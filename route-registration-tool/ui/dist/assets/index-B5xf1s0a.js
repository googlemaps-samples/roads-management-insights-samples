function e(e,t){for(var n=0;n<t.length;n++){const r=t[n];if("string"!=typeof r&&!Array.isArray(r))for(const t in r)if("default"!==t&&!(t in e)){const n=Object.getOwnPropertyDescriptor(r,t);n&&Object.defineProperty(e,t,n.get?n:{enumerable:!0,get:()=>r[t]})}}return Object.freeze(Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}))}function t(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}!function(){const e=document.createElement("link").relList;if(!(e&&e.supports&&e.supports("modulepreload"))){for(const e of document.querySelectorAll('link[rel="modulepreload"]'))t(e);new MutationObserver(e=>{for(const n of e)if("childList"===n.type)for(const e of n.addedNodes)"LINK"===e.tagName&&"modulepreload"===e.rel&&t(e)}).observe(document,{childList:!0,subtree:!0})}function t(e){if(e.ep)return;e.ep=!0;const t=function(e){const t={};return e.integrity&&(t.integrity=e.integrity),e.referrerPolicy&&(t.referrerPolicy=e.referrerPolicy),"use-credentials"===e.crossOrigin?t.credentials="include":"anonymous"===e.crossOrigin?t.credentials="omit":t.credentials="same-origin",t}(e);fetch(e.href,t)}}();var n,r,o={exports:{}},i={};var s=(r||(r=1,o.exports=function(){if(n)return i;n=1;var e=Symbol.for("react.transitional.element"),t=Symbol.for("react.fragment");function r(t,n,r){var o=null;if(void 0!==r&&(o=""+r),void 0!==n.key&&(o=""+n.key),"key"in n)for(var i in r={},n)"key"!==i&&(r[i]=n[i]);else r=n;return n=r.ref,{$$typeof:e,type:t,key:o,ref:void 0!==n?n:null,props:r}}return i.Fragment=t,i.jsx=r,i.jsxs=r,i}()),o.exports),a=class{constructor(){this.listeners=new Set,this.subscribe=this.subscribe.bind(this)}subscribe(e){return this.listeners.add(e),this.onSubscribe(),()=>{this.listeners.delete(e),this.onUnsubscribe()}}hasListeners(){return this.listeners.size>0}onSubscribe(){}onUnsubscribe(){}},l={setTimeout:(e,t)=>setTimeout(e,t),clearTimeout:e=>clearTimeout(e),setInterval:(e,t)=>setInterval(e,t),clearInterval:e=>clearInterval(e)},c=new class{#e=l;#t=!1;setTimeoutProvider(e){this.#e=e}setTimeout(e,t){return this.#e.setTimeout(e,t)}clearTimeout(e){this.#e.clearTimeout(e)}setInterval(e,t){return this.#e.setInterval(e,t)}clearInterval(e){this.#e.clearInterval(e)}};var u="undefined"==typeof window||"Deno"in globalThis;function d(){}function A(e){return"number"==typeof e&&e>=0&&e!==1/0}function h(e,t){return Math.max(e+(t||0)-Date.now(),0)}function p(e,t){return"function"==typeof e?e(t):e}function f(e,t){return"function"==typeof e?e(t):e}function g(e,t){const{type:n="all",exact:r,fetchStatus:o,predicate:i,queryKey:s,stale:a}=e;if(s)if(r){if(t.queryHash!==y(s,t.options))return!1}else if(!b(t.queryKey,s))return!1;if("all"!==n){const e=t.isActive();if("active"===n&&!e)return!1;if("inactive"===n&&e)return!1}return("boolean"!=typeof a||t.isStale()===a)&&((!o||o===t.state.fetchStatus)&&!(i&&!i(t)))}function m(e,t){const{exact:n,status:r,predicate:o,mutationKey:i}=e;if(i){if(!t.options.mutationKey)return!1;if(n){if(v(t.options.mutationKey)!==v(i))return!1}else if(!b(t.options.mutationKey,i))return!1}return(!r||t.state.status===r)&&!(o&&!o(t))}function y(e,t){return(t?.queryKeyHashFn||v)(e)}function v(e){return JSON.stringify(e,(e,t)=>S(t)?Object.keys(t).sort().reduce((e,n)=>(e[n]=t[n],e),{}):t)}function b(e,t){return e===t||typeof e==typeof t&&(!(!e||!t||"object"!=typeof e||"object"!=typeof t)&&Object.keys(t).every(n=>b(e[n],t[n])))}var w=Object.prototype.hasOwnProperty;function x(e,t){if(e===t)return e;const n=C(e)&&C(t);if(!(n||S(e)&&S(t)))return t;const r=(n?e:Object.keys(e)).length,o=n?t:Object.keys(t),i=o.length,s=n?new Array(i):{};let a=0;for(let l=0;l<i;l++){const i=n?l:o[l],c=e[i],u=t[i];if(c===u){s[i]=c,(n?l<r:w.call(e,i))&&a++;continue}if(null===c||null===u||"object"!=typeof c||"object"!=typeof u){s[i]=u;continue}const d=x(c,u);s[i]=d,d===c&&a++}return r===i&&a===r?e:s}function _(e,t){if(!t||Object.keys(e).length!==Object.keys(t).length)return!1;for(const n in e)if(e[n]!==t[n])return!1;return!0}function C(e){return Array.isArray(e)&&e.length===Object.keys(e).length}function S(e){if(!E(e))return!1;const t=e.constructor;if(void 0===t)return!0;const n=t.prototype;return!!E(n)&&(!!n.hasOwnProperty("isPrototypeOf")&&Object.getPrototypeOf(e)===Object.prototype)}function E(e){return"[object Object]"===Object.prototype.toString.call(e)}function B(e,t,n){return"function"==typeof n.structuralSharing?n.structuralSharing(e,t):!1!==n.structuralSharing?x(e,t):t}function I(e,t,n=0){const r=[...e,t];return n&&r.length>n?r.slice(1):r}function R(e,t,n=0){const r=[t,...e];return n&&r.length>n?r.slice(0,-1):r}var k=Symbol();function T(e,t){return!e.queryFn&&t?.initialPromise?()=>t.initialPromise:e.queryFn&&e.queryFn!==k?e.queryFn:()=>Promise.reject(new Error(`Missing queryFn: '${e.queryHash}'`))}function P(e,t){return"function"==typeof e?e(...t):!!e}var F=new class extends a{#n;#r;#o;constructor(){super(),this.#o=e=>{if(!u&&window.addEventListener){const t=()=>e();return window.addEventListener("visibilitychange",t,!1),()=>{window.removeEventListener("visibilitychange",t)}}}}onSubscribe(){this.#r||this.setEventListener(this.#o)}onUnsubscribe(){this.hasListeners()||(this.#r?.(),this.#r=void 0)}setEventListener(e){this.#o=e,this.#r?.(),this.#r=e(e=>{"boolean"==typeof e?this.setFocused(e):this.onFocus()})}setFocused(e){this.#n!==e&&(this.#n=e,this.onFocus())}onFocus(){const e=this.isFocused();this.listeners.forEach(t=>{t(e)})}isFocused(){return"boolean"==typeof this.#n?this.#n:"hidden"!==globalThis.document?.visibilityState}};function M(){let e,t;const n=new Promise((n,r)=>{e=n,t=r});function r(e){Object.assign(n,e),delete n.resolve,delete n.reject}return n.status="pending",n.catch(()=>{}),n.resolve=t=>{r({status:"fulfilled",value:t}),e(t)},n.reject=e=>{r({status:"rejected",reason:e}),t(e)},n}var L=function(e){setTimeout(e,0)};var U=function(){let e=[],t=0,n=e=>{e()},r=e=>{e()},o=L;const i=r=>{t?e.push(r):o(()=>{n(r)})};return{batch:i=>{let s;t++;try{s=i()}finally{t--,t||(()=>{const t=e;e=[],t.length&&o(()=>{r(()=>{t.forEach(e=>{n(e)})})})})()}return s},batchCalls:e=>(...t)=>{i(()=>{e(...t)})},schedule:i,setNotifyFunction:e=>{n=e},setBatchNotifyFunction:e=>{r=e},setScheduler:e=>{o=e}}}(),O=new class extends a{#i=!0;#r;#o;constructor(){super(),this.#o=e=>{if(!u&&window.addEventListener){const t=()=>e(!0),n=()=>e(!1);return window.addEventListener("online",t,!1),window.addEventListener("offline",n,!1),()=>{window.removeEventListener("online",t),window.removeEventListener("offline",n)}}}}onSubscribe(){this.#r||this.setEventListener(this.#o)}onUnsubscribe(){this.hasListeners()||(this.#r?.(),this.#r=void 0)}setEventListener(e){this.#o=e,this.#r?.(),this.#r=e(this.setOnline.bind(this))}setOnline(e){this.#i!==e&&(this.#i=e,this.listeners.forEach(t=>{t(e)}))}isOnline(){return this.#i}};function D(e){return Math.min(1e3*2**e,3e4)}function N(e){return"online"!==(e??"online")||O.isOnline()}var j=class extends Error{constructor(e){super("CancelledError"),this.revert=e?.revert,this.silent=e?.silent}};function Q(e){let t,n=!1,r=0;const o=M(),i=()=>"pending"!==o.status,s=()=>F.isFocused()&&("always"===e.networkMode||O.isOnline())&&e.canRun(),a=()=>N(e.networkMode)&&e.canRun(),l=e=>{i()||(t?.(),o.resolve(e))},d=e=>{i()||(t?.(),o.reject(e))},A=()=>new Promise(n=>{t=e=>{(i()||s())&&n(e)},e.onPause?.()}).then(()=>{t=void 0,i()||e.onContinue?.()}),h=()=>{if(i())return;let t;const o=0===r?e.initialPromise:void 0;try{t=o??e.fn()}catch(a){t=Promise.reject(a)}Promise.resolve(t).then(l).catch(t=>{if(i())return;const o=e.retry??(u?0:3),a=e.retryDelay??D,l="function"==typeof a?a(r,t):a,p=!0===o||"number"==typeof o&&r<o||"function"==typeof o&&o(r,t);var f;!n&&p?(r++,e.onFail?.(r,t),(f=l,new Promise(e=>{c.setTimeout(e,f)})).then(()=>s()?void 0:A()).then(()=>{n?d(t):h()})):d(t)})};return{promise:o,status:()=>o.status,cancel:t=>{if(!i()){const n=new j(t);d(n),e.onCancel?.(n)}},continue:()=>(t?.(),o),cancelRetry:()=>{n=!0},continueRetry:()=>{n=!1},canStart:a,start:()=>(a()?h():A().then(h),o)}}var z=class{#s;destroy(){this.clearGcTimeout()}scheduleGc(){this.clearGcTimeout(),A(this.gcTime)&&(this.#s=c.setTimeout(()=>{this.optionalRemove()},this.gcTime))}updateGcTime(e){this.gcTime=Math.max(this.gcTime||0,e??(u?1/0:3e5))}clearGcTimeout(){this.#s&&(c.clearTimeout(this.#s),this.#s=void 0)}},H=class extends z{#a;#l;#c;#u;#d;#A;#h;constructor(e){super(),this.#h=!1,this.#A=e.defaultOptions,this.setOptions(e.options),this.observers=[],this.#u=e.client,this.#c=this.#u.getQueryCache(),this.queryKey=e.queryKey,this.queryHash=e.queryHash,this.#a=V(this.options),this.state=e.state??this.#a,this.scheduleGc()}get meta(){return this.options.meta}get promise(){return this.#d?.promise}setOptions(e){if(this.options={...this.#A,...e},this.updateGcTime(this.options.gcTime),this.state&&void 0===this.state.data){const e=V(this.options);void 0!==e.data&&(this.setData(e.data,{updatedAt:e.dataUpdatedAt,manual:!0}),this.#a=e)}}optionalRemove(){this.observers.length||"idle"!==this.state.fetchStatus||this.#c.remove(this)}setData(e,t){const n=B(this.state.data,e,this.options);return this.#p({data:n,type:"success",dataUpdatedAt:t?.updatedAt,manual:t?.manual}),n}setState(e,t){this.#p({type:"setState",state:e,setStateOptions:t})}cancel(e){const t=this.#d?.promise;return this.#d?.cancel(e),t?t.then(d).catch(d):Promise.resolve()}destroy(){super.destroy(),this.cancel({silent:!0})}reset(){this.destroy(),this.setState(this.#a)}isActive(){return this.observers.some(e=>!1!==f(e.options.enabled,this))}isDisabled(){return this.getObserversCount()>0?!this.isActive():this.options.queryFn===k||this.state.dataUpdateCount+this.state.errorUpdateCount===0}isStatic(){return this.getObserversCount()>0&&this.observers.some(e=>"static"===p(e.options.staleTime,this))}isStale(){return this.getObserversCount()>0?this.observers.some(e=>e.getCurrentResult().isStale):void 0===this.state.data||this.state.isInvalidated}isStaleByTime(e=0){return void 0===this.state.data||"static"!==e&&(!!this.state.isInvalidated||!h(this.state.dataUpdatedAt,e))}onFocus(){const e=this.observers.find(e=>e.shouldFetchOnWindowFocus());e?.refetch({cancelRefetch:!1}),this.#d?.continue()}onOnline(){const e=this.observers.find(e=>e.shouldFetchOnReconnect());e?.refetch({cancelRefetch:!1}),this.#d?.continue()}addObserver(e){this.observers.includes(e)||(this.observers.push(e),this.clearGcTimeout(),this.#c.notify({type:"observerAdded",query:this,observer:e}))}removeObserver(e){this.observers.includes(e)&&(this.observers=this.observers.filter(t=>t!==e),this.observers.length||(this.#d&&(this.#h?this.#d.cancel({revert:!0}):this.#d.cancelRetry()),this.scheduleGc()),this.#c.notify({type:"observerRemoved",query:this,observer:e}))}getObserversCount(){return this.observers.length}invalidate(){this.state.isInvalidated||this.#p({type:"invalidate"})}async fetch(e,t){if("idle"!==this.state.fetchStatus&&"rejected"!==this.#d?.status())if(void 0!==this.state.data&&t?.cancelRefetch)this.cancel({silent:!0});else if(this.#d)return this.#d.continueRetry(),this.#d.promise;if(e&&this.setOptions(e),!this.options.queryFn){const e=this.observers.find(e=>e.options.queryFn);e&&this.setOptions(e.options)}const n=new AbortController,r=e=>{Object.defineProperty(e,"signal",{enumerable:!0,get:()=>(this.#h=!0,n.signal)})},o=()=>{const e=T(this.options,t),n=(()=>{const e={client:this.#u,queryKey:this.queryKey,meta:this.meta};return r(e),e})();return this.#h=!1,this.options.persister?this.options.persister(e,n,this):e(n)},i=(()=>{const e={fetchOptions:t,options:this.options,queryKey:this.queryKey,client:this.#u,state:this.state,fetchFn:o};return r(e),e})();this.options.behavior?.onFetch(i,this),this.#l=this.state,"idle"!==this.state.fetchStatus&&this.state.fetchMeta===i.fetchOptions?.meta||this.#p({type:"fetch",meta:i.fetchOptions?.meta}),this.#d=Q({initialPromise:t?.initialPromise,fn:i.fetchFn,onCancel:e=>{e instanceof j&&e.revert&&this.setState({...this.#l,fetchStatus:"idle"}),n.abort()},onFail:(e,t)=>{this.#p({type:"failed",failureCount:e,error:t})},onPause:()=>{this.#p({type:"pause"})},onContinue:()=>{this.#p({type:"continue"})},retry:i.options.retry,retryDelay:i.options.retryDelay,networkMode:i.options.networkMode,canRun:()=>!0});try{const e=await this.#d.start();if(void 0===e)throw new Error(`${this.queryHash} data is undefined`);return this.setData(e),this.#c.config.onSuccess?.(e,this),this.#c.config.onSettled?.(e,this.state.error,this),e}catch(s){if(s instanceof j){if(s.silent)return this.#d.promise;if(s.revert){if(void 0===this.state.data)throw s;return this.state.data}}throw this.#p({type:"error",error:s}),this.#c.config.onError?.(s,this),this.#c.config.onSettled?.(this.state.data,s,this),s}finally{this.scheduleGc()}}#p(e){this.state=(t=>{switch(e.type){case"failed":return{...t,fetchFailureCount:e.failureCount,fetchFailureReason:e.error};case"pause":return{...t,fetchStatus:"paused"};case"continue":return{...t,fetchStatus:"fetching"};case"fetch":return{...t,...G(t.data,this.options),fetchMeta:e.meta??null};case"success":const n={...t,data:e.data,dataUpdateCount:t.dataUpdateCount+1,dataUpdatedAt:e.dataUpdatedAt??Date.now(),error:null,isInvalidated:!1,status:"success",...!e.manual&&{fetchStatus:"idle",fetchFailureCount:0,fetchFailureReason:null}};return this.#l=e.manual?n:void 0,n;case"error":const r=e.error;return{...t,error:r,errorUpdateCount:t.errorUpdateCount+1,errorUpdatedAt:Date.now(),fetchFailureCount:t.fetchFailureCount+1,fetchFailureReason:r,fetchStatus:"idle",status:"error"};case"invalidate":return{...t,isInvalidated:!0};case"setState":return{...t,...e.state}}})(this.state),U.batch(()=>{this.observers.forEach(e=>{e.onQueryUpdate()}),this.#c.notify({query:this,type:"updated",action:e})})}};function G(e,t){return{fetchFailureCount:0,fetchFailureReason:null,fetchStatus:N(t.networkMode)?"fetching":"paused",...void 0===e&&{error:null,status:"pending"}}}function V(e){const t="function"==typeof e.initialData?e.initialData():e.initialData,n=void 0!==t,r=n?"function"==typeof e.initialDataUpdatedAt?e.initialDataUpdatedAt():e.initialDataUpdatedAt:0;return{data:t,dataUpdateCount:0,dataUpdatedAt:n?r??Date.now():0,error:null,errorUpdateCount:0,errorUpdatedAt:0,fetchFailureCount:0,fetchFailureReason:null,fetchMeta:null,isInvalidated:!1,status:n?"success":"pending",fetchStatus:"idle"}}var W=class extends a{constructor(e,t){super(),this.options=t,this.#u=e,this.#f=null,this.#g=M(),this.bindMethods(),this.setOptions(t)}#u;#m=void 0;#y=void 0;#v=void 0;#b;#w;#g;#f;#x;#_;#C;#S;#E;#B;#I=new Set;bindMethods(){this.refetch=this.refetch.bind(this)}onSubscribe(){1===this.listeners.size&&(this.#m.addObserver(this),$(this.#m,this.options)?this.#R():this.updateResult(),this.#k())}onUnsubscribe(){this.hasListeners()||this.destroy()}shouldFetchOnReconnect(){return K(this.#m,this.options,this.options.refetchOnReconnect)}shouldFetchOnWindowFocus(){return K(this.#m,this.options,this.options.refetchOnWindowFocus)}destroy(){this.listeners=new Set,this.#T(),this.#P(),this.#m.removeObserver(this)}setOptions(e){const t=this.options,n=this.#m;if(this.options=this.#u.defaultQueryOptions(e),void 0!==this.options.enabled&&"boolean"!=typeof this.options.enabled&&"function"!=typeof this.options.enabled&&"boolean"!=typeof f(this.options.enabled,this.#m))throw new Error("Expected enabled to be a boolean or a callback that returns a boolean");this.#F(),this.#m.setOptions(this.options),t._defaulted&&!_(this.options,t)&&this.#u.getQueryCache().notify({type:"observerOptionsUpdated",query:this.#m,observer:this});const r=this.hasListeners();r&&X(this.#m,n,this.options,t)&&this.#R(),this.updateResult(),!r||this.#m===n&&f(this.options.enabled,this.#m)===f(t.enabled,this.#m)&&p(this.options.staleTime,this.#m)===p(t.staleTime,this.#m)||this.#M();const o=this.#L();!r||this.#m===n&&f(this.options.enabled,this.#m)===f(t.enabled,this.#m)&&o===this.#B||this.#U(o)}getOptimisticResult(e){const t=this.#u.getQueryCache().build(this.#u,e),n=this.createResult(t,e);return function(e,t){if(!_(e.getCurrentResult(),t))return!0;return!1}(this,n)&&(this.#v=n,this.#w=this.options,this.#b=this.#m.state),n}getCurrentResult(){return this.#v}trackResult(e,t){return new Proxy(e,{get:(e,n)=>(this.trackProp(n),t?.(n),"promise"!==n||this.options.experimental_prefetchInRender||"pending"!==this.#g.status||this.#g.reject(new Error("experimental_prefetchInRender feature flag is not enabled")),Reflect.get(e,n))})}trackProp(e){this.#I.add(e)}getCurrentQuery(){return this.#m}refetch({...e}={}){return this.fetch({...e})}fetchOptimistic(e){const t=this.#u.defaultQueryOptions(e),n=this.#u.getQueryCache().build(this.#u,t);return n.fetch().then(()=>this.createResult(n,t))}fetch(e){return this.#R({...e,cancelRefetch:e.cancelRefetch??!0}).then(()=>(this.updateResult(),this.#v))}#R(e){this.#F();let t=this.#m.fetch(this.options,e);return e?.throwOnError||(t=t.catch(d)),t}#M(){this.#T();const e=p(this.options.staleTime,this.#m);if(u||this.#v.isStale||!A(e))return;const t=h(this.#v.dataUpdatedAt,e)+1;this.#S=c.setTimeout(()=>{this.#v.isStale||this.updateResult()},t)}#L(){return("function"==typeof this.options.refetchInterval?this.options.refetchInterval(this.#m):this.options.refetchInterval)??!1}#U(e){this.#P(),this.#B=e,!u&&!1!==f(this.options.enabled,this.#m)&&A(this.#B)&&0!==this.#B&&(this.#E=c.setInterval(()=>{(this.options.refetchIntervalInBackground||F.isFocused())&&this.#R()},this.#B))}#k(){this.#M(),this.#U(this.#L())}#T(){this.#S&&(c.clearTimeout(this.#S),this.#S=void 0)}#P(){this.#E&&(c.clearInterval(this.#E),this.#E=void 0)}createResult(e,t){const n=this.#m,r=this.options,o=this.#v,i=this.#b,s=this.#w,a=e!==n?e.state:this.#y,{state:l}=e;let c,u={...l},d=!1;if(t._optimisticResults){const o=this.hasListeners(),i=!o&&$(e,t),s=o&&X(e,n,t,r);(i||s)&&(u={...u,...G(l.data,e.options)}),"isRestoring"===t._optimisticResults&&(u.fetchStatus="idle")}let{error:A,errorUpdatedAt:h,status:p}=u;c=u.data;let g=!1;if(void 0!==t.placeholderData&&void 0===c&&"pending"===p){let e;o?.isPlaceholderData&&t.placeholderData===s?.placeholderData?(e=o.data,g=!0):e="function"==typeof t.placeholderData?t.placeholderData(this.#C?.state.data,this.#C):t.placeholderData,void 0!==e&&(p="success",c=B(o?.data,e,t),d=!0)}if(t.select&&void 0!==c&&!g)if(o&&c===i?.data&&t.select===this.#x)c=this.#_;else try{this.#x=t.select,c=t.select(c),c=B(o?.data,c,t),this.#_=c,this.#f=null}catch(_){this.#f=_}this.#f&&(A=this.#f,c=this.#_,h=Date.now(),p="error");const m="fetching"===u.fetchStatus,y="pending"===p,v="error"===p,b=y&&m,w=void 0!==c,x={status:p,fetchStatus:u.fetchStatus,isPending:y,isSuccess:"success"===p,isError:v,isInitialLoading:b,isLoading:b,data:c,dataUpdatedAt:u.dataUpdatedAt,error:A,errorUpdatedAt:h,failureCount:u.fetchFailureCount,failureReason:u.fetchFailureReason,errorUpdateCount:u.errorUpdateCount,isFetched:u.dataUpdateCount>0||u.errorUpdateCount>0,isFetchedAfterMount:u.dataUpdateCount>a.dataUpdateCount||u.errorUpdateCount>a.errorUpdateCount,isFetching:m,isRefetching:m&&!y,isLoadingError:v&&!w,isPaused:"paused"===u.fetchStatus,isPlaceholderData:d,isRefetchError:v&&w,isStale:Y(e,t),refetch:this.refetch,promise:this.#g,isEnabled:!1!==f(t.enabled,e)};if(this.options.experimental_prefetchInRender){const t=e=>{"error"===x.status?e.reject(x.error):void 0!==x.data&&e.resolve(x.data)},r=()=>{const e=this.#g=x.promise=M();t(e)},o=this.#g;switch(o.status){case"pending":e.queryHash===n.queryHash&&t(o);break;case"fulfilled":"error"!==x.status&&x.data===o.value||r();break;case"rejected":"error"===x.status&&x.error===o.reason||r()}}return x}updateResult(){const e=this.#v,t=this.createResult(this.#m,this.options);if(this.#b=this.#m.state,this.#w=this.options,void 0!==this.#b.data&&(this.#C=this.#m),_(t,e))return;this.#v=t;this.#O({listeners:(()=>{if(!e)return!0;const{notifyOnChangeProps:t}=this.options,n="function"==typeof t?t():t;if("all"===n||!n&&!this.#I.size)return!0;const r=new Set(n??this.#I);return this.options.throwOnError&&r.add("error"),Object.keys(this.#v).some(t=>{const n=t;return this.#v[n]!==e[n]&&r.has(n)})})()})}#F(){const e=this.#u.getQueryCache().build(this.#u,this.options);if(e===this.#m)return;const t=this.#m;this.#m=e,this.#y=e.state,this.hasListeners()&&(t?.removeObserver(this),e.addObserver(this))}onQueryUpdate(){this.updateResult(),this.hasListeners()&&this.#k()}#O(e){U.batch(()=>{e.listeners&&this.listeners.forEach(e=>{e(this.#v)}),this.#u.getQueryCache().notify({query:this.#m,type:"observerResultsUpdated"})})}};function $(e,t){return function(e,t){return!1!==f(t.enabled,e)&&void 0===e.state.data&&!("error"===e.state.status&&!1===t.retryOnMount)}(e,t)||void 0!==e.state.data&&K(e,t,t.refetchOnMount)}function K(e,t,n){if(!1!==f(t.enabled,e)&&"static"!==p(t.staleTime,e)){const r="function"==typeof n?n(e):n;return"always"===r||!1!==r&&Y(e,t)}return!1}function X(e,t,n,r){return(e!==t||!1===f(r.enabled,e))&&(!n.suspense||"error"!==e.state.status)&&Y(e,n)}function Y(e,t){return!1!==f(t.enabled,e)&&e.isStaleByTime(p(t.staleTime,e))}function q(e){return{onFetch:(t,n)=>{const r=t.options,o=t.fetchOptions?.meta?.fetchMore?.direction,i=t.state.data?.pages||[],s=t.state.data?.pageParams||[];let a={pages:[],pageParams:[]},l=0;const c=async()=>{let n=!1;const c=T(t.options,t.fetchOptions),u=async(e,r,o)=>{if(n)return Promise.reject();if(null==r&&e.pages.length)return Promise.resolve(e);const i=(()=>{const e={client:t.client,queryKey:t.queryKey,pageParam:r,direction:o?"backward":"forward",meta:t.options.meta};var i;return i=e,Object.defineProperty(i,"signal",{enumerable:!0,get:()=>(t.signal.aborted?n=!0:t.signal.addEventListener("abort",()=>{n=!0}),t.signal)}),e})(),s=await c(i),{maxPages:a}=t.options,l=o?R:I;return{pages:l(e.pages,s,a),pageParams:l(e.pageParams,r,a)}};if(o&&i.length){const e="backward"===o,t={pages:i,pageParams:s},n=(e?Z:J)(r,t);a=await u(t,n,e)}else{const t=e??i.length;do{const e=0===l?s[0]??r.initialPageParam:J(r,a);if(l>0&&null==e)break;a=await u(a,e),l++}while(l<t)}return a};t.options.persister?t.fetchFn=()=>t.options.persister?.(c,{client:t.client,queryKey:t.queryKey,meta:t.options.meta,signal:t.signal},n):t.fetchFn=c}}}function J(e,{pages:t,pageParams:n}){const r=t.length-1;return t.length>0?e.getNextPageParam(t[r],t,n[r],n):void 0}function Z(e,{pages:t,pageParams:n}){return t.length>0?e.getPreviousPageParam?.(t[0],t,n[0],n):void 0}function ee(e,t){return!!t&&null!=J(e,t)}function te(e,t){return!(!t||!e.getPreviousPageParam)&&null!=Z(e,t)}var ne=class extends W{constructor(e,t){super(e,t)}bindMethods(){super.bindMethods(),this.fetchNextPage=this.fetchNextPage.bind(this),this.fetchPreviousPage=this.fetchPreviousPage.bind(this)}setOptions(e){super.setOptions({...e,behavior:q()})}getOptimisticResult(e){return e.behavior=q(),super.getOptimisticResult(e)}fetchNextPage(e){return this.fetch({...e,meta:{fetchMore:{direction:"forward"}}})}fetchPreviousPage(e){return this.fetch({...e,meta:{fetchMore:{direction:"backward"}}})}createResult(e,t){const{state:n}=e,r=super.createResult(e,t),{isFetching:o,isRefetching:i,isError:s,isRefetchError:a}=r,l=n.fetchMeta?.fetchMore?.direction,c=s&&"forward"===l,u=o&&"forward"===l,d=s&&"backward"===l,A=o&&"backward"===l;return{...r,fetchNextPage:this.fetchNextPage,fetchPreviousPage:this.fetchPreviousPage,hasNextPage:ee(t,n.data),hasPreviousPage:te(t,n.data),isFetchNextPageError:c,isFetchingNextPage:u,isFetchPreviousPageError:d,isFetchingPreviousPage:A,isRefetchError:a&&!c&&!d,isRefetching:i&&!u&&!A}}},re=class extends z{#u;#D;#N;#d;constructor(e){super(),this.#u=e.client,this.mutationId=e.mutationId,this.#N=e.mutationCache,this.#D=[],this.state=e.state||{context:void 0,data:void 0,error:null,failureCount:0,failureReason:null,isPaused:!1,status:"idle",variables:void 0,submittedAt:0},this.setOptions(e.options),this.scheduleGc()}setOptions(e){this.options=e,this.updateGcTime(this.options.gcTime)}get meta(){return this.options.meta}addObserver(e){this.#D.includes(e)||(this.#D.push(e),this.clearGcTimeout(),this.#N.notify({type:"observerAdded",mutation:this,observer:e}))}removeObserver(e){this.#D=this.#D.filter(t=>t!==e),this.scheduleGc(),this.#N.notify({type:"observerRemoved",mutation:this,observer:e})}optionalRemove(){this.#D.length||("pending"===this.state.status?this.scheduleGc():this.#N.remove(this))}continue(){return this.#d?.continue()??this.execute(this.state.variables)}async execute(e){const t=()=>{this.#p({type:"continue"})},n={client:this.#u,meta:this.options.meta,mutationKey:this.options.mutationKey};this.#d=Q({fn:()=>this.options.mutationFn?this.options.mutationFn(e,n):Promise.reject(new Error("No mutationFn found")),onFail:(e,t)=>{this.#p({type:"failed",failureCount:e,error:t})},onPause:()=>{this.#p({type:"pause"})},onContinue:t,retry:this.options.retry??0,retryDelay:this.options.retryDelay,networkMode:this.options.networkMode,canRun:()=>this.#N.canRun(this)});const r="pending"===this.state.status,o=!this.#d.canStart();try{if(r)t();else{this.#p({type:"pending",variables:e,isPaused:o}),await(this.#N.config.onMutate?.(e,this,n));const t=await(this.options.onMutate?.(e,n));t!==this.state.context&&this.#p({type:"pending",context:t,variables:e,isPaused:o})}const i=await this.#d.start();return await(this.#N.config.onSuccess?.(i,e,this.state.context,this,n)),await(this.options.onSuccess?.(i,e,this.state.context,n)),await(this.#N.config.onSettled?.(i,null,this.state.variables,this.state.context,this,n)),await(this.options.onSettled?.(i,null,e,this.state.context,n)),this.#p({type:"success",data:i}),i}catch(i){try{throw await(this.#N.config.onError?.(i,e,this.state.context,this,n)),await(this.options.onError?.(i,e,this.state.context,n)),await(this.#N.config.onSettled?.(void 0,i,this.state.variables,this.state.context,this,n)),await(this.options.onSettled?.(void 0,i,e,this.state.context,n)),i}finally{this.#p({type:"error",error:i})}}finally{this.#N.runNext(this)}}#p(e){this.state=(t=>{switch(e.type){case"failed":return{...t,failureCount:e.failureCount,failureReason:e.error};case"pause":return{...t,isPaused:!0};case"continue":return{...t,isPaused:!1};case"pending":return{...t,context:e.context,data:void 0,failureCount:0,failureReason:null,error:null,isPaused:e.isPaused,status:"pending",variables:e.variables,submittedAt:Date.now()};case"success":return{...t,data:e.data,failureCount:0,failureReason:null,error:null,status:"success",isPaused:!1};case"error":return{...t,data:void 0,error:e.error,failureCount:t.failureCount+1,failureReason:e.error,isPaused:!1,status:"error"}}})(this.state),U.batch(()=>{this.#D.forEach(t=>{t.onMutationUpdate(e)}),this.#N.notify({mutation:this,type:"updated",action:e})})}};var oe=class extends a{constructor(e={}){super(),this.config=e,this.#j=new Set,this.#Q=new Map,this.#z=0}#j;#Q;#z;build(e,t,n){const r=new re({client:e,mutationCache:this,mutationId:++this.#z,options:e.defaultMutationOptions(t),state:n});return this.add(r),r}add(e){this.#j.add(e);const t=ie(e);if("string"==typeof t){const n=this.#Q.get(t);n?n.push(e):this.#Q.set(t,[e])}this.notify({type:"added",mutation:e})}remove(e){if(this.#j.delete(e)){const t=ie(e);if("string"==typeof t){const n=this.#Q.get(t);if(n)if(n.length>1){const t=n.indexOf(e);-1!==t&&n.splice(t,1)}else n[0]===e&&this.#Q.delete(t)}}this.notify({type:"removed",mutation:e})}canRun(e){const t=ie(e);if("string"==typeof t){const n=this.#Q.get(t),r=n?.find(e=>"pending"===e.state.status);return!r||r===e}return!0}runNext(e){const t=ie(e);if("string"==typeof t){const n=this.#Q.get(t)?.find(t=>t!==e&&t.state.isPaused);return n?.continue()??Promise.resolve()}return Promise.resolve()}clear(){U.batch(()=>{this.#j.forEach(e=>{this.notify({type:"removed",mutation:e})}),this.#j.clear(),this.#Q.clear()})}getAll(){return Array.from(this.#j)}find(e){const t={exact:!0,...e};return this.getAll().find(e=>m(t,e))}findAll(e={}){return this.getAll().filter(t=>m(e,t))}notify(e){U.batch(()=>{this.listeners.forEach(t=>{t(e)})})}resumePausedMutations(){const e=this.getAll().filter(e=>e.state.isPaused);return U.batch(()=>Promise.all(e.map(e=>e.continue().catch(d))))}};function ie(e){return e.options.scope?.id}var se,ae,le=class extends a{#u;#v=void 0;#H;#G;constructor(e,t){super(),this.#u=e,this.setOptions(t),this.bindMethods(),this.#V()}bindMethods(){this.mutate=this.mutate.bind(this),this.reset=this.reset.bind(this)}setOptions(e){const t=this.options;this.options=this.#u.defaultMutationOptions(e),_(this.options,t)||this.#u.getMutationCache().notify({type:"observerOptionsUpdated",mutation:this.#H,observer:this}),t?.mutationKey&&this.options.mutationKey&&v(t.mutationKey)!==v(this.options.mutationKey)?this.reset():"pending"===this.#H?.state.status&&this.#H.setOptions(this.options)}onUnsubscribe(){this.hasListeners()||this.#H?.removeObserver(this)}onMutationUpdate(e){this.#V(),this.#O(e)}getCurrentResult(){return this.#v}reset(){this.#H?.removeObserver(this),this.#H=void 0,this.#V(),this.#O()}mutate(e,t){return this.#G=t,this.#H?.removeObserver(this),this.#H=this.#u.getMutationCache().build(this.#u,this.options),this.#H.addObserver(this),this.#H.execute(e)}#V(){const e=this.#H?.state??{context:void 0,data:void 0,error:null,failureCount:0,failureReason:null,isPaused:!1,status:"idle",variables:void 0,submittedAt:0};this.#v={...e,isPending:"pending"===e.status,isSuccess:"success"===e.status,isError:"error"===e.status,isIdle:"idle"===e.status,mutate:this.mutate,reset:this.reset}}#O(e){U.batch(()=>{if(this.#G&&this.hasListeners()){const t=this.#v.variables,n=this.#v.context,r={client:this.#u,meta:this.options.meta,mutationKey:this.options.mutationKey};"success"===e?.type?(this.#G.onSuccess?.(e.data,t,n,r),this.#G.onSettled?.(e.data,null,t,n,r)):"error"===e?.type&&(this.#G.onError?.(e.error,t,n,r),this.#G.onSettled?.(void 0,e.error,t,n,r))}this.listeners.forEach(e=>{e(this.#v)})})}},ce=class extends a{constructor(e={}){super(),this.config=e,this.#W=new Map}#W;build(e,t,n){const r=t.queryKey,o=t.queryHash??y(r,t);let i=this.get(o);return i||(i=new H({client:e,queryKey:r,queryHash:o,options:e.defaultQueryOptions(t),state:n,defaultOptions:e.getQueryDefaults(r)}),this.add(i)),i}add(e){this.#W.has(e.queryHash)||(this.#W.set(e.queryHash,e),this.notify({type:"added",query:e}))}remove(e){const t=this.#W.get(e.queryHash);t&&(e.destroy(),t===e&&this.#W.delete(e.queryHash),this.notify({type:"removed",query:e}))}clear(){U.batch(()=>{this.getAll().forEach(e=>{this.remove(e)})})}get(e){return this.#W.get(e)}getAll(){return[...this.#W.values()]}find(e){const t={exact:!0,...e};return this.getAll().find(e=>g(t,e))}findAll(e={}){const t=this.getAll();return Object.keys(e).length>0?t.filter(t=>g(e,t)):t}notify(e){U.batch(()=>{this.listeners.forEach(t=>{t(e)})})}onFocus(){U.batch(()=>{this.getAll().forEach(e=>{e.onFocus()})})}onOnline(){U.batch(()=>{this.getAll().forEach(e=>{e.onOnline()})})}},ue={exports:{}},de={};function Ae(){if(se)return de;se=1;var e=Symbol.for("react.transitional.element"),t=Symbol.for("react.portal"),n=Symbol.for("react.fragment"),r=Symbol.for("react.strict_mode"),o=Symbol.for("react.profiler"),i=Symbol.for("react.consumer"),s=Symbol.for("react.context"),a=Symbol.for("react.forward_ref"),l=Symbol.for("react.suspense"),c=Symbol.for("react.memo"),u=Symbol.for("react.lazy"),d=Symbol.iterator;var A={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},h=Object.assign,p={};function f(e,t,n){this.props=e,this.context=t,this.refs=p,this.updater=n||A}function g(){}function m(e,t,n){this.props=e,this.context=t,this.refs=p,this.updater=n||A}f.prototype.isReactComponent={},f.prototype.setState=function(e,t){if("object"!=typeof e&&"function"!=typeof e&&null!=e)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")},f.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")},g.prototype=f.prototype;var y=m.prototype=new g;y.constructor=m,h(y,f.prototype),y.isPureReactComponent=!0;var v=Array.isArray,b={H:null,A:null,T:null,S:null,V:null},w=Object.prototype.hasOwnProperty;function x(t,n,r,o,i,s){return r=s.ref,{$$typeof:e,type:t,key:n,ref:void 0!==r?r:null,props:s}}function _(t){return"object"==typeof t&&null!==t&&t.$$typeof===e}var C=/\/+/g;function S(e,t){return"object"==typeof e&&null!==e&&null!=e.key?(n=""+e.key,r={"=":"=0",":":"=2"},"$"+n.replace(/[=:]/g,function(e){return r[e]})):t.toString(36);var n,r}function E(){}function B(n,r,o,i,s){var a=typeof n;"undefined"!==a&&"boolean"!==a||(n=null);var l,c,A=!1;if(null===n)A=!0;else switch(a){case"bigint":case"string":case"number":A=!0;break;case"object":switch(n.$$typeof){case e:case t:A=!0;break;case u:return B((A=n._init)(n._payload),r,o,i,s)}}if(A)return s=s(n),A=""===i?"."+S(n,0):i,v(s)?(o="",null!=A&&(o=A.replace(C,"$&/")+"/"),B(s,r,o,"",function(e){return e})):null!=s&&(_(s)&&(l=s,c=o+(null==s.key||n&&n.key===s.key?"":(""+s.key).replace(C,"$&/")+"/")+A,s=x(l.type,c,void 0,0,0,l.props)),r.push(s)),1;A=0;var h,p=""===i?".":i+":";if(v(n))for(var f=0;f<n.length;f++)A+=B(i=n[f],r,o,a=p+S(i,f),s);else if("function"==typeof(f=null===(h=n)||"object"!=typeof h?null:"function"==typeof(h=d&&h[d]||h["@@iterator"])?h:null))for(n=f.call(n),f=0;!(i=n.next()).done;)A+=B(i=i.value,r,o,a=p+S(i,f++),s);else if("object"===a){if("function"==typeof n.then)return B(function(e){switch(e.status){case"fulfilled":return e.value;case"rejected":throw e.reason;default:switch("string"==typeof e.status?e.then(E,E):(e.status="pending",e.then(function(t){"pending"===e.status&&(e.status="fulfilled",e.value=t)},function(t){"pending"===e.status&&(e.status="rejected",e.reason=t)})),e.status){case"fulfilled":return e.value;case"rejected":throw e.reason}}throw e}(n),r,o,i,s);throw r=String(n),Error("Objects are not valid as a React child (found: "+("[object Object]"===r?"object with keys {"+Object.keys(n).join(", ")+"}":r)+"). If you meant to render a collection of children, use an array instead.")}return A}function I(e,t,n){if(null==e)return e;var r=[],o=0;return B(e,r,"","",function(e){return t.call(n,e,o++)}),r}function R(e){if(-1===e._status){var t=e._result;(t=t()).then(function(t){0!==e._status&&-1!==e._status||(e._status=1,e._result=t)},function(t){0!==e._status&&-1!==e._status||(e._status=2,e._result=t)}),-1===e._status&&(e._status=0,e._result=t)}if(1===e._status)return e._result.default;throw e._result}var k="function"==typeof reportError?reportError:function(e){if("object"==typeof window&&"function"==typeof window.ErrorEvent){var t=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:"object"==typeof e&&null!==e&&"string"==typeof e.message?String(e.message):String(e),error:e});if(!window.dispatchEvent(t))return}else if("object"==typeof process&&"function"==typeof process.emit)return void process.emit("uncaughtException",e)};function T(){}return de.Children={map:I,forEach:function(e,t,n){I(e,function(){t.apply(this,arguments)},n)},count:function(e){var t=0;return I(e,function(){t++}),t},toArray:function(e){return I(e,function(e){return e})||[]},only:function(e){if(!_(e))throw Error("React.Children.only expected to receive a single React element child.");return e}},de.Component=f,de.Fragment=n,de.Profiler=o,de.PureComponent=m,de.StrictMode=r,de.Suspense=l,de.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=b,de.__COMPILER_RUNTIME={__proto__:null,c:function(e){return b.H.useMemoCache(e)}},de.cache=function(e){return function(){return e.apply(null,arguments)}},de.cloneElement=function(e,t,n){if(null==e)throw Error("The argument must be a React element, but you passed "+e+".");var r=h({},e.props),o=e.key;if(null!=t)for(i in void 0!==t.ref&&void 0,void 0!==t.key&&(o=""+t.key),t)!w.call(t,i)||"key"===i||"__self"===i||"__source"===i||"ref"===i&&void 0===t.ref||(r[i]=t[i]);var i=arguments.length-2;if(1===i)r.children=n;else if(1<i){for(var s=Array(i),a=0;a<i;a++)s[a]=arguments[a+2];r.children=s}return x(e.type,o,void 0,0,0,r)},de.createContext=function(e){return(e={$$typeof:s,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null}).Provider=e,e.Consumer={$$typeof:i,_context:e},e},de.createElement=function(e,t,n){var r,o={},i=null;if(null!=t)for(r in void 0!==t.key&&(i=""+t.key),t)w.call(t,r)&&"key"!==r&&"__self"!==r&&"__source"!==r&&(o[r]=t[r]);var s=arguments.length-2;if(1===s)o.children=n;else if(1<s){for(var a=Array(s),l=0;l<s;l++)a[l]=arguments[l+2];o.children=a}if(e&&e.defaultProps)for(r in s=e.defaultProps)void 0===o[r]&&(o[r]=s[r]);return x(e,i,void 0,0,0,o)},de.createRef=function(){return{current:null}},de.forwardRef=function(e){return{$$typeof:a,render:e}},de.isValidElement=_,de.lazy=function(e){return{$$typeof:u,_payload:{_status:-1,_result:e},_init:R}},de.memo=function(e,t){return{$$typeof:c,type:e,compare:void 0===t?null:t}},de.startTransition=function(e){var t=b.T,n={};b.T=n;try{var r=e(),o=b.S;null!==o&&o(n,r),"object"==typeof r&&null!==r&&"function"==typeof r.then&&r.then(T,k)}catch(i){k(i)}finally{b.T=t}},de.unstable_useCacheRefresh=function(){return b.H.useCacheRefresh()},de.use=function(e){return b.H.use(e)},de.useActionState=function(e,t,n){return b.H.useActionState(e,t,n)},de.useCallback=function(e,t){return b.H.useCallback(e,t)},de.useContext=function(e){return b.H.useContext(e)},de.useDebugValue=function(){},de.useDeferredValue=function(e,t){return b.H.useDeferredValue(e,t)},de.useEffect=function(e,t,n){var r=b.H;if("function"==typeof n)throw Error("useEffect CRUD overload is not enabled in this build of React.");return r.useEffect(e,t)},de.useId=function(){return b.H.useId()},de.useImperativeHandle=function(e,t,n){return b.H.useImperativeHandle(e,t,n)},de.useInsertionEffect=function(e,t){return b.H.useInsertionEffect(e,t)},de.useLayoutEffect=function(e,t){return b.H.useLayoutEffect(e,t)},de.useMemo=function(e,t){return b.H.useMemo(e,t)},de.useOptimistic=function(e,t){return b.H.useOptimistic(e,t)},de.useReducer=function(e,t,n){return b.H.useReducer(e,t,n)},de.useRef=function(e){return b.H.useRef(e)},de.useState=function(e){return b.H.useState(e)},de.useSyncExternalStore=function(e,t,n){return b.H.useSyncExternalStore(e,t,n)},de.useTransition=function(){return b.H.useTransition()},de.version="19.1.1",de}function he(){return ae||(ae=1,ue.exports=Ae()),ue.exports}var pe=he();const fe=t(pe),ge=e({__proto__:null,default:fe},[pe]);var me=pe.createContext(void 0),ye=e=>{const t=pe.useContext(me);if(!t)throw new Error("No QueryClient set, use QueryClientProvider to set one");return t},ve=({client:e,children:t})=>(pe.useEffect(()=>(e.mount(),()=>{e.unmount()}),[e]),s.jsx(me.Provider,{value:e,children:t})),be=pe.createContext(!1);be.Provider;var we=pe.createContext(function(){let e=!1;return{clearReset:()=>{e=!1},reset:()=>{e=!0},isReset:()=>e}}()),xe=(e,t)=>void 0===t.state.data,_e=(e,t,n)=>t.fetchOptimistic(e).catch(()=>{n.clearReset()});function Ce(e,t,n){const r=pe.useContext(be),o=pe.useContext(we),i=ye(),s=i.defaultQueryOptions(e);i.getDefaultOptions().queries?._experimental_beforeQuery?.(s),s._optimisticResults=r?"isRestoring":"optimistic",(e=>{if(e.suspense){const t=1e3,n=e=>"static"===e?e:Math.max(e??t,t),r=e.staleTime;e.staleTime="function"==typeof r?(...e)=>n(r(...e)):n(r),"number"==typeof e.gcTime&&(e.gcTime=Math.max(e.gcTime,t))}})(s),((e,t)=>{(e.suspense||e.throwOnError||e.experimental_prefetchInRender)&&(t.isReset()||(e.retryOnMount=!1))})(s,o),(e=>{pe.useEffect(()=>{e.clearReset()},[e])})(o);const a=!i.getQueryCache().get(s.queryHash),[l]=pe.useState(()=>new t(i,s)),c=l.getOptimisticResult(s),A=!r&&!1!==e.subscribed;if(pe.useSyncExternalStore(pe.useCallback(e=>{const t=A?l.subscribe(U.batchCalls(e)):d;return l.updateResult(),t},[l,A]),()=>l.getCurrentResult(),()=>l.getCurrentResult()),pe.useEffect(()=>{l.setOptions(s)},[s,l]),((e,t)=>e?.suspense&&t.isPending)(s,c))throw _e(s,l,o);if((({result:e,errorResetBoundary:t,throwOnError:n,query:r,suspense:o})=>e.isError&&!t.isReset()&&!e.isFetching&&r&&(o&&void 0===e.data||P(n,[e.error,r])))({result:c,errorResetBoundary:o,throwOnError:s.throwOnError,query:i.getQueryCache().get(s.queryHash),suspense:s.suspense}))throw c.error;if(i.getDefaultOptions().queries?._experimental_afterQuery?.(s,c),s.experimental_prefetchInRender&&!u&&((e,t)=>e.isLoading&&e.isFetching&&!t)(c,r)){const e=a?_e(s,l,o):i.getQueryCache().get(s.queryHash)?.promise;e?.catch(d).finally(()=>{l.updateResult()})}return s.notifyOnChangeProps?c:l.trackResult(c)}function Se(e,t){return Ce(e,W)}function Ee(e,t){const n=ye(),[r]=pe.useState(()=>new le(n,e));pe.useEffect(()=>{r.setOptions(e)},[r,e]);const o=pe.useSyncExternalStore(pe.useCallback(e=>r.subscribe(U.batchCalls(e)),[r]),()=>r.getCurrentResult(),()=>r.getCurrentResult()),i=pe.useCallback((e,t)=>{r.mutate(e,t).catch(d)},[r]);if(o.error&&P(r.options.throwOnError,[o.error]))throw o.error;return{...o,mutate:i,mutateAsync:o.mutate}}const Be={},Ie=function(e,t,n){let r=Promise.resolve();if(t&&t.length>0){let e=function(e){return Promise.all(e.map(e=>Promise.resolve(e).then(e=>({status:"fulfilled",value:e}),e=>({status:"rejected",reason:e}))))};document.getElementsByTagName("link");const n=document.querySelector("meta[property=csp-nonce]"),o=n?.nonce||n?.getAttribute("nonce");r=e(t.map(e=>{if((e=function(e){return"/"+e}(e))in Be)return;Be[e]=!0;const t=e.endsWith(".css"),n=t?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${e}"]${n}`))return;const r=document.createElement("link");return r.rel=t?"stylesheet":"modulepreload",t||(r.as="script"),r.crossOrigin="",r.href=e,o&&r.setAttribute("nonce",o),document.head.appendChild(r),t?new Promise((t,n)=>{r.addEventListener("load",t),r.addEventListener("error",()=>n(new Error(`Unable to preload CSS for ${e}`)))}):void 0}))}function o(e){const t=new Event("vite:preloadError",{cancelable:!0});if(t.payload=e,window.dispatchEvent(t),!t.defaultPrevented)throw e}return r.then(t=>{for(const e of t||[])"rejected"===e.status&&o(e.reason);return e().catch(o)})};var Re,ke,Te=function(){return null},Pe={exports:{}},Fe={},Me={exports:{}},Le={};function Ue(){return ke||(ke=1,Me.exports=(Re||(Re=1,function(e){function t(e,t){var n=e.length;e.push(t);e:for(;0<n;){var r=n-1>>>1,i=e[r];if(!(0<o(i,t)))break e;e[r]=t,e[n]=i,n=r}}function n(e){return 0===e.length?null:e[0]}function r(e){if(0===e.length)return null;var t=e[0],n=e.pop();if(n!==t){e[0]=n;e:for(var r=0,i=e.length,s=i>>>1;r<s;){var a=2*(r+1)-1,l=e[a],c=a+1,u=e[c];if(0>o(l,n))c<i&&0>o(u,l)?(e[r]=u,e[c]=n,r=c):(e[r]=l,e[a]=n,r=a);else{if(!(c<i&&0>o(u,n)))break e;e[r]=u,e[c]=n,r=c}}}return t}function o(e,t){var n=e.sortIndex-t.sortIndex;return 0!==n?n:e.id-t.id}if(e.unstable_now=void 0,"object"==typeof performance&&"function"==typeof performance.now){var i=performance;e.unstable_now=function(){return i.now()}}else{var s=Date,a=s.now();e.unstable_now=function(){return s.now()-a}}var l=[],c=[],u=1,d=null,A=3,h=!1,p=!1,f=!1,g=!1,m="function"==typeof setTimeout?setTimeout:null,y="function"==typeof clearTimeout?clearTimeout:null,v="undefined"!=typeof setImmediate?setImmediate:null;function b(e){for(var o=n(c);null!==o;){if(null===o.callback)r(c);else{if(!(o.startTime<=e))break;r(c),o.sortIndex=o.expirationTime,t(l,o)}o=n(c)}}function w(e){if(f=!1,b(e),!p)if(null!==n(l))p=!0,_||(_=!0,x());else{var t=n(c);null!==t&&T(w,t.startTime-e)}}var x,_=!1,C=-1,S=5,E=-1;function B(){return!(!g&&e.unstable_now()-E<S)}function I(){if(g=!1,_){var t=e.unstable_now();E=t;var o=!0;try{e:{p=!1,f&&(f=!1,y(C),C=-1),h=!0;var i=A;try{t:{for(b(t),d=n(l);null!==d&&!(d.expirationTime>t&&B());){var s=d.callback;if("function"==typeof s){d.callback=null,A=d.priorityLevel;var a=s(d.expirationTime<=t);if(t=e.unstable_now(),"function"==typeof a){d.callback=a,b(t),o=!0;break t}d===n(l)&&r(l),b(t)}else r(l);d=n(l)}if(null!==d)o=!0;else{var u=n(c);null!==u&&T(w,u.startTime-t),o=!1}}break e}finally{d=null,A=i,h=!1}o=void 0}}finally{o?x():_=!1}}}if("function"==typeof v)x=function(){v(I)};else if("undefined"!=typeof MessageChannel){var R=new MessageChannel,k=R.port2;R.port1.onmessage=I,x=function(){k.postMessage(null)}}else x=function(){m(I,0)};function T(t,n){C=m(function(){t(e.unstable_now())},n)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(e){e.callback=null},e.unstable_forceFrameRate=function(e){0>e||125<e||(S=0<e?Math.floor(1e3/e):5)},e.unstable_getCurrentPriorityLevel=function(){return A},e.unstable_next=function(e){switch(A){case 1:case 2:case 3:var t=3;break;default:t=A}var n=A;A=t;try{return e()}finally{A=n}},e.unstable_requestPaint=function(){g=!0},e.unstable_runWithPriority=function(e,t){switch(e){case 1:case 2:case 3:case 4:case 5:break;default:e=3}var n=A;A=e;try{return t()}finally{A=n}},e.unstable_scheduleCallback=function(r,o,i){var s=e.unstable_now();switch(i="object"==typeof i&&null!==i&&"number"==typeof(i=i.delay)&&0<i?s+i:s,r){case 1:var a=-1;break;case 2:a=250;break;case 5:a=1073741823;break;case 4:a=1e4;break;default:a=5e3}return r={id:u++,callback:o,priorityLevel:r,startTime:i,expirationTime:a=i+a,sortIndex:-1},i>s?(r.sortIndex=i,t(c,r),null===n(l)&&r===n(c)&&(f?(y(C),C=-1):f=!0,T(w,i-s))):(r.sortIndex=a,t(l,r),p||h||(p=!0,_||(_=!0,x()))),r},e.unstable_shouldYield=B,e.unstable_wrapCallback=function(e){var t=A;return function(){var n=A;A=t;try{return e.apply(this,arguments)}finally{A=n}}}}(Le)),Le)),Me.exports}var Oe,De,Ne,je,Qe={exports:{}},ze={};function He(){if(Oe)return ze;Oe=1;var e=he();function t(e){var t="https://react.dev/errors/"+e;if(1<arguments.length){t+="?args[]="+encodeURIComponent(arguments[1]);for(var n=2;n<arguments.length;n++)t+="&args[]="+encodeURIComponent(arguments[n])}return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function n(){}var r={d:{f:n,r:function(){throw Error(t(522))},D:n,C:n,L:n,m:n,X:n,S:n,M:n},p:0,findDOMNode:null},o=Symbol.for("react.portal");var i=e.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function s(e,t){return"font"===e?"":"string"==typeof t?"use-credentials"===t?t:"":void 0}return ze.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=r,ze.createPortal=function(e,n){var r=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null;if(!n||1!==n.nodeType&&9!==n.nodeType&&11!==n.nodeType)throw Error(t(299));return function(e,t,n){var r=3<arguments.length&&void 0!==arguments[3]?arguments[3]:null;return{$$typeof:o,key:null==r?null:""+r,children:e,containerInfo:t,implementation:n}}(e,n,null,r)},ze.flushSync=function(e){var t=i.T,n=r.p;try{if(i.T=null,r.p=2,e)return e()}finally{i.T=t,r.p=n,r.d.f()}},ze.preconnect=function(e,t){"string"==typeof e&&(t?t="string"==typeof(t=t.crossOrigin)?"use-credentials"===t?t:"":void 0:t=null,r.d.C(e,t))},ze.prefetchDNS=function(e){"string"==typeof e&&r.d.D(e)},ze.preinit=function(e,t){if("string"==typeof e&&t&&"string"==typeof t.as){var n=t.as,o=s(n,t.crossOrigin),i="string"==typeof t.integrity?t.integrity:void 0,a="string"==typeof t.fetchPriority?t.fetchPriority:void 0;"style"===n?r.d.S(e,"string"==typeof t.precedence?t.precedence:void 0,{crossOrigin:o,integrity:i,fetchPriority:a}):"script"===n&&r.d.X(e,{crossOrigin:o,integrity:i,fetchPriority:a,nonce:"string"==typeof t.nonce?t.nonce:void 0})}},ze.preinitModule=function(e,t){if("string"==typeof e)if("object"==typeof t&&null!==t){if(null==t.as||"script"===t.as){var n=s(t.as,t.crossOrigin);r.d.M(e,{crossOrigin:n,integrity:"string"==typeof t.integrity?t.integrity:void 0,nonce:"string"==typeof t.nonce?t.nonce:void 0})}}else null==t&&r.d.M(e)},ze.preload=function(e,t){if("string"==typeof e&&"object"==typeof t&&null!==t&&"string"==typeof t.as){var n=t.as,o=s(n,t.crossOrigin);r.d.L(e,n,{crossOrigin:o,integrity:"string"==typeof t.integrity?t.integrity:void 0,nonce:"string"==typeof t.nonce?t.nonce:void 0,type:"string"==typeof t.type?t.type:void 0,fetchPriority:"string"==typeof t.fetchPriority?t.fetchPriority:void 0,referrerPolicy:"string"==typeof t.referrerPolicy?t.referrerPolicy:void 0,imageSrcSet:"string"==typeof t.imageSrcSet?t.imageSrcSet:void 0,imageSizes:"string"==typeof t.imageSizes?t.imageSizes:void 0,media:"string"==typeof t.media?t.media:void 0})}},ze.preloadModule=function(e,t){if("string"==typeof e)if(t){var n=s(t.as,t.crossOrigin);r.d.m(e,{as:"string"==typeof t.as&&"script"!==t.as?t.as:void 0,crossOrigin:n,integrity:"string"==typeof t.integrity?t.integrity:void 0})}else r.d.m(e)},ze.requestFormReset=function(e){r.d.r(e)},ze.unstable_batchedUpdates=function(e,t){return e(t)},ze.useFormState=function(e,t,n){return i.H.useFormState(e,t,n)},ze.useFormStatus=function(){return i.H.useHostTransitionStatus()},ze.version="19.1.1",ze}function Ge(){if(De)return Qe.exports;return De=1,function e(){if("undefined"!=typeof __REACT_DEVTOOLS_GLOBAL_HOOK__&&"function"==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE)try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(t){}}(),Qe.exports=He(),Qe.exports}function Ve(){if(Ne)return Fe;Ne=1;
/**
   * @license React
   * react-dom-client.production.js
   *
   * Copyright (c) Meta Platforms, Inc. and affiliates.
   *
   * This source code is licensed under the MIT license found in the
   * LICENSE file in the root directory of this source tree.
   */
var e=Ue(),t=he(),n=Ge();function r(e){var t="https://react.dev/errors/"+e;if(1<arguments.length){t+="?args[]="+encodeURIComponent(arguments[1]);for(var n=2;n<arguments.length;n++)t+="&args[]="+encodeURIComponent(arguments[n])}return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function o(e){return!(!e||1!==e.nodeType&&9!==e.nodeType&&11!==e.nodeType)}function i(e){var t=e,n=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do{!!(4098&(t=e).flags)&&(n=t.return),e=t.return}while(e)}return 3===t.tag?n:null}function s(e){if(13===e.tag){var t=e.memoizedState;if(null===t&&(null!==(e=e.alternate)&&(t=e.memoizedState)),null!==t)return t.dehydrated}return null}function a(e){if(i(e)!==e)throw Error(r(188))}function l(e){var t=e.tag;if(5===t||26===t||27===t||6===t)return e;for(e=e.child;null!==e;){if(null!==(t=l(e)))return t;e=e.sibling}return null}var c=Object.assign,u=Symbol.for("react.element"),d=Symbol.for("react.transitional.element"),A=Symbol.for("react.portal"),h=Symbol.for("react.fragment"),p=Symbol.for("react.strict_mode"),f=Symbol.for("react.profiler"),g=Symbol.for("react.provider"),m=Symbol.for("react.consumer"),y=Symbol.for("react.context"),v=Symbol.for("react.forward_ref"),b=Symbol.for("react.suspense"),w=Symbol.for("react.suspense_list"),x=Symbol.for("react.memo"),_=Symbol.for("react.lazy"),C=Symbol.for("react.activity"),S=Symbol.for("react.memo_cache_sentinel"),E=Symbol.iterator;function B(e){return null===e||"object"!=typeof e?null:"function"==typeof(e=E&&e[E]||e["@@iterator"])?e:null}var I=Symbol.for("react.client.reference");function R(e){if(null==e)return null;if("function"==typeof e)return e.$$typeof===I?null:e.displayName||e.name||null;if("string"==typeof e)return e;switch(e){case h:return"Fragment";case f:return"Profiler";case p:return"StrictMode";case b:return"Suspense";case w:return"SuspenseList";case C:return"Activity"}if("object"==typeof e)switch(e.$$typeof){case A:return"Portal";case y:return(e.displayName||"Context")+".Provider";case m:return(e._context.displayName||"Context")+".Consumer";case v:var t=e.render;return(e=e.displayName)||(e=""!==(e=t.displayName||t.name||"")?"ForwardRef("+e+")":"ForwardRef"),e;case x:return null!==(t=e.displayName||null)?t:R(e.type)||"Memo";case _:t=e._payload,e=e._init;try{return R(e(t))}catch(n){}}return null}var k=Array.isArray,T=t.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,P=n.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,F={pending:!1,data:null,method:null,action:null},M=[],L=-1;function U(e){return{current:e}}function O(e){0>L||(e.current=M[L],M[L]=null,L--)}function D(e,t){L++,M[L]=e.current,e.current=t}var N=U(null),j=U(null),Q=U(null),z=U(null);function H(e,t){switch(D(Q,t),D(j,e),D(N,null),t.nodeType){case 9:case 11:e=(e=t.documentElement)&&(e=e.namespaceURI)?sd(e):0;break;default:if(e=t.tagName,t=t.namespaceURI)e=ad(t=sd(t),e);else switch(e){case"svg":e=1;break;case"math":e=2;break;default:e=0}}O(N),D(N,e)}function G(){O(N),O(j),O(Q)}function V(e){null!==e.memoizedState&&D(z,e);var t=N.current,n=ad(t,e.type);t!==n&&(D(j,e),D(N,n))}function W(e){j.current===e&&(O(N),O(j)),z.current===e&&(O(z),Yd._currentValue=F)}var $=Object.prototype.hasOwnProperty,K=e.unstable_scheduleCallback,X=e.unstable_cancelCallback,Y=e.unstable_shouldYield,q=e.unstable_requestPaint,J=e.unstable_now,Z=e.unstable_getCurrentPriorityLevel,ee=e.unstable_ImmediatePriority,te=e.unstable_UserBlockingPriority,ne=e.unstable_NormalPriority,re=e.unstable_LowPriority,oe=e.unstable_IdlePriority,ie=e.log,se=e.unstable_setDisableYieldValue,ae=null,le=null;function ce(e){if("function"==typeof ie&&se(e),le&&"function"==typeof le.setStrictMode)try{le.setStrictMode(ae,e)}catch(t){}}var ue=Math.clz32?Math.clz32:function(e){return 0===(e>>>=0)?32:31-(de(e)/Ae|0)|0},de=Math.log,Ae=Math.LN2;var pe=256,fe=4194304;function ge(e){var t=42&e;if(0!==t)return t;switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return 4194048&e;case 4194304:case 8388608:case 16777216:case 33554432:return 62914560&e;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return e}}function me(e,t,n){var r=e.pendingLanes;if(0===r)return 0;var o=0,i=e.suspendedLanes,s=e.pingedLanes;e=e.warmLanes;var a=134217727&r;return 0!==a?0!==(r=a&~i)?o=ge(r):0!==(s&=a)?o=ge(s):n||0!==(n=a&~e)&&(o=ge(n)):0!==(a=r&~i)?o=ge(a):0!==s?o=ge(s):n||0!==(n=r&~e)&&(o=ge(n)),0===o?0:0!==t&&t!==o&&0===(t&i)&&((i=o&-o)>=(n=t&-t)||32===i&&4194048&n)?t:o}function ye(e,t){return 0===(e.pendingLanes&~(e.suspendedLanes&~e.pingedLanes)&t)}function ve(e,t){switch(e){case 1:case 2:case 4:case 8:case 64:return t+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;default:return-1}}function be(){var e=pe;return!(4194048&(pe<<=1))&&(pe=256),e}function we(){var e=fe;return!(62914560&(fe<<=1))&&(fe=4194304),e}function xe(e){for(var t=[],n=0;31>n;n++)t.push(e);return t}function _e(e,t){e.pendingLanes|=t,268435456!==t&&(e.suspendedLanes=0,e.pingedLanes=0,e.warmLanes=0)}function Ce(e,t,n){e.pendingLanes|=t,e.suspendedLanes&=~t;var r=31-ue(t);e.entangledLanes|=t,e.entanglements[r]=1073741824|e.entanglements[r]|4194090&n}function Se(e,t){var n=e.entangledLanes|=t;for(e=e.entanglements;n;){var r=31-ue(n),o=1<<r;o&t|e[r]&t&&(e[r]|=t),n&=~o}}function Ee(e){switch(e){case 2:e=1;break;case 8:e=4;break;case 32:e=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:e=128;break;case 268435456:e=134217728;break;default:e=0}return e}function Be(e){return 2<(e&=-e)?8<e?134217727&e?32:268435456:8:2}function Ie(){var e=P.p;return 0!==e?e:void 0===(e=window.event)?32:dA(e.type)}var Re=Math.random().toString(36).slice(2),ke="__reactFiber$"+Re,Te="__reactProps$"+Re,Pe="__reactContainer$"+Re,Me="__reactEvents$"+Re,Le="__reactListeners$"+Re,Oe="__reactHandles$"+Re,De="__reactResources$"+Re,je="__reactMarker$"+Re;function Qe(e){delete e[ke],delete e[Te],delete e[Me],delete e[Le],delete e[Oe]}function ze(e){var t=e[ke];if(t)return t;for(var n=e.parentNode;n;){if(t=n[Pe]||n[ke]){if(n=t.alternate,null!==t.child||null!==n&&null!==n.child)for(e=wd(e);null!==e;){if(n=e[ke])return n;e=wd(e)}return t}n=(e=n).parentNode}return null}function He(e){if(e=e[ke]||e[Pe]){var t=e.tag;if(5===t||6===t||13===t||26===t||27===t||3===t)return e}return null}function Ve(e){var t=e.tag;if(5===t||26===t||27===t||6===t)return e.stateNode;throw Error(r(33))}function We(e){var t=e[De];return t||(t=e[De]={hoistableStyles:new Map,hoistableScripts:new Map}),t}function $e(e){e[je]=!0}var Ke=new Set,Xe={};function Ye(e,t){qe(e,t),qe(e+"Capture",t)}function qe(e,t){for(Xe[e]=t,e=0;e<t.length;e++)Ke.add(t[e])}var Je,Ze,et=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),tt={},nt={};function rt(e,t,n){if(o=t,$.call(nt,o)||!$.call(tt,o)&&(et.test(o)?nt[o]=!0:(tt[o]=!0,0)))if(null===n)e.removeAttribute(t);else{switch(typeof n){case"undefined":case"function":case"symbol":return void e.removeAttribute(t);case"boolean":var r=t.toLowerCase().slice(0,5);if("data-"!==r&&"aria-"!==r)return void e.removeAttribute(t)}e.setAttribute(t,""+n)}var o}function ot(e,t,n){if(null===n)e.removeAttribute(t);else{switch(typeof n){case"undefined":case"function":case"symbol":case"boolean":return void e.removeAttribute(t)}e.setAttribute(t,""+n)}}function it(e,t,n,r){if(null===r)e.removeAttribute(n);else{switch(typeof r){case"undefined":case"function":case"symbol":case"boolean":return void e.removeAttribute(n)}e.setAttributeNS(t,n,""+r)}}function st(e){if(void 0===Je)try{throw Error()}catch(n){var t=n.stack.trim().match(/\n( *(at )?)/);Je=t&&t[1]||"",Ze=-1<n.stack.indexOf("\n    at")?" (<anonymous>)":-1<n.stack.indexOf("@")?"@unknown:0:0":""}return"\n"+Je+e+Ze}var at=!1;function lt(e,t){if(!e||at)return"";at=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var r={DetermineComponentFrameRoot:function(){try{if(t){var n=function(){throw Error()};if(Object.defineProperty(n.prototype,"props",{set:function(){throw Error()}}),"object"==typeof Reflect&&Reflect.construct){try{Reflect.construct(n,[])}catch(o){var r=o}Reflect.construct(e,[],n)}else{try{n.call()}catch(i){r=i}e.call(n.prototype)}}else{try{throw Error()}catch(s){r=s}(n=e())&&"function"==typeof n.catch&&n.catch(function(){})}}catch(a){if(a&&r&&"string"==typeof a.stack)return[a.stack,r.stack]}return[null,null]}};r.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var o=Object.getOwnPropertyDescriptor(r.DetermineComponentFrameRoot,"name");o&&o.configurable&&Object.defineProperty(r.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var i=r.DetermineComponentFrameRoot(),s=i[0],a=i[1];if(s&&a){var l=s.split("\n"),c=a.split("\n");for(o=r=0;r<l.length&&!l[r].includes("DetermineComponentFrameRoot");)r++;for(;o<c.length&&!c[o].includes("DetermineComponentFrameRoot");)o++;if(r===l.length||o===c.length)for(r=l.length-1,o=c.length-1;1<=r&&0<=o&&l[r]!==c[o];)o--;for(;1<=r&&0<=o;r--,o--)if(l[r]!==c[o]){if(1!==r||1!==o)do{if(r--,0>--o||l[r]!==c[o]){var u="\n"+l[r].replace(" at new "," at ");return e.displayName&&u.includes("<anonymous>")&&(u=u.replace("<anonymous>",e.displayName)),u}}while(1<=r&&0<=o);break}}}finally{at=!1,Error.prepareStackTrace=n}return(n=e?e.displayName||e.name:"")?st(n):""}function ct(e){switch(e.tag){case 26:case 27:case 5:return st(e.type);case 16:return st("Lazy");case 13:return st("Suspense");case 19:return st("SuspenseList");case 0:case 15:return lt(e.type,!1);case 11:return lt(e.type.render,!1);case 1:return lt(e.type,!0);case 31:return st("Activity");default:return""}}function ut(e){try{var t="";do{t+=ct(e),e=e.return}while(e);return t}catch(n){return"\nError generating stack: "+n.message+"\n"+n.stack}}function dt(e){switch(typeof e){case"bigint":case"boolean":case"number":case"string":case"undefined":case"object":return e;default:return""}}function At(e){var t=e.type;return(e=e.nodeName)&&"input"===e.toLowerCase()&&("checkbox"===t||"radio"===t)}function ht(e){e._valueTracker||(e._valueTracker=function(e){var t=At(e)?"checked":"value",n=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),r=""+e[t];if(!e.hasOwnProperty(t)&&void 0!==n&&"function"==typeof n.get&&"function"==typeof n.set){var o=n.get,i=n.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return o.call(this)},set:function(e){r=""+e,i.call(this,e)}}),Object.defineProperty(e,t,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(e){r=""+e},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}(e))}function pt(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var n=t.getValue(),r="";return e&&(r=At(e)?e.checked?"true":"false":e.value),(e=r)!==n&&(t.setValue(e),!0)}function ft(e){if(void 0===(e=e||("undefined"!=typeof document?document:void 0)))return null;try{return e.activeElement||e.body}catch(t){return e.body}}var gt=/[\n"\\]/g;function mt(e){return e.replace(gt,function(e){return"\\"+e.charCodeAt(0).toString(16)+" "})}function yt(e,t,n,r,o,i,s,a){e.name="",null!=s&&"function"!=typeof s&&"symbol"!=typeof s&&"boolean"!=typeof s?e.type=s:e.removeAttribute("type"),null!=t?"number"===s?(0===t&&""===e.value||e.value!=t)&&(e.value=""+dt(t)):e.value!==""+dt(t)&&(e.value=""+dt(t)):"submit"!==s&&"reset"!==s||e.removeAttribute("value"),null!=t?bt(e,s,dt(t)):null!=n?bt(e,s,dt(n)):null!=r&&e.removeAttribute("value"),null==o&&null!=i&&(e.defaultChecked=!!i),null!=o&&(e.checked=o&&"function"!=typeof o&&"symbol"!=typeof o),null!=a&&"function"!=typeof a&&"symbol"!=typeof a&&"boolean"!=typeof a?e.name=""+dt(a):e.removeAttribute("name")}function vt(e,t,n,r,o,i,s,a){if(null!=i&&"function"!=typeof i&&"symbol"!=typeof i&&"boolean"!=typeof i&&(e.type=i),null!=t||null!=n){if(("submit"===i||"reset"===i)&&null==t)return;n=null!=n?""+dt(n):"",t=null!=t?""+dt(t):n,a||t===e.value||(e.value=t),e.defaultValue=t}r="function"!=typeof(r=null!=r?r:o)&&"symbol"!=typeof r&&!!r,e.checked=a?e.checked:!!r,e.defaultChecked=!!r,null!=s&&"function"!=typeof s&&"symbol"!=typeof s&&"boolean"!=typeof s&&(e.name=s)}function bt(e,t,n){"number"===t&&ft(e.ownerDocument)===e||e.defaultValue===""+n||(e.defaultValue=""+n)}function wt(e,t,n,r){if(e=e.options,t){t={};for(var o=0;o<n.length;o++)t["$"+n[o]]=!0;for(n=0;n<e.length;n++)o=t.hasOwnProperty("$"+e[n].value),e[n].selected!==o&&(e[n].selected=o),o&&r&&(e[n].defaultSelected=!0)}else{for(n=""+dt(n),t=null,o=0;o<e.length;o++){if(e[o].value===n)return e[o].selected=!0,void(r&&(e[o].defaultSelected=!0));null!==t||e[o].disabled||(t=e[o])}null!==t&&(t.selected=!0)}}function xt(e,t,n){null==t||((t=""+dt(t))!==e.value&&(e.value=t),null!=n)?e.defaultValue=null!=n?""+dt(n):"":e.defaultValue!==t&&(e.defaultValue=t)}function _t(e,t,n,o){if(null==t){if(null!=o){if(null!=n)throw Error(r(92));if(k(o)){if(1<o.length)throw Error(r(93));o=o[0]}n=o}null==n&&(n=""),t=n}n=dt(t),e.defaultValue=n,(o=e.textContent)===n&&""!==o&&null!==o&&(e.value=o)}function Ct(e,t){if(t){var n=e.firstChild;if(n&&n===e.lastChild&&3===n.nodeType)return void(n.nodeValue=t)}e.textContent=t}var St=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function Et(e,t,n){var r=0===t.indexOf("--");null==n||"boolean"==typeof n||""===n?r?e.setProperty(t,""):"float"===t?e.cssFloat="":e[t]="":r?e.setProperty(t,n):"number"!=typeof n||0===n||St.has(t)?"float"===t?e.cssFloat=n:e[t]=(""+n).trim():e[t]=n+"px"}function Bt(e,t,n){if(null!=t&&"object"!=typeof t)throw Error(r(62));if(e=e.style,null!=n){for(var o in n)!n.hasOwnProperty(o)||null!=t&&t.hasOwnProperty(o)||(0===o.indexOf("--")?e.setProperty(o,""):"float"===o?e.cssFloat="":e[o]="");for(var i in t)o=t[i],t.hasOwnProperty(i)&&n[i]!==o&&Et(e,i,o)}else for(var s in t)t.hasOwnProperty(s)&&Et(e,s,t[s])}function It(e){if(-1===e.indexOf("-"))return!1;switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Rt=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),kt=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function Tt(e){return kt.test(""+e)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":e}var Pt=null;function Ft(e){return(e=e.target||e.srcElement||window).correspondingUseElement&&(e=e.correspondingUseElement),3===e.nodeType?e.parentNode:e}var Mt=null,Lt=null;function Ut(e){var t=He(e);if(t&&(e=t.stateNode)){var n=e[Te]||null;e:switch(e=t.stateNode,t.type){case"input":if(yt(e,n.value,n.defaultValue,n.defaultValue,n.checked,n.defaultChecked,n.type,n.name),t=n.name,"radio"===n.type&&null!=t){for(n=e;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll('input[name="'+mt(""+t)+'"][type="radio"]'),t=0;t<n.length;t++){var o=n[t];if(o!==e&&o.form===e.form){var i=o[Te]||null;if(!i)throw Error(r(90));yt(o,i.value,i.defaultValue,i.defaultValue,i.checked,i.defaultChecked,i.type,i.name)}}for(t=0;t<n.length;t++)(o=n[t]).form===e.form&&pt(o)}break e;case"textarea":xt(e,n.value,n.defaultValue);break e;case"select":null!=(t=n.value)&&wt(e,!!n.multiple,t,!1)}}}var Ot=!1;function Dt(e,t,n){if(Ot)return e(t,n);Ot=!0;try{return e(t)}finally{if(Ot=!1,(null!==Mt||null!==Lt)&&(Hc(),Mt&&(t=Mt,e=Lt,Lt=Mt=null,Ut(t),e)))for(t=0;t<e.length;t++)Ut(e[t])}}function Nt(e,t){var n=e.stateNode;if(null===n)return null;var o=n[Te]||null;if(null===o)return null;n=o[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(o=!o.disabled)||(o=!("button"===(e=e.type)||"input"===e||"select"===e||"textarea"===e)),e=!o;break e;default:e=!1}if(e)return null;if(n&&"function"!=typeof n)throw Error(r(231,t,typeof n));return n}var jt=!("undefined"==typeof window||void 0===window.document||void 0===window.document.createElement),Qt=!1;if(jt)try{var zt={};Object.defineProperty(zt,"passive",{get:function(){Qt=!0}}),window.addEventListener("test",zt,zt),window.removeEventListener("test",zt,zt)}catch(LA){Qt=!1}var Ht=null,Gt=null,Vt=null;function Wt(){if(Vt)return Vt;var e,t,n=Gt,r=n.length,o="value"in Ht?Ht.value:Ht.textContent,i=o.length;for(e=0;e<r&&n[e]===o[e];e++);var s=r-e;for(t=1;t<=s&&n[r-t]===o[i-t];t++);return Vt=o.slice(e,1<t?1-t:void 0)}function $t(e){var t=e.keyCode;return"charCode"in e?0===(e=e.charCode)&&13===t&&(e=13):e=t,10===e&&(e=13),32<=e||13===e?e:0}function Kt(){return!0}function Xt(){return!1}function Yt(e){function t(t,n,r,o,i){for(var s in this._reactName=t,this._targetInst=r,this.type=n,this.nativeEvent=o,this.target=i,this.currentTarget=null,e)e.hasOwnProperty(s)&&(t=e[s],this[s]=t?t(o):o[s]);return this.isDefaultPrevented=(null!=o.defaultPrevented?o.defaultPrevented:!1===o.returnValue)?Kt:Xt,this.isPropagationStopped=Xt,this}return c(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var e=this.nativeEvent;e&&(e.preventDefault?e.preventDefault():"unknown"!=typeof e.returnValue&&(e.returnValue=!1),this.isDefaultPrevented=Kt)},stopPropagation:function(){var e=this.nativeEvent;e&&(e.stopPropagation?e.stopPropagation():"unknown"!=typeof e.cancelBubble&&(e.cancelBubble=!0),this.isPropagationStopped=Kt)},persist:function(){},isPersistent:Kt}),t}var qt,Jt,Zt,en={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},tn=Yt(en),nn=c({},en,{view:0,detail:0}),rn=Yt(nn),on=c({},nn,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:gn,button:0,buttons:0,relatedTarget:function(e){return void 0===e.relatedTarget?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==Zt&&(Zt&&"mousemove"===e.type?(qt=e.screenX-Zt.screenX,Jt=e.screenY-Zt.screenY):Jt=qt=0,Zt=e),qt)},movementY:function(e){return"movementY"in e?e.movementY:Jt}}),sn=Yt(on),an=Yt(c({},on,{dataTransfer:0})),ln=Yt(c({},nn,{relatedTarget:0})),cn=Yt(c({},en,{animationName:0,elapsedTime:0,pseudoElement:0})),un=Yt(c({},en,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}})),dn=Yt(c({},en,{data:0})),An={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},hn={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},pn={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function fn(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):!!(e=pn[e])&&!!t[e]}function gn(){return fn}var mn=Yt(c({},nn,{key:function(e){if(e.key){var t=An[e.key]||e.key;if("Unidentified"!==t)return t}return"keypress"===e.type?13===(e=$t(e))?"Enter":String.fromCharCode(e):"keydown"===e.type||"keyup"===e.type?hn[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:gn,charCode:function(e){return"keypress"===e.type?$t(e):0},keyCode:function(e){return"keydown"===e.type||"keyup"===e.type?e.keyCode:0},which:function(e){return"keypress"===e.type?$t(e):"keydown"===e.type||"keyup"===e.type?e.keyCode:0}})),yn=Yt(c({},on,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0})),vn=Yt(c({},nn,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:gn})),bn=Yt(c({},en,{propertyName:0,elapsedTime:0,pseudoElement:0})),wn=Yt(c({},on,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0})),xn=Yt(c({},en,{newState:0,oldState:0})),_n=[9,13,27,32],Cn=jt&&"CompositionEvent"in window,Sn=null;jt&&"documentMode"in document&&(Sn=document.documentMode);var En=jt&&"TextEvent"in window&&!Sn,Bn=jt&&(!Cn||Sn&&8<Sn&&11>=Sn),In=String.fromCharCode(32),Rn=!1;function kn(e,t){switch(e){case"keyup":return-1!==_n.indexOf(t.keyCode);case"keydown":return 229!==t.keyCode;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Tn(e){return"object"==typeof(e=e.detail)&&"data"in e?e.data:null}var Pn=!1;var Fn={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Mn(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return"input"===t?!!Fn[e.type]:"textarea"===t}function Ln(e,t,n,r){Mt?Lt?Lt.push(r):Lt=[r]:Mt=r,0<(t=Wu(t,"onChange")).length&&(n=new tn("onChange","change",null,n,r),e.push({event:n,listeners:t}))}var Un=null,On=null;function Dn(e){Du(e,0)}function Nn(e){if(pt(Ve(e)))return e}function jn(e,t){if("change"===e)return t}var Qn=!1;if(jt){var zn;if(jt){var Hn="oninput"in document;if(!Hn){var Gn=document.createElement("div");Gn.setAttribute("oninput","return;"),Hn="function"==typeof Gn.oninput}zn=Hn}else zn=!1;Qn=zn&&(!document.documentMode||9<document.documentMode)}function Vn(){Un&&(Un.detachEvent("onpropertychange",Wn),On=Un=null)}function Wn(e){if("value"===e.propertyName&&Nn(On)){var t=[];Ln(t,On,e,Ft(e)),Dt(Dn,t)}}function $n(e,t,n){"focusin"===e?(Vn(),On=n,(Un=t).attachEvent("onpropertychange",Wn)):"focusout"===e&&Vn()}function Kn(e){if("selectionchange"===e||"keyup"===e||"keydown"===e)return Nn(On)}function Xn(e,t){if("click"===e)return Nn(t)}function Yn(e,t){if("input"===e||"change"===e)return Nn(t)}var qn="function"==typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e==1/t)||e!=e&&t!=t};function Jn(e,t){if(qn(e,t))return!0;if("object"!=typeof e||null===e||"object"!=typeof t||null===t)return!1;var n=Object.keys(e),r=Object.keys(t);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++){var o=n[r];if(!$.call(t,o)||!qn(e[o],t[o]))return!1}return!0}function Zn(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function er(e,t){var n,r=Zn(e);for(e=0;r;){if(3===r.nodeType){if(n=e+r.textContent.length,e<=t&&n>=t)return{node:r,offset:t-e};e=n}e:{for(;r;){if(r.nextSibling){r=r.nextSibling;break e}r=r.parentNode}r=void 0}r=Zn(r)}}function tr(e,t){return!(!e||!t)&&(e===t||(!e||3!==e.nodeType)&&(t&&3===t.nodeType?tr(e,t.parentNode):"contains"in e?e.contains(t):!!e.compareDocumentPosition&&!!(16&e.compareDocumentPosition(t))))}function nr(e){for(var t=ft((e=null!=e&&null!=e.ownerDocument&&null!=e.ownerDocument.defaultView?e.ownerDocument.defaultView:window).document);t instanceof e.HTMLIFrameElement;){try{var n="string"==typeof t.contentWindow.location.href}catch(r){n=!1}if(!n)break;t=ft((e=t.contentWindow).document)}return t}function rr(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&("input"===t&&("text"===e.type||"search"===e.type||"tel"===e.type||"url"===e.type||"password"===e.type)||"textarea"===t||"true"===e.contentEditable)}var or=jt&&"documentMode"in document&&11>=document.documentMode,ir=null,sr=null,ar=null,lr=!1;function cr(e,t,n){var r=n.window===n?n.document:9===n.nodeType?n:n.ownerDocument;lr||null==ir||ir!==ft(r)||("selectionStart"in(r=ir)&&rr(r)?r={start:r.selectionStart,end:r.selectionEnd}:r={anchorNode:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection()).anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset},ar&&Jn(ar,r)||(ar=r,0<(r=Wu(sr,"onSelect")).length&&(t=new tn("onSelect","select",null,t,n),e.push({event:t,listeners:r}),t.target=ir)))}function ur(e,t){var n={};return n[e.toLowerCase()]=t.toLowerCase(),n["Webkit"+e]="webkit"+t,n["Moz"+e]="moz"+t,n}var dr={animationend:ur("Animation","AnimationEnd"),animationiteration:ur("Animation","AnimationIteration"),animationstart:ur("Animation","AnimationStart"),transitionrun:ur("Transition","TransitionRun"),transitionstart:ur("Transition","TransitionStart"),transitioncancel:ur("Transition","TransitionCancel"),transitionend:ur("Transition","TransitionEnd")},Ar={},hr={};function pr(e){if(Ar[e])return Ar[e];if(!dr[e])return e;var t,n=dr[e];for(t in n)if(n.hasOwnProperty(t)&&t in hr)return Ar[e]=n[t];return e}jt&&(hr=document.createElement("div").style,"AnimationEvent"in window||(delete dr.animationend.animation,delete dr.animationiteration.animation,delete dr.animationstart.animation),"TransitionEvent"in window||delete dr.transitionend.transition);var fr=pr("animationend"),gr=pr("animationiteration"),mr=pr("animationstart"),yr=pr("transitionrun"),vr=pr("transitionstart"),br=pr("transitioncancel"),wr=pr("transitionend"),xr=new Map,_r="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Cr(e,t){xr.set(e,t),Ye(t,[e])}_r.push("scrollEnd");var Sr=new WeakMap;function Er(e,t){if("object"==typeof e&&null!==e){var n=Sr.get(e);return void 0!==n?n:(t={value:e,source:t,stack:ut(t)},Sr.set(e,t),t)}return{value:e,source:t,stack:ut(t)}}var Br=[],Ir=0,Rr=0;function kr(){for(var e=Ir,t=Rr=Ir=0;t<e;){var n=Br[t];Br[t++]=null;var r=Br[t];Br[t++]=null;var o=Br[t];Br[t++]=null;var i=Br[t];if(Br[t++]=null,null!==r&&null!==o){var s=r.pending;null===s?o.next=o:(o.next=s.next,s.next=o),r.pending=o}0!==i&&Mr(n,o,i)}}function Tr(e,t,n,r){Br[Ir++]=e,Br[Ir++]=t,Br[Ir++]=n,Br[Ir++]=r,Rr|=r,e.lanes|=r,null!==(e=e.alternate)&&(e.lanes|=r)}function Pr(e,t,n,r){return Tr(e,t,n,r),Lr(e)}function Fr(e,t){return Tr(e,null,null,t),Lr(e)}function Mr(e,t,n){e.lanes|=n;var r=e.alternate;null!==r&&(r.lanes|=n);for(var o=!1,i=e.return;null!==i;)i.childLanes|=n,null!==(r=i.alternate)&&(r.childLanes|=n),22===i.tag&&(null===(e=i.stateNode)||1&e._visibility||(o=!0)),e=i,i=i.return;return 3===e.tag?(i=e.stateNode,o&&null!==t&&(o=31-ue(n),null===(r=(e=i.hiddenUpdates)[o])?e[o]=[t]:r.push(t),t.lane=536870912|n),i):null}function Lr(e){if(50<Mc)throw Mc=0,Lc=null,Error(r(185));for(var t=e.return;null!==t;)t=(e=t).return;return 3===e.tag?e.stateNode:null}var Ur={};function Or(e,t,n,r){this.tag=e,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Dr(e,t,n,r){return new Or(e,t,n,r)}function Nr(e){return!(!(e=e.prototype)||!e.isReactComponent)}function jr(e,t){var n=e.alternate;return null===n?((n=Dr(e.tag,t,e.key,e.mode)).elementType=e.elementType,n.type=e.type,n.stateNode=e.stateNode,n.alternate=e,e.alternate=n):(n.pendingProps=t,n.type=e.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=65011712&e.flags,n.childLanes=e.childLanes,n.lanes=e.lanes,n.child=e.child,n.memoizedProps=e.memoizedProps,n.memoizedState=e.memoizedState,n.updateQueue=e.updateQueue,t=e.dependencies,n.dependencies=null===t?null:{lanes:t.lanes,firstContext:t.firstContext},n.sibling=e.sibling,n.index=e.index,n.ref=e.ref,n.refCleanup=e.refCleanup,n}function Qr(e,t){e.flags&=65011714;var n=e.alternate;return null===n?(e.childLanes=0,e.lanes=t,e.child=null,e.subtreeFlags=0,e.memoizedProps=null,e.memoizedState=null,e.updateQueue=null,e.dependencies=null,e.stateNode=null):(e.childLanes=n.childLanes,e.lanes=n.lanes,e.child=n.child,e.subtreeFlags=0,e.deletions=null,e.memoizedProps=n.memoizedProps,e.memoizedState=n.memoizedState,e.updateQueue=n.updateQueue,e.type=n.type,t=n.dependencies,e.dependencies=null===t?null:{lanes:t.lanes,firstContext:t.firstContext}),e}function zr(e,t,n,o,i,s){var a=0;if(o=e,"function"==typeof e)Nr(e)&&(a=1);else if("string"==typeof e)a=function(e,t,n){if(1===n||null!=t.itemProp)return!1;switch(e){case"meta":case"title":return!0;case"style":if("string"!=typeof t.precedence||"string"!=typeof t.href||""===t.href)break;return!0;case"link":if("string"!=typeof t.rel||"string"!=typeof t.href||""===t.href||t.onLoad||t.onError)break;return"stylesheet"!==t.rel||(e=t.disabled,"string"==typeof t.precedence&&null==e);case"script":if(t.async&&"function"!=typeof t.async&&"symbol"!=typeof t.async&&!t.onLoad&&!t.onError&&t.src&&"string"==typeof t.src)return!0}return!1}(e,n,N.current)?26:"html"===e||"head"===e||"body"===e?27:5;else e:switch(e){case C:return(e=Dr(31,n,t,i)).elementType=C,e.lanes=s,e;case h:return Hr(n.children,i,s,t);case p:a=8,i|=24;break;case f:return(e=Dr(12,n,t,2|i)).elementType=f,e.lanes=s,e;case b:return(e=Dr(13,n,t,i)).elementType=b,e.lanes=s,e;case w:return(e=Dr(19,n,t,i)).elementType=w,e.lanes=s,e;default:if("object"==typeof e&&null!==e)switch(e.$$typeof){case g:case y:a=10;break e;case m:a=9;break e;case v:a=11;break e;case x:a=14;break e;case _:a=16,o=null;break e}a=29,n=Error(r(130,null===e?"null":typeof e,"")),o=null}return(t=Dr(a,n,t,i)).elementType=e,t.type=o,t.lanes=s,t}function Hr(e,t,n,r){return(e=Dr(7,e,r,t)).lanes=n,e}function Gr(e,t,n){return(e=Dr(6,e,null,t)).lanes=n,e}function Vr(e,t,n){return(t=Dr(4,null!==e.children?e.children:[],e.key,t)).lanes=n,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}var Wr=[],$r=0,Kr=null,Xr=0,Yr=[],qr=0,Jr=null,Zr=1,eo="";function to(e,t){Wr[$r++]=Xr,Wr[$r++]=Kr,Kr=e,Xr=t}function no(e,t,n){Yr[qr++]=Zr,Yr[qr++]=eo,Yr[qr++]=Jr,Jr=e;var r=Zr;e=eo;var o=32-ue(r)-1;r&=~(1<<o),n+=1;var i=32-ue(t)+o;if(30<i){var s=o-o%5;i=(r&(1<<s)-1).toString(32),r>>=s,o-=s,Zr=1<<32-ue(t)+o|n<<o|r,eo=i+e}else Zr=1<<i|n<<o|r,eo=e}function ro(e){null!==e.return&&(to(e,1),no(e,1,0))}function oo(e){for(;e===Kr;)Kr=Wr[--$r],Wr[$r]=null,Xr=Wr[--$r],Wr[$r]=null;for(;e===Jr;)Jr=Yr[--qr],Yr[qr]=null,eo=Yr[--qr],Yr[qr]=null,Zr=Yr[--qr],Yr[qr]=null}var io=null,so=null,ao=!1,lo=null,co=!1,uo=Error(r(519));function Ao(e){throw yo(Er(Error(r(418,"")),e)),uo}function ho(e){var t=e.stateNode,n=e.type,r=e.memoizedProps;switch(t[ke]=e,t[Te]=r,n){case"dialog":Nu("cancel",t),Nu("close",t);break;case"iframe":case"object":case"embed":Nu("load",t);break;case"video":case"audio":for(n=0;n<Uu.length;n++)Nu(Uu[n],t);break;case"source":Nu("error",t);break;case"img":case"image":case"link":Nu("error",t),Nu("load",t);break;case"details":Nu("toggle",t);break;case"input":Nu("invalid",t),vt(t,r.value,r.defaultValue,r.checked,r.defaultChecked,r.type,r.name,!0),ht(t);break;case"select":Nu("invalid",t);break;case"textarea":Nu("invalid",t),_t(t,r.value,r.defaultValue,r.children),ht(t)}"string"!=typeof(n=r.children)&&"number"!=typeof n&&"bigint"!=typeof n||t.textContent===""+n||!0===r.suppressHydrationWarning||Ju(t.textContent,n)?(null!=r.popover&&(Nu("beforetoggle",t),Nu("toggle",t)),null!=r.onScroll&&Nu("scroll",t),null!=r.onScrollEnd&&Nu("scrollend",t),null!=r.onClick&&(t.onclick=Zu),t=!0):t=!1,t||Ao(e)}function po(e){for(io=e.return;io;)switch(io.tag){case 5:case 13:return void(co=!1);case 27:case 3:return void(co=!0);default:io=io.return}}function fo(e){if(e!==io)return!1;if(!ao)return po(e),ao=!0,!1;var t,n=e.tag;if((t=3!==n&&27!==n)&&((t=5===n)&&(t=!("form"!==(t=e.type)&&"button"!==t)||ld(e.type,e.memoizedProps)),t=!t),t&&so&&Ao(e),po(e),13===n){if(!(e=null!==(e=e.memoizedState)?e.dehydrated:null))throw Error(r(317));e:{for(e=e.nextSibling,n=0;e;){if(8===e.nodeType)if("/$"===(t=e.data)){if(0===n){so=vd(e.nextSibling);break e}n--}else"$"!==t&&"$!"!==t&&"$?"!==t||n++;e=e.nextSibling}so=null}}else 27===n?(n=so,fd(e.type)?(e=bd,bd=null,so=e):so=n):so=io?vd(e.stateNode.nextSibling):null;return!0}function go(){so=io=null,ao=!1}function mo(){var e=lo;return null!==e&&(null===wc?wc=e:wc.push.apply(wc,e),lo=null),e}function yo(e){null===lo?lo=[e]:lo.push(e)}var vo=U(null),bo=null,wo=null;function xo(e,t,n){D(vo,t._currentValue),t._currentValue=n}function _o(e){e._currentValue=vo.current,O(vo)}function Co(e,t,n){for(;null!==e;){var r=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,null!==r&&(r.childLanes|=t)):null!==r&&(r.childLanes&t)!==t&&(r.childLanes|=t),e===n)break;e=e.return}}function So(e,t,n,o){var i=e.child;for(null!==i&&(i.return=e);null!==i;){var s=i.dependencies;if(null!==s){var a=i.child;s=s.firstContext;e:for(;null!==s;){var l=s;s=i;for(var c=0;c<t.length;c++)if(l.context===t[c]){s.lanes|=n,null!==(l=s.alternate)&&(l.lanes|=n),Co(s.return,n,e),o||(a=null);break e}s=l.next}}else if(18===i.tag){if(null===(a=i.return))throw Error(r(341));a.lanes|=n,null!==(s=a.alternate)&&(s.lanes|=n),Co(a,n,e),a=null}else a=i.child;if(null!==a)a.return=i;else for(a=i;null!==a;){if(a===e){a=null;break}if(null!==(i=a.sibling)){i.return=a.return,a=i;break}a=a.return}i=a}}function Eo(e,t,n,o){e=null;for(var i=t,s=!1;null!==i;){if(!s)if(524288&i.flags)s=!0;else if(262144&i.flags)break;if(10===i.tag){var a=i.alternate;if(null===a)throw Error(r(387));if(null!==(a=a.memoizedProps)){var l=i.type;qn(i.pendingProps.value,a.value)||(null!==e?e.push(l):e=[l])}}else if(i===z.current){if(null===(a=i.alternate))throw Error(r(387));a.memoizedState.memoizedState!==i.memoizedState.memoizedState&&(null!==e?e.push(Yd):e=[Yd])}i=i.return}null!==e&&So(t,e,n,o),t.flags|=262144}function Bo(e){for(e=e.firstContext;null!==e;){if(!qn(e.context._currentValue,e.memoizedValue))return!0;e=e.next}return!1}function Io(e){bo=e,wo=null,null!==(e=e.dependencies)&&(e.firstContext=null)}function Ro(e){return To(bo,e)}function ko(e,t){return null===bo&&Io(e),To(e,t)}function To(e,t){var n=t._currentValue;if(t={context:t,memoizedValue:n,next:null},null===wo){if(null===e)throw Error(r(308));wo=t,e.dependencies={lanes:0,firstContext:t},e.flags|=524288}else wo=wo.next=t;return n}var Po="undefined"!=typeof AbortController?AbortController:function(){var e=[],t=this.signal={aborted:!1,addEventListener:function(t,n){e.push(n)}};this.abort=function(){t.aborted=!0,e.forEach(function(e){return e()})}},Fo=e.unstable_scheduleCallback,Mo=e.unstable_NormalPriority,Lo={$$typeof:y,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function Uo(){return{controller:new Po,data:new Map,refCount:0}}function Oo(e){e.refCount--,0===e.refCount&&Fo(Mo,function(){e.controller.abort()})}var Do=null,No=0,jo=0,Qo=null;function zo(){if(0===--No&&null!==Do){null!==Qo&&(Qo.status="fulfilled");var e=Do;Do=null,jo=0,Qo=null;for(var t=0;t<e.length;t++)(0,e[t])()}}var Ho=T.S;T.S=function(e,t){"object"==typeof t&&null!==t&&"function"==typeof t.then&&function(e,t){if(null===Do){var n=Do=[];No=0,jo=Tu(),Qo={status:"pending",value:void 0,then:function(e){n.push(e)}}}No++,t.then(zo,zo)}(0,t),null!==Ho&&Ho(e,t)};var Go=U(null);function Vo(){var e=Go.current;return null!==e?e:ic.pooledCache}function Wo(e,t){D(Go,null===t?Go.current:t.pool)}function $o(){var e=Vo();return null===e?null:{parent:Lo._currentValue,pool:e}}var Ko=Error(r(460)),Xo=Error(r(474)),Yo=Error(r(542)),qo={then:function(){}};function Jo(e){return"fulfilled"===(e=e.status)||"rejected"===e}function Zo(){}function ei(e,t,n){switch(void 0===(n=e[n])?e.push(t):n!==t&&(t.then(Zo,Zo),t=n),t.status){case"fulfilled":return t.value;case"rejected":throw ri(e=t.reason),e;default:if("string"==typeof t.status)t.then(Zo,Zo);else{if(null!==(e=ic)&&100<e.shellSuspendCounter)throw Error(r(482));(e=t).status="pending",e.then(function(e){if("pending"===t.status){var n=t;n.status="fulfilled",n.value=e}},function(e){if("pending"===t.status){var n=t;n.status="rejected",n.reason=e}})}switch(t.status){case"fulfilled":return t.value;case"rejected":throw ri(e=t.reason),e}throw ti=t,Ko}}var ti=null;function ni(){if(null===ti)throw Error(r(459));var e=ti;return ti=null,e}function ri(e){if(e===Ko||e===Yo)throw Error(r(483))}var oi=!1;function ii(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function si(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,callbacks:null})}function ai(e){return{lane:e,tag:0,payload:null,callback:null,next:null}}function li(e,t,n){var r=e.updateQueue;if(null===r)return null;if(r=r.shared,2&oc){var o=r.pending;return null===o?t.next=t:(t.next=o.next,o.next=t),r.pending=t,t=Lr(e),Mr(e,null,n),t}return Tr(e,r,t,n),Lr(e)}function ci(e,t,n){if(null!==(t=t.updateQueue)&&(t=t.shared,4194048&n)){var r=t.lanes;n|=r&=e.pendingLanes,t.lanes=n,Se(e,n)}}function ui(e,t){var n=e.updateQueue,r=e.alternate;if(null!==r&&n===(r=r.updateQueue)){var o=null,i=null;if(null!==(n=n.firstBaseUpdate)){do{var s={lane:n.lane,tag:n.tag,payload:n.payload,callback:null,next:null};null===i?o=i=s:i=i.next=s,n=n.next}while(null!==n);null===i?o=i=t:i=i.next=t}else o=i=t;return n={baseState:r.baseState,firstBaseUpdate:o,lastBaseUpdate:i,shared:r.shared,callbacks:r.callbacks},void(e.updateQueue=n)}null===(e=n.lastBaseUpdate)?n.firstBaseUpdate=t:e.next=t,n.lastBaseUpdate=t}var di=!1;function Ai(){if(di){if(null!==Qo)throw Qo}}function hi(e,t,n,r){di=!1;var o=e.updateQueue;oi=!1;var i=o.firstBaseUpdate,s=o.lastBaseUpdate,a=o.shared.pending;if(null!==a){o.shared.pending=null;var l=a,u=l.next;l.next=null,null===s?i=u:s.next=u,s=l;var d=e.alternate;null!==d&&((a=(d=d.updateQueue).lastBaseUpdate)!==s&&(null===a?d.firstBaseUpdate=u:a.next=u,d.lastBaseUpdate=l))}if(null!==i){var A=o.baseState;for(s=0,d=u=l=null,a=i;;){var h=-536870913&a.lane,p=h!==a.lane;if(p?(ac&h)===h:(r&h)===h){0!==h&&h===jo&&(di=!0),null!==d&&(d=d.next={lane:0,tag:a.tag,payload:a.payload,callback:null,next:null});e:{var f=e,g=a;h=t;var m=n;switch(g.tag){case 1:if("function"==typeof(f=g.payload)){A=f.call(m,A,h);break e}A=f;break e;case 3:f.flags=-65537&f.flags|128;case 0:if(null==(h="function"==typeof(f=g.payload)?f.call(m,A,h):f))break e;A=c({},A,h);break e;case 2:oi=!0}}null!==(h=a.callback)&&(e.flags|=64,p&&(e.flags|=8192),null===(p=o.callbacks)?o.callbacks=[h]:p.push(h))}else p={lane:h,tag:a.tag,payload:a.payload,callback:a.callback,next:null},null===d?(u=d=p,l=A):d=d.next=p,s|=h;if(null===(a=a.next)){if(null===(a=o.shared.pending))break;a=(p=a).next,p.next=null,o.lastBaseUpdate=p,o.shared.pending=null}}null===d&&(l=A),o.baseState=l,o.firstBaseUpdate=u,o.lastBaseUpdate=d,null===i&&(o.shared.lanes=0),fc|=s,e.lanes=s,e.memoizedState=A}}function pi(e,t){if("function"!=typeof e)throw Error(r(191,e));e.call(t)}function fi(e,t){var n=e.callbacks;if(null!==n)for(e.callbacks=null,e=0;e<n.length;e++)pi(n[e],t)}var gi=U(null),mi=U(0);function yi(e,t){D(mi,e=hc),D(gi,t),hc=e|t.baseLanes}function vi(){D(mi,hc),D(gi,gi.current)}function bi(){hc=mi.current,O(gi),O(mi)}var wi=0,xi=null,_i=null,Ci=null,Si=!1,Ei=!1,Bi=!1,Ii=0,Ri=0,ki=null,Ti=0;function Pi(){throw Error(r(321))}function Fi(e,t){if(null===t)return!1;for(var n=0;n<t.length&&n<e.length;n++)if(!qn(e[n],t[n]))return!1;return!0}function Mi(e,t,n,r,o,i){return wi=i,xi=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,T.H=null===e||null===e.memoizedState?Ks:Xs,Bi=!1,i=n(r,o),Bi=!1,Ei&&(i=Ui(t,n,r,o)),Li(e),i}function Li(e){T.H=$s;var t=null!==_i&&null!==_i.next;if(wi=0,Ci=_i=xi=null,Si=!1,Ri=0,ki=null,t)throw Error(r(300));null===e||Ra||null!==(e=e.dependencies)&&Bo(e)&&(Ra=!0)}function Ui(e,t,n,o){xi=e;var i=0;do{if(Ei&&(ki=null),Ri=0,Ei=!1,25<=i)throw Error(r(301));if(i+=1,Ci=_i=null,null!=e.updateQueue){var s=e.updateQueue;s.lastEffect=null,s.events=null,s.stores=null,null!=s.memoCache&&(s.memoCache.index=0)}T.H=Ys,s=t(n,o)}while(Ei);return s}function Oi(){var e=T.H,t=e.useState()[0];return t="function"==typeof t.then?Hi(t):t,e=e.useState()[0],(null!==_i?_i.memoizedState:null)!==e&&(xi.flags|=1024),t}function Di(){var e=0!==Ii;return Ii=0,e}function Ni(e,t,n){t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~n}function ji(e){if(Si){for(e=e.memoizedState;null!==e;){var t=e.queue;null!==t&&(t.pending=null),e=e.next}Si=!1}wi=0,Ci=_i=xi=null,Ei=!1,Ri=Ii=0,ki=null}function Qi(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return null===Ci?xi.memoizedState=Ci=e:Ci=Ci.next=e,Ci}function zi(){if(null===_i){var e=xi.alternate;e=null!==e?e.memoizedState:null}else e=_i.next;var t=null===Ci?xi.memoizedState:Ci.next;if(null!==t)Ci=t,_i=e;else{if(null===e){if(null===xi.alternate)throw Error(r(467));throw Error(r(310))}e={memoizedState:(_i=e).memoizedState,baseState:_i.baseState,baseQueue:_i.baseQueue,queue:_i.queue,next:null},null===Ci?xi.memoizedState=Ci=e:Ci=Ci.next=e}return Ci}function Hi(e){var t=Ri;return Ri+=1,null===ki&&(ki=[]),e=ei(ki,e,t),t=xi,null===(null===Ci?t.memoizedState:Ci.next)&&(t=t.alternate,T.H=null===t||null===t.memoizedState?Ks:Xs),e}function Gi(e){if(null!==e&&"object"==typeof e){if("function"==typeof e.then)return Hi(e);if(e.$$typeof===y)return Ro(e)}throw Error(r(438,String(e)))}function Vi(e){var t=null,n=xi.updateQueue;if(null!==n&&(t=n.memoCache),null==t){var r=xi.alternate;null!==r&&(null!==(r=r.updateQueue)&&(null!=(r=r.memoCache)&&(t={data:r.data.map(function(e){return e.slice()}),index:0})))}if(null==t&&(t={data:[],index:0}),null===n&&(n={lastEffect:null,events:null,stores:null,memoCache:null},xi.updateQueue=n),n.memoCache=t,void 0===(n=t.data[t.index]))for(n=t.data[t.index]=Array(e),r=0;r<e;r++)n[r]=S;return t.index++,n}function Wi(e,t){return"function"==typeof t?t(e):t}function $i(e){return Ki(zi(),_i,e)}function Ki(e,t,n){var o=e.queue;if(null===o)throw Error(r(311));o.lastRenderedReducer=n;var i=e.baseQueue,s=o.pending;if(null!==s){if(null!==i){var a=i.next;i.next=s.next,s.next=a}t.baseQueue=i=s,o.pending=null}if(s=e.baseState,null===i)e.memoizedState=s;else{var l=a=null,c=null,u=t=i.next,d=!1;do{var A=-536870913&u.lane;if(A!==u.lane?(ac&A)===A:(wi&A)===A){var h=u.revertLane;if(0===h)null!==c&&(c=c.next={lane:0,revertLane:0,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null}),A===jo&&(d=!0);else{if((wi&h)===h){u=u.next,h===jo&&(d=!0);continue}A={lane:0,revertLane:u.revertLane,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null},null===c?(l=c=A,a=s):c=c.next=A,xi.lanes|=h,fc|=h}A=u.action,Bi&&n(s,A),s=u.hasEagerState?u.eagerState:n(s,A)}else h={lane:A,revertLane:u.revertLane,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null},null===c?(l=c=h,a=s):c=c.next=h,xi.lanes|=A,fc|=A;u=u.next}while(null!==u&&u!==t);if(null===c?a=s:c.next=l,!qn(s,e.memoizedState)&&(Ra=!0,d&&null!==(n=Qo)))throw n;e.memoizedState=s,e.baseState=a,e.baseQueue=c,o.lastRenderedState=s}return null===i&&(o.lanes=0),[e.memoizedState,o.dispatch]}function Xi(e){var t=zi(),n=t.queue;if(null===n)throw Error(r(311));n.lastRenderedReducer=e;var o=n.dispatch,i=n.pending,s=t.memoizedState;if(null!==i){n.pending=null;var a=i=i.next;do{s=e(s,a.action),a=a.next}while(a!==i);qn(s,t.memoizedState)||(Ra=!0),t.memoizedState=s,null===t.baseQueue&&(t.baseState=s),n.lastRenderedState=s}return[s,o]}function Yi(e,t,n){var o=xi,i=zi(),s=ao;if(s){if(void 0===n)throw Error(r(407));n=n()}else n=t();var a=!qn((_i||i).memoizedState,n);if(a&&(i.memoizedState=n,Ra=!0),i=i.queue,vs(2048,8,Zi.bind(null,o,i,e),[e]),i.getSnapshot!==t||a||null!==Ci&&1&Ci.memoizedState.tag){if(o.flags|=2048,gs(9,{destroy:void 0,resource:void 0},Ji.bind(null,o,i,n,t),null),null===ic)throw Error(r(349));s||124&wi||qi(o,t,n)}return n}function qi(e,t,n){e.flags|=16384,e={getSnapshot:t,value:n},null===(t=xi.updateQueue)?(t={lastEffect:null,events:null,stores:null,memoCache:null},xi.updateQueue=t,t.stores=[e]):null===(n=t.stores)?t.stores=[e]:n.push(e)}function Ji(e,t,n,r){t.value=n,t.getSnapshot=r,es(t)&&ts(e)}function Zi(e,t,n){return n(function(){es(t)&&ts(e)})}function es(e){var t=e.getSnapshot;e=e.value;try{var n=t();return!qn(e,n)}catch(r){return!0}}function ts(e){var t=Fr(e,2);null!==t&&Dc(t,e,2)}function ns(e){var t=Qi();if("function"==typeof e){var n=e;if(e=n(),Bi){ce(!0);try{n()}finally{ce(!1)}}}return t.memoizedState=t.baseState=e,t.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Wi,lastRenderedState:e},t}function rs(e,t,n,r){return e.baseState=n,Ki(e,_i,"function"==typeof r?r:Wi)}function os(e,t,n,o,i){if(Gs(e))throw Error(r(485));if(null!==(e=t.action)){var s={payload:i,action:e,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(e){s.listeners.push(e)}};null!==T.T?n(!0):s.isTransition=!1,o(s),null===(n=t.pending)?(s.next=t.pending=s,is(t,s)):(s.next=n.next,t.pending=n.next=s)}}function is(e,t){var n=t.action,r=t.payload,o=e.state;if(t.isTransition){var i=T.T,s={};T.T=s;try{var a=n(o,r),l=T.S;null!==l&&l(s,a),ss(e,t,a)}catch(c){ls(e,t,c)}finally{T.T=i}}else try{ss(e,t,i=n(o,r))}catch(u){ls(e,t,u)}}function ss(e,t,n){null!==n&&"object"==typeof n&&"function"==typeof n.then?n.then(function(n){as(e,t,n)},function(n){return ls(e,t,n)}):as(e,t,n)}function as(e,t,n){t.status="fulfilled",t.value=n,cs(t),e.state=n,null!==(t=e.pending)&&((n=t.next)===t?e.pending=null:(n=n.next,t.next=n,is(e,n)))}function ls(e,t,n){var r=e.pending;if(e.pending=null,null!==r){r=r.next;do{t.status="rejected",t.reason=n,cs(t),t=t.next}while(t!==r)}e.action=null}function cs(e){e=e.listeners;for(var t=0;t<e.length;t++)(0,e[t])()}function us(e,t){return t}function ds(e,t){if(ao){var n=ic.formState;if(null!==n){e:{var r=xi;if(ao){if(so){t:{for(var o=so,i=co;8!==o.nodeType;){if(!i){o=null;break t}if(null===(o=vd(o.nextSibling))){o=null;break t}}o="F!"===(i=o.data)||"F"===i?o:null}if(o){so=vd(o.nextSibling),r="F!"===o.data;break e}}Ao(r)}r=!1}r&&(t=n[0])}}return(n=Qi()).memoizedState=n.baseState=t,r={pending:null,lanes:0,dispatch:null,lastRenderedReducer:us,lastRenderedState:t},n.queue=r,n=Qs.bind(null,xi,r),r.dispatch=n,r=ns(!1),i=Hs.bind(null,xi,!1,r.queue),o={state:t,dispatch:null,action:e,pending:null},(r=Qi()).queue=o,n=os.bind(null,xi,o,i,n),o.dispatch=n,r.memoizedState=e,[t,n,!1]}function As(e){return hs(zi(),_i,e)}function hs(e,t,n){if(t=Ki(e,t,us)[0],e=$i(Wi)[0],"object"==typeof t&&null!==t&&"function"==typeof t.then)try{var r=Hi(t)}catch(s){if(s===Ko)throw Yo;throw s}else r=t;var o=(t=zi()).queue,i=o.dispatch;return n!==t.memoizedState&&(xi.flags|=2048,gs(9,{destroy:void 0,resource:void 0},ps.bind(null,o,n),null)),[r,i,e]}function ps(e,t){e.action=t}function fs(e){var t=zi(),n=_i;if(null!==n)return hs(t,n,e);zi(),t=t.memoizedState;var r=(n=zi()).queue.dispatch;return n.memoizedState=e,[t,r,!1]}function gs(e,t,n,r){return e={tag:e,create:n,deps:r,inst:t,next:null},null===(t=xi.updateQueue)&&(t={lastEffect:null,events:null,stores:null,memoCache:null},xi.updateQueue=t),null===(n=t.lastEffect)?t.lastEffect=e.next=e:(r=n.next,n.next=e,e.next=r,t.lastEffect=e),e}function ms(){return zi().memoizedState}function ys(e,t,n,r){var o=Qi();r=void 0===r?null:r,xi.flags|=e,o.memoizedState=gs(1|t,{destroy:void 0,resource:void 0},n,r)}function vs(e,t,n,r){var o=zi();r=void 0===r?null:r;var i=o.memoizedState.inst;null!==_i&&null!==r&&Fi(r,_i.memoizedState.deps)?o.memoizedState=gs(t,i,n,r):(xi.flags|=e,o.memoizedState=gs(1|t,i,n,r))}function bs(e,t){ys(8390656,8,e,t)}function ws(e,t){vs(2048,8,e,t)}function xs(e,t){return vs(4,2,e,t)}function _s(e,t){return vs(4,4,e,t)}function Cs(e,t){if("function"==typeof t){e=e();var n=t(e);return function(){"function"==typeof n?n():t(null)}}if(null!=t)return e=e(),t.current=e,function(){t.current=null}}function Ss(e,t,n){n=null!=n?n.concat([e]):null,vs(4,4,Cs.bind(null,t,e),n)}function Es(){}function Bs(e,t){var n=zi();t=void 0===t?null:t;var r=n.memoizedState;return null!==t&&Fi(t,r[1])?r[0]:(n.memoizedState=[e,t],e)}function Is(e,t){var n=zi();t=void 0===t?null:t;var r=n.memoizedState;if(null!==t&&Fi(t,r[1]))return r[0];if(r=e(),Bi){ce(!0);try{e()}finally{ce(!1)}}return n.memoizedState=[r,t],r}function Rs(e,t,n){return void 0===n||1073741824&wi?e.memoizedState=t:(e.memoizedState=n,e=Oc(),xi.lanes|=e,fc|=e,n)}function ks(e,t,n,r){return qn(n,t)?n:null!==gi.current?(e=Rs(e,n,r),qn(e,t)||(Ra=!0),e):42&wi?(e=Oc(),xi.lanes|=e,fc|=e,t):(Ra=!0,e.memoizedState=n)}function Ts(e,t,n,r,o){var i=P.p;P.p=0!==i&&8>i?i:8;var s,a,l,c=T.T,u={};T.T=u,Hs(e,!1,t,n);try{var d=o(),A=T.S;if(null!==A&&A(u,d),null!==d&&"object"==typeof d&&"function"==typeof d.then){var h=(s=r,a=[],l={status:"pending",value:null,reason:null,then:function(e){a.push(e)}},d.then(function(){l.status="fulfilled",l.value=s;for(var e=0;e<a.length;e++)(0,a[e])(s)},function(e){for(l.status="rejected",l.reason=e,e=0;e<a.length;e++)(0,a[e])(void 0)}),l);zs(e,t,h,Uc())}else zs(e,t,r,Uc())}catch(p){zs(e,t,{then:function(){},status:"rejected",reason:p},Uc())}finally{P.p=i,T.T=c}}function Ps(){}function Fs(e,t,n,o){if(5!==e.tag)throw Error(r(476));var i=Ms(e).queue;Ts(e,i,t,F,null===n?Ps:function(){return Ls(e),n(o)})}function Ms(e){var t=e.memoizedState;if(null!==t)return t;var n={};return(t={memoizedState:F,baseState:F,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Wi,lastRenderedState:F},next:null}).next={memoizedState:n,baseState:n,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Wi,lastRenderedState:n},next:null},e.memoizedState=t,null!==(e=e.alternate)&&(e.memoizedState=t),t}function Ls(e){zs(e,Ms(e).next.queue,{},Uc())}function Us(){return Ro(Yd)}function Os(){return zi().memoizedState}function Ds(){return zi().memoizedState}function Ns(e){for(var t=e.return;null!==t;){switch(t.tag){case 24:case 3:var n=Uc(),r=li(t,e=ai(n),n);return null!==r&&(Dc(r,t,n),ci(r,t,n)),t={cache:Uo()},void(e.payload=t)}t=t.return}}function js(e,t,n){var r=Uc();n={lane:r,revertLane:0,action:n,hasEagerState:!1,eagerState:null,next:null},Gs(e)?Vs(t,n):null!==(n=Pr(e,t,n,r))&&(Dc(n,e,r),Ws(n,t,r))}function Qs(e,t,n){zs(e,t,n,Uc())}function zs(e,t,n,r){var o={lane:r,revertLane:0,action:n,hasEagerState:!1,eagerState:null,next:null};if(Gs(e))Vs(t,o);else{var i=e.alternate;if(0===e.lanes&&(null===i||0===i.lanes)&&null!==(i=t.lastRenderedReducer))try{var s=t.lastRenderedState,a=i(s,n);if(o.hasEagerState=!0,o.eagerState=a,qn(a,s))return Tr(e,t,o,0),null===ic&&kr(),!1}catch(l){}if(null!==(n=Pr(e,t,o,r)))return Dc(n,e,r),Ws(n,t,r),!0}return!1}function Hs(e,t,n,o){if(o={lane:2,revertLane:Tu(),action:o,hasEagerState:!1,eagerState:null,next:null},Gs(e)){if(t)throw Error(r(479))}else null!==(t=Pr(e,n,o,2))&&Dc(t,e,2)}function Gs(e){var t=e.alternate;return e===xi||null!==t&&t===xi}function Vs(e,t){Ei=Si=!0;var n=e.pending;null===n?t.next=t:(t.next=n.next,n.next=t),e.pending=t}function Ws(e,t,n){if(4194048&n){var r=t.lanes;n|=r&=e.pendingLanes,t.lanes=n,Se(e,n)}}var $s={readContext:Ro,use:Gi,useCallback:Pi,useContext:Pi,useEffect:Pi,useImperativeHandle:Pi,useLayoutEffect:Pi,useInsertionEffect:Pi,useMemo:Pi,useReducer:Pi,useRef:Pi,useState:Pi,useDebugValue:Pi,useDeferredValue:Pi,useTransition:Pi,useSyncExternalStore:Pi,useId:Pi,useHostTransitionStatus:Pi,useFormState:Pi,useActionState:Pi,useOptimistic:Pi,useMemoCache:Pi,useCacheRefresh:Pi},Ks={readContext:Ro,use:Gi,useCallback:function(e,t){return Qi().memoizedState=[e,void 0===t?null:t],e},useContext:Ro,useEffect:bs,useImperativeHandle:function(e,t,n){n=null!=n?n.concat([e]):null,ys(4194308,4,Cs.bind(null,t,e),n)},useLayoutEffect:function(e,t){return ys(4194308,4,e,t)},useInsertionEffect:function(e,t){ys(4,2,e,t)},useMemo:function(e,t){var n=Qi();t=void 0===t?null:t;var r=e();if(Bi){ce(!0);try{e()}finally{ce(!1)}}return n.memoizedState=[r,t],r},useReducer:function(e,t,n){var r=Qi();if(void 0!==n){var o=n(t);if(Bi){ce(!0);try{n(t)}finally{ce(!1)}}}else o=t;return r.memoizedState=r.baseState=o,e={pending:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:o},r.queue=e,e=e.dispatch=js.bind(null,xi,e),[r.memoizedState,e]},useRef:function(e){return e={current:e},Qi().memoizedState=e},useState:function(e){var t=(e=ns(e)).queue,n=Qs.bind(null,xi,t);return t.dispatch=n,[e.memoizedState,n]},useDebugValue:Es,useDeferredValue:function(e,t){return Rs(Qi(),e,t)},useTransition:function(){var e=ns(!1);return e=Ts.bind(null,xi,e.queue,!0,!1),Qi().memoizedState=e,[!1,e]},useSyncExternalStore:function(e,t,n){var o=xi,i=Qi();if(ao){if(void 0===n)throw Error(r(407));n=n()}else{if(n=t(),null===ic)throw Error(r(349));124&ac||qi(o,t,n)}i.memoizedState=n;var s={value:n,getSnapshot:t};return i.queue=s,bs(Zi.bind(null,o,s,e),[e]),o.flags|=2048,gs(9,{destroy:void 0,resource:void 0},Ji.bind(null,o,s,n,t),null),n},useId:function(){var e=Qi(),t=ic.identifierPrefix;if(ao){var n=eo;t=""+t+"R"+(n=(Zr&~(1<<32-ue(Zr)-1)).toString(32)+n),0<(n=Ii++)&&(t+="H"+n.toString(32)),t+=""}else t=""+t+"r"+(n=Ti++).toString(32)+"";return e.memoizedState=t},useHostTransitionStatus:Us,useFormState:ds,useActionState:ds,useOptimistic:function(e){var t=Qi();t.memoizedState=t.baseState=e;var n={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return t.queue=n,t=Hs.bind(null,xi,!0,n),n.dispatch=t,[e,t]},useMemoCache:Vi,useCacheRefresh:function(){return Qi().memoizedState=Ns.bind(null,xi)}},Xs={readContext:Ro,use:Gi,useCallback:Bs,useContext:Ro,useEffect:ws,useImperativeHandle:Ss,useInsertionEffect:xs,useLayoutEffect:_s,useMemo:Is,useReducer:$i,useRef:ms,useState:function(){return $i(Wi)},useDebugValue:Es,useDeferredValue:function(e,t){return ks(zi(),_i.memoizedState,e,t)},useTransition:function(){var e=$i(Wi)[0],t=zi().memoizedState;return["boolean"==typeof e?e:Hi(e),t]},useSyncExternalStore:Yi,useId:Os,useHostTransitionStatus:Us,useFormState:As,useActionState:As,useOptimistic:function(e,t){return rs(zi(),0,e,t)},useMemoCache:Vi,useCacheRefresh:Ds},Ys={readContext:Ro,use:Gi,useCallback:Bs,useContext:Ro,useEffect:ws,useImperativeHandle:Ss,useInsertionEffect:xs,useLayoutEffect:_s,useMemo:Is,useReducer:Xi,useRef:ms,useState:function(){return Xi(Wi)},useDebugValue:Es,useDeferredValue:function(e,t){var n=zi();return null===_i?Rs(n,e,t):ks(n,_i.memoizedState,e,t)},useTransition:function(){var e=Xi(Wi)[0],t=zi().memoizedState;return["boolean"==typeof e?e:Hi(e),t]},useSyncExternalStore:Yi,useId:Os,useHostTransitionStatus:Us,useFormState:fs,useActionState:fs,useOptimistic:function(e,t){var n=zi();return null!==_i?rs(n,0,e,t):(n.baseState=e,[e,n.queue.dispatch])},useMemoCache:Vi,useCacheRefresh:Ds},qs=null,Js=0;function Zs(e){var t=Js;return Js+=1,null===qs&&(qs=[]),ei(qs,e,t)}function ea(e,t){t=t.props.ref,e.ref=void 0!==t?t:null}function ta(e,t){if(t.$$typeof===u)throw Error(r(525));throw e=Object.prototype.toString.call(t),Error(r(31,"[object Object]"===e?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function na(e){return(0,e._init)(e._payload)}function ra(e){function t(t,n){if(e){var r=t.deletions;null===r?(t.deletions=[n],t.flags|=16):r.push(n)}}function n(n,r){if(!e)return null;for(;null!==r;)t(n,r),r=r.sibling;return null}function o(e){for(var t=new Map;null!==e;)null!==e.key?t.set(e.key,e):t.set(e.index,e),e=e.sibling;return t}function i(e,t){return(e=jr(e,t)).index=0,e.sibling=null,e}function s(t,n,r){return t.index=r,e?null!==(r=t.alternate)?(r=r.index)<n?(t.flags|=67108866,n):r:(t.flags|=67108866,n):(t.flags|=1048576,n)}function a(t){return e&&null===t.alternate&&(t.flags|=67108866),t}function l(e,t,n,r){return null===t||6!==t.tag?((t=Gr(n,e.mode,r)).return=e,t):((t=i(t,n)).return=e,t)}function c(e,t,n,r){var o=n.type;return o===h?p(e,t,n.props.children,r,n.key):null!==t&&(t.elementType===o||"object"==typeof o&&null!==o&&o.$$typeof===_&&na(o)===t.type)?(ea(t=i(t,n.props),n),t.return=e,t):(ea(t=zr(n.type,n.key,n.props,null,e.mode,r),n),t.return=e,t)}function u(e,t,n,r){return null===t||4!==t.tag||t.stateNode.containerInfo!==n.containerInfo||t.stateNode.implementation!==n.implementation?((t=Vr(n,e.mode,r)).return=e,t):((t=i(t,n.children||[])).return=e,t)}function p(e,t,n,r,o){return null===t||7!==t.tag?((t=Hr(n,e.mode,r,o)).return=e,t):((t=i(t,n)).return=e,t)}function f(e,t,n){if("string"==typeof t&&""!==t||"number"==typeof t||"bigint"==typeof t)return(t=Gr(""+t,e.mode,n)).return=e,t;if("object"==typeof t&&null!==t){switch(t.$$typeof){case d:return ea(n=zr(t.type,t.key,t.props,null,e.mode,n),t),n.return=e,n;case A:return(t=Vr(t,e.mode,n)).return=e,t;case _:return f(e,t=(0,t._init)(t._payload),n)}if(k(t)||B(t))return(t=Hr(t,e.mode,n,null)).return=e,t;if("function"==typeof t.then)return f(e,Zs(t),n);if(t.$$typeof===y)return f(e,ko(e,t),n);ta(e,t)}return null}function g(e,t,n,r){var o=null!==t?t.key:null;if("string"==typeof n&&""!==n||"number"==typeof n||"bigint"==typeof n)return null!==o?null:l(e,t,""+n,r);if("object"==typeof n&&null!==n){switch(n.$$typeof){case d:return n.key===o?c(e,t,n,r):null;case A:return n.key===o?u(e,t,n,r):null;case _:return g(e,t,n=(o=n._init)(n._payload),r)}if(k(n)||B(n))return null!==o?null:p(e,t,n,r,null);if("function"==typeof n.then)return g(e,t,Zs(n),r);if(n.$$typeof===y)return g(e,t,ko(e,n),r);ta(e,n)}return null}function m(e,t,n,r,o){if("string"==typeof r&&""!==r||"number"==typeof r||"bigint"==typeof r)return l(t,e=e.get(n)||null,""+r,o);if("object"==typeof r&&null!==r){switch(r.$$typeof){case d:return c(t,e=e.get(null===r.key?n:r.key)||null,r,o);case A:return u(t,e=e.get(null===r.key?n:r.key)||null,r,o);case _:return m(e,t,n,r=(0,r._init)(r._payload),o)}if(k(r)||B(r))return p(t,e=e.get(n)||null,r,o,null);if("function"==typeof r.then)return m(e,t,n,Zs(r),o);if(r.$$typeof===y)return m(e,t,n,ko(t,r),o);ta(t,r)}return null}function v(l,c,u,p){if("object"==typeof u&&null!==u&&u.type===h&&null===u.key&&(u=u.props.children),"object"==typeof u&&null!==u){switch(u.$$typeof){case d:e:{for(var b=u.key;null!==c;){if(c.key===b){if((b=u.type)===h){if(7===c.tag){n(l,c.sibling),(p=i(c,u.props.children)).return=l,l=p;break e}}else if(c.elementType===b||"object"==typeof b&&null!==b&&b.$$typeof===_&&na(b)===c.type){n(l,c.sibling),ea(p=i(c,u.props),u),p.return=l,l=p;break e}n(l,c);break}t(l,c),c=c.sibling}u.type===h?((p=Hr(u.props.children,l.mode,p,u.key)).return=l,l=p):(ea(p=zr(u.type,u.key,u.props,null,l.mode,p),u),p.return=l,l=p)}return a(l);case A:e:{for(b=u.key;null!==c;){if(c.key===b){if(4===c.tag&&c.stateNode.containerInfo===u.containerInfo&&c.stateNode.implementation===u.implementation){n(l,c.sibling),(p=i(c,u.children||[])).return=l,l=p;break e}n(l,c);break}t(l,c),c=c.sibling}(p=Vr(u,l.mode,p)).return=l,l=p}return a(l);case _:return v(l,c,u=(b=u._init)(u._payload),p)}if(k(u))return function(r,i,a,l){for(var c=null,u=null,d=i,A=i=0,h=null;null!==d&&A<a.length;A++){d.index>A?(h=d,d=null):h=d.sibling;var p=g(r,d,a[A],l);if(null===p){null===d&&(d=h);break}e&&d&&null===p.alternate&&t(r,d),i=s(p,i,A),null===u?c=p:u.sibling=p,u=p,d=h}if(A===a.length)return n(r,d),ao&&to(r,A),c;if(null===d){for(;A<a.length;A++)null!==(d=f(r,a[A],l))&&(i=s(d,i,A),null===u?c=d:u.sibling=d,u=d);return ao&&to(r,A),c}for(d=o(d);A<a.length;A++)null!==(h=m(d,r,A,a[A],l))&&(e&&null!==h.alternate&&d.delete(null===h.key?A:h.key),i=s(h,i,A),null===u?c=h:u.sibling=h,u=h);return e&&d.forEach(function(e){return t(r,e)}),ao&&to(r,A),c}(l,c,u,p);if(B(u)){if("function"!=typeof(b=B(u)))throw Error(r(150));return function(i,a,l,c){if(null==l)throw Error(r(151));for(var u=null,d=null,A=a,h=a=0,p=null,y=l.next();null!==A&&!y.done;h++,y=l.next()){A.index>h?(p=A,A=null):p=A.sibling;var v=g(i,A,y.value,c);if(null===v){null===A&&(A=p);break}e&&A&&null===v.alternate&&t(i,A),a=s(v,a,h),null===d?u=v:d.sibling=v,d=v,A=p}if(y.done)return n(i,A),ao&&to(i,h),u;if(null===A){for(;!y.done;h++,y=l.next())null!==(y=f(i,y.value,c))&&(a=s(y,a,h),null===d?u=y:d.sibling=y,d=y);return ao&&to(i,h),u}for(A=o(A);!y.done;h++,y=l.next())null!==(y=m(A,i,h,y.value,c))&&(e&&null!==y.alternate&&A.delete(null===y.key?h:y.key),a=s(y,a,h),null===d?u=y:d.sibling=y,d=y);return e&&A.forEach(function(e){return t(i,e)}),ao&&to(i,h),u}(l,c,u=b.call(u),p)}if("function"==typeof u.then)return v(l,c,Zs(u),p);if(u.$$typeof===y)return v(l,c,ko(l,u),p);ta(l,u)}return"string"==typeof u&&""!==u||"number"==typeof u||"bigint"==typeof u?(u=""+u,null!==c&&6===c.tag?(n(l,c.sibling),(p=i(c,u)).return=l,l=p):(n(l,c),(p=Gr(u,l.mode,p)).return=l,l=p),a(l)):n(l,c)}return function(e,t,n,r){try{Js=0;var o=v(e,t,n,r);return qs=null,o}catch(s){if(s===Ko||s===Yo)throw s;var i=Dr(29,s,null,e.mode);return i.lanes=r,i.return=e,i}}}var oa=ra(!0),ia=ra(!1),sa=U(null),aa=null;function la(e){var t=e.alternate;D(Aa,1&Aa.current),D(sa,e),null===aa&&(null===t||null!==gi.current||null!==t.memoizedState)&&(aa=e)}function ca(e){if(22===e.tag){if(D(Aa,Aa.current),D(sa,e),null===aa){var t=e.alternate;null!==t&&null!==t.memoizedState&&(aa=e)}}else ua()}function ua(){D(Aa,Aa.current),D(sa,sa.current)}function da(e){O(sa),aa===e&&(aa=null),O(Aa)}var Aa=U(0);function ha(e){for(var t=e;null!==t;){if(13===t.tag){var n=t.memoizedState;if(null!==n&&(null===(n=n.dehydrated)||"$?"===n.data||yd(n)))return t}else if(19===t.tag&&void 0!==t.memoizedProps.revealOrder){if(128&t.flags)return t}else if(null!==t.child){t.child.return=t,t=t.child;continue}if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}function pa(e,t,n,r){n=null==(n=n(r,t=e.memoizedState))?t:c({},t,n),e.memoizedState=n,0===e.lanes&&(e.updateQueue.baseState=n)}var fa={enqueueSetState:function(e,t,n){e=e._reactInternals;var r=Uc(),o=ai(r);o.payload=t,null!=n&&(o.callback=n),null!==(t=li(e,o,r))&&(Dc(t,e,r),ci(t,e,r))},enqueueReplaceState:function(e,t,n){e=e._reactInternals;var r=Uc(),o=ai(r);o.tag=1,o.payload=t,null!=n&&(o.callback=n),null!==(t=li(e,o,r))&&(Dc(t,e,r),ci(t,e,r))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var n=Uc(),r=ai(n);r.tag=2,null!=t&&(r.callback=t),null!==(t=li(e,r,n))&&(Dc(t,e,n),ci(t,e,n))}};function ga(e,t,n,r,o,i,s){return"function"==typeof(e=e.stateNode).shouldComponentUpdate?e.shouldComponentUpdate(r,i,s):!t.prototype||!t.prototype.isPureReactComponent||(!Jn(n,r)||!Jn(o,i))}function ma(e,t,n,r){e=t.state,"function"==typeof t.componentWillReceiveProps&&t.componentWillReceiveProps(n,r),"function"==typeof t.UNSAFE_componentWillReceiveProps&&t.UNSAFE_componentWillReceiveProps(n,r),t.state!==e&&fa.enqueueReplaceState(t,t.state,null)}function ya(e,t){var n=t;if("ref"in t)for(var r in n={},t)"ref"!==r&&(n[r]=t[r]);if(e=e.defaultProps)for(var o in n===t&&(n=c({},n)),e)void 0===n[o]&&(n[o]=e[o]);return n}var va="function"==typeof reportError?reportError:function(e){if("object"==typeof window&&"function"==typeof window.ErrorEvent){var t=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:"object"==typeof e&&null!==e&&"string"==typeof e.message?String(e.message):String(e),error:e});if(!window.dispatchEvent(t))return}else if("object"==typeof process&&"function"==typeof process.emit)return void process.emit("uncaughtException",e)};function ba(e){va(e)}function wa(e){}function xa(e){va(e)}function _a(e,t){try{(0,e.onUncaughtError)(t.value,{componentStack:t.stack})}catch(n){setTimeout(function(){throw n})}}function Ca(e,t,n){try{(0,e.onCaughtError)(n.value,{componentStack:n.stack,errorBoundary:1===t.tag?t.stateNode:null})}catch(r){setTimeout(function(){throw r})}}function Sa(e,t,n){return(n=ai(n)).tag=3,n.payload={element:null},n.callback=function(){_a(e,t)},n}function Ea(e){return(e=ai(e)).tag=3,e}function Ba(e,t,n,r){var o=n.type.getDerivedStateFromError;if("function"==typeof o){var i=r.value;e.payload=function(){return o(i)},e.callback=function(){Ca(t,n,r)}}var s=n.stateNode;null!==s&&"function"==typeof s.componentDidCatch&&(e.callback=function(){Ca(t,n,r),"function"!=typeof o&&(null===Ec?Ec=new Set([this]):Ec.add(this));var e=r.stack;this.componentDidCatch(r.value,{componentStack:null!==e?e:""})})}var Ia=Error(r(461)),Ra=!1;function ka(e,t,n,r){t.child=null===e?ia(t,null,n,r):oa(t,e.child,n,r)}function Ta(e,t,n,r,o){n=n.render;var i=t.ref;if("ref"in r){var s={};for(var a in r)"ref"!==a&&(s[a]=r[a])}else s=r;return Io(t),r=Mi(e,t,n,s,i,o),a=Di(),null===e||Ra?(ao&&a&&ro(t),t.flags|=1,ka(e,t,r,o),t.child):(Ni(e,t,o),qa(e,t,o))}function Pa(e,t,n,r,o){if(null===e){var i=n.type;return"function"!=typeof i||Nr(i)||void 0!==i.defaultProps||null!==n.compare?((e=zr(n.type,null,r,t,t.mode,o)).ref=t.ref,e.return=t,t.child=e):(t.tag=15,t.type=i,Fa(e,t,i,r,o))}if(i=e.child,!Ja(e,o)){var s=i.memoizedProps;if((n=null!==(n=n.compare)?n:Jn)(s,r)&&e.ref===t.ref)return qa(e,t,o)}return t.flags|=1,(e=jr(i,r)).ref=t.ref,e.return=t,t.child=e}function Fa(e,t,n,r,o){if(null!==e){var i=e.memoizedProps;if(Jn(i,r)&&e.ref===t.ref){if(Ra=!1,t.pendingProps=r=i,!Ja(e,o))return t.lanes=e.lanes,qa(e,t,o);131072&e.flags&&(Ra=!0)}}return Oa(e,t,n,r,o)}function Ma(e,t,n){var r=t.pendingProps,o=r.children,i=null!==e?e.memoizedState:null;if("hidden"===r.mode){if(128&t.flags){if(r=null!==i?i.baseLanes|n:n,null!==e){for(o=t.child=e.child,i=0;null!==o;)i=i|o.lanes|o.childLanes,o=o.sibling;t.childLanes=i&~r}else t.childLanes=0,t.child=null;return La(e,t,r,n)}if(!(536870912&n))return t.lanes=t.childLanes=536870912,La(e,t,null!==i?i.baseLanes|n:n,n);t.memoizedState={baseLanes:0,cachePool:null},null!==e&&Wo(0,null!==i?i.cachePool:null),null!==i?yi(t,i):vi(),ca(t)}else null!==i?(Wo(0,i.cachePool),yi(t,i),ua(),t.memoizedState=null):(null!==e&&Wo(0,null),vi(),ua());return ka(e,t,o,n),t.child}function La(e,t,n,r){var o=Vo();return o=null===o?null:{parent:Lo._currentValue,pool:o},t.memoizedState={baseLanes:n,cachePool:o},null!==e&&Wo(0,null),vi(),ca(t),null!==e&&Eo(e,t,r,!0),null}function Ua(e,t){var n=t.ref;if(null===n)null!==e&&null!==e.ref&&(t.flags|=4194816);else{if("function"!=typeof n&&"object"!=typeof n)throw Error(r(284));null!==e&&e.ref===n||(t.flags|=4194816)}}function Oa(e,t,n,r,o){return Io(t),n=Mi(e,t,n,r,void 0,o),r=Di(),null===e||Ra?(ao&&r&&ro(t),t.flags|=1,ka(e,t,n,o),t.child):(Ni(e,t,o),qa(e,t,o))}function Da(e,t,n,r,o,i){return Io(t),t.updateQueue=null,n=Ui(t,r,n,o),Li(e),r=Di(),null===e||Ra?(ao&&r&&ro(t),t.flags|=1,ka(e,t,n,i),t.child):(Ni(e,t,i),qa(e,t,i))}function Na(e,t,n,r,o){if(Io(t),null===t.stateNode){var i=Ur,s=n.contextType;"object"==typeof s&&null!==s&&(i=Ro(s)),i=new n(r,i),t.memoizedState=null!==i.state&&void 0!==i.state?i.state:null,i.updater=fa,t.stateNode=i,i._reactInternals=t,(i=t.stateNode).props=r,i.state=t.memoizedState,i.refs={},ii(t),s=n.contextType,i.context="object"==typeof s&&null!==s?Ro(s):Ur,i.state=t.memoizedState,"function"==typeof(s=n.getDerivedStateFromProps)&&(pa(t,n,s,r),i.state=t.memoizedState),"function"==typeof n.getDerivedStateFromProps||"function"==typeof i.getSnapshotBeforeUpdate||"function"!=typeof i.UNSAFE_componentWillMount&&"function"!=typeof i.componentWillMount||(s=i.state,"function"==typeof i.componentWillMount&&i.componentWillMount(),"function"==typeof i.UNSAFE_componentWillMount&&i.UNSAFE_componentWillMount(),s!==i.state&&fa.enqueueReplaceState(i,i.state,null),hi(t,r,i,o),Ai(),i.state=t.memoizedState),"function"==typeof i.componentDidMount&&(t.flags|=4194308),r=!0}else if(null===e){i=t.stateNode;var a=t.memoizedProps,l=ya(n,a);i.props=l;var c=i.context,u=n.contextType;s=Ur,"object"==typeof u&&null!==u&&(s=Ro(u));var d=n.getDerivedStateFromProps;u="function"==typeof d||"function"==typeof i.getSnapshotBeforeUpdate,a=t.pendingProps!==a,u||"function"!=typeof i.UNSAFE_componentWillReceiveProps&&"function"!=typeof i.componentWillReceiveProps||(a||c!==s)&&ma(t,i,r,s),oi=!1;var A=t.memoizedState;i.state=A,hi(t,r,i,o),Ai(),c=t.memoizedState,a||A!==c||oi?("function"==typeof d&&(pa(t,n,d,r),c=t.memoizedState),(l=oi||ga(t,n,l,r,A,c,s))?(u||"function"!=typeof i.UNSAFE_componentWillMount&&"function"!=typeof i.componentWillMount||("function"==typeof i.componentWillMount&&i.componentWillMount(),"function"==typeof i.UNSAFE_componentWillMount&&i.UNSAFE_componentWillMount()),"function"==typeof i.componentDidMount&&(t.flags|=4194308)):("function"==typeof i.componentDidMount&&(t.flags|=4194308),t.memoizedProps=r,t.memoizedState=c),i.props=r,i.state=c,i.context=s,r=l):("function"==typeof i.componentDidMount&&(t.flags|=4194308),r=!1)}else{i=t.stateNode,si(e,t),u=ya(n,s=t.memoizedProps),i.props=u,d=t.pendingProps,A=i.context,c=n.contextType,l=Ur,"object"==typeof c&&null!==c&&(l=Ro(c)),(c="function"==typeof(a=n.getDerivedStateFromProps)||"function"==typeof i.getSnapshotBeforeUpdate)||"function"!=typeof i.UNSAFE_componentWillReceiveProps&&"function"!=typeof i.componentWillReceiveProps||(s!==d||A!==l)&&ma(t,i,r,l),oi=!1,A=t.memoizedState,i.state=A,hi(t,r,i,o),Ai();var h=t.memoizedState;s!==d||A!==h||oi||null!==e&&null!==e.dependencies&&Bo(e.dependencies)?("function"==typeof a&&(pa(t,n,a,r),h=t.memoizedState),(u=oi||ga(t,n,u,r,A,h,l)||null!==e&&null!==e.dependencies&&Bo(e.dependencies))?(c||"function"!=typeof i.UNSAFE_componentWillUpdate&&"function"!=typeof i.componentWillUpdate||("function"==typeof i.componentWillUpdate&&i.componentWillUpdate(r,h,l),"function"==typeof i.UNSAFE_componentWillUpdate&&i.UNSAFE_componentWillUpdate(r,h,l)),"function"==typeof i.componentDidUpdate&&(t.flags|=4),"function"==typeof i.getSnapshotBeforeUpdate&&(t.flags|=1024)):("function"!=typeof i.componentDidUpdate||s===e.memoizedProps&&A===e.memoizedState||(t.flags|=4),"function"!=typeof i.getSnapshotBeforeUpdate||s===e.memoizedProps&&A===e.memoizedState||(t.flags|=1024),t.memoizedProps=r,t.memoizedState=h),i.props=r,i.state=h,i.context=l,r=u):("function"!=typeof i.componentDidUpdate||s===e.memoizedProps&&A===e.memoizedState||(t.flags|=4),"function"!=typeof i.getSnapshotBeforeUpdate||s===e.memoizedProps&&A===e.memoizedState||(t.flags|=1024),r=!1)}return i=r,Ua(e,t),r=!!(128&t.flags),i||r?(i=t.stateNode,n=r&&"function"!=typeof n.getDerivedStateFromError?null:i.render(),t.flags|=1,null!==e&&r?(t.child=oa(t,e.child,null,o),t.child=oa(t,null,n,o)):ka(e,t,n,o),t.memoizedState=i.state,e=t.child):e=qa(e,t,o),e}function ja(e,t,n,r){return go(),t.flags|=256,ka(e,t,n,r),t.child}var Qa={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function za(e){return{baseLanes:e,cachePool:$o()}}function Ha(e,t,n){return e=null!==e?e.childLanes&~n:0,t&&(e|=yc),e}function Ga(e,t,n){var o,i=t.pendingProps,s=!1,a=!!(128&t.flags);if((o=a)||(o=(null===e||null!==e.memoizedState)&&!!(2&Aa.current)),o&&(s=!0,t.flags&=-129),o=!!(32&t.flags),t.flags&=-33,null===e){if(ao){if(s?la(t):ua(),ao){var l,c=so;if(l=c){e:{for(l=c,c=co;8!==l.nodeType;){if(!c){c=null;break e}if(null===(l=vd(l.nextSibling))){c=null;break e}}c=l}null!==c?(t.memoizedState={dehydrated:c,treeContext:null!==Jr?{id:Zr,overflow:eo}:null,retryLane:536870912,hydrationErrors:null},(l=Dr(18,null,null,0)).stateNode=c,l.return=t,t.child=l,io=t,so=null,l=!0):l=!1}l||Ao(t)}if(null!==(c=t.memoizedState)&&null!==(c=c.dehydrated))return yd(c)?t.lanes=32:t.lanes=536870912,null;da(t)}return c=i.children,i=i.fallback,s?(ua(),c=Wa({mode:"hidden",children:c},s=t.mode),i=Hr(i,s,n,null),c.return=t,i.return=t,c.sibling=i,t.child=c,(s=t.child).memoizedState=za(n),s.childLanes=Ha(e,o,n),t.memoizedState=Qa,i):(la(t),Va(t,c))}if(null!==(l=e.memoizedState)&&null!==(c=l.dehydrated)){if(a)256&t.flags?(la(t),t.flags&=-257,t=$a(e,t,n)):null!==t.memoizedState?(ua(),t.child=e.child,t.flags|=128,t=null):(ua(),s=i.fallback,c=t.mode,i=Wa({mode:"visible",children:i.children},c),(s=Hr(s,c,n,null)).flags|=2,i.return=t,s.return=t,i.sibling=s,t.child=i,oa(t,e.child,null,n),(i=t.child).memoizedState=za(n),i.childLanes=Ha(e,o,n),t.memoizedState=Qa,t=s);else if(la(t),yd(c)){if(o=c.nextSibling&&c.nextSibling.dataset)var u=o.dgst;o=u,(i=Error(r(419))).stack="",i.digest=o,yo({value:i,source:null,stack:null}),t=$a(e,t,n)}else if(Ra||Eo(e,t,n,!1),o=0!==(n&e.childLanes),Ra||o){if(null!==(o=ic)&&(0!==(i=0!==((i=42&(i=n&-n)?1:Ee(i))&(o.suspendedLanes|n))?0:i)&&i!==l.retryLane))throw l.retryLane=i,Fr(e,i),Dc(o,e,i),Ia;"$?"===c.data||Xc(),t=$a(e,t,n)}else"$?"===c.data?(t.flags|=192,t.child=e.child,t=null):(e=l.treeContext,so=vd(c.nextSibling),io=t,ao=!0,lo=null,co=!1,null!==e&&(Yr[qr++]=Zr,Yr[qr++]=eo,Yr[qr++]=Jr,Zr=e.id,eo=e.overflow,Jr=t),(t=Va(t,i.children)).flags|=4096);return t}return s?(ua(),s=i.fallback,c=t.mode,u=(l=e.child).sibling,(i=jr(l,{mode:"hidden",children:i.children})).subtreeFlags=65011712&l.subtreeFlags,null!==u?s=jr(u,s):(s=Hr(s,c,n,null)).flags|=2,s.return=t,i.return=t,i.sibling=s,t.child=i,i=s,s=t.child,null===(c=e.child.memoizedState)?c=za(n):(null!==(l=c.cachePool)?(u=Lo._currentValue,l=l.parent!==u?{parent:u,pool:u}:l):l=$o(),c={baseLanes:c.baseLanes|n,cachePool:l}),s.memoizedState=c,s.childLanes=Ha(e,o,n),t.memoizedState=Qa,i):(la(t),e=(n=e.child).sibling,(n=jr(n,{mode:"visible",children:i.children})).return=t,n.sibling=null,null!==e&&(null===(o=t.deletions)?(t.deletions=[e],t.flags|=16):o.push(e)),t.child=n,t.memoizedState=null,n)}function Va(e,t){return(t=Wa({mode:"visible",children:t},e.mode)).return=e,e.child=t}function Wa(e,t){return(e=Dr(22,e,null,t)).lanes=0,e.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null},e}function $a(e,t,n){return oa(t,e.child,null,n),(e=Va(t,t.pendingProps.children)).flags|=2,t.memoizedState=null,e}function Ka(e,t,n){e.lanes|=t;var r=e.alternate;null!==r&&(r.lanes|=t),Co(e.return,t,n)}function Xa(e,t,n,r,o){var i=e.memoizedState;null===i?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:o}:(i.isBackwards=t,i.rendering=null,i.renderingStartTime=0,i.last=r,i.tail=n,i.tailMode=o)}function Ya(e,t,n){var r=t.pendingProps,o=r.revealOrder,i=r.tail;if(ka(e,t,r.children,n),2&(r=Aa.current))r=1&r|2,t.flags|=128;else{if(null!==e&&128&e.flags)e:for(e=t.child;null!==e;){if(13===e.tag)null!==e.memoizedState&&Ka(e,n,t);else if(19===e.tag)Ka(e,n,t);else if(null!==e.child){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;null===e.sibling;){if(null===e.return||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}r&=1}switch(D(Aa,r),o){case"forwards":for(n=t.child,o=null;null!==n;)null!==(e=n.alternate)&&null===ha(e)&&(o=n),n=n.sibling;null===(n=o)?(o=t.child,t.child=null):(o=n.sibling,n.sibling=null),Xa(t,!1,o,n,i);break;case"backwards":for(n=null,o=t.child,t.child=null;null!==o;){if(null!==(e=o.alternate)&&null===ha(e)){t.child=o;break}e=o.sibling,o.sibling=n,n=o,o=e}Xa(t,!0,n,null,i);break;case"together":Xa(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function qa(e,t,n){if(null!==e&&(t.dependencies=e.dependencies),fc|=t.lanes,0===(n&t.childLanes)){if(null===e)return null;if(Eo(e,t,n,!1),0===(n&t.childLanes))return null}if(null!==e&&t.child!==e.child)throw Error(r(153));if(null!==t.child){for(n=jr(e=t.child,e.pendingProps),t.child=n,n.return=t;null!==e.sibling;)e=e.sibling,(n=n.sibling=jr(e,e.pendingProps)).return=t;n.sibling=null}return t.child}function Ja(e,t){return 0!==(e.lanes&t)||!(null===(e=e.dependencies)||!Bo(e))}function Za(e,t,n){if(null!==e)if(e.memoizedProps!==t.pendingProps)Ra=!0;else{if(!(Ja(e,n)||128&t.flags))return Ra=!1,function(e,t,n){switch(t.tag){case 3:H(t,t.stateNode.containerInfo),xo(0,Lo,e.memoizedState.cache),go();break;case 27:case 5:V(t);break;case 4:H(t,t.stateNode.containerInfo);break;case 10:xo(0,t.type,t.memoizedProps.value);break;case 13:var r=t.memoizedState;if(null!==r)return null!==r.dehydrated?(la(t),t.flags|=128,null):0!==(n&t.child.childLanes)?Ga(e,t,n):(la(t),null!==(e=qa(e,t,n))?e.sibling:null);la(t);break;case 19:var o=!!(128&e.flags);if((r=0!==(n&t.childLanes))||(Eo(e,t,n,!1),r=0!==(n&t.childLanes)),o){if(r)return Ya(e,t,n);t.flags|=128}if(null!==(o=t.memoizedState)&&(o.rendering=null,o.tail=null,o.lastEffect=null),D(Aa,Aa.current),r)break;return null;case 22:case 23:return t.lanes=0,Ma(e,t,n);case 24:xo(0,Lo,e.memoizedState.cache)}return qa(e,t,n)}(e,t,n);Ra=!!(131072&e.flags)}else Ra=!1,ao&&1048576&t.flags&&no(t,Xr,t.index);switch(t.lanes=0,t.tag){case 16:e:{e=t.pendingProps;var o=t.elementType,i=o._init;if(o=i(o._payload),t.type=o,"function"!=typeof o){if(null!=o){if((i=o.$$typeof)===v){t.tag=11,t=Ta(null,t,o,e,n);break e}if(i===x){t.tag=14,t=Pa(null,t,o,e,n);break e}}throw t=R(o)||o,Error(r(306,t,""))}Nr(o)?(e=ya(o,e),t.tag=1,t=Na(null,t,o,e,n)):(t.tag=0,t=Oa(null,t,o,e,n))}return t;case 0:return Oa(e,t,t.type,t.pendingProps,n);case 1:return Na(e,t,o=t.type,i=ya(o,t.pendingProps),n);case 3:e:{if(H(t,t.stateNode.containerInfo),null===e)throw Error(r(387));o=t.pendingProps;var s=t.memoizedState;i=s.element,si(e,t),hi(t,o,null,n);var a=t.memoizedState;if(o=a.cache,xo(0,Lo,o),o!==s.cache&&So(t,[Lo],n,!0),Ai(),o=a.element,s.isDehydrated){if(s={element:o,isDehydrated:!1,cache:a.cache},t.updateQueue.baseState=s,t.memoizedState=s,256&t.flags){t=ja(e,t,o,n);break e}if(o!==i){yo(i=Er(Error(r(424)),t)),t=ja(e,t,o,n);break e}if(9===(e=t.stateNode.containerInfo).nodeType)e=e.body;else e="HTML"===e.nodeName?e.ownerDocument.body:e;for(so=vd(e.firstChild),io=t,ao=!0,lo=null,co=!0,n=ia(t,null,o,n),t.child=n;n;)n.flags=-3&n.flags|4096,n=n.sibling}else{if(go(),o===i){t=qa(e,t,n);break e}ka(e,t,o,n)}t=t.child}return t;case 26:return Ua(e,t),null===e?(n=kd(t.type,null,t.pendingProps,null))?t.memoizedState=n:ao||(n=t.type,e=t.pendingProps,(o=id(Q.current).createElement(n))[ke]=t,o[Te]=e,nd(o,n,e),$e(o),t.stateNode=o):t.memoizedState=kd(t.type,e.memoizedProps,t.pendingProps,e.memoizedState),null;case 27:return V(t),null===e&&ao&&(o=t.stateNode=xd(t.type,t.pendingProps,Q.current),io=t,co=!0,i=so,fd(t.type)?(bd=i,so=vd(o.firstChild)):so=i),ka(e,t,t.pendingProps.children,n),Ua(e,t),null===e&&(t.flags|=4194304),t.child;case 5:return null===e&&ao&&((i=o=so)&&(null!==(o=function(e,t,n,r){for(;1===e.nodeType;){var o=n;if(e.nodeName.toLowerCase()!==t.toLowerCase()){if(!r&&("INPUT"!==e.nodeName||"hidden"!==e.type))break}else if(r){if(!e[je])switch(t){case"meta":if(!e.hasAttribute("itemprop"))break;return e;case"link":if("stylesheet"===(i=e.getAttribute("rel"))&&e.hasAttribute("data-precedence"))break;if(i!==o.rel||e.getAttribute("href")!==(null==o.href||""===o.href?null:o.href)||e.getAttribute("crossorigin")!==(null==o.crossOrigin?null:o.crossOrigin)||e.getAttribute("title")!==(null==o.title?null:o.title))break;return e;case"style":if(e.hasAttribute("data-precedence"))break;return e;case"script":if(((i=e.getAttribute("src"))!==(null==o.src?null:o.src)||e.getAttribute("type")!==(null==o.type?null:o.type)||e.getAttribute("crossorigin")!==(null==o.crossOrigin?null:o.crossOrigin))&&i&&e.hasAttribute("async")&&!e.hasAttribute("itemprop"))break;return e;default:return e}}else{if("input"!==t||"hidden"!==e.type)return e;var i=null==o.name?null:""+o.name;if("hidden"===o.type&&e.getAttribute("name")===i)return e}if(null===(e=vd(e.nextSibling)))break}return null}(o,t.type,t.pendingProps,co))?(t.stateNode=o,io=t,so=vd(o.firstChild),co=!1,i=!0):i=!1),i||Ao(t)),V(t),i=t.type,s=t.pendingProps,a=null!==e?e.memoizedProps:null,o=s.children,ld(i,s)?o=null:null!==a&&ld(i,a)&&(t.flags|=32),null!==t.memoizedState&&(i=Mi(e,t,Oi,null,null,n),Yd._currentValue=i),Ua(e,t),ka(e,t,o,n),t.child;case 6:return null===e&&ao&&((e=n=so)&&(null!==(n=function(e,t,n){if(""===t)return null;for(;3!==e.nodeType;){if((1!==e.nodeType||"INPUT"!==e.nodeName||"hidden"!==e.type)&&!n)return null;if(null===(e=vd(e.nextSibling)))return null}return e}(n,t.pendingProps,co))?(t.stateNode=n,io=t,so=null,e=!0):e=!1),e||Ao(t)),null;case 13:return Ga(e,t,n);case 4:return H(t,t.stateNode.containerInfo),o=t.pendingProps,null===e?t.child=oa(t,null,o,n):ka(e,t,o,n),t.child;case 11:return Ta(e,t,t.type,t.pendingProps,n);case 7:return ka(e,t,t.pendingProps,n),t.child;case 8:case 12:return ka(e,t,t.pendingProps.children,n),t.child;case 10:return o=t.pendingProps,xo(0,t.type,o.value),ka(e,t,o.children,n),t.child;case 9:return i=t.type._context,o=t.pendingProps.children,Io(t),o=o(i=Ro(i)),t.flags|=1,ka(e,t,o,n),t.child;case 14:return Pa(e,t,t.type,t.pendingProps,n);case 15:return Fa(e,t,t.type,t.pendingProps,n);case 19:return Ya(e,t,n);case 31:return o=t.pendingProps,n=t.mode,o={mode:o.mode,children:o.children},null===e?((n=Wa(o,n)).ref=t.ref,t.child=n,n.return=t,t=n):((n=jr(e.child,o)).ref=t.ref,t.child=n,n.return=t,t=n),t;case 22:return Ma(e,t,n);case 24:return Io(t),o=Ro(Lo),null===e?(null===(i=Vo())&&(i=ic,s=Uo(),i.pooledCache=s,s.refCount++,null!==s&&(i.pooledCacheLanes|=n),i=s),t.memoizedState={parent:o,cache:i},ii(t),xo(0,Lo,i)):(0!==(e.lanes&n)&&(si(e,t),hi(t,null,null,n),Ai()),i=e.memoizedState,s=t.memoizedState,i.parent!==o?(i={parent:o,cache:o},t.memoizedState=i,0===t.lanes&&(t.memoizedState=t.updateQueue.baseState=i),xo(0,Lo,o)):(o=s.cache,xo(0,Lo,o),o!==i.cache&&So(t,[Lo],n,!0))),ka(e,t,t.pendingProps.children,n),t.child;case 29:throw t.pendingProps}throw Error(r(156,t.tag))}function el(e){e.flags|=4}function tl(e,t){if("stylesheet"!==t.type||4&t.state.loading)e.flags&=-16777217;else if(e.flags|=16777216,!Hd(t)){if(null!==(t=sa.current)&&((4194048&ac)===ac?null!==aa:(62914560&ac)!==ac&&!(536870912&ac)||t!==aa))throw ti=qo,Xo;e.flags|=8192}}function nl(e,t){null!==t&&(e.flags|=4),16384&e.flags&&(t=22!==e.tag?we():536870912,e.lanes|=t,vc|=t)}function rl(e,t){if(!ao)switch(e.tailMode){case"hidden":t=e.tail;for(var n=null;null!==t;)null!==t.alternate&&(n=t),t=t.sibling;null===n?e.tail=null:n.sibling=null;break;case"collapsed":n=e.tail;for(var r=null;null!==n;)null!==n.alternate&&(r=n),n=n.sibling;null===r?t||null===e.tail?e.tail=null:e.tail.sibling=null:r.sibling=null}}function ol(e){var t=null!==e.alternate&&e.alternate.child===e.child,n=0,r=0;if(t)for(var o=e.child;null!==o;)n|=o.lanes|o.childLanes,r|=65011712&o.subtreeFlags,r|=65011712&o.flags,o.return=e,o=o.sibling;else for(o=e.child;null!==o;)n|=o.lanes|o.childLanes,r|=o.subtreeFlags,r|=o.flags,o.return=e,o=o.sibling;return e.subtreeFlags|=r,e.childLanes=n,t}function il(e,t,n){var o=t.pendingProps;switch(oo(t),t.tag){case 31:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:case 1:return ol(t),null;case 3:return n=t.stateNode,o=null,null!==e&&(o=e.memoizedState.cache),t.memoizedState.cache!==o&&(t.flags|=2048),_o(Lo),G(),n.pendingContext&&(n.context=n.pendingContext,n.pendingContext=null),null!==e&&null!==e.child||(fo(t)?el(t):null===e||e.memoizedState.isDehydrated&&!(256&t.flags)||(t.flags|=1024,mo())),ol(t),null;case 26:return n=t.memoizedState,null===e?(el(t),null!==n?(ol(t),tl(t,n)):(ol(t),t.flags&=-16777217)):n?n!==e.memoizedState?(el(t),ol(t),tl(t,n)):(ol(t),t.flags&=-16777217):(e.memoizedProps!==o&&el(t),ol(t),t.flags&=-16777217),null;case 27:W(t),n=Q.current;var i=t.type;if(null!==e&&null!=t.stateNode)e.memoizedProps!==o&&el(t);else{if(!o){if(null===t.stateNode)throw Error(r(166));return ol(t),null}e=N.current,fo(t)?ho(t):(e=xd(i,o,n),t.stateNode=e,el(t))}return ol(t),null;case 5:if(W(t),n=t.type,null!==e&&null!=t.stateNode)e.memoizedProps!==o&&el(t);else{if(!o){if(null===t.stateNode)throw Error(r(166));return ol(t),null}if(e=N.current,fo(t))ho(t);else{switch(i=id(Q.current),e){case 1:e=i.createElementNS("http://www.w3.org/2000/svg",n);break;case 2:e=i.createElementNS("http://www.w3.org/1998/Math/MathML",n);break;default:switch(n){case"svg":e=i.createElementNS("http://www.w3.org/2000/svg",n);break;case"math":e=i.createElementNS("http://www.w3.org/1998/Math/MathML",n);break;case"script":(e=i.createElement("div")).innerHTML="<script><\/script>",e=e.removeChild(e.firstChild);break;case"select":e="string"==typeof o.is?i.createElement("select",{is:o.is}):i.createElement("select"),o.multiple?e.multiple=!0:o.size&&(e.size=o.size);break;default:e="string"==typeof o.is?i.createElement(n,{is:o.is}):i.createElement(n)}}e[ke]=t,e[Te]=o;e:for(i=t.child;null!==i;){if(5===i.tag||6===i.tag)e.appendChild(i.stateNode);else if(4!==i.tag&&27!==i.tag&&null!==i.child){i.child.return=i,i=i.child;continue}if(i===t)break e;for(;null===i.sibling;){if(null===i.return||i.return===t)break e;i=i.return}i.sibling.return=i.return,i=i.sibling}t.stateNode=e;e:switch(nd(e,n,o),n){case"button":case"input":case"select":case"textarea":e=!!o.autoFocus;break e;case"img":e=!0;break e;default:e=!1}e&&el(t)}}return ol(t),t.flags&=-16777217,null;case 6:if(e&&null!=t.stateNode)e.memoizedProps!==o&&el(t);else{if("string"!=typeof o&&null===t.stateNode)throw Error(r(166));if(e=Q.current,fo(t)){if(e=t.stateNode,n=t.memoizedProps,o=null,null!==(i=io))switch(i.tag){case 27:case 5:o=i.memoizedProps}e[ke]=t,(e=!!(e.nodeValue===n||null!==o&&!0===o.suppressHydrationWarning||Ju(e.nodeValue,n)))||Ao(t)}else(e=id(e).createTextNode(o))[ke]=t,t.stateNode=e}return ol(t),null;case 13:if(o=t.memoizedState,null===e||null!==e.memoizedState&&null!==e.memoizedState.dehydrated){if(i=fo(t),null!==o&&null!==o.dehydrated){if(null===e){if(!i)throw Error(r(318));if(!(i=null!==(i=t.memoizedState)?i.dehydrated:null))throw Error(r(317));i[ke]=t}else go(),!(128&t.flags)&&(t.memoizedState=null),t.flags|=4;ol(t),i=!1}else i=mo(),null!==e&&null!==e.memoizedState&&(e.memoizedState.hydrationErrors=i),i=!0;if(!i)return 256&t.flags?(da(t),t):(da(t),null)}if(da(t),128&t.flags)return t.lanes=n,t;if(n=null!==o,e=null!==e&&null!==e.memoizedState,n){i=null,null!==(o=t.child).alternate&&null!==o.alternate.memoizedState&&null!==o.alternate.memoizedState.cachePool&&(i=o.alternate.memoizedState.cachePool.pool);var s=null;null!==o.memoizedState&&null!==o.memoizedState.cachePool&&(s=o.memoizedState.cachePool.pool),s!==i&&(o.flags|=2048)}return n!==e&&n&&(t.child.flags|=8192),nl(t,t.updateQueue),ol(t),null;case 4:return G(),null===e&&zu(t.stateNode.containerInfo),ol(t),null;case 10:return _o(t.type),ol(t),null;case 19:if(O(Aa),null===(i=t.memoizedState))return ol(t),null;if(o=!!(128&t.flags),null===(s=i.rendering))if(o)rl(i,!1);else{if(0!==pc||null!==e&&128&e.flags)for(e=t.child;null!==e;){if(null!==(s=ha(e))){for(t.flags|=128,rl(i,!1),e=s.updateQueue,t.updateQueue=e,nl(t,e),t.subtreeFlags=0,e=n,n=t.child;null!==n;)Qr(n,e),n=n.sibling;return D(Aa,1&Aa.current|2),t.child}e=e.sibling}null!==i.tail&&J()>Cc&&(t.flags|=128,o=!0,rl(i,!1),t.lanes=4194304)}else{if(!o)if(null!==(e=ha(s))){if(t.flags|=128,o=!0,e=e.updateQueue,t.updateQueue=e,nl(t,e),rl(i,!0),null===i.tail&&"hidden"===i.tailMode&&!s.alternate&&!ao)return ol(t),null}else 2*J()-i.renderingStartTime>Cc&&536870912!==n&&(t.flags|=128,o=!0,rl(i,!1),t.lanes=4194304);i.isBackwards?(s.sibling=t.child,t.child=s):(null!==(e=i.last)?e.sibling=s:t.child=s,i.last=s)}return null!==i.tail?(t=i.tail,i.rendering=t,i.tail=t.sibling,i.renderingStartTime=J(),t.sibling=null,e=Aa.current,D(Aa,o?1&e|2:1&e),t):(ol(t),null);case 22:case 23:return da(t),bi(),o=null!==t.memoizedState,null!==e?null!==e.memoizedState!==o&&(t.flags|=8192):o&&(t.flags|=8192),o?!!(536870912&n)&&!(128&t.flags)&&(ol(t),6&t.subtreeFlags&&(t.flags|=8192)):ol(t),null!==(n=t.updateQueue)&&nl(t,n.retryQueue),n=null,null!==e&&null!==e.memoizedState&&null!==e.memoizedState.cachePool&&(n=e.memoizedState.cachePool.pool),o=null,null!==t.memoizedState&&null!==t.memoizedState.cachePool&&(o=t.memoizedState.cachePool.pool),o!==n&&(t.flags|=2048),null!==e&&O(Go),null;case 24:return n=null,null!==e&&(n=e.memoizedState.cache),t.memoizedState.cache!==n&&(t.flags|=2048),_o(Lo),ol(t),null;case 25:case 30:return null}throw Error(r(156,t.tag))}function sl(e,t){switch(oo(t),t.tag){case 1:return 65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 3:return _o(Lo),G(),65536&(e=t.flags)&&!(128&e)?(t.flags=-65537&e|128,t):null;case 26:case 27:case 5:return W(t),null;case 13:if(da(t),null!==(e=t.memoizedState)&&null!==e.dehydrated){if(null===t.alternate)throw Error(r(340));go()}return 65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 19:return O(Aa),null;case 4:return G(),null;case 10:return _o(t.type),null;case 22:case 23:return da(t),bi(),null!==e&&O(Go),65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 24:return _o(Lo),null;default:return null}}function al(e,t){switch(oo(t),t.tag){case 3:_o(Lo),G();break;case 26:case 27:case 5:W(t);break;case 4:G();break;case 13:da(t);break;case 19:O(Aa);break;case 10:_o(t.type);break;case 22:case 23:da(t),bi(),null!==e&&O(Go);break;case 24:_o(Lo)}}function ll(e,t){try{var n=t.updateQueue,r=null!==n?n.lastEffect:null;if(null!==r){var o=r.next;n=o;do{if((n.tag&e)===e){r=void 0;var i=n.create,s=n.inst;r=i(),s.destroy=r}n=n.next}while(n!==o)}}catch(a){Au(t,t.return,a)}}function cl(e,t,n){try{var r=t.updateQueue,o=null!==r?r.lastEffect:null;if(null!==o){var i=o.next;r=i;do{if((r.tag&e)===e){var s=r.inst,a=s.destroy;if(void 0!==a){s.destroy=void 0,o=t;var l=n,c=a;try{c()}catch(u){Au(o,l,u)}}}r=r.next}while(r!==i)}}catch(u){Au(t,t.return,u)}}function ul(e){var t=e.updateQueue;if(null!==t){var n=e.stateNode;try{fi(t,n)}catch(r){Au(e,e.return,r)}}}function dl(e,t,n){n.props=ya(e.type,e.memoizedProps),n.state=e.memoizedState;try{n.componentWillUnmount()}catch(r){Au(e,t,r)}}function Al(e,t){try{var n=e.ref;if(null!==n){switch(e.tag){case 26:case 27:case 5:var r=e.stateNode;break;default:r=e.stateNode}"function"==typeof n?e.refCleanup=n(r):n.current=r}}catch(o){Au(e,t,o)}}function hl(e,t){var n=e.ref,r=e.refCleanup;if(null!==n)if("function"==typeof r)try{r()}catch(o){Au(e,t,o)}finally{e.refCleanup=null,null!=(e=e.alternate)&&(e.refCleanup=null)}else if("function"==typeof n)try{n(null)}catch(i){Au(e,t,i)}else n.current=null}function pl(e){var t=e.type,n=e.memoizedProps,r=e.stateNode;try{e:switch(t){case"button":case"input":case"select":case"textarea":n.autoFocus&&r.focus();break e;case"img":n.src?r.src=n.src:n.srcSet&&(r.srcset=n.srcSet)}}catch(o){Au(e,e.return,o)}}function fl(e,t,n){try{var o=e.stateNode;!function(e,t,n,o){switch(t){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var i=null,s=null,a=null,l=null,c=null,u=null,d=null;for(p in n){var A=n[p];if(n.hasOwnProperty(p)&&null!=A)switch(p){case"checked":case"value":break;case"defaultValue":c=A;default:o.hasOwnProperty(p)||ed(e,t,p,null,o,A)}}for(var h in o){var p=o[h];if(A=n[h],o.hasOwnProperty(h)&&(null!=p||null!=A))switch(h){case"type":s=p;break;case"name":i=p;break;case"checked":u=p;break;case"defaultChecked":d=p;break;case"value":a=p;break;case"defaultValue":l=p;break;case"children":case"dangerouslySetInnerHTML":if(null!=p)throw Error(r(137,t));break;default:p!==A&&ed(e,t,h,p,o,A)}}return void yt(e,a,l,c,u,d,s,i);case"select":for(s in p=a=l=h=null,n)if(c=n[s],n.hasOwnProperty(s)&&null!=c)switch(s){case"value":break;case"multiple":p=c;default:o.hasOwnProperty(s)||ed(e,t,s,null,o,c)}for(i in o)if(s=o[i],c=n[i],o.hasOwnProperty(i)&&(null!=s||null!=c))switch(i){case"value":h=s;break;case"defaultValue":l=s;break;case"multiple":a=s;default:s!==c&&ed(e,t,i,s,o,c)}return t=l,n=a,o=p,void(null!=h?wt(e,!!n,h,!1):!!o!=!!n&&(null!=t?wt(e,!!n,t,!0):wt(e,!!n,n?[]:"",!1)));case"textarea":for(l in p=h=null,n)if(i=n[l],n.hasOwnProperty(l)&&null!=i&&!o.hasOwnProperty(l))switch(l){case"value":case"children":break;default:ed(e,t,l,null,o,i)}for(a in o)if(i=o[a],s=n[a],o.hasOwnProperty(a)&&(null!=i||null!=s))switch(a){case"value":h=i;break;case"defaultValue":p=i;break;case"children":break;case"dangerouslySetInnerHTML":if(null!=i)throw Error(r(91));break;default:i!==s&&ed(e,t,a,i,o,s)}return void xt(e,h,p);case"option":for(var f in n)if(h=n[f],n.hasOwnProperty(f)&&null!=h&&!o.hasOwnProperty(f))if("selected"===f)e.selected=!1;else ed(e,t,f,null,o,h);for(c in o)if(h=o[c],p=n[c],o.hasOwnProperty(c)&&h!==p&&(null!=h||null!=p))if("selected"===c)e.selected=h&&"function"!=typeof h&&"symbol"!=typeof h;else ed(e,t,c,h,o,p);return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var g in n)h=n[g],n.hasOwnProperty(g)&&null!=h&&!o.hasOwnProperty(g)&&ed(e,t,g,null,o,h);for(u in o)if(h=o[u],p=n[u],o.hasOwnProperty(u)&&h!==p&&(null!=h||null!=p))switch(u){case"children":case"dangerouslySetInnerHTML":if(null!=h)throw Error(r(137,t));break;default:ed(e,t,u,h,o,p)}return;default:if(It(t)){for(var m in n)h=n[m],n.hasOwnProperty(m)&&void 0!==h&&!o.hasOwnProperty(m)&&td(e,t,m,void 0,o,h);for(d in o)h=o[d],p=n[d],!o.hasOwnProperty(d)||h===p||void 0===h&&void 0===p||td(e,t,d,h,o,p);return}}for(var y in n)h=n[y],n.hasOwnProperty(y)&&null!=h&&!o.hasOwnProperty(y)&&ed(e,t,y,null,o,h);for(A in o)h=o[A],p=n[A],!o.hasOwnProperty(A)||h===p||null==h&&null==p||ed(e,t,A,h,o,p)}(o,e.type,n,t),o[Te]=t}catch(i){Au(e,e.return,i)}}function gl(e){return 5===e.tag||3===e.tag||26===e.tag||27===e.tag&&fd(e.type)||4===e.tag}function ml(e){e:for(;;){for(;null===e.sibling;){if(null===e.return||gl(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;5!==e.tag&&6!==e.tag&&18!==e.tag;){if(27===e.tag&&fd(e.type))continue e;if(2&e.flags)continue e;if(null===e.child||4===e.tag)continue e;e.child.return=e,e=e.child}if(!(2&e.flags))return e.stateNode}}function yl(e,t,n){var r=e.tag;if(5===r||6===r)e=e.stateNode,t?(9===n.nodeType?n.body:"HTML"===n.nodeName?n.ownerDocument.body:n).insertBefore(e,t):((t=9===n.nodeType?n.body:"HTML"===n.nodeName?n.ownerDocument.body:n).appendChild(e),null!=(n=n._reactRootContainer)||null!==t.onclick||(t.onclick=Zu));else if(4!==r&&(27===r&&fd(e.type)&&(n=e.stateNode,t=null),null!==(e=e.child)))for(yl(e,t,n),e=e.sibling;null!==e;)yl(e,t,n),e=e.sibling}function vl(e,t,n){var r=e.tag;if(5===r||6===r)e=e.stateNode,t?n.insertBefore(e,t):n.appendChild(e);else if(4!==r&&(27===r&&fd(e.type)&&(n=e.stateNode),null!==(e=e.child)))for(vl(e,t,n),e=e.sibling;null!==e;)vl(e,t,n),e=e.sibling}function bl(e){var t=e.stateNode,n=e.memoizedProps;try{for(var r=e.type,o=t.attributes;o.length;)t.removeAttributeNode(o[0]);nd(t,r,n),t[ke]=e,t[Te]=n}catch(i){Au(e,e.return,i)}}var wl=!1,xl=!1,_l=!1,Cl="function"==typeof WeakSet?WeakSet:Set,Sl=null;function El(e,t,n){var r=n.flags;switch(n.tag){case 0:case 11:case 15:Nl(e,n),4&r&&ll(5,n);break;case 1:if(Nl(e,n),4&r)if(e=n.stateNode,null===t)try{e.componentDidMount()}catch(s){Au(n,n.return,s)}else{var o=ya(n.type,t.memoizedProps);t=t.memoizedState;try{e.componentDidUpdate(o,t,e.__reactInternalSnapshotBeforeUpdate)}catch(a){Au(n,n.return,a)}}64&r&&ul(n),512&r&&Al(n,n.return);break;case 3:if(Nl(e,n),64&r&&null!==(e=n.updateQueue)){if(t=null,null!==n.child)switch(n.child.tag){case 27:case 5:case 1:t=n.child.stateNode}try{fi(e,t)}catch(s){Au(n,n.return,s)}}break;case 27:null===t&&4&r&&bl(n);case 26:case 5:Nl(e,n),null===t&&4&r&&pl(n),512&r&&Al(n,n.return);break;case 12:Nl(e,n);break;case 13:Nl(e,n),4&r&&Pl(e,n),64&r&&(null!==(e=n.memoizedState)&&(null!==(e=e.dehydrated)&&function(e,t){var n=e.ownerDocument;if("$?"!==e.data||"complete"===n.readyState)t();else{var r=function(){t(),n.removeEventListener("DOMContentLoaded",r)};n.addEventListener("DOMContentLoaded",r),e._reactRetry=r}}(e,n=gu.bind(null,n))));break;case 22:if(!(r=null!==n.memoizedState||wl)){t=null!==t&&null!==t.memoizedState||xl,o=wl;var i=xl;wl=r,(xl=t)&&!i?Ql(e,n,!!(8772&n.subtreeFlags)):Nl(e,n),wl=o,xl=i}break;case 30:break;default:Nl(e,n)}}function Bl(e){var t=e.alternate;null!==t&&(e.alternate=null,Bl(t)),e.child=null,e.deletions=null,e.sibling=null,5===e.tag&&(null!==(t=e.stateNode)&&Qe(t)),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}var Il=null,Rl=!1;function kl(e,t,n){for(n=n.child;null!==n;)Tl(e,t,n),n=n.sibling}function Tl(e,t,n){if(le&&"function"==typeof le.onCommitFiberUnmount)try{le.onCommitFiberUnmount(ae,n)}catch(i){}switch(n.tag){case 26:xl||hl(n,t),kl(e,t,n),n.memoizedState?n.memoizedState.count--:n.stateNode&&(n=n.stateNode).parentNode.removeChild(n);break;case 27:xl||hl(n,t);var r=Il,o=Rl;fd(n.type)&&(Il=n.stateNode,Rl=!1),kl(e,t,n),_d(n.stateNode),Il=r,Rl=o;break;case 5:xl||hl(n,t);case 6:if(r=Il,o=Rl,Il=null,kl(e,t,n),Rl=o,null!==(Il=r))if(Rl)try{(9===Il.nodeType?Il.body:"HTML"===Il.nodeName?Il.ownerDocument.body:Il).removeChild(n.stateNode)}catch(s){Au(n,t,s)}else try{Il.removeChild(n.stateNode)}catch(s){Au(n,t,s)}break;case 18:null!==Il&&(Rl?(gd(9===(e=Il).nodeType?e.body:"HTML"===e.nodeName?e.ownerDocument.body:e,n.stateNode),RA(e)):gd(Il,n.stateNode));break;case 4:r=Il,o=Rl,Il=n.stateNode.containerInfo,Rl=!0,kl(e,t,n),Il=r,Rl=o;break;case 0:case 11:case 14:case 15:xl||cl(2,n,t),xl||cl(4,n,t),kl(e,t,n);break;case 1:xl||(hl(n,t),"function"==typeof(r=n.stateNode).componentWillUnmount&&dl(n,t,r)),kl(e,t,n);break;case 21:kl(e,t,n);break;case 22:xl=(r=xl)||null!==n.memoizedState,kl(e,t,n),xl=r;break;default:kl(e,t,n)}}function Pl(e,t){if(null===t.memoizedState&&(null!==(e=t.alternate)&&(null!==(e=e.memoizedState)&&null!==(e=e.dehydrated))))try{RA(e)}catch(n){Au(t,t.return,n)}}function Fl(e,t){var n=function(e){switch(e.tag){case 13:case 19:var t=e.stateNode;return null===t&&(t=e.stateNode=new Cl),t;case 22:return null===(t=(e=e.stateNode)._retryCache)&&(t=e._retryCache=new Cl),t;default:throw Error(r(435,e.tag))}}(e);t.forEach(function(t){var r=mu.bind(null,e,t);n.has(t)||(n.add(t),t.then(r,r))})}function Ml(e,t){var n=t.deletions;if(null!==n)for(var o=0;o<n.length;o++){var i=n[o],s=e,a=t,l=a;e:for(;null!==l;){switch(l.tag){case 27:if(fd(l.type)){Il=l.stateNode,Rl=!1;break e}break;case 5:Il=l.stateNode,Rl=!1;break e;case 3:case 4:Il=l.stateNode.containerInfo,Rl=!0;break e}l=l.return}if(null===Il)throw Error(r(160));Tl(s,a,i),Il=null,Rl=!1,null!==(s=i.alternate)&&(s.return=null),i.return=null}if(13878&t.subtreeFlags)for(t=t.child;null!==t;)Ul(t,e),t=t.sibling}var Ll=null;function Ul(e,t){var n=e.alternate,o=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:Ml(t,e),Ol(e),4&o&&(cl(3,e,e.return),ll(3,e),cl(5,e,e.return));break;case 1:Ml(t,e),Ol(e),512&o&&(xl||null===n||hl(n,n.return)),64&o&&wl&&(null!==(e=e.updateQueue)&&(null!==(o=e.callbacks)&&(n=e.shared.hiddenCallbacks,e.shared.hiddenCallbacks=null===n?o:n.concat(o))));break;case 26:var i=Ll;if(Ml(t,e),Ol(e),512&o&&(xl||null===n||hl(n,n.return)),4&o){var s=null!==n?n.memoizedState:null;if(o=e.memoizedState,null===n)if(null===o)if(null===e.stateNode){e:{o=e.type,n=e.memoizedProps,i=i.ownerDocument||i;t:switch(o){case"title":(!(s=i.getElementsByTagName("title")[0])||s[je]||s[ke]||"http://www.w3.org/2000/svg"===s.namespaceURI||s.hasAttribute("itemprop"))&&(s=i.createElement(o),i.head.insertBefore(s,i.querySelector("head > title"))),nd(s,o,n),s[ke]=e,$e(s),o=s;break e;case"link":var a=Qd("link","href",i).get(o+(n.href||""));if(a)for(var l=0;l<a.length;l++)if((s=a[l]).getAttribute("href")===(null==n.href||""===n.href?null:n.href)&&s.getAttribute("rel")===(null==n.rel?null:n.rel)&&s.getAttribute("title")===(null==n.title?null:n.title)&&s.getAttribute("crossorigin")===(null==n.crossOrigin?null:n.crossOrigin)){a.splice(l,1);break t}nd(s=i.createElement(o),o,n),i.head.appendChild(s);break;case"meta":if(a=Qd("meta","content",i).get(o+(n.content||"")))for(l=0;l<a.length;l++)if((s=a[l]).getAttribute("content")===(null==n.content?null:""+n.content)&&s.getAttribute("name")===(null==n.name?null:n.name)&&s.getAttribute("property")===(null==n.property?null:n.property)&&s.getAttribute("http-equiv")===(null==n.httpEquiv?null:n.httpEquiv)&&s.getAttribute("charset")===(null==n.charSet?null:n.charSet)){a.splice(l,1);break t}nd(s=i.createElement(o),o,n),i.head.appendChild(s);break;default:throw Error(r(468,o))}s[ke]=e,$e(s),o=s}e.stateNode=o}else zd(i,e.type,e.stateNode);else e.stateNode=Ud(i,o,e.memoizedProps);else s!==o?(null===s?null!==n.stateNode&&(n=n.stateNode).parentNode.removeChild(n):s.count--,null===o?zd(i,e.type,e.stateNode):Ud(i,o,e.memoizedProps)):null===o&&null!==e.stateNode&&fl(e,e.memoizedProps,n.memoizedProps)}break;case 27:Ml(t,e),Ol(e),512&o&&(xl||null===n||hl(n,n.return)),null!==n&&4&o&&fl(e,e.memoizedProps,n.memoizedProps);break;case 5:if(Ml(t,e),Ol(e),512&o&&(xl||null===n||hl(n,n.return)),32&e.flags){i=e.stateNode;try{Ct(i,"")}catch(p){Au(e,e.return,p)}}4&o&&null!=e.stateNode&&fl(e,i=e.memoizedProps,null!==n?n.memoizedProps:i),1024&o&&(_l=!0);break;case 6:if(Ml(t,e),Ol(e),4&o){if(null===e.stateNode)throw Error(r(162));o=e.memoizedProps,n=e.stateNode;try{n.nodeValue=o}catch(p){Au(e,e.return,p)}}break;case 3:if(jd=null,i=Ll,Ll=Ed(t.containerInfo),Ml(t,e),Ll=i,Ol(e),4&o&&null!==n&&n.memoizedState.isDehydrated)try{RA(t.containerInfo)}catch(p){Au(e,e.return,p)}_l&&(_l=!1,Dl(e));break;case 4:o=Ll,Ll=Ed(e.stateNode.containerInfo),Ml(t,e),Ol(e),Ll=o;break;case 12:default:Ml(t,e),Ol(e);break;case 13:Ml(t,e),Ol(e),8192&e.child.flags&&null!==e.memoizedState!=(null!==n&&null!==n.memoizedState)&&(_c=J()),4&o&&(null!==(o=e.updateQueue)&&(e.updateQueue=null,Fl(e,o)));break;case 22:i=null!==e.memoizedState;var c=null!==n&&null!==n.memoizedState,u=wl,d=xl;if(wl=u||i,xl=d||c,Ml(t,e),xl=d,wl=u,Ol(e),8192&o)e:for(t=e.stateNode,t._visibility=i?-2&t._visibility:1|t._visibility,i&&(null===n||c||wl||xl||jl(e)),n=null,t=e;;){if(5===t.tag||26===t.tag){if(null===n){c=n=t;try{if(s=c.stateNode,i)"function"==typeof(a=s.style).setProperty?a.setProperty("display","none","important"):a.display="none";else{l=c.stateNode;var A=c.memoizedProps.style,h=null!=A&&A.hasOwnProperty("display")?A.display:null;l.style.display=null==h||"boolean"==typeof h?"":(""+h).trim()}}catch(p){Au(c,c.return,p)}}}else if(6===t.tag){if(null===n){c=t;try{c.stateNode.nodeValue=i?"":c.memoizedProps}catch(p){Au(c,c.return,p)}}}else if((22!==t.tag&&23!==t.tag||null===t.memoizedState||t===e)&&null!==t.child){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;null===t.sibling;){if(null===t.return||t.return===e)break e;n===t&&(n=null),t=t.return}n===t&&(n=null),t.sibling.return=t.return,t=t.sibling}4&o&&(null!==(o=e.updateQueue)&&(null!==(n=o.retryQueue)&&(o.retryQueue=null,Fl(e,n))));break;case 19:Ml(t,e),Ol(e),4&o&&(null!==(o=e.updateQueue)&&(e.updateQueue=null,Fl(e,o)));case 30:case 21:}}function Ol(e){var t=e.flags;if(2&t){try{for(var n,o=e.return;null!==o;){if(gl(o)){n=o;break}o=o.return}if(null==n)throw Error(r(160));switch(n.tag){case 27:var i=n.stateNode;vl(e,ml(e),i);break;case 5:var s=n.stateNode;32&n.flags&&(Ct(s,""),n.flags&=-33),vl(e,ml(e),s);break;case 3:case 4:var a=n.stateNode.containerInfo;yl(e,ml(e),a);break;default:throw Error(r(161))}}catch(l){Au(e,e.return,l)}e.flags&=-3}4096&t&&(e.flags&=-4097)}function Dl(e){if(1024&e.subtreeFlags)for(e=e.child;null!==e;){var t=e;Dl(t),5===t.tag&&1024&t.flags&&t.stateNode.reset(),e=e.sibling}}function Nl(e,t){if(8772&t.subtreeFlags)for(t=t.child;null!==t;)El(e,t.alternate,t),t=t.sibling}function jl(e){for(e=e.child;null!==e;){var t=e;switch(t.tag){case 0:case 11:case 14:case 15:cl(4,t,t.return),jl(t);break;case 1:hl(t,t.return);var n=t.stateNode;"function"==typeof n.componentWillUnmount&&dl(t,t.return,n),jl(t);break;case 27:_d(t.stateNode);case 26:case 5:hl(t,t.return),jl(t);break;case 22:null===t.memoizedState&&jl(t);break;default:jl(t)}e=e.sibling}}function Ql(e,t,n){for(n=n&&!!(8772&t.subtreeFlags),t=t.child;null!==t;){var r=t.alternate,o=e,i=t,s=i.flags;switch(i.tag){case 0:case 11:case 15:Ql(o,i,n),ll(4,i);break;case 1:if(Ql(o,i,n),"function"==typeof(o=(r=i).stateNode).componentDidMount)try{o.componentDidMount()}catch(c){Au(r,r.return,c)}if(null!==(o=(r=i).updateQueue)){var a=r.stateNode;try{var l=o.shared.hiddenCallbacks;if(null!==l)for(o.shared.hiddenCallbacks=null,o=0;o<l.length;o++)pi(l[o],a)}catch(c){Au(r,r.return,c)}}n&&64&s&&ul(i),Al(i,i.return);break;case 27:bl(i);case 26:case 5:Ql(o,i,n),n&&null===r&&4&s&&pl(i),Al(i,i.return);break;case 12:Ql(o,i,n);break;case 13:Ql(o,i,n),n&&4&s&&Pl(o,i);break;case 22:null===i.memoizedState&&Ql(o,i,n),Al(i,i.return);break;case 30:break;default:Ql(o,i,n)}t=t.sibling}}function zl(e,t){var n=null;null!==e&&null!==e.memoizedState&&null!==e.memoizedState.cachePool&&(n=e.memoizedState.cachePool.pool),e=null,null!==t.memoizedState&&null!==t.memoizedState.cachePool&&(e=t.memoizedState.cachePool.pool),e!==n&&(null!=e&&e.refCount++,null!=n&&Oo(n))}function Hl(e,t){e=null,null!==t.alternate&&(e=t.alternate.memoizedState.cache),(t=t.memoizedState.cache)!==e&&(t.refCount++,null!=e&&Oo(e))}function Gl(e,t,n,r){if(10256&t.subtreeFlags)for(t=t.child;null!==t;)Vl(e,t,n,r),t=t.sibling}function Vl(e,t,n,r){var o=t.flags;switch(t.tag){case 0:case 11:case 15:Gl(e,t,n,r),2048&o&&ll(9,t);break;case 1:case 13:default:Gl(e,t,n,r);break;case 3:Gl(e,t,n,r),2048&o&&(e=null,null!==t.alternate&&(e=t.alternate.memoizedState.cache),(t=t.memoizedState.cache)!==e&&(t.refCount++,null!=e&&Oo(e)));break;case 12:if(2048&o){Gl(e,t,n,r),e=t.stateNode;try{var i=t.memoizedProps,s=i.id,a=i.onPostCommit;"function"==typeof a&&a(s,null===t.alternate?"mount":"update",e.passiveEffectDuration,-0)}catch(l){Au(t,t.return,l)}}else Gl(e,t,n,r);break;case 23:break;case 22:i=t.stateNode,s=t.alternate,null!==t.memoizedState?2&i._visibility?Gl(e,t,n,r):$l(e,t):2&i._visibility?Gl(e,t,n,r):(i._visibility|=2,Wl(e,t,n,r,!!(10256&t.subtreeFlags))),2048&o&&zl(s,t);break;case 24:Gl(e,t,n,r),2048&o&&Hl(t.alternate,t)}}function Wl(e,t,n,r,o){for(o=o&&!!(10256&t.subtreeFlags),t=t.child;null!==t;){var i=e,s=t,a=n,l=r,c=s.flags;switch(s.tag){case 0:case 11:case 15:Wl(i,s,a,l,o),ll(8,s);break;case 23:break;case 22:var u=s.stateNode;null!==s.memoizedState?2&u._visibility?Wl(i,s,a,l,o):$l(i,s):(u._visibility|=2,Wl(i,s,a,l,o)),o&&2048&c&&zl(s.alternate,s);break;case 24:Wl(i,s,a,l,o),o&&2048&c&&Hl(s.alternate,s);break;default:Wl(i,s,a,l,o)}t=t.sibling}}function $l(e,t){if(10256&t.subtreeFlags)for(t=t.child;null!==t;){var n=e,r=t,o=r.flags;switch(r.tag){case 22:$l(n,r),2048&o&&zl(r.alternate,r);break;case 24:$l(n,r),2048&o&&Hl(r.alternate,r);break;default:$l(n,r)}t=t.sibling}}var Kl=8192;function Xl(e){if(e.subtreeFlags&Kl)for(e=e.child;null!==e;)Yl(e),e=e.sibling}function Yl(e){switch(e.tag){case 26:Xl(e),e.flags&Kl&&null!==e.memoizedState&&function(e,t,n){if(null===Gd)throw Error(r(475));var o=Gd;if(!("stylesheet"!==t.type||"string"==typeof n.media&&!1===matchMedia(n.media).matches||4&t.state.loading)){if(null===t.instance){var i=Td(n.href),s=e.querySelector(Pd(i));if(s)return null!==(e=s._p)&&"object"==typeof e&&"function"==typeof e.then&&(o.count++,o=Wd.bind(o),e.then(o,o)),t.state.loading|=4,t.instance=s,void $e(s);s=e.ownerDocument||e,n=Fd(n),(i=Cd.get(i))&&Dd(n,i),$e(s=s.createElement("link"));var a=s;a._p=new Promise(function(e,t){a.onload=e,a.onerror=t}),nd(s,"link",n),t.instance=s}null===o.stylesheets&&(o.stylesheets=new Map),o.stylesheets.set(t,e),(e=t.state.preload)&&!(3&t.state.loading)&&(o.count++,t=Wd.bind(o),e.addEventListener("load",t),e.addEventListener("error",t))}}(Ll,e.memoizedState,e.memoizedProps);break;case 5:default:Xl(e);break;case 3:case 4:var t=Ll;Ll=Ed(e.stateNode.containerInfo),Xl(e),Ll=t;break;case 22:null===e.memoizedState&&(null!==(t=e.alternate)&&null!==t.memoizedState?(t=Kl,Kl=16777216,Xl(e),Kl=t):Xl(e))}}function ql(e){var t=e.alternate;if(null!==t&&null!==(e=t.child)){t.child=null;do{t=e.sibling,e.sibling=null,e=t}while(null!==e)}}function Jl(e){var t=e.deletions;if(16&e.flags){if(null!==t)for(var n=0;n<t.length;n++){var r=t[n];Sl=r,tc(r,e)}ql(e)}if(10256&e.subtreeFlags)for(e=e.child;null!==e;)Zl(e),e=e.sibling}function Zl(e){switch(e.tag){case 0:case 11:case 15:Jl(e),2048&e.flags&&cl(9,e,e.return);break;case 3:case 12:default:Jl(e);break;case 22:var t=e.stateNode;null!==e.memoizedState&&2&t._visibility&&(null===e.return||13!==e.return.tag)?(t._visibility&=-3,ec(e)):Jl(e)}}function ec(e){var t=e.deletions;if(16&e.flags){if(null!==t)for(var n=0;n<t.length;n++){var r=t[n];Sl=r,tc(r,e)}ql(e)}for(e=e.child;null!==e;){switch((t=e).tag){case 0:case 11:case 15:cl(8,t,t.return),ec(t);break;case 22:2&(n=t.stateNode)._visibility&&(n._visibility&=-3,ec(t));break;default:ec(t)}e=e.sibling}}function tc(e,t){for(;null!==Sl;){var n=Sl;switch(n.tag){case 0:case 11:case 15:cl(8,n,t);break;case 23:case 22:if(null!==n.memoizedState&&null!==n.memoizedState.cachePool){var r=n.memoizedState.cachePool.pool;null!=r&&r.refCount++}break;case 24:Oo(n.memoizedState.cache)}if(null!==(r=n.child))r.return=n,Sl=r;else e:for(n=e;null!==Sl;){var o=(r=Sl).sibling,i=r.return;if(Bl(r),r===n){Sl=null;break e}if(null!==o){o.return=i,Sl=o;break e}Sl=i}}}var nc={getCacheForType:function(e){var t=Ro(Lo),n=t.data.get(e);return void 0===n&&(n=e(),t.data.set(e,n)),n}},rc="function"==typeof WeakMap?WeakMap:Map,oc=0,ic=null,sc=null,ac=0,lc=0,cc=null,uc=!1,dc=!1,Ac=!1,hc=0,pc=0,fc=0,gc=0,mc=0,yc=0,vc=0,bc=null,wc=null,xc=!1,_c=0,Cc=1/0,Sc=null,Ec=null,Bc=0,Ic=null,Rc=null,kc=0,Tc=0,Pc=null,Fc=null,Mc=0,Lc=null;function Uc(){if(2&oc&&0!==ac)return ac&-ac;if(null!==T.T){return 0!==jo?jo:Tu()}return Ie()}function Oc(){0===yc&&(yc=536870912&ac&&!ao?536870912:be());var e=sa.current;return null!==e&&(e.flags|=32),yc}function Dc(e,t,n){(e!==ic||2!==lc&&9!==lc)&&null===e.cancelPendingCommit||(Vc(e,0),zc(e,ac,yc,!1)),_e(e,n),2&oc&&e===ic||(e===ic&&(!(2&oc)&&(gc|=n),4===pc&&zc(e,ac,yc,!1)),Cu(e))}function Nc(e,t,n){if(6&oc)throw Error(r(327));for(var o=!n&&!(124&t)&&0===(t&e.expiredLanes)||ye(e,t),i=o?function(e,t){var n=oc;oc|=2;var o=$c(),i=Kc();ic!==e||ac!==t?(Sc=null,Cc=J()+500,Vc(e,t)):dc=ye(e,t);e:for(;;)try{if(0!==lc&&null!==sc){t=sc;var s=cc;t:switch(lc){case 1:lc=0,cc=null,tu(e,t,s,1);break;case 2:case 9:if(Jo(s)){lc=0,cc=null,eu(t);break}t=function(){2!==lc&&9!==lc||ic!==e||(lc=7),Cu(e)},s.then(t,t);break e;case 3:lc=7;break e;case 4:lc=5;break e;case 7:Jo(s)?(lc=0,cc=null,eu(t)):(lc=0,cc=null,tu(e,t,s,7));break;case 5:var a=null;switch(sc.tag){case 26:a=sc.memoizedState;case 5:case 27:var l=sc;if(!a||Hd(a)){lc=0,cc=null;var c=l.sibling;if(null!==c)sc=c;else{var u=l.return;null!==u?(sc=u,nu(u)):sc=null}break t}}lc=0,cc=null,tu(e,t,s,5);break;case 6:lc=0,cc=null,tu(e,t,s,6);break;case 8:Gc(),pc=6;break e;default:throw Error(r(462))}}Jc();break}catch(d){Wc(e,d)}return wo=bo=null,T.H=o,T.A=i,oc=n,null!==sc?0:(ic=null,ac=0,kr(),pc)}(e,t):Yc(e,t,!0),s=o;;){if(0===i){dc&&!o&&zc(e,t,0,!1);break}if(n=e.current.alternate,!s||Qc(n)){if(2===i){if(s=t,e.errorRecoveryDisabledLanes&s)var a=0;else a=0!==(a=-536870913&e.pendingLanes)?a:536870912&a?536870912:0;if(0!==a){t=a;e:{var l=e;i=bc;var c=l.current.memoizedState.isDehydrated;if(c&&(Vc(l,a).flags|=256),2!==(a=Yc(l,a,!1))){if(Ac&&!c){l.errorRecoveryDisabledLanes|=s,gc|=s,i=4;break e}s=wc,wc=i,null!==s&&(null===wc?wc=s:wc.push.apply(wc,s))}i=a}if(s=!1,2!==i)continue}}if(1===i){Vc(e,0),zc(e,t,0,!0);break}e:{switch(o=e,s=i){case 0:case 1:throw Error(r(345));case 4:if((4194048&t)!==t)break;case 6:zc(o,t,yc,!uc);break e;case 2:wc=null;break;case 3:case 5:break;default:throw Error(r(329))}if((62914560&t)===t&&10<(i=_c+300-J())){if(zc(o,t,yc,!uc),0!==me(o,0,!0))break e;o.timeoutHandle=ud(jc.bind(null,o,n,wc,Sc,xc,t,yc,gc,vc,uc,s,2,-0,0),i)}else jc(o,n,wc,Sc,xc,t,yc,gc,vc,uc,s,0,-0,0)}break}i=Yc(e,t,!1),s=!1}Cu(e)}function jc(e,t,n,o,i,s,a,l,c,u,d,A,h,p){if(e.timeoutHandle=-1,(8192&(A=t.subtreeFlags)||!(16785408&~A))&&(Gd={stylesheets:null,count:0,unsuspend:Vd},Yl(t),null!==(A=function(){if(null===Gd)throw Error(r(475));var e=Gd;return e.stylesheets&&0===e.count&&Kd(e,e.stylesheets),0<e.count?function(t){var n=setTimeout(function(){if(e.stylesheets&&Kd(e,e.stylesheets),e.unsuspend){var t=e.unsuspend;e.unsuspend=null,t()}},6e4);return e.unsuspend=t,function(){e.unsuspend=null,clearTimeout(n)}}:null}())))return e.cancelPendingCommit=A(ou.bind(null,e,t,s,n,o,i,a,l,c,d,1,h,p)),void zc(e,s,a,!u);ou(e,t,s,n,o,i,a,l,c)}function Qc(e){for(var t=e;;){var n=t.tag;if((0===n||11===n||15===n)&&16384&t.flags&&(null!==(n=t.updateQueue)&&null!==(n=n.stores)))for(var r=0;r<n.length;r++){var o=n[r],i=o.getSnapshot;o=o.value;try{if(!qn(i(),o))return!1}catch(s){return!1}}if(n=t.child,16384&t.subtreeFlags&&null!==n)n.return=t,t=n;else{if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}function zc(e,t,n,r){t&=~mc,t&=~gc,e.suspendedLanes|=t,e.pingedLanes&=~t,r&&(e.warmLanes|=t),r=e.expirationTimes;for(var o=t;0<o;){var i=31-ue(o),s=1<<i;r[i]=-1,o&=~s}0!==n&&Ce(e,n,t)}function Hc(){return!!(6&oc)||(Su(0),!1)}function Gc(){if(null!==sc){if(0===lc)var e=sc.return;else wo=bo=null,ji(e=sc),qs=null,Js=0,e=sc;for(;null!==e;)al(e.alternate,e),e=e.return;sc=null}}function Vc(e,t){var n=e.timeoutHandle;-1!==n&&(e.timeoutHandle=-1,dd(n)),null!==(n=e.cancelPendingCommit)&&(e.cancelPendingCommit=null,n()),Gc(),ic=e,sc=n=jr(e.current,null),ac=t,lc=0,cc=null,uc=!1,dc=ye(e,t),Ac=!1,vc=yc=mc=gc=fc=pc=0,wc=bc=null,xc=!1,8&t&&(t|=32&t);var r=e.entangledLanes;if(0!==r)for(e=e.entanglements,r&=t;0<r;){var o=31-ue(r),i=1<<o;t|=e[o],r&=~i}return hc=t,kr(),n}function Wc(e,t){xi=null,T.H=$s,t===Ko||t===Yo?(t=ni(),lc=3):t===Xo?(t=ni(),lc=4):lc=t===Ia?8:null!==t&&"object"==typeof t&&"function"==typeof t.then?6:1,cc=t,null===sc&&(pc=1,_a(e,Er(t,e.current)))}function $c(){var e=T.H;return T.H=$s,null===e?$s:e}function Kc(){var e=T.A;return T.A=nc,e}function Xc(){pc=4,uc||(4194048&ac)!==ac&&null!==sa.current||(dc=!0),!(134217727&fc)&&!(134217727&gc)||null===ic||zc(ic,ac,yc,!1)}function Yc(e,t,n){var r=oc;oc|=2;var o=$c(),i=Kc();ic===e&&ac===t||(Sc=null,Vc(e,t)),t=!1;var s=pc;e:for(;;)try{if(0!==lc&&null!==sc){var a=sc,l=cc;switch(lc){case 8:Gc(),s=6;break e;case 3:case 2:case 9:case 6:null===sa.current&&(t=!0);var c=lc;if(lc=0,cc=null,tu(e,a,l,c),n&&dc){s=0;break e}break;default:c=lc,lc=0,cc=null,tu(e,a,l,c)}}qc(),s=pc;break}catch(u){Wc(e,u)}return t&&e.shellSuspendCounter++,wo=bo=null,oc=r,T.H=o,T.A=i,null===sc&&(ic=null,ac=0,kr()),s}function qc(){for(;null!==sc;)Zc(sc)}function Jc(){for(;null!==sc&&!Y();)Zc(sc)}function Zc(e){var t=Za(e.alternate,e,hc);e.memoizedProps=e.pendingProps,null===t?nu(e):sc=t}function eu(e){var t=e,n=t.alternate;switch(t.tag){case 15:case 0:t=Da(n,t,t.pendingProps,t.type,void 0,ac);break;case 11:t=Da(n,t,t.pendingProps,t.type.render,t.ref,ac);break;case 5:ji(t);default:al(n,t),t=Za(n,t=sc=Qr(t,hc),hc)}e.memoizedProps=e.pendingProps,null===t?nu(e):sc=t}function tu(e,t,n,o){wo=bo=null,ji(t),qs=null,Js=0;var i=t.return;try{if(function(e,t,n,o,i){if(n.flags|=32768,null!==o&&"object"==typeof o&&"function"==typeof o.then){if(null!==(t=n.alternate)&&Eo(t,n,i,!0),null!==(n=sa.current)){switch(n.tag){case 13:return null===aa?Xc():null===n.alternate&&0===pc&&(pc=3),n.flags&=-257,n.flags|=65536,n.lanes=i,o===qo?n.flags|=16384:(null===(t=n.updateQueue)?n.updateQueue=new Set([o]):t.add(o),hu(e,o,i)),!1;case 22:return n.flags|=65536,o===qo?n.flags|=16384:(null===(t=n.updateQueue)?(t={transitions:null,markerInstances:null,retryQueue:new Set([o])},n.updateQueue=t):null===(n=t.retryQueue)?t.retryQueue=new Set([o]):n.add(o),hu(e,o,i)),!1}throw Error(r(435,n.tag))}return hu(e,o,i),Xc(),!1}if(ao)return null!==(t=sa.current)?(!(65536&t.flags)&&(t.flags|=256),t.flags|=65536,t.lanes=i,o!==uo&&yo(Er(e=Error(r(422),{cause:o}),n))):(o!==uo&&yo(Er(t=Error(r(423),{cause:o}),n)),(e=e.current.alternate).flags|=65536,i&=-i,e.lanes|=i,o=Er(o,n),ui(e,i=Sa(e.stateNode,o,i)),4!==pc&&(pc=2)),!1;var s=Error(r(520),{cause:o});if(s=Er(s,n),null===bc?bc=[s]:bc.push(s),4!==pc&&(pc=2),null===t)return!0;o=Er(o,n),n=t;do{switch(n.tag){case 3:return n.flags|=65536,e=i&-i,n.lanes|=e,ui(n,e=Sa(n.stateNode,o,e)),!1;case 1:if(t=n.type,s=n.stateNode,!(128&n.flags||"function"!=typeof t.getDerivedStateFromError&&(null===s||"function"!=typeof s.componentDidCatch||null!==Ec&&Ec.has(s))))return n.flags|=65536,i&=-i,n.lanes|=i,Ba(i=Ea(i),e,n,o),ui(n,i),!1}n=n.return}while(null!==n);return!1}(e,i,t,n,ac))return pc=1,_a(e,Er(n,e.current)),void(sc=null)}catch(s){if(null!==i)throw sc=i,s;return pc=1,_a(e,Er(n,e.current)),void(sc=null)}32768&t.flags?(ao||1===o?e=!0:dc||536870912&ac?e=!1:(uc=e=!0,(2===o||9===o||3===o||6===o)&&(null!==(o=sa.current)&&13===o.tag&&(o.flags|=16384))),ru(t,e)):nu(t)}function nu(e){var t=e;do{if(32768&t.flags)return void ru(t,uc);e=t.return;var n=il(t.alternate,t,hc);if(null!==n)return void(sc=n);if(null!==(t=t.sibling))return void(sc=t);sc=t=e}while(null!==t);0===pc&&(pc=5)}function ru(e,t){do{var n=sl(e.alternate,e);if(null!==n)return n.flags&=32767,void(sc=n);if(null!==(n=e.return)&&(n.flags|=32768,n.subtreeFlags=0,n.deletions=null),!t&&null!==(e=e.sibling))return void(sc=e);sc=e=n}while(null!==e);pc=6,sc=null}function ou(e,t,n,o,i,s,a,l,c){e.cancelPendingCommit=null;do{cu()}while(0!==Bc);if(6&oc)throw Error(r(327));if(null!==t){if(t===e.current)throw Error(r(177));if(s=t.lanes|t.childLanes,function(e,t,n,r,o,i){var s=e.pendingLanes;e.pendingLanes=n,e.suspendedLanes=0,e.pingedLanes=0,e.warmLanes=0,e.expiredLanes&=n,e.entangledLanes&=n,e.errorRecoveryDisabledLanes&=n,e.shellSuspendCounter=0;var a=e.entanglements,l=e.expirationTimes,c=e.hiddenUpdates;for(n=s&~n;0<n;){var u=31-ue(n),d=1<<u;a[u]=0,l[u]=-1;var A=c[u];if(null!==A)for(c[u]=null,u=0;u<A.length;u++){var h=A[u];null!==h&&(h.lane&=-536870913)}n&=~d}0!==r&&Ce(e,r,0),0!==i&&0===o&&0!==e.tag&&(e.suspendedLanes|=i&~(s&~t))}(e,n,s|=Rr,a,l,c),e===ic&&(sc=ic=null,ac=0),Rc=t,Ic=e,kc=n,Tc=s,Pc=i,Fc=o,10256&t.subtreeFlags||10256&t.flags?(e.callbackNode=null,e.callbackPriority=0,K(ne,function(){return uu(),null})):(e.callbackNode=null,e.callbackPriority=0),o=!!(13878&t.flags),13878&t.subtreeFlags||o){o=T.T,T.T=null,i=P.p,P.p=2,a=oc,oc|=4;try{!function(e,t){if(e=e.containerInfo,rd=oA,rr(e=nr(e))){if("selectionStart"in e)var n={start:e.selectionStart,end:e.selectionEnd};else e:{var o=(n=(n=e.ownerDocument)&&n.defaultView||window).getSelection&&n.getSelection();if(o&&0!==o.rangeCount){n=o.anchorNode;var i=o.anchorOffset,s=o.focusNode;o=o.focusOffset;try{n.nodeType,s.nodeType}catch(g){n=null;break e}var a=0,l=-1,c=-1,u=0,d=0,A=e,h=null;t:for(;;){for(var p;A!==n||0!==i&&3!==A.nodeType||(l=a+i),A!==s||0!==o&&3!==A.nodeType||(c=a+o),3===A.nodeType&&(a+=A.nodeValue.length),null!==(p=A.firstChild);)h=A,A=p;for(;;){if(A===e)break t;if(h===n&&++u===i&&(l=a),h===s&&++d===o&&(c=a),null!==(p=A.nextSibling))break;h=(A=h).parentNode}A=p}n=-1===l||-1===c?null:{start:l,end:c}}else n=null}n=n||{start:0,end:0}}else n=null;for(od={focusedElem:e,selectionRange:n},oA=!1,Sl=t;null!==Sl;)if(e=(t=Sl).child,1024&t.subtreeFlags&&null!==e)e.return=t,Sl=e;else for(;null!==Sl;){switch(s=(t=Sl).alternate,e=t.flags,t.tag){case 0:case 11:case 15:case 5:case 26:case 27:case 6:case 4:case 17:break;case 1:if(1024&e&&null!==s){e=void 0,n=t,i=s.memoizedProps,s=s.memoizedState,o=n.stateNode;try{var f=ya(n.type,i,(n.elementType,n.type));e=o.getSnapshotBeforeUpdate(f,s),o.__reactInternalSnapshotBeforeUpdate=e}catch(m){Au(n,n.return,m)}}break;case 3:if(1024&e)if(9===(n=(e=t.stateNode.containerInfo).nodeType))md(e);else if(1===n)switch(e.nodeName){case"HEAD":case"HTML":case"BODY":md(e);break;default:e.textContent=""}break;default:if(1024&e)throw Error(r(163))}if(null!==(e=t.sibling)){e.return=t.return,Sl=e;break}Sl=t.return}}(e,t)}finally{oc=a,P.p=i,T.T=o}}Bc=1,iu(),su(),au()}}function iu(){if(1===Bc){Bc=0;var e=Ic,t=Rc,n=!!(13878&t.flags);if(13878&t.subtreeFlags||n){n=T.T,T.T=null;var r=P.p;P.p=2;var o=oc;oc|=4;try{Ul(t,e);var i=od,s=nr(e.containerInfo),a=i.focusedElem,l=i.selectionRange;if(s!==a&&a&&a.ownerDocument&&tr(a.ownerDocument.documentElement,a)){if(null!==l&&rr(a)){var c=l.start,u=l.end;if(void 0===u&&(u=c),"selectionStart"in a)a.selectionStart=c,a.selectionEnd=Math.min(u,a.value.length);else{var d=a.ownerDocument||document,A=d&&d.defaultView||window;if(A.getSelection){var h=A.getSelection(),p=a.textContent.length,f=Math.min(l.start,p),g=void 0===l.end?f:Math.min(l.end,p);!h.extend&&f>g&&(s=g,g=f,f=s);var m=er(a,f),y=er(a,g);if(m&&y&&(1!==h.rangeCount||h.anchorNode!==m.node||h.anchorOffset!==m.offset||h.focusNode!==y.node||h.focusOffset!==y.offset)){var v=d.createRange();v.setStart(m.node,m.offset),h.removeAllRanges(),f>g?(h.addRange(v),h.extend(y.node,y.offset)):(v.setEnd(y.node,y.offset),h.addRange(v))}}}}for(d=[],h=a;h=h.parentNode;)1===h.nodeType&&d.push({element:h,left:h.scrollLeft,top:h.scrollTop});for("function"==typeof a.focus&&a.focus(),a=0;a<d.length;a++){var b=d[a];b.element.scrollLeft=b.left,b.element.scrollTop=b.top}}oA=!!rd,od=rd=null}finally{oc=o,P.p=r,T.T=n}}e.current=t,Bc=2}}function su(){if(2===Bc){Bc=0;var e=Ic,t=Rc,n=!!(8772&t.flags);if(8772&t.subtreeFlags||n){n=T.T,T.T=null;var r=P.p;P.p=2;var o=oc;oc|=4;try{El(e,t.alternate,t)}finally{oc=o,P.p=r,T.T=n}}Bc=3}}function au(){if(4===Bc||3===Bc){Bc=0,q();var e=Ic,t=Rc,n=kc,r=Fc;10256&t.subtreeFlags||10256&t.flags?Bc=5:(Bc=0,Rc=Ic=null,lu(e,e.pendingLanes));var o=e.pendingLanes;if(0===o&&(Ec=null),Be(n),t=t.stateNode,le&&"function"==typeof le.onCommitFiberRoot)try{le.onCommitFiberRoot(ae,t,void 0,!(128&~t.current.flags))}catch(l){}if(null!==r){t=T.T,o=P.p,P.p=2,T.T=null;try{for(var i=e.onRecoverableError,s=0;s<r.length;s++){var a=r[s];i(a.value,{componentStack:a.stack})}}finally{T.T=t,P.p=o}}3&kc&&cu(),Cu(e),o=e.pendingLanes,4194090&n&&42&o?e===Lc?Mc++:(Mc=0,Lc=e):Mc=0,Su(0)}}function lu(e,t){0===(e.pooledCacheLanes&=t)&&(null!=(t=e.pooledCache)&&(e.pooledCache=null,Oo(t)))}function cu(e){return iu(),su(),au(),uu()}function uu(){if(5!==Bc)return!1;var e=Ic,t=Tc;Tc=0;var n=Be(kc),o=T.T,i=P.p;try{P.p=32>n?32:n,T.T=null,n=Pc,Pc=null;var s=Ic,a=kc;if(Bc=0,Rc=Ic=null,kc=0,6&oc)throw Error(r(331));var l=oc;if(oc|=4,Zl(s.current),Vl(s,s.current,a,n),oc=l,Su(0,!1),le&&"function"==typeof le.onPostCommitFiberRoot)try{le.onPostCommitFiberRoot(ae,s)}catch(c){}return!0}finally{P.p=i,T.T=o,lu(e,t)}}function du(e,t,n){t=Er(n,t),null!==(e=li(e,t=Sa(e.stateNode,t,2),2))&&(_e(e,2),Cu(e))}function Au(e,t,n){if(3===e.tag)du(e,e,n);else for(;null!==t;){if(3===t.tag){du(t,e,n);break}if(1===t.tag){var r=t.stateNode;if("function"==typeof t.type.getDerivedStateFromError||"function"==typeof r.componentDidCatch&&(null===Ec||!Ec.has(r))){e=Er(n,e),null!==(r=li(t,n=Ea(2),2))&&(Ba(n,r,t,e),_e(r,2),Cu(r));break}}t=t.return}}function hu(e,t,n){var r=e.pingCache;if(null===r){r=e.pingCache=new rc;var o=new Set;r.set(t,o)}else void 0===(o=r.get(t))&&(o=new Set,r.set(t,o));o.has(n)||(Ac=!0,o.add(n),e=pu.bind(null,e,t,n),t.then(e,e))}function pu(e,t,n){var r=e.pingCache;null!==r&&r.delete(t),e.pingedLanes|=e.suspendedLanes&n,e.warmLanes&=~n,ic===e&&(ac&n)===n&&(4===pc||3===pc&&(62914560&ac)===ac&&300>J()-_c?!(2&oc)&&Vc(e,0):mc|=n,vc===ac&&(vc=0)),Cu(e)}function fu(e,t){0===t&&(t=we()),null!==(e=Fr(e,t))&&(_e(e,t),Cu(e))}function gu(e){var t=e.memoizedState,n=0;null!==t&&(n=t.retryLane),fu(e,n)}function mu(e,t){var n=0;switch(e.tag){case 13:var o=e.stateNode,i=e.memoizedState;null!==i&&(n=i.retryLane);break;case 19:o=e.stateNode;break;case 22:o=e.stateNode._retryCache;break;default:throw Error(r(314))}null!==o&&o.delete(t),fu(e,n)}var yu=null,vu=null,bu=!1,wu=!1,xu=!1,_u=0;function Cu(e){e!==vu&&null===e.next&&(null===vu?yu=vu=e:vu=vu.next=e),wu=!0,bu||(bu=!0,hd(function(){6&oc?K(ee,Eu):Bu()}))}function Su(e,t){if(!xu&&wu){xu=!0;do{for(var n=!1,r=yu;null!==r;){if(0!==e){var o=r.pendingLanes;if(0===o)var i=0;else{var s=r.suspendedLanes,a=r.pingedLanes;i=(1<<31-ue(42|e)+1)-1,i=201326741&(i&=o&~(s&~a))?201326741&i|1:i?2|i:0}0!==i&&(n=!0,ku(r,i))}else i=ac,!(3&(i=me(r,r===ic?i:0,null!==r.cancelPendingCommit||-1!==r.timeoutHandle)))||ye(r,i)||(n=!0,ku(r,i));r=r.next}}while(n);xu=!1}}function Eu(){Bu()}function Bu(){wu=bu=!1;var e=0;0!==_u&&(function(){var e=window.event;if(e&&"popstate"===e.type)return e!==cd&&(cd=e,!0);return cd=null,!1}()&&(e=_u),_u=0);for(var t=J(),n=null,r=yu;null!==r;){var o=r.next,i=Iu(r,t);0===i?(r.next=null,null===n?yu=o:n.next=o,null===o&&(vu=n)):(n=r,(0!==e||3&i)&&(wu=!0)),r=o}Su(e)}function Iu(e,t){for(var n=e.suspendedLanes,r=e.pingedLanes,o=e.expirationTimes,i=-62914561&e.pendingLanes;0<i;){var s=31-ue(i),a=1<<s,l=o[s];-1===l?0!==(a&n)&&0===(a&r)||(o[s]=ve(a,t)):l<=t&&(e.expiredLanes|=a),i&=~a}if(n=ac,n=me(e,e===(t=ic)?n:0,null!==e.cancelPendingCommit||-1!==e.timeoutHandle),r=e.callbackNode,0===n||e===t&&(2===lc||9===lc)||null!==e.cancelPendingCommit)return null!==r&&null!==r&&X(r),e.callbackNode=null,e.callbackPriority=0;if(!(3&n)||ye(e,n)){if((t=n&-n)===e.callbackPriority)return t;switch(null!==r&&X(r),Be(n)){case 2:case 8:n=te;break;case 32:default:n=ne;break;case 268435456:n=oe}return r=Ru.bind(null,e),n=K(n,r),e.callbackPriority=t,e.callbackNode=n,t}return null!==r&&null!==r&&X(r),e.callbackPriority=2,e.callbackNode=null,2}function Ru(e,t){if(0!==Bc&&5!==Bc)return e.callbackNode=null,e.callbackPriority=0,null;var n=e.callbackNode;if(cu()&&e.callbackNode!==n)return null;var r=ac;return 0===(r=me(e,e===ic?r:0,null!==e.cancelPendingCommit||-1!==e.timeoutHandle))?null:(Nc(e,r,t),Iu(e,J()),null!=e.callbackNode&&e.callbackNode===n?Ru.bind(null,e):null)}function ku(e,t){if(cu())return null;Nc(e,t,!0)}function Tu(){return 0===_u&&(_u=be()),_u}function Pu(e){return null==e||"symbol"==typeof e||"boolean"==typeof e?null:"function"==typeof e?e:Tt(""+e)}function Fu(e,t){var n=t.ownerDocument.createElement("input");return n.name=t.name,n.value=t.value,e.id&&n.setAttribute("form",e.id),t.parentNode.insertBefore(n,t),e=new FormData(e),n.parentNode.removeChild(n),e}for(var Mu=0;Mu<_r.length;Mu++){var Lu=_r[Mu];Cr(Lu.toLowerCase(),"on"+(Lu[0].toUpperCase()+Lu.slice(1)))}Cr(fr,"onAnimationEnd"),Cr(gr,"onAnimationIteration"),Cr(mr,"onAnimationStart"),Cr("dblclick","onDoubleClick"),Cr("focusin","onFocus"),Cr("focusout","onBlur"),Cr(yr,"onTransitionRun"),Cr(vr,"onTransitionStart"),Cr(br,"onTransitionCancel"),Cr(wr,"onTransitionEnd"),qe("onMouseEnter",["mouseout","mouseover"]),qe("onMouseLeave",["mouseout","mouseover"]),qe("onPointerEnter",["pointerout","pointerover"]),qe("onPointerLeave",["pointerout","pointerover"]),Ye("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),Ye("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),Ye("onBeforeInput",["compositionend","keypress","textInput","paste"]),Ye("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),Ye("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),Ye("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Uu="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Ou=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(Uu));function Du(e,t){t=!!(4&t);for(var n=0;n<e.length;n++){var r=e[n],o=r.event;r=r.listeners;e:{var i=void 0;if(t)for(var s=r.length-1;0<=s;s--){var a=r[s],l=a.instance,c=a.currentTarget;if(a=a.listener,l!==i&&o.isPropagationStopped())break e;i=a,o.currentTarget=c;try{i(o)}catch(u){va(u)}o.currentTarget=null,i=l}else for(s=0;s<r.length;s++){if(l=(a=r[s]).instance,c=a.currentTarget,a=a.listener,l!==i&&o.isPropagationStopped())break e;i=a,o.currentTarget=c;try{i(o)}catch(u){va(u)}o.currentTarget=null,i=l}}}}function Nu(e,t){var n=t[Me];void 0===n&&(n=t[Me]=new Set);var r=e+"__bubble";n.has(r)||(Hu(t,e,2,!1),n.add(r))}function ju(e,t,n){var r=0;t&&(r|=4),Hu(n,e,r,t)}var Qu="_reactListening"+Math.random().toString(36).slice(2);function zu(e){if(!e[Qu]){e[Qu]=!0,Ke.forEach(function(t){"selectionchange"!==t&&(Ou.has(t)||ju(t,!1,e),ju(t,!0,e))});var t=9===e.nodeType?e:e.ownerDocument;null===t||t[Qu]||(t[Qu]=!0,ju("selectionchange",!1,t))}}function Hu(e,t,n,r){switch(dA(t)){case 2:var o=iA;break;case 8:o=sA;break;default:o=aA}n=o.bind(null,t,n,e),o=void 0,!Qt||"touchstart"!==t&&"touchmove"!==t&&"wheel"!==t||(o=!0),r?void 0!==o?e.addEventListener(t,n,{capture:!0,passive:o}):e.addEventListener(t,n,!0):void 0!==o?e.addEventListener(t,n,{passive:o}):e.addEventListener(t,n,!1)}function Gu(e,t,n,r,o){var s=r;if(!(1&t||2&t||null===r))e:for(;;){if(null===r)return;var a=r.tag;if(3===a||4===a){var l=r.stateNode.containerInfo;if(l===o)break;if(4===a)for(a=r.return;null!==a;){var c=a.tag;if((3===c||4===c)&&a.stateNode.containerInfo===o)return;a=a.return}for(;null!==l;){if(null===(a=ze(l)))return;if(5===(c=a.tag)||6===c||26===c||27===c){r=s=a;continue e}l=l.parentNode}}r=r.return}Dt(function(){var r=s,o=Ft(n),a=[];e:{var l=xr.get(e);if(void 0!==l){var c=tn,u=e;switch(e){case"keypress":if(0===$t(n))break e;case"keydown":case"keyup":c=mn;break;case"focusin":u="focus",c=ln;break;case"focusout":u="blur",c=ln;break;case"beforeblur":case"afterblur":c=ln;break;case"click":if(2===n.button)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":c=sn;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":c=an;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":c=vn;break;case fr:case gr:case mr:c=cn;break;case wr:c=bn;break;case"scroll":case"scrollend":c=rn;break;case"wheel":c=wn;break;case"copy":case"cut":case"paste":c=un;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":c=yn;break;case"toggle":case"beforetoggle":c=xn}var d=!!(4&t),A=!d&&("scroll"===e||"scrollend"===e),h=d?null!==l?l+"Capture":null:l;d=[];for(var p,f=r;null!==f;){var g=f;if(p=g.stateNode,5!==(g=g.tag)&&26!==g&&27!==g||null===p||null===h||null!=(g=Nt(f,h))&&d.push(Vu(f,g,p)),A)break;f=f.return}0<d.length&&(l=new c(l,u,null,n,o),a.push({event:l,listeners:d}))}}if(!(7&t)){if(c="mouseout"===e||"pointerout"===e,(!(l="mouseover"===e||"pointerover"===e)||n===Pt||!(u=n.relatedTarget||n.fromElement)||!ze(u)&&!u[Pe])&&(c||l)&&(l=o.window===o?o:(l=o.ownerDocument)?l.defaultView||l.parentWindow:window,c?(c=r,null!==(u=(u=n.relatedTarget||n.toElement)?ze(u):null)&&(A=i(u),d=u.tag,u!==A||5!==d&&27!==d&&6!==d)&&(u=null)):(c=null,u=r),c!==u)){if(d=sn,g="onMouseLeave",h="onMouseEnter",f="mouse","pointerout"!==e&&"pointerover"!==e||(d=yn,g="onPointerLeave",h="onPointerEnter",f="pointer"),A=null==c?l:Ve(c),p=null==u?l:Ve(u),(l=new d(g,f+"leave",c,n,o)).target=A,l.relatedTarget=p,g=null,ze(o)===r&&((d=new d(h,f+"enter",u,n,o)).target=p,d.relatedTarget=A,g=d),A=g,c&&u)e:{for(h=u,f=0,p=d=c;p;p=$u(p))f++;for(p=0,g=h;g;g=$u(g))p++;for(;0<f-p;)d=$u(d),f--;for(;0<p-f;)h=$u(h),p--;for(;f--;){if(d===h||null!==h&&d===h.alternate)break e;d=$u(d),h=$u(h)}d=null}else d=null;null!==c&&Ku(a,l,c,d,!1),null!==u&&null!==A&&Ku(a,A,u,d,!0)}if("select"===(c=(l=r?Ve(r):window).nodeName&&l.nodeName.toLowerCase())||"input"===c&&"file"===l.type)var m=jn;else if(Mn(l))if(Qn)m=Yn;else{m=Kn;var y=$n}else!(c=l.nodeName)||"input"!==c.toLowerCase()||"checkbox"!==l.type&&"radio"!==l.type?r&&It(r.elementType)&&(m=jn):m=Xn;switch(m&&(m=m(e,r))?Ln(a,m,n,o):(y&&y(e,l,r),"focusout"===e&&r&&"number"===l.type&&null!=r.memoizedProps.value&&bt(l,"number",l.value)),y=r?Ve(r):window,e){case"focusin":(Mn(y)||"true"===y.contentEditable)&&(ir=y,sr=r,ar=null);break;case"focusout":ar=sr=ir=null;break;case"mousedown":lr=!0;break;case"contextmenu":case"mouseup":case"dragend":lr=!1,cr(a,n,o);break;case"selectionchange":if(or)break;case"keydown":case"keyup":cr(a,n,o)}var v;if(Cn)e:{switch(e){case"compositionstart":var b="onCompositionStart";break e;case"compositionend":b="onCompositionEnd";break e;case"compositionupdate":b="onCompositionUpdate";break e}b=void 0}else Pn?kn(e,n)&&(b="onCompositionEnd"):"keydown"===e&&229===n.keyCode&&(b="onCompositionStart");b&&(Bn&&"ko"!==n.locale&&(Pn||"onCompositionStart"!==b?"onCompositionEnd"===b&&Pn&&(v=Wt()):(Gt="value"in(Ht=o)?Ht.value:Ht.textContent,Pn=!0)),0<(y=Wu(r,b)).length&&(b=new dn(b,e,null,n,o),a.push({event:b,listeners:y}),v?b.data=v:null!==(v=Tn(n))&&(b.data=v))),(v=En?function(e,t){switch(e){case"compositionend":return Tn(t);case"keypress":return 32!==t.which?null:(Rn=!0,In);case"textInput":return(e=t.data)===In&&Rn?null:e;default:return null}}(e,n):function(e,t){if(Pn)return"compositionend"===e||!Cn&&kn(e,t)?(e=Wt(),Vt=Gt=Ht=null,Pn=!1,e):null;switch(e){case"paste":default:return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return Bn&&"ko"!==t.locale?null:t.data}}(e,n))&&(0<(b=Wu(r,"onBeforeInput")).length&&(y=new dn("onBeforeInput","beforeinput",null,n,o),a.push({event:y,listeners:b}),y.data=v)),function(e,t,n,r,o){if("submit"===t&&n&&n.stateNode===o){var i=Pu((o[Te]||null).action),s=r.submitter;s&&null!==(t=(t=s[Te]||null)?Pu(t.formAction):s.getAttribute("formAction"))&&(i=t,s=null);var a=new tn("action","action",null,r,o);e.push({event:a,listeners:[{instance:null,listener:function(){if(r.defaultPrevented){if(0!==_u){var e=s?Fu(o,s):new FormData(o);Fs(n,{pending:!0,data:e,method:o.method,action:i},null,e)}}else"function"==typeof i&&(a.preventDefault(),e=s?Fu(o,s):new FormData(o),Fs(n,{pending:!0,data:e,method:o.method,action:i},i,e))},currentTarget:o}]})}}(a,e,r,n,o)}Du(a,t)})}function Vu(e,t,n){return{instance:e,listener:t,currentTarget:n}}function Wu(e,t){for(var n=t+"Capture",r=[];null!==e;){var o=e,i=o.stateNode;if(5!==(o=o.tag)&&26!==o&&27!==o||null===i||(null!=(o=Nt(e,n))&&r.unshift(Vu(e,o,i)),null!=(o=Nt(e,t))&&r.push(Vu(e,o,i))),3===e.tag)return r;e=e.return}return[]}function $u(e){if(null===e)return null;do{e=e.return}while(e&&5!==e.tag&&27!==e.tag);return e||null}function Ku(e,t,n,r,o){for(var i=t._reactName,s=[];null!==n&&n!==r;){var a=n,l=a.alternate,c=a.stateNode;if(a=a.tag,null!==l&&l===r)break;5!==a&&26!==a&&27!==a||null===c||(l=c,o?null!=(c=Nt(n,i))&&s.unshift(Vu(n,c,l)):o||null!=(c=Nt(n,i))&&s.push(Vu(n,c,l))),n=n.return}0!==s.length&&e.push({event:t,listeners:s})}var Xu=/\r\n?/g,Yu=/\u0000|\uFFFD/g;function qu(e){return("string"==typeof e?e:""+e).replace(Xu,"\n").replace(Yu,"")}function Ju(e,t){return t=qu(t),qu(e)===t}function Zu(){}function ed(e,t,n,o,i,s){switch(n){case"children":"string"==typeof o?"body"===t||"textarea"===t&&""===o||Ct(e,o):("number"==typeof o||"bigint"==typeof o)&&"body"!==t&&Ct(e,""+o);break;case"className":ot(e,"class",o);break;case"tabIndex":ot(e,"tabindex",o);break;case"dir":case"role":case"viewBox":case"width":case"height":ot(e,n,o);break;case"style":Bt(e,o,s);break;case"data":if("object"!==t){ot(e,"data",o);break}case"src":case"href":if(""===o&&("a"!==t||"href"!==n)){e.removeAttribute(n);break}if(null==o||"function"==typeof o||"symbol"==typeof o||"boolean"==typeof o){e.removeAttribute(n);break}o=Tt(""+o),e.setAttribute(n,o);break;case"action":case"formAction":if("function"==typeof o){e.setAttribute(n,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}if("function"==typeof s&&("formAction"===n?("input"!==t&&ed(e,t,"name",i.name,i,null),ed(e,t,"formEncType",i.formEncType,i,null),ed(e,t,"formMethod",i.formMethod,i,null),ed(e,t,"formTarget",i.formTarget,i,null)):(ed(e,t,"encType",i.encType,i,null),ed(e,t,"method",i.method,i,null),ed(e,t,"target",i.target,i,null))),null==o||"symbol"==typeof o||"boolean"==typeof o){e.removeAttribute(n);break}o=Tt(""+o),e.setAttribute(n,o);break;case"onClick":null!=o&&(e.onclick=Zu);break;case"onScroll":null!=o&&Nu("scroll",e);break;case"onScrollEnd":null!=o&&Nu("scrollend",e);break;case"dangerouslySetInnerHTML":if(null!=o){if("object"!=typeof o||!("__html"in o))throw Error(r(61));if(null!=(n=o.__html)){if(null!=i.children)throw Error(r(60));e.innerHTML=n}}break;case"multiple":e.multiple=o&&"function"!=typeof o&&"symbol"!=typeof o;break;case"muted":e.muted=o&&"function"!=typeof o&&"symbol"!=typeof o;break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":case"autoFocus":break;case"xlinkHref":if(null==o||"function"==typeof o||"boolean"==typeof o||"symbol"==typeof o){e.removeAttribute("xlink:href");break}n=Tt(""+o),e.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",n);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":null!=o&&"function"!=typeof o&&"symbol"!=typeof o?e.setAttribute(n,""+o):e.removeAttribute(n);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":o&&"function"!=typeof o&&"symbol"!=typeof o?e.setAttribute(n,""):e.removeAttribute(n);break;case"capture":case"download":!0===o?e.setAttribute(n,""):!1!==o&&null!=o&&"function"!=typeof o&&"symbol"!=typeof o?e.setAttribute(n,o):e.removeAttribute(n);break;case"cols":case"rows":case"size":case"span":null!=o&&"function"!=typeof o&&"symbol"!=typeof o&&!isNaN(o)&&1<=o?e.setAttribute(n,o):e.removeAttribute(n);break;case"rowSpan":case"start":null==o||"function"==typeof o||"symbol"==typeof o||isNaN(o)?e.removeAttribute(n):e.setAttribute(n,o);break;case"popover":Nu("beforetoggle",e),Nu("toggle",e),rt(e,"popover",o);break;case"xlinkActuate":it(e,"http://www.w3.org/1999/xlink","xlink:actuate",o);break;case"xlinkArcrole":it(e,"http://www.w3.org/1999/xlink","xlink:arcrole",o);break;case"xlinkRole":it(e,"http://www.w3.org/1999/xlink","xlink:role",o);break;case"xlinkShow":it(e,"http://www.w3.org/1999/xlink","xlink:show",o);break;case"xlinkTitle":it(e,"http://www.w3.org/1999/xlink","xlink:title",o);break;case"xlinkType":it(e,"http://www.w3.org/1999/xlink","xlink:type",o);break;case"xmlBase":it(e,"http://www.w3.org/XML/1998/namespace","xml:base",o);break;case"xmlLang":it(e,"http://www.w3.org/XML/1998/namespace","xml:lang",o);break;case"xmlSpace":it(e,"http://www.w3.org/XML/1998/namespace","xml:space",o);break;case"is":rt(e,"is",o);break;case"innerText":case"textContent":break;default:(!(2<n.length)||"o"!==n[0]&&"O"!==n[0]||"n"!==n[1]&&"N"!==n[1])&&rt(e,n=Rt.get(n)||n,o)}}function td(e,t,n,o,i,s){switch(n){case"style":Bt(e,o,s);break;case"dangerouslySetInnerHTML":if(null!=o){if("object"!=typeof o||!("__html"in o))throw Error(r(61));if(null!=(n=o.__html)){if(null!=i.children)throw Error(r(60));e.innerHTML=n}}break;case"children":"string"==typeof o?Ct(e,o):("number"==typeof o||"bigint"==typeof o)&&Ct(e,""+o);break;case"onScroll":null!=o&&Nu("scroll",e);break;case"onScrollEnd":null!=o&&Nu("scrollend",e);break;case"onClick":null!=o&&(e.onclick=Zu);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":case"innerText":case"textContent":break;default:Xe.hasOwnProperty(n)||("o"!==n[0]||"n"!==n[1]||(i=n.endsWith("Capture"),t=n.slice(2,i?n.length-7:void 0),"function"==typeof(s=null!=(s=e[Te]||null)?s[n]:null)&&e.removeEventListener(t,s,i),"function"!=typeof o)?n in e?e[n]=o:!0===o?e.setAttribute(n,""):rt(e,n,o):("function"!=typeof s&&null!==s&&(n in e?e[n]=null:e.hasAttribute(n)&&e.removeAttribute(n)),e.addEventListener(t,o,i)))}}function nd(e,t,n){switch(t){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":Nu("error",e),Nu("load",e);var o,i=!1,s=!1;for(o in n)if(n.hasOwnProperty(o)){var a=n[o];if(null!=a)switch(o){case"src":i=!0;break;case"srcSet":s=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(r(137,t));default:ed(e,t,o,a,n,null)}}return s&&ed(e,t,"srcSet",n.srcSet,n,null),void(i&&ed(e,t,"src",n.src,n,null));case"input":Nu("invalid",e);var l=o=a=s=null,c=null,u=null;for(i in n)if(n.hasOwnProperty(i)){var d=n[i];if(null!=d)switch(i){case"name":s=d;break;case"type":a=d;break;case"checked":c=d;break;case"defaultChecked":u=d;break;case"value":o=d;break;case"defaultValue":l=d;break;case"children":case"dangerouslySetInnerHTML":if(null!=d)throw Error(r(137,t));break;default:ed(e,t,i,d,n,null)}}return vt(e,o,l,c,u,a,s,!1),void ht(e);case"select":for(s in Nu("invalid",e),i=a=o=null,n)if(n.hasOwnProperty(s)&&null!=(l=n[s]))switch(s){case"value":o=l;break;case"defaultValue":a=l;break;case"multiple":i=l;default:ed(e,t,s,l,n,null)}return t=o,n=a,e.multiple=!!i,void(null!=t?wt(e,!!i,t,!1):null!=n&&wt(e,!!i,n,!0));case"textarea":for(a in Nu("invalid",e),o=s=i=null,n)if(n.hasOwnProperty(a)&&null!=(l=n[a]))switch(a){case"value":i=l;break;case"defaultValue":s=l;break;case"children":o=l;break;case"dangerouslySetInnerHTML":if(null!=l)throw Error(r(91));break;default:ed(e,t,a,l,n,null)}return _t(e,i,s,o),void ht(e);case"option":for(c in n)if(n.hasOwnProperty(c)&&null!=(i=n[c]))if("selected"===c)e.selected=i&&"function"!=typeof i&&"symbol"!=typeof i;else ed(e,t,c,i,n,null);return;case"dialog":Nu("beforetoggle",e),Nu("toggle",e),Nu("cancel",e),Nu("close",e);break;case"iframe":case"object":Nu("load",e);break;case"video":case"audio":for(i=0;i<Uu.length;i++)Nu(Uu[i],e);break;case"image":Nu("error",e),Nu("load",e);break;case"details":Nu("toggle",e);break;case"embed":case"source":case"link":Nu("error",e),Nu("load",e);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(u in n)if(n.hasOwnProperty(u)&&null!=(i=n[u]))switch(u){case"children":case"dangerouslySetInnerHTML":throw Error(r(137,t));default:ed(e,t,u,i,n,null)}return;default:if(It(t)){for(d in n)n.hasOwnProperty(d)&&(void 0!==(i=n[d])&&td(e,t,d,i,n,void 0));return}}for(l in n)n.hasOwnProperty(l)&&(null!=(i=n[l])&&ed(e,t,l,i,n,null))}var rd=null,od=null;function id(e){return 9===e.nodeType?e:e.ownerDocument}function sd(e){switch(e){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function ad(e,t){if(0===e)switch(t){case"svg":return 1;case"math":return 2;default:return 0}return 1===e&&"foreignObject"===t?0:e}function ld(e,t){return"textarea"===e||"noscript"===e||"string"==typeof t.children||"number"==typeof t.children||"bigint"==typeof t.children||"object"==typeof t.dangerouslySetInnerHTML&&null!==t.dangerouslySetInnerHTML&&null!=t.dangerouslySetInnerHTML.__html}var cd=null;var ud="function"==typeof setTimeout?setTimeout:void 0,dd="function"==typeof clearTimeout?clearTimeout:void 0,Ad="function"==typeof Promise?Promise:void 0,hd="function"==typeof queueMicrotask?queueMicrotask:void 0!==Ad?function(e){return Ad.resolve(null).then(e).catch(pd)}:ud;function pd(e){setTimeout(function(){throw e})}function fd(e){return"head"===e}function gd(e,t){var n=t,r=0,o=0;do{var i=n.nextSibling;if(e.removeChild(n),i&&8===i.nodeType)if("/$"===(n=i.data)){if(0<r&&8>r){n=r;var s=e.ownerDocument;if(1&n&&_d(s.documentElement),2&n&&_d(s.body),4&n)for(_d(n=s.head),s=n.firstChild;s;){var a=s.nextSibling,l=s.nodeName;s[je]||"SCRIPT"===l||"STYLE"===l||"LINK"===l&&"stylesheet"===s.rel.toLowerCase()||n.removeChild(s),s=a}}if(0===o)return e.removeChild(i),void RA(t);o--}else"$"===n||"$?"===n||"$!"===n?o++:r=n.charCodeAt(0)-48;else r=0;n=i}while(n);RA(t)}function md(e){var t=e.firstChild;for(t&&10===t.nodeType&&(t=t.nextSibling);t;){var n=t;switch(t=t.nextSibling,n.nodeName){case"HTML":case"HEAD":case"BODY":md(n),Qe(n);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if("stylesheet"===n.rel.toLowerCase())continue}e.removeChild(n)}}function yd(e){return"$!"===e.data||"$?"===e.data&&"complete"===e.ownerDocument.readyState}function vd(e){for(;null!=e;e=e.nextSibling){var t=e.nodeType;if(1===t||3===t)break;if(8===t){if("$"===(t=e.data)||"$!"===t||"$?"===t||"F!"===t||"F"===t)break;if("/$"===t)return null}}return e}var bd=null;function wd(e){e=e.previousSibling;for(var t=0;e;){if(8===e.nodeType){var n=e.data;if("$"===n||"$!"===n||"$?"===n){if(0===t)return e;t--}else"/$"===n&&t++}e=e.previousSibling}return null}function xd(e,t,n){switch(t=id(n),e){case"html":if(!(e=t.documentElement))throw Error(r(452));return e;case"head":if(!(e=t.head))throw Error(r(453));return e;case"body":if(!(e=t.body))throw Error(r(454));return e;default:throw Error(r(451))}}function _d(e){for(var t=e.attributes;t.length;)e.removeAttributeNode(t[0]);Qe(e)}var Cd=new Map,Sd=new Set;function Ed(e){return"function"==typeof e.getRootNode?e.getRootNode():9===e.nodeType?e:e.ownerDocument}var Bd=P.d;P.d={f:function(){var e=Bd.f(),t=Hc();return e||t},r:function(e){var t=He(e);null!==t&&5===t.tag&&"form"===t.type?Ls(t):Bd.r(e)},D:function(e){Bd.D(e),Rd("dns-prefetch",e,null)},C:function(e,t){Bd.C(e,t),Rd("preconnect",e,t)},L:function(e,t,n){Bd.L(e,t,n);var r=Id;if(r&&e&&t){var o='link[rel="preload"][as="'+mt(t)+'"]';"image"===t&&n&&n.imageSrcSet?(o+='[imagesrcset="'+mt(n.imageSrcSet)+'"]',"string"==typeof n.imageSizes&&(o+='[imagesizes="'+mt(n.imageSizes)+'"]')):o+='[href="'+mt(e)+'"]';var i=o;switch(t){case"style":i=Td(e);break;case"script":i=Md(e)}Cd.has(i)||(e=c({rel:"preload",href:"image"===t&&n&&n.imageSrcSet?void 0:e,as:t},n),Cd.set(i,e),null!==r.querySelector(o)||"style"===t&&r.querySelector(Pd(i))||"script"===t&&r.querySelector(Ld(i))||(nd(t=r.createElement("link"),"link",e),$e(t),r.head.appendChild(t)))}},m:function(e,t){Bd.m(e,t);var n=Id;if(n&&e){var r=t&&"string"==typeof t.as?t.as:"script",o='link[rel="modulepreload"][as="'+mt(r)+'"][href="'+mt(e)+'"]',i=o;switch(r){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":i=Md(e)}if(!Cd.has(i)&&(e=c({rel:"modulepreload",href:e},t),Cd.set(i,e),null===n.querySelector(o))){switch(r){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(n.querySelector(Ld(i)))return}nd(r=n.createElement("link"),"link",e),$e(r),n.head.appendChild(r)}}},X:function(e,t){Bd.X(e,t);var n=Id;if(n&&e){var r=We(n).hoistableScripts,o=Md(e),i=r.get(o);i||((i=n.querySelector(Ld(o)))||(e=c({src:e,async:!0},t),(t=Cd.get(o))&&Nd(e,t),$e(i=n.createElement("script")),nd(i,"link",e),n.head.appendChild(i)),i={type:"script",instance:i,count:1,state:null},r.set(o,i))}},S:function(e,t,n){Bd.S(e,t,n);var r=Id;if(r&&e){var o=We(r).hoistableStyles,i=Td(e);t=t||"default";var s=o.get(i);if(!s){var a={loading:0,preload:null};if(s=r.querySelector(Pd(i)))a.loading=5;else{e=c({rel:"stylesheet",href:e,"data-precedence":t},n),(n=Cd.get(i))&&Dd(e,n);var l=s=r.createElement("link");$e(l),nd(l,"link",e),l._p=new Promise(function(e,t){l.onload=e,l.onerror=t}),l.addEventListener("load",function(){a.loading|=1}),l.addEventListener("error",function(){a.loading|=2}),a.loading|=4,Od(s,t,r)}s={type:"stylesheet",instance:s,count:1,state:a},o.set(i,s)}}},M:function(e,t){Bd.M(e,t);var n=Id;if(n&&e){var r=We(n).hoistableScripts,o=Md(e),i=r.get(o);i||((i=n.querySelector(Ld(o)))||(e=c({src:e,async:!0,type:"module"},t),(t=Cd.get(o))&&Nd(e,t),$e(i=n.createElement("script")),nd(i,"link",e),n.head.appendChild(i)),i={type:"script",instance:i,count:1,state:null},r.set(o,i))}}};var Id="undefined"==typeof document?null:document;function Rd(e,t,n){var r=Id;if(r&&"string"==typeof t&&t){var o=mt(t);o='link[rel="'+e+'"][href="'+o+'"]',"string"==typeof n&&(o+='[crossorigin="'+n+'"]'),Sd.has(o)||(Sd.add(o),e={rel:e,crossOrigin:n,href:t},null===r.querySelector(o)&&(nd(t=r.createElement("link"),"link",e),$e(t),r.head.appendChild(t)))}}function kd(e,t,n,o){var i,s,a,l,c=(c=Q.current)?Ed(c):null;if(!c)throw Error(r(446));switch(e){case"meta":case"title":return null;case"style":return"string"==typeof n.precedence&&"string"==typeof n.href?(t=Td(n.href),(o=(n=We(c).hoistableStyles).get(t))||(o={type:"style",instance:null,count:0,state:null},n.set(t,o)),o):{type:"void",instance:null,count:0,state:null};case"link":if("stylesheet"===n.rel&&"string"==typeof n.href&&"string"==typeof n.precedence){e=Td(n.href);var u=We(c).hoistableStyles,d=u.get(e);if(d||(c=c.ownerDocument||c,d={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},u.set(e,d),(u=c.querySelector(Pd(e)))&&!u._p&&(d.instance=u,d.state.loading=5),Cd.has(e)||(n={rel:"preload",as:"style",href:n.href,crossOrigin:n.crossOrigin,integrity:n.integrity,media:n.media,hrefLang:n.hrefLang,referrerPolicy:n.referrerPolicy},Cd.set(e,n),u||(i=c,s=e,a=n,l=d.state,i.querySelector('link[rel="preload"][as="style"]['+s+"]")?l.loading=1:(s=i.createElement("link"),l.preload=s,s.addEventListener("load",function(){return l.loading|=1}),s.addEventListener("error",function(){return l.loading|=2}),nd(s,"link",a),$e(s),i.head.appendChild(s))))),t&&null===o)throw Error(r(528,""));return d}if(t&&null!==o)throw Error(r(529,""));return null;case"script":return t=n.async,"string"==typeof(n=n.src)&&t&&"function"!=typeof t&&"symbol"!=typeof t?(t=Md(n),(o=(n=We(c).hoistableScripts).get(t))||(o={type:"script",instance:null,count:0,state:null},n.set(t,o)),o):{type:"void",instance:null,count:0,state:null};default:throw Error(r(444,e))}}function Td(e){return'href="'+mt(e)+'"'}function Pd(e){return'link[rel="stylesheet"]['+e+"]"}function Fd(e){return c({},e,{"data-precedence":e.precedence,precedence:null})}function Md(e){return'[src="'+mt(e)+'"]'}function Ld(e){return"script[async]"+e}function Ud(e,t,n){if(t.count++,null===t.instance)switch(t.type){case"style":var o=e.querySelector('style[data-href~="'+mt(n.href)+'"]');if(o)return t.instance=o,$e(o),o;var i=c({},n,{"data-href":n.href,"data-precedence":n.precedence,href:null,precedence:null});return $e(o=(e.ownerDocument||e).createElement("style")),nd(o,"style",i),Od(o,n.precedence,e),t.instance=o;case"stylesheet":i=Td(n.href);var s=e.querySelector(Pd(i));if(s)return t.state.loading|=4,t.instance=s,$e(s),s;o=Fd(n),(i=Cd.get(i))&&Dd(o,i),$e(s=(e.ownerDocument||e).createElement("link"));var a=s;return a._p=new Promise(function(e,t){a.onload=e,a.onerror=t}),nd(s,"link",o),t.state.loading|=4,Od(s,n.precedence,e),t.instance=s;case"script":return s=Md(n.src),(i=e.querySelector(Ld(s)))?(t.instance=i,$e(i),i):(o=n,(i=Cd.get(s))&&Nd(o=c({},n),i),$e(i=(e=e.ownerDocument||e).createElement("script")),nd(i,"link",o),e.head.appendChild(i),t.instance=i);case"void":return null;default:throw Error(r(443,t.type))}else"stylesheet"===t.type&&!(4&t.state.loading)&&(o=t.instance,t.state.loading|=4,Od(o,n.precedence,e));return t.instance}function Od(e,t,n){for(var r=n.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),o=r.length?r[r.length-1]:null,i=o,s=0;s<r.length;s++){var a=r[s];if(a.dataset.precedence===t)i=a;else if(i!==o)break}i?i.parentNode.insertBefore(e,i.nextSibling):(t=9===n.nodeType?n.head:n).insertBefore(e,t.firstChild)}function Dd(e,t){null==e.crossOrigin&&(e.crossOrigin=t.crossOrigin),null==e.referrerPolicy&&(e.referrerPolicy=t.referrerPolicy),null==e.title&&(e.title=t.title)}function Nd(e,t){null==e.crossOrigin&&(e.crossOrigin=t.crossOrigin),null==e.referrerPolicy&&(e.referrerPolicy=t.referrerPolicy),null==e.integrity&&(e.integrity=t.integrity)}var jd=null;function Qd(e,t,n){if(null===jd){var r=new Map,o=jd=new Map;o.set(n,r)}else(r=(o=jd).get(n))||(r=new Map,o.set(n,r));if(r.has(e))return r;for(r.set(e,null),n=n.getElementsByTagName(e),o=0;o<n.length;o++){var i=n[o];if(!(i[je]||i[ke]||"link"===e&&"stylesheet"===i.getAttribute("rel"))&&"http://www.w3.org/2000/svg"!==i.namespaceURI){var s=i.getAttribute(t)||"";s=e+s;var a=r.get(s);a?a.push(i):r.set(s,[i])}}return r}function zd(e,t,n){(e=e.ownerDocument||e).head.insertBefore(n,"title"===t?e.querySelector("head > title"):null)}function Hd(e){return!!("stylesheet"!==e.type||3&e.state.loading)}var Gd=null;function Vd(){}function Wd(){if(this.count--,0===this.count)if(this.stylesheets)Kd(this,this.stylesheets);else if(this.unsuspend){var e=this.unsuspend;this.unsuspend=null,e()}}var $d=null;function Kd(e,t){e.stylesheets=null,null!==e.unsuspend&&(e.count++,$d=new Map,t.forEach(Xd,e),$d=null,Wd.call(e))}function Xd(e,t){if(!(4&t.state.loading)){var n=$d.get(e);if(n)var r=n.get(null);else{n=new Map,$d.set(e,n);for(var o=e.querySelectorAll("link[data-precedence],style[data-precedence]"),i=0;i<o.length;i++){var s=o[i];"LINK"!==s.nodeName&&"not all"===s.getAttribute("media")||(n.set(s.dataset.precedence,s),r=s)}r&&n.set(null,r)}s=(o=t.instance).getAttribute("data-precedence"),(i=n.get(s)||r)===r&&n.set(null,o),n.set(s,o),this.count++,r=Wd.bind(this),o.addEventListener("load",r),o.addEventListener("error",r),i?i.parentNode.insertBefore(o,i.nextSibling):(e=9===e.nodeType?e.head:e).insertBefore(o,e.firstChild),t.state.loading|=4}}var Yd={$$typeof:y,Provider:null,Consumer:null,_currentValue:F,_currentValue2:F,_threadCount:0};function qd(e,t,n,r,o,i,s,a){this.tag=1,this.containerInfo=e,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=xe(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=xe(0),this.hiddenUpdates=xe(null),this.identifierPrefix=r,this.onUncaughtError=o,this.onCaughtError=i,this.onRecoverableError=s,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=a,this.incompleteTransitions=new Map}function Jd(e,t,n,r,o,i,s,a,l,c,u,d){return e=new qd(e,t,n,s,a,l,c,d),t=1,!0===i&&(t|=24),i=Dr(3,null,null,t),e.current=i,i.stateNode=e,(t=Uo()).refCount++,e.pooledCache=t,t.refCount++,i.memoizedState={element:r,isDehydrated:n,cache:t},ii(i),e}function Zd(e){return e?e=Ur:Ur}function eA(e,t,n,r,o,i){o=Zd(o),null===r.context?r.context=o:r.pendingContext=o,(r=ai(t)).payload={element:n},null!==(i=void 0===i?null:i)&&(r.callback=i),null!==(n=li(e,r,t))&&(Dc(n,0,t),ci(n,e,t))}function tA(e,t){if(null!==(e=e.memoizedState)&&null!==e.dehydrated){var n=e.retryLane;e.retryLane=0!==n&&n<t?n:t}}function nA(e,t){tA(e,t),(e=e.alternate)&&tA(e,t)}function rA(e){if(13===e.tag){var t=Fr(e,67108864);null!==t&&Dc(t,0,67108864),nA(e,67108864)}}var oA=!0;function iA(e,t,n,r){var o=T.T;T.T=null;var i=P.p;try{P.p=2,aA(e,t,n,r)}finally{P.p=i,T.T=o}}function sA(e,t,n,r){var o=T.T;T.T=null;var i=P.p;try{P.p=8,aA(e,t,n,r)}finally{P.p=i,T.T=o}}function aA(e,t,n,r){if(oA){var o=lA(r);if(null===o)Gu(e,t,r,cA,n),bA(e,r);else if(function(e,t,n,r,o){switch(t){case"focusin":return hA=wA(hA,e,t,n,r,o),!0;case"dragenter":return pA=wA(pA,e,t,n,r,o),!0;case"mouseover":return fA=wA(fA,e,t,n,r,o),!0;case"pointerover":var i=o.pointerId;return gA.set(i,wA(gA.get(i)||null,e,t,n,r,o)),!0;case"gotpointercapture":return i=o.pointerId,mA.set(i,wA(mA.get(i)||null,e,t,n,r,o)),!0}return!1}(o,e,t,n,r))r.stopPropagation();else if(bA(e,r),4&t&&-1<vA.indexOf(e)){for(;null!==o;){var i=He(o);if(null!==i)switch(i.tag){case 3:if((i=i.stateNode).current.memoizedState.isDehydrated){var s=ge(i.pendingLanes);if(0!==s){var a=i;for(a.pendingLanes|=2,a.entangledLanes|=2;s;){var l=1<<31-ue(s);a.entanglements[1]|=l,s&=~l}Cu(i),!(6&oc)&&(Cc=J()+500,Su(0))}}break;case 13:null!==(a=Fr(i,2))&&Dc(a,0,2),Hc(),nA(i,2)}if(null===(i=lA(r))&&Gu(e,t,r,cA,n),i===o)break;o=i}null!==o&&r.stopPropagation()}else Gu(e,t,r,null,n)}}function lA(e){return uA(e=Ft(e))}var cA=null;function uA(e){if(cA=null,null!==(e=ze(e))){var t=i(e);if(null===t)e=null;else{var n=t.tag;if(13===n){if(null!==(e=s(t)))return e;e=null}else if(3===n){if(t.stateNode.current.memoizedState.isDehydrated)return 3===t.tag?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null)}}return cA=e,null}function dA(e){switch(e){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(Z()){case ee:return 2;case te:return 8;case ne:case re:return 32;case oe:return 268435456;default:return 32}default:return 32}}var AA=!1,hA=null,pA=null,fA=null,gA=new Map,mA=new Map,yA=[],vA="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function bA(e,t){switch(e){case"focusin":case"focusout":hA=null;break;case"dragenter":case"dragleave":pA=null;break;case"mouseover":case"mouseout":fA=null;break;case"pointerover":case"pointerout":gA.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":mA.delete(t.pointerId)}}function wA(e,t,n,r,o,i){return null===e||e.nativeEvent!==i?(e={blockedOn:t,domEventName:n,eventSystemFlags:r,nativeEvent:i,targetContainers:[o]},null!==t&&(null!==(t=He(t))&&rA(t)),e):(e.eventSystemFlags|=r,t=e.targetContainers,null!==o&&-1===t.indexOf(o)&&t.push(o),e)}function xA(e){var t=ze(e.target);if(null!==t){var n=i(t);if(null!==n)if(13===(t=n.tag)){if(null!==(t=s(n)))return e.blockedOn=t,void function(e,t){var n=P.p;try{return P.p=e,t()}finally{P.p=n}}(e.priority,function(){if(13===n.tag){var e=Uc();e=Ee(e);var t=Fr(n,e);null!==t&&Dc(t,0,e),nA(n,e)}})}else if(3===t&&n.stateNode.current.memoizedState.isDehydrated)return void(e.blockedOn=3===n.tag?n.stateNode.containerInfo:null)}e.blockedOn=null}function _A(e){if(null!==e.blockedOn)return!1;for(var t=e.targetContainers;0<t.length;){var n=lA(e.nativeEvent);if(null!==n)return null!==(t=He(n))&&rA(t),e.blockedOn=n,!1;var r=new(n=e.nativeEvent).constructor(n.type,n);Pt=r,n.target.dispatchEvent(r),Pt=null,t.shift()}return!0}function CA(e,t,n){_A(e)&&n.delete(t)}function SA(){AA=!1,null!==hA&&_A(hA)&&(hA=null),null!==pA&&_A(pA)&&(pA=null),null!==fA&&_A(fA)&&(fA=null),gA.forEach(CA),mA.forEach(CA)}function EA(t,n){t.blockedOn===n&&(t.blockedOn=null,AA||(AA=!0,e.unstable_scheduleCallback(e.unstable_NormalPriority,SA)))}var BA=null;function IA(t){BA!==t&&(BA=t,e.unstable_scheduleCallback(e.unstable_NormalPriority,function(){BA===t&&(BA=null);for(var e=0;e<t.length;e+=3){var n=t[e],r=t[e+1],o=t[e+2];if("function"!=typeof r){if(null===uA(r||n))continue;break}var i=He(n);null!==i&&(t.splice(e,3),e-=3,Fs(i,{pending:!0,data:o,method:n.method,action:r},r,o))}}))}function RA(e){function t(t){return EA(t,e)}null!==hA&&EA(hA,e),null!==pA&&EA(pA,e),null!==fA&&EA(fA,e),gA.forEach(t),mA.forEach(t);for(var n=0;n<yA.length;n++){var r=yA[n];r.blockedOn===e&&(r.blockedOn=null)}for(;0<yA.length&&null===(n=yA[0]).blockedOn;)xA(n),null===n.blockedOn&&yA.shift();if(null!=(n=(e.ownerDocument||e).$$reactFormReplay))for(r=0;r<n.length;r+=3){var o=n[r],i=n[r+1],s=o[Te]||null;if("function"==typeof i)s||IA(n);else if(s){var a=null;if(i&&i.hasAttribute("formAction")){if(o=i,s=i[Te]||null)a=s.formAction;else if(null!==uA(o))continue}else a=s.action;"function"==typeof a?n[r+1]=a:(n.splice(r,3),r-=3),IA(n)}}}function kA(e){this._internalRoot=e}function TA(e){this._internalRoot=e}TA.prototype.render=kA.prototype.render=function(e){var t=this._internalRoot;if(null===t)throw Error(r(409));eA(t.current,Uc(),e,t,null,null)},TA.prototype.unmount=kA.prototype.unmount=function(){var e=this._internalRoot;if(null!==e){this._internalRoot=null;var t=e.containerInfo;eA(e.current,2,null,e,null,null),Hc(),t[Pe]=null}},TA.prototype.unstable_scheduleHydration=function(e){if(e){var t=Ie();e={blockedOn:null,target:e,priority:t};for(var n=0;n<yA.length&&0!==t&&t<yA[n].priority;n++);yA.splice(n,0,e),0===n&&xA(e)}};var PA=t.version;if("19.1.1"!==PA)throw Error(r(527,PA,"19.1.1"));P.findDOMNode=function(e){var t=e._reactInternals;if(void 0===t){if("function"==typeof e.render)throw Error(r(188));throw e=Object.keys(e).join(","),Error(r(268,e))}return e=function(e){var t=e.alternate;if(!t){if(null===(t=i(e)))throw Error(r(188));return t!==e?null:e}for(var n=e,o=t;;){var s=n.return;if(null===s)break;var l=s.alternate;if(null===l){if(null!==(o=s.return)){n=o;continue}break}if(s.child===l.child){for(l=s.child;l;){if(l===n)return a(s),e;if(l===o)return a(s),t;l=l.sibling}throw Error(r(188))}if(n.return!==o.return)n=s,o=l;else{for(var c=!1,u=s.child;u;){if(u===n){c=!0,n=s,o=l;break}if(u===o){c=!0,o=s,n=l;break}u=u.sibling}if(!c){for(u=l.child;u;){if(u===n){c=!0,n=l,o=s;break}if(u===o){c=!0,o=l,n=s;break}u=u.sibling}if(!c)throw Error(r(189))}}if(n.alternate!==o)throw Error(r(190))}if(3!==n.tag)throw Error(r(188));return n.stateNode.current===n?e:t}(t),e=null===(e=null!==e?l(e):null)?null:e.stateNode};var FA={bundleType:0,version:"19.1.1",rendererPackageName:"react-dom",currentDispatcherRef:T,reconcilerVersion:"19.1.1"};if("undefined"!=typeof __REACT_DEVTOOLS_GLOBAL_HOOK__){var MA=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!MA.isDisabled&&MA.supportsFiber)try{ae=MA.inject(FA),le=MA}catch(UA){}}return Fe.createRoot=function(e,t){if(!o(e))throw Error(r(299));var n=!1,i="",s=ba,a=wa,l=xa;return null!=t&&(!0===t.unstable_strictMode&&(n=!0),void 0!==t.identifierPrefix&&(i=t.identifierPrefix),void 0!==t.onUncaughtError&&(s=t.onUncaughtError),void 0!==t.onCaughtError&&(a=t.onCaughtError),void 0!==t.onRecoverableError&&(l=t.onRecoverableError),void 0!==t.unstable_transitionCallbacks&&t.unstable_transitionCallbacks),t=Jd(e,1,!1,null,0,n,i,s,a,l,0,null),e[Pe]=t.current,zu(e),new kA(t)},Fe.hydrateRoot=function(e,t,n){if(!o(e))throw Error(r(299));var i=!1,s="",a=ba,l=wa,c=xa,u=null;return null!=n&&(!0===n.unstable_strictMode&&(i=!0),void 0!==n.identifierPrefix&&(s=n.identifierPrefix),void 0!==n.onUncaughtError&&(a=n.onUncaughtError),void 0!==n.onCaughtError&&(l=n.onCaughtError),void 0!==n.onRecoverableError&&(c=n.onRecoverableError),void 0!==n.unstable_transitionCallbacks&&n.unstable_transitionCallbacks,void 0!==n.formState&&(u=n.formState)),(t=Jd(e,1,!0,t,0,i,s,a,l,c,0,u)).context=Zd(null),n=t.current,(s=ai(i=Ee(i=Uc()))).callback=null,li(n,s,i),n=i,t.current.lanes=n,_e(t,n),Cu(t),e[Pe]=t.current,zu(e),new TA(t)},Fe.version="19.1.1",Fe}var We=(je||(je=1,function e(){if("undefined"!=typeof __REACT_DEVTOOLS_GLOBAL_HOOK__&&"function"==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE)try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(t){}}(),Pe.exports=Ve()),Pe.exports);function $e(e,...t){const n=new URL(`https://mui.com/production-error/?code=${e}`);return t.forEach(e=>n.searchParams.append("args[]",e)),`Minified MUI error #${e}; visit ${n} for the full message.`}function Ke(){return Ke=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)({}).hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},Ke.apply(null,arguments)}var Xe=function(){function e(e){var t=this;this._insertTag=function(e){var n;n=0===t.tags.length?t.insertionPoint?t.insertionPoint.nextSibling:t.prepend?t.container.firstChild:t.before:t.tags[t.tags.length-1].nextSibling,t.container.insertBefore(e,n),t.tags.push(e)},this.isSpeedy=void 0===e.speedy||e.speedy,this.tags=[],this.ctr=0,this.nonce=e.nonce,this.key=e.key,this.container=e.container,this.prepend=e.prepend,this.insertionPoint=e.insertionPoint,this.before=null}var t=e.prototype;return t.hydrate=function(e){e.forEach(this._insertTag)},t.insert=function(e){this.ctr%(this.isSpeedy?65e3:1)==0&&this._insertTag(function(e){var t=document.createElement("style");return t.setAttribute("data-emotion",e.key),void 0!==e.nonce&&t.setAttribute("nonce",e.nonce),t.appendChild(document.createTextNode("")),t.setAttribute("data-s",""),t}(this));var t=this.tags[this.tags.length-1];if(this.isSpeedy){var n=function(e){if(e.sheet)return e.sheet;for(var t=0;t<document.styleSheets.length;t++)if(document.styleSheets[t].ownerNode===e)return document.styleSheets[t]}(t);try{n.insertRule(e,n.cssRules.length)}catch(r){}}else t.appendChild(document.createTextNode(e));this.ctr++},t.flush=function(){this.tags.forEach(function(e){var t;return null==(t=e.parentNode)?void 0:t.removeChild(e)}),this.tags=[],this.ctr=0},e}(),Ye="-ms-",qe="-moz-",Je="-webkit-",Ze="comm",et="rule",tt="decl",nt="@keyframes",rt=Math.abs,ot=String.fromCharCode,it=Object.assign;function st(e){return e.trim()}function at(e,t,n){return e.replace(t,n)}function lt(e,t){return e.indexOf(t)}function ct(e,t){return 0|e.charCodeAt(t)}function ut(e,t,n){return e.slice(t,n)}function dt(e){return e.length}function At(e){return e.length}function ht(e,t){return t.push(e),e}var pt=1,ft=1,gt=0,mt=0,yt=0,vt="";function bt(e,t,n,r,o,i,s){return{value:e,root:t,parent:n,type:r,props:o,children:i,line:pt,column:ft,length:s,return:""}}function wt(e,t){return it(bt("",null,null,"",null,null,0),e,{length:-e.length},t)}function xt(){return yt=mt>0?ct(vt,--mt):0,ft--,10===yt&&(ft=1,pt--),yt}function _t(){return yt=mt<gt?ct(vt,mt++):0,ft++,10===yt&&(ft=1,pt++),yt}function Ct(){return ct(vt,mt)}function St(){return mt}function Et(e,t){return ut(vt,e,t)}function Bt(e){switch(e){case 0:case 9:case 10:case 13:case 32:return 5;case 33:case 43:case 44:case 47:case 62:case 64:case 126:case 59:case 123:case 125:return 4;case 58:return 3;case 34:case 39:case 40:case 91:return 2;case 41:case 93:return 1}return 0}function It(e){return pt=ft=1,gt=dt(vt=e),mt=0,[]}function Rt(e){return vt="",e}function kt(e){return st(Et(mt-1,Ft(91===e?e+2:40===e?e+1:e)))}function Tt(e){for(;(yt=Ct())&&yt<33;)_t();return Bt(e)>2||Bt(yt)>3?"":" "}function Pt(e,t){for(;--t&&_t()&&!(yt<48||yt>102||yt>57&&yt<65||yt>70&&yt<97););return Et(e,St()+(t<6&&32==Ct()&&32==_t()))}function Ft(e){for(;_t();)switch(yt){case e:return mt;case 34:case 39:34!==e&&39!==e&&Ft(yt);break;case 40:41===e&&Ft(e);break;case 92:_t()}return mt}function Mt(e,t){for(;_t()&&e+yt!==57&&(e+yt!==84||47!==Ct()););return"/*"+Et(t,mt-1)+"*"+ot(47===e?e:_t())}function Lt(e){for(;!Bt(Ct());)_t();return Et(e,mt)}function Ut(e){return Rt(Ot("",null,null,null,[""],e=It(e),0,[0],e))}function Ot(e,t,n,r,o,i,s,a,l){for(var c=0,u=0,d=s,A=0,h=0,p=0,f=1,g=1,m=1,y=0,v="",b=o,w=i,x=r,_=v;g;)switch(p=y,y=_t()){case 40:if(108!=p&&58==ct(_,d-1)){-1!=lt(_+=at(kt(y),"&","&\f"),"&\f")&&(m=-1);break}case 34:case 39:case 91:_+=kt(y);break;case 9:case 10:case 13:case 32:_+=Tt(p);break;case 92:_+=Pt(St()-1,7);continue;case 47:switch(Ct()){case 42:case 47:ht(Nt(Mt(_t(),St()),t,n),l);break;default:_+="/"}break;case 123*f:a[c++]=dt(_)*m;case 125*f:case 59:case 0:switch(y){case 0:case 125:g=0;case 59+u:-1==m&&(_=at(_,/\f/g,"")),h>0&&dt(_)-d&&ht(h>32?jt(_+";",r,n,d-1):jt(at(_," ","")+";",r,n,d-2),l);break;case 59:_+=";";default:if(ht(x=Dt(_,t,n,c,u,o,a,v,b=[],w=[],d),i),123===y)if(0===u)Ot(_,t,x,x,b,i,d,a,w);else switch(99===A&&110===ct(_,3)?100:A){case 100:case 108:case 109:case 115:Ot(e,x,x,r&&ht(Dt(e,x,x,0,0,o,a,v,o,b=[],d),w),o,w,d,a,r?b:w);break;default:Ot(_,x,x,x,[""],w,0,a,w)}}c=u=h=0,f=m=1,v=_="",d=s;break;case 58:d=1+dt(_),h=p;default:if(f<1)if(123==y)--f;else if(125==y&&0==f++&&125==xt())continue;switch(_+=ot(y),y*f){case 38:m=u>0?1:(_+="\f",-1);break;case 44:a[c++]=(dt(_)-1)*m,m=1;break;case 64:45===Ct()&&(_+=kt(_t())),A=Ct(),u=d=dt(v=_+=Lt(St())),y++;break;case 45:45===p&&2==dt(_)&&(f=0)}}return i}function Dt(e,t,n,r,o,i,s,a,l,c,u){for(var d=o-1,A=0===o?i:[""],h=At(A),p=0,f=0,g=0;p<r;++p)for(var m=0,y=ut(e,d+1,d=rt(f=s[p])),v=e;m<h;++m)(v=st(f>0?A[m]+" "+y:at(y,/&\f/g,A[m])))&&(l[g++]=v);return bt(e,t,n,0===o?et:a,l,c,u)}function Nt(e,t,n){return bt(e,t,n,Ze,ot(yt),ut(e,2,-2),0)}function jt(e,t,n,r){return bt(e,t,n,tt,ut(e,0,r),ut(e,r+1,-1),r)}function Qt(e,t){for(var n="",r=At(e),o=0;o<r;o++)n+=t(e[o],o,e,t)||"";return n}function zt(e,t,n,r){switch(e.type){case"@layer":if(e.children.length)break;case"@import":case tt:return e.return=e.return||e.value;case Ze:return"";case nt:return e.return=e.value+"{"+Qt(e.children,r)+"}";case et:e.value=e.props.join(",")}return dt(n=Qt(e.children,r))?e.return=e.value+"{"+n+"}":""}function Ht(e){var t=Object.create(null);return function(n){return void 0===t[n]&&(t[n]=e(n)),t[n]}}var Gt=function(e,t,n){for(var r=0,o=0;r=o,o=Ct(),38===r&&12===o&&(t[n]=1),!Bt(o);)_t();return Et(e,mt)},Vt=function(e,t){return Rt(function(e,t){var n=-1,r=44;do{switch(Bt(r)){case 0:38===r&&12===Ct()&&(t[n]=1),e[n]+=Gt(mt-1,t,n);break;case 2:e[n]+=kt(r);break;case 4:if(44===r){e[++n]=58===Ct()?"&\f":"",t[n]=e[n].length;break}default:e[n]+=ot(r)}}while(r=_t());return e}(It(e),t))},Wt=new WeakMap,$t=function(e){if("rule"===e.type&&e.parent&&!(e.length<1)){for(var t=e.value,n=e.parent,r=e.column===n.column&&e.line===n.line;"rule"!==n.type;)if(!(n=n.parent))return;if((1!==e.props.length||58===t.charCodeAt(0)||Wt.get(n))&&!r){Wt.set(e,!0);for(var o=[],i=Vt(t,o),s=n.props,a=0,l=0;a<i.length;a++)for(var c=0;c<s.length;c++,l++)e.props[l]=o[a]?i[a].replace(/&\f/g,s[c]):s[c]+" "+i[a]}}},Kt=function(e){if("decl"===e.type){var t=e.value;108===t.charCodeAt(0)&&98===t.charCodeAt(2)&&(e.return="",e.value="")}};function Xt(e,t){switch(function(e,t){return 45^ct(e,0)?(((t<<2^ct(e,0))<<2^ct(e,1))<<2^ct(e,2))<<2^ct(e,3):0}(e,t)){case 5103:return Je+"print-"+e+e;case 5737:case 4201:case 3177:case 3433:case 1641:case 4457:case 2921:case 5572:case 6356:case 5844:case 3191:case 6645:case 3005:case 6391:case 5879:case 5623:case 6135:case 4599:case 4855:case 4215:case 6389:case 5109:case 5365:case 5621:case 3829:return Je+e+e;case 5349:case 4246:case 4810:case 6968:case 2756:return Je+e+qe+e+Ye+e+e;case 6828:case 4268:return Je+e+Ye+e+e;case 6165:return Je+e+Ye+"flex-"+e+e;case 5187:return Je+e+at(e,/(\w+).+(:[^]+)/,Je+"box-$1$2"+Ye+"flex-$1$2")+e;case 5443:return Je+e+Ye+"flex-item-"+at(e,/flex-|-self/,"")+e;case 4675:return Je+e+Ye+"flex-line-pack"+at(e,/align-content|flex-|-self/,"")+e;case 5548:return Je+e+Ye+at(e,"shrink","negative")+e;case 5292:return Je+e+Ye+at(e,"basis","preferred-size")+e;case 6060:return Je+"box-"+at(e,"-grow","")+Je+e+Ye+at(e,"grow","positive")+e;case 4554:return Je+at(e,/([^-])(transform)/g,"$1"+Je+"$2")+e;case 6187:return at(at(at(e,/(zoom-|grab)/,Je+"$1"),/(image-set)/,Je+"$1"),e,"")+e;case 5495:case 3959:return at(e,/(image-set\([^]*)/,Je+"$1$`$1");case 4968:return at(at(e,/(.+:)(flex-)?(.*)/,Je+"box-pack:$3"+Ye+"flex-pack:$3"),/s.+-b[^;]+/,"justify")+Je+e+e;case 4095:case 3583:case 4068:case 2532:return at(e,/(.+)-inline(.+)/,Je+"$1$2")+e;case 8116:case 7059:case 5753:case 5535:case 5445:case 5701:case 4933:case 4677:case 5533:case 5789:case 5021:case 4765:if(dt(e)-1-t>6)switch(ct(e,t+1)){case 109:if(45!==ct(e,t+4))break;case 102:return at(e,/(.+:)(.+)-([^]+)/,"$1"+Je+"$2-$3$1"+qe+(108==ct(e,t+3)?"$3":"$2-$3"))+e;case 115:return~lt(e,"stretch")?Xt(at(e,"stretch","fill-available"),t)+e:e}break;case 4949:if(115!==ct(e,t+1))break;case 6444:switch(ct(e,dt(e)-3-(~lt(e,"!important")&&10))){case 107:return at(e,":",":"+Je)+e;case 101:return at(e,/(.+:)([^;!]+)(;|!.+)?/,"$1"+Je+(45===ct(e,14)?"inline-":"")+"box$3$1"+Je+"$2$3$1"+Ye+"$2box$3")+e}break;case 5936:switch(ct(e,t+11)){case 114:return Je+e+Ye+at(e,/[svh]\w+-[tblr]{2}/,"tb")+e;case 108:return Je+e+Ye+at(e,/[svh]\w+-[tblr]{2}/,"tb-rl")+e;case 45:return Je+e+Ye+at(e,/[svh]\w+-[tblr]{2}/,"lr")+e}return Je+e+Ye+e+e}return e}var Yt,qt,Jt,Zt,en=[function(e,t,n,r){if(e.length>-1&&!e.return)switch(e.type){case tt:e.return=Xt(e.value,e.length);break;case nt:return Qt([wt(e,{value:at(e.value,"@","@"+Je)})],r);case et:if(e.length)return function(e,t){return e.map(t).join("")}(e.props,function(t){switch(function(e,t){return(e=t.exec(e))?e[0]:e}(t,/(::plac\w+|:read-\w+)/)){case":read-only":case":read-write":return Qt([wt(e,{props:[at(t,/:(read-\w+)/,":-moz-$1")]})],r);case"::placeholder":return Qt([wt(e,{props:[at(t,/:(plac\w+)/,":"+Je+"input-$1")]}),wt(e,{props:[at(t,/:(plac\w+)/,":-moz-$1")]}),wt(e,{props:[at(t,/:(plac\w+)/,Ye+"input-$1")]})],r)}return""})}}],tn=function(e){var t=e.key;if("css"===t){var n=document.querySelectorAll("style[data-emotion]:not([data-s])");Array.prototype.forEach.call(n,function(e){-1!==e.getAttribute("data-emotion").indexOf(" ")&&(document.head.appendChild(e),e.setAttribute("data-s",""))})}var r,o,i=e.stylisPlugins||en,s={},a=[];r=e.container||document.head,Array.prototype.forEach.call(document.querySelectorAll('style[data-emotion^="'+t+' "]'),function(e){for(var t=e.getAttribute("data-emotion").split(" "),n=1;n<t.length;n++)s[t[n]]=!0;a.push(e)});var l,c,u,d,A=[zt,(d=function(e){l.insert(e)},function(e){e.root||(e=e.return)&&d(e)})],h=(c=[$t,Kt].concat(i,A),u=At(c),function(e,t,n,r){for(var o="",i=0;i<u;i++)o+=c[i](e,t,n,r)||"";return o});o=function(e,t,n,r){l=n,Qt(Ut(e?e+"{"+t.styles+"}":t.styles),h),r&&(p.inserted[t.name]=!0)};var p={key:t,sheet:new Xe({key:t,container:r,nonce:e.nonce,speedy:e.speedy,prepend:e.prepend,insertionPoint:e.insertionPoint}),nonce:e.nonce,inserted:s,registered:{},insert:o};return p.sheet.hydrate(a),p},nn={exports:{}},rn={};function on(){return qt||(qt=1,nn.exports=function(){if(Yt)return rn;Yt=1;var e="function"==typeof Symbol&&Symbol.for,t=e?Symbol.for("react.element"):60103,n=e?Symbol.for("react.portal"):60106,r=e?Symbol.for("react.fragment"):60107,o=e?Symbol.for("react.strict_mode"):60108,i=e?Symbol.for("react.profiler"):60114,s=e?Symbol.for("react.provider"):60109,a=e?Symbol.for("react.context"):60110,l=e?Symbol.for("react.async_mode"):60111,c=e?Symbol.for("react.concurrent_mode"):60111,u=e?Symbol.for("react.forward_ref"):60112,d=e?Symbol.for("react.suspense"):60113,A=e?Symbol.for("react.suspense_list"):60120,h=e?Symbol.for("react.memo"):60115,p=e?Symbol.for("react.lazy"):60116,f=e?Symbol.for("react.block"):60121,g=e?Symbol.for("react.fundamental"):60117,m=e?Symbol.for("react.responder"):60118,y=e?Symbol.for("react.scope"):60119;function v(e){if("object"==typeof e&&null!==e){var A=e.$$typeof;switch(A){case t:switch(e=e.type){case l:case c:case r:case i:case o:case d:return e;default:switch(e=e&&e.$$typeof){case a:case u:case p:case h:case s:return e;default:return A}}case n:return A}}}function b(e){return v(e)===c}return rn.AsyncMode=l,rn.ConcurrentMode=c,rn.ContextConsumer=a,rn.ContextProvider=s,rn.Element=t,rn.ForwardRef=u,rn.Fragment=r,rn.Lazy=p,rn.Memo=h,rn.Portal=n,rn.Profiler=i,rn.StrictMode=o,rn.Suspense=d,rn.isAsyncMode=function(e){return b(e)||v(e)===l},rn.isConcurrentMode=b,rn.isContextConsumer=function(e){return v(e)===a},rn.isContextProvider=function(e){return v(e)===s},rn.isElement=function(e){return"object"==typeof e&&null!==e&&e.$$typeof===t},rn.isForwardRef=function(e){return v(e)===u},rn.isFragment=function(e){return v(e)===r},rn.isLazy=function(e){return v(e)===p},rn.isMemo=function(e){return v(e)===h},rn.isPortal=function(e){return v(e)===n},rn.isProfiler=function(e){return v(e)===i},rn.isStrictMode=function(e){return v(e)===o},rn.isSuspense=function(e){return v(e)===d},rn.isValidElementType=function(e){return"string"==typeof e||"function"==typeof e||e===r||e===c||e===i||e===o||e===d||e===A||"object"==typeof e&&null!==e&&(e.$$typeof===p||e.$$typeof===h||e.$$typeof===s||e.$$typeof===a||e.$$typeof===u||e.$$typeof===g||e.$$typeof===m||e.$$typeof===y||e.$$typeof===f)},rn.typeOf=v,rn}()),nn.exports}!function(){if(Zt)return Jt;Zt=1;var e=on(),t={childContextTypes:!0,contextType:!0,contextTypes:!0,defaultProps:!0,displayName:!0,getDefaultProps:!0,getDerivedStateFromError:!0,getDerivedStateFromProps:!0,mixins:!0,propTypes:!0,type:!0},n={name:!0,length:!0,prototype:!0,caller:!0,callee:!0,arguments:!0,arity:!0},r={$$typeof:!0,compare:!0,defaultProps:!0,displayName:!0,propTypes:!0,type:!0},o={};function i(n){return e.isMemo(n)?r:o[n.$$typeof]||t}o[e.ForwardRef]={$$typeof:!0,render:!0,defaultProps:!0,displayName:!0,propTypes:!0},o[e.Memo]=r;var s=Object.defineProperty,a=Object.getOwnPropertyNames,l=Object.getOwnPropertySymbols,c=Object.getOwnPropertyDescriptor,u=Object.getPrototypeOf,d=Object.prototype;Jt=function e(t,r,o){if("string"!=typeof r){if(d){var A=u(r);A&&A!==d&&e(t,A,o)}var h=a(r);l&&(h=h.concat(l(r)));for(var p=i(t),f=i(r),g=0;g<h.length;++g){var m=h[g];if(!(n[m]||o&&o[m]||f&&f[m]||p&&p[m])){var y=c(r,m);try{s(t,m,y)}catch(v){}}}}return t}}();function sn(e,t,n){var r="";return n.split(" ").forEach(function(n){void 0!==e[n]?t.push(e[n]+";"):n&&(r+=n+" ")}),r}var an=function(e,t,n){var r=e.key+"-"+t.name;!1===n&&void 0===e.registered[r]&&(e.registered[r]=t.styles)},ln=function(e,t,n){an(e,t,n);var r=e.key+"-"+t.name;if(void 0===e.inserted[t.name]){var o=t;do{e.insert(t===o?"."+r:"",o,e.sheet,!0),o=o.next}while(void 0!==o)}};var cn={animationIterationCount:1,aspectRatio:1,borderImageOutset:1,borderImageSlice:1,borderImageWidth:1,boxFlex:1,boxFlexGroup:1,boxOrdinalGroup:1,columnCount:1,columns:1,flex:1,flexGrow:1,flexPositive:1,flexShrink:1,flexNegative:1,flexOrder:1,gridRow:1,gridRowEnd:1,gridRowSpan:1,gridRowStart:1,gridColumn:1,gridColumnEnd:1,gridColumnSpan:1,gridColumnStart:1,msGridRow:1,msGridRowSpan:1,msGridColumn:1,msGridColumnSpan:1,fontWeight:1,lineHeight:1,opacity:1,order:1,orphans:1,scale:1,tabSize:1,widows:1,zIndex:1,zoom:1,WebkitLineClamp:1,fillOpacity:1,floodOpacity:1,stopOpacity:1,strokeDasharray:1,strokeDashoffset:1,strokeMiterlimit:1,strokeOpacity:1,strokeWidth:1},un=/[A-Z]|^ms/g,dn=/_EMO_([^_]+?)_([^]*?)_EMO_/g,An=function(e){return 45===e.charCodeAt(1)},hn=function(e){return null!=e&&"boolean"!=typeof e},pn=Ht(function(e){return An(e)?e:e.replace(un,"-$&").toLowerCase()}),fn=function(e,t){switch(e){case"animation":case"animationName":if("string"==typeof t)return t.replace(dn,function(e,t,n){return mn={name:t,styles:n,next:mn},t})}return 1===cn[e]||An(e)||"number"!=typeof t||0===t?t:t+"px"};function gn(e,t,n){if(null==n)return"";var r=n;if(void 0!==r.__emotion_styles)return r;switch(typeof n){case"boolean":return"";case"object":var o=n;if(1===o.anim)return mn={name:o.name,styles:o.styles,next:mn},o.name;var i=n;if(void 0!==i.styles){var s=i.next;if(void 0!==s)for(;void 0!==s;)mn={name:s.name,styles:s.styles,next:mn},s=s.next;return i.styles+";"}return function(e,t,n){var r="";if(Array.isArray(n))for(var o=0;o<n.length;o++)r+=gn(e,t,n[o])+";";else for(var i in n){var s=n[i];if("object"!=typeof s){var a=s;null!=t&&void 0!==t[a]?r+=i+"{"+t[a]+"}":hn(a)&&(r+=pn(i)+":"+fn(i,a)+";")}else if(!Array.isArray(s)||"string"!=typeof s[0]||null!=t&&void 0!==t[s[0]]){var l=gn(e,t,s);switch(i){case"animation":case"animationName":r+=pn(i)+":"+l+";";break;default:r+=i+"{"+l+"}"}}else for(var c=0;c<s.length;c++)hn(s[c])&&(r+=pn(i)+":"+fn(i,s[c])+";")}return r}(e,t,n);case"function":if(void 0!==e){var a=mn,l=n(e);return mn=a,gn(e,t,l)}}var c=n;if(null==t)return c;var u=t[c];return void 0!==u?u:c}var mn,yn=/label:\s*([^\s;{]+)\s*(;|$)/g;function vn(e,t,n){if(1===e.length&&"object"==typeof e[0]&&null!==e[0]&&void 0!==e[0].styles)return e[0];var r=!0,o="";mn=void 0;var i=e[0];null==i||void 0===i.raw?(r=!1,o+=gn(n,t,i)):o+=i[0];for(var s=1;s<e.length;s++){if(o+=gn(n,t,e[s]),r)o+=i[s]}yn.lastIndex=0;for(var a,l="";null!==(a=yn.exec(o));)l+="-"+a[1];var c=function(e){for(var t,n=0,r=0,o=e.length;o>=4;++r,o-=4)t=1540483477*(65535&(t=255&e.charCodeAt(r)|(255&e.charCodeAt(++r))<<8|(255&e.charCodeAt(++r))<<16|(255&e.charCodeAt(++r))<<24))+(59797*(t>>>16)<<16),n=1540483477*(65535&(t^=t>>>24))+(59797*(t>>>16)<<16)^1540483477*(65535&n)+(59797*(n>>>16)<<16);switch(o){case 3:n^=(255&e.charCodeAt(r+2))<<16;case 2:n^=(255&e.charCodeAt(r+1))<<8;case 1:n=1540483477*(65535&(n^=255&e.charCodeAt(r)))+(59797*(n>>>16)<<16)}return(((n=1540483477*(65535&(n^=n>>>13))+(59797*(n>>>16)<<16))^n>>>15)>>>0).toString(36)}(o)+l;return{name:c,styles:o,next:mn}}var bn,wn,xn=!!ge.useInsertionEffect&&ge.useInsertionEffect,_n=xn||function(e){return e()},Cn=xn||pe.useLayoutEffect,Sn=pe.createContext("undefined"!=typeof HTMLElement?tn({key:"css"}):null),En=Sn.Provider,Bn=function(e){return pe.forwardRef(function(t,n){var r=pe.useContext(Sn);return e(t,r,n)})},In=pe.createContext({}),Rn={}.hasOwnProperty,kn="__EMOTION_TYPE_PLEASE_DO_NOT_USE__",Tn=function(e){var t=e.cache,n=e.serialized,r=e.isStringTag;return an(t,n,r),_n(function(){return ln(t,n,r)}),null},Pn=Bn(function(e,t,n){var r=e.css;"string"==typeof r&&void 0!==t.registered[r]&&(r=t.registered[r]);var o=e[kn],i=[r],s="";"string"==typeof e.className?s=sn(t.registered,i,e.className):null!=e.className&&(s=e.className+" ");var a=vn(i,void 0,pe.useContext(In));s+=t.key+"-"+a.name;var l={};for(var c in e)Rn.call(e,c)&&"css"!==c&&c!==kn&&(l[c]=e[c]);return l.className=s,n&&(l.ref=n),pe.createElement(pe.Fragment,null,pe.createElement(Tn,{cache:t,serialized:a,isStringTag:"string"==typeof o}),pe.createElement(o,l))}),Fn=function(e,t){var n=arguments;if(null==t||!Rn.call(t,"css"))return pe.createElement.apply(void 0,n);var r=n.length,o=new Array(r);o[0]=Pn,o[1]=function(e,t){var n={};for(var r in t)Rn.call(t,r)&&(n[r]=t[r]);return n[kn]=e,n}(e,t);for(var i=2;i<r;i++)o[i]=n[i];return pe.createElement.apply(null,o)};bn=Fn||(Fn={}),wn||(wn=bn.JSX||(bn.JSX={}));var Mn=Bn(function(e,t){var n=vn([e.styles],void 0,pe.useContext(In)),r=pe.useRef();return Cn(function(){var e=t.key+"-global",o=new t.sheet.constructor({key:e,nonce:t.sheet.nonce,container:t.sheet.container,speedy:t.sheet.isSpeedy}),i=!1,s=document.querySelector('style[data-emotion="'+e+" "+n.name+'"]');return t.sheet.tags.length&&(o.before=t.sheet.tags[0]),null!==s&&(i=!0,s.setAttribute("data-emotion",e),o.hydrate([s])),r.current=[o,i],function(){o.flush()}},[t]),Cn(function(){var e=r.current,o=e[0];if(e[1])e[1]=!1;else{if(void 0!==n.next&&ln(t,n.next,!0),o.tags.length){var i=o.tags[o.tags.length-1].nextElementSibling;o.before=i,o.flush()}t.insert("",n,o,!1)}},[t,n.name]),null});function Ln(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return vn(t)}function Un(){var e=Ln.apply(void 0,arguments),t="animation-"+e.name;return{name:t,styles:"@keyframes "+t+"{"+e.styles+"}",anim:1,toString:function(){return"_EMO_"+this.name+"_"+this.styles+"_EMO_"}}}var On=/^((children|dangerouslySetInnerHTML|key|ref|autoFocus|defaultValue|defaultChecked|innerHTML|suppressContentEditableWarning|suppressHydrationWarning|valueLink|abbr|accept|acceptCharset|accessKey|action|allow|allowUserMedia|allowPaymentRequest|allowFullScreen|allowTransparency|alt|async|autoComplete|autoPlay|capture|cellPadding|cellSpacing|challenge|charSet|checked|cite|classID|className|cols|colSpan|content|contentEditable|contextMenu|controls|controlsList|coords|crossOrigin|data|dateTime|decoding|default|defer|dir|disabled|disablePictureInPicture|disableRemotePlayback|download|draggable|encType|enterKeyHint|fetchpriority|fetchPriority|form|formAction|formEncType|formMethod|formNoValidate|formTarget|frameBorder|headers|height|hidden|high|href|hrefLang|htmlFor|httpEquiv|id|inputMode|integrity|is|keyParams|keyType|kind|label|lang|list|loading|loop|low|marginHeight|marginWidth|max|maxLength|media|mediaGroup|method|min|minLength|multiple|muted|name|nonce|noValidate|open|optimum|pattern|placeholder|playsInline|popover|popoverTarget|popoverTargetAction|poster|preload|profile|radioGroup|readOnly|referrerPolicy|rel|required|reversed|role|rows|rowSpan|sandbox|scope|scoped|scrolling|seamless|selected|shape|size|sizes|slot|span|spellCheck|src|srcDoc|srcLang|srcSet|start|step|style|summary|tabIndex|target|title|translate|type|useMap|value|width|wmode|wrap|about|datatype|inlist|prefix|property|resource|typeof|vocab|autoCapitalize|autoCorrect|autoSave|color|incremental|fallback|inert|itemProp|itemScope|itemType|itemID|itemRef|on|option|results|security|unselectable|accentHeight|accumulate|additive|alignmentBaseline|allowReorder|alphabetic|amplitude|arabicForm|ascent|attributeName|attributeType|autoReverse|azimuth|baseFrequency|baselineShift|baseProfile|bbox|begin|bias|by|calcMode|capHeight|clip|clipPathUnits|clipPath|clipRule|colorInterpolation|colorInterpolationFilters|colorProfile|colorRendering|contentScriptType|contentStyleType|cursor|cx|cy|d|decelerate|descent|diffuseConstant|direction|display|divisor|dominantBaseline|dur|dx|dy|edgeMode|elevation|enableBackground|end|exponent|externalResourcesRequired|fill|fillOpacity|fillRule|filter|filterRes|filterUnits|floodColor|floodOpacity|focusable|fontFamily|fontSize|fontSizeAdjust|fontStretch|fontStyle|fontVariant|fontWeight|format|from|fr|fx|fy|g1|g2|glyphName|glyphOrientationHorizontal|glyphOrientationVertical|glyphRef|gradientTransform|gradientUnits|hanging|horizAdvX|horizOriginX|ideographic|imageRendering|in|in2|intercept|k|k1|k2|k3|k4|kernelMatrix|kernelUnitLength|kerning|keyPoints|keySplines|keyTimes|lengthAdjust|letterSpacing|lightingColor|limitingConeAngle|local|markerEnd|markerMid|markerStart|markerHeight|markerUnits|markerWidth|mask|maskContentUnits|maskUnits|mathematical|mode|numOctaves|offset|opacity|operator|order|orient|orientation|origin|overflow|overlinePosition|overlineThickness|panose1|paintOrder|pathLength|patternContentUnits|patternTransform|patternUnits|pointerEvents|points|pointsAtX|pointsAtY|pointsAtZ|preserveAlpha|preserveAspectRatio|primitiveUnits|r|radius|refX|refY|renderingIntent|repeatCount|repeatDur|requiredExtensions|requiredFeatures|restart|result|rotate|rx|ry|scale|seed|shapeRendering|slope|spacing|specularConstant|specularExponent|speed|spreadMethod|startOffset|stdDeviation|stemh|stemv|stitchTiles|stopColor|stopOpacity|strikethroughPosition|strikethroughThickness|string|stroke|strokeDasharray|strokeDashoffset|strokeLinecap|strokeLinejoin|strokeMiterlimit|strokeOpacity|strokeWidth|surfaceScale|systemLanguage|tableValues|targetX|targetY|textAnchor|textDecoration|textRendering|textLength|to|transform|u1|u2|underlinePosition|underlineThickness|unicode|unicodeBidi|unicodeRange|unitsPerEm|vAlphabetic|vHanging|vIdeographic|vMathematical|values|vectorEffect|version|vertAdvY|vertOriginX|vertOriginY|viewBox|viewTarget|visibility|widths|wordSpacing|writingMode|x|xHeight|x1|x2|xChannelSelector|xlinkActuate|xlinkArcrole|xlinkHref|xlinkRole|xlinkShow|xlinkTitle|xlinkType|xmlBase|xmlns|xmlnsXlink|xmlLang|xmlSpace|y|y1|y2|yChannelSelector|z|zoomAndPan|for|class|autofocus)|(([Dd][Aa][Tt][Aa]|[Aa][Rr][Ii][Aa]|x)-.*))$/,Dn=Ht(function(e){return On.test(e)||111===e.charCodeAt(0)&&110===e.charCodeAt(1)&&e.charCodeAt(2)<91}),Nn=function(e){return"theme"!==e},jn=function(e){return"string"==typeof e&&e.charCodeAt(0)>96?Dn:Nn},Qn=function(e,t,n){var r;if(t){var o=t.shouldForwardProp;r=e.__emotion_forwardProp&&o?function(t){return e.__emotion_forwardProp(t)&&o(t)}:o}return"function"!=typeof r&&n&&(r=e.__emotion_forwardProp),r},zn=function(e){var t=e.cache,n=e.serialized,r=e.isStringTag;return an(t,n,r),_n(function(){return ln(t,n,r)}),null},Hn=function e(t,n){var r,o,i=t.__emotion_real===t,s=i&&t.__emotion_base||t;void 0!==n&&(r=n.label,o=n.target);var a=Qn(t,n,i),l=a||jn(s),c=!l("as");return function(){var u=arguments,d=i&&void 0!==t.__emotion_styles?t.__emotion_styles.slice(0):[];if(void 0!==r&&d.push("label:"+r+";"),null==u[0]||void 0===u[0].raw)d.push.apply(d,u);else{var A=u[0];d.push(A[0]);for(var h=u.length,p=1;p<h;p++)d.push(u[p],A[p])}var f=Bn(function(e,t,n){var r=c&&e.as||s,i="",u=[],A=e;if(null==e.theme){for(var h in A={},e)A[h]=e[h];A.theme=pe.useContext(In)}"string"==typeof e.className?i=sn(t.registered,u,e.className):null!=e.className&&(i=e.className+" ");var p=vn(d.concat(u),t.registered,A);i+=t.key+"-"+p.name,void 0!==o&&(i+=" "+o);var f=c&&void 0===a?jn(r):l,g={};for(var m in e)c&&"as"===m||f(m)&&(g[m]=e[m]);return g.className=i,n&&(g.ref=n),pe.createElement(pe.Fragment,null,pe.createElement(zn,{cache:t,serialized:p,isStringTag:"string"==typeof r}),pe.createElement(r,g))});return f.displayName=void 0!==r?r:"Styled("+("string"==typeof s?s:s.displayName||s.name||"Component")+")",f.defaultProps=t.defaultProps,f.__emotion_real=f,f.__emotion_base=s,f.__emotion_styles=d,f.__emotion_forwardProp=a,Object.defineProperty(f,"toString",{value:function(){return"."+o}}),f.withComponent=function(t,r){return e(t,Ke({},n,r,{shouldForwardProp:Qn(f,r,!0)})).apply(void 0,d)},f}}.bind(null);["a","abbr","address","area","article","aside","audio","b","base","bdi","bdo","big","blockquote","body","br","button","canvas","caption","cite","code","col","colgroup","data","datalist","dd","del","details","dfn","dialog","div","dl","dt","em","embed","fieldset","figcaption","figure","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","iframe","img","input","ins","kbd","keygen","label","legend","li","link","main","map","mark","marquee","menu","menuitem","meta","meter","nav","noscript","object","ol","optgroup","option","output","p","param","picture","pre","progress","q","rp","rt","ruby","s","samp","script","section","select","small","source","span","strong","style","sub","summary","sup","table","tbody","td","textarea","tfoot","th","thead","time","title","tr","track","u","ul","var","video","wbr","circle","clipPath","defs","ellipse","foreignObject","g","image","line","linearGradient","mask","path","pattern","polygon","polyline","radialGradient","rect","stop","svg","text","tspan"].forEach(function(e){Hn[e]=Hn(e)});const Gn=new Map;let Vn;if("object"==typeof document&&(Vn=document.querySelector('[name="emotion-insertion-point"]'),!Vn)){Vn=document.createElement("meta"),Vn.setAttribute("name","emotion-insertion-point"),Vn.setAttribute("content","");const e=document.querySelector("head");e&&e.prepend(Vn)}function Wn(e,t){if(e||t){class n extends Xe{insert(e,t){return this.key&&this.key.endsWith("global")&&(this.before=Vn),super.insert(e,t)}}const r=((e,t)=>{const n=tn(e);return n.sheet=new t({key:n.key,nonce:n.sheet.nonce,container:n.sheet.container,speedy:n.sheet.isSpeedy,prepend:n.sheet.prepend,insertionPoint:n.sheet.insertionPoint}),n})({key:"css",insertionPoint:e?Vn:void 0},n);if(t){const e=r.insert;r.insert=(...t)=>(t[1].styles.match(/^@layer\s+[^{]*$/)||(t[1].styles=`@layer mui {${t[1].styles}}`),e(...t))}return r}}function $n(e){const{injectFirst:t,enableCssLayer:n,children:r}=e,o=pe.useMemo(()=>{const e=`${t}-${n}`;if("object"==typeof document&&Gn.has(e))return Gn.get(e);const r=Wn(t,n);return Gn.set(e,r),r},[t,n]);return o?s.jsx(En,{value:o,children:r}):r}function Kn(e){const{styles:t,defaultTheme:n={}}=e,r="function"==typeof t?e=>{return t(null==(r=e)||0===Object.keys(r).length?n:e);var r}:t;return s.jsx(Mn,{styles:r})}function Xn(e,t){return Hn(e,t)}const Yn=[];function qn(e){return Yn[0]=e,vn(Yn)}var Jn,Zn,er={exports:{}},tr={};function nr(){if(Jn)return tr;Jn=1;var e=Symbol.for("react.transitional.element"),t=Symbol.for("react.portal"),n=Symbol.for("react.fragment"),r=Symbol.for("react.strict_mode"),o=Symbol.for("react.profiler"),i=Symbol.for("react.consumer"),s=Symbol.for("react.context"),a=Symbol.for("react.forward_ref"),l=Symbol.for("react.suspense"),c=Symbol.for("react.suspense_list"),u=Symbol.for("react.memo"),d=Symbol.for("react.lazy"),A=Symbol.for("react.view_transition"),h=Symbol.for("react.client.reference");function p(h){if("object"==typeof h&&null!==h){var p=h.$$typeof;switch(p){case e:switch(h=h.type){case n:case o:case r:case l:case c:case A:return h;default:switch(h=h&&h.$$typeof){case s:case a:case d:case u:case i:return h;default:return p}}case t:return p}}}return tr.ContextConsumer=i,tr.ContextProvider=s,tr.Element=e,tr.ForwardRef=a,tr.Fragment=n,tr.Lazy=d,tr.Memo=u,tr.Portal=t,tr.Profiler=o,tr.StrictMode=r,tr.Suspense=l,tr.SuspenseList=c,tr.isContextConsumer=function(e){return p(e)===i},tr.isContextProvider=function(e){return p(e)===s},tr.isElement=function(t){return"object"==typeof t&&null!==t&&t.$$typeof===e},tr.isForwardRef=function(e){return p(e)===a},tr.isFragment=function(e){return p(e)===n},tr.isLazy=function(e){return p(e)===d},tr.isMemo=function(e){return p(e)===u},tr.isPortal=function(e){return p(e)===t},tr.isProfiler=function(e){return p(e)===o},tr.isStrictMode=function(e){return p(e)===r},tr.isSuspense=function(e){return p(e)===l},tr.isSuspenseList=function(e){return p(e)===c},tr.isValidElementType=function(e){return"string"==typeof e||"function"==typeof e||e===n||e===o||e===r||e===l||e===c||"object"==typeof e&&null!==e&&(e.$$typeof===d||e.$$typeof===u||e.$$typeof===s||e.$$typeof===i||e.$$typeof===a||e.$$typeof===h||void 0!==e.getModuleId)},tr.typeOf=p,tr}function rr(){return Zn||(Zn=1,er.exports=nr()),er.exports}var or=rr();function ir(e){if("object"!=typeof e||null===e)return!1;const t=Object.getPrototypeOf(e);return!(null!==t&&t!==Object.prototype&&null!==Object.getPrototypeOf(t)||Symbol.toStringTag in e||Symbol.iterator in e)}function sr(e){if(pe.isValidElement(e)||or.isValidElementType(e)||!ir(e))return e;const t={};return Object.keys(e).forEach(n=>{t[n]=sr(e[n])}),t}function ar(e,t,n={clone:!0}){const r=n.clone?{...e}:e;return ir(e)&&ir(t)&&Object.keys(t).forEach(o=>{pe.isValidElement(t[o])||or.isValidElementType(t[o])?r[o]=t[o]:ir(t[o])&&Object.prototype.hasOwnProperty.call(e,o)&&ir(e[o])?r[o]=ar(e[o],t[o],n):n.clone?r[o]=ir(t[o])?sr(t[o]):t[o]:r[o]=t[o]}),r}function lr(e){const{values:t={xs:0,sm:600,md:900,lg:1200,xl:1536},unit:n="px",step:r=5,...o}=e,i=(e=>{const t=Object.keys(e).map(t=>({key:t,val:e[t]}))||[];return t.sort((e,t)=>e.val-t.val),t.reduce((e,t)=>({...e,[t.key]:t.val}),{})})(t),s=Object.keys(i);function a(e){return`@media (min-width:${"number"==typeof t[e]?t[e]:e}${n})`}function l(e){return`@media (max-width:${("number"==typeof t[e]?t[e]:e)-r/100}${n})`}function c(e,o){const i=s.indexOf(o);return`@media (min-width:${"number"==typeof t[e]?t[e]:e}${n}) and (max-width:${(-1!==i&&"number"==typeof t[s[i]]?t[s[i]]:o)-r/100}${n})`}return{keys:s,values:i,up:a,down:l,between:c,only:function(e){return s.indexOf(e)+1<s.length?c(e,s[s.indexOf(e)+1]):a(e)},not:function(e){const t=s.indexOf(e);return 0===t?a(s[1]):t===s.length-1?l(s[t]):c(e,s[s.indexOf(e)+1]).replace("@media","@media not all and")},unit:n,...o}}function cr(e,t){if(!e.containerQueries)return t;const n=Object.keys(t).filter(e=>e.startsWith("@container")).sort((e,t)=>{const n=/min-width:\s*([0-9.]+)/;return+(e.match(n)?.[1]||0)-+(t.match(n)?.[1]||0)});return n.length?n.reduce((e,n)=>{const r=t[n];return delete e[n],e[n]=r,e},{...t}):t}const ur={borderRadius:4};function dr(e,t){return t?ar(e,t,{clone:!1}):e}const Ar={xs:0,sm:600,md:900,lg:1200,xl:1536},hr={keys:["xs","sm","md","lg","xl"],up:e=>`@media (min-width:${Ar[e]}px)`},pr={containerQueries:e=>({up:t=>{let n="number"==typeof t?t:Ar[t]||t;return"number"==typeof n&&(n=`${n}px`),e?`@container ${e} (min-width:${n})`:`@container (min-width:${n})`}})};function fr(e,t,n){const r=e.theme||{};if(Array.isArray(t)){const e=r.breakpoints||hr;return t.reduce((r,o,i)=>(r[e.up(e.keys[i])]=n(t[i]),r),{})}if("object"==typeof t){const e=r.breakpoints||hr;return Object.keys(t).reduce((o,i)=>{if(s=e.keys,"@"===(a=i)||a.startsWith("@")&&(s.some(e=>a.startsWith(`@${e}`))||a.match(/^@\d/))){const e=function(e,t){const n=t.match(/^@([^/]+)?\/?(.+)?$/);if(!n)return null;const[,r,o]=n,i=Number.isNaN(+r)?r||0:+r;return e.containerQueries(o).up(i)}(r.containerQueries?r:pr,i);e&&(o[e]=n(t[i],i))}else if(Object.keys(e.values||Ar).includes(i)){o[e.up(i)]=n(t[i],i)}else{const e=i;o[e]=t[e]}var s,a;return o},{})}return n(t)}function gr(e={}){const t=e.keys?.reduce((t,n)=>(t[e.up(n)]={},t),{});return t||{}}function mr(e,t){return e.reduce((e,t)=>{const n=e[t];return(!n||0===Object.keys(n).length)&&delete e[t],e},t)}function yr({values:e,breakpoints:t,base:n}){const r=n||function(e,t){if("object"!=typeof e)return{};const n={},r=Object.keys(t);return Array.isArray(e)?r.forEach((t,r)=>{r<e.length&&(n[t]=!0)}):r.forEach(t=>{null!=e[t]&&(n[t]=!0)}),n}(e,t),o=Object.keys(r);if(0===o.length)return e;let i;return o.reduce((t,n,r)=>(Array.isArray(e)?(t[n]=null!=e[r]?e[r]:e[i],i=r):"object"==typeof e?(t[n]=null!=e[n]?e[n]:e[i],i=n):t[n]=e,t),{})}function vr(e){if("string"!=typeof e)throw new Error($e(7));return e.charAt(0).toUpperCase()+e.slice(1)}function br(e,t,n=!0){if(!t||"string"!=typeof t)return null;if(e&&e.vars&&n){const n=`vars.${t}`.split(".").reduce((e,t)=>e&&e[t]?e[t]:null,e);if(null!=n)return n}return t.split(".").reduce((e,t)=>e&&null!=e[t]?e[t]:null,e)}function wr(e,t,n,r=n){let o;return o="function"==typeof e?e(n):Array.isArray(e)?e[n]||r:br(e,n)||r,t&&(o=t(o,r,e)),o}function xr(e){const{prop:t,cssProperty:n=e.prop,themeKey:r,transform:o}=e,i=e=>{if(null==e[t])return null;const i=e[t],s=br(e.theme,r)||{};return fr(e,i,e=>{let r=wr(s,o,e);return e===r&&"string"==typeof e&&(r=wr(s,o,`${t}${"default"===e?"":vr(e)}`,e)),!1===n?r:{[n]:r}})};return i.propTypes={},i.filterProps=[t],i}const _r={m:"margin",p:"padding"},Cr={t:"Top",r:"Right",b:"Bottom",l:"Left",x:["Left","Right"],y:["Top","Bottom"]},Sr={marginX:"mx",marginY:"my",paddingX:"px",paddingY:"py"},Er=function(e){const t={};return n=>(void 0===t[n]&&(t[n]=e(n)),t[n])}(e=>{if(e.length>2){if(!Sr[e])return[e];e=Sr[e]}const[t,n]=e.split(""),r=_r[t],o=Cr[n]||"";return Array.isArray(o)?o.map(e=>r+e):[r+o]}),Br=["m","mt","mr","mb","ml","mx","my","margin","marginTop","marginRight","marginBottom","marginLeft","marginX","marginY","marginInline","marginInlineStart","marginInlineEnd","marginBlock","marginBlockStart","marginBlockEnd"],Ir=["p","pt","pr","pb","pl","px","py","padding","paddingTop","paddingRight","paddingBottom","paddingLeft","paddingX","paddingY","paddingInline","paddingInlineStart","paddingInlineEnd","paddingBlock","paddingBlockStart","paddingBlockEnd"];function Rr(e,t,n,r){const o=br(e,t,!0)??n;return"number"==typeof o||"string"==typeof o?e=>"string"==typeof e?e:"string"==typeof o?o.startsWith("var(")&&0===e?0:o.startsWith("var(")&&1===e?o:`calc(${e} * ${o})`:o*e:Array.isArray(o)?e=>{if("string"==typeof e)return e;const t=Math.abs(e),n=o[t];return e>=0?n:"number"==typeof n?-n:"string"==typeof n&&n.startsWith("var(")?`calc(-1 * ${n})`:`-${n}`}:"function"==typeof o?o:()=>{}}function kr(e){return Rr(e,"spacing",8)}function Tr(e,t){return"string"==typeof t||null==t?t:e(t)}function Pr(e,t,n,r){if(!t.includes(n))return null;const o=function(e,t){return n=>e.reduce((e,r)=>(e[r]=Tr(t,n),e),{})}(Er(n),r);return fr(e,e[n],o)}function Fr(e,t){const n=kr(e.theme);return Object.keys(e).map(r=>Pr(e,t,r,n)).reduce(dr,{})}function Mr(e){return Fr(e,Br)}function Lr(e){return Fr(e,Ir)}function Ur(e=8,t=kr({spacing:e})){if(e.mui)return e;const n=(...e)=>(0===e.length?[1]:e).map(e=>{const n=t(e);return"number"==typeof n?`${n}px`:n}).join(" ");return n.mui=!0,n}function Or(...e){const t=e.reduce((e,t)=>(t.filterProps.forEach(n=>{e[n]=t}),e),{}),n=e=>Object.keys(e).reduce((n,r)=>t[r]?dr(n,t[r](e)):n,{});return n.propTypes={},n.filterProps=e.reduce((e,t)=>e.concat(t.filterProps),[]),n}function Dr(e){return"number"!=typeof e?e:`${e}px solid`}function Nr(e,t){return xr({prop:e,themeKey:"borders",transform:t})}Mr.propTypes={},Mr.filterProps=Br,Lr.propTypes={},Lr.filterProps=Ir;const jr=Nr("border",Dr),Qr=Nr("borderTop",Dr),zr=Nr("borderRight",Dr),Hr=Nr("borderBottom",Dr),Gr=Nr("borderLeft",Dr),Vr=Nr("borderColor"),Wr=Nr("borderTopColor"),$r=Nr("borderRightColor"),Kr=Nr("borderBottomColor"),Xr=Nr("borderLeftColor"),Yr=Nr("outline",Dr),qr=Nr("outlineColor"),Jr=e=>{if(void 0!==e.borderRadius&&null!==e.borderRadius){const t=Rr(e.theme,"shape.borderRadius",4),n=e=>({borderRadius:Tr(t,e)});return fr(e,e.borderRadius,n)}return null};Jr.propTypes={},Jr.filterProps=["borderRadius"],Or(jr,Qr,zr,Hr,Gr,Vr,Wr,$r,Kr,Xr,Jr,Yr,qr);const Zr=e=>{if(void 0!==e.gap&&null!==e.gap){const t=Rr(e.theme,"spacing",8),n=e=>({gap:Tr(t,e)});return fr(e,e.gap,n)}return null};Zr.propTypes={},Zr.filterProps=["gap"];const eo=e=>{if(void 0!==e.columnGap&&null!==e.columnGap){const t=Rr(e.theme,"spacing",8),n=e=>({columnGap:Tr(t,e)});return fr(e,e.columnGap,n)}return null};eo.propTypes={},eo.filterProps=["columnGap"];const to=e=>{if(void 0!==e.rowGap&&null!==e.rowGap){const t=Rr(e.theme,"spacing",8),n=e=>({rowGap:Tr(t,e)});return fr(e,e.rowGap,n)}return null};to.propTypes={},to.filterProps=["rowGap"];function no(e,t){return"grey"===t?t:e}Or(Zr,eo,to,xr({prop:"gridColumn"}),xr({prop:"gridRow"}),xr({prop:"gridAutoFlow"}),xr({prop:"gridAutoColumns"}),xr({prop:"gridAutoRows"}),xr({prop:"gridTemplateColumns"}),xr({prop:"gridTemplateRows"}),xr({prop:"gridTemplateAreas"}),xr({prop:"gridArea"}));function ro(e){return e<=1&&0!==e?100*e+"%":e}Or(xr({prop:"color",themeKey:"palette",transform:no}),xr({prop:"bgcolor",cssProperty:"backgroundColor",themeKey:"palette",transform:no}),xr({prop:"backgroundColor",themeKey:"palette",transform:no}));const oo=xr({prop:"width",transform:ro}),io=e=>{if(void 0!==e.maxWidth&&null!==e.maxWidth){const t=t=>{const n=e.theme?.breakpoints?.values?.[t]||Ar[t];return n?"px"!==e.theme?.breakpoints?.unit?{maxWidth:`${n}${e.theme.breakpoints.unit}`}:{maxWidth:n}:{maxWidth:ro(t)}};return fr(e,e.maxWidth,t)}return null};io.filterProps=["maxWidth"];const so=xr({prop:"minWidth",transform:ro}),ao=xr({prop:"height",transform:ro}),lo=xr({prop:"maxHeight",transform:ro}),co=xr({prop:"minHeight",transform:ro});xr({prop:"size",cssProperty:"width",transform:ro}),xr({prop:"size",cssProperty:"height",transform:ro});Or(oo,io,so,ao,lo,co,xr({prop:"boxSizing"}));const uo={border:{themeKey:"borders",transform:Dr},borderTop:{themeKey:"borders",transform:Dr},borderRight:{themeKey:"borders",transform:Dr},borderBottom:{themeKey:"borders",transform:Dr},borderLeft:{themeKey:"borders",transform:Dr},borderColor:{themeKey:"palette"},borderTopColor:{themeKey:"palette"},borderRightColor:{themeKey:"palette"},borderBottomColor:{themeKey:"palette"},borderLeftColor:{themeKey:"palette"},outline:{themeKey:"borders",transform:Dr},outlineColor:{themeKey:"palette"},borderRadius:{themeKey:"shape.borderRadius",style:Jr},color:{themeKey:"palette",transform:no},bgcolor:{themeKey:"palette",cssProperty:"backgroundColor",transform:no},backgroundColor:{themeKey:"palette",transform:no},p:{style:Lr},pt:{style:Lr},pr:{style:Lr},pb:{style:Lr},pl:{style:Lr},px:{style:Lr},py:{style:Lr},padding:{style:Lr},paddingTop:{style:Lr},paddingRight:{style:Lr},paddingBottom:{style:Lr},paddingLeft:{style:Lr},paddingX:{style:Lr},paddingY:{style:Lr},paddingInline:{style:Lr},paddingInlineStart:{style:Lr},paddingInlineEnd:{style:Lr},paddingBlock:{style:Lr},paddingBlockStart:{style:Lr},paddingBlockEnd:{style:Lr},m:{style:Mr},mt:{style:Mr},mr:{style:Mr},mb:{style:Mr},ml:{style:Mr},mx:{style:Mr},my:{style:Mr},margin:{style:Mr},marginTop:{style:Mr},marginRight:{style:Mr},marginBottom:{style:Mr},marginLeft:{style:Mr},marginX:{style:Mr},marginY:{style:Mr},marginInline:{style:Mr},marginInlineStart:{style:Mr},marginInlineEnd:{style:Mr},marginBlock:{style:Mr},marginBlockStart:{style:Mr},marginBlockEnd:{style:Mr},displayPrint:{cssProperty:!1,transform:e=>({"@media print":{display:e}})},display:{},overflow:{},textOverflow:{},visibility:{},whiteSpace:{},flexBasis:{},flexDirection:{},flexWrap:{},justifyContent:{},alignItems:{},alignContent:{},order:{},flex:{},flexGrow:{},flexShrink:{},alignSelf:{},justifyItems:{},justifySelf:{},gap:{style:Zr},rowGap:{style:to},columnGap:{style:eo},gridColumn:{},gridRow:{},gridAutoFlow:{},gridAutoColumns:{},gridAutoRows:{},gridTemplateColumns:{},gridTemplateRows:{},gridTemplateAreas:{},gridArea:{},position:{},zIndex:{themeKey:"zIndex"},top:{},right:{},bottom:{},left:{},boxShadow:{themeKey:"shadows"},width:{transform:ro},maxWidth:{style:io},minWidth:{transform:ro},height:{transform:ro},maxHeight:{transform:ro},minHeight:{transform:ro},boxSizing:{},font:{themeKey:"font"},fontFamily:{themeKey:"typography"},fontSize:{themeKey:"typography"},fontStyle:{themeKey:"typography"},fontWeight:{themeKey:"typography"},letterSpacing:{},textTransform:{},lineHeight:{},textAlign:{},typography:{cssProperty:!1,themeKey:"typography"}};const Ao=function(){function e(e,t,n,r){const o={[e]:t,theme:n},i=r[e];if(!i)return{[e]:t};const{cssProperty:s=e,themeKey:a,transform:l,style:c}=i;if(null==t)return null;if("typography"===a&&"inherit"===t)return{[e]:t};const u=br(n,a)||{};if(c)return c(o);return fr(o,t,t=>{let n=wr(u,l,t);return t===n&&"string"==typeof t&&(n=wr(u,l,`${e}${"default"===t?"":vr(t)}`,t)),!1===s?n:{[s]:n}})}return function t(n){const{sx:r,theme:o={},nested:i}=n||{};if(!r)return null;const s=o.unstable_sxConfig??uo;function a(n){let r=n;if("function"==typeof n)r=n(o);else if("object"!=typeof n)return n;if(!r)return null;const a=gr(o.breakpoints),l=Object.keys(a);let c=a;return Object.keys(r).forEach(n=>{const i=(a=r[n],l=o,"function"==typeof a?a(l):a);var a,l;if(null!=i)if("object"==typeof i)if(s[n])c=dr(c,e(n,i,o,s));else{const e=fr({theme:o},i,e=>({[n]:e}));!function(...e){const t=e.reduce((e,t)=>e.concat(Object.keys(t)),[]),n=new Set(t);return e.every(e=>n.size===Object.keys(e).length)}(e,i)?c=dr(c,e):c[n]=t({sx:i,theme:o,nested:!0})}else c=dr(c,e(n,i,o,s))}),!i&&o.modularCssLayers?{"@layer sx":cr(o,mr(l,c))}:cr(o,mr(l,c))}return Array.isArray(r)?r.map(a):a(r)}}();function ho(e,t){const n=this;if(n.vars){if(!n.colorSchemes?.[e]||"function"!=typeof n.getColorSchemeSelector)return{};let r=n.getColorSchemeSelector(e);return"&"===r?t:((r.includes("data-")||r.includes("."))&&(r=`*:where(${r.replace(/\s*&$/,"")}) &`),{[r]:t})}return n.palette.mode===e?t:{}}function po(e={},...t){const{breakpoints:n={},palette:r={},spacing:o,shape:i={},...s}=e;let a=ar({breakpoints:lr(n),direction:"ltr",components:{},palette:{mode:"light",...r},spacing:Ur(o),shape:{...ur,...i}},s);return a=function(e){const t=(e,t)=>e.replace("@media",t?`@container ${t}`:"@container");function n(n,r){n.up=(...n)=>t(e.breakpoints.up(...n),r),n.down=(...n)=>t(e.breakpoints.down(...n),r),n.between=(...n)=>t(e.breakpoints.between(...n),r),n.only=(...n)=>t(e.breakpoints.only(...n),r),n.not=(...n)=>{const o=t(e.breakpoints.not(...n),r);return o.includes("not all and")?o.replace("not all and ","").replace("min-width:","width<").replace("max-width:","width>").replace("and","or"):o}}const r={},o=e=>(n(r,e),r);return n(o),{...e,containerQueries:o}}(a),a.applyStyles=ho,a=t.reduce((e,t)=>ar(e,t),a),a.unstable_sxConfig={...uo,...s?.unstable_sxConfig},a.unstable_sx=function(e){return Ao({sx:e,theme:this})},a}function fo(e=null){const t=pe.useContext(In);return t&&(n=t,0!==Object.keys(n).length)?t:e;var n}Ao.filterProps=["sx"];const go=po();function mo(e=go){return fo(e)}function yo(e){const t=qn(e);return e!==t&&t.styles?(t.styles.match(/^@layer\s+[^{]*$/)||(t.styles=`@layer global{${t.styles}}`),t):e}function vo({styles:e,themeId:t,defaultTheme:n={}}){const r=mo(n),o=t&&r[t]||r;let i="function"==typeof e?e(o):e;return o.modularCssLayers&&(i=Array.isArray(i)?i.map(e=>yo("function"==typeof e?e(o):e)):yo(i)),s.jsx(Kn,{styles:i})}function bo(e){const{sx:t,...n}=e,{systemProps:r,otherProps:o}=(e=>{const t={systemProps:{},otherProps:{}},n=e?.theme?.unstable_sxConfig??uo;return Object.keys(e).forEach(r=>{n[r]?t.systemProps[r]=e[r]:t.otherProps[r]=e[r]}),t})(n);let i;return i=Array.isArray(t)?[r,...t]:"function"==typeof t?(...e)=>{const n=t(...e);return ir(n)?{...r,...n}:r}:{...r,...t},{...o,sx:i}}const wo=e=>e,xo=(()=>{let e=wo;return{configure(t){e=t},generate:t=>e(t),reset(){e=wo}}})();function _o(e){var t,n,r="";if("string"==typeof e||"number"==typeof e)r+=e;else if("object"==typeof e)if(Array.isArray(e)){var o=e.length;for(t=0;t<o;t++)e[t]&&(n=_o(e[t]))&&(r&&(r+=" "),r+=n)}else for(n in e)e[n]&&(r&&(r+=" "),r+=n);return r}function Co(){for(var e,t,n=0,r="",o=arguments.length;n<o;n++)(e=arguments[n])&&(t=_o(e))&&(r&&(r+=" "),r+=t);return r}const So={active:"active",checked:"checked",completed:"completed",disabled:"disabled",error:"error",expanded:"expanded",focused:"focused",focusVisible:"focusVisible",open:"open",readOnly:"readOnly",required:"required",selected:"selected"};function Eo(e,t,n="Mui"){const r=So[t];return r?`${n}-${r}`:`${xo.generate(e)}-${t}`}function Bo(e,t,n="Mui"){const r={};return t.forEach(t=>{r[t]=Eo(e,t,n)}),r}function Io(e){const{variants:t,...n}=e,r={variants:t,style:qn(n),isProcessed:!0};return r.style===n||t&&t.forEach(e=>{"function"!=typeof e.style&&(e.style=qn(e.style))}),r}const Ro=po();function ko(e){return"ownerState"!==e&&"theme"!==e&&"sx"!==e&&"as"!==e}function To(e,t){return t&&e&&"object"==typeof e&&e.styles&&!e.styles.startsWith("@layer")&&(e.styles=`@layer ${t}{${String(e.styles)}}`),e}function Po(e){return e?(t,n)=>n[e]:null}function Fo(e,t,n){const r="function"==typeof t?t(e):t;if(Array.isArray(r))return r.flatMap(t=>Fo(e,t,n));if(Array.isArray(r?.variants)){let t;if(r.isProcessed)t=n?To(r.style,n):r.style;else{const{variants:e,...o}=r;t=n?To(qn(o),n):o}return Mo(e,r.variants,[t],n)}return r?.isProcessed?n?To(qn(r.style),n):r.style:n?To(qn(r),n):r}function Mo(e,t,n=[],r=void 0){let o;e:for(let i=0;i<t.length;i+=1){const s=t[i];if("function"==typeof s.props){if(o??={...e,...e.ownerState,ownerState:e.ownerState},!s.props(o))continue}else for(const t in s.props)if(e[t]!==s.props[t]&&e.ownerState?.[t]!==s.props[t])continue e;"function"==typeof s.style?(o??={...e,...e.ownerState,ownerState:e.ownerState},n.push(r?To(qn(s.style(o)),r):s.style(o))):n.push(r?To(qn(s.style),r):s.style)}return n}function Lo(e={}){const{themeId:t,defaultTheme:n=Ro,rootShouldForwardProp:r=ko,slotShouldForwardProp:o=ko}=e;function i(e){!function(e,t,n){e.theme=function(e){for(const t in e)return!1;return!0}(e.theme)?n:e.theme[t]||e.theme}(e,t,n)}return(e,t={})=>{!function(e,t){Array.isArray(e.__emotion_styles)&&(e.__emotion_styles=t(e.__emotion_styles))}(e,e=>e.filter(e=>e!==Ao));const{name:n,slot:s,skipVariantsResolver:a,skipSx:l,overridesResolver:c=Po(Oo(s)),...u}=t,d=n&&n.startsWith("Mui")||s?"components":"custom",A=void 0!==a?a:s&&"Root"!==s&&"root"!==s||!1,h=l||!1;let p=ko;"Root"===s||"root"===s?p=r:s?p=o:function(e){return"string"==typeof e&&e.charCodeAt(0)>96}(e)&&(p=void 0);const f=Xn(e,{shouldForwardProp:p,label:Uo(),...u}),g=e=>{if(e.__emotion_real===e)return e;if("function"==typeof e)return function(t){return Fo(t,e,t.theme.modularCssLayers?d:void 0)};if(ir(e)){const t=Io(e);return function(e){return t.variants?Fo(e,t,e.theme.modularCssLayers?d:void 0):e.theme.modularCssLayers?To(t.style,d):t.style}}return e},m=(...t)=>{const r=[],o=t.map(g),s=[];if(r.push(i),n&&c&&s.push(function(e){const t=e.theme,r=t.components?.[n]?.styleOverrides;if(!r)return null;const o={};for(const n in r)o[n]=Fo(e,r[n],e.theme.modularCssLayers?"theme":void 0);return c(e,o)}),n&&!A&&s.push(function(e){const t=e.theme,r=t?.components?.[n]?.variants;return r?Mo(e,r,[],e.theme.modularCssLayers?"theme":void 0):null}),h||s.push(Ao),Array.isArray(o[0])){const e=o.shift(),t=new Array(r.length).fill(""),n=new Array(s.length).fill("");let i;i=[...t,...e,...n],i.raw=[...t,...e.raw,...n],r.unshift(i)}const a=[...r,...o,...s],l=f(...a);return e.muiName&&(l.muiName=e.muiName),l};return f.withConfig&&(m.withConfig=f.withConfig),m}}function Uo(e,t){}function Oo(e){return e?e.charAt(0).toLowerCase()+e.slice(1):e}const Do=Lo();function No(e,t,n=!1){const r={...t};for(const o in e)if(Object.prototype.hasOwnProperty.call(e,o)){const i=o;if("components"===i||"slots"===i)r[i]={...e[i],...r[i]};else if("componentsProps"===i||"slotProps"===i){const o=e[i],s=t[i];if(s)if(o){r[i]={...s};for(const e in o)if(Object.prototype.hasOwnProperty.call(o,e)){const t=e;r[i][t]=No(o[t],s[t],n)}}else r[i]=s;else r[i]=o||{}}else"className"===i&&n&&t.className?r.className=Co(e?.className,t?.className):"style"===i&&n&&t.style?r.style={...e?.style,...t?.style}:void 0===r[i]&&(r[i]=e[i])}return r}function jo({props:e,name:t,defaultTheme:n,themeId:r}){let o=mo(n);return r&&(o=o[r]||o),function(e){const{theme:t,name:n,props:r}=e;return t&&t.components&&t.components[n]&&t.components[n].defaultProps?No(t.components[n].defaultProps,r):r}({theme:o,name:t,props:e})}const Qo="undefined"!=typeof window?pe.useLayoutEffect:pe.useEffect;function zo(e,t=0,n=1){return function(e,t=Number.MIN_SAFE_INTEGER,n=Number.MAX_SAFE_INTEGER){return Math.max(t,Math.min(e,n))}(e,t,n)}function Ho(e){if(e.type)return e;if("#"===e.charAt(0))return Ho(function(e){e=e.slice(1);const t=new RegExp(`.{1,${e.length>=6?2:1}}`,"g");let n=e.match(t);return n&&1===n[0].length&&(n=n.map(e=>e+e)),n?`rgb${4===n.length?"a":""}(${n.map((e,t)=>t<3?parseInt(e,16):Math.round(parseInt(e,16)/255*1e3)/1e3).join(", ")})`:""}(e));const t=e.indexOf("("),n=e.substring(0,t);if(!["rgb","rgba","hsl","hsla","color"].includes(n))throw new Error($e(9,e));let r,o=e.substring(t+1,e.length-1);if("color"===n){if(o=o.split(" "),r=o.shift(),4===o.length&&"/"===o[3].charAt(0)&&(o[3]=o[3].slice(1)),!["srgb","display-p3","a98-rgb","prophoto-rgb","rec-2020"].includes(r))throw new Error($e(10,r))}else o=o.split(",");return o=o.map(e=>parseFloat(e)),{type:n,values:o,colorSpace:r}}const Go=(e,t)=>{try{return(e=>{const t=Ho(e);return t.values.slice(0,3).map((e,n)=>t.type.includes("hsl")&&0!==n?`${e}%`:e).join(" ")})(e)}catch(n){return e}};function Vo(e){const{type:t,colorSpace:n}=e;let{values:r}=e;return t.includes("rgb")?r=r.map((e,t)=>t<3?parseInt(e,10):e):t.includes("hsl")&&(r[1]=`${r[1]}%`,r[2]=`${r[2]}%`),r=t.includes("color")?`${n} ${r.join(" ")}`:`${r.join(", ")}`,`${t}(${r})`}function Wo(e){e=Ho(e);const{values:t}=e,n=t[0],r=t[1]/100,o=t[2]/100,i=r*Math.min(o,1-o),s=(e,t=(e+n/30)%12)=>o-i*Math.max(Math.min(t-3,9-t,1),-1);let a="rgb";const l=[Math.round(255*s(0)),Math.round(255*s(8)),Math.round(255*s(4))];return"hsla"===e.type&&(a+="a",l.push(t[3])),Vo({type:a,values:l})}function $o(e){let t="hsl"===(e=Ho(e)).type||"hsla"===e.type?Ho(Wo(e)).values:e.values;return t=t.map(t=>("color"!==e.type&&(t/=255),t<=.03928?t/12.92:((t+.055)/1.055)**2.4)),Number((.2126*t[0]+.7152*t[1]+.0722*t[2]).toFixed(3))}function Ko(e,t){return e=Ho(e),t=zo(t),"rgb"!==e.type&&"hsl"!==e.type||(e.type+="a"),"color"===e.type?e.values[3]=`/${t}`:e.values[3]=t,Vo(e)}function Xo(e,t,n){try{return Ko(e,t)}catch(r){return e}}function Yo(e,t){if(e=Ho(e),t=zo(t),e.type.includes("hsl"))e.values[2]*=1-t;else if(e.type.includes("rgb")||e.type.includes("color"))for(let n=0;n<3;n+=1)e.values[n]*=1-t;return Vo(e)}function qo(e,t,n){try{return Yo(e,t)}catch(r){return e}}function Jo(e,t){if(e=Ho(e),t=zo(t),e.type.includes("hsl"))e.values[2]+=(100-e.values[2])*t;else if(e.type.includes("rgb"))for(let n=0;n<3;n+=1)e.values[n]+=(255-e.values[n])*t;else if(e.type.includes("color"))for(let n=0;n<3;n+=1)e.values[n]+=(1-e.values[n])*t;return Vo(e)}function Zo(e,t,n){try{return Jo(e,t)}catch(r){return e}}function ei(e,t=.15){return $o(e)>.5?Yo(e,t):Jo(e,t)}function ti(e,t,n){try{return ei(e,t)}catch(r){return e}}const ni=pe.createContext(null);function ri(){return pe.useContext(ni)}const oi="function"==typeof Symbol&&Symbol.for?Symbol.for("mui.nested"):"__THEME_NESTED__";function ii(e){const{children:t,theme:n}=e,r=ri(),o=pe.useMemo(()=>{const e=null===r?{...n}:function(e,t){if("function"==typeof t)return t(e);return{...e,...t}}(r,n);return null!=e&&(e[oi]=null!==r),e},[n,r]);return s.jsx(ni.Provider,{value:o,children:t})}const si=pe.createContext();function ai({value:e,...t}){return s.jsx(si.Provider,{value:e??!0,...t})}const li=()=>pe.useContext(si)??!1,ci=pe.createContext(void 0);function ui({value:e,children:t}){return s.jsx(ci.Provider,{value:e,children:t})}function di({props:e,name:t}){return function(e){const{theme:t,name:n,props:r}=e;if(!t||!t.components||!t.components[n])return r;const o=t.components[n];return o.defaultProps?No(o.defaultProps,r,t.components.mergeClassNameAndStyle):o.styleOverrides||o.variants?r:No(o,r,t.components.mergeClassNameAndStyle)}({props:e,name:t,theme:{components:pe.useContext(ci)}})}let Ai=0;const hi={...ge}.useId;function pi(e){if(void 0!==hi){const t=hi();return e??t}return function(e){const[t,n]=pe.useState(e),r=e||t;return pe.useEffect(()=>{null==t&&(Ai+=1,n(`mui-${Ai}`))},[t]),r}(e)}const fi={};function gi(e,t,n,r=!1){return pe.useMemo(()=>{const o=e&&t[e]||t;if("function"==typeof n){const i=n(o),s=e?{...t,[e]:i}:i;return r?()=>s:s}return e?{...t,[e]:n}:{...t,...n}},[e,t,n,r])}function mi(e){const{children:t,theme:n,themeId:r}=e,o=fo(fi),i=ri()||fi,a=gi(r,o,n),l=gi(r,i,n,!0),c="rtl"===(r?a[r]:a).direction,u=function(e){const t=fo(),n=pi()||"",{modularCssLayers:r}=e;let o="mui.global, mui.components, mui.theme, mui.custom, mui.sx";return o=r&&null===t?"string"==typeof r?r.replace(/mui(?!\.)/g,o):`@layer ${o};`:"",Qo(()=>{const e=document.querySelector("head");if(!e)return;const t=e.firstChild;if(o){if(t&&t.hasAttribute?.("data-mui-layer-order")&&t.getAttribute("data-mui-layer-order")===n)return;const r=document.createElement("style");r.setAttribute("data-mui-layer-order",n),r.textContent=o,e.prepend(r)}else e.querySelector(`style[data-mui-layer-order="${n}"]`)?.remove()},[o,n]),o?s.jsx(vo,{styles:o}):null}(a);return s.jsx(ii,{theme:l,children:s.jsx(In.Provider,{value:a,children:s.jsx(ai,{value:c,children:s.jsxs(ui,{value:r?a[r].components:a.components,children:[u,t]})})})})}const yi={theme:void 0};const vi="mode",bi="color-scheme",wi="data-color-scheme";function xi(){}const _i=({key:e,storageWindow:t})=>(t||"undefined"==typeof window||(t=window),{get(n){if("undefined"==typeof window)return;if(!t)return n;let r;try{r=t.localStorage.getItem(e)}catch{}return r||n},set:n=>{if(t)try{t.localStorage.setItem(e,n)}catch{}},subscribe:n=>{if(!t)return xi;const r=t=>{const r=t.newValue;t.key===e&&n(r)};return t.addEventListener("storage",r),()=>{t.removeEventListener("storage",r)}}});function Ci(){}function Si(e){if("undefined"!=typeof window&&"function"==typeof window.matchMedia&&"system"===e){return window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light"}}function Ei(e,t){return"light"===e.mode||"system"===e.mode&&"light"===e.systemMode?t("light"):"dark"===e.mode||"system"===e.mode&&"dark"===e.systemMode?t("dark"):void 0}function Bi(e){const{defaultMode:t="light",defaultLightColorScheme:n,defaultDarkColorScheme:r,supportedColorSchemes:o=[],modeStorageKey:i=vi,colorSchemeStorageKey:s=bi,storageWindow:a=("undefined"==typeof window?void 0:window),storageManager:l=_i,noSsr:c=!1}=e,u=o.join(","),d=o.length>1,A=pe.useMemo(()=>l?.({key:i,storageWindow:a}),[l,i,a]),h=pe.useMemo(()=>l?.({key:`${s}-light`,storageWindow:a}),[l,s,a]),p=pe.useMemo(()=>l?.({key:`${s}-dark`,storageWindow:a}),[l,s,a]),[f,g]=pe.useState(()=>{const e=A?.get(t)||t,o=h?.get(n)||n,i=p?.get(r)||r;return{mode:e,systemMode:Si(e),lightColorScheme:o,darkColorScheme:i}}),[m,y]=pe.useState(c||!d);pe.useEffect(()=>{y(!0)},[]);const v=function(e){return Ei(e,t=>"light"===t?e.lightColorScheme:"dark"===t?e.darkColorScheme:void 0)}(f),b=pe.useCallback(e=>{g(n=>{if(e===n.mode)return n;const r=e??t;return A?.set(r),{...n,mode:r,systemMode:Si(r)}})},[A,t]),w=pe.useCallback(e=>{e?"string"==typeof e?e&&!u.includes(e)||g(t=>{const n={...t};return Ei(t,t=>{"light"===t&&(h?.set(e),n.lightColorScheme=e),"dark"===t&&(p?.set(e),n.darkColorScheme=e)}),n}):g(t=>{const o={...t},i=null===e.light?n:e.light,s=null===e.dark?r:e.dark;return i&&u.includes(i)&&(o.lightColorScheme=i,h?.set(i)),s&&u.includes(s)&&(o.darkColorScheme=s,p?.set(s)),o}):g(e=>(h?.set(n),p?.set(r),{...e,lightColorScheme:n,darkColorScheme:r}))},[u,h,p,n,r]),x=pe.useCallback(e=>{"system"===f.mode&&g(t=>{const n=e?.matches?"dark":"light";return t.systemMode===n?t:{...t,systemMode:n}})},[f.mode]),_=pe.useRef(x);return _.current=x,pe.useEffect(()=>{if("function"!=typeof window.matchMedia||!d)return;const e=(...e)=>_.current(...e),t=window.matchMedia("(prefers-color-scheme: dark)");return t.addListener(e),e(t),()=>{t.removeListener(e)}},[d]),pe.useEffect(()=>{if(d){const e=A?.subscribe(e=>{e&&!["light","dark","system"].includes(e)||b(e||t)})||Ci,n=h?.subscribe(e=>{e&&!u.match(e)||w({light:e})})||Ci,r=p?.subscribe(e=>{e&&!u.match(e)||w({dark:e})})||Ci;return()=>{e(),n(),r()}}},[w,b,u,t,a,d,A,h,p]),{...f,mode:m?f.mode:void 0,systemMode:m?f.systemMode:void 0,colorScheme:m?v:void 0,setMode:b,setColorScheme:w}}function Ii(e=""){function t(...n){if(!n.length)return"";const r=n[0];return"string"!=typeof r||r.match(/(#|\(|\)|(-?(\d*\.)?\d+)(px|em|%|ex|ch|rem|vw|vh|vmin|vmax|cm|mm|in|pt|pc))|^(-?(\d*\.)?\d+)$|(\d+ \d+ \d+)/)?`, ${r}`:`, var(--${e?`${e}-`:""}${r}${t(...n.slice(1))})`}return(n,...r)=>`var(--${e?`${e}-`:""}${n}${t(...r)})`}const Ri=(e,t,n,r=[])=>{let o=e;t.forEach((e,i)=>{i===t.length-1?Array.isArray(o)?o[Number(e)]=n:o&&"object"==typeof o&&(o[e]=n):o&&"object"==typeof o&&(o[e]||(o[e]=r.includes(e)?[]:{}),o=o[e])})};function ki(e,t){const{prefix:n,shouldSkipGeneratingVar:r}=t||{},o={},i={},s={};var a,l;return a=(e,t,a)=>{if(!("string"!=typeof t&&"number"!=typeof t||r&&r(e,t))){const r=`--${n?`${n}-`:""}${e.join("-")}`,l=((e,t)=>"number"==typeof t?["lineHeight","fontWeight","opacity","zIndex"].some(t=>e.includes(t))||e[e.length-1].toLowerCase().includes("opacity")?t:`${t}px`:t)(e,t);Object.assign(o,{[r]:l}),Ri(i,e,`var(${r})`,a),Ri(s,e,`var(${r}, ${l})`,a)}},l=e=>"vars"===e[0],function e(t,n=[],r=[]){Object.entries(t).forEach(([t,o])=>{(!l||l&&!l([...n,t]))&&null!=o&&("object"==typeof o&&Object.keys(o).length>0?e(o,[...n,t],Array.isArray(o)?[...r,t]:r):a([...n,t],o,r))})}(e),{css:o,vars:i,varsWithDefaults:s}}function Ti(e,t,n=void 0){const r={};for(const o in e){const i=e[o];let s="",a=!0;for(let e=0;e<i.length;e+=1){const r=i[e];r&&(s+=(!0===a?"":" ")+t(r),a=!1,n&&n[r]&&(s+=" "+n[r]))}r[o]=s}return r}function Pi(e,t){return pe.isValidElement(e)&&-1!==t.indexOf(e.type.muiName??e.type?._payload?.value?.muiName)}const Fi=po(),Mi=Do("div",{name:"MuiStack",slot:"Root"});function Li(e){return jo({props:e,name:"MuiStack",defaultTheme:Fi})}function Ui(e,t){const n=pe.Children.toArray(e).filter(Boolean);return n.reduce((e,r,o)=>(e.push(r),o<n.length-1&&e.push(pe.cloneElement(t,{key:`separator-${o}`})),e),[])}const Oi=({ownerState:e,theme:t})=>{let n={display:"flex",flexDirection:"column",...fr({theme:t},yr({values:e.direction,breakpoints:t.breakpoints.values}),e=>({flexDirection:e}))};if(e.spacing){const r=kr(t),o=Object.keys(t.breakpoints.values).reduce((t,n)=>(("object"==typeof e.spacing&&null!=e.spacing[n]||"object"==typeof e.direction&&null!=e.direction[n])&&(t[n]=!0),t),{}),i=yr({values:e.direction,base:o}),s=yr({values:e.spacing,base:o});"object"==typeof i&&Object.keys(i).forEach((e,t,n)=>{if(!i[e]){const r=t>0?i[n[t-1]]:"column";i[e]=r}});n=ar(n,fr({theme:t},s,(t,n)=>{return e.useFlexGap?{gap:Tr(r,t)}:{"& > :not(style):not(style)":{margin:0},"& > :not(style) ~ :not(style)":{[`margin${o=n?i[n]:e.direction,{row:"Left","row-reverse":"Right",column:"Top","column-reverse":"Bottom"}[o]}`]:Tr(r,t)}};var o}))}return n=function(e,...t){const n=gr(e),r=[n,...t].reduce((e,t)=>ar(e,t),{});return mr(Object.keys(n),r)}(t.breakpoints,n),n};const Di={black:"#000",white:"#fff"},Ni={50:"#fafafa",100:"#f5f5f5",200:"#eeeeee",300:"#e0e0e0",400:"#bdbdbd",500:"#9e9e9e",600:"#757575",700:"#616161",800:"#424242",900:"#212121",A100:"#f5f5f5",A200:"#eeeeee",A400:"#bdbdbd",A700:"#616161"},ji="#f3e5f5",Qi="#ce93d8",zi="#ba68c8",Hi="#ab47bc",Gi="#9c27b0",Vi="#7b1fa2",Wi="#e57373",$i="#ef5350",Ki="#f44336",Xi="#d32f2f",Yi="#c62828",qi="#ffb74d",Ji="#ffa726",Zi="#ff9800",es="#f57c00",ts="#e65100",ns="#e3f2fd",rs="#90caf9",os="#42a5f5",is="#1976d2",ss="#1565c0",as="#4fc3f7",ls="#29b6f6",cs="#03a9f4",us="#0288d1",ds="#01579b",As="#81c784",hs="#66bb6a",ps="#4caf50",fs="#388e3c",gs="#2e7d32",ms="#1b5e20";function ys(){return{text:{primary:"rgba(0, 0, 0, 0.87)",secondary:"rgba(0, 0, 0, 0.6)",disabled:"rgba(0, 0, 0, 0.38)"},divider:"rgba(0, 0, 0, 0.12)",background:{paper:Di.white,default:Di.white},action:{active:"rgba(0, 0, 0, 0.54)",hover:"rgba(0, 0, 0, 0.04)",hoverOpacity:.04,selected:"rgba(0, 0, 0, 0.08)",selectedOpacity:.08,disabled:"rgba(0, 0, 0, 0.26)",disabledBackground:"rgba(0, 0, 0, 0.12)",disabledOpacity:.38,focus:"rgba(0, 0, 0, 0.12)",focusOpacity:.12,activatedOpacity:.12}}}const vs=ys();function bs(){return{text:{primary:Di.white,secondary:"rgba(255, 255, 255, 0.7)",disabled:"rgba(255, 255, 255, 0.5)",icon:"rgba(255, 255, 255, 0.5)"},divider:"rgba(255, 255, 255, 0.12)",background:{paper:"#121212",default:"#121212"},action:{active:Di.white,hover:"rgba(255, 255, 255, 0.08)",hoverOpacity:.08,selected:"rgba(255, 255, 255, 0.16)",selectedOpacity:.16,disabled:"rgba(255, 255, 255, 0.3)",disabledBackground:"rgba(255, 255, 255, 0.12)",disabledOpacity:.38,focus:"rgba(255, 255, 255, 0.12)",focusOpacity:.12,activatedOpacity:.24}}}const ws=bs();function xs(e,t,n,r){const o=r.light||r,i=r.dark||1.5*r;e[t]||(e.hasOwnProperty(n)?e[t]=e[n]:"light"===t?e.light=Jo(e.main,o):"dark"===t&&(e.dark=Yo(e.main,i)))}function _s(e,t,n,r,o){const i=o.light||o,s=o.dark||1.5*o;t[n]||(t.hasOwnProperty(r)?t[n]=t[r]:"light"===n?t.light=`color-mix(in ${e}, ${t.main}, #fff ${(100*i).toFixed(0)}%)`:"dark"===n&&(t.dark=`color-mix(in ${e}, ${t.main}, #000 ${(100*s).toFixed(0)}%)`))}function Cs(e){const{mode:t="light",contrastThreshold:n=3,tonalOffset:r=.2,colorSpace:o,...i}=e,s=e.primary||function(e="light"){return"dark"===e?{main:rs,light:ns,dark:os}:{main:is,light:os,dark:ss}}(t),a=e.secondary||function(e="light"){return"dark"===e?{main:Qi,light:ji,dark:Hi}:{main:Gi,light:zi,dark:Vi}}(t),l=e.error||function(e="light"){return"dark"===e?{main:Ki,light:Wi,dark:Xi}:{main:Xi,light:$i,dark:Yi}}(t),c=e.info||function(e="light"){return"dark"===e?{main:ls,light:as,dark:us}:{main:us,light:cs,dark:ds}}(t),u=e.success||function(e="light"){return"dark"===e?{main:hs,light:As,dark:fs}:{main:gs,light:ps,dark:ms}}(t),d=e.warning||function(e="light"){return"dark"===e?{main:Ji,light:qi,dark:es}:{main:"#ed6c02",light:Zi,dark:ts}}(t);function A(e){if(o)return function(e){return`oklch(from ${e} var(--__l) 0 h / var(--__a))`}(e);const t=function(e,t){const n=$o(e),r=$o(t);return(Math.max(n,r)+.05)/(Math.min(n,r)+.05)}(e,ws.text.primary)>=n?ws.text.primary:vs.text.primary;return t}const h=({color:e,name:t,mainShade:n=500,lightShade:i=300,darkShade:s=700})=>{if(!(e={...e}).main&&e[n]&&(e.main=e[n]),!e.hasOwnProperty("main"))throw new Error($e(11,t?` (${t})`:"",n));if("string"!=typeof e.main)throw new Error($e(12,t?` (${t})`:"",JSON.stringify(e.main)));return o?(_s(o,e,"light",i,r),_s(o,e,"dark",s,r)):(xs(e,"light",i,r),xs(e,"dark",s,r)),e.contrastText||(e.contrastText=A(e.main)),e};let p;"light"===t?p=ys():"dark"===t&&(p=bs());return ar({common:{...Di},mode:t,primary:h({color:s,name:"primary"}),secondary:h({color:a,name:"secondary",mainShade:"A400",lightShade:"A200",darkShade:"A700"}),error:h({color:l,name:"error"}),warning:h({color:d,name:"warning"}),info:h({color:c,name:"info"}),success:h({color:u,name:"success"}),grey:Ni,contrastThreshold:n,getContrastText:A,augmentColor:h,tonalOffset:r,...p},i)}function Ss(e){const t={};return Object.entries(e).forEach(e=>{const[n,r]=e;"object"==typeof r&&(t[n]=`${r.fontStyle?`${r.fontStyle} `:""}${r.fontVariant?`${r.fontVariant} `:""}${r.fontWeight?`${r.fontWeight} `:""}${r.fontStretch?`${r.fontStretch} `:""}${r.fontSize||""}${r.lineHeight?`/${r.lineHeight} `:""}${r.fontFamily||""}`)}),t}const Es={textTransform:"uppercase"},Bs='"Roboto", "Helvetica", "Arial", sans-serif';function Is(e,t){const{fontFamily:n=Bs,fontSize:r=14,fontWeightLight:o=300,fontWeightRegular:i=400,fontWeightMedium:s=500,fontWeightBold:a=700,htmlFontSize:l=16,allVariants:c,pxToRem:u,...d}="function"==typeof t?t(e):t,A=r/14,h=u||(e=>e/l*A+"rem"),p=(e,t,r,o,i)=>{return{fontFamily:n,fontWeight:e,fontSize:h(t),lineHeight:r,...n===Bs?{letterSpacing:(s=o/t,Math.round(1e5*s)/1e5)+"em"}:{},...i,...c};var s},f={h1:p(o,96,1.167,-1.5),h2:p(o,60,1.2,-.5),h3:p(i,48,1.167,0),h4:p(i,34,1.235,.25),h5:p(i,24,1.334,0),h6:p(s,20,1.6,.15),subtitle1:p(i,16,1.75,.15),subtitle2:p(s,14,1.57,.1),body1:p(i,16,1.5,.15),body2:p(i,14,1.43,.15),button:p(s,14,1.75,.4,Es),caption:p(i,12,1.66,.4),overline:p(i,12,2.66,1,Es),inherit:{fontFamily:"inherit",fontWeight:"inherit",fontSize:"inherit",lineHeight:"inherit",letterSpacing:"inherit"}};return ar({htmlFontSize:l,pxToRem:h,fontFamily:n,fontSize:r,fontWeightLight:o,fontWeightRegular:i,fontWeightMedium:s,fontWeightBold:a,...f},d,{clone:!1})}function Rs(...e){return[`${e[0]}px ${e[1]}px ${e[2]}px ${e[3]}px rgba(0,0,0,0.2)`,`${e[4]}px ${e[5]}px ${e[6]}px ${e[7]}px rgba(0,0,0,0.14)`,`${e[8]}px ${e[9]}px ${e[10]}px ${e[11]}px rgba(0,0,0,0.12)`].join(",")}const ks=["none",Rs(0,2,1,-1,0,1,1,0,0,1,3,0),Rs(0,3,1,-2,0,2,2,0,0,1,5,0),Rs(0,3,3,-2,0,3,4,0,0,1,8,0),Rs(0,2,4,-1,0,4,5,0,0,1,10,0),Rs(0,3,5,-1,0,5,8,0,0,1,14,0),Rs(0,3,5,-1,0,6,10,0,0,1,18,0),Rs(0,4,5,-2,0,7,10,1,0,2,16,1),Rs(0,5,5,-3,0,8,10,1,0,3,14,2),Rs(0,5,6,-3,0,9,12,1,0,3,16,2),Rs(0,6,6,-3,0,10,14,1,0,4,18,3),Rs(0,6,7,-4,0,11,15,1,0,4,20,3),Rs(0,7,8,-4,0,12,17,2,0,5,22,4),Rs(0,7,8,-4,0,13,19,2,0,5,24,4),Rs(0,7,9,-4,0,14,21,2,0,5,26,4),Rs(0,8,9,-5,0,15,22,2,0,6,28,5),Rs(0,8,10,-5,0,16,24,2,0,6,30,5),Rs(0,8,11,-5,0,17,26,2,0,6,32,5),Rs(0,9,11,-5,0,18,28,2,0,7,34,6),Rs(0,9,12,-6,0,19,29,2,0,7,36,6),Rs(0,10,13,-6,0,20,31,3,0,8,38,7),Rs(0,10,13,-6,0,21,33,3,0,8,40,7),Rs(0,10,14,-6,0,22,35,3,0,8,42,7),Rs(0,11,14,-7,0,23,36,3,0,9,44,8),Rs(0,11,15,-7,0,24,38,3,0,9,46,8)],Ts={easeInOut:"cubic-bezier(0.4, 0, 0.2, 1)",easeOut:"cubic-bezier(0.0, 0, 0.2, 1)",easeIn:"cubic-bezier(0.4, 0, 1, 1)",sharp:"cubic-bezier(0.4, 0, 0.6, 1)"},Ps={shortest:150,shorter:200,short:250,standard:300,complex:375,enteringScreen:225,leavingScreen:195};function Fs(e){return`${Math.round(e)}ms`}function Ms(e){if(!e)return 0;const t=e/36;return Math.min(Math.round(10*(4+15*t**.25+t/5)),3e3)}function Ls(e){const t={...Ts,...e.easing},n={...Ps,...e.duration};return{getAutoHeightDuration:Ms,create:(e=["all"],r={})=>{const{duration:o=n.standard,easing:i=t.easeInOut,delay:s=0,...a}=r;return(Array.isArray(e)?e:[e]).map(e=>`${e} ${"string"==typeof o?o:Fs(o)} ${i} ${"string"==typeof s?s:Fs(s)}`).join(",")},...e,easing:t,duration:n}}const Us={mobileStepper:1e3,fab:1050,speedDial:1050,appBar:1100,drawer:1200,modal:1300,snackbar:1400,tooltip:1500};function Os(e){return ir(e)||void 0===e||"string"==typeof e||"boolean"==typeof e||"number"==typeof e||Array.isArray(e)}function Ds(e={}){const t={...e};return function e(t){const n=Object.entries(t);for(let r=0;r<n.length;r++){const[o,i]=n[r];!Os(i)||o.startsWith("unstable_")?delete t[o]:ir(i)&&(t[o]={...i},e(t[o]))}}(t),`import { unstable_createBreakpoints as createBreakpoints, createTransitions } from '@mui/material/styles';\n\nconst theme = ${JSON.stringify(t,null,2)};\n\ntheme.breakpoints = createBreakpoints(theme.breakpoints || {});\ntheme.transitions = createTransitions(theme.transitions || {});\n\nexport default theme;`}function Ns(e){return"number"==typeof e?`${(100*e).toFixed(0)}%`:`calc((${e}) * 100%)`}function js(e){Object.assign(e,{alpha(t,n){const r=this||e;return r.colorSpace?`oklch(from ${t} l c h / ${"string"==typeof n?`calc(${n})`:n})`:r.vars?`rgba(${t.replace(/var\(--([^,\s)]+)(?:,[^)]+)?\)+/g,"var(--$1Channel)")} / ${"string"==typeof n?`calc(${n})`:n})`:Ko(t,(e=>{if(!Number.isNaN(+e))return+e;const t=e.match(/\d*\.?\d+/g);if(!t)return 0;let n=0;for(let r=0;r<t.length;r+=1)n+=+t[r];return n})(n))},lighten(t,n){const r=this||e;return r.colorSpace?`color-mix(in ${r.colorSpace}, ${t}, #fff ${Ns(n)})`:Jo(t,n)},darken(t,n){const r=this||e;return r.colorSpace?`color-mix(in ${r.colorSpace}, ${t}, #000 ${Ns(n)})`:Yo(t,n)}})}function Qs(e={},...t){const{breakpoints:n,mixins:r={},spacing:o,palette:i={},transitions:s={},typography:a={},shape:l,colorSpace:c,...u}=e;if(e.vars&&void 0===e.generateThemeVars)throw new Error($e(20));const d=Cs({...i,colorSpace:c}),A=po(e);let h=ar(A,{mixins:(p=A.breakpoints,f=r,{toolbar:{minHeight:56,[p.up("xs")]:{"@media (orientation: landscape)":{minHeight:48}},[p.up("sm")]:{minHeight:64}},...f}),palette:d,shadows:ks.slice(),typography:Is(d,a),transitions:Ls(s),zIndex:{...Us}});var p,f;return h=ar(h,u),h=t.reduce((e,t)=>ar(e,t),h),h.unstable_sxConfig={...uo,...u?.unstable_sxConfig},h.unstable_sx=function(e){return Ao({sx:e,theme:this})},h.toRuntimeSource=Ds,js(h),h}function zs(e){let t;return t=e<1?5.11916*e**2:4.5*Math.log(e+1)+2,Math.round(10*t)/1e3}const Hs=[...Array(25)].map((e,t)=>{if(0===t)return"none";const n=zs(t);return`linear-gradient(rgba(255 255 255 / ${n}), rgba(255 255 255 / ${n}))`});function Gs(e){return{inputPlaceholder:"dark"===e?.5:.42,inputUnderline:"dark"===e?.7:.42,switchTrackDisabled:"dark"===e?.2:.12,switchTrack:"dark"===e?.3:.38}}function Vs(e){return"dark"===e?Hs:[]}function Ws(e){return!!e[0].match(/(cssVarPrefix|colorSchemeSelector|modularCssLayers|rootSelector|typography|mixins|breakpoints|direction|transitions)/)||!!e[0].match(/sxConfig$/)||"palette"===e[0]&&!!e[1]?.match(/(mode|contrastThreshold|tonalOffset)/)}const $s=e=>(t,n)=>{const r=e.rootSelector||":root",o=e.colorSchemeSelector;let i=o;if("class"===o&&(i=".%s"),"data"===o&&(i="[data-%s]"),o?.startsWith("data-")&&!o.includes("%s")&&(i=`[${o}="%s"]`),e.defaultColorScheme===t){if("dark"===t){const o={};return(s=e.cssVarPrefix,[...[...Array(25)].map((e,t)=>`--${s?`${s}-`:""}overlays-${t}`),`--${s?`${s}-`:""}palette-AppBar-darkBg`,`--${s?`${s}-`:""}palette-AppBar-darkColor`]).forEach(e=>{o[e]=n[e],delete n[e]}),"media"===i?{[r]:n,"@media (prefers-color-scheme: dark)":{[r]:o}}:i?{[i.replace("%s",t)]:o,[`${r}, ${i.replace("%s",t)}`]:n}:{[r]:{...n,...o}}}if(i&&"media"!==i)return`${r}, ${i.replace("%s",String(t))}`}else if(t){if("media"===i)return{[`@media (prefers-color-scheme: ${String(t)})`]:{[r]:n}};if(i)return i.replace("%s",String(t))}var s;return r};function Ks(e,t,n){!e[t]&&n&&(e[t]=n)}function Xs(e){return"string"==typeof e&&e.startsWith("hsl")?Wo(e):e}function Ys(e,t){`${t}Channel`in e||(e[`${t}Channel`]=Go(Xs(e[t])))}const qs=e=>{try{return e()}catch(t){}};function Js(e,t,n,r,o){if(!n)return;n=!0===n?{}:n;const i="dark"===o?"dark":"light";if(!r)return void(t[o]=function(e){const{palette:t={mode:"light"},opacity:n,overlays:r,colorSpace:o,...i}=e,s=Cs({...t,colorSpace:o});return{palette:s,opacity:{...Gs(s.mode),...n},overlays:r||Vs(s.mode),...i}}({...n,palette:{mode:i,...n?.palette},colorSpace:e}));const{palette:s,...a}=Qs({...r,palette:{mode:i,...n?.palette},colorSpace:e});return t[o]={...n,palette:s,opacity:{...Gs(i),...n?.opacity},overlays:n?.overlays||Vs(i)},a}function Zs(e={},...t){const{colorSchemes:n={light:!0},defaultColorScheme:r,disableCssColorScheme:o=!1,cssVarPrefix:i="mui",nativeColor:s=!1,shouldSkipGeneratingVar:a=Ws,colorSchemeSelector:l=(n.light&&n.dark?"media":void 0),rootSelector:c=":root",...u}=e,d=Object.keys(n)[0],A=r||(n.light&&"light"!==d?"light":d),h=((e="mui")=>Ii(e))(i),{[A]:p,light:f,dark:g,...m}=n,y={...m};let v,b=p;if(("dark"===A&&!("dark"in n)||"light"===A&&!("light"in n))&&(b=!0),!b)throw new Error($e(21,A));s&&(v="oklch");const w=Js(v,y,b,u,A);f&&!y.light&&Js(v,y,f,void 0,"light"),g&&!y.dark&&Js(v,y,g,void 0,"dark");let x={defaultColorScheme:A,...w,cssVarPrefix:i,colorSchemeSelector:l,rootSelector:c,getCssVar:h,colorSchemes:y,font:{...Ss(w.typography),...w.font},spacing:(_=u.spacing,"number"==typeof _?`${_}px`:"string"==typeof _||"function"==typeof _||Array.isArray(_)?_:"8px")};var _;Object.keys(x.colorSchemes).forEach(e=>{const t=x.colorSchemes[e].palette,n=e=>{const n=e.split("-"),r=n[1],o=n[2];return h(e,t[r][o])};function r(e,t,n){if(v){let r;return e===Xo&&(r=`transparent ${(100*(1-n)).toFixed(0)}%`),e===qo&&(r=`#000 ${(100*n).toFixed(0)}%`),e===Zo&&(r=`#fff ${(100*n).toFixed(0)}%`),`color-mix(in ${v}, ${t}, ${r})`}return e(t,n)}var o;if("light"===t.mode&&(Ks(t.common,"background","#fff"),Ks(t.common,"onBackground","#000")),"dark"===t.mode&&(Ks(t.common,"background","#000"),Ks(t.common,"onBackground","#fff")),o=t,["Alert","AppBar","Avatar","Button","Chip","FilledInput","LinearProgress","Skeleton","Slider","SnackbarContent","SpeedDialAction","StepConnector","StepContent","Switch","TableCell","Tooltip"].forEach(e=>{o[e]||(o[e]={})}),"light"===t.mode){Ks(t.Alert,"errorColor",r(qo,t.error.light,.6)),Ks(t.Alert,"infoColor",r(qo,t.info.light,.6)),Ks(t.Alert,"successColor",r(qo,t.success.light,.6)),Ks(t.Alert,"warningColor",r(qo,t.warning.light,.6)),Ks(t.Alert,"errorFilledBg",n("palette-error-main")),Ks(t.Alert,"infoFilledBg",n("palette-info-main")),Ks(t.Alert,"successFilledBg",n("palette-success-main")),Ks(t.Alert,"warningFilledBg",n("palette-warning-main")),Ks(t.Alert,"errorFilledColor",qs(()=>t.getContrastText(t.error.main))),Ks(t.Alert,"infoFilledColor",qs(()=>t.getContrastText(t.info.main))),Ks(t.Alert,"successFilledColor",qs(()=>t.getContrastText(t.success.main))),Ks(t.Alert,"warningFilledColor",qs(()=>t.getContrastText(t.warning.main))),Ks(t.Alert,"errorStandardBg",r(Zo,t.error.light,.9)),Ks(t.Alert,"infoStandardBg",r(Zo,t.info.light,.9)),Ks(t.Alert,"successStandardBg",r(Zo,t.success.light,.9)),Ks(t.Alert,"warningStandardBg",r(Zo,t.warning.light,.9)),Ks(t.Alert,"errorIconColor",n("palette-error-main")),Ks(t.Alert,"infoIconColor",n("palette-info-main")),Ks(t.Alert,"successIconColor",n("palette-success-main")),Ks(t.Alert,"warningIconColor",n("palette-warning-main")),Ks(t.AppBar,"defaultBg",n("palette-grey-100")),Ks(t.Avatar,"defaultBg",n("palette-grey-400")),Ks(t.Button,"inheritContainedBg",n("palette-grey-300")),Ks(t.Button,"inheritContainedHoverBg",n("palette-grey-A100")),Ks(t.Chip,"defaultBorder",n("palette-grey-400")),Ks(t.Chip,"defaultAvatarColor",n("palette-grey-700")),Ks(t.Chip,"defaultIconColor",n("palette-grey-700")),Ks(t.FilledInput,"bg","rgba(0, 0, 0, 0.06)"),Ks(t.FilledInput,"hoverBg","rgba(0, 0, 0, 0.09)"),Ks(t.FilledInput,"disabledBg","rgba(0, 0, 0, 0.12)"),Ks(t.LinearProgress,"primaryBg",r(Zo,t.primary.main,.62)),Ks(t.LinearProgress,"secondaryBg",r(Zo,t.secondary.main,.62)),Ks(t.LinearProgress,"errorBg",r(Zo,t.error.main,.62)),Ks(t.LinearProgress,"infoBg",r(Zo,t.info.main,.62)),Ks(t.LinearProgress,"successBg",r(Zo,t.success.main,.62)),Ks(t.LinearProgress,"warningBg",r(Zo,t.warning.main,.62)),Ks(t.Skeleton,"bg",v?r(Xo,t.text.primary,.11):`rgba(${n("palette-text-primaryChannel")} / 0.11)`),Ks(t.Slider,"primaryTrack",r(Zo,t.primary.main,.62)),Ks(t.Slider,"secondaryTrack",r(Zo,t.secondary.main,.62)),Ks(t.Slider,"errorTrack",r(Zo,t.error.main,.62)),Ks(t.Slider,"infoTrack",r(Zo,t.info.main,.62)),Ks(t.Slider,"successTrack",r(Zo,t.success.main,.62)),Ks(t.Slider,"warningTrack",r(Zo,t.warning.main,.62));const e=v?r(qo,t.background.default,.6825):ti(t.background.default,.8);Ks(t.SnackbarContent,"bg",e),Ks(t.SnackbarContent,"color",qs(()=>v?ws.text.primary:t.getContrastText(e))),Ks(t.SpeedDialAction,"fabHoverBg",ti(t.background.paper,.15)),Ks(t.StepConnector,"border",n("palette-grey-400")),Ks(t.StepContent,"border",n("palette-grey-400")),Ks(t.Switch,"defaultColor",n("palette-common-white")),Ks(t.Switch,"defaultDisabledColor",n("palette-grey-100")),Ks(t.Switch,"primaryDisabledColor",r(Zo,t.primary.main,.62)),Ks(t.Switch,"secondaryDisabledColor",r(Zo,t.secondary.main,.62)),Ks(t.Switch,"errorDisabledColor",r(Zo,t.error.main,.62)),Ks(t.Switch,"infoDisabledColor",r(Zo,t.info.main,.62)),Ks(t.Switch,"successDisabledColor",r(Zo,t.success.main,.62)),Ks(t.Switch,"warningDisabledColor",r(Zo,t.warning.main,.62)),Ks(t.TableCell,"border",r(Zo,r(Xo,t.divider,1),.88)),Ks(t.Tooltip,"bg",r(Xo,t.grey[700],.92))}if("dark"===t.mode){Ks(t.Alert,"errorColor",r(Zo,t.error.light,.6)),Ks(t.Alert,"infoColor",r(Zo,t.info.light,.6)),Ks(t.Alert,"successColor",r(Zo,t.success.light,.6)),Ks(t.Alert,"warningColor",r(Zo,t.warning.light,.6)),Ks(t.Alert,"errorFilledBg",n("palette-error-dark")),Ks(t.Alert,"infoFilledBg",n("palette-info-dark")),Ks(t.Alert,"successFilledBg",n("palette-success-dark")),Ks(t.Alert,"warningFilledBg",n("palette-warning-dark")),Ks(t.Alert,"errorFilledColor",qs(()=>t.getContrastText(t.error.dark))),Ks(t.Alert,"infoFilledColor",qs(()=>t.getContrastText(t.info.dark))),Ks(t.Alert,"successFilledColor",qs(()=>t.getContrastText(t.success.dark))),Ks(t.Alert,"warningFilledColor",qs(()=>t.getContrastText(t.warning.dark))),Ks(t.Alert,"errorStandardBg",r(qo,t.error.light,.9)),Ks(t.Alert,"infoStandardBg",r(qo,t.info.light,.9)),Ks(t.Alert,"successStandardBg",r(qo,t.success.light,.9)),Ks(t.Alert,"warningStandardBg",r(qo,t.warning.light,.9)),Ks(t.Alert,"errorIconColor",n("palette-error-main")),Ks(t.Alert,"infoIconColor",n("palette-info-main")),Ks(t.Alert,"successIconColor",n("palette-success-main")),Ks(t.Alert,"warningIconColor",n("palette-warning-main")),Ks(t.AppBar,"defaultBg",n("palette-grey-900")),Ks(t.AppBar,"darkBg",n("palette-background-paper")),Ks(t.AppBar,"darkColor",n("palette-text-primary")),Ks(t.Avatar,"defaultBg",n("palette-grey-600")),Ks(t.Button,"inheritContainedBg",n("palette-grey-800")),Ks(t.Button,"inheritContainedHoverBg",n("palette-grey-700")),Ks(t.Chip,"defaultBorder",n("palette-grey-700")),Ks(t.Chip,"defaultAvatarColor",n("palette-grey-300")),Ks(t.Chip,"defaultIconColor",n("palette-grey-300")),Ks(t.FilledInput,"bg","rgba(255, 255, 255, 0.09)"),Ks(t.FilledInput,"hoverBg","rgba(255, 255, 255, 0.13)"),Ks(t.FilledInput,"disabledBg","rgba(255, 255, 255, 0.12)"),Ks(t.LinearProgress,"primaryBg",r(qo,t.primary.main,.5)),Ks(t.LinearProgress,"secondaryBg",r(qo,t.secondary.main,.5)),Ks(t.LinearProgress,"errorBg",r(qo,t.error.main,.5)),Ks(t.LinearProgress,"infoBg",r(qo,t.info.main,.5)),Ks(t.LinearProgress,"successBg",r(qo,t.success.main,.5)),Ks(t.LinearProgress,"warningBg",r(qo,t.warning.main,.5)),Ks(t.Skeleton,"bg",v?r(Xo,t.text.primary,.13):`rgba(${n("palette-text-primaryChannel")} / 0.13)`),Ks(t.Slider,"primaryTrack",r(qo,t.primary.main,.5)),Ks(t.Slider,"secondaryTrack",r(qo,t.secondary.main,.5)),Ks(t.Slider,"errorTrack",r(qo,t.error.main,.5)),Ks(t.Slider,"infoTrack",r(qo,t.info.main,.5)),Ks(t.Slider,"successTrack",r(qo,t.success.main,.5)),Ks(t.Slider,"warningTrack",r(qo,t.warning.main,.5));const e=v?r(Zo,t.background.default,.985):ti(t.background.default,.98);Ks(t.SnackbarContent,"bg",e),Ks(t.SnackbarContent,"color",qs(()=>v?vs.text.primary:t.getContrastText(e))),Ks(t.SpeedDialAction,"fabHoverBg",ti(t.background.paper,.15)),Ks(t.StepConnector,"border",n("palette-grey-600")),Ks(t.StepContent,"border",n("palette-grey-600")),Ks(t.Switch,"defaultColor",n("palette-grey-300")),Ks(t.Switch,"defaultDisabledColor",n("palette-grey-600")),Ks(t.Switch,"primaryDisabledColor",r(qo,t.primary.main,.55)),Ks(t.Switch,"secondaryDisabledColor",r(qo,t.secondary.main,.55)),Ks(t.Switch,"errorDisabledColor",r(qo,t.error.main,.55)),Ks(t.Switch,"infoDisabledColor",r(qo,t.info.main,.55)),Ks(t.Switch,"successDisabledColor",r(qo,t.success.main,.55)),Ks(t.Switch,"warningDisabledColor",r(qo,t.warning.main,.55)),Ks(t.TableCell,"border",r(qo,r(Xo,t.divider,1),.68)),Ks(t.Tooltip,"bg",r(Xo,t.grey[700],.92))}Ys(t.background,"default"),Ys(t.background,"paper"),Ys(t.common,"background"),Ys(t.common,"onBackground"),Ys(t,"divider"),Object.keys(t).forEach(e=>{const n=t[e];"tonalOffset"!==e&&n&&"object"==typeof n&&(n.main&&Ks(t[e],"mainChannel",Go(Xs(n.main))),n.light&&Ks(t[e],"lightChannel",Go(Xs(n.light))),n.dark&&Ks(t[e],"darkChannel",Go(Xs(n.dark))),n.contrastText&&Ks(t[e],"contrastTextChannel",Go(Xs(n.contrastText))),"text"===e&&(Ys(t[e],"primary"),Ys(t[e],"secondary")),"action"===e&&(n.active&&Ys(t[e],"active"),n.selected&&Ys(t[e],"selected")))})}),x=t.reduce((e,t)=>ar(e,t),x);const C={prefix:i,disableCssColorScheme:o,shouldSkipGeneratingVar:a,getSelector:$s(x),enableContrastVars:s},{vars:S,generateThemeVars:E,generateStyleSheets:B}=function(e,t={}){const{getSelector:n=m,disableCssColorScheme:r,colorSchemeSelector:o,enableContrastVars:i}=t,{colorSchemes:s={},components:a,defaultColorScheme:l="light",...c}=e,{vars:u,css:d,varsWithDefaults:A}=ki(c,t);let h=A;const p={},{[l]:f,...g}=s;if(Object.entries(g||{}).forEach(([e,n])=>{const{vars:r,css:o,varsWithDefaults:i}=ki(n,t);h=ar(h,i),p[e]={css:o,vars:r}}),f){const{css:e,vars:n,varsWithDefaults:r}=ki(f,t);h=ar(h,r),p[l]={css:e,vars:n}}function m(t,n){let r=o;if("class"===o&&(r=".%s"),"data"===o&&(r="[data-%s]"),o?.startsWith("data-")&&!o.includes("%s")&&(r=`[${o}="%s"]`),t){if("media"===r){if(e.defaultColorScheme===t)return":root";const r=s[t]?.palette?.mode||t;return{[`@media (prefers-color-scheme: ${r})`]:{":root":n}}}if(r)return e.defaultColorScheme===t?`:root, ${r.replace("%s",String(t))}`:r.replace("%s",String(t))}return":root"}return{vars:h,generateThemeVars:()=>{let e={...u};return Object.entries(p).forEach(([,{vars:t}])=>{e=ar(e,t)}),e},generateStyleSheets:()=>{const t=[],o=e.defaultColorScheme||"light";function a(e,n){Object.keys(n).length&&t.push("string"==typeof e?{[e]:{...n}}:e)}a(n(void 0,{...d}),d);const{[o]:l,...c}=p;if(l){const{css:e}=l,t=s[o]?.palette?.mode,i=!r&&t?{colorScheme:t,...e}:{...e};a(n(o,{...i}),i)}return Object.entries(c).forEach(([e,{css:t}])=>{const o=s[e]?.palette?.mode,i=!r&&o?{colorScheme:o,...t}:{...t};a(n(e,{...i}),i)}),i&&t.push({":root":{"--__l-threshold":"0.7","--__l":"clamp(0, (l / var(--__l-threshold) - 1) * -infinity, 1)","--__a":"clamp(0.87, (l / var(--__l-threshold) - 1) * -infinity, 1)"}}),t}}}(x,C);return x.vars=S,Object.entries(x.colorSchemes[x.defaultColorScheme]).forEach(([e,t])=>{x[e]=t}),x.generateThemeVars=E,x.generateStyleSheets=B,x.generateSpacing=function(){return Ur(u.spacing,kr(this))},x.getColorSchemeSelector=function(e){return function(t){return"media"===e?`@media (prefers-color-scheme: ${t})`:e?e.startsWith("data-")&&!e.includes("%s")?`[${e}="${t}"] &`:"class"===e?`.${t} &`:"data"===e?`[data-${t}] &`:`${e.replace("%s",t)} &`:"&"}}(l),x.spacing=x.generateSpacing(),x.shouldSkipGeneratingVar=a,x.unstable_sxConfig={...uo,...u?.unstable_sxConfig},x.unstable_sx=function(e){return Ao({sx:e,theme:this})},x.toRuntimeSource=Ds,x}function ea(e,t,n){e.colorSchemes&&n&&(e.colorSchemes[t]={...!0!==n&&n,palette:Cs({...!0===n?{}:n.palette,mode:t})})}function ta(e={},...t){const{palette:n,cssVariables:r=!1,colorSchemes:o=(n?void 0:{light:!0}),defaultColorScheme:i=n?.mode,...s}=e,a=i||"light",l=o?.[a],c={...o,...n?{[a]:{..."boolean"!=typeof l&&l,palette:n}}:void 0};if(!1===r){if(!("colorSchemes"in e))return Qs(e,...t);let r=n;"palette"in e||c[a]&&(!0!==c[a]?r=c[a].palette:"dark"===a&&(r={mode:"dark"}));const o=Qs({...e,palette:r},...t);return o.defaultColorScheme=a,o.colorSchemes=c,"light"===o.palette.mode&&(o.colorSchemes.light={...!0!==c.light&&c.light,palette:o.palette},ea(o,"dark",c.dark)),"dark"===o.palette.mode&&(o.colorSchemes.dark={...!0!==c.dark&&c.dark,palette:o.palette},ea(o,"light",c.light)),o}return n||"light"in c||"light"!==a||(c.light=!0),Zs({...s,colorSchemes:c,defaultColorScheme:a,..."boolean"!=typeof r&&r},...t)}const na=ta(),ra="$$material";function oa(e){return s.jsx(vo,{...e,defaultTheme:na,themeId:ra})}function ia(){const e=mo(na);return e[ra]||e}function sa(e){return"ownerState"!==e&&"theme"!==e&&"sx"!==e&&"as"!==e}const aa=e=>sa(e)&&"classes"!==e,la=Lo({themeId:ra,defaultTheme:na,rootShouldForwardProp:aa});function ca({theme:e,...t}){const n=ra in e?e[ra]:void 0;return s.jsx(mi,{...t,themeId:n?ra:void 0,theme:n||e})}const ua="mui-color-scheme",da="light",Aa="dark",ha="mui-mode",{CssVarsProvider:pa}=function(e){const{themeId:t,theme:n={},modeStorageKey:r=vi,colorSchemeStorageKey:o=bi,disableTransitionOnChange:i=!1,defaultColorScheme:a,resolveTheme:l}=e,c={allColorSchemes:[],colorScheme:void 0,darkColorScheme:void 0,lightColorScheme:void 0,mode:void 0,setColorScheme:()=>{},setMode:()=>{},systemMode:void 0},u=pe.createContext(void 0),d={},A={},h="string"==typeof a?a:a.light,p="string"==typeof a?a:a.dark;return{CssVarsProvider:function(e){const{children:c,theme:h,modeStorageKey:p=r,colorSchemeStorageKey:f=o,disableTransitionOnChange:g=i,storageManager:m,storageWindow:y=("undefined"==typeof window?void 0:window),documentNode:v=("undefined"==typeof document?void 0:document),colorSchemeNode:b=("undefined"==typeof document?void 0:document.documentElement),disableNestedContext:w=!1,disableStyleSheetGeneration:x=!1,defaultMode:_="system",forceThemeRerender:C=!1,noSsr:S}=e,E=pe.useRef(!1),B=ri(),I=pe.useContext(u),R=!!I&&!w,k=pe.useMemo(()=>h||("function"==typeof n?n():n),[h]),T=k[t],P=T||k,{colorSchemes:F=d,components:M=A,cssVarPrefix:L}=P,U=Object.keys(F).filter(e=>!!F[e]).join(","),O=pe.useMemo(()=>U.split(","),[U]),D="string"==typeof a?a:a.light,N="string"==typeof a?a:a.dark,j=F[D]&&F[N]?_:F[P.defaultColorScheme]?.palette?.mode||P.palette?.mode,{mode:Q,setMode:z,systemMode:H,lightColorScheme:G,darkColorScheme:V,colorScheme:W,setColorScheme:$}=Bi({supportedColorSchemes:O,defaultLightColorScheme:D,defaultDarkColorScheme:N,modeStorageKey:p,colorSchemeStorageKey:f,defaultMode:j,storageManager:m,storageWindow:y,noSsr:S});let K=Q,X=W;R&&(K=I.mode,X=I.colorScheme);let Y=X||P.defaultColorScheme;P.vars&&!C&&(Y=P.defaultColorScheme);const q=pe.useMemo(()=>{const e=P.generateThemeVars?.()||P.vars,t={...P,components:M,colorSchemes:F,cssVarPrefix:L,vars:e};if("function"==typeof t.generateSpacing&&(t.spacing=t.generateSpacing()),Y){const e=F[Y];e&&"object"==typeof e&&Object.keys(e).forEach(n=>{e[n]&&"object"==typeof e[n]?t[n]={...t[n],...e[n]}:t[n]=e[n]})}return l?l(t):t},[P,Y,M,F,L]),J=P.colorSchemeSelector;Qo(()=>{if(X&&b&&J&&"media"!==J){const e=J;let t=J;if("class"===e&&(t=".%s"),"data"===e&&(t="[data-%s]"),e?.startsWith("data-")&&!e.includes("%s")&&(t=`[${e}="%s"]`),t.startsWith("."))b.classList.remove(...O.map(e=>t.substring(1).replace("%s",e))),b.classList.add(t.substring(1).replace("%s",X));else{const e=t.replace("%s",X).match(/\[([^\]]+)\]/);if(e){const[t,n]=e[1].split("=");n||O.forEach(e=>{b.removeAttribute(t.replace(X,e))}),b.setAttribute(t,n?n.replace(/"|'/g,""):"")}else b.setAttribute(t,X)}}},[X,J,b,O]),pe.useEffect(()=>{let e;if(g&&E.current&&v){const t=v.createElement("style");t.appendChild(v.createTextNode("*{-webkit-transition:none!important;-moz-transition:none!important;-o-transition:none!important;-ms-transition:none!important;transition:none!important}")),v.head.appendChild(t),window.getComputedStyle(v.body),e=setTimeout(()=>{v.head.removeChild(t)},1)}return()=>{clearTimeout(e)}},[X,g,v]),pe.useEffect(()=>(E.current=!0,()=>{E.current=!1}),[]);const Z=pe.useMemo(()=>({allColorSchemes:O,colorScheme:X,darkColorScheme:V,lightColorScheme:G,mode:K,setColorScheme:$,setMode:z,systemMode:H}),[O,X,V,G,K,$,z,H,q.colorSchemeSelector]);let ee=!0;(x||!1===P.cssVariables||R&&B?.cssVarPrefix===L)&&(ee=!1);const te=s.jsxs(pe.Fragment,{children:[s.jsx(mi,{themeId:T?t:void 0,theme:q,children:c}),ee&&s.jsx(Kn,{styles:q.generateStyleSheets?.()||[]})]});return R?te:s.jsx(u.Provider,{value:Z,children:te})},useColorScheme:()=>pe.useContext(u)||c,getInitColorSchemeScript:e=>function(e){const{defaultMode:t="system",defaultLightColorScheme:n="light",defaultDarkColorScheme:r="dark",modeStorageKey:o=vi,colorSchemeStorageKey:i=bi,attribute:a=wi,colorSchemeNode:l="document.documentElement",nonce:c}=e||{};let u="",d=a;if("class"===a&&(d=".%s"),"data"===a&&(d="[data-%s]"),d.startsWith(".")){const e=d.substring(1);u+=`${l}.classList.remove('${e}'.replace('%s', light), '${e}'.replace('%s', dark));\n      ${l}.classList.add('${e}'.replace('%s', colorScheme));`}const A=d.match(/\[([^[\]]+)\]/);if(A){const[e,t]=A[1].split("=");t||(u+=`${l}.removeAttribute('${e}'.replace('%s', light));\n      ${l}.removeAttribute('${e}'.replace('%s', dark));`),u+=`\n      ${l}.setAttribute('${e}'.replace('%s', colorScheme), ${t?`${t}.replace('%s', colorScheme)`:'""'});`}else u+=`${l}.setAttribute('${d}', colorScheme);`;return s.jsx("script",{suppressHydrationWarning:!0,nonce:"undefined"==typeof window?c:"",dangerouslySetInnerHTML:{__html:`(function() {\ntry {\n  let colorScheme = '';\n  const mode = localStorage.getItem('${o}') || '${t}';\n  const dark = localStorage.getItem('${i}-dark') || '${r}';\n  const light = localStorage.getItem('${i}-light') || '${n}';\n  if (mode === 'system') {\n    // handle system mode\n    const mql = window.matchMedia('(prefers-color-scheme: dark)');\n    if (mql.matches) {\n      colorScheme = dark\n    } else {\n      colorScheme = light\n    }\n  }\n  if (mode === 'light') {\n    colorScheme = light;\n  }\n  if (mode === 'dark') {\n    colorScheme = dark;\n  }\n  if (colorScheme) {\n    ${u}\n  }\n} catch(e){}})();`}},"mui-color-scheme-init")}({colorSchemeStorageKey:o,defaultLightColorScheme:h,defaultDarkColorScheme:p,modeStorageKey:r,...e})}}({themeId:ra,theme:()=>ta({cssVariables:!0}),colorSchemeStorageKey:ua,modeStorageKey:ha,defaultColorScheme:{light:da,dark:Aa},resolveTheme:e=>{const t={...e,typography:Is(e.palette,e.typography)};return t.unstable_sx=function(e){return Ao({sx:e,theme:this})},t}}),fa=pa;function ga({theme:e,...t}){const n=pe.useMemo(()=>{if("function"==typeof e)return e;const t=ra in e?e[ra]:e;return"colorSchemes"in t?null:"vars"in t?e:{...e,vars:null}},[e]);return n?s.jsx(ca,{theme:n,...t}):s.jsx(fa,{theme:e,...t})}
/**
 * react-router v7.9.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */var ma,ya=e=>{throw TypeError(e)},va=(e,t,n)=>(((e,t,n)=>{t.has(e)||ya("Cannot "+n)})(e,t,"read from private field"),n?n.call(e):t.get(e)),ba="popstate";function wa(e={}){return function(e,t,n,r={}){let{window:o=document.defaultView,v5Compat:i=!1}=r,s=o.history,a="POP",l=null,c=u();null==c&&(c=0,s.replaceState({...s.state,idx:c},""));function u(){return(s.state||{idx:null}).idx}function d(){a="POP";let e=u(),t=null==e?null:e-c;c=e,l&&l({action:a,location:f.location,delta:t})}function A(e,t){a="PUSH";let n=Sa(f.location,e,t);c=u()+1;let r=Ca(n,c),d=f.createHref(n);try{s.pushState(r,"",d)}catch(A){if(A instanceof DOMException&&"DataCloneError"===A.name)throw A;o.location.assign(d)}i&&l&&l({action:a,location:f.location,delta:1})}function h(e,t){a="REPLACE";let n=Sa(f.location,e,t);c=u();let r=Ca(n,c),o=f.createHref(n);s.replaceState(r,"",o),i&&l&&l({action:a,location:f.location,delta:0})}function p(e){return Ia(e)}let f={get action(){return a},get location(){return e(o,s)},listen(e){if(l)throw new Error("A history only accepts one active listener");return o.addEventListener(ba,d),l=e,()=>{o.removeEventListener(ba,d),l=null}},createHref:e=>t(o,e),createURL:p,encodeLocation(e){let t=p(e);return{pathname:t.pathname,search:t.search,hash:t.hash}},push:A,replace:h,go:e=>s.go(e)};return f}(function(e,t){let{pathname:n,search:r,hash:o}=e.location;return Sa("",{pathname:n,search:r,hash:o},t.state&&t.state.usr||null,t.state&&t.state.key||"default")},function(e,t){return"string"==typeof t?t:Ea(t)},0,e)}function xa(e,t){if(!1===e||null==e)throw new Error(t)}function _a(e,t){if(!e)try{throw new Error(t)}catch(n){}}function Ca(e,t){return{usr:e.state,key:e.key,idx:t}}function Sa(e,t,n=null,r){return{pathname:"string"==typeof e?e:e.pathname,search:"",hash:"",..."string"==typeof t?Ba(t):t,state:n,key:t&&t.key||r||Math.random().toString(36).substring(2,10)}}function Ea({pathname:e="/",search:t="",hash:n=""}){return t&&"?"!==t&&(e+="?"===t.charAt(0)?t:"?"+t),n&&"#"!==n&&(e+="#"===n.charAt(0)?n:"#"+n),e}function Ba(e){let t={};if(e){let n=e.indexOf("#");n>=0&&(t.hash=e.substring(n),e=e.substring(0,n));let r=e.indexOf("?");r>=0&&(t.search=e.substring(r),e=e.substring(0,r)),e&&(t.pathname=e)}return t}function Ia(e,t=!1){let n="http://localhost";"undefined"!=typeof window&&(n="null"!==window.location.origin?window.location.origin:window.location.href),xa(n,"No window.location.(origin|href) available to create URL");let r="string"==typeof e?e:Ea(e);return r=r.replace(/ $/,"%20"),!t&&r.startsWith("//")&&(r=n+r),new URL(r,n)}var Ra=class{constructor(e){var t,n,r;if(t=this,n=ma,r=new Map,n.has(t)?ya("Cannot add the same private member more than once"):n instanceof WeakSet?n.add(t):n.set(t,r),e)for(let[o,i]of e)this.set(o,i)}get(e){if(va(this,ma).has(e))return va(this,ma).get(e);if(void 0!==e.defaultValue)return e.defaultValue;throw new Error("No value found for context")}set(e,t){va(this,ma).set(e,t)}};ma=new WeakMap;var ka=new Set(["lazy","caseSensitive","path","id","index","children"]);var Ta=new Set(["lazy","caseSensitive","path","id","index","middleware","children"]);function Pa(e){return Ta.has(e)}function Fa(e,t,n=[],r={},o=!1){return e.map((e,i)=>{let s=[...n,String(i)],a="string"==typeof e.id?e.id:s.join("-");if(xa(!0!==e.index||!e.children,"Cannot specify children on an index route"),xa(o||!r[a],`Found a route id collision on id "${a}".  Route id's must be globally unique within Data Router usages`),function(e){return!0===e.index}(e)){let n={...e,...t(e),id:a};return r[a]=n,n}{let n={...e,...t(e),id:a,children:void 0};return r[a]=n,e.children&&(n.children=Fa(e.children,t,s,r,o)),n}})}function Ma(e,t,n="/"){return La(e,t,n,!1)}function La(e,t,n,r){let o=Xa(("string"==typeof t?Ba(t):t).pathname||"/",n);if(null==o)return null;let i=Ua(e);!function(e){e.sort((e,t)=>e.score!==t.score?t.score-e.score:function(e,t){let n=e.length===t.length&&e.slice(0,-1).every((e,n)=>e===t[n]);return n?e[e.length-1]-t[t.length-1]:0}(e.routesMeta.map(e=>e.childrenIndex),t.routesMeta.map(e=>e.childrenIndex)))}(i);let s=null;for(let a=0;null==s&&a<i.length;++a){let e=Ka(o);s=Wa(i[a],e,r)}return s}function Ua(e,t=[],n=[],r="",o=!1){let i=(e,i,s=o,a)=>{let l={relativePath:void 0===a?e.path||"":a,caseSensitive:!0===e.caseSensitive,childrenIndex:i,route:e};if(l.relativePath.startsWith("/")){if(!l.relativePath.startsWith(r)&&s)return;xa(l.relativePath.startsWith(r),`Absolute route path "${l.relativePath}" nested under path "${r}" is not valid. An absolute child route path must start with the combined path of all its parent routes.`),l.relativePath=l.relativePath.slice(r.length)}let c=el([r,l.relativePath]),u=n.concat(l);e.children&&e.children.length>0&&(xa(!0!==e.index,`Index routes must not have child routes. Please remove all child routes from route path "${c}".`),Ua(e.children,t,u,c,s)),(null!=e.path||e.index)&&t.push({path:c,score:Va(c,e.index),routesMeta:u})};return e.forEach((e,t)=>{if(""!==e.path&&e.path?.includes("?"))for(let n of Oa(e.path))i(e,t,!0,n);else i(e,t)}),t}function Oa(e){let t=e.split("/");if(0===t.length)return[];let[n,...r]=t,o=n.endsWith("?"),i=n.replace(/\?$/,"");if(0===r.length)return o?[i,""]:[i];let s=Oa(r.join("/")),a=[];return a.push(...s.map(e=>""===e?i:[i,e].join("/"))),o&&a.push(...s),a.map(t=>e.startsWith("/")&&""===t?"/":t)}var Da=/^:[\w-]+$/,Na=3,ja=2,Qa=1,za=10,Ha=-2,Ga=e=>"*"===e;function Va(e,t){let n=e.split("/"),r=n.length;return n.some(Ga)&&(r+=Ha),t&&(r+=ja),n.filter(e=>!Ga(e)).reduce((e,t)=>e+(Da.test(t)?Na:""===t?Qa:za),r)}function Wa(e,t,n=!1){let{routesMeta:r}=e,o={},i="/",s=[];for(let a=0;a<r.length;++a){let e=r[a],l=a===r.length-1,c="/"===i?t:t.slice(i.length)||"/",u=$a({path:e.relativePath,caseSensitive:e.caseSensitive,end:l},c),d=e.route;if(!u&&l&&n&&!r[r.length-1].route.index&&(u=$a({path:e.relativePath,caseSensitive:e.caseSensitive,end:!1},c)),!u)return null;Object.assign(o,u.params),s.push({params:o,pathname:el([i,u.pathname]),pathnameBase:tl(el([i,u.pathnameBase])),route:d}),"/"!==u.pathnameBase&&(i=el([i,u.pathnameBase]))}return s}function $a(e,t){"string"==typeof e&&(e={path:e,caseSensitive:!1,end:!0});let[n,r]=function(e,t=!1,n=!0){_a("*"===e||!e.endsWith("*")||e.endsWith("/*"),`Route path "${e}" will be treated as if it were "${e.replace(/\*$/,"/*")}" because the \`*\` character must always follow a \`/\` in the pattern. To get rid of this warning, please change the route path to "${e.replace(/\*$/,"/*")}".`);let r=[],o="^"+e.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(e,t,n)=>(r.push({paramName:t,isOptional:null!=n}),n?"/?([^\\/]+)?":"/([^\\/]+)")).replace(/\/([\w-]+)\?(\/|$)/g,"(/$1)?$2");e.endsWith("*")?(r.push({paramName:"*"}),o+="*"===e||"/*"===e?"(.*)$":"(?:\\/(.+)|\\/*)$"):n?o+="\\/*$":""!==e&&"/"!==e&&(o+="(?:(?=\\/|$))");let i=new RegExp(o,t?void 0:"i");return[i,r]}(e.path,e.caseSensitive,e.end),o=t.match(n);if(!o)return null;let i=o[0],s=i.replace(/(.)\/+$/,"$1"),a=o.slice(1);return{params:r.reduce((e,{paramName:t,isOptional:n},r)=>{if("*"===t){let e=a[r]||"";s=i.slice(0,i.length-e.length).replace(/(.)\/+$/,"$1")}const o=a[r];return e[t]=n&&!o?void 0:(o||"").replace(/%2F/g,"/"),e},{}),pathname:i,pathnameBase:s,pattern:e}}function Ka(e){try{return e.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(t){return _a(!1,`The URL path "${e}" could not be decoded because it is a malformed URL segment. This is probably due to a bad percent encoding (${t}).`),e}}function Xa(e,t){if("/"===t)return e;if(!e.toLowerCase().startsWith(t.toLowerCase()))return null;let n=t.endsWith("/")?t.length-1:t.length,r=e.charAt(n);return r&&"/"!==r?null:e.slice(n)||"/"}function Ya(e,t,n,r){return`Cannot include a '${e}' character in a manually specified \`to.${t}\` field [${JSON.stringify(r)}].  Please separate it out to the \`to.${n}\` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.`}function qa(e){return e.filter((e,t)=>0===t||e.route.path&&e.route.path.length>0)}function Ja(e){let t=qa(e);return t.map((e,n)=>n===t.length-1?e.pathname:e.pathnameBase)}function Za(e,t,n,r=!1){let o;"string"==typeof e?o=Ba(e):(o={...e},xa(!o.pathname||!o.pathname.includes("?"),Ya("?","pathname","search",o)),xa(!o.pathname||!o.pathname.includes("#"),Ya("#","pathname","hash",o)),xa(!o.search||!o.search.includes("#"),Ya("#","search","hash",o)));let i,s=""===e||""===o.pathname,a=s?"/":o.pathname;if(null==a)i=n;else{let e=t.length-1;if(!r&&a.startsWith("..")){let t=a.split("/");for(;".."===t[0];)t.shift(),e-=1;o.pathname=t.join("/")}i=e>=0?t[e]:"/"}let l=function(e,t="/"){let{pathname:n,search:r="",hash:o=""}="string"==typeof e?Ba(e):e,i=n?n.startsWith("/")?n:function(e,t){let n=t.replace(/\/+$/,"").split("/");return e.split("/").forEach(e=>{".."===e?n.length>1&&n.pop():"."!==e&&n.push(e)}),n.length>1?n.join("/"):"/"}(n,t):t;return{pathname:i,search:nl(r),hash:rl(o)}}(o,i),c=a&&"/"!==a&&a.endsWith("/"),u=(s||"."===a)&&n.endsWith("/");return l.pathname.endsWith("/")||!c&&!u||(l.pathname+="/"),l}var el=e=>e.join("/").replace(/\/\/+/g,"/"),tl=e=>e.replace(/\/+$/,"").replace(/^\/*/,"/"),nl=e=>e&&"?"!==e?e.startsWith("?")?e:"?"+e:"",rl=e=>e&&"#"!==e?e.startsWith("#")?e:"#"+e:"",ol=class{constructor(e,t,n,r=!1){this.status=e,this.statusText=t||"",this.internal=r,n instanceof Error?(this.data=n.toString(),this.error=n):this.data=n}};function il(e){return null!=e&&"number"==typeof e.status&&"string"==typeof e.statusText&&"boolean"==typeof e.internal&&"data"in e}var sl=["POST","PUT","PATCH","DELETE"],al=new Set(sl),ll=["GET",...sl],cl=new Set(ll),ul=new Set([301,302,303,307,308]),dl=new Set([307,308]),Al={state:"idle",location:void 0,formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0,json:void 0,text:void 0},hl={state:"idle",data:void 0,formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0,json:void 0,text:void 0},pl={state:"unblocked",proceed:void 0,reset:void 0,location:void 0},fl=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,gl=e=>fl.test(e),ml=e=>({hasErrorBoundary:Boolean(e.hasErrorBoundary)}),yl="remix-router-transitions",vl=Symbol("ResetLoaderData");function bl(e){const t=e.window?e.window:"undefined"!=typeof window?window:void 0,n=void 0!==t&&void 0!==t.document&&void 0!==t.document.createElement;xa(e.routes.length>0,"You must provide a non-empty routes array to createRouter");let r,o=e.hydrationRouteProperties||[],i=e.mapRouteProperties||ml,s={},a=Fa(e.routes,i,void 0,s),l=e.basename||"/";l.startsWith("/")||(l=`/${l}`);let c,u,d=e.dataStrategy||Pl,A={...e.future},h=null,p=new Set,f=null,g=null,m=null,y=null!=e.hydrationData,v=Ma(a,e.history.location,l),b=!1,w=null;if(null!=v||e.patchRoutesOnNavigation){if(v&&!e.hydrationData){de(v,a,e.history.location.pathname).active&&(v=null)}if(v)if(v.some(e=>e.route.lazy))c=!1;else if(v.some(e=>e.route.loader)){let t=e.hydrationData?e.hydrationData.loaderData:null,n=e.hydrationData?e.hydrationData.errors:null;if(n){let e=v.findIndex(e=>void 0!==n[e.route.id]);c=v.slice(0,e+1).every(e=>!Cl(e.route,t,n))}else c=v.every(e=>!Cl(e.route,t,n))}else c=!0;else{c=!1,v=[];let t=de(null,a,e.history.location.pathname);t.active&&t.matches&&(b=!0,v=t.matches)}}else{let t=Xl(404,{pathname:e.history.location.pathname}),{matches:n,route:r}=Kl(a);c=!0,v=n,w={[r.id]:t}}let x,_,C={historyAction:e.history.action,location:e.history.location,matches:v,initialized:c,navigation:Al,restoreScrollPosition:null==e.hydrationData&&null,preventScrollReset:!1,revalidation:"idle",loaderData:e.hydrationData&&e.hydrationData.loaderData||{},actionData:e.hydrationData&&e.hydrationData.actionData||null,errors:e.hydrationData&&e.hydrationData.errors||w,fetchers:new Map,blockers:new Map},S="POP",E=!1,B=!1,I=new Map,R=null,k=!1,T=!1,P=new Set,F=new Map,M=0,L=-1,U=new Map,O=new Set,D=new Map,N=new Map,j=new Set,Q=new Map,z=null;function H(e,t={}){e.matches&&(e.matches=e.matches.map(e=>{let t=s[e.route.id],n=e.route;return n.element!==t.element||n.errorElement!==t.errorElement||n.hydrateFallbackElement!==t.hydrateFallbackElement?{...e,route:t}:e})),C={...C,...e};let n=[],r=[];C.fetchers.forEach((e,t)=>{"idle"===e.state&&(j.has(t)?n.push(t):r.push(t))}),j.forEach(e=>{C.fetchers.has(e)||F.has(e)||n.push(e)}),[...p].forEach(e=>e(C,{deletedFetchers:n,viewTransitionOpts:t.viewTransitionOpts,flushSync:!0===t.flushSync})),n.forEach(e=>ee(e)),r.forEach(e=>C.fetchers.delete(e))}function G(t,n,{flushSync:o}={}){let i,s=null!=C.actionData&&null!=C.navigation.formMethod&&oc(C.navigation.formMethod)&&"loading"===C.navigation.state&&!0!==t.state?._isRedirect;i=n.actionData?Object.keys(n.actionData).length>0?n.actionData:null:s?C.actionData:null;let l=n.loaderData?Vl(C.loaderData,n.loaderData,n.matches||[],n.errors):C.loaderData,c=C.blockers;c.size>0&&(c=new Map(c),c.forEach((e,t)=>c.set(t,pl)));let u,d=!k&&ue(t,n.matches||C.matches),A=!0===E||null!=C.navigation.formMethod&&oc(C.navigation.formMethod)&&!0!==t.state?._isRedirect;if(r&&(a=r,r=void 0),k||"POP"===S||("PUSH"===S?e.history.push(t,t.state):"REPLACE"===S&&e.history.replace(t,t.state)),"POP"===S){let e=I.get(C.location.pathname);e&&e.has(t.pathname)?u={currentLocation:C.location,nextLocation:t}:I.has(t.pathname)&&(u={currentLocation:t,nextLocation:C.location})}else if(B){let e=I.get(C.location.pathname);e?e.add(t.pathname):(e=new Set([t.pathname]),I.set(C.location.pathname,e)),u={currentLocation:C.location,nextLocation:t}}H({...n,actionData:i,loaderData:l,historyAction:S,location:t,initialized:!0,navigation:Al,revalidation:"idle",restoreScrollPosition:d,preventScrollReset:A,blockers:c},{viewTransitionOpts:u,flushSync:!0===o}),S="POP",E=!1,B=!1,k=!1,T=!1,z?.resolve(),z=null}async function V(t,n,c){x&&x.abort(),x=null,S=t,k=!0===(c&&c.startUninterruptedRevalidation),function(e,t){if(f&&m){let n=ce(e,t);f[n]=m()}}(C.location,C.matches),E=!0===(c&&c.preventScrollReset),B=!0===(c&&c.enableViewTransition);let u=r||a,d=c&&c.overrideNavigation,A=c?.initialHydration&&C.matches&&C.matches.length>0&&!b?C.matches:Ma(u,n,l),h=!0===(c&&c.flushSync);if(A&&C.initialized&&!T&&function(e,t){if(e.pathname!==t.pathname||e.search!==t.search)return!1;if(""===e.hash)return""!==t.hash;if(e.hash===t.hash)return!0;if(""!==t.hash)return!0;return!1}(C.location,n)&&!(c&&c.submission&&oc(c.submission.formMethod)))return void G(n,{matches:A},{flushSync:h});let p=de(A,u,n.pathname);if(p.active&&p.matches&&(A=p.matches),!A){let{error:e,notFoundMatches:t,route:r}=le(n.pathname);return void G(n,{matches:t,loaderData:{},errors:{[r.id]:e}},{flushSync:h})}x=new AbortController;let g,y=Ql(e.history,n,x.signal,c&&c.submission),v=e.getContext?await e.getContext():new Ra;if(c&&c.pendingError)g=[$l(A).route.id,{type:"error",error:c.pendingError}];else if(c&&c.submission&&oc(c.submission.formMethod)){let t=await async function(e,t,n,r,c,u,d,A={}){Y();let h,p=function(e,t){let n={state:"submitting",location:e,formMethod:t.formMethod,formAction:t.formAction,formEncType:t.formEncType,formData:t.formData,json:t.json,text:t.text};return n}(t,n);if(H({navigation:p},{flushSync:!0===A.flushSync}),u){let n=await Ae(r,t.pathname,e.signal);if("aborted"===n.type)return{shortCircuited:!0};if("error"===n.type){if(0===n.partialMatches.length){let{matches:e,route:t}=Kl(a);return{matches:e,pendingActionResult:[t.id,{type:"error",error:n.error}]}}let e=$l(n.partialMatches).route.id;return{matches:n.partialMatches,pendingActionResult:[e,{type:"error",error:n.error}]}}if(!n.matches){let{notFoundMatches:e,error:n,route:r}=le(t.pathname);return{matches:e,pendingActionResult:[r.id,{type:"error",error:n}]}}r=n.matches}let f=sc(r,t);if(f.route.action||f.route.lazy){let t=Ol(i,s,e,r,f,d?[]:o,c),n=await K(e,t,c,null);if(h=n[f.route.id],!h)for(let e of r)if(n[e.route.id]){h=n[e.route.id];break}if(e.signal.aborted)return{shortCircuited:!0}}else h={type:"error",error:Xl(405,{method:e.method,pathname:t.pathname,routeId:f.route.id})};if(tc(h)){let t;if(A&&null!=A.replace)t=A.replace;else{t=jl(h.response.headers.get("Location"),new URL(e.url),l)===C.location.pathname+C.location.search}return await $(e,h,!0,{submission:n,replace:t}),{shortCircuited:!0}}if(ec(h)){let e=$l(r,f.route.id);return!0!==(A&&A.replace)&&(S="PUSH"),{matches:r,pendingActionResult:[e.route.id,h,f.route.id]}}return{matches:r,pendingActionResult:[f.route.id,h]}}(y,n,c.submission,A,v,p.active,c&&!0===c.initialHydration,{replace:c.replace,flushSync:h});if(t.shortCircuited)return;if(t.pendingActionResult){let[e,r]=t.pendingActionResult;if(ec(r)&&il(r.error)&&404===r.error.status)return x=null,void G(n,{matches:t.matches,loaderData:{},errors:{[e]:r.error}})}A=t.matches||A,g=t.pendingActionResult,d=lc(n,c.submission),h=!1,p.active=!1,y=Ql(e.history,y.url,y.signal)}let{shortCircuited:w,matches:_,loaderData:I,errors:R}=await async function(t,n,c,u,d,A,h,p,f,g,m,y){let v=A||lc(n,h),b=h||p||ac(v),w=!k&&!g;if(d){if(w){let e=W(y);H({navigation:v,...void 0!==e?{actionData:e}:{}},{flushSync:m})}let e=await Ae(c,n.pathname,t.signal);if("aborted"===e.type)return{shortCircuited:!0};if("error"===e.type){if(0===e.partialMatches.length){let{matches:t,route:n}=Kl(a);return{matches:t,loaderData:{},errors:{[n.id]:e.error}}}let t=$l(e.partialMatches).route.id;return{matches:e.partialMatches,loaderData:{},errors:{[t]:e.error}}}if(!e.matches){let{error:e,notFoundMatches:t,route:r}=le(n.pathname);return{matches:t,loaderData:{},errors:{[r.id]:e}}}c=e.matches}let _=r||a,{dsMatches:S,revalidatingFetchers:E}=_l(t,u,i,s,e.history,C,c,b,n,g?[]:o,!0===g,T,P,j,D,O,_,l,null!=e.patchRoutesOnNavigation,y);if(L=++M,!e.dataStrategy&&!S.some(e=>e.shouldLoad)&&!S.some(e=>e.route.middleware)&&0===E.length){let e=re();return G(n,{matches:c,loaderData:{},errors:y&&ec(y[1])?{[y[0]]:y[1].error}:null,...Wl(y),...e?{fetchers:new Map(C.fetchers)}:{}},{flushSync:m}),{shortCircuited:!0}}if(w){let e={};if(!d){e.navigation=v;let t=W(y);void 0!==t&&(e.actionData=t)}E.length>0&&(e.fetchers=function(e){return e.forEach(e=>{let t=C.fetchers.get(e.key),n=cc(void 0,t?t.data:void 0);C.fetchers.set(e.key,n)}),new Map(C.fetchers)}(E)),H(e,{flushSync:m})}E.forEach(e=>{te(e.key),e.controller&&F.set(e.key,e.controller)});let B=()=>E.forEach(e=>te(e.key));x&&x.signal.addEventListener("abort",B);let{loaderResults:I,fetcherResults:R}=await X(S,E,t,u);if(t.signal.aborted)return{shortCircuited:!0};x&&x.signal.removeEventListener("abort",B);E.forEach(e=>F.delete(e.key));let U=Yl(I);if(U)return await $(t,U.result,!0,{replace:f}),{shortCircuited:!0};if(U=Yl(R),U)return O.add(U.key),await $(t,U.result,!0,{replace:f}),{shortCircuited:!0};let{loaderData:N,errors:Q}=Gl(C,c,I,y,E,R);g&&C.errors&&(Q={...C.errors,...Q});let z=re(),V=oe(L),K=z||V||E.length>0;return{matches:c,loaderData:N,errors:Q,...K?{fetchers:new Map(C.fetchers)}:{}}}(y,n,A,v,p.active,d,c&&c.submission,c&&c.fetcherSubmission,c&&c.replace,c&&!0===c.initialHydration,h,g);w||(x=null,G(n,{matches:_||A,...Wl(g),loaderData:I,errors:R}))}function W(e){return e&&!ec(e[1])?{[e[0]]:e[1].data}:C.actionData?0===Object.keys(C.actionData).length?null:C.actionData:void 0}async function $(e,r,o,{submission:i,fetcherSubmission:s,preventScrollReset:a,replace:c}={}){r.response.headers.has("X-Remix-Revalidate")&&(T=!0);let u=r.response.headers.get("Location");xa(u,"Expected a Location header on the redirect Response"),u=jl(u,new URL(e.url),l);let d=Sa(C.location,u,{_isRedirect:!0});if(n){let e=!1;if(r.response.headers.has("X-Remix-Reload-Document"))e=!0;else if(gl(u)){const n=Ia(u,!0);e=n.origin!==t.location.origin||null==Xa(n.pathname,l)}if(e)return void(c?t.location.replace(u):t.location.assign(u))}x=null;let A=!0===c||r.response.headers.has("X-Remix-Replace")?"REPLACE":"PUSH",{formMethod:h,formAction:p,formEncType:f}=C.navigation;!i&&!s&&h&&p&&f&&(i=ac(C.navigation));let g=i||s;if(dl.has(r.response.status)&&g&&oc(g.formMethod))await V(A,d,{submission:{...g,formAction:u},preventScrollReset:a||E,enableViewTransition:o?B:void 0});else{let e=lc(d,i);await V(A,d,{overrideNavigation:e,fetcherSubmission:s,preventScrollReset:a||E,enableViewTransition:o?B:void 0})}}async function K(e,t,n,r){let o,i={};try{o=await async function(e,t,n,r,o){n.some(e=>e._lazyPromises?.middleware)&&await Promise.all(n.map(e=>e._lazyPromises?.middleware));let i={request:t,params:n[0].params,context:o,matches:n},s=e=>{let t=i;return Fl(t,()=>e({...t,fetcherKey:r,runClientMiddleware:()=>{throw new Error("Cannot call `runClientMiddleware()` from within an `runClientMiddleware` handler")}}))},a=await e({...i,fetcherKey:r,runClientMiddleware:s});try{await Promise.all(n.flatMap(e=>[e._lazyPromises?.handler,e._lazyPromises?.route]))}catch(l){}return a}(d,e,t,r,n)}catch(s){return t.filter(e=>e.shouldLoad).forEach(e=>{i[e.route.id]={type:"error",error:s}}),i}if(e.signal.aborted)return i;for(let[a,c]of Object.entries(o))if(Zl(c)){let n=c.result;i[a]={type:"redirect",response:Nl(n,e,a,t,l)}}else i[a]=await Dl(c);return i}async function X(e,t,n,r){let o=K(n,e,r,null),i=Promise.all(t.map(async e=>{if(e.matches&&e.match&&e.request&&e.controller){let t=(await K(e.request,e.matches,r,e.key))[e.match.route.id];return{[e.key]:t}}return Promise.resolve({[e.key]:{type:"error",error:Xl(404,{pathname:e.path})}})}));return{loaderResults:await o,fetcherResults:(await i).reduce((e,t)=>Object.assign(e,t),{})}}function Y(){T=!0,D.forEach((e,t)=>{F.has(t)&&P.add(t),te(t)})}function q(e,t,n={}){C.fetchers.set(e,t),H({fetchers:new Map(C.fetchers)},{flushSync:!0===(n&&n.flushSync)})}function J(e,t,n,r={}){let o=$l(C.matches,t);ee(e),H({errors:{[o.route.id]:n},fetchers:new Map(C.fetchers)},{flushSync:!0===(r&&r.flushSync)})}function Z(e){return N.set(e,(N.get(e)||0)+1),j.has(e)&&j.delete(e),C.fetchers.get(e)||hl}function ee(e){let t=C.fetchers.get(e);!F.has(e)||t&&"loading"===t.state&&U.has(e)||te(e),D.delete(e),U.delete(e),O.delete(e),j.delete(e),P.delete(e),C.fetchers.delete(e)}function te(e){let t=F.get(e);t&&(t.abort(),F.delete(e))}function ne(e){for(let t of e){let e=uc(Z(t).data);C.fetchers.set(t,e)}}function re(){let e=[],t=!1;for(let n of O){let r=C.fetchers.get(n);xa(r,`Expected fetcher: ${n}`),"loading"===r.state&&(O.delete(n),e.push(n),t=!0)}return ne(e),t}function oe(e){let t=[];for(let[n,r]of U)if(r<e){let e=C.fetchers.get(n);xa(e,`Expected fetcher: ${n}`),"loading"===e.state&&(te(n),U.delete(n),t.push(n))}return ne(t),t.length>0}function ie(e){C.blockers.delete(e),Q.delete(e)}function se(e,t){let n=C.blockers.get(e)||pl;xa("unblocked"===n.state&&"blocked"===t.state||"blocked"===n.state&&"blocked"===t.state||"blocked"===n.state&&"proceeding"===t.state||"blocked"===n.state&&"unblocked"===t.state||"proceeding"===n.state&&"unblocked"===t.state,`Invalid blocker state transition: ${n.state} -> ${t.state}`);let r=new Map(C.blockers);r.set(e,t),H({blockers:r})}function ae({currentLocation:e,nextLocation:t,historyAction:n}){if(0===Q.size)return;Q.size>1&&_a(!1,"A router only supports one blocker at a time");let r=Array.from(Q.entries()),[o,i]=r[r.length-1],s=C.blockers.get(o);return s&&"proceeding"===s.state?void 0:i({currentLocation:e,nextLocation:t,historyAction:n})?o:void 0}function le(e){let t=Xl(404,{pathname:e}),n=r||a,{matches:o,route:i}=Kl(n);return{notFoundMatches:o,route:i,error:t}}function ce(e,t){if(g){return g(e,t.map(e=>function(e,t){let{route:n,pathname:r,params:o}=e;return{id:n.id,pathname:r,params:o,data:t[n.id],loaderData:t[n.id],handle:n.handle}}(e,C.loaderData)))||e.key}return e.key}function ue(e,t){if(f){let n=ce(e,t),r=f[n];if("number"==typeof r)return r}return null}function de(t,n,r){if(e.patchRoutesOnNavigation){if(!t){return{active:!0,matches:La(n,r,l,!0)||[]}}if(Object.keys(t[0].params).length>0){return{active:!0,matches:La(n,r,l,!0)}}}return{active:!1,matches:null}}async function Ae(t,n,o,c){if(!e.patchRoutesOnNavigation)return{type:"success",matches:t};let u=t;for(;;){let t=null==r,A=r||a,h=s;try{await e.patchRoutesOnNavigation({signal:o,path:n,matches:u,fetcherKey:c,patch:(e,t)=>{o.aborted||El(e,t,A,h,i,!1)}})}catch(d){return{type:"error",error:d,partialMatches:u}}finally{t&&!o.aborted&&(a=[...a])}if(o.aborted)return{type:"aborted"};let p=Ma(A,n,l);if(p)return{type:"success",matches:p};let f=La(A,n,l,!0);if(!f||u.length===f.length&&u.every((e,t)=>e.route.id===f[t].route.id))return{type:"success",matches:null};u=f}}return u={get basename(){return l},get future(){return A},get state(){return C},get routes(){return a},get window(){return t},initialize:function(){if(h=e.history.listen(({action:t,location:n,delta:r})=>{if(_)return _(),void(_=void 0);_a(0===Q.size||null!=r,"You are trying to use a blocker on a POP navigation to a location that was not created by @remix-run/router. This will fail silently in production. This can happen if you are navigating outside the router via `window.history.pushState`/`window.location.hash` instead of using router navigation APIs.  This can also happen if you are using createHashRouter and the user manually changes the URL.");let o=ae({currentLocation:C.location,nextLocation:n,historyAction:t});if(o&&null!=r){let t=new Promise(e=>{_=e});return e.history.go(-1*r),void se(o,{state:"blocked",location:n,proceed(){se(o,{state:"proceeding",proceed:void 0,reset:void 0,location:n}),t.then(()=>e.history.go(r))},reset(){let e=new Map(C.blockers);e.set(o,pl),H({blockers:e})}})}return V(t,n)}),n){!function(e,t){try{let n=e.sessionStorage.getItem(yl);if(n){let e=JSON.parse(n);for(let[n,r]of Object.entries(e||{}))r&&Array.isArray(r)&&t.set(n,new Set(r||[]))}}catch(n){}}(t,I);let e=()=>function(e,t){if(t.size>0){let r={};for(let[e,n]of t)r[e]=[...n];try{e.sessionStorage.setItem(yl,JSON.stringify(r))}catch(n){_a(!1,`Failed to save applied view transitions in sessionStorage (${n}).`)}}}(t,I);t.addEventListener("pagehide",e),R=()=>t.removeEventListener("pagehide",e)}return C.initialized||V("POP",C.location,{initialHydration:!0}),u},subscribe:function(e){return p.add(e),()=>p.delete(e)},enableScrollRestoration:function(e,t,n){if(f=e,m=t,g=n||null,!y&&C.navigation===Al){y=!0;let e=ue(C.location,C.matches);null!=e&&H({restoreScrollPosition:e})}return()=>{f=null,m=null,g=null}},navigate:async function t(n,r){if("number"==typeof n)return void e.history.go(n);let o=wl(C.location,C.matches,l,n,r?.fromRouteId,r?.relative),{path:i,submission:s,error:a}=xl(!1,o,r),c=C.location,u=Sa(C.location,i,r&&r.state);u={...u,...e.history.encodeLocation(u)};let d=r&&null!=r.replace?r.replace:void 0,A="PUSH";!0===d?A="REPLACE":!1===d||null!=s&&oc(s.formMethod)&&s.formAction===C.location.pathname+C.location.search&&(A="REPLACE");let h=r&&"preventScrollReset"in r?!0===r.preventScrollReset:void 0,p=!0===(r&&r.flushSync),f=ae({currentLocation:c,nextLocation:u,historyAction:A});f?se(f,{state:"blocked",location:u,proceed(){se(f,{state:"proceeding",proceed:void 0,reset:void 0,location:u}),t(n,r)},reset(){let e=new Map(C.blockers);e.set(f,pl),H({blockers:e})}}):await V(A,u,{submission:s,pendingError:a,preventScrollReset:h,replace:r&&r.replace,enableViewTransition:r&&r.viewTransition,flushSync:p})},fetch:async function(t,n,c,u){te(t);let d=!0===(u&&u.flushSync),A=r||a,h=wl(C.location,C.matches,l,c,n,u?.relative),p=Ma(A,h,l),f=de(p,A,h);if(f.active&&f.matches&&(p=f.matches),!p)return void J(t,n,Xl(404,{pathname:h}),{flushSync:d});let{path:g,submission:m,error:y}=xl(!0,h,u);if(y)return void J(t,n,y,{flushSync:d});let v=e.getContext?await e.getContext():new Ra,b=!0===(u&&u.preventScrollReset);m&&oc(m.formMethod)?await async function(t,n,c,u,d,A,h,p,f){Y(),D.delete(t);let g=C.fetchers.get(t);q(t,function(e,t){let n={state:"submitting",formMethod:e.formMethod,formAction:e.formAction,formEncType:e.formEncType,formData:e.formData,json:e.json,text:e.text,data:t?t.data:void 0};return n}(f,g),{flushSync:h});let m=new AbortController,y=Ql(e.history,c,m.signal,f);if(A){let e=await Ae(u,new URL(y.url).pathname,y.signal,t);if("aborted"===e.type)return;if("error"===e.type)return void J(t,n,e.error,{flushSync:h});if(!e.matches)return void J(t,n,Xl(404,{pathname:c}),{flushSync:h});u=e.matches}let v=sc(u,c);if(!v.route.action&&!v.route.lazy){let e=Xl(405,{method:f.formMethod,pathname:c,routeId:n});return void J(t,n,e,{flushSync:h})}F.set(t,m);let b=M,w=Ol(i,s,y,u,v,o,d),_=await K(y,w,d,t),E=_[v.route.id];if(y.signal.aborted)return void(F.get(t)===m&&F.delete(t));if(j.has(t)){if(tc(E)||ec(E))return void q(t,uc(void 0))}else{if(tc(E))return F.delete(t),L>b?void q(t,uc(void 0)):(O.add(t),q(t,cc(f)),$(y,E,!1,{fetcherSubmission:f,preventScrollReset:p}));if(ec(E))return void J(t,n,E.error)}let B=C.navigation.location||C.location,I=Ql(e.history,B,m.signal),R=r||a,k="idle"!==C.navigation.state?Ma(R,C.navigation.location,l):C.matches;xa(k,"Didn't find any matches after fetcher action");let N=++M;U.set(t,N);let Q=cc(f,E.data);C.fetchers.set(t,Q);let{dsMatches:z,revalidatingFetchers:V}=_l(I,d,i,s,e.history,C,k,f,B,o,!1,T,P,j,D,O,R,l,null!=e.patchRoutesOnNavigation,[v.route.id,E]);V.filter(e=>e.key!==t).forEach(e=>{let t=e.key,n=C.fetchers.get(t),r=cc(void 0,n?n.data:void 0);C.fetchers.set(t,r),te(t),e.controller&&F.set(t,e.controller)}),H({fetchers:new Map(C.fetchers)});let W=()=>V.forEach(e=>te(e.key));m.signal.addEventListener("abort",W);let{loaderResults:Z,fetcherResults:ee}=await X(z,V,I,d);if(m.signal.aborted)return;if(m.signal.removeEventListener("abort",W),U.delete(t),F.delete(t),V.forEach(e=>F.delete(e.key)),C.fetchers.has(t)){let e=uc(E.data);C.fetchers.set(t,e)}let ne=Yl(Z);if(ne)return $(I,ne.result,!1,{preventScrollReset:p});if(ne=Yl(ee),ne)return O.add(ne.key),$(I,ne.result,!1,{preventScrollReset:p});let{loaderData:re,errors:ie}=Gl(C,k,Z,void 0,V,ee);oe(N),"loading"===C.navigation.state&&N>L?(xa(S,"Expected pending action"),x&&x.abort(),G(C.navigation.location,{matches:k,loaderData:re,errors:ie,fetchers:new Map(C.fetchers)})):(H({errors:ie,loaderData:Vl(C.loaderData,re,k,ie),fetchers:new Map(C.fetchers)}),T=!1)}(t,n,g,p,v,f.active,d,b,m):(D.set(t,{routeId:n,path:g}),await async function(t,n,r,a,l,c,u,d,A){let h=C.fetchers.get(t);q(t,cc(A,h?h.data:void 0),{flushSync:u});let p=new AbortController,f=Ql(e.history,r,p.signal);if(c){let e=await Ae(a,new URL(f.url).pathname,f.signal,t);if("aborted"===e.type)return;if("error"===e.type)return void J(t,n,e.error,{flushSync:u});if(!e.matches)return void J(t,n,Xl(404,{pathname:r}),{flushSync:u});a=e.matches}let g=sc(a,r);F.set(t,p);let m=M,y=Ol(i,s,f,a,g,o,l),v=await K(f,y,l,t),b=v[g.route.id];F.get(t)===p&&F.delete(t);if(f.signal.aborted)return;if(j.has(t))return void q(t,uc(void 0));if(tc(b))return L>m?void q(t,uc(void 0)):(O.add(t),void(await $(f,b,!1,{preventScrollReset:d})));if(ec(b))return void J(t,n,b.error);q(t,uc(b.data))}(t,n,g,p,v,f.active,d,b,m))},revalidate:function(){z||(z=function(){let e,t,n=new Promise((r,o)=>{e=async e=>{r(e);try{await n}catch(t){}},t=async e=>{o(e);try{await n}catch(t){}}});return{promise:n,resolve:e,reject:t}}()),Y(),H({revalidation:"loading"});let e=z.promise;return"submitting"===C.navigation.state?e:"idle"===C.navigation.state?(V(C.historyAction,C.location,{startUninterruptedRevalidation:!0}),e):(V(S||C.historyAction,C.navigation.location,{overrideNavigation:C.navigation,enableViewTransition:!0===B}),e)},createHref:t=>e.history.createHref(t),encodeLocation:t=>e.history.encodeLocation(t),getFetcher:Z,deleteFetcher:function(e){let t=(N.get(e)||0)-1;t<=0?(N.delete(e),j.add(e)):N.set(e,t),H({fetchers:new Map(C.fetchers)})},dispose:function(){h&&h(),R&&R(),p.clear(),x&&x.abort(),C.fetchers.forEach((e,t)=>ee(t)),C.blockers.forEach((e,t)=>ie(t))},getBlocker:function(e,t){let n=C.blockers.get(e)||pl;return Q.get(e)!==t&&Q.set(e,t),n},deleteBlocker:ie,patchRoutes:function(e,t,n=!1){let o=null==r;El(e,t,r||a,s,i,n),o&&(a=[...a],H({}))},_internalFetchControllers:F,_internalSetRoutes:function(e){s={},r=Fa(e,i,void 0,s)},_internalSetStateDoNotUseOrYouWillBreakYourApp(e){H(e)}},u}function wl(e,t,n,r,o,i){let s,a;if(o){s=[];for(let e of t)if(s.push(e),e.route.id===o){a=e;break}}else s=t,a=t[t.length-1];let l=Za(r||".",Ja(s),Xa(e.pathname,n)||e.pathname,"path"===i);if(null==r&&(l.search=e.search,l.hash=e.hash),(null==r||""===r||"."===r)&&a){let e=ic(l.search);if(a.route.index&&!e)l.search=l.search?l.search.replace(/^\?/,"?index&"):"?index";else if(!a.route.index&&e){let e=new URLSearchParams(l.search),t=e.getAll("index");e.delete("index"),t.filter(e=>e).forEach(t=>e.append("index",t));let n=e.toString();l.search=n?`?${n}`:""}}return"/"!==n&&(l.pathname=function({basename:e,pathname:t}){return"/"===t?e:el([e,t])}({basename:n,pathname:l.pathname})),Ea(l)}function xl(e,t,n){if(!n||!function(e){return null!=e&&("formData"in e&&null!=e.formData||"body"in e&&void 0!==e.body)}(n))return{path:t};if(n.formMethod&&(r=n.formMethod,!cl.has(r.toUpperCase())))return{path:t,error:Xl(405,{method:n.formMethod})};var r;let o,i,s=()=>({path:t,error:Xl(400,{type:"invalid-body"})}),a=(n.formMethod||"get").toUpperCase(),l=ql(t);if(void 0!==n.body){if("text/plain"===n.formEncType){if(!oc(a))return s();let e="string"==typeof n.body?n.body:n.body instanceof FormData||n.body instanceof URLSearchParams?Array.from(n.body.entries()).reduce((e,[t,n])=>`${e}${t}=${n}\n`,""):String(n.body);return{path:t,submission:{formMethod:a,formAction:l,formEncType:n.formEncType,formData:void 0,json:void 0,text:e}}}if("application/json"===n.formEncType){if(!oc(a))return s();try{let e="string"==typeof n.body?JSON.parse(n.body):n.body;return{path:t,submission:{formMethod:a,formAction:l,formEncType:n.formEncType,formData:void 0,json:e,text:void 0}}}catch(d){return s()}}}if(xa("function"==typeof FormData,"FormData is not available in this environment"),n.formData)o=zl(n.formData),i=n.formData;else if(n.body instanceof FormData)o=zl(n.body),i=n.body;else if(n.body instanceof URLSearchParams)o=n.body,i=Hl(o);else if(null==n.body)o=new URLSearchParams,i=new FormData;else try{o=new URLSearchParams(n.body),i=Hl(o)}catch(d){return s()}let c={formMethod:a,formAction:l,formEncType:n&&n.formEncType||"application/x-www-form-urlencoded",formData:i,json:void 0,text:void 0};if(oc(c.formMethod))return{path:t,submission:c};let u=Ba(t);return e&&u.search&&ic(u.search)&&o.append("index",""),u.search=`?${o}`,{path:Ea(u),submission:c}}function _l(e,t,n,r,o,i,s,a,l,c,u,d,A,h,p,f,g,m,y,v){let b,w=v?ec(v[1])?v[1].error:v[1].data:void 0,x=o.createURL(i.location),_=o.createURL(l);if(u&&i.errors){let e=Object.keys(i.errors)[0];b=s.findIndex(t=>t.route.id===e)}else if(v&&ec(v[1])){let e=v[0];b=s.findIndex(t=>t.route.id===e)-1}let C=v?v[1].statusCode:void 0,S=C&&C>=400,E={currentUrl:x,currentParams:i.matches[0]?.params||{},nextUrl:_,nextParams:s[0].params,...a,actionResult:w,actionStatus:C},B=s.map((o,s)=>{let{route:a}=o,l=null;if(null!=b&&s>b?l=!1:a.lazy?l=!0:null==a.loader?l=!1:u?l=Cl(a,i.loaderData,i.errors):function(e,t,n){let r=!t||n.route.id!==t.route.id,o=!e.hasOwnProperty(n.route.id);return r||o}(i.loaderData,i.matches[s],o)&&(l=!0),null!==l)return Ul(n,r,e,o,c,t,l);let A=!S&&(d||x.pathname+x.search===_.pathname+_.search||x.search!==_.search||function(e,t){let n=e.route.path;return e.pathname!==t.pathname||null!=n&&n.endsWith("*")&&e.params["*"]!==t.params["*"]}(i.matches[s],o)),h={...E,defaultShouldRevalidate:A},p=Sl(o,h);return Ul(n,r,e,o,c,t,p,h)}),I=[];return p.forEach((e,a)=>{if(u||!s.some(t=>t.route.id===e.routeId)||h.has(a))return;let l=i.fetchers.get(a),p=l&&"idle"!==l.state&&void 0===l.data,v=Ma(g,e.path,m);if(!v){if(y&&p)return;return void I.push({key:a,routeId:e.routeId,path:e.path,matches:null,match:null,request:null,controller:null})}if(f.has(a))return;let b=sc(v,e.path),w=new AbortController,x=Ql(o,e.path,w.signal),_=null;if(A.has(a))A.delete(a),_=Ol(n,r,x,v,b,c,t);else if(p)d&&(_=Ol(n,r,x,v,b,c,t));else{let e={...E,defaultShouldRevalidate:!S&&d};Sl(b,e)&&(_=Ol(n,r,x,v,b,c,t,e))}_&&I.push({key:a,routeId:e.routeId,path:e.path,matches:_,match:b,request:x,controller:w})}),{dsMatches:B,revalidatingFetchers:I}}function Cl(e,t,n){if(e.lazy)return!0;if(!e.loader)return!1;let r=null!=t&&e.id in t,o=null!=n&&void 0!==n[e.id];return!(!r&&o)&&("function"==typeof e.loader&&!0===e.loader.hydrate||!r&&!o)}function Sl(e,t){if(e.route.shouldRevalidate){let n=e.route.shouldRevalidate(t);if("boolean"==typeof n)return n}return t.defaultShouldRevalidate}function El(e,t,n,r,o,i){let s;if(e){let t=r[e];xa(t,`No route found to patch children into: routeId = ${e}`),t.children||(t.children=[]),s=t.children}else s=n;let a=[],l=[];if(t.forEach(e=>{let t=s.find(t=>Bl(e,t));t?l.push({existingRoute:t,newRoute:e}):a.push(e)}),a.length>0){let t=Fa(a,o,[e||"_","patch",String(s?.length||"0")],r);s.push(...t)}if(i&&l.length>0)for(let c=0;c<l.length;c++){let{existingRoute:e,newRoute:t}=l[c],n=e,[r]=Fa([t],o,[],{},!0);Object.assign(n,{element:r.element?r.element:n.element,errorElement:r.errorElement?r.errorElement:n.errorElement,hydrateFallbackElement:r.hydrateFallbackElement?r.hydrateFallbackElement:n.hydrateFallbackElement})}}function Bl(e,t){return"id"in e&&"id"in t&&e.id===t.id||e.index===t.index&&e.path===t.path&&e.caseSensitive===t.caseSensitive&&(!(e.children&&0!==e.children.length||t.children&&0!==t.children.length)||e.children.every((e,n)=>t.children?.some(t=>Bl(e,t))))}var Il=new WeakMap,Rl=({key:e,route:t,manifest:n,mapRouteProperties:r})=>{let o=n[t.id];if(xa(o,"No route found in manifest"),!o.lazy||"object"!=typeof o.lazy)return;let i=o.lazy[e];if(!i)return;let s=Il.get(o);s||(s={},Il.set(o,s));let a=s[e];if(a)return a;let l=(async()=>{let t=function(e){return ka.has(e)}(e),n=void 0!==o[e]&&"hasErrorBoundary"!==e;if(t)_a(!t,"Route property "+e+" is not a supported lazy route property. This property will be ignored."),s[e]=Promise.resolve();else if(n)_a(!1,`Route "${o.id}" has a static property "${e}" defined. The lazy property will be ignored.`);else{let t=await i();null!=t&&(Object.assign(o,{[e]:t}),Object.assign(o,r(o)))}"object"==typeof o.lazy&&(o.lazy[e]=void 0,Object.values(o.lazy).every(e=>void 0===e)&&(o.lazy=void 0))})();return s[e]=l,l},kl=new WeakMap;async function Tl(e){let t=e.matches.filter(e=>e.shouldLoad),n={};return(await Promise.all(t.map(e=>e.resolve()))).forEach((e,r)=>{n[t[r].route.id]=e}),n}async function Pl(e){return e.matches.some(e=>e.route.middleware)?Fl(e,()=>Tl(e)):Tl(e)}function Fl(e,t){return async function(e,t,n,r,o){let{matches:i,request:s,params:a,context:l}=e,c=i.flatMap(e=>e.route.middleware?e.route.middleware.map(t=>[e.route.id,t]):[]),u=await Ml({request:s,params:a,context:l},c,t,n,r,o);return u}(e,t,e=>e,Jl,function(t,n,r){if(r)return Promise.resolve(Object.assign(r.value,{[n]:{type:"error",result:t}}));{let{matches:r}=e,o=Math.min(r.findIndex(e=>e.route.id===n)||0,r.findIndex(e=>e.unstable_shouldCallHandler())||0),i=$l(r,r[o].route.id).route.id;return Promise.resolve({[i]:{type:"error",result:t}})}})}async function Ml(e,t,n,r,o,i,s=0){let{request:a}=e;if(a.signal.aborted)throw a.signal.reason??new Error(`Request aborted: ${a.method} ${a.url}`);let l=t[s];if(!l){return await n()}let c,[u,d]=l,A=async()=>{if(c)throw new Error("You may only call `next()` once per middleware");try{let a=await Ml(e,t,n,r,o,i,s+1);return c={value:a},c.value}catch(a){return c={value:await i(a,u,c)},c.value}};try{let t=await d(e,A),n=null!=t?r(t):void 0;return o(n)?n:c?n??c.value:(c={value:await A()},c.value)}catch(h){return await i(h,u,c)}}function Ll(e,t,n,r,o){let i=Rl({key:"middleware",route:r.route,manifest:t,mapRouteProperties:e}),s=function(e,t,n,r,o){let i=n[e.id];if(xa(i,"No route found in manifest"),!e.lazy)return{lazyRoutePromise:void 0,lazyHandlerPromise:void 0};if("function"==typeof e.lazy){let t=kl.get(i);if(t)return{lazyRoutePromise:t,lazyHandlerPromise:t};let n=(async()=>{xa("function"==typeof e.lazy,"No lazy route function found");let t=await e.lazy(),n={};for(let e in t){let r=t[e];if(void 0===r)continue;let o=Pa(e),s=void 0!==i[e]&&"hasErrorBoundary"!==e;o?_a(!o,"Route property "+e+" is not a supported property to be returned from a lazy route function. This property will be ignored."):s?_a(!s,`Route "${i.id}" has a static property "${e}" defined but its lazy function is also returning a value for this property. The lazy route property "${e}" will be ignored.`):n[e]=r}Object.assign(i,n),Object.assign(i,{...r(i),lazy:void 0})})();return kl.set(i,n),n.catch(()=>{}),{lazyRoutePromise:n,lazyHandlerPromise:n}}let s,a=Object.keys(e.lazy),l=[];for(let u of a){if(o&&o.includes(u))continue;let i=Rl({key:u,route:e,manifest:n,mapRouteProperties:r});i&&(l.push(i),u===t&&(s=i))}let c=l.length>0?Promise.all(l).then(()=>{}):void 0;return c?.catch(()=>{}),s?.catch(()=>{}),{lazyRoutePromise:c,lazyHandlerPromise:s}}(r.route,oc(n.method)?"action":"loader",t,e,o);return{middleware:i,route:s.lazyRoutePromise,handler:s.lazyHandlerPromise}}function Ul(e,t,n,r,o,i,s,a=null){let l=!1,c=Ll(e,t,n,r,o);return{...r,_lazyPromises:c,shouldLoad:s,unstable_shouldRevalidateArgs:a,unstable_shouldCallHandler:e=>(l=!0,a?Sl(r,"boolean"==typeof e?{...a,defaultShouldRevalidate:e}:a):s),resolve:e=>l||s||e&&!oc(n.method)&&(r.route.lazy||r.route.loader)?async function({request:e,match:t,lazyHandlerPromise:n,lazyRoutePromise:r,handlerOverride:o,scopedContext:i}){let s,a,l=oc(e.method),c=l?"action":"loader",u=n=>{let r,s=new Promise((e,t)=>r=t);a=()=>r(),e.signal.addEventListener("abort",a);let l=r=>"function"!=typeof n?Promise.reject(new Error(`You cannot call the handler for a route which defines a boolean "${c}" [routeId: ${t.route.id}]`)):n({request:e,params:t.params,context:i},...void 0!==r?[r]:[]),u=(async()=>{try{return{type:"data",result:await(o?o(e=>l(e)):l())}}catch(e){return{type:"error",result:e}}})();return Promise.race([u,s])};try{let o=l?t.route.action:t.route.loader;if(n||r)if(o){let e,[t]=await Promise.all([u(o).catch(t=>{e=t}),n,r]);if(void 0!==e)throw e;s=t}else{await n;let o=l?t.route.action:t.route.loader;if(!o){if("action"===c){let n=new URL(e.url),r=n.pathname+n.search;throw Xl(405,{method:e.method,pathname:r,routeId:t.route.id})}return{type:"data",result:void 0}}[s]=await Promise.all([u(o),r])}else{if(!o){let t=new URL(e.url);throw Xl(404,{pathname:t.pathname+t.search})}s=await u(o)}}catch(d){return{type:"error",result:d}}finally{a&&e.signal.removeEventListener("abort",a)}return s}({request:n,match:r,lazyHandlerPromise:c?.handler,lazyRoutePromise:c?.route,handlerOverride:e,scopedContext:i}):Promise.resolve({type:"data",result:void 0})}}function Ol(e,t,n,r,o,i,s,a=null){return r.map(r=>r.route.id!==o.route.id?{...r,shouldLoad:!1,unstable_shouldRevalidateArgs:a,unstable_shouldCallHandler:()=>!1,_lazyPromises:Ll(e,t,n,r,i),resolve:()=>Promise.resolve({type:"data",result:void 0})}:Ul(e,t,n,r,i,s,!0,a))}async function Dl(e){let{result:t,type:n}=e;if(rc(t)){let e;try{e=await async function(e){let t=e.headers.get("Content-Type");return t&&/\bapplication\/json\b/.test(t)?null==e.body?null:e.json():e.text()}(t)}catch(r){return{type:"error",error:r}}return"error"===n?{type:"error",error:new ol(t.status,t.statusText,e),statusCode:t.status,headers:t.headers}:{type:"data",data:e,statusCode:t.status,headers:t.headers}}return"error"===n?nc(t)?t.data instanceof Error?{type:"error",error:t.data,statusCode:t.init?.status,headers:t.init?.headers?new Headers(t.init.headers):void 0}:{type:"error",error:new ol(t.init?.status||500,void 0,t.data),statusCode:il(t)?t.status:void 0,headers:t.init?.headers?new Headers(t.init.headers):void 0}:{type:"error",error:t,statusCode:il(t)?t.status:void 0}:nc(t)?{type:"data",data:t.data,statusCode:t.init?.status,headers:t.init?.headers?new Headers(t.init.headers):void 0}:{type:"data",data:t}}function Nl(e,t,n,r,o){let i=e.headers.get("Location");if(xa(i,"Redirects returned/thrown from loaders/actions must have a Location header"),!gl(i)){let s=r.slice(0,r.findIndex(e=>e.route.id===n)+1);i=wl(new URL(t.url),s,o,i),e.headers.set("Location",i)}return e}function jl(e,t,n){if(gl(e)){let r=e,o=r.startsWith("//")?new URL(t.protocol+r):new URL(r),i=null!=Xa(o.pathname,n);if(o.origin===t.origin&&i)return o.pathname+o.search+o.hash}return e}function Ql(e,t,n,r){let o=e.createURL(ql(t)).toString(),i={signal:n};if(r&&oc(r.formMethod)){let{formMethod:e,formEncType:t}=r;i.method=e.toUpperCase(),"application/json"===t?(i.headers=new Headers({"Content-Type":t}),i.body=JSON.stringify(r.json)):"text/plain"===t?i.body=r.text:"application/x-www-form-urlencoded"===t&&r.formData?i.body=zl(r.formData):i.body=r.formData}return new Request(o,i)}function zl(e){let t=new URLSearchParams;for(let[n,r]of e.entries())t.append(n,"string"==typeof r?r:r.name);return t}function Hl(e){let t=new FormData;for(let[n,r]of e.entries())t.append(n,r);return t}function Gl(e,t,n,r,o,i){let{loaderData:s,errors:a}=function(e,t,n,r=!1,o=!1){let i,s={},a=null,l=!1,c={},u=n&&ec(n[1])?n[1].error:void 0;return e.forEach(n=>{if(!(n.route.id in t))return;let d=n.route.id,A=t[d];if(xa(!tc(A),"Cannot handle redirect results in processLoaderData"),ec(A)){let t=A.error;if(void 0!==u&&(t=u,u=void 0),a=a||{},o)a[d]=t;else{let n=$l(e,d);null==a[n.route.id]&&(a[n.route.id]=t)}r||(s[d]=vl),l||(l=!0,i=il(A.error)?A.error.status:500),A.headers&&(c[d]=A.headers)}else s[d]=A.data,A.statusCode&&200!==A.statusCode&&!l&&(i=A.statusCode),A.headers&&(c[d]=A.headers)}),void 0!==u&&n&&(a={[n[0]]:u},n[2]&&(s[n[2]]=void 0)),{loaderData:s,errors:a,statusCode:i||200,loaderHeaders:c}}(t,n,r);return o.filter(e=>!e.matches||e.matches.some(e=>e.shouldLoad)).forEach(t=>{let{key:n,match:r,controller:o}=t;if(o&&o.signal.aborted)return;let s=i[n];if(xa(s,"Did not find corresponding fetcher result"),ec(s)){let t=$l(e.matches,r?.route.id);a&&a[t.route.id]||(a={...a,[t.route.id]:s.error}),e.fetchers.delete(n)}else if(tc(s))xa(!1,"Unhandled fetcher revalidation redirect");else{let t=uc(s.data);e.fetchers.set(n,t)}}),{loaderData:s,errors:a}}function Vl(e,t,n,r){let o=Object.entries(t).filter(([,e])=>e!==vl).reduce((e,[t,n])=>(e[t]=n,e),{});for(let i of n){let n=i.route.id;if(!t.hasOwnProperty(n)&&e.hasOwnProperty(n)&&i.route.loader&&(o[n]=e[n]),r&&r.hasOwnProperty(n))break}return o}function Wl(e){return e?ec(e[1])?{actionData:{}}:{actionData:{[e[0]]:e[1].data}}:{}}function $l(e,t){return(t?e.slice(0,e.findIndex(e=>e.route.id===t)+1):[...e]).reverse().find(e=>!0===e.route.hasErrorBoundary)||e[0]}function Kl(e){let t=1===e.length?e[0]:e.find(e=>e.index||!e.path||"/"===e.path)||{id:"__shim-error-route__"};return{matches:[{params:{},pathname:"",pathnameBase:"",route:t}],route:t}}function Xl(e,{pathname:t,routeId:n,method:r,type:o,message:i}={}){let s="Unknown Server Error",a="Unknown @remix-run/router error";return 400===e?(s="Bad Request",r&&t&&n?a=`You made a ${r} request to "${t}" but did not provide a \`loader\` for route "${n}", so there is no way to handle the request.`:"invalid-body"===o&&(a="Unable to encode submission body")):403===e?(s="Forbidden",a=`Route "${n}" does not match URL "${t}"`):404===e?(s="Not Found",a=`No route matches URL "${t}"`):405===e&&(s="Method Not Allowed",r&&t&&n?a=`You made a ${r.toUpperCase()} request to "${t}" but did not provide an \`action\` for route "${n}", so there is no way to handle the request.`:r&&(a=`Invalid request method "${r.toUpperCase()}"`)),new ol(e||500,s,new Error(a),!0)}function Yl(e){let t=Object.entries(e);for(let n=t.length-1;n>=0;n--){let[e,r]=t[n];if(tc(r))return{key:e,result:r}}}function ql(e){return Ea({..."string"==typeof e?Ba(e):e,hash:""})}function Jl(e){return null!=e&&"object"==typeof e&&Object.entries(e).every(([e,t])=>"string"==typeof e&&function(e){return null!=e&&"object"==typeof e&&"type"in e&&"result"in e&&("data"===e.type||"error"===e.type)}(t))}function Zl(e){return rc(e.result)&&ul.has(e.result.status)}function ec(e){return"error"===e.type}function tc(e){return"redirect"===(e&&e.type)}function nc(e){return"object"==typeof e&&null!=e&&"type"in e&&"data"in e&&"init"in e&&"DataWithResponseInit"===e.type}function rc(e){return null!=e&&"number"==typeof e.status&&"string"==typeof e.statusText&&"object"==typeof e.headers&&void 0!==e.body}function oc(e){return al.has(e.toUpperCase())}function ic(e){return new URLSearchParams(e).getAll("index").some(e=>""===e)}function sc(e,t){let n="string"==typeof t?Ba(t).search:t.search;if(e[e.length-1].route.index&&ic(n||""))return e[e.length-1];let r=qa(e);return r[r.length-1]}function ac(e){let{formMethod:t,formAction:n,formEncType:r,text:o,formData:i,json:s}=e;if(t&&n&&r)return null!=o?{formMethod:t,formAction:n,formEncType:r,formData:void 0,json:void 0,text:o}:null!=i?{formMethod:t,formAction:n,formEncType:r,formData:i,json:void 0,text:void 0}:void 0!==s?{formMethod:t,formAction:n,formEncType:r,formData:void 0,json:s,text:void 0}:void 0}function lc(e,t){if(t){return{state:"loading",location:e,formMethod:t.formMethod,formAction:t.formAction,formEncType:t.formEncType,formData:t.formData,json:t.json,text:t.text}}return{state:"loading",location:e,formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0,json:void 0,text:void 0}}function cc(e,t){if(e){return{state:"loading",formMethod:e.formMethod,formAction:e.formAction,formEncType:e.formEncType,formData:e.formData,json:e.json,text:e.text,data:t}}return{state:"loading",formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0,json:void 0,text:void 0,data:t}}function uc(e){return{state:"idle",formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0,json:void 0,text:void 0,data:e}}var dc=pe.createContext(null);dc.displayName="DataRouter";var Ac=pe.createContext(null);Ac.displayName="DataRouterState",pe.createContext(!1);var hc=pe.createContext({isTransitioning:!1});hc.displayName="ViewTransition";var pc=pe.createContext(new Map);pc.displayName="Fetchers",pe.createContext(null).displayName="Await";var fc=pe.createContext(null);fc.displayName="Navigation";var gc=pe.createContext(null);gc.displayName="Location";var mc=pe.createContext({outlet:null,matches:[],isDataRoute:!1});mc.displayName="Route";var yc=pe.createContext(null);function vc(){return null!=pe.useContext(gc)}function bc(){return xa(vc(),"useLocation() may be used only in the context of a <Router> component."),pe.useContext(gc).location}yc.displayName="RouteError";var wc="You should call navigate() in a React.useEffect(), not when your component is first rendered.";function xc(e){pe.useContext(fc).static||pe.useLayoutEffect(e)}function _c(){let{isDataRoute:e}=pe.useContext(mc);return e?function(){let{router:e}=function(e){let t=pe.useContext(dc);return xa(t,Pc(e)),t}("useNavigate"),t=Fc("useNavigate"),n=pe.useRef(!1);return xc(()=>{n.current=!0}),pe.useCallback(async(r,o={})=>{_a(n.current,wc),n.current&&("number"==typeof r?e.navigate(r):await e.navigate(r,{fromRouteId:t,...o}))},[e,t])}():function(){xa(vc(),"useNavigate() may be used only in the context of a <Router> component.");let e=pe.useContext(dc),{basename:t,navigator:n}=pe.useContext(fc),{matches:r}=pe.useContext(mc),{pathname:o}=bc(),i=JSON.stringify(Ja(r)),s=pe.useRef(!1);return xc(()=>{s.current=!0}),pe.useCallback((r,a={})=>{if(_a(s.current,wc),!s.current)return;if("number"==typeof r)return void n.go(r);let l=Za(r,JSON.parse(i),o,"path"===a.relative);null==e&&"/"!==t&&(l.pathname="/"===l.pathname?t:el([t,l.pathname])),(a.replace?n.replace:n.push)(l,a.state,a)},[t,n,i,o,e])}()}var Cc=pe.createContext(null);function Sc(){let{matches:e}=pe.useContext(mc),t=e[e.length-1];return t?t.params:{}}function Ec(e,{relative:t}={}){let{matches:n}=pe.useContext(mc),{pathname:r}=bc(),o=JSON.stringify(Ja(n));return pe.useMemo(()=>Za(e,JSON.parse(o),r,"path"===t),[e,o,r,t])}function Bc(e,t,n,r,o){xa(vc(),"useRoutes() may be used only in the context of a <Router> component.");let i,{navigator:s}=pe.useContext(fc),{matches:a}=pe.useContext(mc),l=a[a.length-1],c=l?l.params:{},u=l?l.pathname:"/",d=l?l.pathnameBase:"/",A=l&&l.route;{let e=A&&A.path||"";Lc(u,!A||e.endsWith("*")||e.endsWith("*?"),`You rendered descendant <Routes> (or called \`useRoutes()\`) at "${u}" (under <Route path="${e}">) but the parent route path has no trailing "*". This means if you navigate deeper, the parent won't match anymore and therefore the child routes will never render.\n\nPlease change the parent <Route path="${e}"> to <Route path="${"/"===e?"*":`${e}/*`}">.`)}i=bc();let h=i.pathname||"/",p=h;if("/"!==d){let e=d.replace(/^\//,"").split("/");p="/"+h.replace(/^\//,"").split("/").slice(e.length).join("/")}let f=Ma(e,{pathname:p});_a(A||null!=f,`No routes matched location "${i.pathname}${i.search}${i.hash}" `),_a(null==f||void 0!==f[f.length-1].route.element||void 0!==f[f.length-1].route.Component||void 0!==f[f.length-1].route.lazy,`Matched leaf route at location "${i.pathname}${i.search}${i.hash}" does not have an element or Component. This means it will render an <Outlet /> with a null value by default resulting in an "empty" page.`);let g=function(e,t=[],n=null,r=null){if(null==e){if(!n)return null;if(n.errors)e=n.matches;else{if(0!==t.length||n.initialized||!(n.matches.length>0))return null;e=n.matches}}let o=e,i=n?.errors;if(null!=i){let e=o.findIndex(e=>e.route.id&&void 0!==i?.[e.route.id]);xa(e>=0,`Could not find a matching route for errors on route IDs: ${Object.keys(i).join(",")}`),o=o.slice(0,Math.min(o.length,e+1))}let s=!1,a=-1;if(n)for(let l=0;l<o.length;l++){let e=o[l];if((e.route.HydrateFallback||e.route.hydrateFallbackElement)&&(a=l),e.route.id){let{loaderData:t,errors:r}=n,i=e.route.loader&&!t.hasOwnProperty(e.route.id)&&(!r||void 0===r[e.route.id]);if(e.route.lazy||i){s=!0,o=a>=0?o.slice(0,a+1):[o[0]];break}}}return o.reduceRight((e,l,c)=>{let u,d=!1,A=null,h=null;n&&(u=i&&l.route.id?i[l.route.id]:void 0,A=l.route.errorElement||Rc,s&&(a<0&&0===c?(Lc("route-fallback",!1,"No `HydrateFallback` element provided to render during initial hydration"),d=!0,h=null):a===c&&(d=!0,h=l.route.hydrateFallbackElement||null)));let p=t.concat(o.slice(0,c+1)),f=()=>{let t;return t=u?A:d?h:l.route.Component?pe.createElement(l.route.Component,null):l.route.element?l.route.element:e,pe.createElement(Tc,{match:l,routeContext:{outlet:e,matches:p,isDataRoute:null!=n},children:t})};return n&&(l.route.ErrorBoundary||l.route.errorElement||0===c)?pe.createElement(kc,{location:n.location,revalidation:n.revalidation,component:A,error:u,children:f(),routeContext:{outlet:null,matches:p,isDataRoute:!0},unstable_onError:r}):f()},null)}(f&&f.map(e=>Object.assign({},e,{params:Object.assign({},c,e.params),pathname:el([d,s.encodeLocation?s.encodeLocation(e.pathname).pathname:e.pathname]),pathnameBase:"/"===e.pathnameBase?d:el([d,s.encodeLocation?s.encodeLocation(e.pathnameBase).pathname:e.pathnameBase])})),a,n,r,o);return g}function Ic(){let e=function(){let e=pe.useContext(yc),t=function(e){let t=pe.useContext(Ac);return xa(t,Pc(e)),t}("useRouteError"),n=Fc("useRouteError");if(void 0!==e)return e;return t.errors?.[n]}(),t=il(e)?`${e.status} ${e.statusText}`:e instanceof Error?e.message:JSON.stringify(e),n=e instanceof Error?e.stack:null,r="rgba(200,200,200, 0.5)",o={padding:"0.5rem",backgroundColor:r},i={padding:"2px 4px",backgroundColor:r},s=null;return s=pe.createElement(pe.Fragment,null,pe.createElement("p",null," Hey developer "),pe.createElement("p",null,"You can provide a way better UX than this when your app throws errors by providing your own ",pe.createElement("code",{style:i},"ErrorBoundary")," or"," ",pe.createElement("code",{style:i},"errorElement")," prop on your route.")),pe.createElement(pe.Fragment,null,pe.createElement("h2",null,"Unexpected Application Error!"),pe.createElement("h3",{style:{fontStyle:"italic"}},t),n?pe.createElement("pre",{style:o},n):null,s)}var Rc=pe.createElement(Ic,null),kc=class extends pe.Component{constructor(e){super(e),this.state={location:e.location,revalidation:e.revalidation,error:e.error}}static getDerivedStateFromError(e){return{error:e}}static getDerivedStateFromProps(e,t){return t.location!==e.location||"idle"!==t.revalidation&&"idle"===e.revalidation?{error:e.error,location:e.location,revalidation:e.revalidation}:{error:void 0!==e.error?e.error:t.error,location:t.location,revalidation:e.revalidation||t.revalidation}}componentDidCatch(e,t){this.props.unstable_onError&&this.props.unstable_onError(e,t)}render(){return void 0!==this.state.error?pe.createElement(mc.Provider,{value:this.props.routeContext},pe.createElement(yc.Provider,{value:this.state.error,children:this.props.component})):this.props.children}};function Tc({routeContext:e,match:t,children:n}){let r=pe.useContext(dc);return r&&r.static&&r.staticContext&&(t.route.errorElement||t.route.ErrorBoundary)&&(r.staticContext._deepestRenderedBoundaryId=t.route.id),pe.createElement(mc.Provider,{value:e},n)}function Pc(e){return`${e} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function Fc(e){let t=function(e){let t=pe.useContext(mc);return xa(t,Pc(e)),t}(e),n=t.matches[t.matches.length-1];return xa(n.route.id,`${e} can only be used on routes that contain a unique "id"`),n.route.id}var Mc={};function Lc(e,t,n){t||Mc[e]||(Mc[e]=!0,_a(!1,n))}var Uc={};function Oc(e,t){e||Uc[t]||(Uc[t]=!0)}function Dc(e){let t={hasErrorBoundary:e.hasErrorBoundary||null!=e.ErrorBoundary||null!=e.errorElement};return e.Component&&(e.element&&_a(!1,"You should not include both `Component` and `element` on your route - `Component` will be used."),Object.assign(t,{element:pe.createElement(e.Component),Component:void 0})),e.HydrateFallback&&(e.hydrateFallbackElement&&_a(!1,"You should not include both `HydrateFallback` and `hydrateFallbackElement` on your route - `HydrateFallback` will be used."),Object.assign(t,{hydrateFallbackElement:pe.createElement(e.HydrateFallback),HydrateFallback:void 0})),e.ErrorBoundary&&(e.errorElement&&_a(!1,"You should not include both `ErrorBoundary` and `errorElement` on your route - `ErrorBoundary` will be used."),Object.assign(t,{errorElement:pe.createElement(e.ErrorBoundary),ErrorBoundary:void 0})),t}var Nc=["HydrateFallback","hydrateFallbackElement"],jc=class{constructor(){this.status="pending",this.promise=new Promise((e,t)=>{this.resolve=t=>{"pending"===this.status&&(this.status="resolved",e(t))},this.reject=e=>{"pending"===this.status&&(this.status="rejected",t(e))}})}};function Qc({router:e,flushSync:t,unstable_onError:n}){let[r,o]=pe.useState(e.state),[i,s]=pe.useState(),[a,l]=pe.useState({isTransitioning:!1}),[c,u]=pe.useState(),[d,A]=pe.useState(),[h,p]=pe.useState(),f=pe.useRef(new Map),g=pe.useCallback(e=>{o(t=>(e.errors&&n&&Object.entries(e.errors).forEach(([e,r])=>{t.errors?.[e]!==r&&n(r)}),e))},[n]),m=pe.useCallback((n,{deletedFetchers:r,flushSync:o,viewTransitionOpts:i})=>{n.fetchers.forEach((e,t)=>{void 0!==e.data&&f.current.set(t,e.data)}),r.forEach(e=>f.current.delete(e)),Oc(!1===o||null!=t,'You provided the `flushSync` option to a router update, but you are not using the `<RouterProvider>` from `react-router/dom` so `ReactDOM.flushSync()` is unavailable.  Please update your app to `import { RouterProvider } from "react-router/dom"` and ensure you have `react-dom` installed as a dependency to use the `flushSync` option.');let a=null!=e.window&&null!=e.window.document&&"function"==typeof e.window.document.startViewTransition;if(Oc(null==i||a,"You provided the `viewTransition` option to a router update, but you do not appear to be running in a DOM environment as `window.startViewTransition` is not available."),i&&a){if(t&&o){t(()=>{d&&(c&&c.resolve(),d.skipTransition()),l({isTransitioning:!0,flushSync:!0,currentLocation:i.currentLocation,nextLocation:i.nextLocation})});let r=e.window.document.startViewTransition(()=>{t(()=>g(n))});return r.finished.finally(()=>{t(()=>{u(void 0),A(void 0),s(void 0),l({isTransitioning:!1})})}),void t(()=>A(r))}d?(c&&c.resolve(),d.skipTransition(),p({state:n,currentLocation:i.currentLocation,nextLocation:i.nextLocation})):(s(n),l({isTransitioning:!0,flushSync:!1,currentLocation:i.currentLocation,nextLocation:i.nextLocation}))}else t&&o?t(()=>g(n)):pe.startTransition(()=>g(n))},[e.window,t,d,c,g]);pe.useLayoutEffect(()=>e.subscribe(m),[e,m]),pe.useEffect(()=>{a.isTransitioning&&!a.flushSync&&u(new jc)},[a]),pe.useEffect(()=>{if(c&&i&&e.window){let t=i,n=c.promise,r=e.window.document.startViewTransition(async()=>{pe.startTransition(()=>g(t)),await n});r.finished.finally(()=>{u(void 0),A(void 0),s(void 0),l({isTransitioning:!1})}),A(r)}},[i,c,e.window,g]),pe.useEffect(()=>{c&&i&&r.location.key===i.location.key&&c.resolve()},[c,d,r.location,i]),pe.useEffect(()=>{!a.isTransitioning&&h&&(s(h.state),l({isTransitioning:!0,flushSync:!1,currentLocation:h.currentLocation,nextLocation:h.nextLocation}),p(void 0))},[a.isTransitioning,h]);let y=pe.useMemo(()=>({createHref:e.createHref,encodeLocation:e.encodeLocation,go:t=>e.navigate(t),push:(t,n,r)=>e.navigate(t,{state:n,preventScrollReset:r?.preventScrollReset}),replace:(t,n,r)=>e.navigate(t,{replace:!0,state:n,preventScrollReset:r?.preventScrollReset})}),[e]),v=e.basename||"/",b=pe.useMemo(()=>({router:e,navigator:y,static:!1,basename:v,unstable_onError:n}),[e,y,v,n]);return pe.createElement(pe.Fragment,null,pe.createElement(dc.Provider,{value:b},pe.createElement(Ac.Provider,{value:r},pe.createElement(pc.Provider,{value:f.current},pe.createElement(hc.Provider,{value:a},pe.createElement(Vc,{basename:v,location:r.location,navigationType:r.historyAction,navigator:y},pe.createElement(zc,{routes:e.routes,future:e.future,state:r,unstable_onError:n})))))),null)}var zc=pe.memo(function({routes:e,future:t,state:n,unstable_onError:r}){return Bc(e,0,n,r,t)});function Hc({to:e,replace:t,state:n,relative:r}){xa(vc(),"<Navigate> may be used only in the context of a <Router> component.");let{static:o}=pe.useContext(fc);_a(!o,"<Navigate> must not be used on the initial render in a <StaticRouter>. This is a no-op, but you should modify your code so the <Navigate> is only ever rendered in response to some user interaction or state change.");let{matches:i}=pe.useContext(mc),{pathname:s}=bc(),a=_c(),l=Za(e,Ja(i),s,"path"===r),c=JSON.stringify(l);return pe.useEffect(()=>{a(JSON.parse(c),{replace:t,state:n,relative:r})},[a,c,r,t,n]),null}function Gc(e){return function(e){let t=pe.useContext(mc).outlet;return t?pe.createElement(Cc.Provider,{value:e},t):t}(e.context)}function Vc({basename:e="/",children:t=null,location:n,navigationType:r="POP",navigator:o,static:i=!1}){xa(!vc(),"You cannot render a <Router> inside another <Router>. You should never have more than one in your app.");let s=e.replace(/^\/*/,"/"),a=pe.useMemo(()=>({basename:s,navigator:o,static:i,future:{}}),[s,o,i]);"string"==typeof n&&(n=Ba(n));let{pathname:l="/",search:c="",hash:u="",state:d=null,key:A="default"}=n,h=pe.useMemo(()=>{let e=Xa(l,s);return null==e?null:{location:{pathname:e,search:c,hash:u,state:d,key:A},navigationType:r}},[s,l,c,u,d,A,r]);return _a(null!=h,`<Router basename="${s}"> is not able to match the URL "${l}${c}${u}" because it does not start with the basename, so the <Router> won't render anything.`),null==h?null:pe.createElement(fc.Provider,{value:a},pe.createElement(gc.Provider,{children:t,value:h}))}var Wc="get",$c="application/x-www-form-urlencoded";function Kc(e){return null!=e&&"string"==typeof e.tagName}var Xc=null;var Yc=new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);function qc(e){return null==e||Yc.has(e)?e:(_a(!1,`"${e}" is not a valid \`encType\` for \`<Form>\`/\`<fetcher.Form>\` and will default to "${$c}"`),null)}function Jc(e,t){let n,r,o,i,s;if(Kc(a=e)&&"form"===a.tagName.toLowerCase()){let s=e.getAttribute("action");r=s?Xa(s,t):null,n=e.getAttribute("method")||Wc,o=qc(e.getAttribute("enctype"))||$c,i=new FormData(e)}else if(function(e){return Kc(e)&&"button"===e.tagName.toLowerCase()}(e)||function(e){return Kc(e)&&"input"===e.tagName.toLowerCase()}(e)&&("submit"===e.type||"image"===e.type)){let s=e.form;if(null==s)throw new Error('Cannot submit a <button> or <input type="submit"> without a <form>');let a=e.getAttribute("formaction")||s.getAttribute("action");if(r=a?Xa(a,t):null,n=e.getAttribute("formmethod")||s.getAttribute("method")||Wc,o=qc(e.getAttribute("formenctype"))||qc(s.getAttribute("enctype"))||$c,i=new FormData(s,e),!function(){if(null===Xc)try{new FormData(document.createElement("form"),0),Xc=!1}catch(e){Xc=!0}return Xc}()){let{name:t,type:n,value:r}=e;if("image"===n){let e=t?`${t}.`:"";i.append(`${e}x`,"0"),i.append(`${e}y`,"0")}else t&&i.append(t,r)}}else{if(Kc(e))throw new Error('Cannot submit element that is not <form>, <button>, or <input type="submit|image">');n=Wc,r=null,o=$c,s=e}var a;return i&&"text/plain"===o&&(s=i,i=void 0),{action:r,method:n.toLowerCase(),encType:o,formData:i,body:s}}function Zc(e,t){if(!1===e||null==e)throw new Error(t)}function eu(e){return null!=e&&(null==e.href?"preload"===e.rel&&"string"==typeof e.imageSrcSet&&"string"==typeof e.imageSizes:"string"==typeof e.rel&&"string"==typeof e.href)}async function tu(e,t,n){return function(e,t){let n=new Set;return new Set(t),e.reduce((e,t)=>{let r=JSON.stringify(function(e){let t={},n=Object.keys(e).sort();for(let r of n)t[r]=e[r];return t}(t));return n.has(r)||(n.add(r),e.push({key:r,link:t})),e},[])}((await Promise.all(e.map(async e=>{let r=t.routes[e.route.id];if(r){let e=await async function(e,t){if(e.id in t)return t[e.id];try{let n=await import(e.module);return t[e.id]=n,n}catch(n){return window.__reactRouterContext&&window.__reactRouterContext.isSpaMode,window.location.reload(),new Promise(()=>{})}}(r,n);return e.links?e.links():[]}return[]}))).flat(1).filter(eu).filter(e=>"stylesheet"===e.rel||"preload"===e.rel).map(e=>"stylesheet"===e.rel?{...e,rel:"prefetch",as:"style"}:{...e,rel:"prefetch"}))}function nu(e,t,n,r,o,i){let s=(e,t)=>!n[t]||e.route.id!==n[t].route.id,a=(e,t)=>n[t].pathname!==e.pathname||n[t].route.path?.endsWith("*")&&n[t].params["*"]!==e.params["*"];return"assets"===i?t.filter((e,t)=>s(e,t)||a(e,t)):"data"===i?t.filter((t,i)=>{let l=r.routes[t.route.id];if(!l||!l.hasLoader)return!1;if(s(t,i)||a(t,i))return!0;if(t.route.shouldRevalidate){let r=t.route.shouldRevalidate({currentUrl:new URL(o.pathname+o.search+o.hash,window.origin),currentParams:n[0]?.params||{},nextUrl:new URL(e,window.origin),nextParams:t.params,defaultShouldRevalidate:!0});if("boolean"==typeof r)return r}return!0}):[]}function ru(e,t,{includeHydrateFallback:n}={}){return r=e.map(e=>{let r=t.routes[e.route.id];if(!r)return[];let o=[r.module];return r.clientActionModule&&(o=o.concat(r.clientActionModule)),r.clientLoaderModule&&(o=o.concat(r.clientLoaderModule)),n&&r.hydrateFallbackModule&&(o=o.concat(r.hydrateFallbackModule)),r.imports&&(o=o.concat(r.imports)),o}).flat(1),[...new Set(r)];var r}function ou(){let e=pe.useContext(dc);return Zc(e,"You must render this element inside a <DataRouterContext.Provider> element"),e}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");var iu=pe.createContext(void 0);function su(){let e=pe.useContext(iu);return Zc(e,"You must render this element inside a <HydratedRouter> element"),e}function au(e,t){return n=>{e&&e(n),n.defaultPrevented||t(n)}}function lu({page:e,...t}){let{router:n}=ou(),r=pe.useMemo(()=>Ma(n.routes,e,n.basename),[n.routes,e,n.basename]);return r?pe.createElement(cu,{page:e,matches:r,...t}):null}function cu({page:e,matches:t,...n}){let r=bc(),{manifest:o,routeModules:i}=su(),{basename:s}=ou(),{loaderData:a,matches:l}=function(){let e=pe.useContext(Ac);return Zc(e,"You must render this element inside a <DataRouterStateContext.Provider> element"),e}(),c=pe.useMemo(()=>nu(e,t,l,o,r,"data"),[e,t,l,o,r]),u=pe.useMemo(()=>nu(e,t,l,o,r,"assets"),[e,t,l,o,r]),d=pe.useMemo(()=>{if(e===r.pathname+r.search+r.hash)return[];let n=new Set,l=!1;if(t.forEach(e=>{let t=o.routes[e.route.id];t&&t.hasLoader&&(!c.some(t=>t.route.id===e.route.id)&&e.route.id in a&&i[e.route.id]?.shouldRevalidate||t.hasClientLoader?l=!0:n.add(e.route.id))}),0===n.size)return[];let u=function(e,t,n){let r="string"==typeof e?new URL(e,"undefined"==typeof window?"server://singlefetch/":window.location.origin):e;return"/"===r.pathname?r.pathname=`_root.${n}`:t&&"/"===Xa(r.pathname,t)?r.pathname=`${t.replace(/\/$/,"")}/_root.${n}`:r.pathname=`${r.pathname.replace(/\/$/,"")}.${n}`,r}(e,s,"data");return l&&n.size>0&&u.searchParams.set("_routes",t.filter(e=>n.has(e.route.id)).map(e=>e.route.id).join(",")),[u.pathname+u.search]},[s,a,r,o,c,t,e,i]),A=pe.useMemo(()=>ru(u,o),[u,o]),h=function(e){let{manifest:t,routeModules:n}=su(),[r,o]=pe.useState([]);return pe.useEffect(()=>{let r=!1;return tu(e,t,n).then(e=>{r||o(e)}),()=>{r=!0}},[e,t,n]),r}(u);return pe.createElement(pe.Fragment,null,d.map(e=>pe.createElement("link",{key:e,rel:"prefetch",as:"fetch",href:e,...n})),A.map(e=>pe.createElement("link",{key:e,rel:"modulepreload",href:e,...n})),h.map(({key:e,link:t})=>pe.createElement("link",{key:e,nonce:n.nonce,...t})))}function uu(...e){return t=>{e.forEach(e=>{"function"==typeof e?e(t):null!=e&&(e.current=t)})}}iu.displayName="FrameworkContext";var du="undefined"!=typeof window&&void 0!==window.document&&void 0!==window.document.createElement;try{du&&(window.__reactRouterVersion="7.9.1")}catch(hee){}function Au(){let e=window?.__staticRouterHydrationData;return e&&e.errors&&(e={...e,errors:hu(e.errors)}),e}function hu(e){if(!e)return null;let t=Object.entries(e),n={};for(let[r,o]of t)if(o&&"RouteErrorResponse"===o.__type)n[r]=new ol(o.status,o.statusText,o.data,!0===o.internal);else if(o&&"Error"===o.__type){if(o.__subType){let e=window[o.__subType];if("function"==typeof e)try{let t=new e(o.message);t.stack="",n[r]=t}catch(hee){}}if(null==n[r]){let e=new Error(o.message);e.stack="",n[r]=e}}else n[r]=o;return n}var pu=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,fu=pe.forwardRef(function({onClick:e,discover:t="render",prefetch:n="none",relative:r,reloadDocument:o,replace:i,state:s,target:a,to:l,preventScrollReset:c,viewTransition:u,...d},A){let h,{basename:p}=pe.useContext(fc),f="string"==typeof l&&pu.test(l),g=!1;if("string"==typeof l&&f&&(h=l,du))try{let e=new URL(window.location.href),t=l.startsWith("//")?new URL(e.protocol+l):new URL(l),n=Xa(t.pathname,p);t.origin===e.origin&&null!=n?l=n+t.search+t.hash:g=!0}catch(hee){_a(!1,`<Link to="${l}"> contains an invalid URL which will probably break when clicked - please update to a valid URL path.`)}let m=function(e,{relative:t}={}){xa(vc(),"useHref() may be used only in the context of a <Router> component.");let{basename:n,navigator:r}=pe.useContext(fc),{hash:o,pathname:i,search:s}=Ec(e,{relative:t}),a=i;return"/"!==n&&(a="/"===i?n:el([n,i])),r.createHref({pathname:a,search:s,hash:o})}(l,{relative:r}),[y,v,b]=function(e,t){let n=pe.useContext(iu),[r,o]=pe.useState(!1),[i,s]=pe.useState(!1),{onFocus:a,onBlur:l,onMouseEnter:c,onMouseLeave:u,onTouchStart:d}=t,A=pe.useRef(null);pe.useEffect(()=>{if("render"===e&&s(!0),"viewport"===e){let e=new IntersectionObserver(e=>{e.forEach(e=>{s(e.isIntersecting)})},{threshold:.5});return A.current&&e.observe(A.current),()=>{e.disconnect()}}},[e]),pe.useEffect(()=>{if(r){let e=setTimeout(()=>{s(!0)},100);return()=>{clearTimeout(e)}}},[r]);let h=()=>{o(!0)},p=()=>{o(!1),s(!1)};return n?"intent"!==e?[i,A,{}]:[i,A,{onFocus:au(a,h),onBlur:au(l,p),onMouseEnter:au(c,h),onMouseLeave:au(u,p),onTouchStart:au(d,h)}]:[!1,A,{}]}(n,d),w=function(e,{target:t,replace:n,state:r,preventScrollReset:o,relative:i,viewTransition:s}={}){let a=_c(),l=bc(),c=Ec(e,{relative:i});return pe.useCallback(u=>{if(function(e,t){return!(0!==e.button||t&&"_self"!==t||function(e){return!!(e.metaKey||e.altKey||e.ctrlKey||e.shiftKey)}(e))}(u,t)){u.preventDefault();let t=void 0!==n?n:Ea(l)===Ea(c);a(e,{replace:t,state:r,preventScrollReset:o,relative:i,viewTransition:s})}},[l,a,c,n,r,t,e,o,i,s])}(l,{replace:i,state:s,target:a,preventScrollReset:c,relative:r,viewTransition:u});let x=pe.createElement("a",{...d,...b,href:h||m,onClick:g||o?e:function(t){e&&e(t),t.defaultPrevented||w(t)},ref:uu(A,v),target:a,"data-discover":f||"render"!==t?void 0:"true"});return y&&!f?pe.createElement(pe.Fragment,null,x,pe.createElement(lu,{page:m})):x});fu.displayName="Link";var gu=pe.forwardRef(function({"aria-current":e="page",caseSensitive:t=!1,className:n="",end:r=!1,style:o,to:i,viewTransition:s,children:a,...l},c){let u=Ec(i,{relative:l.relative}),d=bc(),A=pe.useContext(Ac),{navigator:h,basename:p}=pe.useContext(fc),f=null!=A&&function(e,{relative:t}={}){let n=pe.useContext(hc);xa(null!=n,"`useViewTransitionState` must be used within `react-router-dom`'s `RouterProvider`.  Did you accidentally import `RouterProvider` from `react-router`?");let{basename:r}=yu("useViewTransitionState"),o=Ec(e,{relative:t});if(!n.isTransitioning)return!1;let i=Xa(n.currentLocation.pathname,r)||n.currentLocation.pathname,s=Xa(n.nextLocation.pathname,r)||n.nextLocation.pathname;return null!=$a(o.pathname,s)||null!=$a(o.pathname,i)}(u)&&!0===s,g=h.encodeLocation?h.encodeLocation(u).pathname:u.pathname,m=d.pathname,y=A&&A.navigation&&A.navigation.location?A.navigation.location.pathname:null;t||(m=m.toLowerCase(),y=y?y.toLowerCase():null,g=g.toLowerCase()),y&&p&&(y=Xa(y,p)||y);const v="/"!==g&&g.endsWith("/")?g.length-1:g.length;let b,w=m===g||!r&&m.startsWith(g)&&"/"===m.charAt(v),x=null!=y&&(y===g||!r&&y.startsWith(g)&&"/"===y.charAt(g.length)),_={isActive:w,isPending:x,isTransitioning:f},C=w?e:void 0;b="function"==typeof n?n(_):[n,w?"active":null,x?"pending":null,f?"transitioning":null].filter(Boolean).join(" ");let S="function"==typeof o?o(_):o;return pe.createElement(fu,{...l,"aria-current":C,className:b,ref:c,style:S,to:i,viewTransition:s},"function"==typeof a?a(_):a)});gu.displayName="NavLink";var mu=pe.forwardRef(({discover:e="render",fetcherKey:t,navigate:n,reloadDocument:r,replace:o,state:i,method:s=Wc,action:a,onSubmit:l,relative:c,preventScrollReset:u,viewTransition:d,...A},h)=>{let p=function(){let{router:e}=yu("useSubmit"),{basename:t}=pe.useContext(fc),n=Fc("useRouteId");return pe.useCallback(async(r,o={})=>{let{action:i,method:s,encType:a,formData:l,body:c}=Jc(r,t);if(!1===o.navigate){let t=o.fetcherKey||bu();await e.fetch(t,n,o.action||i,{preventScrollReset:o.preventScrollReset,formData:l,body:c,formMethod:o.method||s,formEncType:o.encType||a,flushSync:o.flushSync})}else await e.navigate(o.action||i,{preventScrollReset:o.preventScrollReset,formData:l,body:c,formMethod:o.method||s,formEncType:o.encType||a,replace:o.replace,state:o.state,fromRouteId:n,flushSync:o.flushSync,viewTransition:o.viewTransition})},[e,t,n])}(),f=function(e,{relative:t}={}){let{basename:n}=pe.useContext(fc),r=pe.useContext(mc);xa(r,"useFormAction must be used inside a RouteContext");let[o]=r.matches.slice(-1),i={...Ec(e||".",{relative:t})},s=bc();if(null==e){i.search=s.search;let e=new URLSearchParams(i.search),t=e.getAll("index");if(t.some(e=>""===e)){e.delete("index"),t.filter(e=>e).forEach(t=>e.append("index",t));let n=e.toString();i.search=n?`?${n}`:""}}e&&"."!==e||!o.route.index||(i.search=i.search?i.search.replace(/^\?/,"?index&"):"?index");"/"!==n&&(i.pathname="/"===i.pathname?n:el([n,i.pathname]));return Ea(i)}(a,{relative:c}),g="get"===s.toLowerCase()?"get":"post",m="string"==typeof a&&pu.test(a);return pe.createElement("form",{ref:h,method:g,action:f,onSubmit:r?l:e=>{if(l&&l(e),e.defaultPrevented)return;e.preventDefault();let r=e.nativeEvent.submitter,a=r?.getAttribute("formmethod")||s;p(r||e.currentTarget,{fetcherKey:t,method:a,navigate:n,replace:o,state:i,relative:c,preventScrollReset:u,viewTransition:d})},...A,"data-discover":m||"render"!==e?void 0:"true"})});function yu(e){let t=pe.useContext(dc);return xa(t,function(e){return`${e} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}(e)),t}mu.displayName="Form";var vu=0,bu=()=>`__${String(++vu)}__`;var wu=Ge();const xu=t(wu);function _u(e){return pe.createElement(Qc,{flushSync:wu.flushSync,...e})}function Cu(...e){return e.reduce((e,t)=>null==t?e:function(...n){e.apply(this,n),t.apply(this,n)},()=>{})}const Su=function(e){let t,n;return function(r){let o=t;return void 0!==o&&r.theme===n||(yi.theme=r.theme,o=Io(e(yi)),t=o,n=r.theme),o}};function Eu(e){return di(e)}function Bu(e){return Eo("MuiSvgIcon",e)}Bo("MuiSvgIcon",["root","colorPrimary","colorSecondary","colorAction","colorError","colorDisabled","fontSizeInherit","fontSizeSmall","fontSizeMedium","fontSizeLarge"]);const Iu=la("svg",{name:"MuiSvgIcon",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:n}=e;return[t.root,"inherit"!==n.color&&t[`color${vr(n.color)}`],t[`fontSize${vr(n.fontSize)}`]]}})(Su(({theme:e})=>({userSelect:"none",width:"1em",height:"1em",display:"inline-block",flexShrink:0,transition:e.transitions?.create?.("fill",{duration:(e.vars??e).transitions?.duration?.shorter}),variants:[{props:e=>!e.hasSvgAsChild,style:{fill:"currentColor"}},{props:{fontSize:"inherit"},style:{fontSize:"inherit"}},{props:{fontSize:"small"},style:{fontSize:e.typography?.pxToRem?.(20)||"1.25rem"}},{props:{fontSize:"medium"},style:{fontSize:e.typography?.pxToRem?.(24)||"1.5rem"}},{props:{fontSize:"large"},style:{fontSize:e.typography?.pxToRem?.(35)||"2.1875rem"}},...Object.entries((e.vars??e).palette).filter(([,e])=>e&&e.main).map(([t])=>({props:{color:t},style:{color:(e.vars??e).palette?.[t]?.main}})),{props:{color:"action"},style:{color:(e.vars??e).palette?.action?.active}},{props:{color:"disabled"},style:{color:(e.vars??e).palette?.action?.disabled}},{props:{color:"inherit"},style:{color:void 0}}]}))),Ru=pe.forwardRef(function(e,t){const n=Eu({props:e,name:"MuiSvgIcon"}),{children:r,className:o,color:i="inherit",component:a="svg",fontSize:l="medium",htmlColor:c,inheritViewBox:u=!1,titleAccess:d,viewBox:A="0 0 24 24",...h}=n,p=pe.isValidElement(r)&&"svg"===r.type,f={...n,color:i,component:a,fontSize:l,instanceFontSize:e.fontSize,inheritViewBox:u,viewBox:A,hasSvgAsChild:p},g={};u||(g.viewBox=A);const m=(e=>{const{color:t,fontSize:n,classes:r}=e;return Ti({root:["root","inherit"!==t&&`color${vr(t)}`,`fontSize${vr(n)}`]},Bu,r)})(f);return s.jsxs(Iu,{as:a,className:Co(m.root,o),focusable:"false",color:c,"aria-hidden":!d||void 0,role:d?"img":void 0,ref:t,...g,...h,...p&&r.props,ownerState:f,children:[p?r.props.children:r,d?s.jsx("title",{children:d}):null]})});function ku(e,t){function n(t,n){return s.jsx(Ru,{"data-testid":void 0,ref:n,...t,children:e})}return n.muiName=Ru.muiName,pe.memo(pe.forwardRef(n))}function Tu(e,t=166){let n;function r(...r){clearTimeout(n),n=setTimeout(()=>{e.apply(this,r)},t)}return r.clear=()=>{clearTimeout(n)},r}function Pu(e){return e&&e.ownerDocument||document}function Fu(e){return Pu(e).defaultView||window}function Mu(e,t){"function"==typeof e?e(t):e&&(e.current=t)}function Lu(e){const{controlled:t,default:n,name:r,state:o="value"}=e,{current:i}=pe.useRef(void 0!==t),[s,a]=pe.useState(n);return[i?t:s,pe.useCallback(e=>{i||a(e)},[])]}function Uu(e){const t=pe.useRef(e);return Qo(()=>{t.current=e}),pe.useRef((...e)=>(0,t.current)(...e)).current}function Ou(...e){const t=pe.useRef(void 0),n=pe.useCallback(t=>{const n=e.map(e=>{if(null==e)return null;if("function"==typeof e){const n=e,r=n(t);return"function"==typeof r?r:()=>{n(null)}}return e.current=t,()=>{e.current=null}});return()=>{n.forEach(e=>e?.())}},e);return pe.useMemo(()=>e.every(e=>null==e)?null:e=>{t.current&&(t.current(),t.current=void 0),null!=e&&(t.current=n(e))},e)}function Du(e,t){if(!e)return t;function n(e,t){const n={};return Object.keys(t).forEach(r=>{(function(e,t){const n=e.charCodeAt(2);return"o"===e[0]&&"n"===e[1]&&n>=65&&n<=90&&"function"==typeof t})(r,t[r])&&"function"==typeof e[r]&&(n[r]=(...n)=>{e[r](...n),t[r](...n)})}),n}if("function"==typeof e||"function"==typeof t)return r=>{const o="function"==typeof t?t(r):t,i="function"==typeof e?e({...r,...o}):e,s=Co(r?.className,o?.className,i?.className),a=n(i,o);return{...o,...i,...a,...!!s&&{className:s},...o?.style&&i?.style&&{style:{...o.style,...i.style}},...o?.sx&&i?.sx&&{sx:[...Array.isArray(o.sx)?o.sx:[o.sx],...Array.isArray(i.sx)?i.sx:[i.sx]]}}};const r=t,o=n(e,r),i=Co(r?.className,e?.className);return{...t,...e,...o,...!!i&&{className:i},...r?.style&&e?.style&&{style:{...r.style,...e.style}},...r?.sx&&e?.sx&&{sx:[...Array.isArray(r.sx)?r.sx:[r.sx],...Array.isArray(e.sx)?e.sx:[e.sx]]}}}function Nu(e,t){if(null==e)return{};var n={};for(var r in e)if({}.hasOwnProperty.call(e,r)){if(-1!==t.indexOf(r))continue;n[r]=e[r]}return n}function ju(e,t){return(ju=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function Qu(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,ju(e,t)}Ru.muiName="SvgIcon";const zu=!1,Hu=fe.createContext(null);var Gu="unmounted",Vu="exited",Wu="entering",$u="entered",Ku="exiting",Xu=function(e){function t(t,n){var r;r=e.call(this,t,n)||this;var o,i=n&&!n.isMounting?t.enter:t.appear;return r.appearStatus=null,t.in?i?(o=Vu,r.appearStatus=Wu):o=$u:o=t.unmountOnExit||t.mountOnEnter?Gu:Vu,r.state={status:o},r.nextCallback=null,r}Qu(t,e),t.getDerivedStateFromProps=function(e,t){return e.in&&t.status===Gu?{status:Vu}:null};var n=t.prototype;return n.componentDidMount=function(){this.updateStatus(!0,this.appearStatus)},n.componentDidUpdate=function(e){var t=null;if(e!==this.props){var n=this.state.status;this.props.in?n!==Wu&&n!==$u&&(t=Wu):n!==Wu&&n!==$u||(t=Ku)}this.updateStatus(!1,t)},n.componentWillUnmount=function(){this.cancelNextCallback()},n.getTimeouts=function(){var e,t,n,r=this.props.timeout;return e=t=n=r,null!=r&&"number"!=typeof r&&(e=r.exit,t=r.enter,n=void 0!==r.appear?r.appear:t),{exit:e,enter:t,appear:n}},n.updateStatus=function(e,t){if(void 0===e&&(e=!1),null!==t)if(this.cancelNextCallback(),t===Wu){if(this.props.unmountOnExit||this.props.mountOnEnter){var n=this.props.nodeRef?this.props.nodeRef.current:xu.findDOMNode(this);n&&function(e){e.scrollTop}(n)}this.performEnter(e)}else this.performExit();else this.props.unmountOnExit&&this.state.status===Vu&&this.setState({status:Gu})},n.performEnter=function(e){var t=this,n=this.props.enter,r=this.context?this.context.isMounting:e,o=this.props.nodeRef?[r]:[xu.findDOMNode(this),r],i=o[0],s=o[1],a=this.getTimeouts(),l=r?a.appear:a.enter;!e&&!n||zu?this.safeSetState({status:$u},function(){t.props.onEntered(i)}):(this.props.onEnter(i,s),this.safeSetState({status:Wu},function(){t.props.onEntering(i,s),t.onTransitionEnd(l,function(){t.safeSetState({status:$u},function(){t.props.onEntered(i,s)})})}))},n.performExit=function(){var e=this,t=this.props.exit,n=this.getTimeouts(),r=this.props.nodeRef?void 0:xu.findDOMNode(this);t&&!zu?(this.props.onExit(r),this.safeSetState({status:Ku},function(){e.props.onExiting(r),e.onTransitionEnd(n.exit,function(){e.safeSetState({status:Vu},function(){e.props.onExited(r)})})})):this.safeSetState({status:Vu},function(){e.props.onExited(r)})},n.cancelNextCallback=function(){null!==this.nextCallback&&(this.nextCallback.cancel(),this.nextCallback=null)},n.safeSetState=function(e,t){t=this.setNextCallback(t),this.setState(e,t)},n.setNextCallback=function(e){var t=this,n=!0;return this.nextCallback=function(r){n&&(n=!1,t.nextCallback=null,e(r))},this.nextCallback.cancel=function(){n=!1},this.nextCallback},n.onTransitionEnd=function(e,t){this.setNextCallback(t);var n=this.props.nodeRef?this.props.nodeRef.current:xu.findDOMNode(this),r=null==e&&!this.props.addEndListener;if(n&&!r){if(this.props.addEndListener){var o=this.props.nodeRef?[this.nextCallback]:[n,this.nextCallback],i=o[0],s=o[1];this.props.addEndListener(i,s)}null!=e&&setTimeout(this.nextCallback,e)}else setTimeout(this.nextCallback,0)},n.render=function(){var e=this.state.status;if(e===Gu)return null;var t=this.props,n=t.children;t.in,t.mountOnEnter,t.unmountOnExit,t.appear,t.enter,t.exit,t.timeout,t.addEndListener,t.onEnter,t.onEntering,t.onEntered,t.onExit,t.onExiting,t.onExited,t.nodeRef;var r=Nu(t,["children","in","mountOnEnter","unmountOnExit","appear","enter","exit","timeout","addEndListener","onEnter","onEntering","onEntered","onExit","onExiting","onExited","nodeRef"]);return fe.createElement(Hu.Provider,{value:null},"function"==typeof n?n(e,r):fe.cloneElement(fe.Children.only(n),r))},t}(fe.Component);function Yu(){}function qu(e,t){var n=Object.create(null);return e&&pe.Children.map(e,function(e){return e}).forEach(function(e){n[e.key]=function(e){return t&&pe.isValidElement(e)?t(e):e}(e)}),n}function Ju(e,t,n){return null!=n[t]?n[t]:e.props[t]}function Zu(e,t,n){var r=qu(e.children),o=function(e,t){function n(n){return n in t?t[n]:e[n]}e=e||{},t=t||{};var r,o=Object.create(null),i=[];for(var s in e)s in t?i.length&&(o[s]=i,i=[]):i.push(s);var a={};for(var l in t){if(o[l])for(r=0;r<o[l].length;r++){var c=o[l][r];a[o[l][r]]=n(c)}a[l]=n(l)}for(r=0;r<i.length;r++)a[i[r]]=n(i[r]);return a}(t,r);return Object.keys(o).forEach(function(i){var s=o[i];if(pe.isValidElement(s)){var a=i in t,l=i in r,c=t[i],u=pe.isValidElement(c)&&!c.props.in;!l||a&&!u?l||!a||u?l&&a&&pe.isValidElement(c)&&(o[i]=pe.cloneElement(s,{onExited:n.bind(null,s),in:c.props.in,exit:Ju(s,"exit",e),enter:Ju(s,"enter",e)})):o[i]=pe.cloneElement(s,{in:!1}):o[i]=pe.cloneElement(s,{onExited:n.bind(null,s),in:!0,exit:Ju(s,"exit",e),enter:Ju(s,"enter",e)})}}),o}Xu.contextType=Hu,Xu.propTypes={},Xu.defaultProps={in:!1,mountOnEnter:!1,unmountOnExit:!1,appear:!1,enter:!0,exit:!0,onEnter:Yu,onEntering:Yu,onEntered:Yu,onExit:Yu,onExiting:Yu,onExited:Yu},Xu.UNMOUNTED=Gu,Xu.EXITED=Vu,Xu.ENTERING=Wu,Xu.ENTERED=$u,Xu.EXITING=Ku;var ed=Object.values||function(e){return Object.keys(e).map(function(t){return e[t]})},td=function(e){function t(t,n){var r,o=(r=e.call(this,t,n)||this).handleExited.bind(function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(r));return r.state={contextValue:{isMounting:!0},handleExited:o,firstRender:!0},r}Qu(t,e);var n=t.prototype;return n.componentDidMount=function(){this.mounted=!0,this.setState({contextValue:{isMounting:!1}})},n.componentWillUnmount=function(){this.mounted=!1},t.getDerivedStateFromProps=function(e,t){var n,r,o=t.children,i=t.handleExited;return{children:t.firstRender?(n=e,r=i,qu(n.children,function(e){return pe.cloneElement(e,{onExited:r.bind(null,e),in:!0,appear:Ju(e,"appear",n),enter:Ju(e,"enter",n),exit:Ju(e,"exit",n)})})):Zu(e,o,i),firstRender:!1}},n.handleExited=function(e,t){var n=qu(this.props.children);e.key in n||(e.props.onExited&&e.props.onExited(t),this.mounted&&this.setState(function(t){var n=Ke({},t.children);return delete n[e.key],{children:n}}))},n.render=function(){var e=this.props,t=e.component,n=e.childFactory,r=Nu(e,["component","childFactory"]),o=this.state.contextValue,i=ed(this.state.children).map(n);return delete r.appear,delete r.enter,delete r.exit,null===t?fe.createElement(Hu.Provider,{value:o},i):fe.createElement(Hu.Provider,{value:o},fe.createElement(t,r,i))},t}(fe.Component);td.propTypes={},td.defaultProps={component:"div",childFactory:function(e){return e}};const nd={};function rd(e,t){const n=pe.useRef(nd);return n.current===nd&&(n.current=e(t)),n}const od=[];class id{static create(){return new id}currentId=null;start(e,t){this.clear(),this.currentId=setTimeout(()=>{this.currentId=null,t()},e)}clear=()=>{null!==this.currentId&&(clearTimeout(this.currentId),this.currentId=null)};disposeEffect=()=>this.clear}function sd(){const e=rd(id.create).current;var t;return t=e.disposeEffect,pe.useEffect(t,od),e}const ad=e=>e.scrollTop;function ld(e,t){const{timeout:n,easing:r,style:o={}}=e;return{duration:o.transitionDuration??("number"==typeof n?n:n[t.mode]||0),easing:o.transitionTimingFunction??("object"==typeof r?r[t.mode]:r),delay:o.transitionDelay}}function cd(e){return Eo("MuiCollapse",e)}Bo("MuiCollapse",["root","horizontal","vertical","entered","hidden","wrapper","wrapperInner"]);const ud=la("div",{name:"MuiCollapse",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:n}=e;return[t.root,t[n.orientation],"entered"===n.state&&t.entered,"exited"===n.state&&!n.in&&"0px"===n.collapsedSize&&t.hidden]}})(Su(({theme:e})=>({height:0,overflow:"hidden",transition:e.transitions.create("height"),variants:[{props:{orientation:"horizontal"},style:{height:"auto",width:0,transition:e.transitions.create("width")}},{props:{state:"entered"},style:{height:"auto",overflow:"visible"}},{props:{state:"entered",orientation:"horizontal"},style:{width:"auto"}},{props:({ownerState:e})=>"exited"===e.state&&!e.in&&"0px"===e.collapsedSize,style:{visibility:"hidden"}}]}))),dd=la("div",{name:"MuiCollapse",slot:"Wrapper"})({display:"flex",width:"100%",variants:[{props:{orientation:"horizontal"},style:{width:"auto",height:"100%"}}]}),Ad=la("div",{name:"MuiCollapse",slot:"WrapperInner"})({width:"100%",variants:[{props:{orientation:"horizontal"},style:{width:"auto",height:"100%"}}]}),hd=pe.forwardRef(function(e,t){const n=Eu({props:e,name:"MuiCollapse"}),{addEndListener:r,children:o,className:i,collapsedSize:a="0px",component:l,easing:c,in:u,onEnter:d,onEntered:A,onEntering:h,onExit:p,onExited:f,onExiting:g,orientation:m="vertical",style:y,timeout:v=Ps.standard,TransitionComponent:b=Xu,...w}=n,x={...n,orientation:m,collapsedSize:a},_=(e=>{const{orientation:t,classes:n}=e;return Ti({root:["root",`${t}`],entered:["entered"],hidden:["hidden"],wrapper:["wrapper",`${t}`],wrapperInner:["wrapperInner",`${t}`]},cd,n)})(x),C=ia(),S=sd(),E=pe.useRef(null),B=pe.useRef(),I="number"==typeof a?`${a}px`:a,R="horizontal"===m,k=R?"width":"height",T=pe.useRef(null),P=Ou(t,T),F=e=>t=>{if(e){const n=T.current;void 0===t?e(n):e(n,t)}},M=()=>E.current?E.current[R?"clientWidth":"clientHeight"]:0,L=F((e,t)=>{E.current&&R&&(E.current.style.position="absolute"),e.style[k]=I,d&&d(e,t)}),U=F((e,t)=>{const n=M();E.current&&R&&(E.current.style.position="");const{duration:r,easing:o}=ld({style:y,timeout:v,easing:c},{mode:"enter"});if("auto"===v){const t=C.transitions.getAutoHeightDuration(n);e.style.transitionDuration=`${t}ms`,B.current=t}else e.style.transitionDuration="string"==typeof r?r:`${r}ms`;e.style[k]=`${n}px`,e.style.transitionTimingFunction=o,h&&h(e,t)}),O=F((e,t)=>{e.style[k]="auto",A&&A(e,t)}),D=F(e=>{e.style[k]=`${M()}px`,p&&p(e)}),N=F(f),j=F(e=>{const t=M(),{duration:n,easing:r}=ld({style:y,timeout:v,easing:c},{mode:"exit"});if("auto"===v){const n=C.transitions.getAutoHeightDuration(t);e.style.transitionDuration=`${n}ms`,B.current=n}else e.style.transitionDuration="string"==typeof n?n:`${n}ms`;e.style[k]=I,e.style.transitionTimingFunction=r,g&&g(e)});return s.jsx(b,{in:u,onEnter:L,onEntered:O,onEntering:U,onExit:D,onExited:N,onExiting:j,addEndListener:e=>{"auto"===v&&S.start(B.current||0,e),r&&r(T.current,e)},nodeRef:T,timeout:"auto"===v?null:v,...w,children:(e,{ownerState:t,...n})=>s.jsx(ud,{as:l,className:Co(_.root,i,{entered:_.entered,exited:!u&&"0px"===I&&_.hidden}[e]),style:{[R?"minWidth":"minHeight"]:I,...y},ref:P,ownerState:{...x,state:e},...n,children:s.jsx(dd,{ownerState:{...x,state:e},className:_.wrapper,ref:E,children:s.jsx(Ad,{ownerState:{...x,state:e},className:_.wrapperInner,children:o})})})})});function pd(e){return Eo("MuiPaper",e)}hd&&(hd.muiSupportAuto=!0),Bo("MuiPaper",["root","rounded","outlined","elevation","elevation0","elevation1","elevation2","elevation3","elevation4","elevation5","elevation6","elevation7","elevation8","elevation9","elevation10","elevation11","elevation12","elevation13","elevation14","elevation15","elevation16","elevation17","elevation18","elevation19","elevation20","elevation21","elevation22","elevation23","elevation24"]);const fd=la("div",{name:"MuiPaper",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:n}=e;return[t.root,t[n.variant],!n.square&&t.rounded,"elevation"===n.variant&&t[`elevation${n.elevation}`]]}})(Su(({theme:e})=>({backgroundColor:(e.vars||e).palette.background.paper,color:(e.vars||e).palette.text.primary,transition:e.transitions.create("box-shadow"),variants:[{props:({ownerState:e})=>!e.square,style:{borderRadius:e.shape.borderRadius}},{props:{variant:"outlined"},style:{border:`1px solid ${(e.vars||e).palette.divider}`}},{props:{variant:"elevation"},style:{boxShadow:"var(--Paper-shadow)",backgroundImage:"var(--Paper-overlay)"}}]}))),gd=pe.forwardRef(function(e,t){const n=Eu({props:e,name:"MuiPaper"}),r=ia(),{className:o,component:i="div",elevation:a=1,square:l=!1,variant:c="elevation",...u}=n,d={...n,component:i,elevation:a,square:l,variant:c},A=(e=>{const{square:t,elevation:n,variant:r,classes:o}=e;return Ti({root:["root",r,!t&&"rounded","elevation"===r&&`elevation${n}`]},pd,o)})(d);return s.jsx(fd,{as:i,ownerState:d,className:Co(A.root,o),ref:t,...u,style:{..."elevation"===c&&{"--Paper-shadow":(r.vars||r).shadows[a],...r.vars&&{"--Paper-overlay":r.vars.overlays?.[a]},...!r.vars&&"dark"===r.palette.mode&&{"--Paper-overlay":`linear-gradient(${Ko("#fff",zs(a))}, ${Ko("#fff",zs(a))})`}},...u.style}})});function md(e){return"string"==typeof e}function yd(e,t,n){return void 0===e||md(e)?t:{...t,ownerState:{...t.ownerState,...n}}}function vd(e,t,n){return"function"==typeof e?e(t,n):e}function bd(e,t=[]){if(void 0===e)return{};const n={};return Object.keys(e).filter(n=>n.match(/^on[A-Z]/)&&"function"==typeof e[n]&&!t.includes(n)).forEach(t=>{n[t]=e[t]}),n}function wd(e){if(void 0===e)return{};const t={};return Object.keys(e).filter(t=>!(t.match(/^on[A-Z]/)&&"function"==typeof e[t])).forEach(n=>{t[n]=e[n]}),t}function xd(e){const{getSlotProps:t,additionalProps:n,externalSlotProps:r,externalForwardedProps:o,className:i}=e;if(!t){const e=Co(n?.className,i,o?.className,r?.className),t={...n?.style,...o?.style,...r?.style},s={...n,...o,...r};return e.length>0&&(s.className=e),Object.keys(t).length>0&&(s.style=t),{props:s,internalRef:void 0}}const s=bd({...o,...r}),a=wd(r),l=wd(o),c=t(s),u=Co(c?.className,n?.className,i,o?.className,r?.className),d={...c?.style,...n?.style,...o?.style,...r?.style},A={...c,...n,...l,...a};return u.length>0&&(A.className=u),Object.keys(d).length>0&&(A.style=d),{props:A,internalRef:c.ref}}function _d(e,t){const{className:n,elementType:r,ownerState:o,externalForwardedProps:i,internalForwardedProps:s,shouldForwardComponentProp:a=!1,...l}=t,{component:c,slots:u={[e]:void 0},slotProps:d={[e]:void 0},...A}=i,h=u[e]||r,p=vd(d[e],o),{props:{component:f,...g},internalRef:m}=xd({className:n,...l,externalForwardedProps:"root"===e?A:void 0,externalSlotProps:p}),y=Ou(m,p?.ref,t.ref),v="root"===e?f||c:f;return[h,yd(h,{..."root"===e&&!c&&!u[e]&&s,..."root"!==e&&!u[e]&&s,...g,...v&&!a&&{as:v},...v&&a&&{component:v},ref:y},o)]}function Cd(e){try{return e.matches(":focus-visible")}catch(t){}return!1}class Sd{static create(){return new Sd}static use(){const e=rd(Sd.create).current,[t,n]=pe.useState(!1);return e.shouldMount=t,e.setShouldMount=n,pe.useEffect(e.mountEffect,[t]),e}constructor(){this.ref={current:null},this.mounted=null,this.didMount=!1,this.shouldMount=!1,this.setShouldMount=null}mount(){return this.mounted||(this.mounted=function(){let e,t;const n=new Promise((n,r)=>{e=n,t=r});return n.resolve=e,n.reject=t,n}(),this.shouldMount=!0,this.setShouldMount(this.shouldMount)),this.mounted}mountEffect=()=>{this.shouldMount&&!this.didMount&&null!==this.ref.current&&(this.didMount=!0,this.mounted.resolve())};start(...e){this.mount().then(()=>this.ref.current?.start(...e))}stop(...e){this.mount().then(()=>this.ref.current?.stop(...e))}pulsate(...e){this.mount().then(()=>this.ref.current?.pulsate(...e))}}const Ed=Bo("MuiTouchRipple",["root","ripple","rippleVisible","ripplePulsate","child","childLeaving","childPulsate"]),Bd=Un`
  0% {
    transform: scale(0);
    opacity: 0.1;
  }

  100% {
    transform: scale(1);
    opacity: 0.3;
  }
`,Id=Un`
  0% {
    opacity: 1;
  }

  100% {
    opacity: 0;
  }
`,Rd=Un`
  0% {
    transform: scale(1);
  }

  50% {
    transform: scale(0.92);
  }

  100% {
    transform: scale(1);
  }
`,kd=la("span",{name:"MuiTouchRipple",slot:"Root"})({overflow:"hidden",pointerEvents:"none",position:"absolute",zIndex:0,top:0,right:0,bottom:0,left:0,borderRadius:"inherit"}),Td=la(function(e){const{className:t,classes:n,pulsate:r=!1,rippleX:o,rippleY:i,rippleSize:a,in:l,onExited:c,timeout:u}=e,[d,A]=pe.useState(!1),h=Co(t,n.ripple,n.rippleVisible,r&&n.ripplePulsate),p={width:a,height:a,top:-a/2+i,left:-a/2+o},f=Co(n.child,d&&n.childLeaving,r&&n.childPulsate);return l||d||A(!0),pe.useEffect(()=>{if(!l&&null!=c){const e=setTimeout(c,u);return()=>{clearTimeout(e)}}},[c,l,u]),s.jsx("span",{className:h,style:p,children:s.jsx("span",{className:f})})},{name:"MuiTouchRipple",slot:"Ripple"})`
  opacity: 0;
  position: absolute;

  &.${Ed.rippleVisible} {
    opacity: 0.3;
    transform: scale(1);
    animation-name: ${Bd};
    animation-duration: ${550}ms;
    animation-timing-function: ${({theme:e})=>e.transitions.easing.easeInOut};
  }

  &.${Ed.ripplePulsate} {
    animation-duration: ${({theme:e})=>e.transitions.duration.shorter}ms;
  }

  & .${Ed.child} {
    opacity: 1;
    display: block;
    width: 100%;
    height: 100%;
    border-radius: 50%;
    background-color: currentColor;
  }

  & .${Ed.childLeaving} {
    opacity: 0;
    animation-name: ${Id};
    animation-duration: ${550}ms;
    animation-timing-function: ${({theme:e})=>e.transitions.easing.easeInOut};
  }

  & .${Ed.childPulsate} {
    position: absolute;
    /* @noflip */
    left: 0px;
    top: 0;
    animation-name: ${Rd};
    animation-duration: 2500ms;
    animation-timing-function: ${({theme:e})=>e.transitions.easing.easeInOut};
    animation-iteration-count: infinite;
    animation-delay: 200ms;
  }
`,Pd=pe.forwardRef(function(e,t){const n=Eu({props:e,name:"MuiTouchRipple"}),{center:r=!1,classes:o={},className:i,...a}=n,[l,c]=pe.useState([]),u=pe.useRef(0),d=pe.useRef(null);pe.useEffect(()=>{d.current&&(d.current(),d.current=null)},[l]);const A=pe.useRef(!1),h=sd(),p=pe.useRef(null),f=pe.useRef(null),g=pe.useCallback(e=>{const{pulsate:t,rippleX:n,rippleY:r,rippleSize:i,cb:a}=e;c(e=>[...e,s.jsx(Td,{classes:{ripple:Co(o.ripple,Ed.ripple),rippleVisible:Co(o.rippleVisible,Ed.rippleVisible),ripplePulsate:Co(o.ripplePulsate,Ed.ripplePulsate),child:Co(o.child,Ed.child),childLeaving:Co(o.childLeaving,Ed.childLeaving),childPulsate:Co(o.childPulsate,Ed.childPulsate)},timeout:550,pulsate:t,rippleX:n,rippleY:r,rippleSize:i},u.current)]),u.current+=1,d.current=a},[o]),m=pe.useCallback((e={},t={},n=()=>{})=>{const{pulsate:o=!1,center:i=r||t.pulsate,fakeElement:s=!1}=t;if("mousedown"===e?.type&&A.current)return void(A.current=!1);"touchstart"===e?.type&&(A.current=!0);const a=s?null:f.current,l=a?a.getBoundingClientRect():{width:0,height:0,left:0,top:0};let c,u,d;if(i||void 0===e||0===e.clientX&&0===e.clientY||!e.clientX&&!e.touches)c=Math.round(l.width/2),u=Math.round(l.height/2);else{const{clientX:t,clientY:n}=e.touches&&e.touches.length>0?e.touches[0]:e;c=Math.round(t-l.left),u=Math.round(n-l.top)}if(i)d=Math.sqrt((2*l.width**2+l.height**2)/3),d%2==0&&(d+=1);else{const e=2*Math.max(Math.abs((a?a.clientWidth:0)-c),c)+2,t=2*Math.max(Math.abs((a?a.clientHeight:0)-u),u)+2;d=Math.sqrt(e**2+t**2)}e?.touches?null===p.current&&(p.current=()=>{g({pulsate:o,rippleX:c,rippleY:u,rippleSize:d,cb:n})},h.start(80,()=>{p.current&&(p.current(),p.current=null)})):g({pulsate:o,rippleX:c,rippleY:u,rippleSize:d,cb:n})},[r,g,h]),y=pe.useCallback(()=>{m({},{pulsate:!0})},[m]),v=pe.useCallback((e,t)=>{if(h.clear(),"touchend"===e?.type&&p.current)return p.current(),p.current=null,void h.start(0,()=>{v(e,t)});p.current=null,c(e=>e.length>0?e.slice(1):e),d.current=t},[h]);return pe.useImperativeHandle(t,()=>({pulsate:y,start:m,stop:v}),[y,m,v]),s.jsx(kd,{className:Co(Ed.root,o.root,i),ref:f,...a,children:s.jsx(td,{component:null,exit:!0,children:l})})});function Fd(e){return Eo("MuiButtonBase",e)}const Md=Bo("MuiButtonBase",["root","disabled","focusVisible"]),Ld=la("button",{name:"MuiButtonBase",slot:"Root"})({display:"inline-flex",alignItems:"center",justifyContent:"center",position:"relative",boxSizing:"border-box",WebkitTapHighlightColor:"transparent",backgroundColor:"transparent",outline:0,border:0,margin:0,borderRadius:0,padding:0,cursor:"pointer",userSelect:"none",verticalAlign:"middle",MozAppearance:"none",WebkitAppearance:"none",textDecoration:"none",color:"inherit","&::-moz-focus-inner":{borderStyle:"none"},[`&.${Md.disabled}`]:{pointerEvents:"none",cursor:"default"},"@media print":{colorAdjust:"exact"}}),Ud=pe.forwardRef(function(e,t){const n=Eu({props:e,name:"MuiButtonBase"}),{action:r,centerRipple:o=!1,children:i,className:a,component:l="button",disabled:c=!1,disableRipple:u=!1,disableTouchRipple:d=!1,focusRipple:A=!1,focusVisibleClassName:h,LinkComponent:p="a",onBlur:f,onClick:g,onContextMenu:m,onDragLeave:y,onFocus:v,onFocusVisible:b,onKeyDown:w,onKeyUp:x,onMouseDown:_,onMouseLeave:C,onMouseUp:S,onTouchEnd:E,onTouchMove:B,onTouchStart:I,tabIndex:R=0,TouchRippleProps:k,touchRippleRef:T,type:P,...F}=n,M=pe.useRef(null),L=Sd.use(),U=Ou(L.ref,T),[O,D]=pe.useState(!1);c&&O&&D(!1),pe.useImperativeHandle(r,()=>({focusVisible:()=>{D(!0),M.current.focus()}}),[]);const N=L.shouldMount&&!u&&!c;pe.useEffect(()=>{O&&A&&!u&&L.pulsate()},[u,A,O,L]);const j=Od(L,"start",_,d),Q=Od(L,"stop",m,d),z=Od(L,"stop",y,d),H=Od(L,"stop",S,d),G=Od(L,"stop",e=>{O&&e.preventDefault(),C&&C(e)},d),V=Od(L,"start",I,d),W=Od(L,"stop",E,d),$=Od(L,"stop",B,d),K=Od(L,"stop",e=>{Cd(e.target)||D(!1),f&&f(e)},!1),X=Uu(e=>{M.current||(M.current=e.currentTarget),Cd(e.target)&&(D(!0),b&&b(e)),v&&v(e)}),Y=()=>{const e=M.current;return l&&"button"!==l&&!("A"===e.tagName&&e.href)},q=Uu(e=>{A&&!e.repeat&&O&&" "===e.key&&L.stop(e,()=>{L.start(e)}),e.target===e.currentTarget&&Y()&&" "===e.key&&e.preventDefault(),w&&w(e),e.target===e.currentTarget&&Y()&&"Enter"===e.key&&!c&&(e.preventDefault(),g&&g(e))}),J=Uu(e=>{A&&" "===e.key&&O&&!e.defaultPrevented&&L.stop(e,()=>{L.pulsate(e)}),x&&x(e),g&&e.target===e.currentTarget&&Y()&&" "===e.key&&!e.defaultPrevented&&g(e)});let Z=l;"button"===Z&&(F.href||F.to)&&(Z=p);const ee={};"button"===Z?(ee.type=void 0===P?"button":P,ee.disabled=c):(F.href||F.to||(ee.role="button"),c&&(ee["aria-disabled"]=c));const te=Ou(t,M),ne={...n,centerRipple:o,component:l,disabled:c,disableRipple:u,disableTouchRipple:d,focusRipple:A,tabIndex:R,focusVisible:O},re=(e=>{const{disabled:t,focusVisible:n,focusVisibleClassName:r,classes:o}=e,i=Ti({root:["root",t&&"disabled",n&&"focusVisible"]},Fd,o);return n&&r&&(i.root+=` ${r}`),i})(ne);return s.jsxs(Ld,{as:Z,className:Co(re.root,a),ownerState:ne,onBlur:K,onClick:g,onContextMenu:Q,onFocus:X,onKeyDown:q,onKeyUp:J,onMouseDown:j,onMouseLeave:G,onMouseUp:H,onDragLeave:z,onTouchEnd:W,onTouchMove:$,onTouchStart:V,ref:te,tabIndex:c?-1:R,type:P,...ee,...F,children:[i,N?s.jsx(Pd,{ref:U,center:o,...k}):null]})});function Od(e,t,n,r=!1){return Uu(o=>(n&&n(o),r||e[t](o),!0))}function Dd(e=[]){return([,t])=>t&&function(e,t=[]){if(!function(e){return"string"==typeof e.main}(e))return!1;for(const n of t)if(!e.hasOwnProperty(n)||"string"!=typeof e[n])return!1;return!0}(t,e)}function Nd(e){return Eo("MuiAlert",e)}const jd=Bo("MuiAlert",["root","action","icon","message","filled","colorSuccess","colorInfo","colorWarning","colorError","filledSuccess","filledInfo","filledWarning","filledError","outlined","outlinedSuccess","outlinedInfo","outlinedWarning","outlinedError","standard","standardSuccess","standardInfo","standardWarning","standardError"]);function Qd(e){return Eo("MuiCircularProgress",e)}Bo("MuiCircularProgress",["root","determinate","indeterminate","colorPrimary","colorSecondary","svg","circle","circleDeterminate","circleIndeterminate","circleDisableShrink"]);const zd=44,Hd=Un`
  0% {
    transform: rotate(0deg);
  }

  100% {
    transform: rotate(360deg);
  }
`,Gd=Un`
  0% {
    stroke-dasharray: 1px, 200px;
    stroke-dashoffset: 0;
  }

  50% {
    stroke-dasharray: 100px, 200px;
    stroke-dashoffset: -15px;
  }

  100% {
    stroke-dasharray: 1px, 200px;
    stroke-dashoffset: -126px;
  }
`,Vd="string"!=typeof Hd?Ln`
        animation: ${Hd} 1.4s linear infinite;
      `:null,Wd="string"!=typeof Gd?Ln`
        animation: ${Gd} 1.4s ease-in-out infinite;
      `:null,$d=la("span",{name:"MuiCircularProgress",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:n}=e;return[t.root,t[n.variant],t[`color${vr(n.color)}`]]}})(Su(({theme:e})=>({display:"inline-block",variants:[{props:{variant:"determinate"},style:{transition:e.transitions.create("transform")}},{props:{variant:"indeterminate"},style:Vd||{animation:`${Hd} 1.4s linear infinite`}},...Object.entries(e.palette).filter(Dd()).map(([t])=>({props:{color:t},style:{color:(e.vars||e).palette[t].main}}))]}))),Kd=la("svg",{name:"MuiCircularProgress",slot:"Svg"})({display:"block"}),Xd=la("circle",{name:"MuiCircularProgress",slot:"Circle",overridesResolver:(e,t)=>{const{ownerState:n}=e;return[t.circle,t[`circle${vr(n.variant)}`],n.disableShrink&&t.circleDisableShrink]}})(Su(({theme:e})=>({stroke:"currentColor",variants:[{props:{variant:"determinate"},style:{transition:e.transitions.create("stroke-dashoffset")}},{props:{variant:"indeterminate"},style:{strokeDasharray:"80px, 200px",strokeDashoffset:0}},{props:({ownerState:e})=>"indeterminate"===e.variant&&!e.disableShrink,style:Wd||{animation:`${Gd} 1.4s ease-in-out infinite`}}]}))),Yd=pe.forwardRef(function(e,t){const n=Eu({props:e,name:"MuiCircularProgress"}),{className:r,color:o="primary",disableShrink:i=!1,size:a=40,style:l,thickness:c=3.6,value:u=0,variant:d="indeterminate",...A}=n,h={...n,color:o,disableShrink:i,size:a,thickness:c,value:u,variant:d},p=(e=>{const{classes:t,variant:n,color:r,disableShrink:o}=e;return Ti({root:["root",n,`color${vr(r)}`],svg:["svg"],circle:["circle",`circle${vr(n)}`,o&&"circleDisableShrink"]},Qd,t)})(h),f={},g={},m={};if("determinate"===d){const e=2*Math.PI*((zd-c)/2);f.strokeDasharray=e.toFixed(3),m["aria-valuenow"]=Math.round(u),f.strokeDashoffset=`${((100-u)/100*e).toFixed(3)}px`,g.transform="rotate(-90deg)"}return s.jsx($d,{className:Co(p.root,r),style:{width:a,height:a,...g,...l},ownerState:h,ref:t,role:"progressbar",...m,...A,children:s.jsx(Kd,{className:p.svg,ownerState:h,viewBox:"22 22 44 44",children:s.jsx(Xd,{className:p.circle,style:f,ownerState:h,cx:zd,cy:zd,r:(zd-c)/2,fill:"none",strokeWidth:c})})})});function qd(e){return Eo("MuiIconButton",e)}const Jd=Bo("MuiIconButton",["root","disabled","colorInherit","colorPrimary","colorSecondary","colorError","colorInfo","colorSuccess","colorWarning","edgeStart","edgeEnd","sizeSmall","sizeMedium","sizeLarge","loading","loadingIndicator","loadingWrapper"]),Zd=la(Ud,{name:"MuiIconButton",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:n}=e;return[t.root,n.loading&&t.loading,"default"!==n.color&&t[`color${vr(n.color)}`],n.edge&&t[`edge${vr(n.edge)}`],t[`size${vr(n.size)}`]]}})(Su(({theme:e})=>({textAlign:"center",flex:"0 0 auto",fontSize:e.typography.pxToRem(24),padding:8,borderRadius:"50%",color:(e.vars||e).palette.action.active,transition:e.transitions.create("background-color",{duration:e.transitions.duration.shortest}),variants:[{props:e=>!e.disableRipple,style:{"--IconButton-hoverBg":e.alpha((e.vars||e).palette.action.active,(e.vars||e).palette.action.hoverOpacity),"&:hover":{backgroundColor:"var(--IconButton-hoverBg)","@media (hover: none)":{backgroundColor:"transparent"}}}},{props:{edge:"start"},style:{marginLeft:-12}},{props:{edge:"start",size:"small"},style:{marginLeft:-3}},{props:{edge:"end"},style:{marginRight:-12}},{props:{edge:"end",size:"small"},style:{marginRight:-3}}]})),Su(({theme:e})=>({variants:[{props:{color:"inherit"},style:{color:"inherit"}},...Object.entries(e.palette).filter(Dd()).map(([t])=>({props:{color:t},style:{color:(e.vars||e).palette[t].main}})),...Object.entries(e.palette).filter(Dd()).map(([t])=>({props:{color:t},style:{"--IconButton-hoverBg":e.alpha((e.vars||e).palette[t].main,(e.vars||e).palette.action.hoverOpacity)}})),{props:{size:"small"},style:{padding:5,fontSize:e.typography.pxToRem(18)}},{props:{size:"large"},style:{padding:12,fontSize:e.typography.pxToRem(28)}}],[`&.${Jd.disabled}`]:{backgroundColor:"transparent",color:(e.vars||e).palette.action.disabled},[`&.${Jd.loading}`]:{color:"transparent"}}))),eA=la("span",{name:"MuiIconButton",slot:"LoadingIndicator"})(({theme:e})=>({display:"none",position:"absolute",visibility:"visible",top:"50%",left:"50%",transform:"translate(-50%, -50%)",color:(e.vars||e).palette.action.disabled,variants:[{props:{loading:!0},style:{display:"flex"}}]})),tA=pe.forwardRef(function(e,t){const n=Eu({props:e,name:"MuiIconButton"}),{edge:r=!1,children:o,className:i,color:a="default",disabled:l=!1,disableFocusRipple:c=!1,size:u="medium",id:d,loading:A=null,loadingIndicator:h,...p}=n,f=pi(d),g=h??s.jsx(Yd,{"aria-labelledby":f,color:"inherit",size:16}),m={...n,edge:r,color:a,disabled:l,disableFocusRipple:c,loading:A,loadingIndicator:g,size:u},y=(e=>{const{classes:t,disabled:n,color:r,edge:o,size:i,loading:s}=e;return Ti({root:["root",s&&"loading",n&&"disabled","default"!==r&&`color${vr(r)}`,o&&`edge${vr(o)}`,`size${vr(i)}`],loadingIndicator:["loadingIndicator"],loadingWrapper:["loadingWrapper"]},qd,t)})(m);return s.jsxs(Zd,{id:A?f:d,className:Co(y.root,i),centerRipple:!0,focusRipple:!c,disabled:l||A,ref:t,...p,ownerState:m,children:["boolean"==typeof A&&s.jsx("span",{className:y.loadingWrapper,style:{display:"contents"},children:s.jsx(eA,{className:y.loadingIndicator,ownerState:m,children:A&&g})}),o]})}),nA=ku(s.jsx("path",{d:"M20,12A8,8 0 0,1 12,20A8,8 0 0,1 4,12A8,8 0 0,1 12,4C12.76,4 13.5,4.11 14.2, 4.31L15.77,2.74C14.61,2.26 13.34,2 12,2A10,10 0 0,0 2,12A10,10 0 0,0 12,22A10,10 0 0, 0 22,12M7.91,10.08L6.5,11.5L11,16L21,6L19.59,4.58L11,13.17L7.91,10.08Z"})),rA=ku(s.jsx("path",{d:"M12 5.99L19.53 19H4.47L12 5.99M12 2L1 21h22L12 2zm1 14h-2v2h2v-2zm0-6h-2v4h2v-4z"})),oA=ku(s.jsx("path",{d:"M11 15h2v2h-2zm0-8h2v6h-2zm.99-5C6.47 2 2 6.48 2 12s4.47 10 9.99 10C17.52 22 22 17.52 22 12S17.52 2 11.99 2zM12 20c-4.42 0-8-3.58-8-8s3.58-8 8-8 8 3.58 8 8-3.58 8-8 8z"})),iA=ku(s.jsx("path",{d:"M11,9H13V7H11M12,20C7.59,20 4,16.41 4,12C4,7.59 7.59,4 12,4C16.41,4 20,7.59 20, 12C20,16.41 16.41,20 12,20M12,2A10,10 0 0,0 2,12A10,10 0 0,0 12,22A10,10 0 0,0 22,12A10, 10 0 0,0 12,2M11,17H13V11H11V17Z"})),sA=ku(s.jsx("path",{d:"M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"})),aA=la(gd,{name:"MuiAlert",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:n}=e;return[t.root,t[n.variant],t[`${n.variant}${vr(n.color||n.severity)}`]]}})(Su(({theme:e})=>{const t="light"===e.palette.mode?e.darken:e.lighten,n="light"===e.palette.mode?e.lighten:e.darken;return{...e.typography.body2,backgroundColor:"transparent",display:"flex",padding:"6px 16px",variants:[...Object.entries(e.palette).filter(Dd(["light"])).map(([r])=>({props:{colorSeverity:r,variant:"standard"},style:{color:e.vars?e.vars.palette.Alert[`${r}Color`]:t(e.palette[r].light,.6),backgroundColor:e.vars?e.vars.palette.Alert[`${r}StandardBg`]:n(e.palette[r].light,.9),[`& .${jd.icon}`]:e.vars?{color:e.vars.palette.Alert[`${r}IconColor`]}:{color:e.palette[r].main}}})),...Object.entries(e.palette).filter(Dd(["light"])).map(([n])=>({props:{colorSeverity:n,variant:"outlined"},style:{color:e.vars?e.vars.palette.Alert[`${n}Color`]:t(e.palette[n].light,.6),border:`1px solid ${(e.vars||e).palette[n].light}`,[`& .${jd.icon}`]:e.vars?{color:e.vars.palette.Alert[`${n}IconColor`]}:{color:e.palette[n].main}}})),...Object.entries(e.palette).filter(Dd(["dark"])).map(([t])=>({props:{colorSeverity:t,variant:"filled"},style:{fontWeight:e.typography.fontWeightMedium,...e.vars?{color:e.vars.palette.Alert[`${t}FilledColor`],backgroundColor:e.vars.palette.Alert[`${t}FilledBg`]}:{backgroundColor:"dark"===e.palette.mode?e.palette[t].dark:e.palette[t].main,color:e.palette.getContrastText(e.palette[t].main)}}}))]}})),lA=la("div",{name:"MuiAlert",slot:"Icon"})({marginRight:12,padding:"7px 0",display:"flex",fontSize:22,opacity:.9}),cA=la("div",{name:"MuiAlert",slot:"Message"})({padding:"8px 0",minWidth:0,overflow:"auto"}),uA=la("div",{name:"MuiAlert",slot:"Action"})({display:"flex",alignItems:"flex-start",padding:"4px 0 0 16px",marginLeft:"auto",marginRight:-8}),dA={success:s.jsx(nA,{fontSize:"inherit"}),warning:s.jsx(rA,{fontSize:"inherit"}),error:s.jsx(oA,{fontSize:"inherit"}),info:s.jsx(iA,{fontSize:"inherit"})},AA=pe.forwardRef(function(e,t){const n=Eu({props:e,name:"MuiAlert"}),{action:r,children:o,className:i,closeText:a="Close",color:l,components:c={},componentsProps:u={},icon:d,iconMapping:A=dA,onClose:h,role:p="alert",severity:f="success",slotProps:g={},slots:m={},variant:y="standard",...v}=n,b={...n,color:l,severity:f,variant:y,colorSeverity:l||f},w=(e=>{const{variant:t,color:n,severity:r,classes:o}=e;return Ti({root:["root",`color${vr(n||r)}`,`${t}${vr(n||r)}`,`${t}`],icon:["icon"],message:["message"],action:["action"]},Nd,o)})(b),x={slots:{closeButton:c.CloseButton,closeIcon:c.CloseIcon,...m},slotProps:{...u,...g}},[_,C]=_d("root",{ref:t,shouldForwardComponentProp:!0,className:Co(w.root,i),elementType:aA,externalForwardedProps:{...x,...v},ownerState:b,additionalProps:{role:p,elevation:0}}),[S,E]=_d("icon",{className:w.icon,elementType:lA,externalForwardedProps:x,ownerState:b}),[B,I]=_d("message",{className:w.message,elementType:cA,externalForwardedProps:x,ownerState:b}),[R,k]=_d("action",{className:w.action,elementType:uA,externalForwardedProps:x,ownerState:b}),[T,P]=_d("closeButton",{elementType:tA,externalForwardedProps:x,ownerState:b}),[F,M]=_d("closeIcon",{elementType:sA,externalForwardedProps:x,ownerState:b});return s.jsxs(_,{...C,children:[!1!==d?s.jsx(S,{...E,children:d||A[f]||dA[f]}):null,s.jsx(B,{...I,children:o}),null!=r?s.jsx(R,{...k,children:r}):null,null==r&&h?s.jsx(R,{...k,children:s.jsx(T,{size:"small","aria-label":a,title:a,color:"inherit",onClick:h,...P,children:s.jsx(F,{fontSize:"small",...M})})}):null]})});function hA(e){return Eo("MuiTypography",e)}const pA=Bo("MuiTypography",["root","h1","h2","h3","h4","h5","h6","subtitle1","subtitle2","body1","body2","inherit","button","caption","overline","alignLeft","alignRight","alignCenter","alignJustify","noWrap","gutterBottom","paragraph"]),fA={primary:!0,secondary:!0,error:!0,info:!0,success:!0,warning:!0,textPrimary:!0,textSecondary:!0,textDisabled:!0},gA=bo,mA=la("span",{name:"MuiTypography",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:n}=e;return[t.root,n.variant&&t[n.variant],"inherit"!==n.align&&t[`align${vr(n.align)}`],n.noWrap&&t.noWrap,n.gutterBottom&&t.gutterBottom,n.paragraph&&t.paragraph]}})(Su(({theme:e})=>({margin:0,variants:[{props:{variant:"inherit"},style:{font:"inherit",lineHeight:"inherit",letterSpacing:"inherit"}},...Object.entries(e.typography).filter(([e,t])=>"inherit"!==e&&t&&"object"==typeof t).map(([e,t])=>({props:{variant:e},style:t})),...Object.entries(e.palette).filter(Dd()).map(([t])=>({props:{color:t},style:{color:(e.vars||e).palette[t].main}})),...Object.entries(e.palette?.text||{}).filter(([,e])=>"string"==typeof e).map(([t])=>({props:{color:`text${vr(t)}`},style:{color:(e.vars||e).palette.text[t]}})),{props:({ownerState:e})=>"inherit"!==e.align,style:{textAlign:"var(--Typography-textAlign)"}},{props:({ownerState:e})=>e.noWrap,style:{overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"}},{props:({ownerState:e})=>e.gutterBottom,style:{marginBottom:"0.35em"}},{props:({ownerState:e})=>e.paragraph,style:{marginBottom:16}}]}))),yA={h1:"h1",h2:"h2",h3:"h3",h4:"h4",h5:"h5",h6:"h6",subtitle1:"h6",subtitle2:"h6",body1:"p",body2:"p",inherit:"p"},vA=pe.forwardRef(function(e,t){const{color:n,...r}=Eu({props:e,name:"MuiTypography"}),o=gA({...r,...!fA[n]&&{color:n}}),{align:i="inherit",className:a,component:l,gutterBottom:c=!1,noWrap:u=!1,paragraph:d=!1,variant:A="body1",variantMapping:h=yA,...p}=o,f={...o,align:i,color:n,className:a,component:l,gutterBottom:c,noWrap:u,paragraph:d,variant:A,variantMapping:h},g=l||(d?"p":h[A]||yA[A])||"span",m=(e=>{const{align:t,gutterBottom:n,noWrap:r,paragraph:o,variant:i,classes:s}=e;return Ti({root:["root",i,"inherit"!==e.align&&`align${vr(t)}`,n&&"gutterBottom",r&&"noWrap",o&&"paragraph"]},hA,s)})(f);return s.jsx(mA,{as:g,ref:t,className:Co(m.root,a),...p,ownerState:f,style:{..."inherit"!==i&&{"--Typography-textAlign":i},...p.style}})});function bA({array1:e,array2:t,parser:n=e=>e}){return e&&t&&e.length===t.length&&e.every((e,r)=>n(e)===n(t[r]))}function wA(e){return e.normalize("NFD").replace(/[\u0300-\u036f]/g,"")}const xA=function(e={}){const{ignoreAccents:t=!0,ignoreCase:n=!0,limit:r,matchFrom:o="any",stringify:i,trim:s=!1}=e;return(e,{inputValue:a,getOptionLabel:l})=>{let c=s?a.trim():a;n&&(c=c.toLowerCase()),t&&(c=wA(c));const u=c?e.filter(e=>{let r=(i||l)(e);return n&&(r=r.toLowerCase()),t&&(r=wA(r)),"start"===o?r.startsWith(c):r.includes(c)}):e;return"number"==typeof r?u.slice(0,r):u}}(),_A=e=>null!==e.current&&e.current.parentElement?.contains(document.activeElement),CA=[];function SA(e,t,n,r){if(t||null==e||r)return"";const o=n(e);return"string"==typeof o?o:""}function EA(e){const{unstable_isActiveElementInListbox:t=_A,unstable_classNamePrefix:n="Mui",autoComplete:r=!1,autoHighlight:o=!1,autoSelect:i=!1,blurOnSelect:s=!1,clearOnBlur:a=!e.freeSolo,clearOnEscape:l=!1,componentName:c="useAutocomplete",defaultValue:u=(e.multiple?CA:null),disableClearable:d=!1,disableCloseOnSelect:A=!1,disabled:h,disabledItemsFocusable:p=!1,disableListWrap:f=!1,filterOptions:g=xA,filterSelectedOptions:m=!1,freeSolo:y=!1,getOptionDisabled:v,getOptionKey:b,getOptionLabel:w=e=>e.label??e,groupBy:x,handleHomeEndKeys:_=!e.freeSolo,id:C,includeInputInList:S=!1,inputValue:E,isOptionEqualToValue:B=(e,t)=>e===t,multiple:I=!1,onChange:R,onClose:k,onHighlightChange:T,onInputChange:P,onOpen:F,open:M,openOnFocus:L=!1,options:U,readOnly:O=!1,renderValue:D,selectOnFocus:N=!e.freeSolo,value:j}=e,Q=pi(C);let z=w;z=e=>{const t=w(e);return"string"!=typeof t?String(t):t};const H=pe.useRef(!1),G=pe.useRef(!0),V=pe.useRef(null),W=pe.useRef(null),[$,K]=pe.useState(null),[X,Y]=pe.useState(-1),q=o?0:-1,J=pe.useRef(q),Z=pe.useRef(SA(u??j,I,z)).current,[ee,te]=Lu({controlled:j,default:u,name:c}),[ne,re]=Lu({controlled:E,default:Z,name:c,state:"inputValue"}),[oe,ie]=pe.useState(!1),se=pe.useCallback((e,t,n)=>{if(!(I?ee.length<t.length:null!==t)&&!a)return;const r=SA(t,I,z,D);ne!==r&&(re(r),P&&P(e,r,n))},[z,ne,I,P,re,a,ee,D]),[ae,le]=Lu({controlled:M,default:!1,name:c,state:"open"}),[ce,ue]=pe.useState(!0),de=!I&&null!=ee&&ne===z(ee),Ae=ae&&!O,he=Ae?g(U.filter(e=>!m||!(I?ee:[ee]).some(t=>null!==t&&B(e,t))),{inputValue:de&&ce?"":ne,getOptionLabel:z}):[],fe=(e=>{const t=pe.useRef({});return pe.useEffect(()=>{t.current=e}),t.current})({filteredOptions:he,value:ee,inputValue:ne});pe.useEffect(()=>{const e=ee!==fe.value;oe&&!e||y&&!e||se(null,ee,"reset")},[ee,se,oe,fe.value,y]);const ge=ae&&he.length>0&&!O,me=Uu(e=>{if(-1===e)V.current.focus();else{const t=D?"data-item-index":"data-tag-index";$.querySelector(`[${t}="${e}"]`).focus()}});pe.useEffect(()=>{I&&X>ee.length-1&&(Y(-1),me(-1))},[ee,I,X,me]);const ye=Uu(({event:e,index:t,reason:r})=>{if(J.current=t,-1===t?V.current.removeAttribute("aria-activedescendant"):V.current.setAttribute("aria-activedescendant",`${Q}-option-${t}`),T&&["mouse","keyboard","touch"].includes(r)&&T(e,-1===t?null:he[t],r),!W.current)return;const o=W.current.querySelector(`[role="option"].${n}-focused`);o&&(o.classList.remove(`${n}-focused`),o.classList.remove(`${n}-focusVisible`));let i=W.current;if("listbox"!==W.current.getAttribute("role")&&(i=W.current.parentElement.querySelector('[role="listbox"]')),!i)return;if(-1===t)return void(i.scrollTop=0);const s=W.current.querySelector(`[data-option-index="${t}"]`);if(s&&(s.classList.add(`${n}-focused`),"keyboard"===r&&s.classList.add(`${n}-focusVisible`),i.scrollHeight>i.clientHeight&&"mouse"!==r&&"touch"!==r)){const e=s,t=i.clientHeight+i.scrollTop,n=e.offsetTop+e.offsetHeight;n>t?i.scrollTop=n-i.clientHeight:e.offsetTop-e.offsetHeight*(x?1.3:0)<i.scrollTop&&(i.scrollTop=e.offsetTop-e.offsetHeight*(x?1.3:0))}}),ve=Uu(({event:e,diff:t,direction:n="next",reason:o})=>{if(!Ae)return;const i=function(e,t){if(!W.current||e<0||e>=he.length)return-1;let n=e;for(;;){const r=W.current.querySelector(`[data-option-index="${n}"]`),o=!p&&(!r||r.disabled||"true"===r.getAttribute("aria-disabled"));if(r&&r.hasAttribute("tabindex")&&!o)return n;if(n="next"===t?(n+1)%he.length:(n-1+he.length)%he.length,n===e)return-1}}((()=>{const e=he.length-1;if("reset"===t)return q;if("start"===t)return 0;if("end"===t)return e;const n=J.current+t;return n<0?-1===n&&S?-1:f&&-1!==J.current||Math.abs(t)>1?0:e:n>e?n===e+1&&S?-1:f||Math.abs(t)>1?e:0:n})(),n);if(ye({index:i,reason:o,event:e}),r&&"reset"!==t)if(-1===i)V.current.value=ne;else{const e=z(he[i]);V.current.value=e;0===e.toLowerCase().indexOf(ne.toLowerCase())&&ne.length>0&&V.current.setSelectionRange(ne.length,e.length)}}),be=!bA({array1:fe.filteredOptions,array2:he,parser:z}),we=pe.useCallback(()=>{if(!Ae)return;const e=(()=>{if(-1!==J.current&&!bA({array1:fe.filteredOptions,array2:he,parser:z})&&fe.inputValue===ne&&(I?ee.length===fe.value.length&&fe.value.every((e,t)=>z(ee[t])===z(e)):(e=fe.value,t=ee,(e?z(e):"")===(t?z(t):"")))){const e=fe.filteredOptions[J.current];if(e)return he.findIndex(t=>z(t)===z(e))}var e,t;return-1})();if(-1!==e)return void(J.current=e);const t=I?ee[0]:ee;if(0!==he.length&&null!=t){if(W.current){if(null!=t){const e=he[J.current];if(I&&e&&-1!==ee.findIndex(t=>B(e,t)))return;const n=he.findIndex(e=>B(e,t));return void(-1===n?ve({diff:"reset"}):ye({index:n}))}J.current>=he.length-1?ye({index:he.length-1}):ye({index:J.current})}}else ve({diff:"reset"})},[he.length,!I&&ee,m,ve,ye,Ae,ne,I]),xe=Uu(e=>{Mu(W,e),e&&we()});pe.useEffect(()=>{be&&we()},[we,be]);const _e=e=>{ae||(le(!0),ue(!0),F&&F(e))},Ce=(e,t)=>{ae&&(le(!1),k&&k(e,t))},Se=(e,t,n,r)=>{if(I){if(ee.length===t.length&&ee.every((e,n)=>e===t[n]))return}else if(ee===t)return;R&&R(e,t,n,r),te(t)},Ee=pe.useRef(!1),Be=(e,t,n="selectOption",r="options")=>{let o=n,i=t;if(I){i=Array.isArray(ee)?ee.slice():[];const e=i.findIndex(e=>B(t,e));-1===e?i.push(t):"freeSolo"!==r&&(i.splice(e,1),o="removeOption")}se(e,i,o),Se(e,i,o,{option:t}),A||e&&(e.ctrlKey||e.metaKey)||Ce(e,o),(!0===s||"touch"===s&&Ee.current||"mouse"===s&&!Ee.current)&&V.current.blur()};const Ie=(e,t)=>{if(!I)return;""===ne&&Ce(e,"toggleInput");let n=X;-1===X?""===ne&&"previous"===t&&(n=ee.length-1):(n+="next"===t?1:-1,n<0&&(n=0),n===ee.length&&(n=-1)),n=function(e,t){if(-1===e)return-1;let n=e;for(;;){if("next"===t&&n===ee.length||"previous"===t&&-1===n)return-1;const e=D?"data-item-index":"data-tag-index",r=$.querySelector(`[${e}="${n}"]`);if(r&&r.hasAttribute("tabindex")&&!r.disabled&&"true"!==r.getAttribute("aria-disabled"))return n;n+="next"===t?1:-1}}(n,t),Y(n),me(n)},Re=e=>{H.current=!0,re(""),P&&P(e,"","clear"),Se(e,I?[]:null,"clear")},ke=e=>t=>{if(e.onKeyDown&&e.onKeyDown(t),!t.defaultMuiPrevented&&(-1===X||["ArrowLeft","ArrowRight"].includes(t.key)||(Y(-1),me(-1)),229!==t.which))switch(t.key){case"Home":Ae&&_&&(t.preventDefault(),ve({diff:"start",direction:"next",reason:"keyboard",event:t}));break;case"End":Ae&&_&&(t.preventDefault(),ve({diff:"end",direction:"previous",reason:"keyboard",event:t}));break;case"PageUp":t.preventDefault(),ve({diff:-5,direction:"previous",reason:"keyboard",event:t}),_e(t);break;case"PageDown":t.preventDefault(),ve({diff:5,direction:"next",reason:"keyboard",event:t}),_e(t);break;case"ArrowDown":t.preventDefault(),ve({diff:1,direction:"next",reason:"keyboard",event:t}),_e(t);break;case"ArrowUp":t.preventDefault(),ve({diff:-1,direction:"previous",reason:"keyboard",event:t}),_e(t);break;case"ArrowLeft":!I&&D?me(0):Ie(t,"previous");break;case"ArrowRight":!I&&D?me(-1):Ie(t,"next");break;case"Enter":if(-1!==J.current&&Ae){const e=he[J.current],n=!!v&&v(e);if(t.preventDefault(),n)return;Be(t,e,"selectOption"),r&&V.current.setSelectionRange(V.current.value.length,V.current.value.length)}else y&&""!==ne&&!1===de&&(I&&t.preventDefault(),Be(t,ne,"createOption","freeSolo"));break;case"Escape":Ae?(t.preventDefault(),t.stopPropagation(),Ce(t,"escape")):l&&(""!==ne||I&&ee.length>0||D)&&(t.preventDefault(),t.stopPropagation(),Re(t));break;case"Backspace":if(I&&!O&&""===ne&&ee.length>0){const e=-1===X?ee.length-1:X,n=ee.slice();n.splice(e,1),Se(t,n,"removeOption",{option:ee[e]})}I||!D||O||(te(null),me(-1));break;case"Delete":if(I&&!O&&""===ne&&ee.length>0&&-1!==X){const e=X,n=ee.slice();n.splice(e,1),Se(t,n,"removeOption",{option:ee[e]})}I||!D||O||(te(null),me(-1))}},Te=e=>{ie(!0),L&&!H.current&&_e(e)},Pe=e=>{t(W)?V.current.focus():(ie(!1),G.current=!0,H.current=!1,i&&-1!==J.current&&Ae?Be(e,he[J.current],"blur"):i&&y&&""!==ne?Be(e,ne,"blur","freeSolo"):a&&se(e,ee,"blur"),Ce(e,"blur"))},Fe=e=>{const t=e.target.value;ne!==t&&(re(t),ue(!1),P&&P(e,t,"input")),""===t?d||I||Se(e,null,"clear"):_e(e)},Me=e=>{const t=Number(e.currentTarget.getAttribute("data-option-index"));J.current!==t&&ye({event:e,index:t,reason:"mouse"})},Le=e=>{ye({event:e,index:Number(e.currentTarget.getAttribute("data-option-index")),reason:"touch"}),Ee.current=!0},Ue=e=>{const t=Number(e.currentTarget.getAttribute("data-option-index"));Be(e,he[t],"selectOption"),Ee.current=!1},Oe=e=>t=>{const n=ee.slice();n.splice(e,1),Se(t,n,"removeOption",{option:ee[e]})},De=e=>{Se(e,null,"removeOption",{option:ee})},Ne=e=>{ae?Ce(e,"toggleInput"):_e(e)},je=e=>{e.currentTarget.contains(e.target)&&e.target.getAttribute("id")!==Q&&e.preventDefault()},Qe=e=>{e.currentTarget.contains(e.target)&&(V.current.focus(),N&&G.current&&V.current.selectionEnd-V.current.selectionStart===0&&V.current.select(),G.current=!1)},ze=e=>{h||""!==ne&&ae||Ne(e)};let He=y&&ne.length>0;He=He||(I?ee.length>0:null!==ee);let Ge=he;return x&&(Ge=he.reduce((e,t,n)=>{const r=x(t);return e.length>0&&e[e.length-1].group===r?e[e.length-1].options.push(t):e.push({key:n,index:n,group:r,options:[t]}),e},[])),h&&oe&&Pe(),{getRootProps:(e={})=>({...e,onKeyDown:ke(e),onMouseDown:je,onClick:Qe}),getInputLabelProps:()=>({id:`${Q}-label`,htmlFor:Q}),getInputProps:()=>({id:Q,value:ne,onBlur:Pe,onFocus:Te,onChange:Fe,onMouseDown:ze,"aria-activedescendant":Ae?"":null,"aria-autocomplete":r?"both":"list","aria-controls":ge?`${Q}-listbox`:void 0,"aria-expanded":ge,autoComplete:"off",ref:V,autoCapitalize:"none",spellCheck:"false",role:"combobox",disabled:h}),getClearProps:()=>({tabIndex:-1,type:"button",onClick:Re}),getItemProps:({index:e=0}={})=>({...I&&{key:e},...D?{"data-item-index":e}:{"data-tag-index":e},tabIndex:-1,...!O&&{onDelete:I?Oe(e):De}}),getPopupIndicatorProps:()=>({tabIndex:-1,type:"button",onClick:Ne}),getTagProps:({index:e})=>({key:e,"data-tag-index":e,tabIndex:-1,...!O&&{onDelete:Oe(e)}}),getListboxProps:()=>({role:"listbox",id:`${Q}-listbox`,"aria-labelledby":`${Q}-label`,ref:xe,onMouseDown:e=>{e.preventDefault()}}),getOptionProps:({index:e,option:t})=>{const n=(I?ee:[ee]).some(e=>null!=e&&B(t,e)),r=!!v&&v(t);return{key:b?.(t)??z(t),tabIndex:-1,role:"option",id:`${Q}-option-${e}`,onMouseMove:Me,onClick:Ue,onTouchStart:Le,"data-option-index":e,"aria-disabled":r,"aria-selected":n}},id:Q,inputValue:ne,value:ee,dirty:He,expanded:Ae&&$,popupOpen:Ae,focused:oe||-1!==X,anchorEl:$,setAnchorEl:K,focusedItem:X,focusedTag:X,groupedOptions:Ge}}var BA="top",IA="bottom",RA="right",kA="left",TA="auto",PA=[BA,IA,RA,kA],FA="start",MA="end",LA="viewport",UA="popper",OA=PA.reduce(function(e,t){return e.concat([t+"-"+FA,t+"-"+MA])},[]),DA=[].concat(PA,[TA]).reduce(function(e,t){return e.concat([t,t+"-"+FA,t+"-"+MA])},[]),NA=["beforeRead","read","afterRead","beforeMain","main","afterMain","beforeWrite","write","afterWrite"];function jA(e){return e?(e.nodeName||"").toLowerCase():null}function QA(e){if(null==e)return window;if("[object Window]"!==e.toString()){var t=e.ownerDocument;return t&&t.defaultView||window}return e}function zA(e){return e instanceof QA(e).Element||e instanceof Element}function HA(e){return e instanceof QA(e).HTMLElement||e instanceof HTMLElement}function GA(e){return"undefined"!=typeof ShadowRoot&&(e instanceof QA(e).ShadowRoot||e instanceof ShadowRoot)}const VA={name:"applyStyles",enabled:!0,phase:"write",fn:function(e){var t=e.state;Object.keys(t.elements).forEach(function(e){var n=t.styles[e]||{},r=t.attributes[e]||{},o=t.elements[e];HA(o)&&jA(o)&&(Object.assign(o.style,n),Object.keys(r).forEach(function(e){var t=r[e];!1===t?o.removeAttribute(e):o.setAttribute(e,!0===t?"":t)}))})},effect:function(e){var t=e.state,n={popper:{position:t.options.strategy,left:"0",top:"0",margin:"0"},arrow:{position:"absolute"},reference:{}};return Object.assign(t.elements.popper.style,n.popper),t.styles=n,t.elements.arrow&&Object.assign(t.elements.arrow.style,n.arrow),function(){Object.keys(t.elements).forEach(function(e){var r=t.elements[e],o=t.attributes[e]||{},i=Object.keys(t.styles.hasOwnProperty(e)?t.styles[e]:n[e]).reduce(function(e,t){return e[t]="",e},{});HA(r)&&jA(r)&&(Object.assign(r.style,i),Object.keys(o).forEach(function(e){r.removeAttribute(e)}))})}},requires:["computeStyles"]};function WA(e){return e.split("-")[0]}var $A=Math.max,KA=Math.min,XA=Math.round;function YA(){var e=navigator.userAgentData;return null!=e&&e.brands&&Array.isArray(e.brands)?e.brands.map(function(e){return e.brand+"/"+e.version}).join(" "):navigator.userAgent}function qA(){return!/^((?!chrome|android).)*safari/i.test(YA())}function JA(e,t,n){void 0===t&&(t=!1),void 0===n&&(n=!1);var r=e.getBoundingClientRect(),o=1,i=1;t&&HA(e)&&(o=e.offsetWidth>0&&XA(r.width)/e.offsetWidth||1,i=e.offsetHeight>0&&XA(r.height)/e.offsetHeight||1);var s=(zA(e)?QA(e):window).visualViewport,a=!qA()&&n,l=(r.left+(a&&s?s.offsetLeft:0))/o,c=(r.top+(a&&s?s.offsetTop:0))/i,u=r.width/o,d=r.height/i;return{width:u,height:d,top:c,right:l+u,bottom:c+d,left:l,x:l,y:c}}function ZA(e){var t=JA(e),n=e.offsetWidth,r=e.offsetHeight;return Math.abs(t.width-n)<=1&&(n=t.width),Math.abs(t.height-r)<=1&&(r=t.height),{x:e.offsetLeft,y:e.offsetTop,width:n,height:r}}function eh(e,t){var n=t.getRootNode&&t.getRootNode();if(e.contains(t))return!0;if(n&&GA(n)){var r=t;do{if(r&&e.isSameNode(r))return!0;r=r.parentNode||r.host}while(r)}return!1}function th(e){return QA(e).getComputedStyle(e)}function nh(e){return["table","td","th"].indexOf(jA(e))>=0}function rh(e){return((zA(e)?e.ownerDocument:e.document)||window.document).documentElement}function oh(e){return"html"===jA(e)?e:e.assignedSlot||e.parentNode||(GA(e)?e.host:null)||rh(e)}function ih(e){return HA(e)&&"fixed"!==th(e).position?e.offsetParent:null}function sh(e){for(var t=QA(e),n=ih(e);n&&nh(n)&&"static"===th(n).position;)n=ih(n);return n&&("html"===jA(n)||"body"===jA(n)&&"static"===th(n).position)?t:n||function(e){var t=/firefox/i.test(YA());if(/Trident/i.test(YA())&&HA(e)&&"fixed"===th(e).position)return null;var n=oh(e);for(GA(n)&&(n=n.host);HA(n)&&["html","body"].indexOf(jA(n))<0;){var r=th(n);if("none"!==r.transform||"none"!==r.perspective||"paint"===r.contain||-1!==["transform","perspective"].indexOf(r.willChange)||t&&"filter"===r.willChange||t&&r.filter&&"none"!==r.filter)return n;n=n.parentNode}return null}(e)||t}function ah(e){return["top","bottom"].indexOf(e)>=0?"x":"y"}function lh(e,t,n){return $A(e,KA(t,n))}function ch(e){return Object.assign({},{top:0,right:0,bottom:0,left:0},e)}function uh(e,t){return t.reduce(function(t,n){return t[n]=e,t},{})}const dh={name:"arrow",enabled:!0,phase:"main",fn:function(e){var t,n=e.state,r=e.name,o=e.options,i=n.elements.arrow,s=n.modifiersData.popperOffsets,a=WA(n.placement),l=ah(a),c=[kA,RA].indexOf(a)>=0?"height":"width";if(i&&s){var u=function(e,t){return ch("number"!=typeof(e="function"==typeof e?e(Object.assign({},t.rects,{placement:t.placement})):e)?e:uh(e,PA))}(o.padding,n),d=ZA(i),A="y"===l?BA:kA,h="y"===l?IA:RA,p=n.rects.reference[c]+n.rects.reference[l]-s[l]-n.rects.popper[c],f=s[l]-n.rects.reference[l],g=sh(i),m=g?"y"===l?g.clientHeight||0:g.clientWidth||0:0,y=p/2-f/2,v=u[A],b=m-d[c]-u[h],w=m/2-d[c]/2+y,x=lh(v,w,b),_=l;n.modifiersData[r]=((t={})[_]=x,t.centerOffset=x-w,t)}},effect:function(e){var t=e.state,n=e.options.element,r=void 0===n?"[data-popper-arrow]":n;null!=r&&("string"!=typeof r||(r=t.elements.popper.querySelector(r)))&&eh(t.elements.popper,r)&&(t.elements.arrow=r)},requires:["popperOffsets"],requiresIfExists:["preventOverflow"]};function Ah(e){return e.split("-")[1]}var hh={top:"auto",right:"auto",bottom:"auto",left:"auto"};function ph(e){var t,n=e.popper,r=e.popperRect,o=e.placement,i=e.variation,s=e.offsets,a=e.position,l=e.gpuAcceleration,c=e.adaptive,u=e.roundOffsets,d=e.isFixed,A=s.x,h=void 0===A?0:A,p=s.y,f=void 0===p?0:p,g="function"==typeof u?u({x:h,y:f}):{x:h,y:f};h=g.x,f=g.y;var m=s.hasOwnProperty("x"),y=s.hasOwnProperty("y"),v=kA,b=BA,w=window;if(c){var x=sh(n),_="clientHeight",C="clientWidth";if(x===QA(n)&&"static"!==th(x=rh(n)).position&&"absolute"===a&&(_="scrollHeight",C="scrollWidth"),o===BA||(o===kA||o===RA)&&i===MA)b=IA,f-=(d&&x===w&&w.visualViewport?w.visualViewport.height:x[_])-r.height,f*=l?1:-1;if(o===kA||(o===BA||o===IA)&&i===MA)v=RA,h-=(d&&x===w&&w.visualViewport?w.visualViewport.width:x[C])-r.width,h*=l?1:-1}var S,E=Object.assign({position:a},c&&hh),B=!0===u?function(e,t){var n=e.x,r=e.y,o=t.devicePixelRatio||1;return{x:XA(n*o)/o||0,y:XA(r*o)/o||0}}({x:h,y:f},QA(n)):{x:h,y:f};return h=B.x,f=B.y,l?Object.assign({},E,((S={})[b]=y?"0":"",S[v]=m?"0":"",S.transform=(w.devicePixelRatio||1)<=1?"translate("+h+"px, "+f+"px)":"translate3d("+h+"px, "+f+"px, 0)",S)):Object.assign({},E,((t={})[b]=y?f+"px":"",t[v]=m?h+"px":"",t.transform="",t))}const fh={name:"computeStyles",enabled:!0,phase:"beforeWrite",fn:function(e){var t=e.state,n=e.options,r=n.gpuAcceleration,o=void 0===r||r,i=n.adaptive,s=void 0===i||i,a=n.roundOffsets,l=void 0===a||a,c={placement:WA(t.placement),variation:Ah(t.placement),popper:t.elements.popper,popperRect:t.rects.popper,gpuAcceleration:o,isFixed:"fixed"===t.options.strategy};null!=t.modifiersData.popperOffsets&&(t.styles.popper=Object.assign({},t.styles.popper,ph(Object.assign({},c,{offsets:t.modifiersData.popperOffsets,position:t.options.strategy,adaptive:s,roundOffsets:l})))),null!=t.modifiersData.arrow&&(t.styles.arrow=Object.assign({},t.styles.arrow,ph(Object.assign({},c,{offsets:t.modifiersData.arrow,position:"absolute",adaptive:!1,roundOffsets:l})))),t.attributes.popper=Object.assign({},t.attributes.popper,{"data-popper-placement":t.placement})},data:{}};var gh={passive:!0};const mh={name:"eventListeners",enabled:!0,phase:"write",fn:function(){},effect:function(e){var t=e.state,n=e.instance,r=e.options,o=r.scroll,i=void 0===o||o,s=r.resize,a=void 0===s||s,l=QA(t.elements.popper),c=[].concat(t.scrollParents.reference,t.scrollParents.popper);return i&&c.forEach(function(e){e.addEventListener("scroll",n.update,gh)}),a&&l.addEventListener("resize",n.update,gh),function(){i&&c.forEach(function(e){e.removeEventListener("scroll",n.update,gh)}),a&&l.removeEventListener("resize",n.update,gh)}},data:{}};var yh={left:"right",right:"left",bottom:"top",top:"bottom"};function vh(e){return e.replace(/left|right|bottom|top/g,function(e){return yh[e]})}var bh={start:"end",end:"start"};function wh(e){return e.replace(/start|end/g,function(e){return bh[e]})}function xh(e){var t=QA(e);return{scrollLeft:t.pageXOffset,scrollTop:t.pageYOffset}}function _h(e){return JA(rh(e)).left+xh(e).scrollLeft}function Ch(e){var t=th(e),n=t.overflow,r=t.overflowX,o=t.overflowY;return/auto|scroll|overlay|hidden/.test(n+o+r)}function Sh(e){return["html","body","#document"].indexOf(jA(e))>=0?e.ownerDocument.body:HA(e)&&Ch(e)?e:Sh(oh(e))}function Eh(e,t){var n;void 0===t&&(t=[]);var r=Sh(e),o=r===(null==(n=e.ownerDocument)?void 0:n.body),i=QA(r),s=o?[i].concat(i.visualViewport||[],Ch(r)?r:[]):r,a=t.concat(s);return o?a:a.concat(Eh(oh(s)))}function Bh(e){return Object.assign({},e,{left:e.x,top:e.y,right:e.x+e.width,bottom:e.y+e.height})}function Ih(e,t,n){return t===LA?Bh(function(e,t){var n=QA(e),r=rh(e),o=n.visualViewport,i=r.clientWidth,s=r.clientHeight,a=0,l=0;if(o){i=o.width,s=o.height;var c=qA();(c||!c&&"fixed"===t)&&(a=o.offsetLeft,l=o.offsetTop)}return{width:i,height:s,x:a+_h(e),y:l}}(e,n)):zA(t)?function(e,t){var n=JA(e,!1,"fixed"===t);return n.top=n.top+e.clientTop,n.left=n.left+e.clientLeft,n.bottom=n.top+e.clientHeight,n.right=n.left+e.clientWidth,n.width=e.clientWidth,n.height=e.clientHeight,n.x=n.left,n.y=n.top,n}(t,n):Bh(function(e){var t,n=rh(e),r=xh(e),o=null==(t=e.ownerDocument)?void 0:t.body,i=$A(n.scrollWidth,n.clientWidth,o?o.scrollWidth:0,o?o.clientWidth:0),s=$A(n.scrollHeight,n.clientHeight,o?o.scrollHeight:0,o?o.clientHeight:0),a=-r.scrollLeft+_h(e),l=-r.scrollTop;return"rtl"===th(o||n).direction&&(a+=$A(n.clientWidth,o?o.clientWidth:0)-i),{width:i,height:s,x:a,y:l}}(rh(e)))}function Rh(e,t,n,r){var o="clippingParents"===t?function(e){var t=Eh(oh(e)),n=["absolute","fixed"].indexOf(th(e).position)>=0&&HA(e)?sh(e):e;return zA(n)?t.filter(function(e){return zA(e)&&eh(e,n)&&"body"!==jA(e)}):[]}(e):[].concat(t),i=[].concat(o,[n]),s=i[0],a=i.reduce(function(t,n){var o=Ih(e,n,r);return t.top=$A(o.top,t.top),t.right=KA(o.right,t.right),t.bottom=KA(o.bottom,t.bottom),t.left=$A(o.left,t.left),t},Ih(e,s,r));return a.width=a.right-a.left,a.height=a.bottom-a.top,a.x=a.left,a.y=a.top,a}function kh(e){var t,n=e.reference,r=e.element,o=e.placement,i=o?WA(o):null,s=o?Ah(o):null,a=n.x+n.width/2-r.width/2,l=n.y+n.height/2-r.height/2;switch(i){case BA:t={x:a,y:n.y-r.height};break;case IA:t={x:a,y:n.y+n.height};break;case RA:t={x:n.x+n.width,y:l};break;case kA:t={x:n.x-r.width,y:l};break;default:t={x:n.x,y:n.y}}var c=i?ah(i):null;if(null!=c){var u="y"===c?"height":"width";switch(s){case FA:t[c]=t[c]-(n[u]/2-r[u]/2);break;case MA:t[c]=t[c]+(n[u]/2-r[u]/2)}}return t}function Th(e,t){void 0===t&&(t={});var n=t,r=n.placement,o=void 0===r?e.placement:r,i=n.strategy,s=void 0===i?e.strategy:i,a=n.boundary,l=void 0===a?"clippingParents":a,c=n.rootBoundary,u=void 0===c?LA:c,d=n.elementContext,A=void 0===d?UA:d,h=n.altBoundary,p=void 0!==h&&h,f=n.padding,g=void 0===f?0:f,m=ch("number"!=typeof g?g:uh(g,PA)),y=A===UA?"reference":UA,v=e.rects.popper,b=e.elements[p?y:A],w=Rh(zA(b)?b:b.contextElement||rh(e.elements.popper),l,u,s),x=JA(e.elements.reference),_=kh({reference:x,element:v,placement:o}),C=Bh(Object.assign({},v,_)),S=A===UA?C:x,E={top:w.top-S.top+m.top,bottom:S.bottom-w.bottom+m.bottom,left:w.left-S.left+m.left,right:S.right-w.right+m.right},B=e.modifiersData.offset;if(A===UA&&B){var I=B[o];Object.keys(E).forEach(function(e){var t=[RA,IA].indexOf(e)>=0?1:-1,n=[BA,IA].indexOf(e)>=0?"y":"x";E[e]+=I[n]*t})}return E}const Ph={name:"flip",enabled:!0,phase:"main",fn:function(e){var t=e.state,n=e.options,r=e.name;if(!t.modifiersData[r]._skip){for(var o=n.mainAxis,i=void 0===o||o,s=n.altAxis,a=void 0===s||s,l=n.fallbackPlacements,c=n.padding,u=n.boundary,d=n.rootBoundary,A=n.altBoundary,h=n.flipVariations,p=void 0===h||h,f=n.allowedAutoPlacements,g=t.options.placement,m=WA(g),y=l||(m===g||!p?[vh(g)]:function(e){if(WA(e)===TA)return[];var t=vh(e);return[wh(e),t,wh(t)]}(g)),v=[g].concat(y).reduce(function(e,n){return e.concat(WA(n)===TA?function(e,t){void 0===t&&(t={});var n=t,r=n.placement,o=n.boundary,i=n.rootBoundary,s=n.padding,a=n.flipVariations,l=n.allowedAutoPlacements,c=void 0===l?DA:l,u=Ah(r),d=u?a?OA:OA.filter(function(e){return Ah(e)===u}):PA,A=d.filter(function(e){return c.indexOf(e)>=0});0===A.length&&(A=d);var h=A.reduce(function(t,n){return t[n]=Th(e,{placement:n,boundary:o,rootBoundary:i,padding:s})[WA(n)],t},{});return Object.keys(h).sort(function(e,t){return h[e]-h[t]})}(t,{placement:n,boundary:u,rootBoundary:d,padding:c,flipVariations:p,allowedAutoPlacements:f}):n)},[]),b=t.rects.reference,w=t.rects.popper,x=new Map,_=!0,C=v[0],S=0;S<v.length;S++){var E=v[S],B=WA(E),I=Ah(E)===FA,R=[BA,IA].indexOf(B)>=0,k=R?"width":"height",T=Th(t,{placement:E,boundary:u,rootBoundary:d,altBoundary:A,padding:c}),P=R?I?RA:kA:I?IA:BA;b[k]>w[k]&&(P=vh(P));var F=vh(P),M=[];if(i&&M.push(T[B]<=0),a&&M.push(T[P]<=0,T[F]<=0),M.every(function(e){return e})){C=E,_=!1;break}x.set(E,M)}if(_)for(var L=function(e){var t=v.find(function(t){var n=x.get(t);if(n)return n.slice(0,e).every(function(e){return e})});if(t)return C=t,"break"},U=p?3:1;U>0;U--){if("break"===L(U))break}t.placement!==C&&(t.modifiersData[r]._skip=!0,t.placement=C,t.reset=!0)}},requiresIfExists:["offset"],data:{_skip:!1}};function Fh(e,t,n){return void 0===n&&(n={x:0,y:0}),{top:e.top-t.height-n.y,right:e.right-t.width+n.x,bottom:e.bottom-t.height+n.y,left:e.left-t.width-n.x}}function Mh(e){return[BA,RA,IA,kA].some(function(t){return e[t]>=0})}const Lh={name:"offset",enabled:!0,phase:"main",requires:["popperOffsets"],fn:function(e){var t=e.state,n=e.options,r=e.name,o=n.offset,i=void 0===o?[0,0]:o,s=DA.reduce(function(e,n){return e[n]=function(e,t,n){var r=WA(e),o=[kA,BA].indexOf(r)>=0?-1:1,i="function"==typeof n?n(Object.assign({},t,{placement:e})):n,s=i[0],a=i[1];return s=s||0,a=(a||0)*o,[kA,RA].indexOf(r)>=0?{x:a,y:s}:{x:s,y:a}}(n,t.rects,i),e},{}),a=s[t.placement],l=a.x,c=a.y;null!=t.modifiersData.popperOffsets&&(t.modifiersData.popperOffsets.x+=l,t.modifiersData.popperOffsets.y+=c),t.modifiersData[r]=s}};const Uh={name:"preventOverflow",enabled:!0,phase:"main",fn:function(e){var t=e.state,n=e.options,r=e.name,o=n.mainAxis,i=void 0===o||o,s=n.altAxis,a=void 0!==s&&s,l=n.boundary,c=n.rootBoundary,u=n.altBoundary,d=n.padding,A=n.tether,h=void 0===A||A,p=n.tetherOffset,f=void 0===p?0:p,g=Th(t,{boundary:l,rootBoundary:c,padding:d,altBoundary:u}),m=WA(t.placement),y=Ah(t.placement),v=!y,b=ah(m),w="x"===b?"y":"x",x=t.modifiersData.popperOffsets,_=t.rects.reference,C=t.rects.popper,S="function"==typeof f?f(Object.assign({},t.rects,{placement:t.placement})):f,E="number"==typeof S?{mainAxis:S,altAxis:S}:Object.assign({mainAxis:0,altAxis:0},S),B=t.modifiersData.offset?t.modifiersData.offset[t.placement]:null,I={x:0,y:0};if(x){if(i){var R,k="y"===b?BA:kA,T="y"===b?IA:RA,P="y"===b?"height":"width",F=x[b],M=F+g[k],L=F-g[T],U=h?-C[P]/2:0,O=y===FA?_[P]:C[P],D=y===FA?-C[P]:-_[P],N=t.elements.arrow,j=h&&N?ZA(N):{width:0,height:0},Q=t.modifiersData["arrow#persistent"]?t.modifiersData["arrow#persistent"].padding:{top:0,right:0,bottom:0,left:0},z=Q[k],H=Q[T],G=lh(0,_[P],j[P]),V=v?_[P]/2-U-G-z-E.mainAxis:O-G-z-E.mainAxis,W=v?-_[P]/2+U+G+H+E.mainAxis:D+G+H+E.mainAxis,$=t.elements.arrow&&sh(t.elements.arrow),K=$?"y"===b?$.clientTop||0:$.clientLeft||0:0,X=null!=(R=null==B?void 0:B[b])?R:0,Y=F+W-X,q=lh(h?KA(M,F+V-X-K):M,F,h?$A(L,Y):L);x[b]=q,I[b]=q-F}if(a){var J,Z="x"===b?BA:kA,ee="x"===b?IA:RA,te=x[w],ne="y"===w?"height":"width",re=te+g[Z],oe=te-g[ee],ie=-1!==[BA,kA].indexOf(m),se=null!=(J=null==B?void 0:B[w])?J:0,ae=ie?re:te-_[ne]-C[ne]-se+E.altAxis,le=ie?te+_[ne]+C[ne]-se-E.altAxis:oe,ce=h&&ie?(de=lh(ae,te,ue=le))>ue?ue:de:lh(h?ae:re,te,h?le:oe);x[w]=ce,I[w]=ce-te}var ue,de;t.modifiersData[r]=I}},requiresIfExists:["offset"]};function Oh(e,t,n){void 0===n&&(n=!1);var r,o,i=HA(t),s=HA(t)&&function(e){var t=e.getBoundingClientRect(),n=XA(t.width)/e.offsetWidth||1,r=XA(t.height)/e.offsetHeight||1;return 1!==n||1!==r}(t),a=rh(t),l=JA(e,s,n),c={scrollLeft:0,scrollTop:0},u={x:0,y:0};return(i||!i&&!n)&&(("body"!==jA(t)||Ch(a))&&(c=(r=t)!==QA(r)&&HA(r)?{scrollLeft:(o=r).scrollLeft,scrollTop:o.scrollTop}:xh(r)),HA(t)?((u=JA(t,!0)).x+=t.clientLeft,u.y+=t.clientTop):a&&(u.x=_h(a))),{x:l.left+c.scrollLeft-u.x,y:l.top+c.scrollTop-u.y,width:l.width,height:l.height}}function Dh(e){var t=new Map,n=new Set,r=[];function o(e){n.add(e.name),[].concat(e.requires||[],e.requiresIfExists||[]).forEach(function(e){if(!n.has(e)){var r=t.get(e);r&&o(r)}}),r.push(e)}return e.forEach(function(e){t.set(e.name,e)}),e.forEach(function(e){n.has(e.name)||o(e)}),r}var Nh={placement:"bottom",modifiers:[],strategy:"absolute"};function jh(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return!t.some(function(e){return!(e&&"function"==typeof e.getBoundingClientRect)})}function Qh(e){void 0===e&&(e={});var t=e,n=t.defaultModifiers,r=void 0===n?[]:n,o=t.defaultOptions,i=void 0===o?Nh:o;return function(e,t,n){void 0===n&&(n=i);var o,s,a={placement:"bottom",orderedModifiers:[],options:Object.assign({},Nh,i),modifiersData:{},elements:{reference:e,popper:t},attributes:{},styles:{}},l=[],c=!1,u={state:a,setOptions:function(n){var o="function"==typeof n?n(a.options):n;d(),a.options=Object.assign({},i,a.options,o),a.scrollParents={reference:zA(e)?Eh(e):e.contextElement?Eh(e.contextElement):[],popper:Eh(t)};var s,c,A=function(e){var t=Dh(e);return NA.reduce(function(e,n){return e.concat(t.filter(function(e){return e.phase===n}))},[])}((s=[].concat(r,a.options.modifiers),c=s.reduce(function(e,t){var n=e[t.name];return e[t.name]=n?Object.assign({},n,t,{options:Object.assign({},n.options,t.options),data:Object.assign({},n.data,t.data)}):t,e},{}),Object.keys(c).map(function(e){return c[e]})));return a.orderedModifiers=A.filter(function(e){return e.enabled}),a.orderedModifiers.forEach(function(e){var t=e.name,n=e.options,r=void 0===n?{}:n,o=e.effect;if("function"==typeof o){var i=o({state:a,name:t,instance:u,options:r}),s=function(){};l.push(i||s)}}),u.update()},forceUpdate:function(){if(!c){var e=a.elements,t=e.reference,n=e.popper;if(jh(t,n)){a.rects={reference:Oh(t,sh(n),"fixed"===a.options.strategy),popper:ZA(n)},a.reset=!1,a.placement=a.options.placement,a.orderedModifiers.forEach(function(e){return a.modifiersData[e.name]=Object.assign({},e.data)});for(var r=0;r<a.orderedModifiers.length;r++)if(!0!==a.reset){var o=a.orderedModifiers[r],i=o.fn,s=o.options,l=void 0===s?{}:s,d=o.name;"function"==typeof i&&(a=i({state:a,options:l,name:d,instance:u})||a)}else a.reset=!1,r=-1}}},update:(o=function(){return new Promise(function(e){u.forceUpdate(),e(a)})},function(){return s||(s=new Promise(function(e){Promise.resolve().then(function(){s=void 0,e(o())})})),s}),destroy:function(){d(),c=!0}};if(!jh(e,t))return u;function d(){l.forEach(function(e){return e()}),l=[]}return u.setOptions(n).then(function(e){!c&&n.onFirstUpdate&&n.onFirstUpdate(e)}),u}}var zh=Qh({defaultModifiers:[mh,{name:"popperOffsets",enabled:!0,phase:"read",fn:function(e){var t=e.state,n=e.name;t.modifiersData[n]=kh({reference:t.rects.reference,element:t.rects.popper,placement:t.placement})},data:{}},fh,VA,Lh,Ph,Uh,dh,{name:"hide",enabled:!0,phase:"main",requiresIfExists:["preventOverflow"],fn:function(e){var t=e.state,n=e.name,r=t.rects.reference,o=t.rects.popper,i=t.modifiersData.preventOverflow,s=Th(t,{elementContext:"reference"}),a=Th(t,{altBoundary:!0}),l=Fh(s,r),c=Fh(a,o,i),u=Mh(l),d=Mh(c);t.modifiersData[n]={referenceClippingOffsets:l,popperEscapeOffsets:c,isReferenceHidden:u,hasPopperEscaped:d},t.attributes.popper=Object.assign({},t.attributes.popper,{"data-popper-reference-hidden":u,"data-popper-escaped":d})}}]});function Hh(e){const{elementType:t,externalSlotProps:n,ownerState:r,skipResolvingSlotProps:o=!1,...i}=e,s=o?{}:vd(n,r),{props:a,internalRef:l}=xd({...i,externalSlotProps:s});return yd(t,{...a,ref:Ou(l,s?.ref,e.additionalProps?.ref)},r)}function Gh(e){return parseInt(pe.version,10)>=19?e?.props?.ref||null:e?.ref||null}const Vh=pe.forwardRef(function(e,t){const{children:n,container:r,disablePortal:o=!1}=e,[i,s]=pe.useState(null),a=Ou(pe.isValidElement(n)?Gh(n):null,t);if(Qo(()=>{o||s(function(e){return"function"==typeof e?e():e}(r)||document.body)},[r,o]),Qo(()=>{if(i&&!o)return Mu(t,i),()=>{Mu(t,null)}},[t,i,o]),o){if(pe.isValidElement(n)){const e={ref:a};return pe.cloneElement(n,e)}return n}return i?wu.createPortal(n,i):i});function Wh(e){return Eo("MuiPopper",e)}function $h(e){return"function"==typeof e?e():e}Bo("MuiPopper",["root"]);const Kh={},Xh=pe.forwardRef(function(e,t){const{anchorEl:n,children:r,direction:o,disablePortal:i,modifiers:a,open:l,placement:c,popperOptions:u,popperRef:d,slotProps:A={},slots:h={},TransitionProps:p,ownerState:f,...g}=e,m=pe.useRef(null),y=Ou(m,t),v=pe.useRef(null),b=Ou(v,d),w=pe.useRef(b);Qo(()=>{w.current=b},[b]),pe.useImperativeHandle(d,()=>v.current,[]);const x=function(e,t){if("ltr"===t)return e;switch(e){case"bottom-end":return"bottom-start";case"bottom-start":return"bottom-end";case"top-end":return"top-start";case"top-start":return"top-end";default:return e}}(c,o),[_,C]=pe.useState(x),[S,E]=pe.useState($h(n));pe.useEffect(()=>{v.current&&v.current.forceUpdate()}),pe.useEffect(()=>{n&&E($h(n))},[n]),Qo(()=>{if(!S||!l)return;let e=[{name:"preventOverflow",options:{altBoundary:i}},{name:"flip",options:{altBoundary:i}},{name:"onUpdate",enabled:!0,phase:"afterWrite",fn:({state:e})=>{C(e.placement)}}];null!=a&&(e=e.concat(a)),u&&null!=u.modifiers&&(e=e.concat(u.modifiers));const t=zh(S,m.current,{placement:x,...u,modifiers:e});return w.current(t),()=>{t.destroy(),w.current(null)}},[S,i,a,l,u,x]);const B={placement:_};null!==p&&(B.TransitionProps=p);const I=(e=>{const{classes:t}=e;return Ti({root:["root"]},Wh,t)})(e),R=h.root??"div",k=Hh({elementType:R,externalSlotProps:A.root,externalForwardedProps:g,additionalProps:{role:"tooltip",ref:y},ownerState:e,className:I.root});return s.jsx(R,{...k,children:"function"==typeof r?r(B):r})}),Yh=la(pe.forwardRef(function(e,t){const{anchorEl:n,children:r,container:o,direction:i="ltr",disablePortal:a=!1,keepMounted:l=!1,modifiers:c,open:u,placement:d="bottom",popperOptions:A=Kh,popperRef:h,style:p,transition:f=!1,slotProps:g={},slots:m={},...y}=e,[v,b]=pe.useState(!0);if(!l&&!u&&(!f||v))return null;let w;if(o)w=o;else if(n){const e=$h(n);w=e&&void 0!==e.nodeType?Pu(e).body:Pu(null).body}const x=u||!l||f&&!v?void 0:"none",_=f?{in:u,onEnter:()=>{b(!1)},onExited:()=>{b(!0)}}:void 0;return s.jsx(Vh,{disablePortal:a,container:w,children:s.jsx(Xh,{anchorEl:n,direction:i,disablePortal:a,modifiers:c,ref:t,open:f?!v:u,placement:d,popperOptions:A,popperRef:h,slotProps:g,slots:m,...y,style:{position:"fixed",top:0,left:0,display:x,...p},TransitionProps:_,children:r})})}),{name:"MuiPopper",slot:"Root"})({}),qh=pe.forwardRef(function(e,t){const n=li(),r=Eu({props:e,name:"MuiPopper"}),{anchorEl:o,component:i,components:a,componentsProps:l,container:c,disablePortal:u,keepMounted:d,modifiers:A,open:h,placement:p,popperOptions:f,popperRef:g,transition:m,slots:y,slotProps:v,...b}=r,w=y?.root??a?.Root,x={anchorEl:o,container:c,disablePortal:u,keepMounted:d,modifiers:A,open:h,placement:p,popperOptions:f,popperRef:g,transition:m,...b};return s.jsx(Yh,{as:i,direction:n?"rtl":"ltr",slots:{root:w},slotProps:v??l,...x,ref:t})});function Jh(e){return Eo("MuiListSubheader",e)}Bo("MuiListSubheader",["root","colorPrimary","colorInherit","gutters","inset","sticky"]);const Zh=la("li",{name:"MuiListSubheader",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:n}=e;return[t.root,"default"!==n.color&&t[`color${vr(n.color)}`],!n.disableGutters&&t.gutters,n.inset&&t.inset,!n.disableSticky&&t.sticky]}})(Su(({theme:e})=>({boxSizing:"border-box",lineHeight:"48px",listStyle:"none",color:(e.vars||e).palette.text.secondary,fontFamily:e.typography.fontFamily,fontWeight:e.typography.fontWeightMedium,fontSize:e.typography.pxToRem(14),variants:[{props:{color:"primary"},style:{color:(e.vars||e).palette.primary.main}},{props:{color:"inherit"},style:{color:"inherit"}},{props:({ownerState:e})=>!e.disableGutters,style:{paddingLeft:16,paddingRight:16}},{props:({ownerState:e})=>e.inset,style:{paddingLeft:72}},{props:({ownerState:e})=>!e.disableSticky,style:{position:"sticky",top:0,zIndex:1,backgroundColor:(e.vars||e).palette.background.paper}}]}))),ep=pe.forwardRef(function(e,t){const n=Eu({props:e,name:"MuiListSubheader"}),{className:r,color:o="default",component:i="li",disableGutters:a=!1,disableSticky:l=!1,inset:c=!1,...u}=n,d={...n,color:o,component:i,disableGutters:a,disableSticky:l,inset:c},A=(e=>{const{classes:t,color:n,disableGutters:r,inset:o,disableSticky:i}=e;return Ti({root:["root","default"!==n&&`color${vr(n)}`,!r&&"gutters",o&&"inset",!i&&"sticky"]},Jh,t)})(d);return s.jsx(Zh,{as:i,className:Co(A.root,r),ref:t,ownerState:d,...u})});ep&&(ep.muiSkipListHighlight=!0);const tp=ku(s.jsx("path",{d:"M12 2C6.47 2 2 6.47 2 12s4.47 10 10 10 10-4.47 10-10S17.53 2 12 2zm5 13.59L15.59 17 12 13.41 8.41 17 7 15.59 10.59 12 7 8.41 8.41 7 12 10.59 15.59 7 17 8.41 13.41 12 17 15.59z"}));function np(e){return Eo("MuiChip",e)}const rp=Bo("MuiChip",["root","sizeSmall","sizeMedium","colorDefault","colorError","colorInfo","colorPrimary","colorSecondary","colorSuccess","colorWarning","disabled","clickable","clickableColorPrimary","clickableColorSecondary","deletable","deletableColorPrimary","deletableColorSecondary","outlined","filled","outlinedPrimary","outlinedSecondary","filledPrimary","filledSecondary","avatar","avatarSmall","avatarMedium","avatarColorPrimary","avatarColorSecondary","icon","iconSmall","iconMedium","iconColorPrimary","iconColorSecondary","label","labelSmall","labelMedium","deleteIcon","deleteIconSmall","deleteIconMedium","deleteIconColorPrimary","deleteIconColorSecondary","deleteIconOutlinedColorPrimary","deleteIconOutlinedColorSecondary","deleteIconFilledColorPrimary","deleteIconFilledColorSecondary","focusVisible"]),op=la("div",{name:"MuiChip",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:n}=e,{color:r,iconColor:o,clickable:i,onDelete:s,size:a,variant:l}=n;return[{[`& .${rp.avatar}`]:t.avatar},{[`& .${rp.avatar}`]:t[`avatar${vr(a)}`]},{[`& .${rp.avatar}`]:t[`avatarColor${vr(r)}`]},{[`& .${rp.icon}`]:t.icon},{[`& .${rp.icon}`]:t[`icon${vr(a)}`]},{[`& .${rp.icon}`]:t[`iconColor${vr(o)}`]},{[`& .${rp.deleteIcon}`]:t.deleteIcon},{[`& .${rp.deleteIcon}`]:t[`deleteIcon${vr(a)}`]},{[`& .${rp.deleteIcon}`]:t[`deleteIconColor${vr(r)}`]},{[`& .${rp.deleteIcon}`]:t[`deleteIcon${vr(l)}Color${vr(r)}`]},t.root,t[`size${vr(a)}`],t[`color${vr(r)}`],i&&t.clickable,i&&"default"!==r&&t[`clickableColor${vr(r)})`],s&&t.deletable,s&&"default"!==r&&t[`deletableColor${vr(r)}`],t[l],t[`${l}${vr(r)}`]]}})(Su(({theme:e})=>{const t="light"===e.palette.mode?e.palette.grey[700]:e.palette.grey[300];return{maxWidth:"100%",fontFamily:e.typography.fontFamily,fontSize:e.typography.pxToRem(13),display:"inline-flex",alignItems:"center",justifyContent:"center",height:32,lineHeight:1.5,color:(e.vars||e).palette.text.primary,backgroundColor:(e.vars||e).palette.action.selected,borderRadius:16,whiteSpace:"nowrap",transition:e.transitions.create(["background-color","box-shadow"]),cursor:"unset",outline:0,textDecoration:"none",border:0,padding:0,verticalAlign:"middle",boxSizing:"border-box",[`&.${rp.disabled}`]:{opacity:(e.vars||e).palette.action.disabledOpacity,pointerEvents:"none"},[`& .${rp.avatar}`]:{marginLeft:5,marginRight:-6,width:24,height:24,color:e.vars?e.vars.palette.Chip.defaultAvatarColor:t,fontSize:e.typography.pxToRem(12)},[`& .${rp.avatarColorPrimary}`]:{color:(e.vars||e).palette.primary.contrastText,backgroundColor:(e.vars||e).palette.primary.dark},[`& .${rp.avatarColorSecondary}`]:{color:(e.vars||e).palette.secondary.contrastText,backgroundColor:(e.vars||e).palette.secondary.dark},[`& .${rp.avatarSmall}`]:{marginLeft:4,marginRight:-4,width:18,height:18,fontSize:e.typography.pxToRem(10)},[`& .${rp.icon}`]:{marginLeft:5,marginRight:-6},[`& .${rp.deleteIcon}`]:{WebkitTapHighlightColor:"transparent",color:e.alpha((e.vars||e).palette.text.primary,.26),fontSize:22,cursor:"pointer",margin:"0 5px 0 -6px","&:hover":{color:e.alpha((e.vars||e).palette.text.primary,.4)}},variants:[{props:{size:"small"},style:{height:24,[`& .${rp.icon}`]:{fontSize:18,marginLeft:4,marginRight:-4},[`& .${rp.deleteIcon}`]:{fontSize:16,marginRight:4,marginLeft:-4}}},...Object.entries(e.palette).filter(Dd(["contrastText"])).map(([t])=>({props:{color:t},style:{backgroundColor:(e.vars||e).palette[t].main,color:(e.vars||e).palette[t].contrastText,[`& .${rp.deleteIcon}`]:{color:e.alpha((e.vars||e).palette[t].contrastText,.7),"&:hover, &:active":{color:(e.vars||e).palette[t].contrastText}}}})),{props:e=>e.iconColor===e.color,style:{[`& .${rp.icon}`]:{color:e.vars?e.vars.palette.Chip.defaultIconColor:t}}},{props:e=>e.iconColor===e.color&&"default"!==e.color,style:{[`& .${rp.icon}`]:{color:"inherit"}}},{props:{onDelete:!0},style:{[`&.${rp.focusVisible}`]:{backgroundColor:e.alpha((e.vars||e).palette.action.selected,`${(e.vars||e).palette.action.selectedOpacity} + ${(e.vars||e).palette.action.focusOpacity}`)}}},...Object.entries(e.palette).filter(Dd(["dark"])).map(([t])=>({props:{color:t,onDelete:!0},style:{[`&.${rp.focusVisible}`]:{background:(e.vars||e).palette[t].dark}}})),{props:{clickable:!0},style:{userSelect:"none",WebkitTapHighlightColor:"transparent",cursor:"pointer","&:hover":{backgroundColor:e.alpha((e.vars||e).palette.action.selected,`${(e.vars||e).palette.action.selectedOpacity} + ${(e.vars||e).palette.action.hoverOpacity}`)},[`&.${rp.focusVisible}`]:{backgroundColor:e.alpha((e.vars||e).palette.action.selected,`${(e.vars||e).palette.action.selectedOpacity} + ${(e.vars||e).palette.action.focusOpacity}`)},"&:active":{boxShadow:(e.vars||e).shadows[1]}}},...Object.entries(e.palette).filter(Dd(["dark"])).map(([t])=>({props:{color:t,clickable:!0},style:{[`&:hover, &.${rp.focusVisible}`]:{backgroundColor:(e.vars||e).palette[t].dark}}})),{props:{variant:"outlined"},style:{backgroundColor:"transparent",border:e.vars?`1px solid ${e.vars.palette.Chip.defaultBorder}`:`1px solid ${"light"===e.palette.mode?e.palette.grey[400]:e.palette.grey[700]}`,[`&.${rp.clickable}:hover`]:{backgroundColor:(e.vars||e).palette.action.hover},[`&.${rp.focusVisible}`]:{backgroundColor:(e.vars||e).palette.action.focus},[`& .${rp.avatar}`]:{marginLeft:4},[`& .${rp.avatarSmall}`]:{marginLeft:2},[`& .${rp.icon}`]:{marginLeft:4},[`& .${rp.iconSmall}`]:{marginLeft:2},[`& .${rp.deleteIcon}`]:{marginRight:5},[`& .${rp.deleteIconSmall}`]:{marginRight:3}}},...Object.entries(e.palette).filter(Dd()).map(([t])=>({props:{variant:"outlined",color:t},style:{color:(e.vars||e).palette[t].main,border:`1px solid ${e.alpha((e.vars||e).palette[t].main,.7)}`,[`&.${rp.clickable}:hover`]:{backgroundColor:e.alpha((e.vars||e).palette[t].main,(e.vars||e).palette.action.hoverOpacity)},[`&.${rp.focusVisible}`]:{backgroundColor:e.alpha((e.vars||e).palette[t].main,(e.vars||e).palette.action.focusOpacity)},[`& .${rp.deleteIcon}`]:{color:e.alpha((e.vars||e).palette[t].main,.7),"&:hover, &:active":{color:(e.vars||e).palette[t].main}}}}))]}})),ip=la("span",{name:"MuiChip",slot:"Label",overridesResolver:(e,t)=>{const{ownerState:n}=e,{size:r}=n;return[t.label,t[`label${vr(r)}`]]}})({overflow:"hidden",textOverflow:"ellipsis",paddingLeft:12,paddingRight:12,whiteSpace:"nowrap",variants:[{props:{variant:"outlined"},style:{paddingLeft:11,paddingRight:11}},{props:{size:"small"},style:{paddingLeft:8,paddingRight:8}},{props:{size:"small",variant:"outlined"},style:{paddingLeft:7,paddingRight:7}}]});function sp(e){return"Backspace"===e.key||"Delete"===e.key}const ap=pe.forwardRef(function(e,t){const n=Eu({props:e,name:"MuiChip"}),{avatar:r,className:o,clickable:i,color:a="default",component:l,deleteIcon:c,disabled:u=!1,icon:d,label:A,onClick:h,onDelete:p,onKeyDown:f,onKeyUp:g,size:m="medium",variant:y="filled",tabIndex:v,skipFocusWhenDisabled:b=!1,slots:w={},slotProps:x={},..._}=n,C=Ou(pe.useRef(null),t),S=e=>{e.stopPropagation(),p&&p(e)},E=!(!1===i||!h)||i,B=E||p?Ud:l||"div",I={...n,component:B,disabled:u,size:m,color:a,iconColor:pe.isValidElement(d)&&d.props.color||a,onDelete:!!p,clickable:E,variant:y},R=(e=>{const{classes:t,disabled:n,size:r,color:o,iconColor:i,onDelete:s,clickable:a,variant:l}=e;return Ti({root:["root",l,n&&"disabled",`size${vr(r)}`,`color${vr(o)}`,a&&"clickable",a&&`clickableColor${vr(o)}`,s&&"deletable",s&&`deletableColor${vr(o)}`,`${l}${vr(o)}`],label:["label",`label${vr(r)}`],avatar:["avatar",`avatar${vr(r)}`,`avatarColor${vr(o)}`],icon:["icon",`icon${vr(r)}`,`iconColor${vr(i)}`],deleteIcon:["deleteIcon",`deleteIcon${vr(r)}`,`deleteIconColor${vr(o)}`,`deleteIcon${vr(l)}Color${vr(o)}`]},np,t)})(I),k=B===Ud?{component:l||"div",focusVisibleClassName:R.focusVisible,...p&&{disableRipple:!0}}:{};let T=null;p&&(T=c&&pe.isValidElement(c)?pe.cloneElement(c,{className:Co(c.props.className,R.deleteIcon),onClick:S}):s.jsx(tp,{className:R.deleteIcon,onClick:S}));let P=null;r&&pe.isValidElement(r)&&(P=pe.cloneElement(r,{className:Co(R.avatar,r.props.className)}));let F=null;d&&pe.isValidElement(d)&&(F=pe.cloneElement(d,{className:Co(R.icon,d.props.className)}));const M={slots:w,slotProps:x},[L,U]=_d("root",{elementType:op,externalForwardedProps:{...M,..._},ownerState:I,shouldForwardComponentProp:!0,ref:C,className:Co(R.root,o),additionalProps:{disabled:!(!E||!u)||void 0,tabIndex:b&&u?-1:v,...k},getSlotProps:e=>({...e,onClick:t=>{e.onClick?.(t),h?.(t)},onKeyDown:t=>{e.onKeyDown?.(t),(e=>{e.currentTarget===e.target&&sp(e)&&e.preventDefault(),f&&f(e)})(t)},onKeyUp:t=>{e.onKeyUp?.(t),(e=>{e.currentTarget===e.target&&p&&sp(e)&&p(e),g&&g(e)})(t)}})}),[O,D]=_d("label",{elementType:ip,externalForwardedProps:M,ownerState:I,className:R.label});return s.jsxs(L,{as:B,...U,children:[P||F,s.jsx(O,{...D,children:A}),T]})});function lp(e){return parseInt(e,10)||0}const cp={visibility:"hidden",position:"absolute",overflow:"hidden",height:0,top:0,left:0,transform:"translateZ(0)"};function up(e){return function(e){for(const t in e)return!1;return!0}(e)||0===e.outerHeightStyle&&!e.overflowing}const dp=pe.forwardRef(function(e,t){const{onChange:n,maxRows:r,minRows:o=1,style:i,value:a,...l}=e,{current:c}=pe.useRef(null!=a),u=pe.useRef(null),d=Ou(t,u),A=pe.useRef(null),h=pe.useRef(null),p=pe.useCallback(()=>{const t=u.current,n=h.current;if(!t||!n)return;const i=Fu(t).getComputedStyle(t);if("0px"===i.width)return{outerHeightStyle:0,overflowing:!1};n.style.width=i.width,n.value=t.value||e.placeholder||"x","\n"===n.value.slice(-1)&&(n.value+=" ");const s=i.boxSizing,a=lp(i.paddingBottom)+lp(i.paddingTop),l=lp(i.borderBottomWidth)+lp(i.borderTopWidth),c=n.scrollHeight;n.value="x";const d=n.scrollHeight;let A=c;o&&(A=Math.max(Number(o)*d,A)),r&&(A=Math.min(Number(r)*d,A)),A=Math.max(A,d);return{outerHeightStyle:A+("border-box"===s?a+l:0),overflowing:Math.abs(A-c)<=1}},[r,o,e.placeholder]),f=Uu(()=>{const e=u.current,t=p();if(!e||!t||up(t))return!1;const n=t.outerHeightStyle;return null!=A.current&&A.current!==n}),g=pe.useCallback(()=>{const e=u.current,t=p();if(!e||!t||up(t))return;const n=t.outerHeightStyle;A.current!==n&&(A.current=n,e.style.height=`${n}px`),e.style.overflow=t.overflowing?"hidden":""},[p]),m=pe.useRef(-1);Qo(()=>{const e=Tu(g),t=u?.current;if(!t)return;const n=Fu(t);let r;return n.addEventListener("resize",e),"undefined"!=typeof ResizeObserver&&(r=new ResizeObserver(()=>{f()&&(r.unobserve(t),cancelAnimationFrame(m.current),g(),m.current=requestAnimationFrame(()=>{r.observe(t)}))}),r.observe(t)),()=>{e.clear(),cancelAnimationFrame(m.current),n.removeEventListener("resize",e),r&&r.disconnect()}},[p,g,f]),Qo(()=>{g()});return s.jsxs(pe.Fragment,{children:[s.jsx("textarea",{value:a,onChange:e=>{c||g();const t=e.target,r=t.value.length,o=t.value.endsWith("\n"),i=t.selectionStart===r;o&&i&&t.setSelectionRange(r,r),n&&n(e)},ref:d,rows:o,style:i,...l}),s.jsx("textarea",{"aria-hidden":!0,className:e.className,readOnly:!0,ref:h,tabIndex:-1,style:{...cp,...i,paddingTop:0,paddingBottom:0}})]})});function Ap({props:e,states:t,muiFormControl:n}){return t.reduce((t,r)=>(t[r]=e[r],n&&void 0===e[r]&&(t[r]=n[r]),t),{})}const hp=pe.createContext(void 0);function pp(){return pe.useContext(hp)}function fp(e){return null!=e&&!(Array.isArray(e)&&0===e.length)}function gp(e,t=!1){return e&&(fp(e.value)&&""!==e.value||t&&fp(e.defaultValue)&&""!==e.defaultValue)}function mp(e){return Eo("MuiInputBase",e)}const yp=Bo("MuiInputBase",["root","formControl","focused","disabled","adornedStart","adornedEnd","error","sizeSmall","multiline","colorSecondary","fullWidth","hiddenLabel","readOnly","input","inputSizeSmall","inputMultiline","inputTypeSearch","inputAdornedStart","inputAdornedEnd","inputHiddenLabel"]);var vp;const bp=(e,t)=>{const{ownerState:n}=e;return[t.root,n.formControl&&t.formControl,n.startAdornment&&t.adornedStart,n.endAdornment&&t.adornedEnd,n.error&&t.error,"small"===n.size&&t.sizeSmall,n.multiline&&t.multiline,n.color&&t[`color${vr(n.color)}`],n.fullWidth&&t.fullWidth,n.hiddenLabel&&t.hiddenLabel]},wp=(e,t)=>{const{ownerState:n}=e;return[t.input,"small"===n.size&&t.inputSizeSmall,n.multiline&&t.inputMultiline,"search"===n.type&&t.inputTypeSearch,n.startAdornment&&t.inputAdornedStart,n.endAdornment&&t.inputAdornedEnd,n.hiddenLabel&&t.inputHiddenLabel]},xp=la("div",{name:"MuiInputBase",slot:"Root",overridesResolver:bp})(Su(({theme:e})=>({...e.typography.body1,color:(e.vars||e).palette.text.primary,lineHeight:"1.4375em",boxSizing:"border-box",position:"relative",cursor:"text",display:"inline-flex",alignItems:"center",[`&.${yp.disabled}`]:{color:(e.vars||e).palette.text.disabled,cursor:"default"},variants:[{props:({ownerState:e})=>e.multiline,style:{padding:"4px 0 5px"}},{props:({ownerState:e,size:t})=>e.multiline&&"small"===t,style:{paddingTop:1}},{props:({ownerState:e})=>e.fullWidth,style:{width:"100%"}}]}))),_p=la("input",{name:"MuiInputBase",slot:"Input",overridesResolver:wp})(Su(({theme:e})=>{const t="light"===e.palette.mode,n={color:"currentColor",...e.vars?{opacity:e.vars.opacity.inputPlaceholder}:{opacity:t?.42:.5},transition:e.transitions.create("opacity",{duration:e.transitions.duration.shorter})},r={opacity:"0 !important"},o=e.vars?{opacity:e.vars.opacity.inputPlaceholder}:{opacity:t?.42:.5};return{font:"inherit",letterSpacing:"inherit",color:"currentColor",padding:"4px 0 5px",border:0,boxSizing:"content-box",background:"none",height:"1.4375em",margin:0,WebkitTapHighlightColor:"transparent",display:"block",minWidth:0,width:"100%","&::-webkit-input-placeholder":n,"&::-moz-placeholder":n,"&::-ms-input-placeholder":n,"&:focus":{outline:0},"&:invalid":{boxShadow:"none"},"&::-webkit-search-decoration":{WebkitAppearance:"none"},[`label[data-shrink=false] + .${yp.formControl} &`]:{"&::-webkit-input-placeholder":r,"&::-moz-placeholder":r,"&::-ms-input-placeholder":r,"&:focus::-webkit-input-placeholder":o,"&:focus::-moz-placeholder":o,"&:focus::-ms-input-placeholder":o},[`&.${yp.disabled}`]:{opacity:1,WebkitTextFillColor:(e.vars||e).palette.text.disabled},variants:[{props:({ownerState:e})=>!e.disableInjectingGlobalStyles,style:{animationName:"mui-auto-fill-cancel",animationDuration:"10ms","&:-webkit-autofill":{animationDuration:"5000s",animationName:"mui-auto-fill"}}},{props:{size:"small"},style:{paddingTop:1}},{props:({ownerState:e})=>e.multiline,style:{height:"auto",resize:"none",padding:0,paddingTop:0}},{props:{type:"search"},style:{MozAppearance:"textfield"}}]}})),Cp=(Sp={"@keyframes mui-auto-fill":{from:{display:"block"}},"@keyframes mui-auto-fill-cancel":{from:{display:"block"}}},function(e){return s.jsx(oa,{styles:"function"==typeof Sp?t=>Sp({theme:t,...e}):Sp})});var Sp;const Ep=pe.forwardRef(function(e,t){const n=Eu({props:e,name:"MuiInputBase"}),{"aria-describedby":r,autoComplete:o,autoFocus:i,className:a,color:l,components:c={},componentsProps:u={},defaultValue:d,disabled:A,disableInjectingGlobalStyles:h,endAdornment:p,error:f,fullWidth:g=!1,id:m,inputComponent:y="input",inputProps:v={},inputRef:b,margin:w,maxRows:x,minRows:_,multiline:C=!1,name:S,onBlur:E,onChange:B,onClick:I,onFocus:R,onKeyDown:k,onKeyUp:T,placeholder:P,readOnly:F,renderSuffix:M,rows:L,size:U,slotProps:O={},slots:D={},startAdornment:N,type:j="text",value:Q,...z}=n,H=null!=v.value?v.value:Q,{current:G}=pe.useRef(null!=H),V=pe.useRef(),W=pe.useCallback(e=>{},[]),$=Ou(V,b,v.ref,W),[K,X]=pe.useState(!1),Y=pp(),q=Ap({props:n,muiFormControl:Y,states:["color","disabled","error","hiddenLabel","size","required","filled"]});q.focused=Y?Y.focused:K,pe.useEffect(()=>{!Y&&A&&K&&(X(!1),E&&E())},[Y,A,K,E]);const J=Y&&Y.onFilled,Z=Y&&Y.onEmpty,ee=pe.useCallback(e=>{gp(e)?J&&J():Z&&Z()},[J,Z]);Qo(()=>{G&&ee({value:H})},[H,ee,G]);pe.useEffect(()=>{ee(V.current)},[]);let te=y,ne=v;C&&"input"===te&&(ne=L?{type:void 0,minRows:L,maxRows:L,...ne}:{type:void 0,maxRows:x,minRows:_,...ne},te=dp);pe.useEffect(()=>{Y&&Y.setAdornedStart(Boolean(N))},[Y,N]);const re={...n,color:q.color||"primary",disabled:q.disabled,endAdornment:p,error:q.error,focused:q.focused,formControl:Y,fullWidth:g,hiddenLabel:q.hiddenLabel,multiline:C,size:q.size,startAdornment:N,type:j},oe=(e=>{const{classes:t,color:n,disabled:r,error:o,endAdornment:i,focused:s,formControl:a,fullWidth:l,hiddenLabel:c,multiline:u,readOnly:d,size:A,startAdornment:h,type:p}=e;return Ti({root:["root",`color${vr(n)}`,r&&"disabled",o&&"error",l&&"fullWidth",s&&"focused",a&&"formControl",A&&"medium"!==A&&`size${vr(A)}`,u&&"multiline",h&&"adornedStart",i&&"adornedEnd",c&&"hiddenLabel",d&&"readOnly"],input:["input",r&&"disabled","search"===p&&"inputTypeSearch",u&&"inputMultiline","small"===A&&"inputSizeSmall",c&&"inputHiddenLabel",h&&"inputAdornedStart",i&&"inputAdornedEnd",d&&"readOnly"]},mp,t)})(re),ie=D.root||c.Root||xp,se=O.root||u.root||{},ae=D.input||c.Input||_p;return ne={...ne,...O.input??u.input},s.jsxs(pe.Fragment,{children:[!h&&"function"==typeof Cp&&(vp||(vp=s.jsx(Cp,{}))),s.jsxs(ie,{...se,ref:t,onClick:e=>{V.current&&e.currentTarget===e.target&&V.current.focus(),I&&I(e)},...z,...!md(ie)&&{ownerState:{...re,...se.ownerState}},className:Co(oe.root,se.className,a,F&&"MuiInputBase-readOnly"),children:[N,s.jsx(hp.Provider,{value:null,children:s.jsx(ae,{"aria-invalid":q.error,"aria-describedby":r,autoComplete:o,autoFocus:i,defaultValue:d,disabled:q.disabled,id:m,onAnimationStart:e=>{ee("mui-auto-fill-cancel"===e.animationName?V.current:{value:"x"})},name:S,placeholder:P,readOnly:F,required:q.required,rows:L,value:H,onKeyDown:k,onKeyUp:T,type:j,...ne,...!md(ae)&&{as:te,ownerState:{...re,...ne.ownerState}},ref:$,className:Co(oe.input,ne.className,F&&"MuiInputBase-readOnly"),onBlur:e=>{E&&E(e),v.onBlur&&v.onBlur(e),Y&&Y.onBlur?Y.onBlur(e):X(!1)},onChange:(e,...t)=>{if(!G){const t=e.target||V.current;if(null==t)throw new Error($e(1));ee({value:t.value})}v.onChange&&v.onChange(e,...t),B&&B(e,...t)},onFocus:e=>{R&&R(e),v.onFocus&&v.onFocus(e),Y&&Y.onFocus?Y.onFocus(e):X(!0)}})}),p,M?M({...q,startAdornment:N}):null]})]})});function Bp(e){return Eo("MuiInput",e)}const Ip={...yp,...Bo("MuiInput",["root","underline","input"])};function Rp(e){return Eo("MuiOutlinedInput",e)}const kp={...yp,...Bo("MuiOutlinedInput",["root","notchedOutline","input"])};function Tp(e){return Eo("MuiFilledInput",e)}const Pp={...yp,...Bo("MuiFilledInput",["root","underline","input","adornedStart","adornedEnd","sizeSmall","multiline","hiddenLabel"])},Fp=ku(s.jsx("path",{d:"M7 10l5 5 5-5z"}));function Mp(e){return Eo("MuiAutocomplete",e)}const Lp=Bo("MuiAutocomplete",["root","expanded","fullWidth","focused","focusVisible","tag","tagSizeSmall","tagSizeMedium","hasPopupIcon","hasClearIcon","inputRoot","input","inputFocused","endAdornment","clearIndicator","popupIndicator","popupIndicatorOpen","popper","popperDisablePortal","paper","listbox","loading","noOptions","option","groupLabel","groupUl"]);var Up,Op;const Dp=la("div",{name:"MuiAutocomplete",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:n}=e,{fullWidth:r,hasClearIcon:o,hasPopupIcon:i,inputFocused:s,size:a}=n;return[{[`& .${Lp.tag}`]:t.tag},{[`& .${Lp.tag}`]:t[`tagSize${vr(a)}`]},{[`& .${Lp.inputRoot}`]:t.inputRoot},{[`& .${Lp.input}`]:t.input},{[`& .${Lp.input}`]:s&&t.inputFocused},t.root,r&&t.fullWidth,i&&t.hasPopupIcon,o&&t.hasClearIcon]}})({[`&.${Lp.focused} .${Lp.clearIndicator}`]:{visibility:"visible"},"@media (pointer: fine)":{[`&:hover .${Lp.clearIndicator}`]:{visibility:"visible"}},[`& .${Lp.tag}`]:{margin:3,maxWidth:"calc(100% - 6px)"},[`& .${Lp.inputRoot}`]:{[`.${Lp.hasPopupIcon}&, .${Lp.hasClearIcon}&`]:{paddingRight:30},[`.${Lp.hasPopupIcon}.${Lp.hasClearIcon}&`]:{paddingRight:56},[`& .${Lp.input}`]:{width:0,minWidth:30}},[`& .${Ip.root}`]:{paddingBottom:1,"& .MuiInput-input":{padding:"4px 4px 4px 0px"}},[`& .${Ip.root}.${yp.sizeSmall}`]:{[`& .${Ip.input}`]:{padding:"2px 4px 3px 0"}},[`& .${kp.root}`]:{padding:9,[`.${Lp.hasPopupIcon}&, .${Lp.hasClearIcon}&`]:{paddingRight:39},[`.${Lp.hasPopupIcon}.${Lp.hasClearIcon}&`]:{paddingRight:65},[`& .${Lp.input}`]:{padding:"7.5px 4px 7.5px 5px"},[`& .${Lp.endAdornment}`]:{right:9}},[`& .${kp.root}.${yp.sizeSmall}`]:{paddingTop:6,paddingBottom:6,paddingLeft:6,[`& .${Lp.input}`]:{padding:"2.5px 4px 2.5px 8px"}},[`& .${Pp.root}`]:{paddingTop:19,paddingLeft:8,[`.${Lp.hasPopupIcon}&, .${Lp.hasClearIcon}&`]:{paddingRight:39},[`.${Lp.hasPopupIcon}.${Lp.hasClearIcon}&`]:{paddingRight:65},[`& .${Pp.input}`]:{padding:"7px 4px"},[`& .${Lp.endAdornment}`]:{right:9}},[`& .${Pp.root}.${yp.sizeSmall}`]:{paddingBottom:1,[`& .${Pp.input}`]:{padding:"2.5px 4px"}},[`& .${yp.hiddenLabel}`]:{paddingTop:8},[`& .${Pp.root}.${yp.hiddenLabel}`]:{paddingTop:0,paddingBottom:0,[`& .${Lp.input}`]:{paddingTop:16,paddingBottom:17}},[`& .${Pp.root}.${yp.hiddenLabel}.${yp.sizeSmall}`]:{[`& .${Lp.input}`]:{paddingTop:8,paddingBottom:9}},[`& .${Lp.input}`]:{flexGrow:1,textOverflow:"ellipsis",opacity:0},variants:[{props:{fullWidth:!0},style:{width:"100%"}},{props:{size:"small"},style:{[`& .${Lp.tag}`]:{margin:2,maxWidth:"calc(100% - 4px)"}}},{props:{inputFocused:!0},style:{[`& .${Lp.input}`]:{opacity:1}}},{props:{multiple:!0},style:{[`& .${Lp.inputRoot}`]:{flexWrap:"wrap"}}}]}),Np=la("div",{name:"MuiAutocomplete",slot:"EndAdornment"})({position:"absolute",right:0,top:"50%",transform:"translate(0, -50%)"}),jp=la(tA,{name:"MuiAutocomplete",slot:"ClearIndicator"})({marginRight:-2,padding:4,visibility:"hidden"}),Qp=la(tA,{name:"MuiAutocomplete",slot:"PopupIndicator",overridesResolver:(e,t)=>{const{ownerState:n}=e;return[t.popupIndicator,n.popupOpen&&t.popupIndicatorOpen]}})({padding:2,marginRight:-2,variants:[{props:{popupOpen:!0},style:{transform:"rotate(180deg)"}}]}),zp=la(qh,{name:"MuiAutocomplete",slot:"Popper",overridesResolver:(e,t)=>{const{ownerState:n}=e;return[{[`& .${Lp.option}`]:t.option},t.popper,n.disablePortal&&t.popperDisablePortal]}})(Su(({theme:e})=>({zIndex:(e.vars||e).zIndex.modal,variants:[{props:{disablePortal:!0},style:{position:"absolute"}}]}))),Hp=la(gd,{name:"MuiAutocomplete",slot:"Paper"})(Su(({theme:e})=>({...e.typography.body1,overflow:"auto"}))),Gp=la("div",{name:"MuiAutocomplete",slot:"Loading"})(Su(({theme:e})=>({color:(e.vars||e).palette.text.secondary,padding:"14px 16px"}))),Vp=la("div",{name:"MuiAutocomplete",slot:"NoOptions"})(Su(({theme:e})=>({color:(e.vars||e).palette.text.secondary,padding:"14px 16px"}))),Wp=la("ul",{name:"MuiAutocomplete",slot:"Listbox"})(Su(({theme:e})=>({listStyle:"none",margin:0,padding:"8px 0",maxHeight:"40vh",overflow:"auto",position:"relative",[`& .${Lp.option}`]:{minHeight:48,display:"flex",overflow:"hidden",justifyContent:"flex-start",alignItems:"center",cursor:"pointer",paddingTop:6,boxSizing:"border-box",outline:"0",WebkitTapHighlightColor:"transparent",paddingBottom:6,paddingLeft:16,paddingRight:16,[e.breakpoints.up("sm")]:{minHeight:"auto"},[`&.${Lp.focused}`]:{backgroundColor:(e.vars||e).palette.action.hover,"@media (hover: none)":{backgroundColor:"transparent"}},'&[aria-disabled="true"]':{opacity:(e.vars||e).palette.action.disabledOpacity,pointerEvents:"none"},[`&.${Lp.focusVisible}`]:{backgroundColor:(e.vars||e).palette.action.focus},'&[aria-selected="true"]':{backgroundColor:e.alpha((e.vars||e).palette.primary.main,(e.vars||e).palette.action.selectedOpacity),[`&.${Lp.focused}`]:{backgroundColor:e.alpha((e.vars||e).palette.primary.main,`${(e.vars||e).palette.action.selectedOpacity} + ${(e.vars||e).palette.action.hoverOpacity}`),"@media (hover: none)":{backgroundColor:(e.vars||e).palette.action.selected}},[`&.${Lp.focusVisible}`]:{backgroundColor:e.alpha((e.vars||e).palette.primary.main,`${(e.vars||e).palette.action.selectedOpacity} + ${(e.vars||e).palette.action.focusOpacity}`)}}}}))),$p=la(ep,{name:"MuiAutocomplete",slot:"GroupLabel"})(Su(({theme:e})=>({backgroundColor:(e.vars||e).palette.background.paper,top:-8}))),Kp=la("ul",{name:"MuiAutocomplete",slot:"GroupUl"})({padding:0,[`& .${Lp.option}`]:{paddingLeft:24}}),Xp=pe.forwardRef(function(e,t){const n=Eu({props:e,name:"MuiAutocomplete"}),{autoComplete:r=!1,autoHighlight:o=!1,autoSelect:i=!1,blurOnSelect:a=!1,ChipProps:l,className:c,clearIcon:u=Up||(Up=s.jsx(sA,{fontSize:"small"})),clearOnBlur:d=!n.freeSolo,clearOnEscape:A=!1,clearText:h="Clear",closeText:p="Close",componentsProps:f,defaultValue:g=(n.multiple?[]:null),disableClearable:m=!1,disableCloseOnSelect:y=!1,disabled:v=!1,disabledItemsFocusable:b=!1,disableListWrap:w=!1,disablePortal:x=!1,filterOptions:_,filterSelectedOptions:C=!1,forcePopupIcon:S="auto",freeSolo:E=!1,fullWidth:B=!1,getLimitTagsText:I=e=>`+${e}`,getOptionDisabled:R,getOptionKey:k,getOptionLabel:T,isOptionEqualToValue:P,groupBy:F,handleHomeEndKeys:M=!n.freeSolo,id:L,includeInputInList:U=!1,inputValue:O,limitTags:D=-1,ListboxComponent:N,ListboxProps:j,loading:Q=!1,loadingText:z="Loading",multiple:H=!1,noOptionsText:G="No options",onChange:V,onClose:W,onHighlightChange:$,onInputChange:K,onOpen:X,open:Y,openOnFocus:q=!1,openText:J="Open",options:Z,PaperComponent:ee,PopperComponent:te,popupIcon:ne=Op||(Op=s.jsx(Fp,{})),readOnly:re=!1,renderGroup:oe,renderInput:ie,renderOption:se,renderTags:ae,renderValue:le,selectOnFocus:ce=!n.freeSolo,size:ue="medium",slots:de={},slotProps:Ae={},value:he,...fe}=n,{getRootProps:ge,getInputProps:me,getInputLabelProps:ye,getPopupIndicatorProps:ve,getClearProps:be,getItemProps:we,getListboxProps:xe,getOptionProps:_e,value:Ce,dirty:Se,expanded:Ee,id:Be,popupOpen:Ie,focused:Re,focusedItem:ke,anchorEl:Te,setAnchorEl:Pe,inputValue:Fe,groupedOptions:Me}=EA({...n,componentName:"Autocomplete"}),Le=!m&&!v&&Se&&!re,Ue=(!E||!0===S)&&!1!==S,{onMouseDown:Oe}=me(),{ref:De,...Ne}=xe(),je=T||(e=>e.label??e),Qe={...n,disablePortal:x,expanded:Ee,focused:Re,fullWidth:B,getOptionLabel:je,hasClearIcon:Le,hasPopupIcon:Ue,inputFocused:-1===ke,popupOpen:Ie,size:ue},ze=(e=>{const{classes:t,disablePortal:n,expanded:r,focused:o,fullWidth:i,hasClearIcon:s,hasPopupIcon:a,inputFocused:l,popupOpen:c,size:u}=e;return Ti({root:["root",r&&"expanded",o&&"focused",i&&"fullWidth",s&&"hasClearIcon",a&&"hasPopupIcon"],inputRoot:["inputRoot"],input:["input",l&&"inputFocused"],tag:["tag",`tagSize${vr(u)}`],endAdornment:["endAdornment"],clearIndicator:["clearIndicator"],popupIndicator:["popupIndicator",c&&"popupIndicatorOpen"],popper:["popper",n&&"popperDisablePortal"],paper:["paper"],listbox:["listbox"],loading:["loading"],noOptions:["noOptions"],option:["option"],groupLabel:["groupLabel"],groupUl:["groupUl"]},Mp,t)})(Qe),He={slots:{paper:ee,popper:te,...de},slotProps:{chip:l,listbox:j,...f,...Ae}},[Ge,Ve]=_d("listbox",{elementType:Wp,externalForwardedProps:He,ownerState:Qe,className:ze.listbox,additionalProps:Ne,ref:De}),[We,$e]=_d("paper",{elementType:gd,externalForwardedProps:He,ownerState:Qe,className:ze.paper}),[Ke,Xe]=_d("popper",{elementType:qh,externalForwardedProps:He,ownerState:Qe,className:ze.popper,additionalProps:{disablePortal:x,style:{width:Te?Te.clientWidth:null},role:"presentation",anchorEl:Te,open:Ie}});let Ye;const qe=e=>({className:ze.tag,disabled:v,...we(e)});if(H?Ce.length>0&&(Ye=ae?ae(Ce,qe,Qe):le?le(Ce,qe,Qe):Ce.map((e,t)=>{const{key:n,...r}=qe({index:t});return s.jsx(ap,{label:je(e),size:ue,...r,...He.slotProps.chip},n)})):le&&null!=Ce&&(Ye=le(Ce,qe,Qe)),D>-1&&Array.isArray(Ye)){const e=Ye.length-D;!Re&&e>0&&(Ye=Ye.splice(0,D),Ye.push(s.jsx("span",{className:ze.tag,children:I(e)},Ye.length)))}const Je=oe||(e=>s.jsxs("li",{children:[s.jsx($p,{className:ze.groupLabel,ownerState:Qe,component:"div",children:e.group}),s.jsx(Kp,{className:ze.groupUl,ownerState:Qe,children:e.children})]},e.key)),Ze=se||((e,t)=>{const{key:n,...r}=e;return s.jsx("li",{...r,children:je(t)},n)}),et=(e,t)=>{const n=_e({option:e,index:t});return Ze({...n,className:ze.option},e,{selected:n["aria-selected"],index:t,inputValue:Fe},Qe)},tt=He.slotProps.clearIndicator,nt=He.slotProps.popupIndicator;return s.jsxs(pe.Fragment,{children:[s.jsx(Dp,{ref:t,className:Co(ze.root,c),ownerState:Qe,...ge(fe),children:ie({id:Be,disabled:v,fullWidth:!0,size:"small"===ue?"small":void 0,InputLabelProps:ye(),InputProps:{ref:Pe,className:ze.inputRoot,startAdornment:Ye,onMouseDown:e=>{e.target===e.currentTarget&&Oe(e)},...(Le||Ue)&&{endAdornment:s.jsxs(Np,{className:ze.endAdornment,ownerState:Qe,children:[Le?s.jsx(jp,{...be(),"aria-label":h,title:h,ownerState:Qe,...tt,className:Co(ze.clearIndicator,tt?.className),children:u}):null,Ue?s.jsx(Qp,{...ve(),disabled:v,"aria-label":Ie?p:J,title:Ie?p:J,ownerState:Qe,...nt,className:Co(ze.popupIndicator,nt?.className),children:ne}):null]})}},inputProps:{className:ze.input,disabled:v,readOnly:re,...me()}})}),Te?s.jsx(zp,{as:Ke,...Xe,children:s.jsxs(Hp,{as:We,...$e,children:[Q&&0===Me.length?s.jsx(Gp,{className:ze.loading,ownerState:Qe,children:z}):null,0!==Me.length||E||Q?null:s.jsx(Vp,{className:ze.noOptions,ownerState:Qe,role:"presentation",onMouseDown:e=>{e.preventDefault()},children:G}),Me.length>0?s.jsx(Ge,{as:N,...Ve,children:Me.map((e,t)=>F?Je({key:e.key,group:e.group,children:e.options.map((t,n)=>et(t,e.index+n))}):et(e,t))}):null]})}):null]})}),Yp={entering:{opacity:1},entered:{opacity:1}},qp=pe.forwardRef(function(e,t){const n=ia(),r={enter:n.transitions.duration.enteringScreen,exit:n.transitions.duration.leavingScreen},{addEndListener:o,appear:i=!0,children:a,easing:l,in:c,onEnter:u,onEntered:d,onEntering:A,onExit:h,onExited:p,onExiting:f,style:g,timeout:m=r,TransitionComponent:y=Xu,...v}=e,b=pe.useRef(null),w=Ou(b,Gh(a),t),x=e=>t=>{if(e){const n=b.current;void 0===t?e(n):e(n,t)}},_=x(A),C=x((e,t)=>{ad(e);const r=ld({style:g,timeout:m,easing:l},{mode:"enter"});e.style.webkitTransition=n.transitions.create("opacity",r),e.style.transition=n.transitions.create("opacity",r),u&&u(e,t)}),S=x(d),E=x(f),B=x(e=>{const t=ld({style:g,timeout:m,easing:l},{mode:"exit"});e.style.webkitTransition=n.transitions.create("opacity",t),e.style.transition=n.transitions.create("opacity",t),h&&h(e)}),I=x(p);return s.jsx(y,{appear:i,in:c,nodeRef:b,onEnter:C,onEntered:S,onEntering:_,onExit:B,onExited:I,onExiting:E,addEndListener:e=>{o&&o(b.current,e)},timeout:m,...v,children:(e,{ownerState:t,...n})=>pe.cloneElement(a,{style:{opacity:0,visibility:"exited"!==e||c?void 0:"hidden",...Yp[e],...g,...a.props.style},ref:w,...n})})});function Jp(e){return Eo("MuiBackdrop",e)}Bo("MuiBackdrop",["root","invisible"]);const Zp=la("div",{name:"MuiBackdrop",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:n}=e;return[t.root,n.invisible&&t.invisible]}})({position:"fixed",display:"flex",alignItems:"center",justifyContent:"center",right:0,bottom:0,top:0,left:0,backgroundColor:"rgba(0, 0, 0, 0.5)",WebkitTapHighlightColor:"transparent",variants:[{props:{invisible:!0},style:{backgroundColor:"transparent"}}]}),ef=pe.forwardRef(function(e,t){const n=Eu({props:e,name:"MuiBackdrop"}),{children:r,className:o,component:i="div",invisible:a=!1,open:l,components:c={},componentsProps:u={},slotProps:d={},slots:A={},TransitionComponent:h,transitionDuration:p,...f}=n,g={...n,component:i,invisible:a},m=(e=>{const{classes:t,invisible:n}=e;return Ti({root:["root",n&&"invisible"]},Jp,t)})(g),y={component:i,slots:{transition:h,root:c.Root,...A},slotProps:{...u,...d}},[v,b]=_d("root",{elementType:Zp,externalForwardedProps:y,className:Co(m.root,o),ownerState:g}),[w,x]=_d("transition",{elementType:qp,externalForwardedProps:y,ownerState:g});return s.jsx(w,{in:l,timeout:p,...f,...x,children:s.jsx(v,{"aria-hidden":!0,...b,classes:m,ref:t,children:r})})}),tf=Bo("MuiBox",["root"]),nf=ta(),rf=function(e={}){const{themeId:t,defaultTheme:n,defaultClassName:r="MuiBox-root",generateClassName:o}=e,i=Xn("div",{shouldForwardProp:e=>"theme"!==e&&"sx"!==e&&"as"!==e})(Ao);return pe.forwardRef(function(e,a){const l=mo(n),{className:c,component:u="div",...d}=bo(e);return s.jsx(i,{as:u,ref:a,className:Co(c,o?o(r):r),theme:t&&l[t]||l,...d})})}({themeId:ra,defaultTheme:nf,defaultClassName:tf.root,generateClassName:xo.generate});function of(e){return Eo("MuiButton",e)}const sf=Bo("MuiButton",["root","text","textInherit","textPrimary","textSecondary","textSuccess","textError","textInfo","textWarning","outlined","outlinedInherit","outlinedPrimary","outlinedSecondary","outlinedSuccess","outlinedError","outlinedInfo","outlinedWarning","contained","containedInherit","containedPrimary","containedSecondary","containedSuccess","containedError","containedInfo","containedWarning","disableElevation","focusVisible","disabled","colorInherit","colorPrimary","colorSecondary","colorSuccess","colorError","colorInfo","colorWarning","textSizeSmall","textSizeMedium","textSizeLarge","outlinedSizeSmall","outlinedSizeMedium","outlinedSizeLarge","containedSizeSmall","containedSizeMedium","containedSizeLarge","sizeMedium","sizeSmall","sizeLarge","fullWidth","startIcon","endIcon","icon","iconSizeSmall","iconSizeMedium","iconSizeLarge","loading","loadingWrapper","loadingIconPlaceholder","loadingIndicator","loadingPositionCenter","loadingPositionStart","loadingPositionEnd"]),af=pe.createContext({}),lf=pe.createContext(void 0),cf=[{props:{size:"small"},style:{"& > *:nth-of-type(1)":{fontSize:18}}},{props:{size:"medium"},style:{"& > *:nth-of-type(1)":{fontSize:20}}},{props:{size:"large"},style:{"& > *:nth-of-type(1)":{fontSize:22}}}],uf=la(Ud,{shouldForwardProp:e=>aa(e)||"classes"===e,name:"MuiButton",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:n}=e;return[t.root,t[n.variant],t[`${n.variant}${vr(n.color)}`],t[`size${vr(n.size)}`],t[`${n.variant}Size${vr(n.size)}`],"inherit"===n.color&&t.colorInherit,n.disableElevation&&t.disableElevation,n.fullWidth&&t.fullWidth,n.loading&&t.loading]}})(Su(({theme:e})=>{const t="light"===e.palette.mode?e.palette.grey[300]:e.palette.grey[800],n="light"===e.palette.mode?e.palette.grey.A100:e.palette.grey[700];return{...e.typography.button,minWidth:64,padding:"6px 16px",border:0,borderRadius:(e.vars||e).shape.borderRadius,transition:e.transitions.create(["background-color","box-shadow","border-color","color"],{duration:e.transitions.duration.short}),"&:hover":{textDecoration:"none"},[`&.${sf.disabled}`]:{color:(e.vars||e).palette.action.disabled},variants:[{props:{variant:"contained"},style:{color:"var(--variant-containedColor)",backgroundColor:"var(--variant-containedBg)",boxShadow:(e.vars||e).shadows[2],"&:hover":{boxShadow:(e.vars||e).shadows[4],"@media (hover: none)":{boxShadow:(e.vars||e).shadows[2]}},"&:active":{boxShadow:(e.vars||e).shadows[8]},[`&.${sf.focusVisible}`]:{boxShadow:(e.vars||e).shadows[6]},[`&.${sf.disabled}`]:{color:(e.vars||e).palette.action.disabled,boxShadow:(e.vars||e).shadows[0],backgroundColor:(e.vars||e).palette.action.disabledBackground}}},{props:{variant:"outlined"},style:{padding:"5px 15px",border:"1px solid currentColor",borderColor:"var(--variant-outlinedBorder, currentColor)",backgroundColor:"var(--variant-outlinedBg)",color:"var(--variant-outlinedColor)",[`&.${sf.disabled}`]:{border:`1px solid ${(e.vars||e).palette.action.disabledBackground}`}}},{props:{variant:"text"},style:{padding:"6px 8px",color:"var(--variant-textColor)",backgroundColor:"var(--variant-textBg)"}},...Object.entries(e.palette).filter(Dd()).map(([t])=>({props:{color:t},style:{"--variant-textColor":(e.vars||e).palette[t].main,"--variant-outlinedColor":(e.vars||e).palette[t].main,"--variant-outlinedBorder":e.alpha((e.vars||e).palette[t].main,.5),"--variant-containedColor":(e.vars||e).palette[t].contrastText,"--variant-containedBg":(e.vars||e).palette[t].main,"@media (hover: hover)":{"&:hover":{"--variant-containedBg":(e.vars||e).palette[t].dark,"--variant-textBg":e.alpha((e.vars||e).palette[t].main,(e.vars||e).palette.action.hoverOpacity),"--variant-outlinedBorder":(e.vars||e).palette[t].main,"--variant-outlinedBg":e.alpha((e.vars||e).palette[t].main,(e.vars||e).palette.action.hoverOpacity)}}}})),{props:{color:"inherit"},style:{color:"inherit",borderColor:"currentColor","--variant-containedBg":e.vars?e.vars.palette.Button.inheritContainedBg:t,"@media (hover: hover)":{"&:hover":{"--variant-containedBg":e.vars?e.vars.palette.Button.inheritContainedHoverBg:n,"--variant-textBg":e.alpha((e.vars||e).palette.text.primary,(e.vars||e).palette.action.hoverOpacity),"--variant-outlinedBg":e.alpha((e.vars||e).palette.text.primary,(e.vars||e).palette.action.hoverOpacity)}}}},{props:{size:"small",variant:"text"},style:{padding:"4px 5px",fontSize:e.typography.pxToRem(13)}},{props:{size:"large",variant:"text"},style:{padding:"8px 11px",fontSize:e.typography.pxToRem(15)}},{props:{size:"small",variant:"outlined"},style:{padding:"3px 9px",fontSize:e.typography.pxToRem(13)}},{props:{size:"large",variant:"outlined"},style:{padding:"7px 21px",fontSize:e.typography.pxToRem(15)}},{props:{size:"small",variant:"contained"},style:{padding:"4px 10px",fontSize:e.typography.pxToRem(13)}},{props:{size:"large",variant:"contained"},style:{padding:"8px 22px",fontSize:e.typography.pxToRem(15)}},{props:{disableElevation:!0},style:{boxShadow:"none","&:hover":{boxShadow:"none"},[`&.${sf.focusVisible}`]:{boxShadow:"none"},"&:active":{boxShadow:"none"},[`&.${sf.disabled}`]:{boxShadow:"none"}}},{props:{fullWidth:!0},style:{width:"100%"}},{props:{loadingPosition:"center"},style:{transition:e.transitions.create(["background-color","box-shadow","border-color"],{duration:e.transitions.duration.short}),[`&.${sf.loading}`]:{color:"transparent"}}}]}})),df=la("span",{name:"MuiButton",slot:"StartIcon",overridesResolver:(e,t)=>{const{ownerState:n}=e;return[t.startIcon,n.loading&&t.startIconLoadingStart,t[`iconSize${vr(n.size)}`]]}})(({theme:e})=>({display:"inherit",marginRight:8,marginLeft:-4,variants:[{props:{size:"small"},style:{marginLeft:-2}},{props:{loadingPosition:"start",loading:!0},style:{transition:e.transitions.create(["opacity"],{duration:e.transitions.duration.short}),opacity:0}},{props:{loadingPosition:"start",loading:!0,fullWidth:!0},style:{marginRight:-8}},...cf]})),Af=la("span",{name:"MuiButton",slot:"EndIcon",overridesResolver:(e,t)=>{const{ownerState:n}=e;return[t.endIcon,n.loading&&t.endIconLoadingEnd,t[`iconSize${vr(n.size)}`]]}})(({theme:e})=>({display:"inherit",marginRight:-4,marginLeft:8,variants:[{props:{size:"small"},style:{marginRight:-2}},{props:{loadingPosition:"end",loading:!0},style:{transition:e.transitions.create(["opacity"],{duration:e.transitions.duration.short}),opacity:0}},{props:{loadingPosition:"end",loading:!0,fullWidth:!0},style:{marginLeft:-8}},...cf]})),hf=la("span",{name:"MuiButton",slot:"LoadingIndicator"})(({theme:e})=>({display:"none",position:"absolute",visibility:"visible",variants:[{props:{loading:!0},style:{display:"flex"}},{props:{loadingPosition:"start"},style:{left:14}},{props:{loadingPosition:"start",size:"small"},style:{left:10}},{props:{variant:"text",loadingPosition:"start"},style:{left:6}},{props:{loadingPosition:"center"},style:{left:"50%",transform:"translate(-50%)",color:(e.vars||e).palette.action.disabled}},{props:{loadingPosition:"end"},style:{right:14}},{props:{loadingPosition:"end",size:"small"},style:{right:10}},{props:{variant:"text",loadingPosition:"end"},style:{right:6}},{props:{loadingPosition:"start",fullWidth:!0},style:{position:"relative",left:-10}},{props:{loadingPosition:"end",fullWidth:!0},style:{position:"relative",right:-10}}]})),pf=la("span",{name:"MuiButton",slot:"LoadingIconPlaceholder"})({display:"inline-block",width:"1em",height:"1em"}),ff=pe.forwardRef(function(e,t){const n=pe.useContext(af),r=pe.useContext(lf),o=Eu({props:No(n,e),name:"MuiButton"}),{children:i,color:a="primary",component:l="button",className:c,disabled:u=!1,disableElevation:d=!1,disableFocusRipple:A=!1,endIcon:h,focusVisibleClassName:p,fullWidth:f=!1,id:g,loading:m=null,loadingIndicator:y,loadingPosition:v="center",size:b="medium",startIcon:w,type:x,variant:_="text",...C}=o,S=pi(g),E=y??s.jsx(Yd,{"aria-labelledby":S,color:"inherit",size:16}),B={...o,color:a,component:l,disabled:u,disableElevation:d,disableFocusRipple:A,fullWidth:f,loading:m,loadingIndicator:E,loadingPosition:v,size:b,type:x,variant:_},I=(e=>{const{color:t,disableElevation:n,fullWidth:r,size:o,variant:i,loading:s,loadingPosition:a,classes:l}=e,c=Ti({root:["root",s&&"loading",i,`${i}${vr(t)}`,`size${vr(o)}`,`${i}Size${vr(o)}`,`color${vr(t)}`,n&&"disableElevation",r&&"fullWidth",s&&`loadingPosition${vr(a)}`],startIcon:["icon","startIcon",`iconSize${vr(o)}`],endIcon:["icon","endIcon",`iconSize${vr(o)}`],loadingIndicator:["loadingIndicator"],loadingWrapper:["loadingWrapper"]},of,l);return{...l,...c}})(B),R=(w||m&&"start"===v)&&s.jsx(df,{className:I.startIcon,ownerState:B,children:w||s.jsx(pf,{className:I.loadingIconPlaceholder,ownerState:B})}),k=(h||m&&"end"===v)&&s.jsx(Af,{className:I.endIcon,ownerState:B,children:h||s.jsx(pf,{className:I.loadingIconPlaceholder,ownerState:B})}),T=r||"",P="boolean"==typeof m?s.jsx("span",{className:I.loadingWrapper,style:{display:"contents"},children:m&&s.jsx(hf,{className:I.loadingIndicator,ownerState:B,children:E})}):null;return s.jsxs(uf,{ownerState:B,className:Co(n.className,I.root,c,T),component:l,disabled:u||m,focusRipple:!A,focusVisibleClassName:Co(I.focusVisible,p),ref:t,type:x,id:m?S:g,...C,classes:I,children:[R,"end"!==v&&P,i,"end"===v&&P,k]})});function gf(e){return Eo("MuiCard",e)}Bo("MuiCard",["root"]);const mf=la(gd,{name:"MuiCard",slot:"Root"})({overflow:"hidden"}),yf=pe.forwardRef(function(e,t){const n=Eu({props:e,name:"MuiCard"}),{className:r,raised:o=!1,...i}=n,a={...n,raised:o},l=(e=>{const{classes:t}=e;return Ti({root:["root"]},gf,t)})(a);return s.jsx(mf,{className:Co(l.root,r),elevation:o?8:void 0,ref:t,ownerState:a,...i})});function vf(e){return Eo("MuiCardActionArea",e)}const bf=Bo("MuiCardActionArea",["root","focusVisible","focusHighlight"]),wf=la(Ud,{name:"MuiCardActionArea",slot:"Root"})(Su(({theme:e})=>({display:"block",textAlign:"inherit",borderRadius:"inherit",width:"100%",[`&:hover .${bf.focusHighlight}`]:{opacity:(e.vars||e).palette.action.hoverOpacity,"@media (hover: none)":{opacity:0}},[`&.${bf.focusVisible} .${bf.focusHighlight}`]:{opacity:(e.vars||e).palette.action.focusOpacity}}))),xf=la("span",{name:"MuiCardActionArea",slot:"FocusHighlight"})(Su(({theme:e})=>({overflow:"hidden",pointerEvents:"none",position:"absolute",top:0,right:0,bottom:0,left:0,borderRadius:"inherit",opacity:0,backgroundColor:"currentcolor",transition:e.transitions.create("opacity",{duration:e.transitions.duration.short})}))),_f=pe.forwardRef(function(e,t){const n=Eu({props:e,name:"MuiCardActionArea"}),{children:r,className:o,focusVisibleClassName:i,slots:a={},slotProps:l={},...c}=n,u=n,d=(e=>{const{classes:t}=e;return Ti({root:["root"],focusHighlight:["focusHighlight"]},vf,t)})(u),A={slots:a,slotProps:l},[h,p]=_d("root",{elementType:wf,externalForwardedProps:{...A,...c},shouldForwardComponentProp:!0,ownerState:u,ref:t,className:Co(d.root,o),additionalProps:{focusVisibleClassName:Co(i,d.focusVisible)}}),[f,g]=_d("focusHighlight",{elementType:xf,externalForwardedProps:A,ownerState:u,ref:t,className:d.focusHighlight});return s.jsxs(h,{...p,children:[r,s.jsx(f,{...g})]})});function Cf(e){return Eo("MuiCardContent",e)}Bo("MuiCardContent",["root"]);const Sf=la("div",{name:"MuiCardContent",slot:"Root"})({padding:16,"&:last-child":{paddingBottom:24}}),Ef=pe.forwardRef(function(e,t){const n=Eu({props:e,name:"MuiCardContent"}),{className:r,component:o="div",...i}=n,a={...n,component:o},l=(e=>{const{classes:t}=e;return Ti({root:["root"]},Cf,t)})(a);return s.jsx(Sf,{as:o,className:Co(l.root,r),ownerState:a,ref:t,...i})});function Bf(e){return Eo("PrivateSwitchBase",e)}Bo("PrivateSwitchBase",["root","checked","disabled","input","edgeStart","edgeEnd"]);const If=la(Ud,{name:"MuiSwitchBase"})({padding:9,borderRadius:"50%",variants:[{props:{edge:"start",size:"small"},style:{marginLeft:-3}},{props:({edge:e,ownerState:t})=>"start"===e&&"small"!==t.size,style:{marginLeft:-12}},{props:{edge:"end",size:"small"},style:{marginRight:-3}},{props:({edge:e,ownerState:t})=>"end"===e&&"small"!==t.size,style:{marginRight:-12}}]}),Rf=la("input",{name:"MuiSwitchBase",shouldForwardProp:aa})({cursor:"inherit",position:"absolute",opacity:0,width:"100%",height:"100%",top:0,left:0,margin:0,padding:0,zIndex:1}),kf=pe.forwardRef(function(e,t){const{autoFocus:n,checked:r,checkedIcon:o,defaultChecked:i,disabled:a,disableFocusRipple:l=!1,edge:c=!1,icon:u,id:d,inputProps:A,inputRef:h,name:p,onBlur:f,onChange:g,onFocus:m,readOnly:y,required:v=!1,tabIndex:b,type:w,value:x,slots:_={},slotProps:C={},...S}=e,[E,B]=Lu({controlled:r,default:Boolean(i),name:"SwitchBase",state:"checked"}),I=pp();let R=a;I&&void 0===R&&(R=I.disabled);const k="checkbox"===w||"radio"===w,T={...e,checked:E,disabled:R,disableFocusRipple:l,edge:c},P=(e=>{const{classes:t,checked:n,disabled:r,edge:o}=e;return Ti({root:["root",n&&"checked",r&&"disabled",o&&`edge${vr(o)}`],input:["input"]},Bf,t)})(T),F={slots:_,slotProps:{input:A,...C}},[M,L]=_d("root",{ref:t,elementType:If,className:P.root,shouldForwardComponentProp:!0,externalForwardedProps:{...F,component:"span",...S},getSlotProps:e=>({...e,onFocus:t=>{e.onFocus?.(t),(e=>{m&&m(e),I&&I.onFocus&&I.onFocus(e)})(t)},onBlur:t=>{e.onBlur?.(t),(e=>{f&&f(e),I&&I.onBlur&&I.onBlur(e)})(t)}}),ownerState:T,additionalProps:{centerRipple:!0,focusRipple:!l,disabled:R,role:void 0,tabIndex:null}}),[U,O]=_d("input",{ref:h,elementType:Rf,className:P.input,externalForwardedProps:F,getSlotProps:e=>({...e,onChange:t=>{e.onChange?.(t),(e=>{if(e.nativeEvent.defaultPrevented)return;const t=e.target.checked;B(t),g&&g(e,t)})(t)}}),ownerState:T,additionalProps:{autoFocus:n,checked:r,defaultChecked:i,disabled:R,id:k?d:void 0,name:p,readOnly:y,required:v,tabIndex:b,type:w,..."checkbox"===w&&void 0===x?{}:{value:x}}});return s.jsxs(M,{...L,children:[s.jsx(U,{...O}),E?o:u]})}),Tf=ku(s.jsx("path",{d:"M19 5v14H5V5h14m0-2H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2z"})),Pf=ku(s.jsx("path",{d:"M19 3H5c-1.11 0-2 .9-2 2v14c0 1.1.89 2 2 2h14c1.11 0 2-.9 2-2V5c0-1.1-.89-2-2-2zm-9 14l-5-5 1.41-1.41L10 14.17l7.59-7.59L19 8l-9 9z"})),Ff=ku(s.jsx("path",{d:"M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-2 10H7v-2h10v2z"}));function Mf(e){return Eo("MuiCheckbox",e)}const Lf=Bo("MuiCheckbox",["root","checked","disabled","indeterminate","colorPrimary","colorSecondary","sizeSmall","sizeMedium"]),Uf=la(kf,{shouldForwardProp:e=>aa(e)||"classes"===e,name:"MuiCheckbox",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:n}=e;return[t.root,n.indeterminate&&t.indeterminate,t[`size${vr(n.size)}`],"default"!==n.color&&t[`color${vr(n.color)}`]]}})(Su(({theme:e})=>({color:(e.vars||e).palette.text.secondary,variants:[{props:{color:"default",disableRipple:!1},style:{"&:hover":{backgroundColor:e.alpha((e.vars||e).palette.action.active,(e.vars||e).palette.action.hoverOpacity)}}},...Object.entries(e.palette).filter(Dd()).map(([t])=>({props:{color:t,disableRipple:!1},style:{"&:hover":{backgroundColor:e.alpha((e.vars||e).palette[t].main,(e.vars||e).palette.action.hoverOpacity)}}})),...Object.entries(e.palette).filter(Dd()).map(([t])=>({props:{color:t},style:{[`&.${Lf.checked}, &.${Lf.indeterminate}`]:{color:(e.vars||e).palette[t].main},[`&.${Lf.disabled}`]:{color:(e.vars||e).palette.action.disabled}}})),{props:{disableRipple:!1},style:{"&:hover":{"@media (hover: none)":{backgroundColor:"transparent"}}}}]}))),Of=s.jsx(Pf,{}),Df=s.jsx(Tf,{}),Nf=s.jsx(Ff,{}),jf=pe.forwardRef(function(e,t){const n=Eu({props:e,name:"MuiCheckbox"}),{checkedIcon:r=Of,color:o="primary",icon:i=Df,indeterminate:a=!1,indeterminateIcon:l=Nf,inputProps:c,size:u="medium",disableRipple:d=!1,className:A,slots:h={},slotProps:p={},...f}=n,g=a?l:i,m=a?l:r,y={...n,disableRipple:d,color:o,indeterminate:a,size:u},v=(e=>{const{classes:t,indeterminate:n,color:r,size:o}=e,i=Ti({root:["root",n&&"indeterminate",`color${vr(r)}`,`size${vr(o)}`]},Mf,t);return{...t,...i}})(y),b=p.input??c,[w,x]=_d("root",{ref:t,elementType:Uf,className:Co(v.root,A),shouldForwardComponentProp:!0,externalForwardedProps:{slots:h,slotProps:p,...f},ownerState:y,additionalProps:{type:"checkbox",icon:pe.cloneElement(g,{fontSize:g.props.fontSize??u}),checkedIcon:pe.cloneElement(m,{fontSize:m.props.fontSize??u}),disableRipple:d,slots:h,slotProps:{input:Du("function"==typeof b?b(y):b,{"data-indeterminate":a})}}});return s.jsx(w,{...x,classes:v})});function Qf(e){return e.substring(2).toLowerCase()}function zf(e){const{children:t,disableReactTree:n=!1,mouseEvent:r="onClick",onClickAway:o,touchEvent:i="onTouchEnd"}=e,s=pe.useRef(!1),a=pe.useRef(null),l=pe.useRef(!1),c=pe.useRef(!1);pe.useEffect(()=>(setTimeout(()=>{l.current=!0},0),()=>{l.current=!1}),[]);const u=Ou(Gh(t),a),d=Uu(e=>{const t=c.current;c.current=!1;const r=Pu(a.current);if(!l.current||!a.current||"clientX"in e&&function(e,t){return t.documentElement.clientWidth<e.clientX||t.documentElement.clientHeight<e.clientY}(e,r))return;if(s.current)return void(s.current=!1);let i;i=e.composedPath?e.composedPath().includes(a.current):!r.documentElement.contains(e.target)||a.current.contains(e.target),i||!n&&t||o(e)}),A=e=>n=>{c.current=!0;const r=t.props[e];r&&r(n)},h={ref:u};return!1!==i&&(h[i]=A(i)),pe.useEffect(()=>{if(!1!==i){const e=Qf(i),t=Pu(a.current),n=()=>{s.current=!0};return t.addEventListener(e,d),t.addEventListener("touchmove",n),()=>{t.removeEventListener(e,d),t.removeEventListener("touchmove",n)}}},[d,i]),!1!==r&&(h[r]=A(r)),pe.useEffect(()=>{if(!1!==r){const e=Qf(r),t=Pu(a.current);return t.addEventListener(e,d),()=>{t.removeEventListener(e,d)}}},[d,r]),pe.cloneElement(t,h)}function Hf(e=window){const t=e.document.documentElement.clientWidth;return e.innerWidth-t}function Gf(e,t){t?e.setAttribute("aria-hidden","true"):e.removeAttribute("aria-hidden")}function Vf(e){return parseInt(Fu(e).getComputedStyle(e).paddingRight,10)||0}function Wf(e,t,n,r,o){const i=[t,n,...r];[].forEach.call(e.children,e=>{const t=!i.includes(e),n=!function(e){const t=["TEMPLATE","SCRIPT","STYLE","LINK","MAP","META","NOSCRIPT","PICTURE","COL","COLGROUP","PARAM","SLOT","SOURCE","TRACK"].includes(e.tagName),n="INPUT"===e.tagName&&"hidden"===e.getAttribute("type");return t||n}(e);t&&n&&Gf(e,o)})}function $f(e,t){let n=-1;return e.some((e,r)=>!!t(e)&&(n=r,!0)),n}function Kf(e,t){const n=[],r=e.container;if(!t.disableScrollLock){if(function(e){const t=Pu(e);return t.body===e?Fu(e).innerWidth>t.documentElement.clientWidth:e.scrollHeight>e.clientHeight}(r)){const e=Hf(Fu(r));n.push({value:r.style.paddingRight,property:"padding-right",el:r}),r.style.paddingRight=`${Vf(r)+e}px`;const t=Pu(r).querySelectorAll(".mui-fixed");[].forEach.call(t,t=>{n.push({value:t.style.paddingRight,property:"padding-right",el:t}),t.style.paddingRight=`${Vf(t)+e}px`})}let e;if(r.parentNode instanceof DocumentFragment)e=Pu(r).body;else{const t=r.parentElement,n=Fu(r);e="HTML"===t?.nodeName&&"scroll"===n.getComputedStyle(t).overflowY?t:r}n.push({value:e.style.overflow,property:"overflow",el:e},{value:e.style.overflowX,property:"overflow-x",el:e},{value:e.style.overflowY,property:"overflow-y",el:e}),e.style.overflow="hidden"}return()=>{n.forEach(({value:e,el:t,property:n})=>{e?t.style.setProperty(n,e):t.style.removeProperty(n)})}}const Xf=["input","select","textarea","a[href]","button","[tabindex]","audio[controls]","video[controls]",'[contenteditable]:not([contenteditable="false"])'].join(",");function Yf(e){const t=[],n=[];return Array.from(e.querySelectorAll(Xf)).forEach((e,r)=>{const o=function(e){const t=parseInt(e.getAttribute("tabindex")||"",10);return Number.isNaN(t)?"true"===e.contentEditable||("AUDIO"===e.nodeName||"VIDEO"===e.nodeName||"DETAILS"===e.nodeName)&&null===e.getAttribute("tabindex")?0:e.tabIndex:t}(e);-1!==o&&function(e){return!(e.disabled||"INPUT"===e.tagName&&"hidden"===e.type||function(e){if("INPUT"!==e.tagName||"radio"!==e.type)return!1;if(!e.name)return!1;const t=t=>e.ownerDocument.querySelector(`input[type="radio"]${t}`);let n=t(`[name="${e.name}"]:checked`);return n||(n=t(`[name="${e.name}"]`)),n!==e}(e))}(e)&&(0===o?t.push(e):n.push({documentOrder:r,tabIndex:o,node:e}))}),n.sort((e,t)=>e.tabIndex===t.tabIndex?e.documentOrder-t.documentOrder:e.tabIndex-t.tabIndex).map(e=>e.node).concat(t)}function qf(){return!0}function Jf(e){const{children:t,disableAutoFocus:n=!1,disableEnforceFocus:r=!1,disableRestoreFocus:o=!1,getTabbable:i=Yf,isEnabled:a=qf,open:l}=e,c=pe.useRef(!1),u=pe.useRef(null),d=pe.useRef(null),A=pe.useRef(null),h=pe.useRef(null),p=pe.useRef(!1),f=pe.useRef(null),g=Ou(Gh(t),f),m=pe.useRef(null);pe.useEffect(()=>{l&&f.current&&(p.current=!n)},[n,l]),pe.useEffect(()=>{if(!l||!f.current)return;const e=Pu(f.current);return f.current.contains(e.activeElement)||(f.current.hasAttribute("tabIndex")||f.current.setAttribute("tabIndex","-1"),p.current&&f.current.focus()),()=>{o||(A.current&&A.current.focus&&(c.current=!0,A.current.focus()),A.current=null)}},[l]),pe.useEffect(()=>{if(!l||!f.current)return;const e=Pu(f.current),t=t=>{m.current=t,!r&&a()&&"Tab"===t.key&&e.activeElement===f.current&&t.shiftKey&&(c.current=!0,d.current&&d.current.focus())},n=()=>{const t=f.current;if(null===t)return;if(!e.hasFocus()||!a()||c.current)return void(c.current=!1);if(t.contains(e.activeElement))return;if(r&&e.activeElement!==u.current&&e.activeElement!==d.current)return;if(e.activeElement!==h.current)h.current=null;else if(null!==h.current)return;if(!p.current)return;let n=[];if(e.activeElement!==u.current&&e.activeElement!==d.current||(n=i(f.current)),n.length>0){const e=Boolean(m.current?.shiftKey&&"Tab"===m.current?.key),t=n[0],r=n[n.length-1];"string"!=typeof t&&"string"!=typeof r&&(e?r.focus():t.focus())}else t.focus()};e.addEventListener("focusin",n),e.addEventListener("keydown",t,!0);const o=setInterval(()=>{e.activeElement&&"BODY"===e.activeElement.tagName&&n()},50);return()=>{clearInterval(o),e.removeEventListener("focusin",n),e.removeEventListener("keydown",t,!0)}},[n,r,o,a,l,i]);const y=e=>{null===A.current&&(A.current=e.relatedTarget),p.current=!0};return s.jsxs(pe.Fragment,{children:[s.jsx("div",{tabIndex:l?0:-1,onFocus:y,ref:u,"data-testid":"sentinelStart"}),pe.cloneElement(t,{ref:g,onFocus:e=>{null===A.current&&(A.current=e.relatedTarget),p.current=!0,h.current=e.target;const n=t.props.onFocus;n&&n(e)}}),s.jsx("div",{tabIndex:l?0:-1,onFocus:y,ref:d,"data-testid":"sentinelEnd"})]})}const Zf=()=>{},eg=new class{constructor(){this.modals=[],this.containers=[]}add(e,t){let n=this.modals.indexOf(e);if(-1!==n)return n;n=this.modals.length,this.modals.push(e),e.modalRef&&Gf(e.modalRef,!1);const r=function(e){const t=[];return[].forEach.call(e.children,e=>{"true"===e.getAttribute("aria-hidden")&&t.push(e)}),t}(t);Wf(t,e.mount,e.modalRef,r,!0);const o=$f(this.containers,e=>e.container===t);return-1!==o?(this.containers[o].modals.push(e),n):(this.containers.push({modals:[e],container:t,restore:null,hiddenSiblings:r}),n)}mount(e,t){const n=$f(this.containers,t=>t.modals.includes(e)),r=this.containers[n];r.restore||(r.restore=Kf(r,t))}remove(e,t=!0){const n=this.modals.indexOf(e);if(-1===n)return n;const r=$f(this.containers,t=>t.modals.includes(e)),o=this.containers[r];if(o.modals.splice(o.modals.indexOf(e),1),this.modals.splice(n,1),0===o.modals.length)o.restore&&o.restore(),e.modalRef&&Gf(e.modalRef,t),Wf(o.container,e.mount,e.modalRef,o.hiddenSiblings,!1),this.containers.splice(r,1);else{const e=o.modals[o.modals.length-1];e.modalRef&&Gf(e.modalRef,!1)}return n}isTopModal(e){return this.modals.length>0&&this.modals[this.modals.length-1]===e}};function tg(e){const{container:t,disableEscapeKeyDown:n=!1,disableScrollLock:r=!1,closeAfterTransition:o=!1,onTransitionEnter:i,onTransitionExited:s,children:a,onClose:l,open:c,rootRef:u}=e,d=pe.useRef({}),A=pe.useRef(null),h=pe.useRef(null),p=Ou(h,u),[f,g]=pe.useState(!c),m=function(e){return!!e&&e.props.hasOwnProperty("in")}(a);let y=!0;"false"!==e["aria-hidden"]&&!1!==e["aria-hidden"]||(y=!1);const v=()=>(d.current.modalRef=h.current,d.current.mount=A.current,d.current),b=()=>{eg.mount(v(),{disableScrollLock:r}),h.current&&(h.current.scrollTop=0)},w=Uu(()=>{const e=function(e){return"function"==typeof e?e():e}(t)||Pu(A.current).body;eg.add(v(),e),h.current&&b()}),x=()=>eg.isTopModal(v()),_=Uu(e=>{A.current=e,e&&(c&&x()?b():h.current&&Gf(h.current,y))}),C=pe.useCallback(()=>{eg.remove(v(),y)},[y]);pe.useEffect(()=>()=>{C()},[C]),pe.useEffect(()=>{c?w():m&&o||C()},[c,C,m,o,w]);const S=e=>t=>{e.onKeyDown?.(t),"Escape"===t.key&&229!==t.which&&x()&&(n||(t.stopPropagation(),l&&l(t,"escapeKeyDown")))},E=e=>t=>{e.onClick?.(t),t.target===t.currentTarget&&l&&l(t,"backdropClick")};return{getRootProps:(t={})=>{const n=bd(e);delete n.onTransitionEnter,delete n.onTransitionExited;const r={...n,...t};return{role:"presentation",...r,onKeyDown:S(r),ref:p}},getBackdropProps:(e={})=>{const t=e;return{"aria-hidden":!0,...t,onClick:E(t),open:c}},getTransitionProps:()=>({onEnter:Cu(()=>{g(!1),i&&i()},a?.props.onEnter??Zf),onExited:Cu(()=>{g(!0),s&&s(),o&&C()},a?.props.onExited??Zf)}),rootRef:p,portalRef:_,isTopModal:x,exited:f,hasTransition:m}}function ng(e){return Eo("MuiModal",e)}Bo("MuiModal",["root","hidden","backdrop"]);const rg=la("div",{name:"MuiModal",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:n}=e;return[t.root,!n.open&&n.exited&&t.hidden]}})(Su(({theme:e})=>({position:"fixed",zIndex:(e.vars||e).zIndex.modal,right:0,bottom:0,top:0,left:0,variants:[{props:({ownerState:e})=>!e.open&&e.exited,style:{visibility:"hidden"}}]}))),og=la(ef,{name:"MuiModal",slot:"Backdrop"})({zIndex:-1}),ig=pe.forwardRef(function(e,t){const n=Eu({name:"MuiModal",props:e}),{BackdropComponent:r=og,BackdropProps:o,classes:i,className:a,closeAfterTransition:l=!1,children:c,container:u,component:d,components:A={},componentsProps:h={},disableAutoFocus:p=!1,disableEnforceFocus:f=!1,disableEscapeKeyDown:g=!1,disablePortal:m=!1,disableRestoreFocus:y=!1,disableScrollLock:v=!1,hideBackdrop:b=!1,keepMounted:w=!1,onClose:x,onTransitionEnter:_,onTransitionExited:C,open:S,slotProps:E={},slots:B={},theme:I,...R}=n,k={...n,closeAfterTransition:l,disableAutoFocus:p,disableEnforceFocus:f,disableEscapeKeyDown:g,disablePortal:m,disableRestoreFocus:y,disableScrollLock:v,hideBackdrop:b,keepMounted:w},{getRootProps:T,getBackdropProps:P,getTransitionProps:F,portalRef:M,isTopModal:L,exited:U,hasTransition:O}=tg({...k,rootRef:t}),D={...k,exited:U},N=(e=>{const{open:t,exited:n,classes:r}=e;return Ti({root:["root",!t&&n&&"hidden"],backdrop:["backdrop"]},ng,r)})(D),j={};if(void 0===c.props.tabIndex&&(j.tabIndex="-1"),O){const{onEnter:e,onExited:t}=F();j.onEnter=e,j.onExited=t}const Q={slots:{root:A.Root,backdrop:A.Backdrop,...B},slotProps:{...h,...E}},[z,H]=_d("root",{ref:t,elementType:rg,externalForwardedProps:{...Q,...R,component:d},getSlotProps:T,ownerState:D,className:Co(a,N?.root,!D.open&&D.exited&&N?.hidden)}),[G,V]=_d("backdrop",{ref:o?.ref,elementType:r,externalForwardedProps:Q,shouldForwardComponentProp:!0,additionalProps:o,getSlotProps:e=>P({...e,onClick:t=>{e?.onClick&&e.onClick(t)}}),className:Co(o?.className,N?.backdrop),ownerState:D});return w||S||O&&!U?s.jsx(Vh,{ref:M,container:u,disablePortal:m,children:s.jsxs(z,{...H,children:[!b&&r?s.jsx(G,{...V}):null,s.jsx(Jf,{disableEnforceFocus:f,disableAutoFocus:p,disableRestoreFocus:y,isEnabled:L,open:S,children:pe.cloneElement(c,j)})]})}):null});function sg(e){return Eo("MuiDialog",e)}const ag=Bo("MuiDialog",["root","scrollPaper","scrollBody","container","paper","paperScrollPaper","paperScrollBody","paperWidthFalse","paperWidthXs","paperWidthSm","paperWidthMd","paperWidthLg","paperWidthXl","paperFullWidth","paperFullScreen"]),lg=pe.createContext({}),cg=la(ef,{name:"MuiDialog",slot:"Backdrop",overrides:(e,t)=>t.backdrop})({zIndex:-1}),ug=la(ig,{name:"MuiDialog",slot:"Root"})({"@media print":{position:"absolute !important"}}),dg=la("div",{name:"MuiDialog",slot:"Container",overridesResolver:(e,t)=>{const{ownerState:n}=e;return[t.container,t[`scroll${vr(n.scroll)}`]]}})({height:"100%","@media print":{height:"auto"},outline:0,variants:[{props:{scroll:"paper"},style:{display:"flex",justifyContent:"center",alignItems:"center"}},{props:{scroll:"body"},style:{overflowY:"auto",overflowX:"hidden",textAlign:"center","&::after":{content:'""',display:"inline-block",verticalAlign:"middle",height:"100%",width:"0"}}}]}),Ag=la(gd,{name:"MuiDialog",slot:"Paper",overridesResolver:(e,t)=>{const{ownerState:n}=e;return[t.paper,t[`scrollPaper${vr(n.scroll)}`],t[`paperWidth${vr(String(n.maxWidth))}`],n.fullWidth&&t.paperFullWidth,n.fullScreen&&t.paperFullScreen]}})(Su(({theme:e})=>({margin:32,position:"relative",overflowY:"auto","@media print":{overflowY:"visible",boxShadow:"none"},variants:[{props:{scroll:"paper"},style:{display:"flex",flexDirection:"column",maxHeight:"calc(100% - 64px)"}},{props:{scroll:"body"},style:{display:"inline-block",verticalAlign:"middle",textAlign:"initial"}},{props:({ownerState:e})=>!e.maxWidth,style:{maxWidth:"calc(100% - 64px)"}},{props:{maxWidth:"xs"},style:{maxWidth:"px"===e.breakpoints.unit?Math.max(e.breakpoints.values.xs,444):`max(${e.breakpoints.values.xs}${e.breakpoints.unit}, 444px)`,[`&.${ag.paperScrollBody}`]:{[e.breakpoints.down(Math.max(e.breakpoints.values.xs,444)+64)]:{maxWidth:"calc(100% - 64px)"}}}},...Object.keys(e.breakpoints.values).filter(e=>"xs"!==e).map(t=>({props:{maxWidth:t},style:{maxWidth:`${e.breakpoints.values[t]}${e.breakpoints.unit}`,[`&.${ag.paperScrollBody}`]:{[e.breakpoints.down(e.breakpoints.values[t]+64)]:{maxWidth:"calc(100% - 64px)"}}}})),{props:({ownerState:e})=>e.fullWidth,style:{width:"calc(100% - 64px)"}},{props:({ownerState:e})=>e.fullScreen,style:{margin:0,width:"100%",maxWidth:"100%",height:"100%",maxHeight:"none",borderRadius:0,[`&.${ag.paperScrollBody}`]:{margin:0,maxWidth:"100%"}}}]}))),hg=pe.forwardRef(function(e,t){const n=Eu({props:e,name:"MuiDialog"}),r=ia(),o={enter:r.transitions.duration.enteringScreen,exit:r.transitions.duration.leavingScreen},{"aria-describedby":i,"aria-labelledby":a,"aria-modal":l=!0,BackdropComponent:c,BackdropProps:u,children:d,className:A,disableEscapeKeyDown:h=!1,fullScreen:p=!1,fullWidth:f=!1,maxWidth:g="sm",onClick:m,onClose:y,open:v,PaperComponent:b=gd,PaperProps:w={},scroll:x="paper",slots:_={},slotProps:C={},TransitionComponent:S=qp,transitionDuration:E=o,TransitionProps:B,...I}=n,R={...n,disableEscapeKeyDown:h,fullScreen:p,fullWidth:f,maxWidth:g,scroll:x},k=(e=>{const{classes:t,scroll:n,maxWidth:r,fullWidth:o,fullScreen:i}=e;return Ti({root:["root"],container:["container",`scroll${vr(n)}`],paper:["paper",`paperScroll${vr(n)}`,`paperWidth${vr(String(r))}`,o&&"paperFullWidth",i&&"paperFullScreen"]},sg,t)})(R),T=pe.useRef(),P=pi(a),F=pe.useMemo(()=>({titleId:P}),[P]),M={slots:{transition:S,..._},slotProps:{transition:B,paper:w,backdrop:u,...C}},[L,U]=_d("root",{elementType:ug,shouldForwardComponentProp:!0,externalForwardedProps:M,ownerState:R,className:Co(k.root,A),ref:t}),[O,D]=_d("backdrop",{elementType:cg,shouldForwardComponentProp:!0,externalForwardedProps:M,ownerState:R}),[N,j]=_d("paper",{elementType:Ag,shouldForwardComponentProp:!0,externalForwardedProps:M,ownerState:R,className:Co(k.paper,w.className)}),[Q,z]=_d("container",{elementType:dg,externalForwardedProps:M,ownerState:R,className:k.container}),[H,G]=_d("transition",{elementType:qp,externalForwardedProps:M,ownerState:R,additionalProps:{appear:!0,in:v,timeout:E,role:"presentation"}});return s.jsx(L,{closeAfterTransition:!0,slots:{backdrop:O},slotProps:{backdrop:{transitionDuration:E,as:c,...D}},disableEscapeKeyDown:h,onClose:y,open:v,onClick:e=>{m&&m(e),T.current&&(T.current=null,y&&y(e,"backdropClick"))},...U,...I,children:s.jsx(H,{...G,children:s.jsx(Q,{onMouseDown:e=>{T.current=e.target===e.currentTarget},...z,children:s.jsx(N,{as:b,elevation:24,role:"dialog","aria-describedby":i,"aria-labelledby":P,"aria-modal":l,...j,children:s.jsx(lg.Provider,{value:F,children:d})})})})})});function pg(e){return Eo("MuiDialogActions",e)}Bo("MuiDialogActions",["root","spacing"]);const fg=la("div",{name:"MuiDialogActions",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:n}=e;return[t.root,!n.disableSpacing&&t.spacing]}})({display:"flex",alignItems:"center",padding:8,justifyContent:"flex-end",flex:"0 0 auto",variants:[{props:({ownerState:e})=>!e.disableSpacing,style:{"& > :not(style) ~ :not(style)":{marginLeft:8}}}]}),gg=pe.forwardRef(function(e,t){const n=Eu({props:e,name:"MuiDialogActions"}),{className:r,disableSpacing:o=!1,...i}=n,a={...n,disableSpacing:o},l=(e=>{const{classes:t,disableSpacing:n}=e;return Ti({root:["root",!n&&"spacing"]},pg,t)})(a);return s.jsx(fg,{className:Co(l.root,r),ownerState:a,ref:t,...i})});function mg(e){return Eo("MuiDialogContent",e)}function yg(e){return Eo("MuiDialogTitle",e)}Bo("MuiDialogContent",["root","dividers"]);const vg=Bo("MuiDialogTitle",["root"]),bg=la("div",{name:"MuiDialogContent",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:n}=e;return[t.root,n.dividers&&t.dividers]}})(Su(({theme:e})=>({flex:"1 1 auto",WebkitOverflowScrolling:"touch",overflowY:"auto",padding:"20px 24px",variants:[{props:({ownerState:e})=>e.dividers,style:{padding:"16px 24px",borderTop:`1px solid ${(e.vars||e).palette.divider}`,borderBottom:`1px solid ${(e.vars||e).palette.divider}`}},{props:({ownerState:e})=>!e.dividers,style:{[`.${vg.root} + &`]:{paddingTop:0}}}]}))),wg=pe.forwardRef(function(e,t){const n=Eu({props:e,name:"MuiDialogContent"}),{className:r,dividers:o=!1,...i}=n,a={...n,dividers:o},l=(e=>{const{classes:t,dividers:n}=e;return Ti({root:["root",n&&"dividers"]},mg,t)})(a);return s.jsx(bg,{className:Co(l.root,r),ownerState:a,ref:t,...i})});function xg(e){return Eo("MuiDialogContentText",e)}Bo("MuiDialogContentText",["root"]);const _g=la(vA,{shouldForwardProp:e=>aa(e)||"classes"===e,name:"MuiDialogContentText",slot:"Root"})({}),Cg=pe.forwardRef(function(e,t){const n=Eu({props:e,name:"MuiDialogContentText"}),{children:r,className:o,...i}=n,a=(e=>{const{classes:t}=e,n=Ti({root:["root"]},xg,t);return{...t,...n}})(i);return s.jsx(_g,{component:"p",variant:"body1",color:"textSecondary",ref:t,ownerState:i,className:Co(a.root,o),...n,classes:a})}),Sg=la(vA,{name:"MuiDialogTitle",slot:"Root"})({padding:"16px 24px",flex:"0 0 auto"}),Eg=pe.forwardRef(function(e,t){const n=Eu({props:e,name:"MuiDialogTitle"}),{className:r,id:o,...i}=n,a=n,l=(e=>{const{classes:t}=e;return Ti({root:["root"]},yg,t)})(a),{titleId:c=o}=pe.useContext(lg);return s.jsx(Sg,{component:"h2",className:Co(l.root,r),ownerState:a,ref:t,variant:"h6",id:o??c,...i})});function Bg(e){return Eo("MuiDivider",e)}const Ig=Bo("MuiDivider",["root","absolute","fullWidth","inset","middle","flexItem","light","vertical","withChildren","withChildrenVertical","textAlignRight","textAlignLeft","wrapper","wrapperVertical"]),Rg=la("div",{name:"MuiDivider",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:n}=e;return[t.root,n.absolute&&t.absolute,t[n.variant],n.light&&t.light,"vertical"===n.orientation&&t.vertical,n.flexItem&&t.flexItem,n.children&&t.withChildren,n.children&&"vertical"===n.orientation&&t.withChildrenVertical,"right"===n.textAlign&&"vertical"!==n.orientation&&t.textAlignRight,"left"===n.textAlign&&"vertical"!==n.orientation&&t.textAlignLeft]}})(Su(({theme:e})=>({margin:0,flexShrink:0,borderWidth:0,borderStyle:"solid",borderColor:(e.vars||e).palette.divider,borderBottomWidth:"thin",variants:[{props:{absolute:!0},style:{position:"absolute",bottom:0,left:0,width:"100%"}},{props:{light:!0},style:{borderColor:e.alpha((e.vars||e).palette.divider,.08)}},{props:{variant:"inset"},style:{marginLeft:72}},{props:{variant:"middle",orientation:"horizontal"},style:{marginLeft:e.spacing(2),marginRight:e.spacing(2)}},{props:{variant:"middle",orientation:"vertical"},style:{marginTop:e.spacing(1),marginBottom:e.spacing(1)}},{props:{orientation:"vertical"},style:{height:"100%",borderBottomWidth:0,borderRightWidth:"thin"}},{props:{flexItem:!0},style:{alignSelf:"stretch",height:"auto"}},{props:({ownerState:e})=>!!e.children,style:{display:"flex",textAlign:"center",border:0,borderTopStyle:"solid",borderLeftStyle:"solid","&::before, &::after":{content:'""',alignSelf:"center"}}},{props:({ownerState:e})=>e.children&&"vertical"!==e.orientation,style:{"&::before, &::after":{width:"100%",borderTop:`thin solid ${(e.vars||e).palette.divider}`,borderTopStyle:"inherit"}}},{props:({ownerState:e})=>"vertical"===e.orientation&&e.children,style:{flexDirection:"column","&::before, &::after":{height:"100%",borderLeft:`thin solid ${(e.vars||e).palette.divider}`,borderLeftStyle:"inherit"}}},{props:({ownerState:e})=>"right"===e.textAlign&&"vertical"!==e.orientation,style:{"&::before":{width:"90%"},"&::after":{width:"10%"}}},{props:({ownerState:e})=>"left"===e.textAlign&&"vertical"!==e.orientation,style:{"&::before":{width:"10%"},"&::after":{width:"90%"}}}]}))),kg=la("span",{name:"MuiDivider",slot:"Wrapper",overridesResolver:(e,t)=>{const{ownerState:n}=e;return[t.wrapper,"vertical"===n.orientation&&t.wrapperVertical]}})(Su(({theme:e})=>({display:"inline-block",paddingLeft:`calc(${e.spacing(1)} * 1.2)`,paddingRight:`calc(${e.spacing(1)} * 1.2)`,whiteSpace:"nowrap",variants:[{props:{orientation:"vertical"},style:{paddingTop:`calc(${e.spacing(1)} * 1.2)`,paddingBottom:`calc(${e.spacing(1)} * 1.2)`}}]}))),Tg=pe.forwardRef(function(e,t){const n=Eu({props:e,name:"MuiDivider"}),{absolute:r=!1,children:o,className:i,orientation:a="horizontal",component:l=(o||"vertical"===a?"div":"hr"),flexItem:c=!1,light:u=!1,role:d=("hr"!==l?"separator":void 0),textAlign:A="center",variant:h="fullWidth",...p}=n,f={...n,absolute:r,component:l,flexItem:c,light:u,orientation:a,role:d,textAlign:A,variant:h},g=(e=>{const{absolute:t,children:n,classes:r,flexItem:o,light:i,orientation:s,textAlign:a,variant:l}=e;return Ti({root:["root",t&&"absolute",l,i&&"light","vertical"===s&&"vertical",o&&"flexItem",n&&"withChildren",n&&"vertical"===s&&"withChildrenVertical","right"===a&&"vertical"!==s&&"textAlignRight","left"===a&&"vertical"!==s&&"textAlignLeft"],wrapper:["wrapper","vertical"===s&&"wrapperVertical"]},Bg,r)})(f);return s.jsx(Rg,{as:l,className:Co(g.root,i),role:d,ref:t,ownerState:f,"aria-orientation":"separator"!==d||"hr"===l&&"vertical"!==a?void 0:a,...p,children:o?s.jsx(kg,{className:g.wrapper,ownerState:f,children:o}):null})});function Pg(e,t,n){var r;const o=function(e,t,n){const r=t.getBoundingClientRect(),o=n&&n.getBoundingClientRect(),i=Fu(t);let s;if(t.fakeTransform)s=t.fakeTransform;else{const e=i.getComputedStyle(t);s=e.getPropertyValue("-webkit-transform")||e.getPropertyValue("transform")}let a=0,l=0;if(s&&"none"!==s&&"string"==typeof s){const e=s.split("(")[1].split(")")[0].split(",");a=parseInt(e[4],10),l=parseInt(e[5],10)}return"left"===e?o?`translateX(${o.right+a-r.left}px)`:`translateX(${i.innerWidth+a-r.left}px)`:"right"===e?o?`translateX(-${r.right-o.left-a}px)`:`translateX(-${r.left+r.width-a}px)`:"up"===e?o?`translateY(${o.bottom+l-r.top}px)`:`translateY(${i.innerHeight+l-r.top}px)`:o?`translateY(-${r.top-o.top+r.height-l}px)`:`translateY(-${r.top+r.height-l}px)`}(e,t,"function"==typeof(r=n)?r():r);o&&(t.style.webkitTransform=o,t.style.transform=o)}Tg&&(Tg.muiSkipListHighlight=!0);const Fg=pe.forwardRef(function(e,t){const n=ia(),r={enter:n.transitions.easing.easeOut,exit:n.transitions.easing.sharp},o={enter:n.transitions.duration.enteringScreen,exit:n.transitions.duration.leavingScreen},{addEndListener:i,appear:a=!0,children:l,container:c,direction:u="down",easing:d=r,in:A,onEnter:h,onEntered:p,onEntering:f,onExit:g,onExited:m,onExiting:y,style:v,timeout:b=o,TransitionComponent:w=Xu,...x}=e,_=pe.useRef(null),C=Ou(Gh(l),_,t),S=e=>t=>{e&&(void 0===t?e(_.current):e(_.current,t))},E=S((e,t)=>{Pg(u,e,c),ad(e),h&&h(e,t)}),B=S((e,t)=>{const r=ld({timeout:b,style:v,easing:d},{mode:"enter"});e.style.webkitTransition=n.transitions.create("-webkit-transform",{...r}),e.style.transition=n.transitions.create("transform",{...r}),e.style.webkitTransform="none",e.style.transform="none",f&&f(e,t)}),I=S(p),R=S(y),k=S(e=>{const t=ld({timeout:b,style:v,easing:d},{mode:"exit"});e.style.webkitTransition=n.transitions.create("-webkit-transform",t),e.style.transition=n.transitions.create("transform",t),Pg(u,e,c),g&&g(e)}),T=S(e=>{e.style.webkitTransition="",e.style.transition="",m&&m(e)}),P=pe.useCallback(()=>{_.current&&Pg(u,_.current,c)},[u,c]);return pe.useEffect(()=>{if(A||"down"===u||"right"===u)return;const e=Tu(()=>{_.current&&Pg(u,_.current,c)}),t=Fu(_.current);return t.addEventListener("resize",e),()=>{e.clear(),t.removeEventListener("resize",e)}},[u,A,c]),pe.useEffect(()=>{A||P()},[A,P]),s.jsx(w,{nodeRef:_,onEnter:E,onEntered:I,onEntering:B,onExit:k,onExited:T,onExiting:R,addEndListener:e=>{i&&i(_.current,e)},appear:a,in:A,timeout:b,...x,children:(e,{ownerState:t,...n})=>pe.cloneElement(l,{ref:C,style:{visibility:"exited"!==e||A?void 0:"hidden",...v,...l.props.style},...n})})}),Mg=la(xp,{shouldForwardProp:e=>aa(e)||"classes"===e,name:"MuiFilledInput",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:n}=e;return[...bp(e,t),!n.disableUnderline&&t.underline]}})(Su(({theme:e})=>{const t="light"===e.palette.mode,n=t?"rgba(0, 0, 0, 0.42)":"rgba(255, 255, 255, 0.7)",r=t?"rgba(0, 0, 0, 0.06)":"rgba(255, 255, 255, 0.09)",o=t?"rgba(0, 0, 0, 0.09)":"rgba(255, 255, 255, 0.13)",i=t?"rgba(0, 0, 0, 0.12)":"rgba(255, 255, 255, 0.12)";return{position:"relative",backgroundColor:e.vars?e.vars.palette.FilledInput.bg:r,borderTopLeftRadius:(e.vars||e).shape.borderRadius,borderTopRightRadius:(e.vars||e).shape.borderRadius,transition:e.transitions.create("background-color",{duration:e.transitions.duration.shorter,easing:e.transitions.easing.easeOut}),"&:hover":{backgroundColor:e.vars?e.vars.palette.FilledInput.hoverBg:o,"@media (hover: none)":{backgroundColor:e.vars?e.vars.palette.FilledInput.bg:r}},[`&.${Pp.focused}`]:{backgroundColor:e.vars?e.vars.palette.FilledInput.bg:r},[`&.${Pp.disabled}`]:{backgroundColor:e.vars?e.vars.palette.FilledInput.disabledBg:i},variants:[{props:({ownerState:e})=>!e.disableUnderline,style:{"&::after":{left:0,bottom:0,content:'""',position:"absolute",right:0,transform:"scaleX(0)",transition:e.transitions.create("transform",{duration:e.transitions.duration.shorter,easing:e.transitions.easing.easeOut}),pointerEvents:"none"},[`&.${Pp.focused}:after`]:{transform:"scaleX(1) translateX(0)"},[`&.${Pp.error}`]:{"&::before, &::after":{borderBottomColor:(e.vars||e).palette.error.main}},"&::before":{borderBottom:`1px solid ${e.vars?e.alpha(e.vars.palette.common.onBackground,e.vars.opacity.inputUnderline):n}`,left:0,bottom:0,content:'"\\00a0"',position:"absolute",right:0,transition:e.transitions.create("border-bottom-color",{duration:e.transitions.duration.shorter}),pointerEvents:"none"},[`&:hover:not(.${Pp.disabled}, .${Pp.error}):before`]:{borderBottom:`1px solid ${(e.vars||e).palette.text.primary}`},[`&.${Pp.disabled}:before`]:{borderBottomStyle:"dotted"}}},...Object.entries(e.palette).filter(Dd()).map(([t])=>({props:{disableUnderline:!1,color:t},style:{"&::after":{borderBottom:`2px solid ${(e.vars||e).palette[t]?.main}`}}})),{props:({ownerState:e})=>e.startAdornment,style:{paddingLeft:12}},{props:({ownerState:e})=>e.endAdornment,style:{paddingRight:12}},{props:({ownerState:e})=>e.multiline,style:{padding:"25px 12px 8px"}},{props:({ownerState:e,size:t})=>e.multiline&&"small"===t,style:{paddingTop:21,paddingBottom:4}},{props:({ownerState:e})=>e.multiline&&e.hiddenLabel,style:{paddingTop:16,paddingBottom:17}},{props:({ownerState:e})=>e.multiline&&e.hiddenLabel&&"small"===e.size,style:{paddingTop:8,paddingBottom:9}}]}})),Lg=la(_p,{name:"MuiFilledInput",slot:"Input",overridesResolver:wp})(Su(({theme:e})=>({paddingTop:25,paddingRight:12,paddingBottom:8,paddingLeft:12,...!e.vars&&{"&:-webkit-autofill":{WebkitBoxShadow:"light"===e.palette.mode?null:"0 0 0 100px #266798 inset",WebkitTextFillColor:"light"===e.palette.mode?null:"#fff",caretColor:"light"===e.palette.mode?null:"#fff",borderTopLeftRadius:"inherit",borderTopRightRadius:"inherit"}},...e.vars&&{"&:-webkit-autofill":{borderTopLeftRadius:"inherit",borderTopRightRadius:"inherit"},[e.getColorSchemeSelector("dark")]:{"&:-webkit-autofill":{WebkitBoxShadow:"0 0 0 100px #266798 inset",WebkitTextFillColor:"#fff",caretColor:"#fff"}}},variants:[{props:{size:"small"},style:{paddingTop:21,paddingBottom:4}},{props:({ownerState:e})=>e.hiddenLabel,style:{paddingTop:16,paddingBottom:17}},{props:({ownerState:e})=>e.startAdornment,style:{paddingLeft:0}},{props:({ownerState:e})=>e.endAdornment,style:{paddingRight:0}},{props:({ownerState:e})=>e.hiddenLabel&&"small"===e.size,style:{paddingTop:8,paddingBottom:9}},{props:({ownerState:e})=>e.multiline,style:{paddingTop:0,paddingBottom:0,paddingLeft:0,paddingRight:0}}]}))),Ug=pe.forwardRef(function(e,t){const n=Eu({props:e,name:"MuiFilledInput"}),{disableUnderline:r=!1,components:o={},componentsProps:i,fullWidth:a=!1,hiddenLabel:l,inputComponent:c="input",multiline:u=!1,slotProps:d,slots:A={},type:h="text",...p}=n,f={...n,disableUnderline:r,fullWidth:a,inputComponent:c,multiline:u,type:h},g=(e=>{const{classes:t,disableUnderline:n,startAdornment:r,endAdornment:o,size:i,hiddenLabel:s,multiline:a}=e,l=Ti({root:["root",!n&&"underline",r&&"adornedStart",o&&"adornedEnd","small"===i&&`size${vr(i)}`,s&&"hiddenLabel",a&&"multiline"],input:["input"]},Tp,t);return{...t,...l}})(n),m={root:{ownerState:f},input:{ownerState:f}},y=d??i?ar(m,d??i):m,v=A.root??o.Root??Mg,b=A.input??o.Input??Lg;return s.jsx(Ep,{slots:{root:v,input:b},slotProps:y,fullWidth:a,inputComponent:c,multiline:u,ref:t,type:h,...p,classes:g})});function Og(e){return Eo("MuiFormControl",e)}Ug.muiName="Input",Bo("MuiFormControl",["root","marginNone","marginNormal","marginDense","fullWidth","disabled"]);const Dg=la("div",{name:"MuiFormControl",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:n}=e;return[t.root,t[`margin${vr(n.margin)}`],n.fullWidth&&t.fullWidth]}})({display:"inline-flex",flexDirection:"column",position:"relative",minWidth:0,padding:0,margin:0,border:0,verticalAlign:"top",variants:[{props:{margin:"normal"},style:{marginTop:16,marginBottom:8}},{props:{margin:"dense"},style:{marginTop:8,marginBottom:4}},{props:{fullWidth:!0},style:{width:"100%"}}]}),Ng=pe.forwardRef(function(e,t){const n=Eu({props:e,name:"MuiFormControl"}),{children:r,className:o,color:i="primary",component:a="div",disabled:l=!1,error:c=!1,focused:u,fullWidth:d=!1,hiddenLabel:A=!1,margin:h="none",required:p=!1,size:f="medium",variant:g="outlined",...m}=n,y={...n,color:i,component:a,disabled:l,error:c,fullWidth:d,hiddenLabel:A,margin:h,required:p,size:f,variant:g},v=(e=>{const{classes:t,margin:n,fullWidth:r}=e;return Ti({root:["root","none"!==n&&`margin${vr(n)}`,r&&"fullWidth"]},Og,t)})(y),[b,w]=pe.useState(()=>{let e=!1;return r&&pe.Children.forEach(r,t=>{if(!Pi(t,["Input","Select"]))return;const n=Pi(t,["Select"])?t.props.input:t;n&&n.props.startAdornment&&(e=!0)}),e}),[x,_]=pe.useState(()=>{let e=!1;return r&&pe.Children.forEach(r,t=>{Pi(t,["Input","Select"])&&(gp(t.props,!0)||gp(t.props.inputProps,!0))&&(e=!0)}),e}),[C,S]=pe.useState(!1);l&&C&&S(!1);const E=void 0===u||l?C:u;let B;pe.useRef(!1);const I=pe.useCallback(()=>{_(!0)},[]),R=pe.useCallback(()=>{_(!1)},[]),k=pe.useMemo(()=>({adornedStart:b,setAdornedStart:w,color:i,disabled:l,error:c,filled:x,focused:E,fullWidth:d,hiddenLabel:A,size:f,onBlur:()=>{S(!1)},onFocus:()=>{S(!0)},onEmpty:R,onFilled:I,registerEffect:B,required:p,variant:g}),[b,i,l,c,x,E,d,A,B,R,I,p,f,g]);return s.jsx(hp.Provider,{value:k,children:s.jsx(Dg,{as:a,ownerState:y,className:Co(v.root,o),ref:t,...m,children:r})})});function jg(e){return Eo("MuiFormControlLabel",e)}const Qg=Bo("MuiFormControlLabel",["root","labelPlacementStart","labelPlacementTop","labelPlacementBottom","disabled","label","error","required","asterisk"]),zg=la("label",{name:"MuiFormControlLabel",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:n}=e;return[{[`& .${Qg.label}`]:t.label},t.root,t[`labelPlacement${vr(n.labelPlacement)}`]]}})(Su(({theme:e})=>({display:"inline-flex",alignItems:"center",cursor:"pointer",verticalAlign:"middle",WebkitTapHighlightColor:"transparent",marginLeft:-11,marginRight:16,[`&.${Qg.disabled}`]:{cursor:"default"},[`& .${Qg.label}`]:{[`&.${Qg.disabled}`]:{color:(e.vars||e).palette.text.disabled}},variants:[{props:{labelPlacement:"start"},style:{flexDirection:"row-reverse",marginRight:-11}},{props:{labelPlacement:"top"},style:{flexDirection:"column-reverse"}},{props:{labelPlacement:"bottom"},style:{flexDirection:"column"}},{props:({labelPlacement:e})=>"start"===e||"top"===e||"bottom"===e,style:{marginLeft:16}}]}))),Hg=la("span",{name:"MuiFormControlLabel",slot:"Asterisk"})(Su(({theme:e})=>({[`&.${Qg.error}`]:{color:(e.vars||e).palette.error.main}}))),Gg=pe.forwardRef(function(e,t){const n=Eu({props:e,name:"MuiFormControlLabel"}),{checked:r,className:o,componentsProps:i={},control:a,disabled:l,disableTypography:c,inputRef:u,label:d,labelPlacement:A="end",name:h,onChange:p,required:f,slots:g={},slotProps:m={},value:y,...v}=n,b=pp(),w=l??a.props.disabled??b?.disabled,x=f??a.props.required,_={disabled:w,required:x};["checked","name","onChange","value","inputRef"].forEach(e=>{void 0===a.props[e]&&void 0!==n[e]&&(_[e]=n[e])});const C=Ap({props:n,muiFormControl:b,states:["error"]}),S={...n,disabled:w,labelPlacement:A,required:x,error:C.error},E=(e=>{const{classes:t,disabled:n,labelPlacement:r,error:o,required:i}=e;return Ti({root:["root",n&&"disabled",`labelPlacement${vr(r)}`,o&&"error",i&&"required"],label:["label",n&&"disabled"],asterisk:["asterisk",o&&"error"]},jg,t)})(S),B={slots:g,slotProps:{...i,...m}},[I,R]=_d("typography",{elementType:vA,externalForwardedProps:B,ownerState:S});let k=d;return null==k||k.type===vA||c||(k=s.jsx(I,{component:"span",...R,className:Co(E.label,R?.className),children:k})),s.jsxs(zg,{className:Co(E.root,o),ownerState:S,ref:t,...v,children:[pe.cloneElement(a,_),x?s.jsxs("div",{children:[k,s.jsxs(Hg,{ownerState:S,"aria-hidden":!0,className:E.asterisk,children:["","*"]})]}):k]})});function Vg(e){return Eo("MuiFormGroup",e)}Bo("MuiFormGroup",["root","row","error"]);const Wg=la("div",{name:"MuiFormGroup",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:n}=e;return[t.root,n.row&&t.row]}})({display:"flex",flexDirection:"column",flexWrap:"wrap",variants:[{props:{row:!0},style:{flexDirection:"row"}}]}),$g=pe.forwardRef(function(e,t){const n=Eu({props:e,name:"MuiFormGroup"}),{className:r,row:o=!1,...i}=n,a=Ap({props:n,muiFormControl:pp(),states:["error"]}),l={...n,row:o,error:a.error},c=(e=>{const{classes:t,row:n,error:r}=e;return Ti({root:["root",n&&"row",r&&"error"]},Vg,t)})(l);return s.jsx(Wg,{className:Co(c.root,r),ownerState:l,ref:t,...i})});function Kg(e){return Eo("MuiFormHelperText",e)}const Xg=Bo("MuiFormHelperText",["root","error","disabled","sizeSmall","sizeMedium","contained","focused","filled","required"]);var Yg;const qg=la("p",{name:"MuiFormHelperText",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:n}=e;return[t.root,n.size&&t[`size${vr(n.size)}`],n.contained&&t.contained,n.filled&&t.filled]}})(Su(({theme:e})=>({color:(e.vars||e).palette.text.secondary,...e.typography.caption,textAlign:"left",marginTop:3,marginRight:0,marginBottom:0,marginLeft:0,[`&.${Xg.disabled}`]:{color:(e.vars||e).palette.text.disabled},[`&.${Xg.error}`]:{color:(e.vars||e).palette.error.main},variants:[{props:{size:"small"},style:{marginTop:4}},{props:({ownerState:e})=>e.contained,style:{marginLeft:14,marginRight:14}}]}))),Jg=pe.forwardRef(function(e,t){const n=Eu({props:e,name:"MuiFormHelperText"}),{children:r,className:o,component:i="p",disabled:a,error:l,filled:c,focused:u,margin:d,required:A,variant:h,...p}=n,f=Ap({props:n,muiFormControl:pp(),states:["variant","size","disabled","error","filled","focused","required"]}),g={...n,component:i,contained:"filled"===f.variant||"outlined"===f.variant,variant:f.variant,size:f.size,disabled:f.disabled,error:f.error,filled:f.filled,focused:f.focused,required:f.required};delete g.ownerState;const m=(e=>{const{classes:t,contained:n,size:r,disabled:o,error:i,filled:s,focused:a,required:l}=e;return Ti({root:["root",o&&"disabled",i&&"error",r&&`size${vr(r)}`,n&&"contained",a&&"focused",s&&"filled",l&&"required"]},Kg,t)})(g);return s.jsx(qg,{as:i,className:Co(m.root,o),ref:t,...p,ownerState:g,children:" "===r?Yg||(Yg=s.jsx("span",{className:"notranslate","aria-hidden":!0,children:""})):r})});function Zg(e){return Eo("MuiFormLabel",e)}const em=Bo("MuiFormLabel",["root","colorSecondary","focused","disabled","error","filled","required","asterisk"]),tm=la("label",{name:"MuiFormLabel",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:n}=e;return[t.root,"secondary"===n.color&&t.colorSecondary,n.filled&&t.filled]}})(Su(({theme:e})=>({color:(e.vars||e).palette.text.secondary,...e.typography.body1,lineHeight:"1.4375em",padding:0,position:"relative",variants:[...Object.entries(e.palette).filter(Dd()).map(([t])=>({props:{color:t},style:{[`&.${em.focused}`]:{color:(e.vars||e).palette[t].main}}})),{props:{},style:{[`&.${em.disabled}`]:{color:(e.vars||e).palette.text.disabled},[`&.${em.error}`]:{color:(e.vars||e).palette.error.main}}}]}))),nm=la("span",{name:"MuiFormLabel",slot:"Asterisk"})(Su(({theme:e})=>({[`&.${em.error}`]:{color:(e.vars||e).palette.error.main}}))),rm=pe.forwardRef(function(e,t){const n=Eu({props:e,name:"MuiFormLabel"}),{children:r,className:o,color:i,component:a="label",disabled:l,error:c,filled:u,focused:d,required:A,...h}=n,p=Ap({props:n,muiFormControl:pp(),states:["color","required","focused","disabled","error","filled"]}),f={...n,color:p.color||"primary",component:a,disabled:p.disabled,error:p.error,filled:p.filled,focused:p.focused,required:p.required},g=(e=>{const{classes:t,color:n,focused:r,disabled:o,error:i,filled:s,required:a}=e;return Ti({root:["root",`color${vr(n)}`,o&&"disabled",i&&"error",s&&"filled",r&&"focused",a&&"required"],asterisk:["asterisk",i&&"error"]},Zg,t)})(f);return s.jsxs(tm,{as:a,ownerState:f,className:Co(g.root,o),ref:t,...h,children:[r,p.required&&s.jsxs(nm,{ownerState:f,"aria-hidden":!0,className:g.asterisk,children:["","*"]})]})});function om(e){return`scale(${e}, ${e**2})`}const im={entering:{opacity:1,transform:om(1)},entered:{opacity:1,transform:"none"}},sm="undefined"!=typeof navigator&&/^((?!chrome|android).)*(safari|mobile)/i.test(navigator.userAgent)&&/(os |version\/)15(.|_)4/i.test(navigator.userAgent),am=pe.forwardRef(function(e,t){const{addEndListener:n,appear:r=!0,children:o,easing:i,in:a,onEnter:l,onEntered:c,onEntering:u,onExit:d,onExited:A,onExiting:h,style:p,timeout:f="auto",TransitionComponent:g=Xu,...m}=e,y=sd(),v=pe.useRef(),b=ia(),w=pe.useRef(null),x=Ou(w,Gh(o),t),_=e=>t=>{if(e){const n=w.current;void 0===t?e(n):e(n,t)}},C=_(u),S=_((e,t)=>{ad(e);const{duration:n,delay:r,easing:o}=ld({style:p,timeout:f,easing:i},{mode:"enter"});let s;"auto"===f?(s=b.transitions.getAutoHeightDuration(e.clientHeight),v.current=s):s=n,e.style.transition=[b.transitions.create("opacity",{duration:s,delay:r}),b.transitions.create("transform",{duration:sm?s:.666*s,delay:r,easing:o})].join(","),l&&l(e,t)}),E=_(c),B=_(h),I=_(e=>{const{duration:t,delay:n,easing:r}=ld({style:p,timeout:f,easing:i},{mode:"exit"});let o;"auto"===f?(o=b.transitions.getAutoHeightDuration(e.clientHeight),v.current=o):o=t,e.style.transition=[b.transitions.create("opacity",{duration:o,delay:n}),b.transitions.create("transform",{duration:sm?o:.666*o,delay:sm?n:n||.333*o,easing:r})].join(","),e.style.opacity=0,e.style.transform=om(.75),d&&d(e)}),R=_(A);return s.jsx(g,{appear:r,in:a,nodeRef:w,onEnter:S,onEntered:E,onEntering:C,onExit:I,onExited:R,onExiting:B,addEndListener:e=>{"auto"===f&&y.start(v.current||0,e),n&&n(w.current,e)},timeout:"auto"===f?null:f,...m,children:(e,{ownerState:t,...n})=>pe.cloneElement(o,{style:{opacity:0,transform:om(.75),visibility:"exited"!==e||a?void 0:"hidden",...im[e],...p,...o.props.style},ref:x,...n})})});am&&(am.muiSupportAuto=!0);const lm=la(xp,{shouldForwardProp:e=>aa(e)||"classes"===e,name:"MuiInput",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:n}=e;return[...bp(e,t),!n.disableUnderline&&t.underline]}})(Su(({theme:e})=>{let t="light"===e.palette.mode?"rgba(0, 0, 0, 0.42)":"rgba(255, 255, 255, 0.7)";return e.vars&&(t=e.alpha(e.vars.palette.common.onBackground,e.vars.opacity.inputUnderline)),{position:"relative",variants:[{props:({ownerState:e})=>e.formControl,style:{"label + &":{marginTop:16}}},{props:({ownerState:e})=>!e.disableUnderline,style:{"&::after":{left:0,bottom:0,content:'""',position:"absolute",right:0,transform:"scaleX(0)",transition:e.transitions.create("transform",{duration:e.transitions.duration.shorter,easing:e.transitions.easing.easeOut}),pointerEvents:"none"},[`&.${Ip.focused}:after`]:{transform:"scaleX(1) translateX(0)"},[`&.${Ip.error}`]:{"&::before, &::after":{borderBottomColor:(e.vars||e).palette.error.main}},"&::before":{borderBottom:`1px solid ${t}`,left:0,bottom:0,content:'"\\00a0"',position:"absolute",right:0,transition:e.transitions.create("border-bottom-color",{duration:e.transitions.duration.shorter}),pointerEvents:"none"},[`&:hover:not(.${Ip.disabled}, .${Ip.error}):before`]:{borderBottom:`2px solid ${(e.vars||e).palette.text.primary}`,"@media (hover: none)":{borderBottom:`1px solid ${t}`}},[`&.${Ip.disabled}:before`]:{borderBottomStyle:"dotted"}}},...Object.entries(e.palette).filter(Dd()).map(([t])=>({props:{color:t,disableUnderline:!1},style:{"&::after":{borderBottom:`2px solid ${(e.vars||e).palette[t].main}`}}}))]}})),cm=la(_p,{name:"MuiInput",slot:"Input",overridesResolver:wp})({}),um=pe.forwardRef(function(e,t){const n=Eu({props:e,name:"MuiInput"}),{disableUnderline:r=!1,components:o={},componentsProps:i,fullWidth:a=!1,inputComponent:l="input",multiline:c=!1,slotProps:u,slots:d={},type:A="text",...h}=n,p=(e=>{const{classes:t,disableUnderline:n}=e,r=Ti({root:["root",!n&&"underline"],input:["input"]},Bp,t);return{...t,...r}})(n),f={root:{ownerState:{disableUnderline:r}}},g=u??i?ar(u??i,f):f,m=d.root??o.Root??lm,y=d.input??o.Input??cm;return s.jsx(Ep,{slots:{root:m,input:y},slotProps:g,fullWidth:a,inputComponent:l,multiline:c,ref:t,type:A,...h,classes:p})});function dm(e){return Eo("MuiInputLabel",e)}um.muiName="Input",Bo("MuiInputLabel",["root","focused","disabled","error","required","asterisk","formControl","sizeSmall","shrink","animated","standard","filled","outlined"]);const Am=la(rm,{shouldForwardProp:e=>aa(e)||"classes"===e,name:"MuiInputLabel",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:n}=e;return[{[`& .${em.asterisk}`]:t.asterisk},t.root,n.formControl&&t.formControl,"small"===n.size&&t.sizeSmall,n.shrink&&t.shrink,!n.disableAnimation&&t.animated,n.focused&&t.focused,t[n.variant]]}})(Su(({theme:e})=>({display:"block",transformOrigin:"top left",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",maxWidth:"100%",variants:[{props:({ownerState:e})=>e.formControl,style:{position:"absolute",left:0,top:0,transform:"translate(0, 20px) scale(1)"}},{props:{size:"small"},style:{transform:"translate(0, 17px) scale(1)"}},{props:({ownerState:e})=>e.shrink,style:{transform:"translate(0, -1.5px) scale(0.75)",transformOrigin:"top left",maxWidth:"133%"}},{props:({ownerState:e})=>!e.disableAnimation,style:{transition:e.transitions.create(["color","transform","max-width"],{duration:e.transitions.duration.shorter,easing:e.transitions.easing.easeOut})}},{props:{variant:"filled"},style:{zIndex:1,pointerEvents:"none",transform:"translate(12px, 16px) scale(1)",maxWidth:"calc(100% - 24px)"}},{props:{variant:"filled",size:"small"},style:{transform:"translate(12px, 13px) scale(1)"}},{props:({variant:e,ownerState:t})=>"filled"===e&&t.shrink,style:{userSelect:"none",pointerEvents:"auto",transform:"translate(12px, 7px) scale(0.75)",maxWidth:"calc(133% - 24px)"}},{props:({variant:e,ownerState:t,size:n})=>"filled"===e&&t.shrink&&"small"===n,style:{transform:"translate(12px, 4px) scale(0.75)"}},{props:{variant:"outlined"},style:{zIndex:1,pointerEvents:"none",transform:"translate(14px, 16px) scale(1)",maxWidth:"calc(100% - 24px)"}},{props:{variant:"outlined",size:"small"},style:{transform:"translate(14px, 9px) scale(1)"}},{props:({variant:e,ownerState:t})=>"outlined"===e&&t.shrink,style:{userSelect:"none",pointerEvents:"auto",maxWidth:"calc(133% - 32px)",transform:"translate(14px, -9px) scale(0.75)"}}]}))),hm=pe.forwardRef(function(e,t){const n=Eu({name:"MuiInputLabel",props:e}),{disableAnimation:r=!1,margin:o,shrink:i,variant:a,className:l,...c}=n,u=pp();let d=i;void 0===d&&u&&(d=u.filled||u.focused||u.adornedStart);const A=Ap({props:n,muiFormControl:u,states:["size","variant","required","focused"]}),h={...n,disableAnimation:r,formControl:u,shrink:d,size:A.size,variant:A.variant,required:A.required,focused:A.focused},p=(e=>{const{classes:t,formControl:n,size:r,shrink:o,disableAnimation:i,variant:s,required:a}=e,l=Ti({root:["root",n&&"formControl",!i&&"animated",o&&"shrink",r&&"medium"!==r&&`size${vr(r)}`,s],asterisk:[a&&"asterisk"]},dm,t);return{...t,...l}})(h);return s.jsx(Am,{"data-shrink":d,ref:t,className:Co(p.root,l),...c,ownerState:h,classes:p})});function pm(e){return Eo("MuiLink",e)}const fm=Bo("MuiLink",["root","underlineNone","underlineHover","underlineAlways","button","focusVisible"]),gm=({theme:e,ownerState:t})=>{const n=t.color;if("colorSpace"in e&&e.colorSpace){const r=br(e,`palette.${n}.main`)||br(e,`palette.${n}`)||t.color;return e.alpha(r,.4)}const r=br(e,`palette.${n}.main`,!1)||br(e,`palette.${n}`,!1)||t.color,o=br(e,`palette.${n}.mainChannel`)||br(e,`palette.${n}Channel`);return"vars"in e&&o?`rgba(${o} / 0.4)`:Ko(r,.4)},mm={primary:!0,secondary:!0,error:!0,info:!0,success:!0,warning:!0,textPrimary:!0,textSecondary:!0,textDisabled:!0},ym=la(vA,{name:"MuiLink",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:n}=e;return[t.root,t[`underline${vr(n.underline)}`],"button"===n.component&&t.button]}})(Su(({theme:e})=>({variants:[{props:{underline:"none"},style:{textDecoration:"none"}},{props:{underline:"hover"},style:{textDecoration:"none","&:hover":{textDecoration:"underline"}}},{props:{underline:"always"},style:{textDecoration:"underline","&:hover":{textDecorationColor:"inherit"}}},{props:({underline:e,ownerState:t})=>"always"===e&&"inherit"!==t.color,style:{textDecorationColor:"var(--Link-underlineColor)"}},{props:({underline:e,ownerState:t})=>"always"===e&&"inherit"===t.color,style:e.colorSpace?{textDecorationColor:e.alpha("currentColor",.4)}:null},...Object.entries(e.palette).filter(Dd()).map(([t])=>({props:{underline:"always",color:t},style:{"--Link-underlineColor":e.alpha((e.vars||e).palette[t].main,.4)}})),{props:{underline:"always",color:"textPrimary"},style:{"--Link-underlineColor":e.alpha((e.vars||e).palette.text.primary,.4)}},{props:{underline:"always",color:"textSecondary"},style:{"--Link-underlineColor":e.alpha((e.vars||e).palette.text.secondary,.4)}},{props:{underline:"always",color:"textDisabled"},style:{"--Link-underlineColor":(e.vars||e).palette.text.disabled}},{props:{component:"button"},style:{position:"relative",WebkitTapHighlightColor:"transparent",backgroundColor:"transparent",outline:0,border:0,margin:0,borderRadius:0,padding:0,cursor:"pointer",userSelect:"none",verticalAlign:"middle",MozAppearance:"none",WebkitAppearance:"none","&::-moz-focus-inner":{borderStyle:"none"},[`&.${fm.focusVisible}`]:{outline:"auto"}}}]}))),vm=pe.forwardRef(function(e,t){const n=Eu({props:e,name:"MuiLink"}),r=ia(),{className:o,color:i="primary",component:a="a",onBlur:l,onFocus:c,TypographyClasses:u,underline:d="always",variant:A="inherit",sx:h,...p}=n,[f,g]=pe.useState(!1),m={...n,color:i,component:a,focusVisible:f,underline:d,variant:A},y=(e=>{const{classes:t,component:n,focusVisible:r,underline:o}=e;return Ti({root:["root",`underline${vr(o)}`,"button"===n&&"button",r&&"focusVisible"]},pm,t)})(m);return s.jsx(ym,{color:i,className:Co(y.root,o),classes:u,component:a,onBlur:e=>{Cd(e.target)||g(!1),l&&l(e)},onFocus:e=>{Cd(e.target)&&g(!0),c&&c(e)},ref:t,ownerState:m,variant:A,...p,sx:[...void 0===mm[i]?[{color:i}]:[],...Array.isArray(h)?h:[h]],style:{...p.style,..."always"===d&&"inherit"!==i&&!mm[i]&&{"--Link-underlineColor":gm({theme:r,ownerState:m})}}})}),bm=pe.createContext({});function wm(e){return Eo("MuiList",e)}Bo("MuiList",["root","padding","dense","subheader"]);const xm=la("ul",{name:"MuiList",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:n}=e;return[t.root,!n.disablePadding&&t.padding,n.dense&&t.dense,n.subheader&&t.subheader]}})({listStyle:"none",margin:0,padding:0,position:"relative",variants:[{props:({ownerState:e})=>!e.disablePadding,style:{paddingTop:8,paddingBottom:8}},{props:({ownerState:e})=>e.subheader,style:{paddingTop:0}}]}),_m=pe.forwardRef(function(e,t){const n=Eu({props:e,name:"MuiList"}),{children:r,className:o,component:i="ul",dense:a=!1,disablePadding:l=!1,subheader:c,...u}=n,d=pe.useMemo(()=>({dense:a}),[a]),A={...n,component:i,dense:a,disablePadding:l},h=(e=>{const{classes:t,disablePadding:n,dense:r,subheader:o}=e;return Ti({root:["root",!n&&"padding",r&&"dense",o&&"subheader"]},wm,t)})(A);return s.jsx(bm.Provider,{value:d,children:s.jsxs(xm,{as:i,className:Co(h.root,o),ref:t,ownerState:A,...u,children:[c,r]})})});function Cm(e){return Eo("MuiListItem",e)}function Sm(e){return Eo("MuiListItemButton",e)}Bo("MuiListItem",["root","container","dense","alignItemsFlexStart","divider","gutters","padding","secondaryAction"]);const Em=Bo("MuiListItemButton",["root","focusVisible","dense","alignItemsFlexStart","disabled","divider","gutters","selected"]),Bm=la(Ud,{shouldForwardProp:e=>aa(e)||"classes"===e,name:"MuiListItemButton",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:n}=e;return[t.root,n.dense&&t.dense,"flex-start"===n.alignItems&&t.alignItemsFlexStart,n.divider&&t.divider,!n.disableGutters&&t.gutters]}})(Su(({theme:e})=>({display:"flex",flexGrow:1,justifyContent:"flex-start",alignItems:"center",position:"relative",textDecoration:"none",minWidth:0,boxSizing:"border-box",textAlign:"left",paddingTop:8,paddingBottom:8,transition:e.transitions.create("background-color",{duration:e.transitions.duration.shortest}),"&:hover":{textDecoration:"none",backgroundColor:(e.vars||e).palette.action.hover,"@media (hover: none)":{backgroundColor:"transparent"}},[`&.${Em.selected}`]:{backgroundColor:e.alpha((e.vars||e).palette.primary.main,(e.vars||e).palette.action.selectedOpacity),[`&.${Em.focusVisible}`]:{backgroundColor:e.alpha((e.vars||e).palette.primary.main,`${(e.vars||e).palette.action.selectedOpacity} + ${(e.vars||e).palette.action.focusOpacity}`)}},[`&.${Em.selected}:hover`]:{backgroundColor:e.alpha((e.vars||e).palette.primary.main,`${(e.vars||e).palette.action.selectedOpacity} + ${(e.vars||e).palette.action.hoverOpacity}`),"@media (hover: none)":{backgroundColor:e.alpha((e.vars||e).palette.primary.main,(e.vars||e).palette.action.selectedOpacity)}},[`&.${Em.focusVisible}`]:{backgroundColor:(e.vars||e).palette.action.focus},[`&.${Em.disabled}`]:{opacity:(e.vars||e).palette.action.disabledOpacity},variants:[{props:({ownerState:e})=>e.divider,style:{borderBottom:`1px solid ${(e.vars||e).palette.divider}`,backgroundClip:"padding-box"}},{props:{alignItems:"flex-start"},style:{alignItems:"flex-start"}},{props:({ownerState:e})=>!e.disableGutters,style:{paddingLeft:16,paddingRight:16}},{props:({ownerState:e})=>e.dense,style:{paddingTop:4,paddingBottom:4}}]}))),Im=pe.forwardRef(function(e,t){const n=Eu({props:e,name:"MuiListItemButton"}),{alignItems:r="center",autoFocus:o=!1,component:i="div",children:a,dense:l=!1,disableGutters:c=!1,divider:u=!1,focusVisibleClassName:d,selected:A=!1,className:h,...p}=n,f=pe.useContext(bm),g=pe.useMemo(()=>({dense:l||f.dense||!1,alignItems:r,disableGutters:c}),[r,f.dense,l,c]),m=pe.useRef(null);Qo(()=>{o&&m.current&&m.current.focus()},[o]);const y={...n,alignItems:r,dense:g.dense,disableGutters:c,divider:u,selected:A},v=(e=>{const{alignItems:t,classes:n,dense:r,disabled:o,disableGutters:i,divider:s,selected:a}=e,l=Ti({root:["root",r&&"dense",!i&&"gutters",s&&"divider",o&&"disabled","flex-start"===t&&"alignItemsFlexStart",a&&"selected"]},Sm,n);return{...n,...l}})(y),b=Ou(m,t);return s.jsx(bm.Provider,{value:g,children:s.jsx(Bm,{ref:b,href:p.href||p.to,component:(p.href||p.to)&&"div"===i?"button":i,focusVisibleClassName:Co(v.focusVisible,d),ownerState:y,className:Co(v.root,h),...p,classes:v,children:a})})});function Rm(e){return Eo("MuiListItemSecondaryAction",e)}Bo("MuiListItemSecondaryAction",["root","disableGutters"]);const km=la("div",{name:"MuiListItemSecondaryAction",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:n}=e;return[t.root,n.disableGutters&&t.disableGutters]}})({position:"absolute",right:16,top:"50%",transform:"translateY(-50%)",variants:[{props:({ownerState:e})=>e.disableGutters,style:{right:0}}]}),Tm=pe.forwardRef(function(e,t){const n=Eu({props:e,name:"MuiListItemSecondaryAction"}),{className:r,...o}=n,i=pe.useContext(bm),a={...n,disableGutters:i.disableGutters},l=(e=>{const{disableGutters:t,classes:n}=e;return Ti({root:["root",t&&"disableGutters"]},Rm,n)})(a);return s.jsx(km,{className:Co(l.root,r),ownerState:a,ref:t,...o})});Tm.muiName="ListItemSecondaryAction";const Pm=la("div",{name:"MuiListItem",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:n}=e;return[t.root,n.dense&&t.dense,"flex-start"===n.alignItems&&t.alignItemsFlexStart,n.divider&&t.divider,!n.disableGutters&&t.gutters,!n.disablePadding&&t.padding,n.hasSecondaryAction&&t.secondaryAction]}})(Su(({theme:e})=>({display:"flex",justifyContent:"flex-start",alignItems:"center",position:"relative",textDecoration:"none",width:"100%",boxSizing:"border-box",textAlign:"left",variants:[{props:({ownerState:e})=>!e.disablePadding,style:{paddingTop:8,paddingBottom:8}},{props:({ownerState:e})=>!e.disablePadding&&e.dense,style:{paddingTop:4,paddingBottom:4}},{props:({ownerState:e})=>!e.disablePadding&&!e.disableGutters,style:{paddingLeft:16,paddingRight:16}},{props:({ownerState:e})=>!e.disablePadding&&!!e.secondaryAction,style:{paddingRight:48}},{props:({ownerState:e})=>!!e.secondaryAction,style:{[`& > .${Em.root}`]:{paddingRight:48}}},{props:{alignItems:"flex-start"},style:{alignItems:"flex-start"}},{props:({ownerState:e})=>e.divider,style:{borderBottom:`1px solid ${(e.vars||e).palette.divider}`,backgroundClip:"padding-box"}},{props:({ownerState:e})=>e.button,style:{transition:e.transitions.create("background-color",{duration:e.transitions.duration.shortest}),"&:hover":{textDecoration:"none",backgroundColor:(e.vars||e).palette.action.hover,"@media (hover: none)":{backgroundColor:"transparent"}}}},{props:({ownerState:e})=>e.hasSecondaryAction,style:{paddingRight:48}}]}))),Fm=la("li",{name:"MuiListItem",slot:"Container"})({position:"relative"}),Mm=pe.forwardRef(function(e,t){const n=Eu({props:e,name:"MuiListItem"}),{alignItems:r="center",children:o,className:i,component:a,components:l={},componentsProps:c={},ContainerComponent:u="li",ContainerProps:{className:d,...A}={},dense:h=!1,disableGutters:p=!1,disablePadding:f=!1,divider:g=!1,secondaryAction:m,slotProps:y={},slots:v={},...b}=n,w=pe.useContext(bm),x=pe.useMemo(()=>({dense:h||w.dense||!1,alignItems:r,disableGutters:p}),[r,w.dense,h,p]),_=pe.useRef(null),C=pe.Children.toArray(o),S=C.length&&Pi(C[C.length-1],["ListItemSecondaryAction"]),E={...n,alignItems:r,dense:x.dense,disableGutters:p,disablePadding:f,divider:g,hasSecondaryAction:S},B=(e=>{const{alignItems:t,classes:n,dense:r,disableGutters:o,disablePadding:i,divider:s,hasSecondaryAction:a}=e;return Ti({root:["root",r&&"dense",!o&&"gutters",!i&&"padding",s&&"divider","flex-start"===t&&"alignItemsFlexStart",a&&"secondaryAction"],container:["container"]},Cm,n)})(E),I=Ou(_,t),R=v.root||l.Root||Pm,k=y.root||c.root||{},T={className:Co(B.root,k.className,i),...b};let P=a||"li";return S?(P=T.component||a?P:"div","li"===u&&("li"===P?P="div":"li"===T.component&&(T.component="div")),s.jsx(bm.Provider,{value:x,children:s.jsxs(Fm,{as:u,className:Co(B.container,d),ref:I,ownerState:E,...A,children:[s.jsx(R,{...k,...!md(R)&&{as:P,ownerState:{...E,...k.ownerState}},...T,children:C}),C.pop()]})})):s.jsx(bm.Provider,{value:x,children:s.jsxs(R,{...k,as:P,ref:I,...!md(R)&&{ownerState:{...E,...k.ownerState}},...T,children:[C,m&&s.jsx(Tm,{children:m})]})})});function Lm(e){return Eo("MuiListItemIcon",e)}const Um=Bo("MuiListItemIcon",["root","alignItemsFlexStart"]),Om=la("div",{name:"MuiListItemIcon",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:n}=e;return[t.root,"flex-start"===n.alignItems&&t.alignItemsFlexStart]}})(Su(({theme:e})=>({minWidth:56,color:(e.vars||e).palette.action.active,flexShrink:0,display:"inline-flex",variants:[{props:{alignItems:"flex-start"},style:{marginTop:8}}]}))),Dm=pe.forwardRef(function(e,t){const n=Eu({props:e,name:"MuiListItemIcon"}),{className:r,...o}=n,i=pe.useContext(bm),a={...n,alignItems:i.alignItems},l=(e=>{const{alignItems:t,classes:n}=e;return Ti({root:["root","flex-start"===t&&"alignItemsFlexStart"]},Lm,n)})(a);return s.jsx(Om,{className:Co(l.root,r),ownerState:a,ref:t,...o})});function Nm(e){return Eo("MuiListItemText",e)}const jm=Bo("MuiListItemText",["root","multiline","dense","inset","primary","secondary"]),Qm=la("div",{name:"MuiListItemText",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:n}=e;return[{[`& .${jm.primary}`]:t.primary},{[`& .${jm.secondary}`]:t.secondary},t.root,n.inset&&t.inset,n.primary&&n.secondary&&t.multiline,n.dense&&t.dense]}})({flex:"1 1 auto",minWidth:0,marginTop:4,marginBottom:4,[`.${pA.root}:where(& .${jm.primary})`]:{display:"block"},[`.${pA.root}:where(& .${jm.secondary})`]:{display:"block"},variants:[{props:({ownerState:e})=>e.primary&&e.secondary,style:{marginTop:6,marginBottom:6}},{props:({ownerState:e})=>e.inset,style:{paddingLeft:56}}]}),zm=pe.forwardRef(function(e,t){const n=Eu({props:e,name:"MuiListItemText"}),{children:r,className:o,disableTypography:i=!1,inset:a=!1,primary:l,primaryTypographyProps:c,secondary:u,secondaryTypographyProps:d,slots:A={},slotProps:h={},...p}=n,{dense:f}=pe.useContext(bm);let g=null!=l?l:r,m=u;const y={...n,disableTypography:i,inset:a,primary:!!g,secondary:!!m,dense:f},v=(e=>{const{classes:t,inset:n,primary:r,secondary:o,dense:i}=e;return Ti({root:["root",n&&"inset",i&&"dense",r&&o&&"multiline"],primary:["primary"],secondary:["secondary"]},Nm,t)})(y),b={slots:A,slotProps:{primary:c,secondary:d,...h}},[w,x]=_d("root",{className:Co(v.root,o),elementType:Qm,externalForwardedProps:{...b,...p},ownerState:y,ref:t}),[_,C]=_d("primary",{className:v.primary,elementType:vA,externalForwardedProps:b,ownerState:y}),[S,E]=_d("secondary",{className:v.secondary,elementType:vA,externalForwardedProps:b,ownerState:y});return null==g||g.type===vA||i||(g=s.jsx(_,{variant:f?"body2":"body1",component:C?.variant?void 0:"span",...C,children:g})),null==m||m.type===vA||i||(m=s.jsx(S,{variant:"body2",color:"textSecondary",...E,children:m})),s.jsxs(w,{...x,children:[g,m]})});function Hm(e,t,n){return e===t?e.firstChild:t&&t.nextElementSibling?t.nextElementSibling:n?null:e.firstChild}function Gm(e,t,n){return e===t?n?e.firstChild:e.lastChild:t&&t.previousElementSibling?t.previousElementSibling:n?null:e.lastChild}function Vm(e,t){if(void 0===t)return!0;let n=e.innerText;return void 0===n&&(n=e.textContent),n=n.trim().toLowerCase(),0!==n.length&&(t.repeating?n[0]===t.keys[0]:n.startsWith(t.keys.join("")))}function Wm(e,t,n,r,o,i){let s=!1,a=o(e,t,!!t&&n);for(;a;){if(a===e.firstChild){if(s)return!1;s=!0}const t=!r&&(a.disabled||"true"===a.getAttribute("aria-disabled"));if(a.hasAttribute("tabindex")&&Vm(a,i)&&!t)return a.focus(),!0;a=o(e,a,n)}return!1}const $m=pe.forwardRef(function(e,t){const{actions:n,autoFocus:r=!1,autoFocusItem:o=!1,children:i,className:a,disabledItemsFocusable:l=!1,disableListWrap:c=!1,onKeyDown:u,variant:d="selectedMenu",...A}=e,h=pe.useRef(null),p=pe.useRef({keys:[],repeating:!0,previousKeyMatched:!0,lastTime:null});Qo(()=>{r&&h.current.focus()},[r]),pe.useImperativeHandle(n,()=>({adjustStyleForScrollbar:(e,{direction:t})=>{const n=!h.current.style.width;if(e.clientHeight<h.current.clientHeight&&n){const n=`${Hf(Fu(e))}px`;h.current.style["rtl"===t?"paddingLeft":"paddingRight"]=n,h.current.style.width=`calc(100% + ${n})`}return h.current}}),[]);const f=Ou(h,t);let g=-1;pe.Children.forEach(i,(e,t)=>{pe.isValidElement(e)?(e.props.disabled||("selectedMenu"===d&&e.props.selected||-1===g)&&(g=t),g===t&&(e.props.disabled||e.props.muiSkipListHighlight||e.type.muiSkipListHighlight)&&(g+=1,g>=i.length&&(g=-1))):g===t&&(g+=1,g>=i.length&&(g=-1))});const m=pe.Children.map(i,(e,t)=>{if(t===g){const t={};return o&&(t.autoFocus=!0),void 0===e.props.tabIndex&&"selectedMenu"===d&&(t.tabIndex=0),pe.cloneElement(e,t)}return e});return s.jsx(_m,{role:"menu",ref:f,className:a,onKeyDown:e=>{const t=h.current,n=e.key;if(e.ctrlKey||e.metaKey||e.altKey)return void(u&&u(e));const r=Pu(t).activeElement;if("ArrowDown"===n)e.preventDefault(),Wm(t,r,c,l,Hm);else if("ArrowUp"===n)e.preventDefault(),Wm(t,r,c,l,Gm);else if("Home"===n)e.preventDefault(),Wm(t,null,c,l,Hm);else if("End"===n)e.preventDefault(),Wm(t,null,c,l,Gm);else if(1===n.length){const o=p.current,i=n.toLowerCase(),s=performance.now();o.keys.length>0&&(s-o.lastTime>500?(o.keys=[],o.repeating=!0,o.previousKeyMatched=!0):o.repeating&&i!==o.keys[0]&&(o.repeating=!1)),o.lastTime=s,o.keys.push(i);const a=r&&!o.repeating&&Vm(r,o);o.previousKeyMatched&&(a||Wm(t,r,!1,l,Hm,o))?e.preventDefault():o.previousKeyMatched=!1}u&&u(e)},tabIndex:r?0:-1,...A,children:m})});function Km(e){return Eo("MuiPopover",e)}function Xm(e,t){let n=0;return"number"==typeof t?n=t:"center"===t?n=e.height/2:"bottom"===t&&(n=e.height),n}function Ym(e,t){let n=0;return"number"==typeof t?n=t:"center"===t?n=e.width/2:"right"===t&&(n=e.width),n}function qm(e){return[e.horizontal,e.vertical].map(e=>"number"==typeof e?`${e}px`:e).join(" ")}function Jm(e){return"function"==typeof e?e():e}Bo("MuiPopover",["root","paper"]);const Zm=la(ig,{name:"MuiPopover",slot:"Root"})({}),ey=la(gd,{name:"MuiPopover",slot:"Paper"})({position:"absolute",overflowY:"auto",overflowX:"hidden",minWidth:16,minHeight:16,maxWidth:"calc(100% - 32px)",maxHeight:"calc(100% - 32px)",outline:0}),ty=pe.forwardRef(function(e,t){const n=Eu({props:e,name:"MuiPopover"}),{action:r,anchorEl:o,anchorOrigin:i={vertical:"top",horizontal:"left"},anchorPosition:a,anchorReference:l="anchorEl",children:c,className:u,container:d,elevation:A=8,marginThreshold:h=16,open:p,PaperProps:f={},slots:g={},slotProps:m={},transformOrigin:y={vertical:"top",horizontal:"left"},TransitionComponent:v,transitionDuration:b="auto",TransitionProps:w={},disableScrollLock:x=!1,..._}=n,C=pe.useRef(),S={...n,anchorOrigin:i,anchorReference:l,elevation:A,marginThreshold:h,transformOrigin:y,TransitionComponent:v,transitionDuration:b,TransitionProps:w},E=(e=>{const{classes:t}=e;return Ti({root:["root"],paper:["paper"]},Km,t)})(S),B=pe.useCallback(()=>{if("anchorPosition"===l)return a;const e=Jm(o),t=(e&&1===e.nodeType?e:Pu(C.current).body).getBoundingClientRect();return{top:t.top+Xm(t,i.vertical),left:t.left+Ym(t,i.horizontal)}},[o,i.horizontal,i.vertical,a,l]),I=pe.useCallback(e=>({vertical:Xm(e,y.vertical),horizontal:Ym(e,y.horizontal)}),[y.horizontal,y.vertical]),R=pe.useCallback(e=>{const t={width:e.offsetWidth,height:e.offsetHeight},n=I(t);if("none"===l)return{top:null,left:null,transformOrigin:qm(n)};const r=B();let i=r.top-n.vertical,s=r.left-n.horizontal;const a=i+t.height,c=s+t.width,u=Fu(Jm(o)),d=u.innerHeight-h,A=u.innerWidth-h;if(null!==h&&i<h){const e=i-h;i-=e,n.vertical+=e}else if(null!==h&&a>d){const e=a-d;i-=e,n.vertical+=e}if(null!==h&&s<h){const e=s-h;s-=e,n.horizontal+=e}else if(c>A){const e=c-A;s-=e,n.horizontal+=e}return{top:`${Math.round(i)}px`,left:`${Math.round(s)}px`,transformOrigin:qm(n)}},[o,l,B,I,h]),[k,T]=pe.useState(p),P=pe.useCallback(()=>{const e=C.current;if(!e)return;const t=R(e);null!==t.top&&e.style.setProperty("top",t.top),null!==t.left&&(e.style.left=t.left),e.style.transformOrigin=t.transformOrigin,T(!0)},[R]);pe.useEffect(()=>(x&&window.addEventListener("scroll",P),()=>window.removeEventListener("scroll",P)),[o,x,P]);pe.useEffect(()=>{p&&P()}),pe.useImperativeHandle(r,()=>p?{updatePosition:()=>{P()}}:null,[p,P]),pe.useEffect(()=>{if(!p)return;const e=Tu(()=>{P()}),t=Fu(Jm(o));return t.addEventListener("resize",e),()=>{e.clear(),t.removeEventListener("resize",e)}},[o,p,P]);let F=b;const M={slots:{transition:v,...g},slotProps:{transition:w,paper:f,...m}},[L,U]=_d("transition",{elementType:am,externalForwardedProps:M,ownerState:S,getSlotProps:e=>({...e,onEntering:(t,n)=>{e.onEntering?.(t,n),P()},onExited:t=>{e.onExited?.(t),T(!1)}}),additionalProps:{appear:!0,in:p}});"auto"!==b||L.muiSupportAuto||(F=void 0);const O=d||(o?Pu(Jm(o)).body:void 0),[D,{slots:N,slotProps:j,...Q}]=_d("root",{ref:t,elementType:Zm,externalForwardedProps:{...M,..._},shouldForwardComponentProp:!0,additionalProps:{slots:{backdrop:g.backdrop},slotProps:{backdrop:Du("function"==typeof m.backdrop?m.backdrop(S):m.backdrop,{invisible:!0})},container:O,open:p},ownerState:S,className:Co(E.root,u)}),[z,H]=_d("paper",{ref:C,className:E.paper,elementType:ey,externalForwardedProps:M,shouldForwardComponentProp:!0,additionalProps:{elevation:A,style:k?void 0:{opacity:0}},ownerState:S});return s.jsx(D,{...Q,...!md(D)&&{slots:N,slotProps:j,disableScrollLock:x},children:s.jsx(L,{...U,timeout:F,children:s.jsx(z,{...H,children:c})})})});function ny(e){return Eo("MuiMenu",e)}Bo("MuiMenu",["root","paper","list"]);const ry={vertical:"top",horizontal:"right"},oy={vertical:"top",horizontal:"left"},iy=la(ty,{shouldForwardProp:e=>aa(e)||"classes"===e,name:"MuiMenu",slot:"Root"})({}),sy=la(ey,{name:"MuiMenu",slot:"Paper"})({maxHeight:"calc(100% - 96px)",WebkitOverflowScrolling:"touch"}),ay=la($m,{name:"MuiMenu",slot:"List"})({outline:0}),ly=pe.forwardRef(function(e,t){const n=Eu({props:e,name:"MuiMenu"}),{autoFocus:r=!0,children:o,className:i,disableAutoFocusItem:a=!1,MenuListProps:l={},onClose:c,open:u,PaperProps:d={},PopoverClasses:A,transitionDuration:h="auto",TransitionProps:{onEntering:p,...f}={},variant:g="selectedMenu",slots:m={},slotProps:y={},...v}=n,b=li(),w={...n,autoFocus:r,disableAutoFocusItem:a,MenuListProps:l,onEntering:p,PaperProps:d,transitionDuration:h,TransitionProps:f,variant:g},x=(e=>{const{classes:t}=e;return Ti({root:["root"],paper:["paper"],list:["list"]},ny,t)})(w),_=r&&!a&&u,C=pe.useRef(null);let S=-1;pe.Children.map(o,(e,t)=>{pe.isValidElement(e)&&(e.props.disabled||("selectedMenu"===g&&e.props.selected||-1===S)&&(S=t))});const E={slots:m,slotProps:{list:l,transition:f,paper:d,...y}},B=Hh({elementType:m.root,externalSlotProps:y.root,ownerState:w,className:[x.root,i]}),[I,R]=_d("paper",{className:x.paper,elementType:sy,externalForwardedProps:E,shouldForwardComponentProp:!0,ownerState:w}),[k,T]=_d("list",{className:Co(x.list,l.className),elementType:ay,shouldForwardComponentProp:!0,externalForwardedProps:E,getSlotProps:e=>({...e,onKeyDown:t=>{(e=>{"Tab"===e.key&&(e.preventDefault(),c&&c(e,"tabKeyDown"))})(t),e.onKeyDown?.(t)}}),ownerState:w}),P="function"==typeof E.slotProps.transition?E.slotProps.transition(w):E.slotProps.transition;return s.jsx(iy,{onClose:c,anchorOrigin:{vertical:"bottom",horizontal:b?"right":"left"},transformOrigin:b?ry:oy,slots:{root:m.root,paper:I,backdrop:m.backdrop,...m.transition&&{transition:m.transition}},slotProps:{root:B,paper:R,backdrop:"function"==typeof y.backdrop?y.backdrop(w):y.backdrop,transition:{...P,onEntering:(...e)=>{((e,t)=>{C.current&&C.current.adjustStyleForScrollbar(e,{direction:b?"rtl":"ltr"}),p&&p(e,t)})(...e),P?.onEntering?.(...e)}}},open:u,ref:t,transitionDuration:h,ownerState:w,...v,classes:A,children:s.jsx(k,{actions:C,autoFocus:r&&(-1===S||a),autoFocusItem:_,variant:g,...T,children:o})})});function cy(e){return Eo("MuiMenuItem",e)}const uy=Bo("MuiMenuItem",["root","focusVisible","dense","disabled","divider","gutters","selected"]),dy=la(Ud,{shouldForwardProp:e=>aa(e)||"classes"===e,name:"MuiMenuItem",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:n}=e;return[t.root,n.dense&&t.dense,n.divider&&t.divider,!n.disableGutters&&t.gutters]}})(Su(({theme:e})=>({...e.typography.body1,display:"flex",justifyContent:"flex-start",alignItems:"center",position:"relative",textDecoration:"none",minHeight:48,paddingTop:6,paddingBottom:6,boxSizing:"border-box",whiteSpace:"nowrap","&:hover":{textDecoration:"none",backgroundColor:(e.vars||e).palette.action.hover,"@media (hover: none)":{backgroundColor:"transparent"}},[`&.${uy.selected}`]:{backgroundColor:e.alpha((e.vars||e).palette.primary.main,(e.vars||e).palette.action.selectedOpacity),[`&.${uy.focusVisible}`]:{backgroundColor:e.alpha((e.vars||e).palette.primary.main,`${(e.vars||e).palette.action.selectedOpacity} + ${(e.vars||e).palette.action.focusOpacity}`)}},[`&.${uy.selected}:hover`]:{backgroundColor:e.alpha((e.vars||e).palette.primary.main,`${(e.vars||e).palette.action.selectedOpacity} + ${(e.vars||e).palette.action.hoverOpacity}`),"@media (hover: none)":{backgroundColor:e.alpha((e.vars||e).palette.primary.main,(e.vars||e).palette.action.selectedOpacity)}},[`&.${uy.focusVisible}`]:{backgroundColor:(e.vars||e).palette.action.focus},[`&.${uy.disabled}`]:{opacity:(e.vars||e).palette.action.disabledOpacity},[`& + .${Ig.root}`]:{marginTop:e.spacing(1),marginBottom:e.spacing(1)},[`& + .${Ig.inset}`]:{marginLeft:52},[`& .${jm.root}`]:{marginTop:0,marginBottom:0},[`& .${jm.inset}`]:{paddingLeft:36},[`& .${Um.root}`]:{minWidth:36},variants:[{props:({ownerState:e})=>!e.disableGutters,style:{paddingLeft:16,paddingRight:16}},{props:({ownerState:e})=>e.divider,style:{borderBottom:`1px solid ${(e.vars||e).palette.divider}`,backgroundClip:"padding-box"}},{props:({ownerState:e})=>!e.dense,style:{[e.breakpoints.up("sm")]:{minHeight:"auto"}}},{props:({ownerState:e})=>e.dense,style:{minHeight:32,paddingTop:4,paddingBottom:4,...e.typography.body2,[`& .${Um.root} svg`]:{fontSize:"1.25rem"}}}]}))),Ay=pe.forwardRef(function(e,t){const n=Eu({props:e,name:"MuiMenuItem"}),{autoFocus:r=!1,component:o="li",dense:i=!1,divider:a=!1,disableGutters:l=!1,focusVisibleClassName:c,role:u="menuitem",tabIndex:d,className:A,...h}=n,p=pe.useContext(bm),f=pe.useMemo(()=>({dense:i||p.dense||!1,disableGutters:l}),[p.dense,i,l]),g=pe.useRef(null);Qo(()=>{r&&g.current&&g.current.focus()},[r]);const m={...n,dense:f.dense,divider:a,disableGutters:l},y=(e=>{const{disabled:t,dense:n,divider:r,disableGutters:o,selected:i,classes:s}=e,a=Ti({root:["root",n&&"dense",t&&"disabled",!o&&"gutters",r&&"divider",i&&"selected"]},cy,s);return{...s,...a}})(n),v=Ou(g,t);let b;return n.disabled||(b=void 0!==d?d:-1),s.jsx(bm.Provider,{value:f,children:s.jsx(dy,{ref:v,role:u,tabIndex:b,component:o,focusVisibleClassName:Co(y.focusVisible,c),className:Co(y.root,A),...h,ownerState:m,classes:y})})});function hy(e){return Eo("MuiNativeSelect",e)}const py=Bo("MuiNativeSelect",["root","select","multiple","filled","outlined","standard","disabled","icon","iconOpen","iconFilled","iconOutlined","iconStandard","nativeInput","error"]),fy=la("select",{name:"MuiNativeSelect"})(({theme:e})=>({MozAppearance:"none",WebkitAppearance:"none",userSelect:"none",borderRadius:0,cursor:"pointer","&:focus":{borderRadius:0},[`&.${py.disabled}`]:{cursor:"default"},"&[multiple]":{height:"auto"},"&:not([multiple]) option, &:not([multiple]) optgroup":{backgroundColor:(e.vars||e).palette.background.paper},variants:[{props:({ownerState:e})=>"filled"!==e.variant&&"outlined"!==e.variant,style:{"&&&":{paddingRight:24,minWidth:16}}},{props:{variant:"filled"},style:{"&&&":{paddingRight:32}}},{props:{variant:"outlined"},style:{borderRadius:(e.vars||e).shape.borderRadius,"&:focus":{borderRadius:(e.vars||e).shape.borderRadius},"&&&":{paddingRight:32}}}]})),gy=la(fy,{name:"MuiNativeSelect",slot:"Select",shouldForwardProp:aa,overridesResolver:(e,t)=>{const{ownerState:n}=e;return[t.select,t[n.variant],n.error&&t.error,{[`&.${py.multiple}`]:t.multiple}]}})({}),my=la("svg",{name:"MuiNativeSelect"})(({theme:e})=>({position:"absolute",right:0,top:"calc(50% - .5em)",pointerEvents:"none",color:(e.vars||e).palette.action.active,[`&.${py.disabled}`]:{color:(e.vars||e).palette.action.disabled},variants:[{props:({ownerState:e})=>e.open,style:{transform:"rotate(180deg)"}},{props:{variant:"filled"},style:{right:7}},{props:{variant:"outlined"},style:{right:7}}]})),yy=la(my,{name:"MuiNativeSelect",slot:"Icon",overridesResolver:(e,t)=>{const{ownerState:n}=e;return[t.icon,n.variant&&t[`icon${vr(n.variant)}`],n.open&&t.iconOpen]}})({}),vy=pe.forwardRef(function(e,t){const{className:n,disabled:r,error:o,IconComponent:i,inputRef:a,variant:l="standard",...c}=e,u={...e,disabled:r,variant:l,error:o},d=(e=>{const{classes:t,variant:n,disabled:r,multiple:o,open:i,error:s}=e;return Ti({select:["select",n,r&&"disabled",o&&"multiple",s&&"error"],icon:["icon",`icon${vr(n)}`,i&&"iconOpen",r&&"disabled"]},hy,t)})(u);return s.jsxs(pe.Fragment,{children:[s.jsx(gy,{ownerState:u,className:Co(d.select,n),disabled:r,ref:a||t,...c}),e.multiple?null:s.jsx(yy,{as:i,ownerState:u,className:d.icon})]})});var by;const wy=la("fieldset",{name:"MuiNotchedOutlined",shouldForwardProp:aa})({textAlign:"left",position:"absolute",bottom:0,right:0,top:-5,left:0,margin:0,padding:"0 8px",pointerEvents:"none",borderRadius:"inherit",borderStyle:"solid",borderWidth:1,overflow:"hidden",minWidth:"0%"}),xy=la("legend",{name:"MuiNotchedOutlined",shouldForwardProp:aa})(Su(({theme:e})=>({float:"unset",width:"auto",overflow:"hidden",variants:[{props:({ownerState:e})=>!e.withLabel,style:{padding:0,lineHeight:"11px",transition:e.transitions.create("width",{duration:150,easing:e.transitions.easing.easeOut})}},{props:({ownerState:e})=>e.withLabel,style:{display:"block",padding:0,height:11,fontSize:"0.75em",visibility:"hidden",maxWidth:.01,transition:e.transitions.create("max-width",{duration:50,easing:e.transitions.easing.easeOut}),whiteSpace:"nowrap","& > span":{paddingLeft:5,paddingRight:5,display:"inline-block",opacity:0,visibility:"visible"}}},{props:({ownerState:e})=>e.withLabel&&e.notched,style:{maxWidth:"100%",transition:e.transitions.create("max-width",{duration:100,easing:e.transitions.easing.easeOut,delay:50})}}]})));const _y=la(xp,{shouldForwardProp:e=>aa(e)||"classes"===e,name:"MuiOutlinedInput",slot:"Root",overridesResolver:bp})(Su(({theme:e})=>{const t="light"===e.palette.mode?"rgba(0, 0, 0, 0.23)":"rgba(255, 255, 255, 0.23)";return{position:"relative",borderRadius:(e.vars||e).shape.borderRadius,[`&:hover .${kp.notchedOutline}`]:{borderColor:(e.vars||e).palette.text.primary},"@media (hover: none)":{[`&:hover .${kp.notchedOutline}`]:{borderColor:e.vars?e.alpha(e.vars.palette.common.onBackground,.23):t}},[`&.${kp.focused} .${kp.notchedOutline}`]:{borderWidth:2},variants:[...Object.entries(e.palette).filter(Dd()).map(([t])=>({props:{color:t},style:{[`&.${kp.focused} .${kp.notchedOutline}`]:{borderColor:(e.vars||e).palette[t].main}}})),{props:{},style:{[`&.${kp.error} .${kp.notchedOutline}`]:{borderColor:(e.vars||e).palette.error.main},[`&.${kp.disabled} .${kp.notchedOutline}`]:{borderColor:(e.vars||e).palette.action.disabled}}},{props:({ownerState:e})=>e.startAdornment,style:{paddingLeft:14}},{props:({ownerState:e})=>e.endAdornment,style:{paddingRight:14}},{props:({ownerState:e})=>e.multiline,style:{padding:"16.5px 14px"}},{props:({ownerState:e,size:t})=>e.multiline&&"small"===t,style:{padding:"8.5px 14px"}}]}})),Cy=la(function(e){const{children:t,classes:n,className:r,label:o,notched:i,...a}=e,l=null!=o&&""!==o,c={...e,notched:i,withLabel:l};return s.jsx(wy,{"aria-hidden":!0,className:r,ownerState:c,...a,children:s.jsx(xy,{ownerState:c,children:l?s.jsx("span",{children:o}):by||(by=s.jsx("span",{className:"notranslate","aria-hidden":!0,children:""}))})})},{name:"MuiOutlinedInput",slot:"NotchedOutline"})(Su(({theme:e})=>{const t="light"===e.palette.mode?"rgba(0, 0, 0, 0.23)":"rgba(255, 255, 255, 0.23)";return{borderColor:e.vars?e.alpha(e.vars.palette.common.onBackground,.23):t}})),Sy=la(_p,{name:"MuiOutlinedInput",slot:"Input",overridesResolver:wp})(Su(({theme:e})=>({padding:"16.5px 14px",...!e.vars&&{"&:-webkit-autofill":{WebkitBoxShadow:"light"===e.palette.mode?null:"0 0 0 100px #266798 inset",WebkitTextFillColor:"light"===e.palette.mode?null:"#fff",caretColor:"light"===e.palette.mode?null:"#fff",borderRadius:"inherit"}},...e.vars&&{"&:-webkit-autofill":{borderRadius:"inherit"},[e.getColorSchemeSelector("dark")]:{"&:-webkit-autofill":{WebkitBoxShadow:"0 0 0 100px #266798 inset",WebkitTextFillColor:"#fff",caretColor:"#fff"}}},variants:[{props:{size:"small"},style:{padding:"8.5px 14px"}},{props:({ownerState:e})=>e.multiline,style:{padding:0}},{props:({ownerState:e})=>e.startAdornment,style:{paddingLeft:0}},{props:({ownerState:e})=>e.endAdornment,style:{paddingRight:0}}]}))),Ey=pe.forwardRef(function(e,t){const n=Eu({props:e,name:"MuiOutlinedInput"}),{components:r={},fullWidth:o=!1,inputComponent:i="input",label:a,multiline:l=!1,notched:c,slots:u={},slotProps:d={},type:A="text",...h}=n,p=(e=>{const{classes:t}=e,n=Ti({root:["root"],notchedOutline:["notchedOutline"],input:["input"]},Rp,t);return{...t,...n}})(n),f=pp(),g=Ap({props:n,muiFormControl:f,states:["color","disabled","error","focused","hiddenLabel","size","required"]}),m={...n,color:g.color||"primary",disabled:g.disabled,error:g.error,focused:g.focused,formControl:f,fullWidth:o,hiddenLabel:g.hiddenLabel,multiline:l,size:g.size,type:A},y=u.root??r.Root??_y,v=u.input??r.Input??Sy,[b,w]=_d("notchedOutline",{elementType:Cy,className:p.notchedOutline,shouldForwardComponentProp:!0,ownerState:m,externalForwardedProps:{slots:u,slotProps:d},additionalProps:{label:null!=a&&""!==a&&g.required?s.jsxs(pe.Fragment,{children:[a,"","*"]}):a}});return s.jsx(Ep,{slots:{root:y,input:v},slotProps:d,renderSuffix:e=>s.jsx(b,{...w,notched:void 0!==c?c:Boolean(e.startAdornment||e.filled||e.focused)}),fullWidth:o,inputComponent:i,multiline:l,ref:t,type:A,...h,classes:{...p,notchedOutline:null}})});Ey.muiName="Input";const By=ku(s.jsx("path",{d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 18c-4.42 0-8-3.58-8-8s3.58-8 8-8 8 3.58 8 8-3.58 8-8 8z"})),Iy=ku(s.jsx("path",{d:"M8.465 8.465C9.37 7.56 10.62 7 12 7C14.76 7 17 9.24 17 12C17 13.38 16.44 14.63 15.535 15.535C14.63 16.44 13.38 17 12 17C9.24 17 7 14.76 7 12C7 10.62 7.56 9.37 8.465 8.465Z"})),Ry=la("span",{name:"MuiRadioButtonIcon",shouldForwardProp:aa})({position:"relative",display:"flex"}),ky=la(By,{name:"MuiRadioButtonIcon"})({transform:"scale(1)"}),Ty=la(Iy,{name:"MuiRadioButtonIcon"})(Su(({theme:e})=>({left:0,position:"absolute",transform:"scale(0)",transition:e.transitions.create("transform",{easing:e.transitions.easing.easeIn,duration:e.transitions.duration.shortest}),variants:[{props:{checked:!0},style:{transform:"scale(1)",transition:e.transitions.create("transform",{easing:e.transitions.easing.easeOut,duration:e.transitions.duration.shortest})}}]})));function Py(e){const{checked:t=!1,classes:n={},fontSize:r}=e,o={...e,checked:t};return s.jsxs(Ry,{className:n.root,ownerState:o,children:[s.jsx(ky,{fontSize:r,className:n.background,ownerState:o}),s.jsx(Ty,{fontSize:r,className:n.dot,ownerState:o})]})}const Fy=pe.createContext(void 0);function My(e){return Eo("MuiRadio",e)}const Ly=Bo("MuiRadio",["root","checked","disabled","colorPrimary","colorSecondary","sizeSmall"]),Uy=la(kf,{shouldForwardProp:e=>aa(e)||"classes"===e,name:"MuiRadio",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:n}=e;return[t.root,"medium"!==n.size&&t[`size${vr(n.size)}`],t[`color${vr(n.color)}`]]}})(Su(({theme:e})=>({color:(e.vars||e).palette.text.secondary,[`&.${Ly.disabled}`]:{color:(e.vars||e).palette.action.disabled},variants:[{props:{color:"default",disabled:!1,disableRipple:!1},style:{"&:hover":{backgroundColor:e.alpha((e.vars||e).palette.action.active,(e.vars||e).palette.action.hoverOpacity)}}},...Object.entries(e.palette).filter(Dd()).map(([t])=>({props:{color:t,disabled:!1,disableRipple:!1},style:{"&:hover":{backgroundColor:e.alpha((e.vars||e).palette[t].main,(e.vars||e).palette.action.hoverOpacity)}}})),...Object.entries(e.palette).filter(Dd()).map(([t])=>({props:{color:t,disabled:!1},style:{[`&.${Ly.checked}`]:{color:(e.vars||e).palette[t].main}}})),{props:{disableRipple:!1},style:{"&:hover":{"@media (hover: none)":{backgroundColor:"transparent"}}}}]})));const Oy=s.jsx(Py,{checked:!0}),Dy=s.jsx(Py,{}),Ny=pe.forwardRef(function(e,t){const n=Eu({props:e,name:"MuiRadio"}),{checked:r,checkedIcon:o=Oy,color:i="primary",icon:a=Dy,name:l,onChange:c,size:u="medium",className:d,disabled:A,disableRipple:h=!1,slots:p={},slotProps:f={},inputProps:g,...m}=n,y=pp();let v=A;y&&void 0===v&&(v=y.disabled),v??=!1;const b={...n,disabled:v,disableRipple:h,color:i,size:u},w=(e=>{const{classes:t,color:n,size:r}=e,o={root:["root",`color${vr(n)}`,"medium"!==r&&`size${vr(r)}`]};return{...t,...Ti(o,My,t)}})(b),x=pe.useContext(Fy);let _=r;const C=Cu(c,x&&x.onChange);let S=l;var E,B;x&&(void 0===_&&(E=x.value,_="object"==typeof(B=n.value)&&null!==B?E===B:String(E)===String(B)),void 0===S&&(S=x.name));const I=f.input??g,[R,k]=_d("root",{ref:t,elementType:Uy,className:Co(w.root,d),shouldForwardComponentProp:!0,externalForwardedProps:{slots:p,slotProps:f,...m},getSlotProps:e=>({...e,onChange:(t,...n)=>{e.onChange?.(t,...n),C(t,...n)}}),ownerState:b,additionalProps:{type:"radio",icon:pe.cloneElement(a,{fontSize:a.props.fontSize??u}),checkedIcon:pe.cloneElement(o,{fontSize:o.props.fontSize??u}),disabled:v,name:S,checked:_,slots:p,slotProps:{input:"function"==typeof I?I(b):I}}});return s.jsx(R,{...k,classes:w})});function jy(e){return Eo("MuiRadioGroup",e)}Bo("MuiRadioGroup",["root","row","error"]);const Qy=pe.forwardRef(function(e,t){const{actions:n,children:r,className:o,defaultValue:i,name:a,onChange:l,value:c,...u}=e,d=pe.useRef(null),A=(e=>{const{classes:t,row:n,error:r}=e;return Ti({root:["root",n&&"row",r&&"error"]},jy,t)})(e),[h,p]=Lu({controlled:c,default:i,name:"RadioGroup"});pe.useImperativeHandle(n,()=>({focus:()=>{let e=d.current.querySelector("input:not(:disabled):checked");e||(e=d.current.querySelector("input:not(:disabled)")),e&&e.focus()}}),[]);const f=Ou(t,d),g=pi(a),m=pe.useMemo(()=>({name:g,onChange(e){p(e.target.value),l&&l(e,e.target.value)},value:h}),[g,l,p,h]);return s.jsx(Fy.Provider,{value:m,children:s.jsx($g,{role:"radiogroup",ref:f,className:Co(A.root,o),...u,children:r})})});function zy(e){return Eo("MuiSelect",e)}const Hy=Bo("MuiSelect",["root","select","multiple","filled","outlined","standard","disabled","focused","icon","iconOpen","iconFilled","iconOutlined","iconStandard","nativeInput","error"]);var Gy;const Vy=la(fy,{name:"MuiSelect",slot:"Select",overridesResolver:(e,t)=>{const{ownerState:n}=e;return[{[`&.${Hy.select}`]:t.select},{[`&.${Hy.select}`]:t[n.variant]},{[`&.${Hy.error}`]:t.error},{[`&.${Hy.multiple}`]:t.multiple}]}})({[`&.${Hy.select}`]:{height:"auto",minHeight:"1.4375em",textOverflow:"ellipsis",whiteSpace:"nowrap",overflow:"hidden"}}),Wy=la(my,{name:"MuiSelect",slot:"Icon",overridesResolver:(e,t)=>{const{ownerState:n}=e;return[t.icon,n.variant&&t[`icon${vr(n.variant)}`],n.open&&t.iconOpen]}})({}),$y=la("input",{shouldForwardProp:e=>sa(e)&&"classes"!==e,name:"MuiSelect",slot:"NativeInput"})({bottom:0,left:0,position:"absolute",opacity:0,pointerEvents:"none",width:"100%",boxSizing:"border-box"});function Ky(e,t){return"object"==typeof t&&null!==t?e===t:String(e)===String(t)}function Xy(e){return null==e||"string"==typeof e&&!e.trim()}const Yy=pe.forwardRef(function(e,t){const{"aria-describedby":n,"aria-label":r,autoFocus:o,autoWidth:i,children:a,className:l,defaultOpen:c,defaultValue:u,disabled:d,displayEmpty:A,error:h=!1,IconComponent:p,inputRef:f,labelId:g,MenuProps:m={},multiple:y,name:v,onBlur:b,onChange:w,onClose:x,onFocus:_,onOpen:C,open:S,readOnly:E,renderValue:B,required:I,SelectDisplayProps:R={},tabIndex:k,type:T,value:P,variant:F="standard",...M}=e,[L,U]=Lu({controlled:P,default:u,name:"Select"}),[O,D]=Lu({controlled:S,default:c,name:"Select"}),N=pe.useRef(null),j=pe.useRef(null),[Q,z]=pe.useState(null),{current:H}=pe.useRef(null!=S),[G,V]=pe.useState(),W=Ou(t,f),$=pe.useCallback(e=>{j.current=e,e&&z(e)},[]),K=Q?.parentNode;pe.useImperativeHandle(W,()=>({focus:()=>{j.current.focus()},node:N.current,value:L}),[L]),pe.useEffect(()=>{c&&O&&Q&&!H&&(V(i?null:K.clientWidth),j.current.focus())},[Q,i]),pe.useEffect(()=>{o&&j.current.focus()},[o]),pe.useEffect(()=>{if(!g)return;const e=Pu(j.current).getElementById(g);if(e){const t=()=>{getSelection().isCollapsed&&j.current.focus()};return e.addEventListener("click",t),()=>{e.removeEventListener("click",t)}}},[g]);const X=(e,t)=>{e?C&&C(t):x&&x(t),H||(V(i?null:K.clientWidth),D(e))},Y=pe.Children.toArray(a),q=e=>t=>{let n;if(t.currentTarget.hasAttribute("tabindex")){if(y){n=Array.isArray(L)?L.slice():[];const t=L.indexOf(e.props.value);-1===t?n.push(e.props.value):n.splice(t,1)}else n=e.props.value;if(e.props.onClick&&e.props.onClick(t),L!==n&&(U(n),w)){const r=t.nativeEvent||t,o=new r.constructor(r.type,r);Object.defineProperty(o,"target",{writable:!0,value:{value:n,name:v}}),w(o,e)}y||X(!1,t)}},J=null!==Q&&O;let Z,ee;delete M["aria-invalid"];const te=[];let ne=!1;(gp({value:L})||A)&&(B?Z=B(L):ne=!0);const re=Y.map(e=>{if(!pe.isValidElement(e))return null;let t;if(y){if(!Array.isArray(L))throw new Error($e(2));t=L.some(t=>Ky(t,e.props.value)),t&&ne&&te.push(e.props.children)}else t=Ky(L,e.props.value),t&&ne&&(ee=e.props.children);return pe.cloneElement(e,{"aria-selected":t?"true":"false",onClick:q(e),onKeyUp:t=>{" "===t.key&&t.preventDefault(),e.props.onKeyUp&&e.props.onKeyUp(t)},role:"option",selected:t,value:void 0,"data-value":e.props.value})});ne&&(Z=y?0===te.length?null:te.reduce((e,t,n)=>(e.push(t),n<te.length-1&&e.push(", "),e),[]):ee);let oe,ie=G;!i&&H&&Q&&(ie=K.clientWidth),oe=void 0!==k?k:d?null:0;const se=R.id||(v?`mui-component-select-${v}`:void 0),ae={...e,variant:F,value:L,open:J,error:h},le=(e=>{const{classes:t,variant:n,disabled:r,multiple:o,open:i,error:s}=e;return Ti({select:["select",n,r&&"disabled",o&&"multiple",s&&"error"],icon:["icon",`icon${vr(n)}`,i&&"iconOpen",r&&"disabled"],nativeInput:["nativeInput"]},zy,t)})(ae),ce={...m.PaperProps,..."function"==typeof m.slotProps?.paper?m.slotProps.paper(ae):m.slotProps?.paper},ue={...m.MenuListProps,..."function"==typeof m.slotProps?.list?m.slotProps.list(ae):m.slotProps?.list},de=pi();return s.jsxs(pe.Fragment,{children:[s.jsx(Vy,{as:"div",ref:$,tabIndex:oe,role:"combobox","aria-controls":J?de:void 0,"aria-disabled":d?"true":void 0,"aria-expanded":J?"true":"false","aria-haspopup":"listbox","aria-label":r,"aria-labelledby":[g,se].filter(Boolean).join(" ")||void 0,"aria-describedby":n,"aria-required":I?"true":void 0,"aria-invalid":h?"true":void 0,onKeyDown:e=>{if(!E){[" ","ArrowUp","ArrowDown","Enter"].includes(e.key)&&(e.preventDefault(),X(!0,e))}},onMouseDown:d||E?null:e=>{0===e.button&&(e.preventDefault(),j.current.focus(),X(!0,e))},onBlur:e=>{!J&&b&&(Object.defineProperty(e,"target",{writable:!0,value:{value:L,name:v}}),b(e))},onFocus:_,...R,ownerState:ae,className:Co(R.className,le.select,l),id:se,children:Xy(Z)?Gy||(Gy=s.jsx("span",{className:"notranslate","aria-hidden":!0,children:""})):Z}),s.jsx($y,{"aria-invalid":h,value:Array.isArray(L)?L.join(","):L,name:v,ref:N,"aria-hidden":!0,onChange:e=>{const t=Y.find(t=>t.props.value===e.target.value);void 0!==t&&(U(t.props.value),w&&w(e,t))},tabIndex:-1,disabled:d,className:le.nativeInput,autoFocus:o,required:I,...M,ownerState:ae}),s.jsx(Wy,{as:p,className:le.icon,ownerState:ae}),s.jsx(ly,{id:`menu-${v||""}`,anchorEl:K,open:J,onClose:e=>{X(!1,e)},anchorOrigin:{vertical:"bottom",horizontal:"center"},transformOrigin:{vertical:"top",horizontal:"center"},...m,slotProps:{...m.slotProps,list:{"aria-labelledby":g,role:"listbox","aria-multiselectable":y?"true":void 0,disableListWrap:!0,id:de,...ue},paper:{...ce,style:{minWidth:ie,...null!=ce?ce.style:null}}},children:re})]})}),qy={name:"MuiSelect",slot:"Root",shouldForwardProp:e=>aa(e)&&"variant"!==e},Jy=la(um,qy)(""),Zy=la(Ey,qy)(""),ev=la(Ug,qy)(""),tv=pe.forwardRef(function(e,t){const n=Eu({name:"MuiSelect",props:e}),{autoWidth:r=!1,children:o,classes:i={},className:a,defaultOpen:l=!1,displayEmpty:c=!1,IconComponent:u=Fp,id:d,input:A,inputProps:h,label:p,labelId:f,MenuProps:g,multiple:m=!1,native:y=!1,onClose:v,onOpen:b,open:w,renderValue:x,SelectDisplayProps:_,variant:C="outlined",...S}=n,E=y?vy:Yy,B=Ap({props:n,muiFormControl:pp(),states:["variant","error"]}),I=B.variant||C,R={...n,variant:I,classes:i},k=(e=>{const{classes:t}=e,n=Ti({root:["root"]},zy,t);return{...t,...n}})(R),{root:T,...P}=k,F=A||{standard:s.jsx(Jy,{ownerState:R}),outlined:s.jsx(Zy,{label:p,ownerState:R}),filled:s.jsx(ev,{ownerState:R})}[I],M=Ou(t,Gh(F));return s.jsx(pe.Fragment,{children:pe.cloneElement(F,{inputComponent:E,inputProps:{children:o,error:B.error,IconComponent:u,variant:I,type:void 0,multiple:m,...y?{id:d}:{autoWidth:r,defaultOpen:l,displayEmpty:c,labelId:f,MenuProps:g,onClose:v,onOpen:b,open:w,renderValue:x,SelectDisplayProps:{id:d,..._}},...h,classes:h?ar(P,h.classes):P,...A?A.props.inputProps:{}},...(m&&y||c)&&"outlined"===I?{notched:!0}:{},ref:M,className:Co(F.props.className,a,k.root),...!A&&{variant:I},...S})})});function nv(e){return Eo("MuiSkeleton",e)}tv.muiName="Select",Bo("MuiSkeleton",["root","text","rectangular","rounded","circular","pulse","wave","withChildren","fitContent","heightAuto"]);const rv=Un`
  0% {
    opacity: 1;
  }

  50% {
    opacity: 0.4;
  }

  100% {
    opacity: 1;
  }
`,ov=Un`
  0% {
    transform: translateX(-100%);
  }

  50% {
    /* +0.5s of delay between each loop */
    transform: translateX(100%);
  }

  100% {
    transform: translateX(100%);
  }
`,iv="string"!=typeof rv?Ln`
        animation: ${rv} 2s ease-in-out 0.5s infinite;
      `:null,sv="string"!=typeof ov?Ln`
        &::after {
          animation: ${ov} 2s linear 0.5s infinite;
        }
      `:null,av=la("span",{name:"MuiSkeleton",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:n}=e;return[t.root,t[n.variant],!1!==n.animation&&t[n.animation],n.hasChildren&&t.withChildren,n.hasChildren&&!n.width&&t.fitContent,n.hasChildren&&!n.height&&t.heightAuto]}})(Su(({theme:e})=>{const t=(n=e.shape.borderRadius,String(n).match(/[\d.\-+]*\s*(.*)/)[1]||""||"px");var n;const r=(o=e.shape.borderRadius,parseFloat(o));var o;return{display:"block",backgroundColor:e.vars?e.vars.palette.Skeleton.bg:e.alpha(e.palette.text.primary,"light"===e.palette.mode?.11:.13),height:"1.2em",variants:[{props:{variant:"text"},style:{marginTop:0,marginBottom:0,height:"auto",transformOrigin:"0 55%",transform:"scale(1, 0.60)",borderRadius:`${r}${t}/${Math.round(r/.6*10)/10}${t}`,"&:empty:before":{content:'"\\00a0"'}}},{props:{variant:"circular"},style:{borderRadius:"50%"}},{props:{variant:"rounded"},style:{borderRadius:(e.vars||e).shape.borderRadius}},{props:({ownerState:e})=>e.hasChildren,style:{"& > *":{visibility:"hidden"}}},{props:({ownerState:e})=>e.hasChildren&&!e.width,style:{maxWidth:"fit-content"}},{props:({ownerState:e})=>e.hasChildren&&!e.height,style:{height:"auto"}},{props:{animation:"pulse"},style:iv||{animation:`${rv} 2s ease-in-out 0.5s infinite`}},{props:{animation:"wave"},style:{position:"relative",overflow:"hidden",WebkitMaskImage:"-webkit-radial-gradient(white, black)","&::after":{background:`linear-gradient(\n                90deg,\n                transparent,\n                ${(e.vars||e).palette.action.hover},\n                transparent\n              )`,content:'""',position:"absolute",transform:"translateX(-100%)",bottom:0,left:0,right:0,top:0}}},{props:{animation:"wave"},style:sv||{"&::after":{animation:`${ov} 2s linear 0.5s infinite`}}}]}})),lv=pe.forwardRef(function(e,t){const n=Eu({props:e,name:"MuiSkeleton"}),{animation:r="pulse",className:o,component:i="span",height:a,style:l,variant:c="text",width:u,...d}=n,A={...n,animation:r,component:i,variant:c,hasChildren:Boolean(d.children)},h=(e=>{const{classes:t,variant:n,animation:r,hasChildren:o,width:i,height:s}=e;return Ti({root:["root",n,r,o&&"withChildren",o&&!i&&"fitContent",o&&!s&&"heightAuto"]},nv,t)})(A);return s.jsx(av,{as:i,ref:t,className:Co(h.root,o),ownerState:A,...d,style:{width:u,height:a,...l}})});function cv(e){return Eo("MuiSnackbarContent",e)}Bo("MuiSnackbarContent",["root","message","action"]);const uv=la(gd,{name:"MuiSnackbarContent",slot:"Root"})(Su(({theme:e})=>{const t="light"===e.palette.mode?.8:.98;return{...e.typography.body2,color:e.vars?e.vars.palette.SnackbarContent.color:e.palette.getContrastText(ei(e.palette.background.default,t)),backgroundColor:e.vars?e.vars.palette.SnackbarContent.bg:ei(e.palette.background.default,t),display:"flex",alignItems:"center",flexWrap:"wrap",padding:"6px 16px",flexGrow:1,[e.breakpoints.up("sm")]:{flexGrow:"initial",minWidth:288}}})),dv=la("div",{name:"MuiSnackbarContent",slot:"Message"})({padding:"8px 0"}),Av=la("div",{name:"MuiSnackbarContent",slot:"Action"})({display:"flex",alignItems:"center",marginLeft:"auto",paddingLeft:16,marginRight:-8}),hv=pe.forwardRef(function(e,t){const n=Eu({props:e,name:"MuiSnackbarContent"}),{action:r,className:o,message:i,role:a="alert",...l}=n,c=n,u=(e=>{const{classes:t}=e;return Ti({root:["root"],action:["action"],message:["message"]},cv,t)})(c);return s.jsxs(uv,{role:a,elevation:6,className:Co(u.root,o),ownerState:c,ref:t,...l,children:[s.jsx(dv,{className:u.message,ownerState:c,children:i}),r?s.jsx(Av,{className:u.action,ownerState:c,children:r}):null]})});function pv(e){return Eo("MuiSnackbar",e)}Bo("MuiSnackbar",["root","anchorOriginTopCenter","anchorOriginBottomCenter","anchorOriginTopRight","anchorOriginBottomRight","anchorOriginTopLeft","anchorOriginBottomLeft"]);const fv=la("div",{name:"MuiSnackbar",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:n}=e;return[t.root,t[`anchorOrigin${vr(n.anchorOrigin.vertical)}${vr(n.anchorOrigin.horizontal)}`]]}})(Su(({theme:e})=>({zIndex:(e.vars||e).zIndex.snackbar,position:"fixed",display:"flex",left:8,right:8,justifyContent:"center",alignItems:"center",variants:[{props:({ownerState:e})=>"top"===e.anchorOrigin.vertical,style:{top:8,[e.breakpoints.up("sm")]:{top:24}}},{props:({ownerState:e})=>"top"!==e.anchorOrigin.vertical,style:{bottom:8,[e.breakpoints.up("sm")]:{bottom:24}}},{props:({ownerState:e})=>"left"===e.anchorOrigin.horizontal,style:{justifyContent:"flex-start",[e.breakpoints.up("sm")]:{left:24,right:"auto"}}},{props:({ownerState:e})=>"right"===e.anchorOrigin.horizontal,style:{justifyContent:"flex-end",[e.breakpoints.up("sm")]:{right:24,left:"auto"}}},{props:({ownerState:e})=>"center"===e.anchorOrigin.horizontal,style:{[e.breakpoints.up("sm")]:{left:"50%",right:"auto",transform:"translateX(-50%)"}}}]}))),gv=pe.forwardRef(function(e,t){const n=Eu({props:e,name:"MuiSnackbar"}),r=ia(),o={enter:r.transitions.duration.enteringScreen,exit:r.transitions.duration.leavingScreen},{action:i,anchorOrigin:{vertical:a,horizontal:l}={vertical:"bottom",horizontal:"left"},autoHideDuration:c=null,children:u,className:d,ClickAwayListenerProps:A,ContentProps:h,disableWindowBlurListener:p=!1,message:f,onBlur:g,onClose:m,onFocus:y,onMouseEnter:v,onMouseLeave:b,open:w,resumeHideDuration:x,slots:_={},slotProps:C={},TransitionComponent:S,transitionDuration:E=o,TransitionProps:{onEnter:B,onExited:I,...R}={},...k}=n,T={...n,anchorOrigin:{vertical:a,horizontal:l},autoHideDuration:c,disableWindowBlurListener:p,TransitionComponent:S,transitionDuration:E},P=(e=>{const{classes:t,anchorOrigin:n}=e;return Ti({root:["root",`anchorOrigin${vr(n.vertical)}${vr(n.horizontal)}`]},pv,t)})(T),{getRootProps:F,onClickAway:M}=function(e={}){const{autoHideDuration:t=null,disableWindowBlurListener:n=!1,onClose:r,open:o,resumeHideDuration:i}=e,s=sd();pe.useEffect(()=>{if(o)return document.addEventListener("keydown",e),()=>{document.removeEventListener("keydown",e)};function e(e){e.defaultPrevented||"Escape"===e.key&&r?.(e,"escapeKeyDown")}},[o,r]);const a=Uu((e,t)=>{r?.(e,t)}),l=Uu(e=>{r&&null!=e&&s.start(e,()=>{a(null,"timeout")})});pe.useEffect(()=>(o&&l(t),s.clear),[o,t,l,s]);const c=s.clear,u=pe.useCallback(()=>{null!=t&&l(null!=i?i:.5*t)},[t,i,l]),d=e=>t=>{const n=e.onFocus;n?.(t),c()},A=e=>t=>{const n=e.onMouseEnter;n?.(t),c()},h=e=>t=>{const n=e.onMouseLeave;n?.(t),u()};return pe.useEffect(()=>{if(!n&&o)return window.addEventListener("focus",u),window.addEventListener("blur",c),()=>{window.removeEventListener("focus",u),window.removeEventListener("blur",c)}},[n,o,u,c]),{getRootProps:(t={})=>{const n={...bd(e),...bd(t)};return{role:"presentation",...t,...n,onBlur:(r=n,e=>{const t=r.onBlur;t?.(e),u()}),onFocus:d(n),onMouseEnter:A(n),onMouseLeave:h(n)};var r},onClickAway:e=>{r?.(e,"clickaway")}}}({...T}),[L,U]=pe.useState(!0),O={slots:{transition:S,..._},slotProps:{content:h,clickAwayListener:A,transition:R,...C}},[D,N]=_d("root",{ref:t,className:[P.root,d],elementType:fv,getSlotProps:F,externalForwardedProps:{...O,...k},ownerState:T}),[j,{ownerState:Q,...z}]=_d("clickAwayListener",{elementType:zf,externalForwardedProps:O,getSlotProps:e=>({onClickAway:(...t)=>{const n=t[0];e.onClickAway?.(...t),n?.defaultMuiPrevented||M(...t)}}),ownerState:T}),[H,G]=_d("content",{elementType:hv,shouldForwardComponentProp:!0,externalForwardedProps:O,additionalProps:{message:f,action:i},ownerState:T}),[V,W]=_d("transition",{elementType:am,externalForwardedProps:O,getSlotProps:e=>({onEnter:(...t)=>{e.onEnter?.(...t),((e,t)=>{U(!1),B&&B(e,t)})(...t)},onExited:(...t)=>{e.onExited?.(...t),(e=>{U(!0),I&&I(e)})(...t)}}),additionalProps:{appear:!0,in:w,timeout:E,direction:"top"===a?"down":"up"},ownerState:T});return!w&&L?null:s.jsx(j,{...z,..._.clickAwayListener&&{ownerState:Q},children:s.jsx(D,{...N,children:s.jsx(V,{...W,children:u||s.jsx(H,{...G})})})})});function mv(e){return Eo("MuiTooltip",e)}const yv=Bo("MuiTooltip",["popper","popperInteractive","popperArrow","popperClose","tooltip","tooltipArrow","touch","tooltipPlacementLeft","tooltipPlacementRight","tooltipPlacementTop","tooltipPlacementBottom","arrow"]);const vv=la(qh,{name:"MuiTooltip",slot:"Popper",overridesResolver:(e,t)=>{const{ownerState:n}=e;return[t.popper,!n.disableInteractive&&t.popperInteractive,n.arrow&&t.popperArrow,!n.open&&t.popperClose]}})(Su(({theme:e})=>({zIndex:(e.vars||e).zIndex.tooltip,pointerEvents:"none",variants:[{props:({ownerState:e})=>!e.disableInteractive,style:{pointerEvents:"auto"}},{props:({open:e})=>!e,style:{pointerEvents:"none"}},{props:({ownerState:e})=>e.arrow,style:{[`&[data-popper-placement*="bottom"] .${yv.arrow}`]:{top:0,marginTop:"-0.71em","&::before":{transformOrigin:"0 100%"}},[`&[data-popper-placement*="top"] .${yv.arrow}`]:{bottom:0,marginBottom:"-0.71em","&::before":{transformOrigin:"100% 0"}},[`&[data-popper-placement*="right"] .${yv.arrow}`]:{height:"1em",width:"0.71em","&::before":{transformOrigin:"100% 100%"}},[`&[data-popper-placement*="left"] .${yv.arrow}`]:{height:"1em",width:"0.71em","&::before":{transformOrigin:"0 0"}}}},{props:({ownerState:e})=>e.arrow&&!e.isRtl,style:{[`&[data-popper-placement*="right"] .${yv.arrow}`]:{left:0,marginLeft:"-0.71em"}}},{props:({ownerState:e})=>e.arrow&&!!e.isRtl,style:{[`&[data-popper-placement*="right"] .${yv.arrow}`]:{right:0,marginRight:"-0.71em"}}},{props:({ownerState:e})=>e.arrow&&!e.isRtl,style:{[`&[data-popper-placement*="left"] .${yv.arrow}`]:{right:0,marginRight:"-0.71em"}}},{props:({ownerState:e})=>e.arrow&&!!e.isRtl,style:{[`&[data-popper-placement*="left"] .${yv.arrow}`]:{left:0,marginLeft:"-0.71em"}}}]}))),bv=la("div",{name:"MuiTooltip",slot:"Tooltip",overridesResolver:(e,t)=>{const{ownerState:n}=e;return[t.tooltip,n.touch&&t.touch,n.arrow&&t.tooltipArrow,t[`tooltipPlacement${vr(n.placement.split("-")[0])}`]]}})(Su(({theme:e})=>{return{backgroundColor:e.vars?e.vars.palette.Tooltip.bg:e.alpha(e.palette.grey[700],.92),borderRadius:(e.vars||e).shape.borderRadius,color:(e.vars||e).palette.common.white,fontFamily:e.typography.fontFamily,padding:"4px 8px",fontSize:e.typography.pxToRem(11),maxWidth:300,margin:2,wordWrap:"break-word",fontWeight:e.typography.fontWeightMedium,[`.${yv.popper}[data-popper-placement*="left"] &`]:{transformOrigin:"right center"},[`.${yv.popper}[data-popper-placement*="right"] &`]:{transformOrigin:"left center"},[`.${yv.popper}[data-popper-placement*="top"] &`]:{transformOrigin:"center bottom",marginBottom:"14px"},[`.${yv.popper}[data-popper-placement*="bottom"] &`]:{transformOrigin:"center top",marginTop:"14px"},variants:[{props:({ownerState:e})=>e.arrow,style:{position:"relative",margin:0}},{props:({ownerState:e})=>e.touch,style:{padding:"8px 16px",fontSize:e.typography.pxToRem(14),lineHeight:(t=16/14,Math.round(1e5*t)/1e5)+"em",fontWeight:e.typography.fontWeightRegular}},{props:({ownerState:e})=>!e.isRtl,style:{[`.${yv.popper}[data-popper-placement*="left"] &`]:{marginRight:"14px"},[`.${yv.popper}[data-popper-placement*="right"] &`]:{marginLeft:"14px"}}},{props:({ownerState:e})=>!e.isRtl&&e.touch,style:{[`.${yv.popper}[data-popper-placement*="left"] &`]:{marginRight:"24px"},[`.${yv.popper}[data-popper-placement*="right"] &`]:{marginLeft:"24px"}}},{props:({ownerState:e})=>!!e.isRtl,style:{[`.${yv.popper}[data-popper-placement*="left"] &`]:{marginLeft:"14px"},[`.${yv.popper}[data-popper-placement*="right"] &`]:{marginRight:"14px"}}},{props:({ownerState:e})=>!!e.isRtl&&e.touch,style:{[`.${yv.popper}[data-popper-placement*="left"] &`]:{marginLeft:"24px"},[`.${yv.popper}[data-popper-placement*="right"] &`]:{marginRight:"24px"}}},{props:({ownerState:e})=>e.touch,style:{[`.${yv.popper}[data-popper-placement*="top"] &`]:{marginBottom:"24px"}}},{props:({ownerState:e})=>e.touch,style:{[`.${yv.popper}[data-popper-placement*="bottom"] &`]:{marginTop:"24px"}}}]};var t})),wv=la("span",{name:"MuiTooltip",slot:"Arrow"})(Su(({theme:e})=>({overflow:"hidden",position:"absolute",width:"1em",height:"0.71em",boxSizing:"border-box",color:e.vars?e.vars.palette.Tooltip.bg:e.alpha(e.palette.grey[700],.9),"&::before":{content:'""',margin:"auto",display:"block",width:"100%",height:"100%",backgroundColor:"currentColor",transform:"rotate(45deg)"}})));let xv=!1;const _v=new id;let Cv={x:0,y:0};function Sv(e,t){return(n,...r)=>{t&&t(n,...r),e(n,...r)}}const Ev=pe.forwardRef(function(e,t){const n=Eu({props:e,name:"MuiTooltip"}),{arrow:r=!1,children:o,classes:i,components:a={},componentsProps:l={},describeChild:c=!1,disableFocusListener:u=!1,disableHoverListener:d=!1,disableInteractive:A=!1,disableTouchListener:h=!1,enterDelay:p=100,enterNextDelay:f=0,enterTouchDelay:g=700,followCursor:m=!1,id:y,leaveDelay:v=0,leaveTouchDelay:b=1500,onClose:w,onOpen:x,open:_,placement:C="bottom",PopperComponent:S,PopperProps:E={},slotProps:B={},slots:I={},title:R,TransitionComponent:k,TransitionProps:T,...P}=n,F=pe.isValidElement(o)?o:s.jsx("span",{children:o}),M=ia(),L=li(),[U,O]=pe.useState(),[D,N]=pe.useState(null),j=pe.useRef(!1),Q=A||m,z=sd(),H=sd(),G=sd(),V=sd(),[W,$]=Lu({controlled:_,default:!1,name:"Tooltip",state:"open"});let K=W;const X=pi(y),Y=pe.useRef(),q=Uu(()=>{void 0!==Y.current&&(document.body.style.WebkitUserSelect=Y.current,Y.current=void 0),V.clear()});pe.useEffect(()=>q,[q]);const J=e=>{_v.clear(),xv=!0,$(!0),x&&!K&&x(e)},Z=Uu(e=>{_v.start(800+v,()=>{xv=!1}),$(!1),w&&K&&w(e),z.start(M.transitions.duration.shortest,()=>{j.current=!1})}),ee=e=>{j.current&&"touchstart"!==e.type||(U&&U.removeAttribute("title"),H.clear(),G.clear(),p||xv&&f?H.start(xv?f:p,()=>{J(e)}):J(e))},te=e=>{H.clear(),G.start(v,()=>{Z(e)})},[,ne]=pe.useState(!1),re=e=>{Cd(e.target)||(ne(!1),te(e))},oe=e=>{U||O(e.currentTarget),Cd(e.target)&&(ne(!0),ee(e))},ie=e=>{j.current=!0;const t=F.props;t.onTouchStart&&t.onTouchStart(e)},se=e=>{ie(e),G.clear(),z.clear(),q(),Y.current=document.body.style.WebkitUserSelect,document.body.style.WebkitUserSelect="none",V.start(g,()=>{document.body.style.WebkitUserSelect=Y.current,ee(e)})},ae=e=>{F.props.onTouchEnd&&F.props.onTouchEnd(e),q(),G.start(b,()=>{Z(e)})};pe.useEffect(()=>{if(K)return document.addEventListener("keydown",e),()=>{document.removeEventListener("keydown",e)};function e(e){"Escape"===e.key&&Z(e)}},[Z,K]);const le=Ou(Gh(F),O,t);R||0===R||(K=!1);const ce=pe.useRef(),ue={},de="string"==typeof R;c?(ue.title=K||!de||d?null:R,ue["aria-describedby"]=K?X:null):(ue["aria-label"]=de?R:null,ue["aria-labelledby"]=K&&!de?X:null);const Ae={...ue,...P,...F.props,className:Co(P.className,F.props.className),onTouchStart:ie,ref:le,...m?{onMouseMove:e=>{const t=F.props;t.onMouseMove&&t.onMouseMove(e),Cv={x:e.clientX,y:e.clientY},ce.current&&ce.current.update()}}:{}},he={};h||(Ae.onTouchStart=se,Ae.onTouchEnd=ae),d||(Ae.onMouseOver=Sv(ee,Ae.onMouseOver),Ae.onMouseLeave=Sv(te,Ae.onMouseLeave),Q||(he.onMouseOver=ee,he.onMouseLeave=te)),u||(Ae.onFocus=Sv(oe,Ae.onFocus),Ae.onBlur=Sv(re,Ae.onBlur),Q||(he.onFocus=oe,he.onBlur=re));const fe={...n,isRtl:L,arrow:r,disableInteractive:Q,placement:C,PopperComponentProp:S,touch:j.current},ge="function"==typeof B.popper?B.popper(fe):B.popper,me=pe.useMemo(()=>{let e=[{name:"arrow",enabled:Boolean(D),options:{element:D,padding:4}}];return E.popperOptions?.modifiers&&(e=e.concat(E.popperOptions.modifiers)),ge?.popperOptions?.modifiers&&(e=e.concat(ge.popperOptions.modifiers)),{...E.popperOptions,...ge?.popperOptions,modifiers:e}},[D,E.popperOptions,ge?.popperOptions]),ye=(e=>{const{classes:t,disableInteractive:n,arrow:r,touch:o,placement:i}=e;return Ti({popper:["popper",!n&&"popperInteractive",r&&"popperArrow"],tooltip:["tooltip",r&&"tooltipArrow",o&&"touch",`tooltipPlacement${vr(i.split("-")[0])}`],arrow:["arrow"]},mv,t)})(fe),ve="function"==typeof B.transition?B.transition(fe):B.transition,be={slots:{popper:a.Popper,transition:a.Transition??k,tooltip:a.Tooltip,arrow:a.Arrow,...I},slotProps:{arrow:B.arrow??l.arrow,popper:{...E,...ge??l.popper},tooltip:B.tooltip??l.tooltip,transition:{...T,...ve??l.transition}}},[we,xe]=_d("popper",{elementType:vv,externalForwardedProps:be,ownerState:fe,className:Co(ye.popper,E?.className)}),[_e,Ce]=_d("transition",{elementType:am,externalForwardedProps:be,ownerState:fe}),[Se,Ee]=_d("tooltip",{elementType:bv,className:ye.tooltip,externalForwardedProps:be,ownerState:fe}),[Be,Ie]=_d("arrow",{elementType:wv,className:ye.arrow,externalForwardedProps:be,ownerState:fe,ref:N});return s.jsxs(pe.Fragment,{children:[pe.cloneElement(F,Ae),s.jsx(we,{as:S??qh,placement:C,anchorEl:m?{getBoundingClientRect:()=>({top:Cv.y,left:Cv.x,right:Cv.x,bottom:Cv.y,width:0,height:0})}:U,popperRef:ce,open:!!U&&K,id:X,transition:!0,...he,...xe,popperOptions:me,children:({TransitionProps:e})=>s.jsx(_e,{timeout:M.transitions.duration.shorter,...e,...Ce,children:s.jsxs(Se,{...Ee,children:[R,r?s.jsx(Be,{...Ie}):null]})})})]})}),Bv=function(e={}){const{createStyledComponent:t=Mi,useThemeProps:n=Li,componentName:r="MuiStack"}=e,o=t(Oi);return pe.forwardRef(function(e,t){const i=bo(n(e)),{component:a="div",direction:l="column",spacing:c=0,divider:u,children:d,className:A,useFlexGap:h=!1,...p}=i,f={direction:l,spacing:c,useFlexGap:h},g=Ti({root:["root"]},e=>Eo(r,e),{});return s.jsx(o,{as:a,ownerState:f,ref:t,className:Co(g.root,A),...p,children:u?Ui(d,u):d})})}({createStyledComponent:la("div",{name:"MuiStack",slot:"Root"}),useThemeProps:e=>Eu({props:e,name:"MuiStack"})});function Iv(e){return Eo("MuiSwitch",e)}const Rv=Bo("MuiSwitch",["root","edgeStart","edgeEnd","switchBase","colorPrimary","colorSecondary","sizeSmall","sizeMedium","checked","disabled","input","thumb","track"]),kv=la("span",{name:"MuiSwitch",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:n}=e;return[t.root,n.edge&&t[`edge${vr(n.edge)}`],t[`size${vr(n.size)}`]]}})({display:"inline-flex",width:58,height:38,overflow:"hidden",padding:12,boxSizing:"border-box",position:"relative",flexShrink:0,zIndex:0,verticalAlign:"middle","@media print":{colorAdjust:"exact"},variants:[{props:{edge:"start"},style:{marginLeft:-8}},{props:{edge:"end"},style:{marginRight:-8}},{props:{size:"small"},style:{width:40,height:24,padding:7,[`& .${Rv.thumb}`]:{width:16,height:16},[`& .${Rv.switchBase}`]:{padding:4,[`&.${Rv.checked}`]:{transform:"translateX(16px)"}}}}]}),Tv=la(kf,{name:"MuiSwitch",slot:"SwitchBase",overridesResolver:(e,t)=>{const{ownerState:n}=e;return[t.switchBase,{[`& .${Rv.input}`]:t.input},"default"!==n.color&&t[`color${vr(n.color)}`]]}})(Su(({theme:e})=>({position:"absolute",top:0,left:0,zIndex:1,color:e.vars?e.vars.palette.Switch.defaultColor:`${"light"===e.palette.mode?e.palette.common.white:e.palette.grey[300]}`,transition:e.transitions.create(["left","transform"],{duration:e.transitions.duration.shortest}),[`&.${Rv.checked}`]:{transform:"translateX(20px)"},[`&.${Rv.disabled}`]:{color:e.vars?e.vars.palette.Switch.defaultDisabledColor:`${"light"===e.palette.mode?e.palette.grey[100]:e.palette.grey[600]}`},[`&.${Rv.checked} + .${Rv.track}`]:{opacity:.5},[`&.${Rv.disabled} + .${Rv.track}`]:{opacity:e.vars?e.vars.opacity.switchTrackDisabled:""+("light"===e.palette.mode?.12:.2)},[`& .${Rv.input}`]:{left:"-100%",width:"300%"}})),Su(({theme:e})=>({"&:hover":{backgroundColor:e.alpha((e.vars||e).palette.action.active,(e.vars||e).palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:"transparent"}},variants:[...Object.entries(e.palette).filter(Dd(["light"])).map(([t])=>({props:{color:t},style:{[`&.${Rv.checked}`]:{color:(e.vars||e).palette[t].main,"&:hover":{backgroundColor:e.alpha((e.vars||e).palette[t].main,(e.vars||e).palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:"transparent"}},[`&.${Rv.disabled}`]:{color:e.vars?e.vars.palette.Switch[`${t}DisabledColor`]:`${"light"===e.palette.mode?e.lighten(e.palette[t].main,.62):e.darken(e.palette[t].main,.55)}`}},[`&.${Rv.checked} + .${Rv.track}`]:{backgroundColor:(e.vars||e).palette[t].main}}}))]}))),Pv=la("span",{name:"MuiSwitch",slot:"Track"})(Su(({theme:e})=>({height:"100%",width:"100%",borderRadius:7,zIndex:-1,transition:e.transitions.create(["opacity","background-color"],{duration:e.transitions.duration.shortest}),backgroundColor:e.vars?e.vars.palette.common.onBackground:`${"light"===e.palette.mode?e.palette.common.black:e.palette.common.white}`,opacity:e.vars?e.vars.opacity.switchTrack:""+("light"===e.palette.mode?.38:.3)}))),Fv=la("span",{name:"MuiSwitch",slot:"Thumb"})(Su(({theme:e})=>({boxShadow:(e.vars||e).shadows[1],backgroundColor:"currentColor",width:20,height:20,borderRadius:"50%"}))),Mv=pe.forwardRef(function(e,t){const n=Eu({props:e,name:"MuiSwitch"}),{className:r,color:o="primary",edge:i=!1,size:a="medium",sx:l,slots:c={},slotProps:u={},...d}=n,A={...n,color:o,edge:i,size:a},h=(e=>{const{classes:t,edge:n,size:r,color:o,checked:i,disabled:s}=e,a=Ti({root:["root",n&&`edge${vr(n)}`,`size${vr(r)}`],switchBase:["switchBase",`color${vr(o)}`,i&&"checked",s&&"disabled"],thumb:["thumb"],track:["track"],input:["input"]},Iv,t);return{...t,...a}})(A),p={slots:c,slotProps:u},[f,g]=_d("root",{className:Co(h.root,r),elementType:kv,externalForwardedProps:p,ownerState:A,additionalProps:{sx:l}}),[m,y]=_d("thumb",{className:h.thumb,elementType:Fv,externalForwardedProps:p,ownerState:A}),v=s.jsx(m,{...y}),[b,w]=_d("track",{className:h.track,elementType:Pv,externalForwardedProps:p,ownerState:A});return s.jsxs(f,{...g,children:[s.jsx(Tv,{type:"checkbox",icon:v,checkedIcon:v,ref:t,ownerState:A,...d,classes:{...h,root:h.switchBase},slots:{...c.switchBase&&{root:c.switchBase},...c.input&&{input:c.input}},slotProps:{...u.switchBase&&{root:"function"==typeof u.switchBase?u.switchBase(A):u.switchBase},input:{role:"switch"},...u.input&&{input:"function"==typeof u.input?u.input(A):u.input}}}),s.jsx(b,{...w})]})});function Lv(e){return Eo("MuiTextField",e)}Bo("MuiTextField",["root"]);const Uv={standard:um,filled:Ug,outlined:Ey},Ov=la(Ng,{name:"MuiTextField",slot:"Root"})({}),Dv=pe.forwardRef(function(e,t){const n=Eu({props:e,name:"MuiTextField"}),{autoComplete:r,autoFocus:o=!1,children:i,className:a,color:l="primary",defaultValue:c,disabled:u=!1,error:d=!1,FormHelperTextProps:A,fullWidth:h=!1,helperText:p,id:f,InputLabelProps:g,inputProps:m,InputProps:y,inputRef:v,label:b,maxRows:w,minRows:x,multiline:_=!1,name:C,onBlur:S,onChange:E,onFocus:B,placeholder:I,required:R=!1,rows:k,select:T=!1,SelectProps:P,slots:F={},slotProps:M={},type:L,value:U,variant:O="outlined",...D}=n,N={...n,autoFocus:o,color:l,disabled:u,error:d,fullWidth:h,multiline:_,required:R,select:T,variant:O},j=(e=>{const{classes:t}=e;return Ti({root:["root"]},Lv,t)})(N),Q=pi(f),z=p&&Q?`${Q}-helper-text`:void 0,H=b&&Q?`${Q}-label`:void 0,G=Uv[O],V={slots:F,slotProps:{input:y,inputLabel:g,htmlInput:m,formHelperText:A,select:P,...M}},W={},$=V.slotProps.inputLabel;"outlined"===O&&($&&void 0!==$.shrink&&(W.notched=$.shrink),W.label=b),T&&(P&&P.native||(W.id=void 0),W["aria-describedby"]=void 0);const[K,X]=_d("root",{elementType:Ov,shouldForwardComponentProp:!0,externalForwardedProps:{...V,...D},ownerState:N,className:Co(j.root,a),ref:t,additionalProps:{disabled:u,error:d,fullWidth:h,required:R,color:l,variant:O}}),[Y,q]=_d("input",{elementType:G,externalForwardedProps:V,additionalProps:W,ownerState:N}),[J,Z]=_d("inputLabel",{elementType:hm,externalForwardedProps:V,ownerState:N}),[ee,te]=_d("htmlInput",{elementType:"input",externalForwardedProps:V,ownerState:N}),[ne,re]=_d("formHelperText",{elementType:Jg,externalForwardedProps:V,ownerState:N}),[oe,ie]=_d("select",{elementType:tv,externalForwardedProps:V,ownerState:N}),se=s.jsx(Y,{"aria-describedby":z,autoComplete:r,autoFocus:o,defaultValue:c,fullWidth:h,multiline:_,name:C,rows:k,maxRows:w,minRows:x,type:L,value:U,id:Q,inputRef:v,onBlur:S,onChange:E,onFocus:B,placeholder:I,inputProps:te,slots:{input:F.htmlInput?ee:void 0},...q});return s.jsxs(K,{...X,children:[null!=b&&""!==b&&s.jsx(J,{htmlFor:Q,id:H,...Z,children:b}),T?s.jsx(oe,{"aria-describedby":z,id:Q,labelId:H,value:U,input:se,...ie,children:i}):se,p&&s.jsx(ne,{id:z,...re,children:p})]})}),Nv=fe.forwardRef(({sx:e,children:t,...n},r)=>s.jsx(ff,{ref:r,...n,sx:{paddingLeft:"12px",paddingRight:"12px",textTransform:"none",fontSize:"14px",fontWeight:500,borderRadius:"999px",fontFamily:'"Google Sans", Roboto, Arial, sans-serif',...e||{}},children:t}));Nv.displayName="Button";const jv=({open:e,onClose:t,title:n,children:r,actions:o,maxWidth:i="sm",fullWidth:a=!0,sx:l,PaperProps:c,contentSx:u,actionsSx:d,titleSx:A})=>s.jsxs(hg,{open:e,onClose:t,maxWidth:i,fullWidth:a,sx:l,PaperProps:{...c,sx:{borderRadius:"8px",boxShadow:"0px 11px 15px -7px rgba(0, 0, 0, 0.2), 0px 24px 38px 3px rgba(0, 0, 0, 0.14), 0px 9px 46px 8px rgba(0, 0, 0, 0.12)",margin:"32px",maxHeight:"calc(100% - 64px)",...c?.sx}},children:[n&&s.jsx(Eg,{sx:{padding:"24px 24px 0 24px",margin:0,borderBottom:"none",...A},children:s.jsx(vA,{variant:"h6",component:"div",sx:{fontSize:"22px",fontFamily:'"Google Sans", sans-serif',fontWeight:400,color:"#202124",lineHeight:"28px",letterSpacing:"0"},children:n})}),s.jsx(wg,{sx:{padding:"24px 24px 8px 24px",margin:0,...u},children:r}),o&&s.jsx(gg,{sx:{padding:"8px 24px 24px 24px",margin:0,borderTop:"none",gap:"8px",justifyContent:"flex-end",minHeight:"auto",...d},children:o})]}),Qv=({open:e,onClose:t,onStay:n,onLeave:r})=>s.jsx(jv,{open:e,onClose:t,title:"Unsaved Changes",maxWidth:"sm",actions:s.jsxs(s.Fragment,{children:[s.jsx(Nv,{onClick:n,variant:"text",sx:{color:"#5f6368",textTransform:"none",fontSize:"14px",fontFamily:'"Google Sans", sans-serif',fontWeight:500,padding:"8px 16px","&:hover":{backgroundColor:"rgba(95, 99, 104, 0.08)"}},children:"Stay"}),s.jsx(Nv,{onClick:r,variant:"contained",sx:{backgroundColor:"#ea4335",color:"#ffffff",textTransform:"none",fontSize:"14px",fontFamily:'"Google Sans", sans-serif',fontWeight:500,padding:"8px 16px",boxShadow:"none","&:hover":{backgroundColor:"#d33b2c",boxShadow:"0 1px 3px rgba(234, 67, 53, 0.4)"},transition:"all 0.2s cubic-bezier(0.4, 0, 0.2, 1)"},children:"Leave"})]}),children:s.jsxs(rf,{sx:{pt:1},children:[s.jsx(vA,{variant:"body1",sx:{fontSize:"15px",color:"#202124",fontFamily:'"Google Sans", sans-serif',lineHeight:1.5,mb:3},children:"You have unsaved changes in this project. If you leave now, all unsaved changes will be lost."}),s.jsx(vA,{variant:"body2",sx:{fontSize:"14px",color:"#5f6368",fontFamily:'"Google Sans", sans-serif',lineHeight:1.5},children:"Are you sure you want to leave?"})]})}),zv=e=>{let t;const n=new Set,r=(e,r)=>{const o="function"==typeof e?e(t):e;if(!Object.is(o,t)){const e=t;t=(null!=r?r:"object"!=typeof o||null===o)?o:Object.assign({},t,o),n.forEach(n=>n(t,e))}},o=()=>t,i={setState:r,getState:o,getInitialState:()=>s,subscribe:e=>(n.add(e),()=>n.delete(e))},s=t=e(r,o,i);return i},Hv=e=>e?zv(e):zv,Gv=e=>e;const Vv=e=>{const t=Hv(e),n=e=>function(e,t=Gv){const n=fe.useSyncExternalStore(e.subscribe,fe.useCallback(()=>t(e.getState()),[e,t]),fe.useCallback(()=>t(e.getInitialState()),[e,t]));return fe.useDebugValue(n),n}(t,e);return Object.assign(n,t),n},Wv=e=>e?Vv(e):Vv;function $v(e,t){let n;try{n=e()}catch(hee){return}return{getItem:e=>{var t;const r=e=>null===e?null:JSON.parse(e,void 0),o=null!=(t=n.getItem(e))?t:null;return o instanceof Promise?o.then(r):r(o)},setItem:(e,t)=>n.setItem(e,JSON.stringify(t,void 0)),removeItem:e=>n.removeItem(e)}}const Kv=e=>t=>{try{const n=e(t);return n instanceof Promise?n:{then:e=>Kv(e)(n),catch(e){return this}}}catch(hee){return{then(e){return this},catch:t=>Kv(t)(hee)}}},Xv=(e,t)=>(n,r,o)=>{let i={storage:$v(()=>localStorage),partialize:e=>e,version:0,merge:(e,t)=>({...t,...e}),...t},s=!1;const a=new Set,l=new Set;let c=i.storage;if(!c)return e((...e)=>{n(...e)},r,o);const u=()=>{const e=i.partialize({...r()});return c.setItem(i.name,{state:e,version:i.version})},d=o.setState;o.setState=(e,t)=>(d(e,t),u());const A=e((...e)=>(n(...e),u()),r,o);let h;o.getInitialState=()=>A;const p=()=>{var e,t;if(!c)return;s=!1,a.forEach(e=>{var t;return e(null!=(t=r())?t:A)});const o=(null==(t=i.onRehydrateStorage)?void 0:t.call(i,null!=(e=r())?e:A))||void 0;return Kv(c.getItem.bind(c))(i.name).then(e=>{if(e){if("number"!=typeof e.version||e.version===i.version)return[!1,e.state];if(i.migrate){const t=i.migrate(e.state,e.version);return t instanceof Promise?t.then(e=>[!0,e]):[!0,t]}}return[!1,void 0]}).then(e=>{var t;const[o,s]=e;if(h=i.merge(s,null!=(t=r())?t:A),n(h,!0),o)return u()}).then(()=>{null==o||o(h,void 0),h=r(),s=!0,l.forEach(e=>e(h))}).catch(e=>{null==o||o(void 0,e)})};return o.persist={setOptions:e=>{i={...i,...e},e.storage&&(c=e.storage)},clearStorage:()=>{null==c||c.removeItem(i.name)},getOptions:()=>i,rehydrate:()=>p(),hasHydrated:()=>s,onHydrate:e=>(a.add(e),()=>{a.delete(e)}),onFinishHydration:e=>(l.add(e),()=>{l.delete(e)})},i.skipHydration||p(),h||A};var Yv=(e,t,n)=>(r,o)=>({pastStates:n?.pastStates||[],futureStates:n?.futureStates||[],undo:(i=1)=>{if(o().pastStates.length){const s=n?.partialize?.(t())||t(),a=o().pastStates.splice(-i,i),l=a.shift();e(l),r({pastStates:o().pastStates,futureStates:o().futureStates.concat(n?.diff?.(s,l)||s,a.reverse())})}},redo:(i=1)=>{if(o().futureStates.length){const s=n?.partialize?.(t())||t(),a=o().futureStates.splice(-i,i),l=a.shift();e(l),r({pastStates:o().pastStates.concat(n?.diff?.(s,l)||s,a.reverse()),futureStates:o().futureStates})}},clear:()=>r({pastStates:[],futureStates:[]}),isTracking:!0,pause:()=>r({isTracking:!1}),resume:()=>r({isTracking:!0}),setOnSave:e=>r({_onSave:e}),_onSave:n?.onSave,_handleSet:(e,t,i,s)=>{n?.limit&&o().pastStates.length>=n?.limit&&o().pastStates.shift(),o()._onSave?.(e,i),r({pastStates:o().pastStates.concat(s||e),futureStates:[]})}});const qv=11102230246251565e-32,Jv=134217729,Zv=(3+8*qv)*qv;function eb(e,t,n,r,o){let i,s,a,l,c=t[0],u=r[0],d=0,A=0;u>c==u>-c?(i=c,c=t[++d]):(i=u,u=r[++A]);let h=0;if(d<e&&A<n)for(u>c==u>-c?(s=c+i,a=i-(s-c),c=t[++d]):(s=u+i,a=i-(s-u),u=r[++A]),i=s,0!==a&&(o[h++]=a);d<e&&A<n;)u>c==u>-c?(s=i+c,l=s-i,a=i-(s-l)+(c-l),c=t[++d]):(s=i+u,l=s-i,a=i-(s-l)+(u-l),u=r[++A]),i=s,0!==a&&(o[h++]=a);for(;d<e;)s=i+c,l=s-i,a=i-(s-l)+(c-l),c=t[++d],i=s,0!==a&&(o[h++]=a);for(;A<n;)s=i+u,l=s-i,a=i-(s-l)+(u-l),u=r[++A],i=s,0!==a&&(o[h++]=a);return 0===i&&0!==h||(o[h++]=i),h}function tb(e){return new Float64Array(e)}const nb=tb(4),rb=tb(8),ob=tb(12),ib=tb(16),sb=tb(4);function ab(e,t,n,r,o,i){const s=(t-i)*(n-o),a=(e-o)*(r-i),l=s-a,c=Math.abs(s+a);return Math.abs(l)>=33306690738754716e-32*c?l:-function(e,t,n,r,o,i,s){let a,l,c,u,d,A,h,p,f,g,m,y,v,b,w,x,_,C;const S=e-o,E=n-o,B=t-i,I=r-i;b=S*I,A=Jv*S,h=A-(A-S),p=S-h,A=Jv*I,f=A-(A-I),g=I-f,w=p*g-(b-h*f-p*f-h*g),x=B*E,A=Jv*B,h=A-(A-B),p=B-h,A=Jv*E,f=A-(A-E),g=E-f,_=p*g-(x-h*f-p*f-h*g),m=w-_,d=w-m,nb[0]=w-(m+d)+(d-_),y=b+m,d=y-b,v=b-(y-d)+(m-d),m=v-x,d=v-m,nb[1]=v-(m+d)+(d-x),C=y+m,d=C-y,nb[2]=y-(C-d)+(m-d),nb[3]=C;let R=function(e,t){let n=t[0];for(let r=1;r<e;r++)n+=t[r];return n}(4,nb),k=22204460492503146e-32*s;if(R>=k||-R>=k)return R;if(d=e-S,a=e-(S+d)+(d-o),d=n-E,c=n-(E+d)+(d-o),d=t-B,l=t-(B+d)+(d-i),d=r-I,u=r-(I+d)+(d-i),0===a&&0===l&&0===c&&0===u)return R;if(k=11093356479670487e-47*s+Zv*Math.abs(R),R+=S*u+I*a-(B*c+E*l),R>=k||-R>=k)return R;b=a*I,A=Jv*a,h=A-(A-a),p=a-h,A=Jv*I,f=A-(A-I),g=I-f,w=p*g-(b-h*f-p*f-h*g),x=l*E,A=Jv*l,h=A-(A-l),p=l-h,A=Jv*E,f=A-(A-E),g=E-f,_=p*g-(x-h*f-p*f-h*g),m=w-_,d=w-m,sb[0]=w-(m+d)+(d-_),y=b+m,d=y-b,v=b-(y-d)+(m-d),m=v-x,d=v-m,sb[1]=v-(m+d)+(d-x),C=y+m,d=C-y,sb[2]=y-(C-d)+(m-d),sb[3]=C;const T=eb(4,nb,4,sb,rb);b=S*u,A=Jv*S,h=A-(A-S),p=S-h,A=Jv*u,f=A-(A-u),g=u-f,w=p*g-(b-h*f-p*f-h*g),x=B*c,A=Jv*B,h=A-(A-B),p=B-h,A=Jv*c,f=A-(A-c),g=c-f,_=p*g-(x-h*f-p*f-h*g),m=w-_,d=w-m,sb[0]=w-(m+d)+(d-_),y=b+m,d=y-b,v=b-(y-d)+(m-d),m=v-x,d=v-m,sb[1]=v-(m+d)+(d-x),C=y+m,d=C-y,sb[2]=y-(C-d)+(m-d),sb[3]=C;const P=eb(T,rb,4,sb,ob);b=a*u,A=Jv*a,h=A-(A-a),p=a-h,A=Jv*u,f=A-(A-u),g=u-f,w=p*g-(b-h*f-p*f-h*g),x=l*c,A=Jv*l,h=A-(A-l),p=l-h,A=Jv*c,f=A-(A-c),g=c-f,_=p*g-(x-h*f-p*f-h*g),m=w-_,d=w-m,sb[0]=w-(m+d)+(d-_),y=b+m,d=y-b,v=b-(y-d)+(m-d),m=v-x,d=v-m,sb[1]=v-(m+d)+(d-x),C=y+m,d=C-y,sb[2]=y-(C-d)+(m-d),sb[3]=C;const F=eb(P,ob,4,sb,ib);return ib[F-1]}(e,t,n,r,o,i,c)}function lb(e,t){var n,r,o,i,s,a,l,c,u,d=0,A=e[0],h=e[1],p=t.length;for(n=0;n<p;n++){r=0;var f=t[n],g=f.length-1;if((c=f[0])[0]!==f[g][0]&&c[1]!==f[g][1])throw new Error("First and last coordinates in a ring must be the same");for(i=c[0]-A,s=c[1]-h;r<g;r++){if(a=(u=f[r+1])[0]-A,l=u[1]-h,0===s&&0===l){if(a<=0&&i>=0||i<=0&&a>=0)return 0}else if(l>=0&&s<=0||l<=0&&s>=0){if(0===(o=ab(i,a,s,l,0,0)))return 0;(o>0&&l>0&&s<=0||o<0&&l<=0&&s>0)&&d++}c=u,s=l,i=a}}return d%2!=0}var cb=6371008.8,ub={centimeters:637100880,centimetres:637100880,degrees:360/(2*Math.PI),feet:20902260.511392,inches:39.37*cb,kilometers:6371.0088,kilometres:6371.0088,meters:cb,metres:cb,miles:3958.761333810546,millimeters:6371008800,millimetres:6371008800,nauticalmiles:cb/1852,radians:1,yards:6967335.223679999};function db(e,t,n={}){const r={type:"Feature"};return(0===n.id||n.id)&&(r.id=n.id),n.bbox&&(r.bbox=n.bbox),r.properties=t||{},r.geometry=e,r}function Ab(e,t,n={}){if(!e)throw new Error("coordinates is required");if(!Array.isArray(e))throw new Error("coordinates must be an Array");if(e.length<2)throw new Error("coordinates must be at least 2 numbers long");if(!yb(e[0])||!yb(e[1]))throw new Error("coordinates must contain numbers");return db({type:"Point",coordinates:e},t,n)}function hb(e,t,n={}){for(const r of e){if(r.length<4)throw new Error("Each LinearRing of a Polygon must have 4 or more Positions.");if(r[r.length-1].length!==r[0].length)throw new Error("First and last Position are not equivalent.");for(let e=0;e<r[r.length-1].length;e++)if(r[r.length-1][e]!==r[0][e])throw new Error("First and last Position are not equivalent.")}return db({type:"Polygon",coordinates:e},t,n)}function pb(e,t,n={}){if(e.length<2)throw new Error("coordinates must be an array of two or more positions");return db({type:"LineString",coordinates:e},t,n)}function fb(e,t={}){const n={type:"FeatureCollection"};return t.id&&(n.id=t.id),t.bbox&&(n.bbox=t.bbox),n.features=e,n}function gb(e){return 180*(e%(2*Math.PI))/Math.PI}function mb(e){return e%360*Math.PI/180}function yb(e){return!isNaN(e)&&null!==e&&!Array.isArray(e)}function vb(e){if(!e)throw new Error("coord is required");if(!Array.isArray(e)){if("Feature"===e.type&&null!==e.geometry&&"Point"===e.geometry.type)return[...e.geometry.coordinates];if("Point"===e.type)return[...e.coordinates]}if(Array.isArray(e)&&e.length>=2&&!Array.isArray(e[0])&&!Array.isArray(e[1]))return[...e];throw new Error("coord must be GeoJSON Point or an Array of numbers")}function bb(e){if(Array.isArray(e))return e;if("Feature"===e.type){if(null!==e.geometry)return e.geometry.coordinates}else if(e.coordinates)return e.coordinates;throw new Error("coords must be GeoJSON Feature, Geometry Object or an Array")}function wb(e){return"Feature"===e.type?e.geometry:e}function xb(e,t,n={}){if(!e)throw new Error("point is required");if(!t)throw new Error("polygon is required");const r=vb(e),o=wb(t),i=o.type,s=t.bbox;let a=o.coordinates;if(s&&!1===function(e,t){return t[0]<=e[0]&&t[1]<=e[1]&&t[2]>=e[0]&&t[3]>=e[1]}(r,s))return!1;"Polygon"===i&&(a=[a]);let l=!1;for(var c=0;c<a.length;++c){const e=lb(r,a[c]);if(0===e)return!n.ignoreBoundary;e&&(l=!0)}return l}var _b=xb;function Cb(e,t,n){if(null!==e)for(var r,o,i,s,a,l,c,u,d=0,A=0,h=e.type,p="FeatureCollection"===h,f="Feature"===h,g=p?e.features.length:1,m=0;m<g;m++){a=(u=!!(c=p?e.features[m].geometry:f?e.geometry:e)&&"GeometryCollection"===c.type)?c.geometries.length:1;for(var y=0;y<a;y++){var v=0,b=0;if(null!==(s=u?c.geometries[y]:c)){l=s.coordinates;var w=s.type;switch(d=0,w){case null:break;case"Point":if(!1===t(l,A,m,v,b))return!1;A++,v++;break;case"LineString":case"MultiPoint":for(r=0;r<l.length;r++){if(!1===t(l[r],A,m,v,b))return!1;A++,"MultiPoint"===w&&v++}"LineString"===w&&v++;break;case"Polygon":case"MultiLineString":for(r=0;r<l.length;r++){for(o=0;o<l[r].length-d;o++){if(!1===t(l[r][o],A,m,v,b))return!1;A++}"MultiLineString"===w&&v++,"Polygon"===w&&b++}"Polygon"===w&&v++;break;case"MultiPolygon":for(r=0;r<l.length;r++){for(b=0,o=0;o<l[r].length;o++){for(i=0;i<l[r][o].length-d;i++){if(!1===t(l[r][o][i],A,m,v,b))return!1;A++}b++}v++}break;case"GeometryCollection":for(r=0;r<s.geometries.length;r++)if(!1===Cb(s.geometries[r],t))return!1;break;default:throw new Error("Unknown Geometry Type")}}}}}function Sb(e,t){!function(e,t){var n,r,o,i,s,a,l,c,u,d,A=0,h="FeatureCollection"===e.type,p="Feature"===e.type,f=h?e.features.length:1;for(n=0;n<f;n++){for(a=h?e.features[n].geometry:p?e.geometry:e,c=h?e.features[n].properties:p?e.properties:{},u=h?e.features[n].bbox:p?e.bbox:void 0,d=h?e.features[n].id:p?e.id:void 0,s=(l=!!a&&"GeometryCollection"===a.type)?a.geometries.length:1,o=0;o<s;o++)if(null!==(i=l?a.geometries[o]:a))switch(i.type){case"Point":case"LineString":case"MultiPoint":case"Polygon":case"MultiLineString":case"MultiPolygon":if(!1===t(i,A,c,u,d))return!1;break;case"GeometryCollection":for(r=0;r<i.geometries.length;r++)if(!1===t(i.geometries[r],A,c,u,d))return!1;break;default:throw new Error("Unknown Geometry Type")}else if(!1===t(null,A,c,u,d))return!1;A++}}(e,function(e,n,r,o,i){var s,a=null===e?null:e.type;switch(a){case null:case"Point":case"LineString":case"Polygon":return!1!==t(db(e,r,{bbox:o,id:i}),n,0)&&void 0}switch(a){case"MultiPoint":s="Point";break;case"MultiLineString":s="LineString";break;case"MultiPolygon":s="Polygon"}for(var l=0;l<e.coordinates.length;l++){var c=e.coordinates[l];if(!1===t(db({type:s,coordinates:c},r),n,l))return!1}})}function Eb(e,t={}){if(null!=e.bbox&&!0!==t.recompute)return e.bbox;const n=[1/0,1/0,-1/0,-1/0];return Cb(e,e=>{n[0]>e[0]&&(n[0]=e[0]),n[1]>e[1]&&(n[1]=e[1]),n[2]<e[0]&&(n[2]=e[0]),n[3]<e[1]&&(n[3]=e[1])}),n}function Bb(e,t,n={}){const r=vb(e),o=bb(t);for(let i=0;i<o.length-1;i++){let e=!1;if(n.ignoreEndVertices&&(0===i&&(e="start"),i===o.length-2&&(e="end"),0===i&&i+1===o.length-1&&(e="both")),Ib(o[i],o[i+1],r,e,void 0===n.epsilon?null:n.epsilon))return!0}return!1}function Ib(e,t,n,r,o){const i=n[0],s=n[1],a=e[0],l=e[1],c=t[0],u=t[1],d=c-a,A=u-l,h=(n[0]-a)*A-(n[1]-l)*d;if(null!==o){if(Math.abs(h)>o)return!1}else if(0!==h)return!1;return Math.abs(d)===Math.abs(A)&&0===Math.abs(d)?!r&&(n[0]===e[0]&&n[1]===e[1]):r?"start"===r?Math.abs(d)>=Math.abs(A)?d>0?a<i&&i<=c:c<=i&&i<a:A>0?l<s&&s<=u:u<=s&&s<l:"end"===r?Math.abs(d)>=Math.abs(A)?d>0?a<=i&&i<c:c<i&&i<=a:A>0?l<=s&&s<u:u<s&&s<=l:"both"===r&&(Math.abs(d)>=Math.abs(A)?d>0?a<i&&i<c:c<i&&i<a:A>0?l<s&&s<u:u<s&&s<l):Math.abs(d)>=Math.abs(A)?d>0?a<=i&&i<=c:c<=i&&i<=a:A>0?l<=s&&s<=u:u<=s&&s<=l}function Rb(e,t){return!(e[0]>t[0])&&(!(e[2]<t[2])&&(!(e[1]>t[1])&&!(e[3]<t[3])))}function kb(e,t){return e[0]===t[0]&&e[1]===t[1]}function Tb(e,t){return[(e[0]+t[0])/2,(e[1]+t[1])/2]}var Pb=function(e,t){var n=wb(e),r=wb(t),o=n.type,i=r.type;switch(o){case"Point":switch(i){case"MultiPoint":return function(e,t){var n,r=!1;for(n=0;n<t.coordinates.length;n++)if(kb(t.coordinates[n],e.coordinates)){r=!0;break}return r}(n,r);case"LineString":return Bb(n,r,{ignoreEndVertices:!0});case"Polygon":case"MultiPolygon":return xb(n,r,{ignoreBoundary:!0});default:throw new Error("feature2 "+i+" geometry not supported")}case"MultiPoint":switch(i){case"MultiPoint":return function(e,t){for(var n=0;n<e.coordinates.length;n++){for(var r=!1,o=0;o<t.coordinates.length;o++)kb(e.coordinates[n],t.coordinates[o])&&(r=!0);if(!r)return!1}return!0}(n,r);case"LineString":return function(e,t){for(var n=!1,r=0;r<e.coordinates.length;r++){if(!Bb(e.coordinates[r],t))return!1;n||(n=Bb(e.coordinates[r],t,{ignoreEndVertices:!0}))}return n}(n,r);case"Polygon":case"MultiPolygon":return function(e,t){for(var n=!0,r=!1,o=0;o<e.coordinates.length;o++){if(!(r=xb(e.coordinates[o],t))){n=!1;break}r=xb(e.coordinates[o],t,{ignoreBoundary:!0})}return n&&r}(n,r);default:throw new Error("feature2 "+i+" geometry not supported")}case"LineString":switch(i){case"LineString":return function(e,t){for(var n=0;n<e.coordinates.length;n++)if(!Bb(e.coordinates[n],t))return!1;return!0}(n,r);case"Polygon":case"MultiPolygon":return function(e,t){var n=Eb(t),r=Eb(e);if(!Rb(n,r))return!1;for(var o=!1,i=0;i<e.coordinates.length;i++){if(!xb(e.coordinates[i],t))return!1;if(o||(o=xb(e.coordinates[i],t,{ignoreBoundary:!0})),!o&&i<e.coordinates.length-1)o=xb(Tb(e.coordinates[i],e.coordinates[i+1]),t,{ignoreBoundary:!0})}return o}(n,r);default:throw new Error("feature2 "+i+" geometry not supported")}case"Polygon":switch(i){case"Polygon":case"MultiPolygon":return function(e,t){var n=Eb(e);if(!Rb(Eb(t),n))return!1;for(var r=0;r<e.coordinates[0].length;r++)if(!xb(e.coordinates[0][r],t))return!1;return!0}(n,r);default:throw new Error("feature2 "+i+" geometry not supported")}default:throw new Error("feature1 "+o+" geometry not supported")}};function Fb(e,t,n={}){var r=vb(e),o=vb(t),i=mb(o[1]-r[1]),s=mb(o[0]-r[0]),a=mb(r[1]),l=mb(o[1]),c=Math.pow(Math.sin(i/2),2)+Math.pow(Math.sin(s/2),2)*Math.cos(a)*Math.cos(l);return function(e,t="kilometers"){const n=ub[t];if(!n)throw new Error(t+" units is invalid");return e*n}(2*Math.atan2(Math.sqrt(c),Math.sqrt(1-c)),n.units)}class Mb{constructor(e=[],t=Lb){if(this.data=e,this.length=this.data.length,this.compare=t,this.length>0)for(let n=(this.length>>1)-1;n>=0;n--)this._down(n)}push(e){this.data.push(e),this.length++,this._up(this.length-1)}pop(){if(0===this.length)return;const e=this.data[0],t=this.data.pop();return this.length--,this.length>0&&(this.data[0]=t,this._down(0)),e}peek(){return this.data[0]}_up(e){const{data:t,compare:n}=this,r=t[e];for(;e>0;){const o=e-1>>1,i=t[o];if(n(r,i)>=0)break;t[e]=i,e=o}t[e]=r}_down(e){const{data:t,compare:n}=this,r=this.length>>1,o=t[e];for(;e<r;){let r=1+(e<<1),i=t[r];const s=r+1;if(s<this.length&&n(t[s],i)<0&&(r=s,i=t[s]),n(i,o)>=0)break;t[e]=i,e=r}t[e]=o}}function Lb(e,t){return e<t?-1:e>t?1:0}function Ub(e,t){return e.p.x>t.p.x?1:e.p.x<t.p.x?-1:e.p.y!==t.p.y?e.p.y>t.p.y?1:-1:1}function Ob(e,t){return e.rightSweepEvent.p.x>t.rightSweepEvent.p.x?1:e.rightSweepEvent.p.x<t.rightSweepEvent.p.x?-1:e.rightSweepEvent.p.y!==t.rightSweepEvent.p.y?e.rightSweepEvent.p.y<t.rightSweepEvent.p.y?1:-1:1}let Db=class{constructor(e,t,n,r){this.p={x:e[0],y:e[1]},this.featureId=t,this.ringId=n,this.eventId=r,this.otherEvent=null,this.isLeftEndpoint=null}isSamePoint(e){return this.p.x===e.p.x&&this.p.y===e.p.y}};let Nb=0,jb=0,Qb=0;function zb(e,t){const n="Feature"===e.type?e.geometry:e;let r=n.coordinates;"Polygon"!==n.type&&"MultiLineString"!==n.type||(r=[r]),"LineString"===n.type&&(r=[[r]]);for(let o=0;o<r.length;o++)for(let e=0;e<r[o].length;e++){let n=r[o][e][0],i=null;jb+=1;for(let s=0;s<r[o][e].length-1;s++){i=r[o][e][s+1];const a=new Db(n,Nb,jb,Qb),l=new Db(i,Nb,jb,Qb+1);a.otherEvent=l,l.otherEvent=a,Ub(a,l)>0?(l.isLeftEndpoint=!0,a.isLeftEndpoint=!1):(a.isLeftEndpoint=!0,l.isLeftEndpoint=!1),t.push(a),t.push(l),n=i,Qb+=1}}Nb+=1}class Hb{constructor(e){this.leftSweepEvent=e,this.rightSweepEvent=e.otherEvent}}function Gb(e,t){if(null===e||null===t)return!1;if(e.leftSweepEvent.ringId===t.leftSweepEvent.ringId&&(e.rightSweepEvent.isSamePoint(t.leftSweepEvent)||e.rightSweepEvent.isSamePoint(t.leftSweepEvent)||e.rightSweepEvent.isSamePoint(t.rightSweepEvent)||e.leftSweepEvent.isSamePoint(t.leftSweepEvent)||e.leftSweepEvent.isSamePoint(t.rightSweepEvent)))return!1;const n=e.leftSweepEvent.p.x,r=e.leftSweepEvent.p.y,o=e.rightSweepEvent.p.x,i=e.rightSweepEvent.p.y,s=t.leftSweepEvent.p.x,a=t.leftSweepEvent.p.y,l=t.rightSweepEvent.p.x,c=t.rightSweepEvent.p.y,u=(c-a)*(o-n)-(l-s)*(i-r),d=(l-s)*(r-a)-(c-a)*(n-s),A=(o-n)*(r-a)-(i-r)*(n-s);if(0===u)return!1;const h=d/u,p=A/u;if(h>=0&&h<=1&&p>=0&&p<=1){return[n+h*(o-n),r+h*(i-r)]}return!1}var Vb=function(e,t){const n=new Mb([],Ub);return function(e,t){if("FeatureCollection"===e.type){const n=e.features;for(let e=0;e<n.length;e++)zb(n[e],t)}else zb(e,t)}(e,n),function(e,t){t=t||!1;const n=[],r=new Mb([],Ob);for(;e.length;){const o=e.pop();if(o.isLeftEndpoint){const e=new Hb(o);for(let i=0;i<r.data.length;i++){const s=r.data[i];if(t&&s.leftSweepEvent.featureId===o.featureId)continue;const a=Gb(e,s);!1!==a&&n.push(a)}r.push(e)}else!1===o.isLeftEndpoint&&r.pop()}return n}(n,t)};function Wb(e,t,n={}){const{removeDuplicates:r=!0,ignoreSelfIntersections:o=!0}=n;let i=[];"FeatureCollection"===e.type?i=i.concat(e.features):"Feature"===e.type?i.push(e):"LineString"!==e.type&&"Polygon"!==e.type&&"MultiLineString"!==e.type&&"MultiPolygon"!==e.type||i.push(db(e)),"FeatureCollection"===t.type?i=i.concat(t.features):"Feature"===t.type?i.push(t):"LineString"!==t.type&&"Polygon"!==t.type&&"MultiLineString"!==t.type&&"MultiPolygon"!==t.type||i.push(db(t));const s=Vb(fb(i),o);let a=[];if(r){const e={};s.forEach(t=>{const n=t.join(",");e[n]||(e[n]=!0,a.push(t))})}else a=s;return fb(a.map(e=>Ab(e)))}function $b(e,t={}){const n=wb(e);switch(t.properties||"Feature"!==e.type||(t.properties=e.properties),n.type){case"Polygon":return function(e,t={}){const n=wb(e),r=n.coordinates,o=t.properties?t.properties:"Feature"===e.type?e.properties:{};return Kb(r,o)}(n,t);case"MultiPolygon":return function(e,t={}){const n=wb(e),r=n.coordinates,o=t.properties?t.properties:"Feature"===e.type?e.properties:{},i=[];return r.forEach(e=>{i.push(Kb(e,o))}),fb(i)}(n,t);default:throw new Error("invalid poly")}}function Kb(e,t){return e.length>1?function(e,t,n={}){return db({type:"MultiLineString",coordinates:e},t,n)}(e,t):pb(e[0],t)}function Xb(e,t,{ignoreSelfIntersections:n=!0}={ignoreSelfIntersections:!0}){let r=!0;return Sb(e,e=>{Sb(t,t=>{if(!1===r)return!1;r=function(e,t,n){switch(e.type){case"Point":switch(t.type){case"Point":return r=e.coordinates,o=t.coordinates,!(r[0]===o[0]&&r[1]===o[1]);case"LineString":return!Yb(t,e);case"Polygon":return!xb(e,t)}break;case"LineString":switch(t.type){case"Point":return!Yb(e,t);case"LineString":return!function(e,t,n){const r=Wb(e,t,{ignoreSelfIntersections:n});if(r.features.length>0)return!0;return!1}(e,t,n);case"Polygon":return!qb(t,e,n)}break;case"Polygon":switch(t.type){case"Point":return!xb(t,e);case"LineString":return!qb(e,t,n);case"Polygon":return!function(e,t,n){for(const o of e.coordinates[0])if(xb(o,t))return!0;for(const o of t.coordinates[0])if(xb(o,e))return!0;const r=Wb($b(e),$b(t),{ignoreSelfIntersections:n});if(r.features.length>0)return!0;return!1}(t,e,n)}}var r,o;return!1}(e.geometry,t.geometry,n)})}),r}function Yb(e,t){for(let n=0;n<e.coordinates.length-1;n++)if(Jb(e.coordinates[n],e.coordinates[n+1],t.coordinates))return!0;return!1}function qb(e,t,n){for(const r of t.coordinates)if(xb(r,e))return!0;return Wb(t,$b(e),{ignoreSelfIntersections:n}).features.length>0}function Jb(e,t,n){const r=n[0]-e[0],o=n[1]-e[1],i=t[0]-e[0],s=t[1]-e[1];return 0===r*s-o*i&&(Math.abs(i)>=Math.abs(s)?i>0?e[0]<=n[0]&&n[0]<=t[0]:t[0]<=n[0]&&n[0]<=e[0]:s>0?e[1]<=n[1]&&n[1]<=t[1]:t[1]<=n[1]&&n[1]<=e[1])}function Zb(e,t,{ignoreSelfIntersections:n=!0}={}){let r=!1;return Sb(e,e=>{Sb(t,t=>{if(!0===r)return!0;r=!Xb(e.geometry,t.geometry,{ignoreSelfIntersections:n})})}),r}var ew,tw,nw=Object.defineProperty,rw=Object.defineProperties,ow=Object.getOwnPropertyDescriptors,iw=Object.getOwnPropertySymbols,sw=Object.prototype.hasOwnProperty,aw=Object.prototype.propertyIsEnumerable,lw=(e,t,n)=>t in e?nw(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,cw=(e,t)=>{for(var n in t||(t={}))sw.call(t,n)&&lw(e,n,t[n]);if(iw)for(var n of iw(t))aw.call(t,n)&&lw(e,n,t[n]);return e},uw=(e,t)=>rw(e,ow(t));function dw(e,t,n={}){if(!e||!t)throw new Error("lines and pt are required arguments");const r=vb(t);let o=Ab([1/0,1/0],{dist:1/0,index:-1,multiFeatureIndex:-1,location:-1}),i=0;return Sb(e,function(e,s,a){const l=bb(e);for(let c=0;c<l.length-1;c++){const e=Ab(l[c]),s=vb(e),u=Ab(l[c+1]),d=vb(u),A=Fb(e,u,n);let h,p;d[0]===r[0]&&d[1]===r[1]?[h,p]=[d,!0]:s[0]===r[0]&&s[1]===r[1]?[h,p]=[s,!1]:[h,p]=mw(s,d,r);const f=Ab(h,{dist:Fb(t,h,n),multiFeatureIndex:a,location:i+Fb(e,h,n)});f.properties.dist<o.properties.dist&&(o=uw(cw({},f),{properties:uw(cw({},f.properties),{index:p?c+1:c})})),i+=A}}),o}function Aw(e,t){const[n,r,o]=e,[i,s,a]=t;return n*i+r*s+o*a}function hw(e,t){const[n,r,o]=e,[i,s,a]=t;return[r*a-o*s,o*i-n*a,n*s-r*i]}function pw(e){const t=function(e){return Math.sqrt(Math.pow(e[0],2)+Math.pow(e[1],2)+Math.pow(e[2],2))}(e);return[e[0]/t,e[1]/t,e[2]/t]}function fw(e){const t=mb(e[1]),n=mb(e[0]);return[Math.cos(t)*Math.cos(n),Math.cos(t)*Math.sin(n),Math.sin(t)]}function gw(e){const[t,n,r]=e,o=Math.min(Math.max(r,-1),1),i=gb(Math.asin(o));return[gb(Math.atan2(n,t)),i]}function mw(e,t,n){const r=fw(e),o=fw(t),i=fw(n),s=hw(r,o);if(0===s[0]&&0===s[1]&&0===s[2])return Aw(r,o)>0?[[...t],!0]:[[...n],!1];const a=hw(s,i);if(0===a[0]&&0===a[1]&&0===a[2])return[[...t],!0];const l=pw(hw(a,s)),c=[-l[0],-l[1],-l[2]],u=Aw(i,l)>Aw(i,c)?l:c,d=pw(s),A=Aw(hw(r,u),d),h=Aw(hw(u,o),d);return A>=0&&h>=0?[gw(u),!1]:Aw(r,i)>Aw(o,i)?[[...e],!1]:[[...t],!0]}var yw=(tw||(tw=1,ew=function e(t,n){if(t===n)return!0;if(t&&n&&"object"==typeof t&&"object"==typeof n){if(t.constructor!==n.constructor)return!1;var r,o,i;if(Array.isArray(t)){if((r=t.length)!=n.length)return!1;for(o=r;0!==o--;)if(!e(t[o],n[o]))return!1;return!0}if(t.constructor===RegExp)return t.source===n.source&&t.flags===n.flags;if(t.valueOf!==Object.prototype.valueOf)return t.valueOf()===n.valueOf();if(t.toString!==Object.prototype.toString)return t.toString()===n.toString();if((r=(i=Object.keys(t)).length)!==Object.keys(n).length)return!1;for(o=r;0!==o--;)if(!Object.prototype.hasOwnProperty.call(n,i[o]))return!1;for(o=r;0!==o--;){var s=i[o];if(!e(t[s],n[s]))return!1}return!0}return t!=t&&n!=n}),ew);const vw=t(yw);var bw,ww={exports:{}};var xw=function(){if(bw)return ww.exports;function e(e,n,o){o=o||2;var i,s,a,u,d,h,p,f=n&&n.length,g=f?n[0]*o:e.length,m=t(e,0,g,o,!0),y=[];if(!m||m.next===m.prev)return y;if(f&&(m=function(e,n,r,o){var i,s,a,u=[];for(i=0,s=n.length;i<s;i++)(a=t(e,n[i]*o,i<s-1?n[i+1]*o:e.length,o,!1))===a.next&&(a.steiner=!0),u.push(A(a));for(u.sort(l),i=0;i<u.length;i++)r=c(u[i],r);return r}(e,n,m,o)),e.length>80*o){i=a=e[0],s=u=e[1];for(var v=o;v<g;v+=o)(d=e[v])<i&&(i=d),(h=e[v+1])<s&&(s=h),d>a&&(a=d),h>u&&(u=h);p=0!==(p=Math.max(a-i,u-s))?32767/p:0}return r(m,y,o,i,s,p,0),y}function t(e,t,n,r,o){var i,s;if(o===S(e,t,n,r)>0)for(i=t;i<n;i+=r)s=x(i,e[i],e[i+1],s);else for(i=n-r;i>=t;i-=r)s=x(i,e[i],e[i+1],s);return s&&g(s,s.next)&&(_(s),s=s.next),s}function n(e,t){if(!e)return e;t||(t=e);var n,r=e;do{if(n=!1,r.steiner||!g(r,r.next)&&0!==f(r.prev,r,r.next))r=r.next;else{if(_(r),(r=t=r.prev)===r.next)break;n=!0}}while(n||r!==t);return t}function r(e,t,l,c,u,A,h){if(e){!h&&A&&function(e,t,n,r){var o=e;do{0===o.z&&(o.z=d(o.x,o.y,t,n,r)),o.prevZ=o.prev,o.nextZ=o.next,o=o.next}while(o!==e);o.prevZ.nextZ=null,o.prevZ=null,function(e){var t,n,r,o,i,s,a,l,c=1;do{for(n=e,e=null,i=null,s=0;n;){for(s++,r=n,a=0,t=0;t<c&&(a++,r=r.nextZ);t++);for(l=c;a>0||l>0&&r;)0!==a&&(0===l||!r||n.z<=r.z)?(o=n,n=n.nextZ,a--):(o=r,r=r.nextZ,l--),i?i.nextZ=o:e=o,o.prevZ=i,i=o;n=r}i.nextZ=null,c*=2}while(s>1)}(o)}(e,c,u,A);for(var p,f,g=e;e.prev!==e.next;)if(p=e.prev,f=e.next,A?i(e,c,u,A):o(e))t.push(p.i/l|0),t.push(e.i/l|0),t.push(f.i/l|0),_(e),e=f.next,g=f.next;else if((e=f)===g){h?1===h?r(e=s(n(e),t,l),t,l,c,u,A,2):2===h&&a(e,t,l,c,u,A):r(n(e),t,l,c,u,A,1);break}}}function o(e){var t=e.prev,n=e,r=e.next;if(f(t,n,r)>=0)return!1;for(var o=t.x,i=n.x,s=r.x,a=t.y,l=n.y,c=r.y,u=o<i?o<s?o:s:i<s?i:s,d=a<l?a<c?a:c:l<c?l:c,A=o>i?o>s?o:s:i>s?i:s,p=a>l?a>c?a:c:l>c?l:c,g=r.next;g!==t;){if(g.x>=u&&g.x<=A&&g.y>=d&&g.y<=p&&h(o,a,i,l,s,c,g.x,g.y)&&f(g.prev,g,g.next)>=0)return!1;g=g.next}return!0}function i(e,t,n,r){var o=e.prev,i=e,s=e.next;if(f(o,i,s)>=0)return!1;for(var a=o.x,l=i.x,c=s.x,u=o.y,A=i.y,p=s.y,g=a<l?a<c?a:c:l<c?l:c,m=u<A?u<p?u:p:A<p?A:p,y=a>l?a>c?a:c:l>c?l:c,v=u>A?u>p?u:p:A>p?A:p,b=d(g,m,t,n,r),w=d(y,v,t,n,r),x=e.prevZ,_=e.nextZ;x&&x.z>=b&&_&&_.z<=w;){if(x.x>=g&&x.x<=y&&x.y>=m&&x.y<=v&&x!==o&&x!==s&&h(a,u,l,A,c,p,x.x,x.y)&&f(x.prev,x,x.next)>=0)return!1;if(x=x.prevZ,_.x>=g&&_.x<=y&&_.y>=m&&_.y<=v&&_!==o&&_!==s&&h(a,u,l,A,c,p,_.x,_.y)&&f(_.prev,_,_.next)>=0)return!1;_=_.nextZ}for(;x&&x.z>=b;){if(x.x>=g&&x.x<=y&&x.y>=m&&x.y<=v&&x!==o&&x!==s&&h(a,u,l,A,c,p,x.x,x.y)&&f(x.prev,x,x.next)>=0)return!1;x=x.prevZ}for(;_&&_.z<=w;){if(_.x>=g&&_.x<=y&&_.y>=m&&_.y<=v&&_!==o&&_!==s&&h(a,u,l,A,c,p,_.x,_.y)&&f(_.prev,_,_.next)>=0)return!1;_=_.nextZ}return!0}function s(e,t,r){var o=e;do{var i=o.prev,s=o.next.next;!g(i,s)&&m(i,o,o.next,s)&&b(i,s)&&b(s,i)&&(t.push(i.i/r|0),t.push(o.i/r|0),t.push(s.i/r|0),_(o),_(o.next),o=e=s),o=o.next}while(o!==e);return n(o)}function a(e,t,o,i,s,a){var l=e;do{for(var c=l.next.next;c!==l.prev;){if(l.i!==c.i&&p(l,c)){var u=w(l,c);return l=n(l,l.next),u=n(u,u.next),r(l,t,o,i,s,a,0),void r(u,t,o,i,s,a,0)}c=c.next}l=l.next}while(l!==e)}function l(e,t){return e.x-t.x}function c(e,t){var r=function(e,t){var n,r=t,o=e.x,i=e.y,s=-1/0;do{if(i<=r.y&&i>=r.next.y&&r.next.y!==r.y){var a=r.x+(i-r.y)*(r.next.x-r.x)/(r.next.y-r.y);if(a<=o&&a>s&&(s=a,n=r.x<r.next.x?r:r.next,a===o))return n}r=r.next}while(r!==t);if(!n)return null;var l,c=n,d=n.x,A=n.y,p=1/0;r=n;do{o>=r.x&&r.x>=d&&o!==r.x&&h(i<A?o:s,i,d,A,i<A?s:o,i,r.x,r.y)&&(l=Math.abs(i-r.y)/(o-r.x),b(r,e)&&(l<p||l===p&&(r.x>n.x||r.x===n.x&&u(n,r)))&&(n=r,p=l)),r=r.next}while(r!==c);return n}(e,t);if(!r)return t;var o=w(r,e);return n(o,o.next),n(r,r.next)}function u(e,t){return f(e.prev,e,t.prev)<0&&f(t.next,e,e.next)<0}function d(e,t,n,r,o){return(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=(e-n)*o|0)|e<<8))|e<<4))|e<<2))|e<<1))|(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=(t-r)*o|0)|t<<8))|t<<4))|t<<2))|t<<1))<<1}function A(e){var t=e,n=e;do{(t.x<n.x||t.x===n.x&&t.y<n.y)&&(n=t),t=t.next}while(t!==e);return n}function h(e,t,n,r,o,i,s,a){return(o-s)*(t-a)>=(e-s)*(i-a)&&(e-s)*(r-a)>=(n-s)*(t-a)&&(n-s)*(i-a)>=(o-s)*(r-a)}function p(e,t){return e.next.i!==t.i&&e.prev.i!==t.i&&!function(e,t){var n=e;do{if(n.i!==e.i&&n.next.i!==e.i&&n.i!==t.i&&n.next.i!==t.i&&m(n,n.next,e,t))return!0;n=n.next}while(n!==e);return!1}(e,t)&&(b(e,t)&&b(t,e)&&function(e,t){var n=e,r=!1,o=(e.x+t.x)/2,i=(e.y+t.y)/2;do{n.y>i!=n.next.y>i&&n.next.y!==n.y&&o<(n.next.x-n.x)*(i-n.y)/(n.next.y-n.y)+n.x&&(r=!r),n=n.next}while(n!==e);return r}(e,t)&&(f(e.prev,e,t.prev)||f(e,t.prev,t))||g(e,t)&&f(e.prev,e,e.next)>0&&f(t.prev,t,t.next)>0)}function f(e,t,n){return(t.y-e.y)*(n.x-t.x)-(t.x-e.x)*(n.y-t.y)}function g(e,t){return e.x===t.x&&e.y===t.y}function m(e,t,n,r){var o=v(f(e,t,n)),i=v(f(e,t,r)),s=v(f(n,r,e)),a=v(f(n,r,t));return o!==i&&s!==a||(!(0!==o||!y(e,n,t))||(!(0!==i||!y(e,r,t))||(!(0!==s||!y(n,e,r))||!(0!==a||!y(n,t,r)))))}function y(e,t,n){return t.x<=Math.max(e.x,n.x)&&t.x>=Math.min(e.x,n.x)&&t.y<=Math.max(e.y,n.y)&&t.y>=Math.min(e.y,n.y)}function v(e){return e>0?1:e<0?-1:0}function b(e,t){return f(e.prev,e,e.next)<0?f(e,t,e.next)>=0&&f(e,e.prev,t)>=0:f(e,t,e.prev)<0||f(e,e.next,t)<0}function w(e,t){var n=new C(e.i,e.x,e.y),r=new C(t.i,t.x,t.y),o=e.next,i=t.prev;return e.next=t,t.prev=e,n.next=o,o.prev=n,r.next=n,n.prev=r,i.next=r,r.prev=i,r}function x(e,t,n,r){var o=new C(e,t,n);return r?(o.next=r.next,o.prev=r,r.next.prev=o,r.next=o):(o.prev=o,o.next=o),o}function _(e){e.next.prev=e.prev,e.prev.next=e.next,e.prevZ&&(e.prevZ.nextZ=e.nextZ),e.nextZ&&(e.nextZ.prevZ=e.prevZ)}function C(e,t,n){this.i=e,this.x=t,this.y=n,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}function S(e,t,n,r){for(var o=0,i=t,s=n-r;i<n;i+=r)o+=(e[s]-e[i])*(e[i+1]+e[s+1]),s=i;return o}return bw=1,ww.exports=e,ww.exports.default=e,e.deviation=function(e,t,n,r){var o=t&&t.length,i=o?t[0]*n:e.length,s=Math.abs(S(e,0,i,n));if(o)for(var a=0,l=t.length;a<l;a++){var c=t[a]*n,u=a<l-1?t[a+1]*n:e.length;s-=Math.abs(S(e,c,u,n))}var d=0;for(a=0;a<r.length;a+=3){var A=r[a]*n,h=r[a+1]*n,p=r[a+2]*n;d+=Math.abs((e[A]-e[p])*(e[h+1]-e[A+1])-(e[A]-e[h])*(e[p+1]-e[A+1]))}return 0===s&&0===d?0:Math.abs((d-s)/s)},e.flatten=function(e){for(var t=e[0][0].length,n={vertices:[],holes:[],dimensions:t},r=0,o=0;o<e.length;o++){for(var i=0;i<e[o].length;i++)for(var s=0;s<t;s++)n.vertices.push(e[o][i][s]);o>0&&(r+=e[o-1].length,n.holes.push(r))}return n},ww.exports}();const _w=t(xw);function Cw(e){if(!e)return null;try{let t;try{const n=JSON.parse(e);if(Array.isArray(n)&&n.length>0&&Array.isArray(n[0])&&2===n[0].length){const e=n[0],r=e[0],o=e[1],i=Math.abs(r)<=90&&Math.abs(o)<=180,s=Math.abs(r)<=180&&Math.abs(o)<=90;t=i&&!s?n.map(e=>[e[1],e[0]]):n}else{const n=Sw(e);if(!n.coordinates||n.coordinates.length<2)return null;t=n.coordinates}}catch{const n=Sw(e);if(!n.coordinates||n.coordinates.length<2)return null;t=n.coordinates}if(t.length<2)return null;let n=0;for(let e=0;e<t.length-1;e++){n+=Fb(Ab([t[e][0],t[e][1]]),Ab([t[e+1][0],t[e+1][1]]),"kilometers")}return n}catch(t){return null}}function Sw(e){if(!e)return{type:"LineString",coordinates:[]};try{try{const t=JSON.parse(e);if(Array.isArray(t)&&t.length>0&&Array.isArray(t[0])&&2===t[0].length){const e=t[0],n=e[0],r=e[1],o=Math.abs(n)<=90&&Math.abs(r)<=180,i=Math.abs(n)<=180&&Math.abs(r)<=90;if(o&&!i){return{type:"LineString",coordinates:t.map(e=>[e[1],e[0]])}}return{type:"LineString",coordinates:t}}}catch{}const t=function(e,t){void 0===t&&(t=5);for(var n=Math.pow(10,t),r=e.length,o=new Array(Math.floor(e.length/2)),i=0,s=0,a=0,l=0;i<r;++l){var c=1,u=0,d=void 0;do{c+=(d=e.charCodeAt(i++)-63-1)<<u,u+=5}while(d>=31);s+=1&c?~(c>>1):c>>1,c=1,u=0;do{c+=(d=e.charCodeAt(i++)-63-1)<<u,u+=5}while(d>=31);a+=1&c?~(c>>1):c>>1,o[l]=[s/n,a/n]}return o.length=l,o}(e);if(0===t.length)return{type:"LineString",coordinates:[]};return{type:"LineString",coordinates:t.map(e=>{const[t,n]=e;return Math.abs(t)>90||Math.abs(n),[n,t]})}}catch(t){return{type:"LineString",coordinates:[]}}}function Ew(e,t,n){if(!n)return!1;if("number"!=typeof e||"number"!=typeof t||isNaN(e)||isNaN(t))return!1;try{let r=null;if("FeatureCollection"===n.type){const e=n;if(!(e.features&&e.features.length>0&&"Polygon"===e.features[0].geometry?.type))return!1;r=e.features[0].geometry}else if("Feature"===n.type){const e=n;if("Polygon"!==e.geometry?.type)return!1;r=e.geometry}else{if("Polygon"!==n.type)return!1;r=n}if(!r||!r.coordinates||0===r.coordinates.length)return!1;const o=Ab([t,e]);return _b(o,r)}catch(r){return!1}}function Bw(e,t){if(!t)return!1;if(!e||"string"!=typeof e)return!1;try{const n=Sw(e);if(!n||"LineString"!==n.type||!n.coordinates||0===n.coordinates.length)return!1;let r=null;if("FeatureCollection"===t.type){const e=t;if(!(e.features&&e.features.length>0&&"Polygon"===e.features[0].geometry?.type))return!1;r=e.features[0].geometry}else if("Feature"===t.type){const e=t;if("Polygon"!==e.geometry?.type)return!1;r=e.geometry}else{if("Polygon"!==t.type)return!1;r=t}if(!r||!r.coordinates||0===r.coordinates.length)return!1;const o=pb(n.coordinates);return Pb(o,r)}catch(n){return!1}}const Iw=Object.freeze(Object.defineProperty({__proto__:null,isPointInBoundary:Ew,isRouteWithinBoundary:Bw},Symbol.toStringTag,{value:"Module"})),Rw=new Map,kw=Wv((e,t)=>({messages:[],addMessage:(n,r,o={})=>{const i=o.id||Date.now()+Math.random(),s=o.duration||("loading"===n?1/0:5e3),a={id:i,type:n,message:r,description:o.description,timestamp:Date.now(),duration:s};if(e(e=>({messages:[...e.messages,a]})),"loading"!==n&&s!==1/0&&s>0){const e=Rw.get(i);e&&(clearTimeout(e),Rw.delete(i));const n=setTimeout(()=>{t().dismissMessage(i),Rw.delete(i)},s);Rw.set(i,n)}return i},updateMessage:(n,r,o,i={})=>{const s=i.duration||("loading"===r?1/0:5e3),a=Rw.get(n);a&&(clearTimeout(a),Rw.delete(n));const l=Date.now();if(e(e=>({messages:e.messages.map(e=>e.id===n?{...e,type:r,message:o,description:i.description,duration:s,timestamp:l}:e)})),s!==1/0&&s>0){const e=setTimeout(()=>{const e=t().messages;if(e.some(e=>e.id===n)){const r=e.find(e=>e.id===n);if(r){Date.now()-r.timestamp>=s&&t().dismissMessage(n)}}Rw.delete(n)},s);Rw.set(n,e)}else{const e=Rw.get(n);e&&(clearTimeout(e),Rw.delete(n))}},dismissMessage:t=>{if(void 0===t)return Rw.forEach(e=>clearTimeout(e)),Rw.clear(),void e({messages:[]});const n=Rw.get(t);n&&(clearTimeout(n),Rw.delete(t)),e(e=>{const n=e.messages.filter(e=>e.id!==t);return n.length!==e.messages.length?{messages:n}:e})},dismissAll:()=>{Rw.forEach(e=>clearTimeout(e)),Rw.clear(),e({messages:[]})},dismissMessagesByPattern:(n,r)=>{const o="string"==typeof n?new RegExp(n,"i"):n,i=t(),s=[];i.messages.forEach(e=>{const t=o.test(e.message)||e.description&&o.test(e.description),n=void 0===r||e.type===r;t&&n&&s.push(e.id)}),s.forEach(e=>{const t=Rw.get(e);t&&(clearTimeout(t),Rw.delete(e))}),s.length>0&&e(e=>({messages:e.messages.filter(e=>!s.includes(e.id))}))},clearExpiredMessages:()=>{const n=Date.now(),r=t(),o=[];r.messages.forEach(e=>{if("loading"===e.type||e.duration===1/0)return;const t=e.duration||5e3;if(n-e.timestamp>=t){o.push(e.id);const t=Rw.get(e.id);t&&(clearTimeout(t),Rw.delete(e.id))}}),o.length>0&&o.forEach(t=>{const n=Rw.get(t);n&&(clearTimeout(n),Rw.delete(t)),e(e=>({messages:e.messages.filter(e=>e.id!==t)}))})}})),Tw=(e,t)=>kw.getState().addMessage("success",e,{description:t?.description,duration:t?.duration}),Pw=(e,t)=>kw.getState().addMessage("error",e,{description:t?.description,duration:t?.duration}),Fw=(e,t)=>kw.getState().addMessage("info",e,{description:t?.description,duration:t?.duration}),Mw=(e,t)=>kw.getState().addMessage("warning",e,{description:t?.description,duration:t?.duration}),Lw=(e,t)=>kw.getState().addMessage("loading",e,{id:t?.id,description:t?.description,duration:1/0}),Uw=(e,t,n,r)=>{kw.getState().updateMessage(e,n,t,{description:r?.description,duration:r?.duration})},Ow=e=>{kw.getState().dismissMessage(e)},Dw=(e,t)=>({individualRoute:{points:[],isGenerating:!1,generatedRoute:null,currentRouteId:null,routeUUID:null,originalRouteName:null,originalRouteTag:null,originalRouteIsSegmented:!1,validationError:null},routeGeneration:{isGenerating:!1,lastGeneratedRouteKey:"",routeUUID:null},addPoint:t=>{e(e=>({individualRoute:{...e.individualRoute,points:[...e.individualRoute.points,t],validationError:null}}))},movePoint:(t,n)=>{e(e=>({individualRoute:{...e.individualRoute,points:e.individualRoute.points.map(e=>e.id===t?{...e,coordinates:n}:e),validationError:null}}));const{dismissMessagesByPattern:r}=kw.getState();r(/jurisdiction boundary|outside.*boundary/i,"error")},removePoint:t=>{e(e=>({individualRoute:{...e.individualRoute,points:e.individualRoute.points.filter(e=>e.id!==t),validationError:null}}))},reorderPoints:(t,n)=>{e(e=>{const r=[...e.individualRoute.points],o=r.findIndex(e=>e.id===t),i=r.findIndex(e=>e.id===n);if(-1===o||-1===i)return e;const[s]=r.splice(o,1);return r.splice(i,0,s),{individualRoute:{...e.individualRoute,points:r}}})},clearPoints:()=>{e(e=>({individualRoute:{...e.individualRoute,points:[],generatedRoute:null,currentRouteId:null,routeUUID:null,originalRouteName:null,originalRouteTag:null,originalRouteIsSegmented:!1,validationError:null}}))},setGenerating:t=>{e(e=>({individualRoute:{...e.individualRoute,isGenerating:t}}))},setGeneratedRoute:t=>{e(e=>({individualRoute:{...e.individualRoute,generatedRoute:t,validationError:null}}))},setCurrentRouteId:t=>{e(e=>({individualRoute:{...e.individualRoute,currentRouteId:t}}))},setRouteUUID:t=>{e(e=>({individualRoute:{...e.individualRoute,routeUUID:t}}))},setIndividualRouteError:t=>{e(e=>({individualRoute:{...e.individualRoute,validationError:t}}))},loadRoutePoints:t=>{const n=[];if(!t.origin||0===t.origin.lat&&0===t.origin.lng)return;if(!t.destination||0===t.destination.lat&&0===t.destination.lng)return;n.push({id:`origin_${Date.now()}`,coordinates:t.origin});(Array.isArray(t.waypoints)?t.waypoints:[]).forEach((e,t)=>{let r;if("object"==typeof e&&null!==e&&"lat"in e&&"lng"in e)r={lat:e.lat,lng:e.lng};else{if(!(Array.isArray(e)&&e.length>=2))return;r={lat:e[1],lng:e[0]}}n.push({id:`waypoint_${t}_${Date.now()}`,coordinates:r})}),n.push({id:`destination_${Date.now()}`,coordinates:t.destination}),e(e=>({individualRoute:{...e.individualRoute,points:n,generatedRoute:t,originalRouteName:t.name,originalRouteTag:t.tag||null,originalRouteIsSegmented:t.isSegmented,validationError:null}}))},clearIndividualRoute:()=>{e(()=>({individualRoute:{points:[],isGenerating:!1,generatedRoute:null,currentRouteId:null,routeUUID:null,originalRouteName:null,originalRouteTag:null,originalRouteIsSegmented:!1,validationError:null},routeGeneration:{isGenerating:!1,lastGeneratedRouteKey:"",routeUUID:null}}))},clearRouteGenerationKey:()=>{e(e=>({routeGeneration:{...e.routeGeneration,lastGeneratedRouteKey:""}}))},generateRoute:n=>{const{points:r,projectId:o,generateRouteMutation:i,setGenerating:s,setGeneratedRoute:a,setRouteUUID:l}=n,{routeGeneration:c}=t();if(r.length>=2){const n=r.map((e,t)=>0===t?{...e,type:"origin"}:t===r.length-1?{...e,type:"destination"}:{...e,type:"waypoint"}),l=n[0],u=n[n.length-1],d=n.slice(1,-1);if(l&&u){const n=`${l.coordinates.lat},${l.coordinates.lng}-${u.coordinates.lat},${u.coordinates.lng}-${d.map(e=>`${e.coordinates.lat},${e.coordinates.lng}`).join("|")}`;c.lastGeneratedRouteKey!==n&&(e(e=>({routeGeneration:{...e.routeGeneration,lastGeneratedRouteKey:n,isGenerating:!0}})),s(!0),i.mutate({origin:l.coordinates,destination:u.coordinates,waypoints:d.map(e=>e.coordinates)},{onSuccess:n=>{if(!n?.encodedPolyline||""===n.encodedPolyline.trim())return Pw("No routes found between these points. Please select different points."),s(!1),void e(e=>({routeGeneration:{...e.routeGeneration,isGenerating:!1,lastGeneratedRouteKey:""},individualRoute:{...e.individualRoute,validationError:"No routes found between these points. Please select different points."}}));const{projectData:r}=JN.getState(),i=r?.boundaryGeoJson;if(i){if(!Bw(n.encodedPolyline,i))return Pw("Route extends outside the jurisdiction boundary. Please adjust your route points."),s(!1),void e(e=>({routeGeneration:{...e.routeGeneration,isGenerating:!1,lastGeneratedRouteKey:""},individualRoute:{...e.individualRoute,validationError:"Route extends outside the jurisdiction boundary. Please adjust your route points."}}))}const{dismissMessagesByPattern:c}=kw.getState();c(/jurisdiction boundary|outside.*boundary/i,"error");const A=t(),h=A.individualRoute.generatedRoute?.type||"individual",p={id:`temp_route_${Date.now()}`,name:`Individual Route ${Date.now()}`,projectId:o,type:h,source:"individual_drawing",origin:l.coordinates,destination:u.coordinates,waypoints:d.map(e=>e.coordinates),encodedPolyline:n.encodedPolyline,distance:n.distance||0,duration:n.duration||0,status:"unsynced",createdAt:(new Date).toISOString(),updatedAt:(new Date).toISOString(),roads:[],isSegmented:!1,segmentCount:0,color:"#2196F3",opacity:1,strokeWidth:4};a(p),s(!1),e(e=>({routeGeneration:{...e.routeGeneration,isGenerating:!1}}))},onError:t=>{const n=t instanceof Error?t.message:"Failed to generate route. Please try again.";Pw(n),s(!1),e(e=>({routeGeneration:{...e.routeGeneration,isGenerating:!1,lastGeneratedRouteKey:""},individualRoute:{...e.individualRoute,validationError:n}}))}}))}}}}),Nw=(e,t)=>({polygonDrawing:{isDrawing:!1,points:[],completedPolygon:null,selectedRoads:[],confirmed:!1},lassoDrawing:{isDrawing:!1,points:[],completedPolygon:null,selectedRoads:[],confirmed:!1},savedPolygons:[],terraDrawUndo:void 0,terraDrawRedo:void 0,terraDrawFinish:void 0,terraDrawInstance:null,setTerraDrawInstance:t=>{e(()=>({terraDrawInstance:t}))},startPolygonDrawing:()=>{const t={isDrawing:!0,points:[],completedPolygon:null,selectedRoads:[],confirmed:!1};e(()=>({polygonDrawing:t,lassoDrawing:t}))},addPolygonPoint:t=>{e(e=>{const n={...e.polygonDrawing,points:[...e.polygonDrawing.points,t]};return{polygonDrawing:n,lassoDrawing:n}})},completePolygon:()=>{const{polygonDrawing:n}=t();if(n.points.length>=3){const t=n.points,r={type:"Polygon",coordinates:[t.length>0&&t[0][0]===t[t.length-1][0]&&t[0][1]===t[t.length-1][1]?t:[...t,t[0]]]};e(e=>{const t={...e.polygonDrawing,isDrawing:!1,completedPolygon:r};return{polygonDrawing:t,lassoDrawing:t}})}},clearPolygon:()=>{const t={isDrawing:!1,points:[],completedPolygon:null,selectedRoads:[],confirmed:!1};e(()=>({polygonDrawing:t,lassoDrawing:t}))},finishPolygonDrawing:()=>{const{polygonDrawing:n}=t();if(n.points.length>=3){const t=n.points,r={type:"Polygon",coordinates:[t.length>0&&t[0][0]===t[t.length-1][0]&&t[0][1]===t[t.length-1][1]?t:[...t,t[0]]]};e(e=>{const t={...e.polygonDrawing,isDrawing:!1,completedPolygon:r};return{polygonDrawing:t,lassoDrawing:t}})}},isPolygonComplete:()=>{const{polygonDrawing:e}=t();return e.points.length>=3},syncPolygonPointsFromTerraDraw:t=>{e(e=>{const n=t.length>=3?{type:"Polygon",coordinates:[t[0][0]===t[t.length-1][0]&&t[0][1]===t[t.length-1][1]?t:[...t,t[0]]]}:null,r={...e.polygonDrawing,points:t,completedPolygon:n};return{polygonDrawing:r,lassoDrawing:r}})},startLassoDrawing:()=>{const t={isDrawing:!0,points:[],completedPolygon:null,selectedRoads:[],confirmed:!1};e(()=>({polygonDrawing:t,lassoDrawing:t}))},setLassoPoints:t=>{e(e=>{const n={...e.polygonDrawing,points:t,completedPolygon:null};return{polygonDrawing:n,lassoDrawing:n}})},finishLassoDrawing:()=>{const{polygonDrawing:n}=t();if(n.points.length>=3){const t=n.points,r={type:"Polygon",coordinates:[t.length>0&&t[0][0]===t[t.length-1][0]&&t[0][1]===t[t.length-1][1]?t:[...t,t[0]]]};e(e=>{const t={...e.polygonDrawing,isDrawing:!1,completedPolygon:r,confirmed:!1};return{polygonDrawing:t,lassoDrawing:t}})}},setLassoSelectedRoads:t=>{e(e=>{const n={...e.polygonDrawing,selectedRoads:t};return{polygonDrawing:n,lassoDrawing:n}})},confirmLassoDrawing:()=>{e(e=>({lassoDrawing:{...e.lassoDrawing,confirmed:!0}}))},clearLassoDrawing:()=>{const t={isDrawing:!1,points:[],completedPolygon:null,selectedRoads:[],confirmed:!1};e(()=>({polygonDrawing:t,lassoDrawing:t}))},isLassoComplete:()=>{const{polygonDrawing:e}=t();return e.points.length>=3},clearPolygonDrawing:()=>{const t={isDrawing:!1,points:[],completedPolygon:null,selectedRoads:[],confirmed:!1};e(()=>({polygonDrawing:t,lassoDrawing:t}))},isNearStartPoint:!1,setIsNearStartPoint:t=>{e({isNearStartPoint:t})}});function jw(e,t,n=7){const r=Math.pow(10,n);return Math.round(e[0]*r)===Math.round(t[0]*r)&&Math.round(e[1]*r)===Math.round(t[1]*r)}function Qw(e,t,n){const r=n.features.find(t=>t.properties.road_id===e);if(!r)return{canAdd:!1,position:null};const o=t.properties.start_point,i=t.properties.end_point,s=r.properties.start_point;return jw(r.properties.end_point,o)?{canAdd:!0,position:"front"}:jw(s,i)?{canAdd:!0,position:"back"}:{canAdd:!1,position:null}}function zw(e){const t=e.coordinates;if(t.length<3)return[];const n=t.slice(1,-1);if(n.length<=25)return n.map(e=>({lat:e[1],lng:e[0]}));const r=Math.ceil(n.length/25),o=[];for(let i=0;i<n.length&&(o.push(n[i]),!(o.length>=25));i+=r);return o.map(e=>({lat:e[1],lng:e[0]}))}const Hw=()=>"undefined"!=typeof window&&window.GOOGLE_API_KEY?window.GOOGLE_API_KEY:"",Gw=Hw(),Vw={generateRoute:async(e,t,n=[],r)=>{try{if(r?.aborted)return{success:!1,data:null,message:"Request was aborted"};const i={origin:{location:{latLng:{latitude:e.lat,longitude:e.lng}}},destination:{location:{latLng:{latitude:t.lat,longitude:t.lng}}},travelMode:"DRIVE",extraComputations:["TRAFFIC_ON_POLYLINE"],requestedReferenceRoutes:["SHORTER_DISTANCE"],routingPreference:"TRAFFIC_AWARE_OPTIMAL",routeModifiers:{avoidFerries:!0,vehicleInfo:{emissionType:"GASOLINE"}},languageCode:"en-US"};n&&n.length>0&&(i.intermediates=n.map(e=>({location:{latLng:{latitude:e.lat,longitude:e.lng}}})));const s=await fetch("https://routes.googleapis.com/directions/v2:computeRoutes",{method:"POST",headers:{"X-Goog-FieldMask":"routes.polyline,routes.distanceMeters,routes.duration","X-Goog-Api-Key":Gw,"Content-Type":"application/json"},body:JSON.stringify(i),signal:r});if(r?.aborted)return{success:!1,data:null,message:"Request was aborted"};if(!s.ok){await s.text();return{success:!1,data:null,message:"An error occurred while generating the route. Please try again."}}let a;try{a=await s.json()}catch(o){return{success:!1,data:null,message:"An error occurred while generating the route. Please try again."}}if(r?.aborted)return{success:!1,data:null,message:"Request was aborted"};if(!a.routes||0===a.routes.length)return{success:!1,data:null,message:"No routes found"};const l=a.routes.length>=2?1:0,c=a.routes[l],u=c.polyline?.encodedPolyline||"";if(!u||""===u.trim())return{success:!1,data:null,message:"No routes found between these points. Please select different points."};const d=c.distanceMeters;return{success:!0,data:{encodedPolyline:u,distance:d/1e3,duration:(c.duration?parseInt(c.duration.replace("s","")):0)/60},message:"Route generated successfully"}}catch(i){return i instanceof Error&&"AbortError"===i.name?{success:!1,data:null,message:"Request was aborted"}:{success:!1,data:null,message:"An error occurred while generating the route. Please try again."}}}};function Ww(e){return 1===e?"Route":`Route (${e} roads)`}function $w(e){return e&&""!==e.trim()?`Stretched Route - ${e}`:"Stretched Route"}const Kw=(e,t)=>({roadImport:{importedRoads:null,importedPolygon:null,panelRoutes:[],hoveredRoadId:null,selectionMode:null,pendingModeSwitch:null,lassoFilteredRoadIds:null,lassoSelectedPriorities:null,multiSelectTempSelection:[],multiSelectValidationResult:null,multiSelectValidating:!1,routeInMaking:null,routeInMakingRoadIds:[]},setImportedRoads:(n,r)=>{!t().roadImport.importedRoads&&$N.temporal.getState().clear(),e(e=>({roadImport:{...e.roadImport,importedRoads:n,importedPolygon:r}}))},toggleSelectedRoad:t=>{e(e=>{if(!e.roadImport.importedRoads)return e;const n=e.roadImport.panelRoutes.findIndex(e=>e.roadIds.includes(t));if(n>=0){const t=e.roadImport.panelRoutes.filter((e,t)=>t!==n);return{roadImport:{...e.roadImport,panelRoutes:t}}}{const n=e.roadImport.importedRoads.features.find(e=>e.properties?.road_id?.toString()===t);if(!n||"LineString"!==n.geometry.type)return e;const r={id:`route-${Date.now()}-${Math.random().toString(36).substr(2,9)}`,name:n.properties?.name||`Route ${t}`,roadIds:[t],geometry:n.geometry,priority:n.properties?.priority,distance:n.properties?.length||0};return{roadImport:{...e.roadImport,panelRoutes:[...e.roadImport.panelRoutes,r]}}}})},removeRouteFromPanel:t=>{e(e=>{const n=e.roadImport.panelRoutes.find(e=>e.id===t),r=n?.roadIds||[],o=e.roadImport.panelRoutes.filter(e=>e.id!==t);let i=e.roadImport.importedRoads;return i&&r.length>0&&(i={...i,features:i.features.filter(e=>{const t=e.properties?.road_id?.toString()||"";if(!r.includes(t))return!0;return!(!0===e.properties?.isStretched||!0===e.properties?.isMultiSelected)})}),{roadImport:{...e.roadImport,panelRoutes:o,importedRoads:i}}})},updateRouteName:(t,n)=>{e(e=>({roadImport:{...e.roadImport,panelRoutes:e.roadImport.panelRoutes.map(e=>e.id===t?{...e,name:n}:e)}}))},setHoveredRoadId:t=>{e(e=>({roadImport:{...e.roadImport,hoveredRoadId:t}}))},setSelectionMode:n=>{t().roadImport.selectionMode;const r=$N.temporal.getState();e(e=>{const t="multi-select"!==n&&(e.roadImport.multiSelectTempSelection.length>0||null!==e.roadImport.routeInMaking);return{roadImport:{...e.roadImport,selectionMode:n,...t&&{multiSelectTempSelection:[],multiSelectValidationResult:null,multiSelectValidating:!1,routeInMaking:null,routeInMakingRoadIds:[]}}}}),setTimeout(()=>{const e=$N.temporal.getState();e.pastStates.length!==r.pastStates.length||(e.futureStates.length,r.futureStates.length)},0)},clearRoadImport:()=>{e(()=>({roadImport:{importedRoads:null,importedPolygon:null,panelRoutes:[],hoveredRoadId:null,selectionMode:null,pendingModeSwitch:null,lassoFilteredRoadIds:null,lassoSelectedPriorities:null,multiSelectTempSelection:[],multiSelectValidationResult:null,multiSelectValidating:!1,routeInMaking:null,routeInMakingRoadIds:[]}}))},setPendingModeSwitch:t=>{e(e=>({roadImport:{...e.roadImport,pendingModeSwitch:t}}))},setLassoFilteredRoads:t=>{e(e=>({roadImport:{...e.roadImport,lassoFilteredRoadIds:t}}))},setLassoSelectedPriorities:t=>{e(e=>({roadImport:{...e.roadImport,lassoSelectedPriorities:t}}))},addLassoFilteredRoadsToPanel:()=>{e(e=>{if(!e.roadImport.importedRoads||!e.roadImport.lassoFilteredRoadIds||0===e.roadImport.lassoFilteredRoadIds.length)return e;const t=[];for(const n of e.roadImport.lassoFilteredRoadIds){if(e.roadImport.panelRoutes.some(e=>e.roadIds.includes(n)))continue;const r=e.roadImport.importedRoads.features.find(e=>e.properties?.road_id?.toString()===n);if(!r||"LineString"!==r.geometry.type)continue;const o={id:`route-${Date.now()}-${n}-${Math.random().toString(36).substr(2,9)}`,name:r.properties?.name||`Route ${n}`,roadIds:[n],geometry:r.geometry,priority:r.properties?.priority,distance:r.properties?.length||0};t.push(o)}return{roadImport:{...e.roadImport,panelRoutes:[...e.roadImport.panelRoutes,...t],lassoFilteredRoadIds:null}}})},clearLassoFilteredRoads:()=>{e(e=>({roadImport:{...e.roadImport,lassoFilteredRoadIds:null,lassoSelectedPriorities:null}}))},addRoadToMultiSelect:t=>{e(e=>e.roadImport.multiSelectTempSelection.includes(t)?e:{roadImport:{...e.roadImport,multiSelectTempSelection:[...e.roadImport.multiSelectTempSelection,t]}})},removeRoadFromMultiSelect:t=>{e(e=>({roadImport:{...e.roadImport,multiSelectTempSelection:e.roadImport.multiSelectTempSelection.filter(e=>e!==t),multiSelectValidationResult:null}}))},clearMultiSelectTemp:()=>{e(e=>({roadImport:{...e.roadImport,multiSelectTempSelection:[],multiSelectValidationResult:null,multiSelectValidating:!1,routeInMaking:null,routeInMakingRoadIds:[]}}))},setMultiSelectValidationResult:t=>{e(e=>({roadImport:{...e.roadImport,multiSelectValidationResult:t,multiSelectValidating:!1}}))},setMultiSelectValidating:t=>{e(e=>({roadImport:{...e.roadImport,multiSelectValidating:t}}))},combineMultiSelectRoadsToRoute:async()=>{const n=t(),{roadImport:r}=n;if(!r.importedRoads||0===r.multiSelectTempSelection.length)throw new Error("No roads selected for combination");const o=r.multiSelectTempSelection.map(e=>{const t=r.importedRoads.features.find(t=>t.properties?.road_id?.toString()===e);return t&&"LineString"===t.geometry.type?{id:e,linestringGeoJson:t.geometry,distanceKm:t.properties?.length||0,priority:t.properties?.priority}:null}).filter(e=>null!==e);if(0===o.length)throw new Error("No valid roads found for combination");if(!JN.getState().projectId)throw new Error("Project ID not available");const i=await async function(e){if(0===e.length)throw new Error("Cannot combine empty roads array");if(1===e.length){const t=e[0];return{id:`route-${Date.now()}-${Math.random().toString(36).substr(2,9)}`,name:Ww(1),roadIds:[t.id],geometry:t.linestringGeoJson,priority:t.priority,distance:t.distanceKm||0}}const t=e[0].linestringGeoJson.coordinates;if(!t||0===t.length)throw new Error("First road has no coordinates");const n={lat:t[0][1],lng:t[0][0]},r=e[e.length-1].linestringGeoJson.coordinates;if(!r||0===r.length)throw new Error("Last road has no coordinates");const o={lat:r[r.length-1][1],lng:r[r.length-1][0]},i=[];for(let u=0;u<e.length-1&&!(i.length>=25);u++){const t=e[u].linestringGeoJson.coordinates;if(t&&t.length>0){const e=t[t.length-1];i.push({lat:e[1],lng:e[0]})}}const s=await Vw.generateRoute(n,o,i);if(!s.success||!s.data)throw new Error(s.message||"Failed to generate route from Google Routes API");const a=Sw(s.data.encodedPolyline);if(!a||"LineString"!==a.type)throw new Error("Failed to decode route polyline");const l=e.reduce((e,t)=>e+(t.distanceKm||0),0)||s.data.distance,c=e[0]?.priority;return{id:`route-${Date.now()}-${Math.random().toString(36).substr(2,9)}`,name:Ww(e.length),roadIds:e.map(e=>e.id),geometry:a,priority:c,distance:l}}(o);e(e=>({roadImport:{...e.roadImport,panelRoutes:[...e.roadImport.panelRoutes,i],multiSelectTempSelection:[],multiSelectValidationResult:null,multiSelectValidating:!1}}))},initializeRouteInMaking:t=>{e(e=>{if(!e.roadImport.importedRoads)return e;const n=e.roadImport.importedRoads.features.find(e=>e.properties.road_id===t);return n&&"LineString"===n.geometry.type?{roadImport:{...e.roadImport,routeInMaking:n,routeInMakingRoadIds:[t]}}:e})},addRoadToRouteInMaking:(t,n)=>{e(e=>{if(!e.roadImport.importedRoads||!e.roadImport.routeInMaking)return e;const r=e.roadImport.importedRoads.features.find(e=>e.properties.road_id===t);if(!r||"LineString"!==r.geometry.type)return e;const o=function(e,t,n){const r=e.geometry.coordinates,o=t.geometry.coordinates,i=e.properties.start_point,s=e.properties.end_point,a=t.properties.start_point,l=t.properties.end_point;let c,u,d;if("front"===n){const e=jw(l,i),t=jw(a,i);e?(c=[...o,...r.slice(1)],u=a):t?(c=[...o.slice().reverse(),...r.slice(1)],u=l):(c=[...o,...r.slice(1)],u=a),d=s}else{const e=jw(a,s),t=jw(l,s);if(e)c=[...r,...o.slice(1)],d=l;else if(t){const e=o.slice().reverse();c=[...r,...e.slice(1)],d=a}else c=[...r,...o.slice(1)],d=l;u=i}return{type:"Feature",geometry:{type:"LineString",coordinates:c},properties:{...e.properties,road_id:`${e.properties.road_id}-${t.properties.road_id}`,start_point:u,end_point:d,length:e.properties.length+t.properties.length,isInRouteInMaking:!0}}}(e.roadImport.routeInMaking,r,n),i="front"===n?[t,...e.roadImport.routeInMakingRoadIds]:[...e.roadImport.routeInMakingRoadIds,t];return{roadImport:{...e.roadImport,routeInMaking:o,routeInMakingRoadIds:i}}})},clearRouteInMaking:()=>{e(e=>({roadImport:{...e.roadImport,routeInMaking:null,routeInMakingRoadIds:[]}}))},saveRouteInMaking:()=>{e(e=>{if(!e.roadImport.routeInMaking)return e;const t=`multi-${Date.now()}-${Math.random().toString(36).substr(2,9)}`,n=Ww(e.roadImport.routeInMakingRoadIds.length)||e.roadImport.routeInMaking.properties.name||"Multi-select Route",r=e.roadImport.routeInMaking.properties.start_point||e.roadImport.routeInMaking.geometry.coordinates[0],o=e.roadImport.routeInMaking.properties.end_point||(()=>{const t=e.roadImport.routeInMaking.geometry.coordinates;return t[t.length-1]})(),i={type:"Feature",geometry:e.roadImport.routeInMaking.geometry,properties:{road_id:t,name:n,length:e.roadImport.routeInMaking.properties.length||0,priority:e.roadImport.routeInMaking.properties.priority,start_point:r,end_point:o,isMultiSelected:!0}},s={id:`route-${Date.now()}-${Math.random().toString(36).substr(2,9)}`,name:n,roadIds:[t],geometry:e.roadImport.routeInMaking.geometry,priority:e.roadImport.routeInMaking.properties.priority,distance:e.roadImport.routeInMaking.properties.length||0},a=e.roadImport.importedRoads,l=a?{...a,features:[...a.features,i]}:null;return{roadImport:{...e.roadImport,importedRoads:l,panelRoutes:[...e.roadImport.panelRoutes,s],routeInMaking:null,routeInMakingRoadIds:[]}}}),$N.temporal.getState().clear()}});function Xw(e,t){if(!e)throw new Error(t||"loader assertion failed.")}const Yw=Boolean("object"!=typeof process||"[object process]"!==String(process)||process.browser),qw="undefined"!=typeof process&&process.version&&/v([0-9]*)/.exec(process.version);qw&&parseFloat(qw[1]);const Jw=globalThis,Zw=globalThis.process||{},ex=globalThis.navigator||{};function tx(e){if("undefined"!=typeof window&&"renderer"===window.process?.type)return!0;if("undefined"!=typeof process&&Boolean(process.versions?.electron))return!0;const t="undefined"!=typeof navigator&&navigator.userAgent;return Boolean(t&&t.indexOf("Electron")>=0)}function nx(){return!("object"==typeof process&&"[object process]"===String(process)&&!process?.browser)||tx()}const rx="4.1.0";class ox{constructor(e,t,n="sessionStorage"){this.storage=function(e){try{const t=window[e],n="__storage_test__";return t.setItem(n,n),t.removeItem(n),t}catch(hee){return null}}(n),this.id=e,this.config=t,this._loadConfiguration()}getConfiguration(){return this.config}setConfiguration(e){if(Object.assign(this.config,e),this.storage){const e=JSON.stringify(this.config);this.storage.setItem(this.id,e)}}_loadConfiguration(){let e={};if(this.storage){const t=this.storage.getItem(this.id);e=t?JSON.parse(t):{}}return Object.assign(this.config,e),this}}var ix,sx;(sx=ix||(ix={}))[sx.BLACK=30]="BLACK",sx[sx.RED=31]="RED",sx[sx.GREEN=32]="GREEN",sx[sx.YELLOW=33]="YELLOW",sx[sx.BLUE=34]="BLUE",sx[sx.MAGENTA=35]="MAGENTA",sx[sx.CYAN=36]="CYAN",sx[sx.WHITE=37]="WHITE",sx[sx.BRIGHT_BLACK=90]="BRIGHT_BLACK",sx[sx.BRIGHT_RED=91]="BRIGHT_RED",sx[sx.BRIGHT_GREEN=92]="BRIGHT_GREEN",sx[sx.BRIGHT_YELLOW=93]="BRIGHT_YELLOW",sx[sx.BRIGHT_BLUE=94]="BRIGHT_BLUE",sx[sx.BRIGHT_MAGENTA=95]="BRIGHT_MAGENTA",sx[sx.BRIGHT_CYAN=96]="BRIGHT_CYAN",sx[sx.BRIGHT_WHITE=97]="BRIGHT_WHITE";function ax(e){return"string"!=typeof e?e:(e=e.toUpperCase(),ix[e]||ix.WHITE)}function lx(e,t){if(!e)throw new Error("Assertion failed")}function cx(){let e;if(nx()&&Jw.performance)e=Jw?.performance?.now?.();else if("hrtime"in Zw){const t=Zw?.hrtime?.();e=1e3*t[0]+t[1]/1e6}else e=Date.now();return e}const ux={debug:nx()&&console.debug||console.log,log:console.log,info:console.info,warn:console.warn,error:console.error},dx={enabled:!0,level:0};function Ax(){}const hx={},px={once:!0};class fx{constructor({id:e}={id:""}){this.VERSION=rx,this._startTs=cx(),this._deltaTs=cx(),this.userData={},this.LOG_THROTTLE_TIMEOUT=0,this.id=e,this.userData={},this._storage=new ox(`__probe-${this.id}__`,dx),this.timeStamp(`${this.id} started`),function(e,t=["constructor"]){const n=Object.getPrototypeOf(e),r=Object.getOwnPropertyNames(n),o=e;for(const i of r){const n=o[i];"function"==typeof n&&(t.find(e=>i===e)||(o[i]=n.bind(e)))}}(this),Object.seal(this)}set level(e){this.setLevel(e)}get level(){return this.getLevel()}isEnabled(){return this._storage.config.enabled}getLevel(){return this._storage.config.level}getTotal(){return Number((cx()-this._startTs).toPrecision(10))}getDelta(){return Number((cx()-this._deltaTs).toPrecision(10))}set priority(e){this.level=e}get priority(){return this.level}getPriority(){return this.level}enable(e=!0){return this._storage.setConfiguration({enabled:e}),this}setLevel(e){return this._storage.setConfiguration({level:e}),this}get(e){return this._storage.config[e]}set(e,t){this._storage.setConfiguration({[e]:t})}settings(){console.table}assert(e,t){if(!e)throw new Error(t||"Assertion failed")}warn(e){return this._getLogFunction(0,e,ux.warn,arguments,px)}error(e){return this._getLogFunction(0,e,ux.error,arguments)}deprecated(e,t){return this.warn(`\`${e}\` is deprecated and will be removed in a later version. Use \`${t}\` instead`)}removed(e,t){return this.error(`\`${e}\` has been removed. Use \`${t}\` instead`)}probe(e,t){return this._getLogFunction(e,t,ux.log,arguments,{time:!0,once:!0})}log(e,t){return this._getLogFunction(e,t,ux.debug,arguments)}info(e,t){return this._getLogFunction(e,t,console.info,arguments)}once(e,t){return this._getLogFunction(e,t,ux.debug||ux.info,arguments,px)}table(e,t,n){return t?this._getLogFunction(e,t,console.table||Ax,n&&[n],{tag:yx(t)}):Ax}time(e,t){return this._getLogFunction(e,t,console.time?console.time:console.info)}timeEnd(e,t){return this._getLogFunction(e,t,console.timeEnd?console.timeEnd:console.info)}timeStamp(e,t){return this._getLogFunction(e,t,console.timeStamp||Ax)}group(e,t,n={collapsed:!1}){const r=mx({logLevel:e,message:t,opts:n}),{collapsed:o}=n;return r.method=(o?console.groupCollapsed:console.group)||console.info,this._getLogFunction(r)}groupCollapsed(e,t,n={}){return this.group(e,t,Object.assign({},n,{collapsed:!0}))}groupEnd(e){return this._getLogFunction(e,"",console.groupEnd||Ax)}withGroup(e,t,n){this.group(e,t)();try{n()}finally{this.groupEnd(e)()}}trace(){console.trace}_shouldLog(e){return this.isEnabled()&&this.getLevel()>=gx(e)}_getLogFunction(e,t,n,r,o){if(this._shouldLog(e)){o=mx({logLevel:e,message:t,args:r,opts:o}),lx(n=n||o.method),o.total=this.getTotal(),o.delta=this.getDelta(),this._deltaTs=cx();const i=o.tag||o.message;if(o.once&&i){if(hx[i])return Ax;hx[i]=cx()}return t=function(e,t,n){if("string"==typeof t){const r=n.time?function(e,t=8){const n=Math.max(t-e.length,0);return`${" ".repeat(n)}${e}`}(function(e){let t;return t=e<10?`${e.toFixed(2)}ms`:e<100?`${e.toFixed(1)}ms`:e<1e3?`${e.toFixed(0)}ms`:`${(e/1e3).toFixed(2)}s`,t}(n.total)):"";t=function(e,t,n){nx||"string"!=typeof e||(t&&(e=`[${ax(t)}m${e}[39m`),n&&(e=`[${ax(n)+10}m${e}[49m`));return e}(t=n.time?`${e}: ${r}  ${t}`:`${e}: ${t}`,n.color,n.background)}return t}(this.id,o.message,o),n.bind(console,t,...o.args)}return Ax}}function gx(e){if(!e)return 0;let t;switch(typeof e){case"number":t=e;break;case"object":t=e.logLevel||e.priority||0;break;default:return 0}return lx(Number.isFinite(t)&&t>=0),t}function mx(e){const{logLevel:t,message:n}=e;e.logLevel=gx(t);const r=e.args?Array.from(e.args):[];for(;r.length&&r.shift()!==n;);switch(typeof t){case"string":case"function":void 0!==n&&r.unshift(n),e.message=t;break;case"object":Object.assign(e,t)}"function"==typeof e.message&&(e.message=e.message());const o=typeof e.message;return lx("string"===o||"object"===o),Object.assign(e,{args:r},e.opts)}function yx(e){for(const t in e)for(const n in e[t])return n||"untitled";return"empty"}fx.VERSION=rx;const vx="4.3.3",bx=vx[0]>="0"&&vx[0]<="9"?`v${vx}`:"";const wx=function(){const e=new fx({id:"loaders.gl"});return globalThis.loaders=globalThis.loaders||{},globalThis.loaders.log=e,globalThis.loaders.version=bx,globalThis.probe=globalThis.probe||{},globalThis.probe.loaders=e,e}();function xx(e,t){return _x(e||{},t)}function _x(e,t,n=0){if(n>3)return t;const r={...e};for(const[o,i]of Object.entries(t))i&&"object"==typeof i&&!Array.isArray(i)?r[o]=_x(r[o]||{},t[o],n+1):r[o]=t[o];return r}globalThis._loadersgl_?.version||(globalThis._loadersgl_=globalThis._loadersgl_||{},globalThis._loadersgl_.version="4.3.3"),globalThis._loadersgl_.version;function Cx(e,t){if(!e)throw new Error(t||"loaders.gl assertion failed.")}const Sx="object"!=typeof process||"[object process]"!==String(process)||process.browser,Ex="undefined"!=typeof window&&void 0!==window.orientation,Bx="undefined"!=typeof process&&process.version&&/v([0-9]*)/.exec(process.version);Bx&&parseFloat(Bx[1]);class Ix{name;workerThread;isRunning=!0;result;_resolve=()=>{};_reject=()=>{};constructor(e,t){this.name=e,this.workerThread=t,this.result=new Promise((e,t)=>{this._resolve=e,this._reject=t})}postMessage(e,t){this.workerThread.postMessage({source:"loaders.gl",type:e,payload:t})}done(e){Cx(this.isRunning),this.isRunning=!1,this._resolve(e)}error(e){Cx(this.isRunning),this.isRunning=!1,this._reject(e)}}class Rx{terminate(){}}const kx=new Map;function Tx(e){Cx(e.source&&!e.url||!e.source&&e.url);let t=kx.get(e.source||e.url);return t||(e.url&&(t=function(e){if(!e.startsWith("http"))return e;return Px((t=e,`try {\n  importScripts('${t}');\n} catch (error) {\n  console.error(error);\n  throw error;\n}`));var t}(e.url),kx.set(e.url,t)),e.source&&(t=Px(e.source),kx.set(e.source,t))),Cx(t),t}function Px(e){const t=new Blob([e],{type:"application/javascript"});return URL.createObjectURL(t)}function Fx(e,t=!0,n){const r=n||new Set;if(e){if(Mx(e))r.add(e);else if(Mx(e.buffer))r.add(e.buffer);else if(ArrayBuffer.isView(e));else if(t&&"object"==typeof e)for(const o in e)Fx(e[o],t,r)}else;return void 0===n?Array.from(r):[]}function Mx(e){return!!e&&(e instanceof ArrayBuffer||("undefined"!=typeof MessagePort&&e instanceof MessagePort||("undefined"!=typeof ImageBitmap&&e instanceof ImageBitmap||"undefined"!=typeof OffscreenCanvas&&e instanceof OffscreenCanvas)))}const Lx=()=>{};class Ux{name;source;url;terminated=!1;worker;onMessage;onError;_loadableURL="";static isSupported(){return"undefined"!=typeof Worker&&Sx||void 0!==Rx&&!Sx}constructor(e){const{name:t,source:n,url:r}=e;Cx(n||r),this.name=t,this.source=n,this.url=r,this.onMessage=Lx,this.onError=e=>{},this.worker=Sx?this._createBrowserWorker():this._createNodeWorker()}destroy(){this.onMessage=Lx,this.onError=Lx,this.worker.terminate(),this.terminated=!0}get isRunning(){return Boolean(this.onMessage)}postMessage(e,t){t=t||Fx(e),this.worker.postMessage(e,t)}_getErrorFromErrorEvent(e){let t="Failed to load ";return t+=`worker ${this.name} from ${this.url}. `,e.message&&(t+=`${e.message} in `),e.lineno&&(t+=`:${e.lineno}:${e.colno}`),new Error(t)}_createBrowserWorker(){this._loadableURL=Tx({source:this.source,url:this.url});const e=new Worker(this._loadableURL,{name:this.name});return e.onmessage=e=>{e.data?this.onMessage(e.data):this.onError(new Error("No data received"))},e.onerror=e=>{this.onError(this._getErrorFromErrorEvent(e)),this.terminated=!0},e.onmessageerror=e=>{},e}_createNodeWorker(){let e;if(this.url){const t=this.url.includes(":/")||this.url.startsWith("/")?this.url:`./${this.url}`;e=new Rx(t,{eval:!1})}else{if(!this.source)throw new Error("no worker");e=new Rx(this.source,{eval:!0})}return e.on("message",e=>{this.onMessage(e)}),e.on("error",e=>{this.onError(e)}),e.on("exit",e=>{}),e}}class Ox{name="unnamed";source;url;maxConcurrency=1;maxMobileConcurrency=1;onDebug=()=>{};reuseWorkers=!0;props={};jobQueue=[];idleQueue=[];count=0;isDestroyed=!1;static isSupported(){return Ux.isSupported()}constructor(e){this.source=e.source,this.url=e.url,this.setProps(e)}destroy(){this.idleQueue.forEach(e=>e.destroy()),this.isDestroyed=!0}setProps(e){this.props={...this.props,...e},void 0!==e.name&&(this.name=e.name),void 0!==e.maxConcurrency&&(this.maxConcurrency=e.maxConcurrency),void 0!==e.maxMobileConcurrency&&(this.maxMobileConcurrency=e.maxMobileConcurrency),void 0!==e.reuseWorkers&&(this.reuseWorkers=e.reuseWorkers),void 0!==e.onDebug&&(this.onDebug=e.onDebug)}async startJob(e,t=(e,t,n)=>e.done(n),n=(e,t)=>e.error(t)){const r=new Promise(r=>(this.jobQueue.push({name:e,onMessage:t,onError:n,onStart:r}),this));return this._startQueuedJob(),await r}async _startQueuedJob(){if(!this.jobQueue.length)return;const e=this._getAvailableWorker();if(!e)return;const t=this.jobQueue.shift();if(t){this.onDebug({message:"Starting job",name:t.name,workerThread:e,backlog:this.jobQueue.length});const r=new Ix(t.name,e);e.onMessage=e=>t.onMessage(r,e.type,e.payload),e.onError=e=>t.onError(r,e),t.onStart(r);try{await r.result}catch(n){}finally{this.returnWorkerToQueue(e)}}}returnWorkerToQueue(e){!Sx||this.isDestroyed||!this.reuseWorkers||this.count>this._getMaxConcurrency()?(e.destroy(),this.count--):this.idleQueue.push(e),this.isDestroyed||this._startQueuedJob()}_getAvailableWorker(){if(this.idleQueue.length>0)return this.idleQueue.shift()||null;if(this.count<this._getMaxConcurrency()){this.count++;const e=`${this.name.toLowerCase()} (#${this.count} of ${this.maxConcurrency})`;return new Ux({name:e,source:this.source,url:this.url})}return null}_getMaxConcurrency(){return Ex?this.maxMobileConcurrency:this.maxConcurrency}}const Dx={maxConcurrency:3,maxMobileConcurrency:1,reuseWorkers:!0,onDebug:()=>{}};class Nx{props;workerPools=new Map;static _workerFarm;static isSupported(){return Ux.isSupported()}static getWorkerFarm(e={}){return Nx._workerFarm=Nx._workerFarm||new Nx({}),Nx._workerFarm.setProps(e),Nx._workerFarm}constructor(e){this.props={...Dx},this.setProps(e),this.workerPools=new Map}destroy(){for(const e of this.workerPools.values())e.destroy();this.workerPools=new Map}setProps(e){this.props={...this.props,...e};for(const t of this.workerPools.values())t.setProps(this._getWorkerPoolProps())}getWorkerPool(e){const{name:t,source:n,url:r}=e;let o=this.workerPools.get(t);return o||(o=new Ox({name:t,source:n,url:r}),o.setProps(this._getWorkerPoolProps()),this.workerPools.set(t,o)),o}_getWorkerPoolProps(){return{maxConcurrency:this.props.maxConcurrency,maxMobileConcurrency:this.props.maxMobileConcurrency,reuseWorkers:this.props.reuseWorkers,onDebug:this.props.onDebug}}}async function jx(e,t,n,r,o){const i=e.id,s=function(e,t={}){const n=t[e.id]||{},r=Sx?`${e.id}-worker.js`:`${e.id}-worker-node.js`;let o=n.workerUrl;if(o||"compression"!==e.id||(o=t.workerUrl),"test"===t._workerType&&(o=Sx?`modules/${e.module}/dist/${r}`:`modules/${e.module}/src/workers/${e.id}-worker-node.ts`),!o){let t=e.version;"latest"===t&&(t="latest");const n=t?`@${t}`:"";o=`https://unpkg.com/@loaders.gl/${e.module}${n}/dist/${r}`}return Cx(o),o}(e,n),a=Nx.getWorkerFarm(n).getWorkerPool({name:i,url:s});n=JSON.parse(JSON.stringify(n)),r=JSON.parse(JSON.stringify(r||{}));const l=await a.startJob("process-on-worker",Qx.bind(null,o));l.postMessage("process",{input:t,options:n,context:r});const c=await l.result;return await c.result}async function Qx(e,t,n,r){switch(n){case"done":t.done(r);break;case"error":t.error(new Error(r.error));break;case"process":const{id:n,input:i,options:s}=r;try{const r=await e(i,s);t.postMessage("done",{id:n,result:r})}catch(o){const e=o instanceof Error?o.message:"unknown error";t.postMessage("error",{id:n,error:e})}}}function zx(...e){return function(e){const t=e.map(e=>e instanceof ArrayBuffer?new Uint8Array(e):e),n=t.reduce((e,t)=>e+t.byteLength,0),r=new Uint8Array(n);let o=0;for(const i of t)r.set(i,o),o+=i.byteLength;return r.buffer}(e)}function Hx(){let e;if("undefined"!=typeof window&&window.performance)e=window.performance.now();else if("undefined"!=typeof process&&process.hrtime){const t=process.hrtime();e=1e3*t[0]+t[1]/1e6}else e=Date.now();return e}class Gx{constructor(e,t){this.sampleSize=1,this.time=0,this.count=0,this.samples=0,this.lastTiming=0,this.lastSampleTime=0,this.lastSampleCount=0,this._count=0,this._time=0,this._samples=0,this._startTime=0,this._timerPending=!1,this.name=e,this.type=t,this.reset()}reset(){return this.time=0,this.count=0,this.samples=0,this.lastTiming=0,this.lastSampleTime=0,this.lastSampleCount=0,this._count=0,this._time=0,this._samples=0,this._startTime=0,this._timerPending=!1,this}setSampleSize(e){return this.sampleSize=e,this}incrementCount(){return this.addCount(1),this}decrementCount(){return this.subtractCount(1),this}addCount(e){return this._count+=e,this._samples++,this._checkSampling(),this}subtractCount(e){return this._count-=e,this._samples++,this._checkSampling(),this}addTime(e){return this._time+=e,this.lastTiming=e,this._samples++,this._checkSampling(),this}timeStart(){return this._startTime=Hx(),this._timerPending=!0,this}timeEnd(){return this._timerPending?(this.addTime(Hx()-this._startTime),this._timerPending=!1,this._checkSampling(),this):this}getSampleAverageCount(){return this.sampleSize>0?this.lastSampleCount/this.sampleSize:0}getSampleAverageTime(){return this.sampleSize>0?this.lastSampleTime/this.sampleSize:0}getSampleHz(){return this.lastSampleTime>0?this.sampleSize/(this.lastSampleTime/1e3):0}getAverageCount(){return this.samples>0?this.count/this.samples:0}getAverageTime(){return this.samples>0?this.time/this.samples:0}getHz(){return this.time>0?this.samples/(this.time/1e3):0}_checkSampling(){this._samples===this.sampleSize&&(this.lastSampleTime=this._time,this.lastSampleCount=this._count,this.count+=this._count,this.time+=this._time,this.samples+=this._samples,this._time=0,this._count=0,this._samples=0)}}class Vx{constructor(e){this.stats={},this.id=e.id,this.stats={},this._initializeStats(e.stats),Object.seal(this)}get(e,t="count"){return this._getOrCreate({name:e,type:t})}get size(){return Object.keys(this.stats).length}reset(){for(const e of Object.values(this.stats))e.reset();return this}forEach(e){for(const t of Object.values(this.stats))e(t)}getTable(){const e={};return this.forEach(t=>{e[t.name]={time:t.time||0,count:t.count||0,average:t.getAverageTime()||0,hz:t.getHz()||0}}),e}_initializeStats(e=[]){e.forEach(e=>this._getOrCreate(e))}_getOrCreate(e){const{name:t,type:n}=e;let r=this.stats[t];return r||(r=e instanceof Gx?e:new Gx(t,n),this.stats[t]=r),r}}const Wx={id:"request-scheduler",throttleRequests:!0,maxRequests:6,debounceTime:0};class $x{props;stats;activeRequestCount=0;requestQueue=[];requestMap=new Map;updateTimer=null;constructor(e={}){this.props={...Wx,...e},this.stats=new Vx({id:this.props.id}),this.stats.get("Queued Requests"),this.stats.get("Active Requests"),this.stats.get("Cancelled Requests"),this.stats.get("Queued Requests Ever"),this.stats.get("Active Requests Ever")}scheduleRequest(e,t=()=>0){if(!this.props.throttleRequests)return Promise.resolve({done:()=>{}});if(this.requestMap.has(e))return this.requestMap.get(e);const n={handle:e,priority:0,getPriority:t},r=new Promise(e=>(n.resolve=e,n));return this.requestQueue.push(n),this.requestMap.set(e,r),this._issueNewRequests(),r}_issueRequest(e){const{handle:t,resolve:n}=e;let r=!1;const o=()=>{r||(r=!0,this.requestMap.delete(t),this.activeRequestCount--,this._issueNewRequests())};return this.activeRequestCount++,n?n({done:o}):Promise.resolve({done:o})}_issueNewRequests(){null!==this.updateTimer&&clearTimeout(this.updateTimer),this.updateTimer=setTimeout(()=>this._issueNewRequestsAsync(),this.props.debounceTime)}_issueNewRequestsAsync(){null!==this.updateTimer&&clearTimeout(this.updateTimer),this.updateTimer=null;const e=Math.max(this.props.maxRequests-this.activeRequestCount,0);if(0!==e){this._updateAllRequests();for(let t=0;t<e;++t){const e=this.requestQueue.shift();e&&this._issueRequest(e)}}}_updateAllRequests(){const e=this.requestQueue;for(let t=0;t<e.length;++t){const n=e[t];this._updateRequest(n)||(e.splice(t,1),this.requestMap.delete(n.handle),t--)}e.sort((e,t)=>e.priority-t.priority)}_updateRequest(e){return e.priority=e.getPriority(e.handle),!(e.priority<0)||(e.resolve(null),!1)}}const Kx={};function Xx(e){if((t=e)&&"object"==typeof t&&t.isBuffer)return e;var t;if(e instanceof ArrayBuffer)return e;if(ArrayBuffer.isView(e))return 0===e.byteOffset&&e.byteLength===e.buffer.byteLength?e.buffer:e.buffer.slice(e.byteOffset,e.byteOffset+e.byteLength);if("string"==typeof e){const t=e;return(new TextEncoder).encode(t).buffer}if(e&&"object"==typeof e&&e._toArrayBuffer)return e._toArrayBuffer();throw new Error("toArrayBuffer")}function Yx(e){const t=e?e.lastIndexOf("/"):-1;return t>=0?e.substr(t+1):""}const qx=e=>"function"==typeof e,Jx=e=>null!==e&&"object"==typeof e,Zx=e=>Jx(e)&&e.constructor==={}.constructor,e_=e=>"undefined"!=typeof Response&&e instanceof Response||e&&e.arrayBuffer&&e.text&&e.json,t_=e=>"undefined"!=typeof Blob&&e instanceof Blob,n_=e=>(e=>"undefined"!=typeof ReadableStream&&e instanceof ReadableStream||Jx(e)&&qx(e.tee)&&qx(e.cancel)&&qx(e.getReader))(e)||(e=>Jx(e)&&qx(e.read)&&qx(e.pipe)&&(e=>"boolean"==typeof e)(e.readable))(e);class r_ extends Error{constructor(e,t){super(e),this.reason=t.reason,this.url=t.url,this.response=t.response}reason;url;response}const o_=/^data:([-\w.]+\/[-\w.+]+)(;|,)/,i_=/^([-\w.]+\/[-\w.+]+)/;function s_(e,t){return e.toLowerCase()===t.toLowerCase()}function a_(e){const t=o_.exec(e);return t?t[1]:""}const l_=/\?.*/;function c_(e){return e.replace(l_,"")}function u_(e){if(e_(e)){return e.url}if(t_(e)){return e.name||""}return"string"==typeof e?e:""}function d_(e){if(e_(e)){const t=e,n=t.headers.get("content-type")||"",r=c_(t.url);return function(e){const t=i_.exec(e);return t?t[1]:e}(n)||a_(r)}if(t_(e)){return e.type||""}return"string"==typeof e?a_(e):""}async function A_(e){if(e_(e))return e;const t={},n=function(e){if(e_(e))return e.headers["content-length"]||-1;if(t_(e))return e.size;return"string"==typeof e?e.length:e instanceof ArrayBuffer||ArrayBuffer.isView(e)?e.byteLength:-1}(e);n>=0&&(t["content-length"]=String(n));const r=u_(e),o=d_(e);o&&(t["content-type"]=o);const i=await async function(e){const t=5;if("string"==typeof e)return`data:,${e.slice(0,t)}`;if(e instanceof Blob){const t=e.slice(0,5);return await new Promise(e=>{const n=new FileReader;n.onload=t=>e(t?.target?.result),n.readAsDataURL(t)})}if(e instanceof ArrayBuffer){const n=function(e){let t="";const n=new Uint8Array(e);for(let r=0;r<n.byteLength;r++)t+=String.fromCharCode(n[r]);return btoa(t)}(e.slice(0,t));return`data:base64,${n}`}return null}(e);i&&(t["x-first-bytes"]=i),"string"==typeof e&&(e=(new TextEncoder).encode(e));const s=new Response(e,{headers:t});return Object.defineProperty(s,"url",{value:r}),s}async function h_(e){if(!e.ok){const t=await async function(e){const n=function(e){if(e.length<50)return e;const t=e.slice(e.length-15);return`${e.substr(0,32)}...${t}`}(e.url);let r=`Failed to fetch resource (${e.status}) ${e.statusText}: ${n}`;r=r.length>100?`${r.slice(0,100)}...`:r;const o={reason:e.statusText,url:e.url,response:e};try{const t=e.headers.get("Content-Type");o.reason=!e.bodyUsed&&t?.includes("application/json")?await e.json():await e.text()}catch(t){}return new r_(r,o)}(e);throw t}}async function p_(e,t){if("string"==typeof e){const n=function(e){for(const t in Kx)if(e.startsWith(t)){const n=Kx[t];e=e.replace(t,n)}return e.startsWith("http://")||e.startsWith("https://")||(e=`${e}`),e}(e);return function(e){return!function(e){return e.startsWith("http:")||e.startsWith("https:")}(e)&&!function(e){return e.startsWith("data:")}(e)}(n)&&globalThis.loaders?.fetchNode?globalThis.loaders?.fetchNode(n,t):await fetch(n,t)}return await A_(e)}const f_=new fx({id:"loaders.gl"});class g_{log(){return()=>{}}info(){return()=>{}}warn(){return()=>{}}error(){return()=>{}}}const m_={fetch:null,mimeType:void 0,nothrow:!1,log:new class{console;constructor(){this.console=console}log(...e){return this.console.log.bind(this.console,...e)}info(...e){return this.console.info.bind(this.console,...e)}warn(...e){return this.console.warn.bind(this.console,...e)}error(...e){return this.console.error.bind(this.console,...e)}},useLocalLibraries:!1,CDN:"https://unpkg.com/@loaders.gl",worker:!0,maxConcurrency:3,maxMobileConcurrency:1,reuseWorkers:Yw,_nodeWorkers:!1,_workerType:"",limit:0,_limitMB:0,batchSize:"auto",batchDebounceMs:0,metadata:!1,transforms:[]},y_={throws:"nothrow",dataType:"(no longer used)",uri:"baseUri",method:"fetch.method",headers:"fetch.headers",body:"fetch.body",mode:"fetch.mode",credentials:"fetch.credentials",cache:"fetch.cache",redirect:"fetch.redirect",referrer:"fetch.referrer",referrerPolicy:"fetch.referrerPolicy",integrity:"fetch.integrity",keepalive:"fetch.keepalive",signal:"fetch.signal"};function v_(){globalThis.loaders=globalThis.loaders||{};const{loaders:e}=globalThis;return e._state||(e._state={}),e._state}function b_(){const e=v_();return e.globalOptions=e.globalOptions||{...m_},e.globalOptions}function w_(e,t,n,r){return n=n||[],function(e,t){x_(e,null,m_,y_,t);for(const n of t){const r=e&&e[n.id]||{},o=n.options&&n.options[n.id]||{},i=n.deprecatedOptions&&n.deprecatedOptions[n.id]||{};x_(r,n.id,o,i,t)}}(e,n=Array.isArray(n)?n:[n]),function(e,t,n){const r=e.options||{},o={...r};(function(e,t){t&&!("baseUri"in e)&&(e.baseUri=t)})(o,n),null===o.log&&(o.log=new g_);return C_(o,b_()),C_(o,t),o}(t,e,r)}function x_(e,t,n,r,o){const i=t||"Top level",s=t?`${t}.`:"";for(const a in e){const l=!t&&Jx(e[a]);if(!(a in n)&&!("baseUri"===a&&!t)&&!("workerUrl"===a&&t))if(a in r)f_.warn(`${i} loader option '${s}${a}' no longer supported, use '${r[a]}'`)();else if(!l){const e=__(a,o);f_.warn(`${i} loader option '${s}${a}' not recognized. ${e}`)()}}}function __(e,t){const n=e.toLowerCase();let r="";for(const o of t)for(const t in o.options){if(e===t)return`Did you mean '${o.id}.${t}'?`;const i=t.toLowerCase();(n.startsWith(i)||i.startsWith(n))&&(r=r||`Did you mean '${o.id}.${t}'?`)}return r}function C_(e,t){for(const n in t)if(n in t){const r=t[n];Zx(r)&&Zx(e[n])?e[n]={...e[n],...t[n]}:e[n]=t[n]}}function S_(e){if(!e)return!1;Array.isArray(e)&&(e=e[0]);return Array.isArray(e?.extensions)}function E_(e){let t;return Xw(e,"null loader"),Xw(S_(e),"invalid loader"),Array.isArray(e)&&(t=e[1],e=e[0],e={...e,options:{...e.options,...t}}),(e?.parseTextSync||e?.parseText)&&(e.text=!0),e.text||(e.binary=!0),e}const B_=()=>{const e=v_();return e.loaderRegistry=e.loaderRegistry||[],e.loaderRegistry};const I_=/\.([^.]+)$/;function R_(e,t=[],n,r){if(!k_(e))return null;if(t&&!Array.isArray(t))return E_(t);let o=[];t&&(o=o.concat(t)),n?.ignoreRegisteredLoaders||o.push(...B_()),function(e){for(const t of e)E_(t)}(o);const i=function(e,t,n,r){const o=u_(e),i=d_(e),s=c_(o)||r?.url;let a=null,l="";n?.mimeType&&(a=P_(t,n?.mimeType),l=`match forced by supplied MIME type ${n?.mimeType}`);a=a||function(e,t){const n=t&&I_.exec(t),r=n&&n[1];return r?function(e,t){t=t.toLowerCase();for(const n of e)for(const e of n.extensions)if(e.toLowerCase()===t)return n;return null}(e,r):null}(t,s),l=l||(a?`matched url ${s}`:""),a=a||P_(t,i),l=l||(a?`matched MIME type ${i}`:""),a=a||function(e,t){if(!t)return null;for(const n of e)if("string"==typeof t){if(F_(t,n))return n}else if(ArrayBuffer.isView(t)){if(M_(t.buffer,t.byteOffset,n))return n}else if(t instanceof ArrayBuffer){if(M_(t,0,n))return n}return null}(t,e),l=l||(a?`matched initial data ${L_(e)}`:""),n?.fallbackMimeType&&(a=a||P_(t,n?.fallbackMimeType),l=l||(a?`matched fallback MIME type ${i}`:""));l&&wx.log(1,`selectLoader selected ${a?.name}: ${l}.`);return a}(e,o,n,r);if(!i&&!n?.nothrow)throw new Error(T_(e));return i}function k_(e){return!(e instanceof Response&&204===e.status)}function T_(e){const t=u_(e),n=d_(e);let r="No valid loader found (";r+=t?`${Yx(t)}, `:"no url provided, ",r+=`MIME type: ${n?`"${n}"`:"not provided"}, `;const o=e?L_(e):"";return r+=o?` first bytes: "${o}"`:"first bytes: not available",r+=")",r}function P_(e,t){for(const n of e){if(n.mimeTypes?.some(e=>s_(t,e)))return n;if(s_(t,`application/x.${n.id}`))return n}return null}function F_(e,t){if(t.testText)return t.testText(e);return(Array.isArray(t.tests)?t.tests:[t.tests]).some(t=>e.startsWith(t))}function M_(e,t,n){return(Array.isArray(n.tests)?n.tests:[n.tests]).some(n=>function(e,t,n,r){if(r instanceof ArrayBuffer)return function(e,t,n){if(n=n||e.byteLength,e.byteLength<n||t.byteLength<n)return!1;const r=new Uint8Array(e),o=new Uint8Array(t);for(let i=0;i<r.length;++i)if(r[i]!==o[i])return!1;return!0}(r,e,r.byteLength);switch(typeof r){case"function":return r(e);case"string":return r===U_(e,t,r.length);default:return!1}}(e,t,0,n))}function L_(e,t=5){if("string"==typeof e)return e.slice(0,t);if(ArrayBuffer.isView(e))return U_(e.buffer,e.byteOffset,t);if(e instanceof ArrayBuffer){return U_(e,0,t)}return""}function U_(e,t,n){if(e.byteLength<t+n)return"";const r=new DataView(e);let o="";for(let i=0;i<n;i++)o+=String.fromCharCode(r.getUint8(t+i));return o}const O_=262144;function D_(e,t){return Yw?async function*(e,t){const n=e.getReader();let r;try{for(;;){const e=r||n.read();t?._streamReadAhead&&(r=n.read());const{done:o,value:i}=await e;if(o)return;yield Xx(i)}}catch(o){n.releaseLock()}}(e,t):async function*(e){for await(const t of e)yield Xx(t)}(e)}function N_(e,t){if("string"==typeof e)return function*(e,t){const n=t?.chunkSize||262144;let r=0;const o=new TextEncoder;for(;r<e.length;){const t=Math.min(e.length-r,n),i=e.slice(r,r+t);r+=t,yield o.encode(i)}}(e,t);if(e instanceof ArrayBuffer)return function*(e,t={}){const{chunkSize:n=O_}=t;let r=0;for(;r<e.byteLength;){const t=Math.min(e.byteLength-r,n),o=new ArrayBuffer(t),i=new Uint8Array(e,r,t);new Uint8Array(o).set(i),r+=t,yield o}}(e,t);if(t_(e))return async function*(e,t){const n=t?.chunkSize||1048576;let r=0;for(;r<e.size;){const t=r+n,o=await e.slice(r,t).arrayBuffer();r=t,yield o}}(e,t);if(n_(e))return D_(e,t);if(e_(e)){return D_(e.body,t)}throw new Error("makeIterator")}const j_="Cannot convert supplied data type";async function Q_(e,t,n){const r=e instanceof ArrayBuffer||ArrayBuffer.isView(e);if("string"==typeof e||r)return function(e,t){if(t.text&&"string"==typeof e)return e;var n;if((n=e)&&"object"==typeof n&&n.isBuffer&&(e=e.buffer),e instanceof ArrayBuffer){const n=e;return t.text&&!t.binary?new TextDecoder("utf8").decode(n):n}if(ArrayBuffer.isView(e)){if(t.text&&!t.binary)return new TextDecoder("utf8").decode(e);let n=e.buffer;const r=e.byteLength||e.length;return 0===e.byteOffset&&r===n.byteLength||(n=n.slice(e.byteOffset,e.byteOffset+r)),n}throw new Error(j_)}(e,t);if(t_(e)&&(e=await A_(e)),e_(e)){const n=e;return await h_(n),t.binary?await n.arrayBuffer():await n.text()}if(n_(e)&&(e=N_(e,n)),o=e,Boolean(o)&&"function"==typeof o[Symbol.iterator]||(e=>e&&"function"==typeof e[Symbol.asyncIterator])(e))return async function(e){const t=[];for await(const n of e)t.push(n);return zx(...t)}(e);var o;throw new Error(j_)}function z_(e,t){const n=b_(),r=e||n;return"function"==typeof r.fetch?r.fetch:Jx(r.fetch)?e=>p_(e,r.fetch):t?.fetch?t?.fetch:p_}function H_(e,t,n){if(n)return n;const r={fetch:z_(t,e),...e};if(r.url){const e=c_(r.url);r.baseUrl=e,r.queryString=function(e){const t=e.match(l_);return t&&t[0]}(r.url),r.filename=Yx(e),r.baseUrl=function(e){const t=e?e.lastIndexOf("/"):-1;return t>=0?e.substr(0,t):""}(e)}return Array.isArray(r.loaders)||(r.loaders=null),r}async function G_(e,t,n,r){!t||Array.isArray(t)||S_(t)||(r=void 0,n=t,t=void 0),n=n||{};const o=u_(e=await e),i=function(e,t){if(e&&!Array.isArray(e))return e;let n;if(e&&(n=Array.isArray(e)?e:[e]),t&&t.loaders){const e=Array.isArray(t.loaders)?t.loaders:[t.loaders];n=n?[...n,...e]:e}return n&&n.length?n:void 0}(t,r),s=await async function(e,t=[],n,r){if(!k_(e))return null;let o=R_(e,t,{...n,nothrow:!0},r);if(o)return o;if(t_(e)&&(o=R_(e=await e.slice(0,10).arrayBuffer(),t,n,r)),!o&&!n?.nothrow)throw new Error(T_(e));return o}(e,i,n);return s?(r=H_({url:o,_parse:G_,loaders:i},n=w_(n,s,i,o),r||null),await async function(e,t,n,r){if(function(e){Cx(e,"no worker provided");const t=e.version}(e),n=xx(e.options,n),e_(t)){const e=t,{ok:n,redirected:o,status:i,statusText:s,type:a,url:l}=e,c=Object.fromEntries(e.headers.entries());r.response={headers:c,ok:n,redirected:o,status:i,statusText:s,type:a,url:l}}t=await Q_(t,e,n);const o=e;if(o.parseTextSync&&"string"==typeof t)return o.parseTextSync(t,n,r);if(function(e,t){return!!Nx.isSupported()&&!(!Sx&&!t?._nodeWorkers)&&e.worker&&t?.worker}(e,n))return await jx(e,t,n,r,G_);if(o.parseText&&"string"==typeof t)return await o.parseText(t,n,r);if(o.parse)return await o.parse(t,n,r);throw Cx(!o.parseSync),new Error(`${e.id} loader - no parser found and worker is disabled`)}(s,e,n,r)):null}async function V_(e,t,n,r){let o,i;Array.isArray(t)||S_(t)?(o=t,i=n):(o=[],i=t);const s=z_(i);let a=e;return"string"==typeof e&&(a=await s(e)),t_(e)&&(a=await s(e)),Array.isArray(o),await G_(a,o,i)}const W_=globalThis.loaders?.parseImageNode,$_="undefined"!=typeof Image,K_="undefined"!=typeof ImageBitmap,X_=Boolean(W_),Y_=!!Yw||X_;function q_(e){const t=function(e){if("undefined"!=typeof ImageBitmap&&e instanceof ImageBitmap)return"imagebitmap";if("undefined"!=typeof Image&&e instanceof Image)return"image";if(e&&"object"==typeof e&&e.data&&e.width&&e.height)return"data";return null}(e);if(!t)throw new Error("Not an image");return t}const J_=/^data:image\/svg\+xml/,Z_=/\.svg((\?|#).*)?$/;function eC(e){return e&&(J_.test(e)||Z_.test(e))}function tC(e,t){if(eC(t))throw new Error("SVG cannot be parsed directly to imagebitmap");return new Blob([new Uint8Array(e)])}async function nC(e,t,n){const r=function(e,t){if(eC(t)){let t=(new TextDecoder).decode(e);try{"function"==typeof unescape&&"function"==typeof encodeURIComponent&&(t=unescape(encodeURIComponent(t)))}catch(n){throw new Error(n.message)}return`data:image/svg+xml;base64,${btoa(t)}`}return tC(e,t)}(e,n),o=self.URL||self.webkitURL,i="string"!=typeof r&&o.createObjectURL(r);try{return await async function(e,t){const n=new Image;if(n.src=e,t.image&&t.image.decode&&n.decode)return await n.decode(),n;return await new Promise((e,t)=>{try{n.onload=()=>e(n),n.onerror=e=>{const n=e instanceof Error?e.message:"error";t(new Error(n))}}catch(r){t(r)}})}(i||r,t)}finally{i&&o.revokeObjectURL(i)}}const rC={};let oC=!0;async function iC(e,t,n){let r;if(eC(n)){r=await nC(e,t,n)}else r=tC(e,n);const o=t&&t.imagebitmap;return await async function(e,t=null){!function(e){for(const t in e||rC)return!1;return!0}(t)&&oC||(t=null);if(t)try{return await createImageBitmap(e,t)}catch(n){oC=!1}return await createImageBitmap(e)}(r,o)}function sC(e){return function(e,t,n=0){const r=(o=t,[...o].map(e=>e.charCodeAt(0)));var o;for(let i=0;i<r.length;++i)if(r[i]!==e[i+n])return!1;return!0}(e,"ftyp",4)&&96&e[8]?function(e){switch((t=e,n=8,r=12,String.fromCharCode(...t.slice(n,r))).replace("\0"," ").trim()){case"avif":case"avis":return{extension:"avif",mimeType:"image/avif"};default:return null}var t,n,r}(e):null}const aC=!1,lC=!0;function cC(e){const t=uC(e);return function(e){const t=uC(e),n=t.byteLength>=24&&2303741511===t.getUint32(0,aC);if(!n)return null;return{mimeType:"image/png",width:t.getUint32(16,aC),height:t.getUint32(20,aC)}}(t)||function(e){const t=uC(e),n=t.byteLength>=3&&65496===t.getUint16(0,aC)&&255===t.getUint8(2);if(!n)return null;const{tableMarkers:r,sofMarkers:o}=function(){const e=new Set([65499,65476,65484,65501,65534]);for(let n=65504;n<65520;++n)e.add(n);const t=new Set([65472,65473,65474,65475,65477,65478,65479,65481,65482,65483,65485,65486,65487,65502]);return{tableMarkers:e,sofMarkers:t}}();let i=2;for(;i+9<t.byteLength;){const e=t.getUint16(i,aC);if(o.has(e))return{mimeType:"image/jpeg",height:t.getUint16(i+5,aC),width:t.getUint16(i+7,aC)};if(!r.has(e))return null;i+=2,i+=t.getUint16(i,aC)}return null}(t)||function(e){const t=uC(e),n=t.byteLength>=10&&1195984440===t.getUint32(0,aC);if(!n)return null;return{mimeType:"image/gif",width:t.getUint16(6,lC),height:t.getUint16(8,lC)}}(t)||function(e){const t=uC(e),n=t.byteLength>=14&&16973===t.getUint16(0,aC)&&t.getUint32(2,lC)===t.byteLength;if(!n)return null;return{mimeType:"image/bmp",width:t.getUint32(18,lC),height:t.getUint32(22,lC)}}(t)||function(e){const t=new Uint8Array(e instanceof DataView?e.buffer:e),n=sC(t);if(!n)return null;return{mimeType:n.mimeType,width:0,height:0}}(t)}function uC(e){if(e instanceof DataView)return e;if(ArrayBuffer.isView(e))return new DataView(e.buffer);if(e instanceof ArrayBuffer)return new DataView(e);throw new Error("toDataView")}const dC={dataType:null,batchType:null,id:"image",module:"images",name:"Images",version:"4.3.3",mimeTypes:["image/png","image/jpeg","image/gif","image/webp","image/avif","image/bmp","image/vnd.microsoft.icon","image/svg+xml"],extensions:["png","jpg","jpeg","gif","webp","bmp","ico","svg","avif"],parse:async function(e,t,n){const r=((t=t||{}).image||{}).type||"auto",{url:o}=n||{};let i;switch(function(e){switch(e){case"auto":case"data":return function(){if(K_)return"imagebitmap";if($_)return"image";if(Y_)return"data";throw new Error("Install '@loaders.gl/polyfills' to parse images under Node.js")}();default:return function(e){switch(e){case"auto":return K_||$_||Y_;case"imagebitmap":return K_;case"image":return $_;case"data":return Y_;default:throw new Error(`@loaders.gl/images: image ${e} not supported in this environment`)}}(e),e}}(r)){case"imagebitmap":i=await iC(e,t,o);break;case"image":i=await nC(e,t,o);break;case"data":i=await async function(e){const{mimeType:t}=cC(e)||{},n=globalThis.loaders?.parseImageNode;return Xw(n),await n(e,t)}(e);break;default:Xw(!1)}return"data"===r&&(i=function(e){switch(q_(e)){case"data":return e;case"image":case"imagebitmap":const t=document.createElement("canvas"),n=t.getContext("2d");if(!n)throw new Error("getImageData");return t.width=e.width,t.height=e.height,n.drawImage(e,0,0),n.getImageData(0,0,e.width,e.height);default:throw new Error("getImageData")}}(i)),i},tests:[e=>Boolean(cC(new DataView(e)))],options:{image:{type:"auto",decode:!0}}},AC=new fx({id:"deck"});let hC={};function pC(e){hC=e}function fC(e,t,n,r){AC.level>0&&hC[e]&&hC[e].call(null,t,n,r)}const gC={dataType:null,batchType:null,id:"JSON",name:"JSON",module:"",version:"",options:{},extensions:["json","geojson"],mimeTypes:["application/json","application/geo+json"],testText:function(e){const t=e[0],n=e[e.length-1];return"{"===t&&"}"===n||"["===t&&"]"===n},parseTextSync:JSON.parse};const mC=function(){const e="9.1.14",t=globalThis.deck&&globalThis.deck.VERSION;if(t&&t!==e)throw new Error(`deck.gl - multiple versions detected: ${t} vs ${e}`);return t||(AC.log(1,`deck.gl ${e}`)(),globalThis.deck={...globalThis.deck,VERSION:e,version:e,log:AC,_registerLoggers:pC},function(e){const t=B_();e=Array.isArray(e)?e:[e];for(const n of e){const e=E_(n);t.find(t=>e===t)||t.unshift(e)}}([gC,[dC,{imagebitmap:{premultiplyAlpha:"none"}}]])),e}();function yC(e,t){if(!e)throw new Error(t||"shadertools: assertion failed.")}const vC={number:{type:"number",validate:(e,t)=>Number.isFinite(e)&&"object"==typeof t&&(void 0===t.max||e<=t.max)&&(void 0===t.min||e>=t.min)},array:{type:"array",validate:(e,t)=>Array.isArray(e)||ArrayBuffer.isView(e)}};function bC(e){let t=wC(e);if("object"!==t)return{value:e,...vC[t],type:t};if("object"==typeof e)return e?void 0!==e.type?{...e,...vC[e.type],type:e.type}:void 0===e.value?{type:"object",value:e}:(t=wC(e.value),{...e,...vC[t],type:t}):{type:"object",value:null};throw new Error("props")}function wC(e){return Array.isArray(e)||ArrayBuffer.isView(e)?"array":typeof e}const xC={vertex:"#ifdef MODULE_LOGDEPTH\n  logdepth_adjustPosition(gl_Position);\n#endif\n",fragment:"#ifdef MODULE_MATERIAL\n  fragColor = material_filterColor(fragColor);\n#endif\n\n#ifdef MODULE_LIGHTING\n  fragColor = lighting_filterColor(fragColor);\n#endif\n\n#ifdef MODULE_FOG\n  fragColor = fog_filterColor(fragColor);\n#endif\n\n#ifdef MODULE_PICKING\n  fragColor = picking_filterHighlightColor(fragColor);\n  fragColor = picking_filterPickingColor(fragColor);\n#endif\n\n#ifdef MODULE_LOGDEPTH\n  logdepth_setFragDepth();\n#endif\n"},_C=/void\s+main\s*\([^)]*\)\s*\{\n?/,CC=/}\n?[^{}]*$/,SC=[],EC="__LUMA_INJECT_DECLARATIONS__";function BC(e){const t={vertex:{},fragment:{}};for(const n in e){let r=e[n];"string"==typeof r&&(r={order:0,injection:r}),t[IC(n)][n]=r}return t}function IC(e){const t=e.slice(0,2);switch(t){case"vs":return"vertex";case"fs":return"fragment";default:throw new Error(t)}}function RC(e,t,n,r=!1){const o="vertex"===t;for(const i in n){const t=n[i];t.sort((e,t)=>e.order-t.order),SC.length=t.length;for(let e=0,n=t.length;e<n;++e)SC[e]=t[e].injection;const r=`${SC.join("\n")}\n`;switch(i){case"vs:#decl":o&&(e=e.replace(EC,r));break;case"vs:#main-start":o&&(e=e.replace(_C,e=>e+r));break;case"vs:#main-end":o&&(e=e.replace(CC,e=>r+e));break;case"fs:#decl":o||(e=e.replace(EC,r));break;case"fs:#main-start":o||(e=e.replace(_C,e=>e+r));break;case"fs:#main-end":o||(e=e.replace(CC,e=>r+e));break;default:e=e.replace(i,e=>e+r)}}return e=e.replace(EC,""),r&&(e=e.replace(/\}\s*$/,e=>e+xC[t])),e}function kC(e){e.map(e=>function(e){if(e.instance)return;kC(e.dependencies||[]);const{propTypes:t={},deprecations:n=[],inject:r={}}=e,o={normalizedInjections:BC(r),parsedDeprecations:PC(n)};t&&(o.propValidators=function(e){const t={};for(const[n,r]of Object.entries(e))t[n]=bC(r);return t}(t));e.instance=o;let i={};t&&(i=Object.entries(t).reduce((e,[t,n])=>{const r=n?.value;return r&&(e[t]=r),e},{}));e.defaultUniforms={...e.defaultUniforms,...i}}(e))}function TC(e,t,n){e.deprecations?.forEach(e=>{e.regex?.test(t)&&(e.deprecated?n.deprecated(e.old,e.new)():n.removed(e.old,e.new)())})}function PC(e){return e.forEach(e=>{if("function"===e.type)e.regex=new RegExp(`\\b${e.old}\\(`);else e.regex=new RegExp(`${e.type} ${e.old};`)}),e}function FC(e){kC(e);const t={},n={};MC({modules:e,level:0,moduleMap:t,moduleDepth:n});const r=Object.keys(n).sort((e,t)=>n[t]-n[e]).map(e=>t[e]);return kC(r),r}function MC(e){const{modules:t,level:n,moduleMap:r,moduleDepth:o}=e;if(n>=5)throw new Error("Possible loop in shader dependency graph");for(const i of t)r[i.name]=i,(void 0===o[i.name]||o[i.name]<n)&&(o[i.name]=n);for(const i of t)i.dependencies&&MC({modules:i.dependencies,level:n+1,moduleMap:r,moduleDepth:o})}const LC=[[/^(#version[ \t]+(100|300[ \t]+es))?[ \t]*\n/,"#version 300 es\n"],[/\btexture(2D|2DProj|Cube)Lod(EXT)?\(/g,"textureLod("],[/\btexture(2D|2DProj|Cube)(EXT)?\(/g,"texture("]],UC=[...LC,[NC("attribute"),"in $1"],[NC("varying"),"out $1"]],OC=[...LC,[NC("varying"),"in $1"]];function DC(e,t){for(const[n,r]of t)e=e.replace(n,r);return e}function NC(e){return new RegExp(`\\b${e}[ \\t]+(\\w+[ \\t]+\\w+(\\[\\w+\\])?;)`,"g")}function jC(e,t){let n="";for(const r in e){const o=e[r];if(n+=`void ${o.signature} {\n`,o.header&&(n+=`  ${o.header}`),t[r]){const e=t[r];e.sort((e,t)=>e.order-t.order);for(const t of e)n+=`  ${t.injection}\n`}o.footer&&(n+=`  ${o.footer}`),n+="}\n"}return n}function QC(e){const t={vertex:{},fragment:{}};for(const n of e){let e,r;"string"!=typeof n?(e=n,r=e.hook):(e={},r=n),r=r.trim();const[o,i]=r.split(":"),s=r.replace(/\(.+/,""),a=Object.assign(e,{signature:i});switch(o){case"vs":t.vertex[s]=a;break;case"fs":t.fragment[s]=a;break;default:throw new Error(o)}}return t}function zC(e,t="unnamed"){const n=/#define[^\S\r\n]*SHADER_NAME[^\S\r\n]*([A-Za-z0-9_-]+)\s*/.exec(e);return n?n[1]:t}function HC(e){let t=100;const n=e.match(/[^\s]+/g);if(n&&n.length>=2&&"#version"===n[0]){const e=parseInt(n[1],10);Number.isFinite(e)&&(t=e)}if(100!==t&&300!==t)throw new Error(`Invalid GLSL version ${t}`);return t}const GC=`\n\n${EC}\n`;function VC(e,t){const{source:n,stage:r,modules:o,hookFunctions:i=[],inject:s={},log:a}=t;yC("string"==typeof n,"shader source must be a string");const l=n;let c="";const u=QC(i),d={},A={},h={};for(const f in s){const e="string"==typeof s[f]?{injection:s[f],order:0}:s[f],t=/^(v|f)s:(#)?([\w-]+)$/.exec(f);if(t){const n=t[2],r=t[3];n?"decl"===r?A[f]=[e]:h[f]=[e]:d[f]=[e]}else h[f]=[e]}const p=o;for(const f of p){a&&TC(f,l,a);c+=KC(f,"wgsl");const e=f.injections?.[r]||{};for(const t in e){const n=/^(v|f)s:#([\w-]+)$/.exec(t);if(n){const r="decl"===n[2]?A:h;r[t]=r[t]||[],r[t].push(e[t])}else d[t]=d[t]||[],d[t].push(e[t])}}return c+=GC,c=RC(c,r,A),c+=jC(u[r],d),c+=l,c=RC(c,r,h),c}function WC(e,t){const{id:n,source:r,stage:o,language:i="glsl",modules:s,defines:a={},hookFunctions:l=[],inject:c={},prologue:u=!0,log:d}=t;yC("string"==typeof r,"shader source must be a string");const A="glsl"===i?function(e,t){return{name:zC(e,t),language:"glsl",version:HC(e)}}(r).version:-1,h=e.shaderLanguageVersion,p=100===A?"#version 100":"#version 300 es",f=r.split("\n").slice(1).join("\n"),g={};s.forEach(e=>{Object.assign(g,e.defines)}),Object.assign(g,a);let m="";switch(i){case"wgsl":break;case"glsl":m=u?`${p}\n\n// ----- PROLOGUE -------------------------\n${function(e){const{id:t,source:n,stage:r}=e,o=t&&-1===n.indexOf("SHADER_NAME");return o?`\n#define SHADER_NAME ${t}_${r}`:""}({id:n,source:r,stage:o})}\n#define SHADER_TYPE_${o.toUpperCase()}\n\n${function(e){switch(e?.gpu.toLowerCase()){case"apple":return"#define APPLE_GPU\n// Apple optimizes away the calculation necessary for emulated fp64\n#define LUMA_FP64_CODE_ELIMINATION_WORKAROUND 1\n#define LUMA_FP32_TAN_PRECISION_WORKAROUND 1\n// Intel GPU doesn't have full 32 bits precision in same cases, causes overflow\n#define LUMA_FP64_HIGH_BITS_OVERFLOW_WORKAROUND 1\n";case"nvidia":return"#define NVIDIA_GPU\n// Nvidia optimizes away the calculation necessary for emulated fp64\n#define LUMA_FP64_CODE_ELIMINATION_WORKAROUND 1\n";case"intel":return"#define INTEL_GPU\n// Intel optimizes away the calculation necessary for emulated fp64\n#define LUMA_FP64_CODE_ELIMINATION_WORKAROUND 1\n// Intel's built-in 'tan' function doesn't have acceptable precision\n#define LUMA_FP32_TAN_PRECISION_WORKAROUND 1\n// Intel GPU doesn't have full 32 bits precision in same cases, causes overflow\n#define LUMA_FP64_HIGH_BITS_OVERFLOW_WORKAROUND 1\n";case"amd":return"#define AMD_GPU\n";default:return"#define DEFAULT_GPU\n// Prevent driver from optimizing away the calculation necessary for emulated fp64\n#define LUMA_FP64_CODE_ELIMINATION_WORKAROUND 1\n// Headless Chrome's software shader 'tan' function doesn't have acceptable precision\n#define LUMA_FP32_TAN_PRECISION_WORKAROUND 1\n// If the GPU doesn't have full 32 bits precision, will causes overflow\n#define LUMA_FP64_HIGH_BITS_OVERFLOW_WORKAROUND 1\n"}}(e)}\n${"fragment"===o?"precision highp float;\n":""}\n\n// ----- APPLICATION DEFINES -------------------------\n\n${function(e={}){let t="";for(const n in e){const r=e[n];(r||Number.isFinite(r))&&(t+=`#define ${n.toUpperCase()} ${e[n]}\n`)}return t}(g)}\n\n`:`${p}\n`}const y=QC(l),v={},b={},w={};for(const x in c){const e="string"==typeof c[x]?{injection:c[x],order:0}:c[x],t=/^(v|f)s:(#)?([\w-]+)$/.exec(x);if(t){const n=t[2],r=t[3];n?"decl"===r?b[x]=[e]:w[x]=[e]:v[x]=[e]}else w[x]=[e]}for(const x of s){d&&TC(x,f,d);m+=KC(x,o);const e=x.instance?.normalizedInjections[o]||{};for(const t in e){const n=/^(v|f)s:#([\w-]+)$/.exec(t);if(n){const r="decl"===n[2]?b:w;r[t]=r[t]||[],r[t].push(e[t])}else v[t]=v[t]||[],v[t].push(e[t])}}return m+="// ----- MAIN SHADER SOURCE -------------------------",m+=GC,m=RC(m,o,b),m+=jC(y[o],v),m+=f,m=RC(m,o,w),"glsl"===i&&A!==h&&(m=function(e,t){if(300!==Number(e.match(/^#version[ \t]+(\d+)/m)?.[1]||100))throw new Error("luma.gl v9 only supports GLSL 3.00 shader sources");switch(t){case"vertex":return DC(e,UC);case"fragment":return DC(e,OC);default:throw new Error(t)}}(m,o)),m.trim()}function $C(e){return function(t){const n={};for(const r of e){const e=r.getUniforms?.(t,n);Object.assign(n,e)}return n}}function KC(e,t){let n;switch(t){case"vertex":n=e.vs||"";break;case"fragment":n=e.fs||"";break;case"wgsl":n=e.source||"";break;default:yC(!1)}if(!e.name)throw new Error("Shader module must have a name");const r=e.name.toUpperCase().replace(/[^0-9a-z]/gi,"_");let o=`// ----- MODULE ${e.name} ---------------\n\n`;return"wgsl"!==t&&(o+=`#define MODULE_${r}\n`),o+=`${n}\n`,o}const XC=/^\s*\#\s*ifdef\s*([a-zA-Z_]+)\s*$/,YC=/^\s*\#\s*endif\s*$/;class qC{static defaultShaderAssembler;_hookFunctions=[];_defaultModules=[];static getDefaultShaderAssembler(){return qC.defaultShaderAssembler=qC.defaultShaderAssembler||new qC,qC.defaultShaderAssembler}addDefaultModule(e){this._defaultModules.find(t=>t.name===("string"==typeof e?e:e.name))||this._defaultModules.push(e)}removeDefaultModule(e){const t="string"==typeof e?e:e.name;this._defaultModules=this._defaultModules.filter(e=>e.name!==t)}addShaderHook(e,t){t&&(e=Object.assign(t,{hook:e})),this._hookFunctions.push(e)}assembleWGSLShader(e){const t=this._getModuleList(e.modules),n=this._hookFunctions,{source:r,getUniforms:o}=function(e){const t=FC(e.modules||[]);return{source:VC(e.platformInfo,{...e,source:e.source,stage:"vertex",modules:t}),getUniforms:$C(t)}}({...e,source:e.source,modules:t,hookFunctions:n}),i="wgsl"===e.platformInfo.shaderLanguage?function(e,t){const n=e.split("\n"),r=[];let o=!0,i=null;for(const s of n){const e=s.match(XC),n=s.match(YC);e?(i=e[1],o=Boolean(t?.defines?.[i])):n?o=!0:o&&r.push(s)}return r.join("\n")}(r):r;return{source:i,getUniforms:o,modules:t}}assembleGLSLShaderPair(e){const t=this._getModuleList(e.modules),n=this._hookFunctions,r=function(e){const{vs:t,fs:n}=e,r=FC(e.modules||[]);return{vs:WC(e.platformInfo,{...e,source:t,stage:"vertex",modules:r}),fs:WC(e.platformInfo,{...e,source:n,stage:"fragment",modules:r}),getUniforms:$C(r)}}({...e,vs:e.vs,fs:e.fs,modules:t,hookFunctions:n});return{...r,modules:t}}_getModuleList(e=[]){const t=new Array(this._defaultModules.length+e.length),n={};let r=0;for(let o=0,i=this._defaultModules.length;o<i;++o){const e=this._defaultModules[o],i=e.name;t[r++]=e,n[i]=!0}for(let o=0,i=e.length;o<i;++o){const i=e[o],s=i.name;n[s]||(t[r++]=i,n[s]=!0)}return t.length=r,kC(t),t}}function JC(e){const{input:t,inputChannels:n,output:r}={};if(!t)return"#version 300 es\nout vec4 transform_output;\nvoid main() {\n  transform_output = vec4(0);\n}";if(!n)throw new Error("inputChannels");return`#version 300 es\nin ${function(e){switch(e){case 1:return"float";case 2:return"vec2";case 3:return"vec3";case 4:return"vec4";default:throw new Error(`invalid channels: ${e}`)}}(n)} ${t};\nout vec4 ${r};\nvoid main() {\n  ${r} = ${function(e,t){switch(t){case 1:return`vec4(${e}, 0.0, 0.0, 1.0)`;case 2:return`vec4(${e}, 0.0, 1.0)`;case 3:return`vec4(${e}, 1.0)`;case 4:return e;default:throw new Error(`invalid channels: ${t}`)}}(t,n)};\n}`}const ZC=new class{stats=new Map;getStats(e){return this.get(e)}get(e){return this.stats.has(e)||this.stats.set(e,new Vx({id:e})),this.stats.get(e)}},eS=new fx({id:"luma.gl"}),tS={};function nS(e="id"){tS[e]=tS[e]||1;return`${e}-${tS[e]++}`}let rS=class{static defaultProps={id:"undefined",handle:void 0,userData:void 0};toString(){return`${this[Symbol.toStringTag]||this.constructor.name}:"${this.id}"`}id;props;userData={};_device;destroyed=!1;allocatedBytes=0;_attachedResources=new Set;constructor(e,t,n){if(!e)throw new Error("no device");this._device=e,this.props=function(e,t){const n={...t};for(const r in e)void 0!==e[r]&&(n[r]=e[r]);return n}(t,n);const r="undefined"!==this.props.id?this.props.id:nS(this[Symbol.toStringTag]);this.props.id=r,this.id=r,this.userData=this.props.userData||{},this.addStats()}destroy(){this.destroyResource()}delete(){return this.destroy(),this}getProps(){return this.props}attachResource(e){this._attachedResources.add(e)}detachResource(e){this._attachedResources.delete(e)}destroyAttachedResource(e){this._attachedResources.delete(e)&&e.destroy()}destroyAttachedResources(){for(const e of Object.values(this._attachedResources))e.destroy();this._attachedResources=new Set}destroyResource(){this.destroyAttachedResources(),this.removeStats(),this.destroyed=!0}removeStats(){const e=this._device.statsManager.getStats("Resource Counts"),t=this[Symbol.toStringTag];e.get(`${t}s Active`).decrementCount()}trackAllocatedMemory(e,t=this[Symbol.toStringTag]){const n=this._device.statsManager.getStats("Resource Counts");n.get("GPU Memory").addCount(e),n.get(`${t} Memory`).addCount(e),this.allocatedBytes=e}trackDeallocatedMemory(e=this[Symbol.toStringTag]){const t=this._device.statsManager.getStats("Resource Counts");t.get("GPU Memory").subtractCount(this.allocatedBytes),t.get(`${e} Memory`).subtractCount(this.allocatedBytes),this.allocatedBytes=0}addStats(){const e=this._device.statsManager.getStats("Resource Counts"),t=this[Symbol.toStringTag];e.get("Resources Created").incrementCount(),e.get(`${t}s Created`).incrementCount(),e.get(`${t}s Active`).incrementCount()}};class oS extends rS{static defaultProps={...rS.defaultProps,usage:0,byteLength:0,byteOffset:0,data:null,indexType:"uint16",mappedAtCreation:!1};static MAP_READ=1;static MAP_WRITE=2;static COPY_SRC=4;static COPY_DST=8;static INDEX=16;static VERTEX=32;static UNIFORM=64;static STORAGE=128;static INDIRECT=256;static QUERY_RESOLVE=512;get[Symbol.toStringTag](){return"Buffer"}usage;indexType;updateTimestamp;constructor(e,t){const n={...t};(t.usage||0)&oS.INDEX&&!t.indexType&&(t.data instanceof Uint32Array?n.indexType="uint32":t.data instanceof Uint16Array&&(n.indexType="uint16")),delete n.data,super(e,n,oS.defaultProps),this.usage=n.usage||0,this.indexType=n.indexType,this.updateTimestamp=e.incrementTimestamp()}clone(e){return this.device.createBuffer({...this.props,...e})}readSyncWebGL(e,t){throw new Error("not implemented")}static DEBUG_DATA_MAX_LENGTH=32;debugData=new ArrayBuffer(0);_setDebugData(e,t,n){const r=ArrayBuffer.isView(e)?e.buffer:e,o=Math.min(e?e.byteLength:n,oS.DEBUG_DATA_MAX_LENGTH);null===r?this.debugData=new ArrayBuffer(o):0===t&&n===r.byteLength?this.debugData=r.slice(0,o):this.debugData=r.slice(t,t+o)}}function iS(e){const t=function(e){const t=aS[e];return t}(sS[e]),n=e.includes("norm"),r=!n&&!e.startsWith("float"),o=e.startsWith("s");return{dataType:sS[e],byteLength:t,integer:r,signed:o,normalized:n}}const sS={uint8:"uint8",sint8:"sint8",unorm8:"uint8",snorm8:"sint8",uint16:"uint16",sint16:"sint16",unorm16:"uint16",snorm16:"sint16",float16:"float16",float32:"float32",uint32:"uint32",sint32:"sint32"},aS={uint8:1,sint8:1,uint16:2,sint16:2,float16:2,float32:4,uint32:4,sint32:4},lS="texture-compression-bc",cS="texture-compression-astc",uS="texture-compression-etc2",dS="texture-compression-pvrtc-webgl",AS="texture-compression-atc-webgl",hS="float32-renderable-webgl",pS="float16-renderable-webgl",fS="snorm8-renderable-webgl",gS="norm16-renderable-webgl",mS="snorm16-renderable-webgl",yS="float32-filterable",vS="float16-filterable-webgl";function bS(e){const t=wS[e];if(!t)throw new Error(`Unsupported texture format ${e}`);return t}const wS={r8unorm:{},r8snorm:{render:fS},r8uint:{},r8sint:{},rg8unorm:{},rg8snorm:{render:fS},rg8uint:{},rg8sint:{},r16uint:{},r16sint:{},r16float:{render:pS,filter:"float16-filterable-webgl"},"r16unorm-webgl":{f:gS},"r16snorm-webgl":{f:mS},"rgba4unorm-webgl":{channels:"rgba",bitsPerChannel:[4,4,4,4],packed:!0},"rgb565unorm-webgl":{channels:"rgb",bitsPerChannel:[5,6,5,0],packed:!0},"rgb5a1unorm-webgl":{channels:"rgba",bitsPerChannel:[5,5,5,1],packed:!0},"rgb8unorm-webgl":{},"rgb8snorm-webgl":{},rgba8unorm:{},"rgba8unorm-srgb":{},rgba8snorm:{render:fS},rgba8uint:{},rgba8sint:{},bgra8unorm:{},"bgra8unorm-srgb":{},rg16uint:{},rg16sint:{},rg16float:{render:pS,filter:vS},"rg16unorm-webgl":{render:gS},"rg16snorm-webgl":{render:mS},r32uint:{},r32sint:{},r32float:{render:hS,filter:yS},rgb9e5ufloat:{channels:"rgb",packed:!0,render:"rgb9e5ufloat-renderable-webgl"},rg11b10ufloat:{channels:"rgb",bitsPerChannel:[11,11,10,0],packed:!0,p:1,render:hS},rgb10a2unorm:{channels:"rgba",bitsPerChannel:[10,10,10,2],packed:!0,p:1},"rgb10a2uint-webgl":{channels:"rgba",bitsPerChannel:[10,10,10,2],packed:!0,p:1,wgpu:!1},"rgb16unorm-webgl":{f:gS},"rgb16snorm-webgl":{f:gS},rg32uint:{},rg32sint:{},rg32float:{render:!1,filter:yS},rgba16uint:{},rgba16sint:{},rgba16float:{render:pS,filter:vS},"rgba16unorm-webgl":{render:gS},"rgba16snorm-webgl":{render:mS},"rgb32float-webgl":{render:hS,filter:yS},rgba32uint:{},rgba32sint:{},rgba32float:{render:hS,filter:yS},stencil8:{attachment:"stencil",bitsPerChannel:[8,0,0,0],dataType:"uint8"},depth16unorm:{attachment:"depth",bitsPerChannel:[16,0,0,0],dataType:"uint16"},depth24plus:{attachment:"depth",bitsPerChannel:[24,0,0,0],dataType:"uint32"},depth32float:{attachment:"depth",bitsPerChannel:[32,0,0,0],dataType:"float32"},"depth24plus-stencil8":{attachment:"depth-stencil",bitsPerChannel:[24,8,0,0],packed:!0},"depth32float-stencil8":{attachment:"depth-stencil",bitsPerChannel:[32,8,0,0],packed:!0},"bc1-rgb-unorm-webgl":{f:lS},"bc1-rgb-unorm-srgb-webgl":{f:lS},"bc1-rgba-unorm":{f:lS},"bc1-rgba-unorm-srgb":{f:lS},"bc2-rgba-unorm":{f:lS},"bc2-rgba-unorm-srgb":{f:lS},"bc3-rgba-unorm":{f:lS},"bc3-rgba-unorm-srgb":{f:lS},"bc4-r-unorm":{f:lS},"bc4-r-snorm":{f:lS},"bc5-rg-unorm":{f:lS},"bc5-rg-snorm":{f:lS},"bc6h-rgb-ufloat":{f:lS},"bc6h-rgb-float":{f:lS},"bc7-rgba-unorm":{f:lS},"bc7-rgba-unorm-srgb":{f:lS},"etc2-rgb8unorm":{f:uS},"etc2-rgb8unorm-srgb":{f:uS},"etc2-rgb8a1unorm":{f:uS},"etc2-rgb8a1unorm-srgb":{f:uS},"etc2-rgba8unorm":{f:uS},"etc2-rgba8unorm-srgb":{f:uS},"eac-r11unorm":{f:uS},"eac-r11snorm":{f:uS},"eac-rg11unorm":{f:uS},"eac-rg11snorm":{f:uS},"astc-4x4-unorm":{f:cS},"astc-4x4-unorm-srgb":{f:cS},"astc-5x4-unorm":{f:cS},"astc-5x4-unorm-srgb":{f:cS},"astc-5x5-unorm":{f:cS},"astc-5x5-unorm-srgb":{f:cS},"astc-6x5-unorm":{f:cS},"astc-6x5-unorm-srgb":{f:cS},"astc-6x6-unorm":{f:cS},"astc-6x6-unorm-srgb":{f:cS},"astc-8x5-unorm":{f:cS},"astc-8x5-unorm-srgb":{f:cS},"astc-8x6-unorm":{f:cS},"astc-8x6-unorm-srgb":{f:cS},"astc-8x8-unorm":{f:cS},"astc-8x8-unorm-srgb":{f:cS},"astc-10x5-unorm":{f:cS},"astc-10x5-unorm-srgb":{f:cS},"astc-10x6-unorm":{f:cS},"astc-10x6-unorm-srgb":{f:cS},"astc-10x8-unorm":{f:cS},"astc-10x8-unorm-srgb":{f:cS},"astc-10x10-unorm":{f:cS},"astc-10x10-unorm-srgb":{f:cS},"astc-12x10-unorm":{f:cS},"astc-12x10-unorm-srgb":{f:cS},"astc-12x12-unorm":{f:cS},"astc-12x12-unorm-srgb":{f:cS},"pvrtc-rgb4unorm-webgl":{f:dS},"pvrtc-rgba4unorm-webgl":{f:dS},"pvrtc-rbg2unorm-webgl":{f:dS},"pvrtc-rgba2unorm-webgl":{f:dS},"etc1-rbg-unorm-webgl":{f:"texture-compression-etc1-webgl"},"atc-rgb-unorm-webgl":{f:AS},"atc-rgba-unorm-webgl":{f:AS},"atc-rgbai-unorm-webgl":{f:AS}},xS=["bc1","bc2","bc3","bc4","bc5","bc6","bc7","etc1","etc2","eac","atc","astc","pvrtc"],_S=/^(r|rg|rgb|rgba|bgra)([0-9]*)([a-z]*)(-srgb)?(-webgl)?$/;function CS(e){return xS.some(t=>e.startsWith(t))}function SS(e){let t=function(e){const t=bS(e),n=t.bytesPerPixel||1,r=t.bitsPerChannel||[8,8,8,8];delete t.bitsPerChannel,delete t.bytesPerPixel,delete t.f,delete t.render,delete t.filter,delete t.blend,delete t.store;const o={...t,format:e,attachment:t.attachment||"color",channels:t.channels||"r",components:t.components||t.channels?.length||1,bytesPerPixel:n,bitsPerChannel:r,dataType:t.dataType||"uint8",srgb:t.srgb??!1,packed:t.packed??!1,webgl:t.webgl??!1,integer:t.integer??!1,signed:t.signed??!1,normalized:t.normalized??!1,compressed:t.compressed??!1};return o}(e);if(CS(e)){t.channels="rgb",t.components=3,t.bytesPerPixel=1,t.srgb=!1,t.compressed=!0;const n=function(e){const t=/.*-(\d+)x(\d+)-.*/.exec(e);if(t){const[,e,n]=t;return{blockWidth:Number(e),blockHeight:Number(n)}}return null}(e);n&&(t.blockWidth=n.blockWidth,t.blockHeight=n.blockHeight)}const n=_S.exec(e);if(n){const[,r,o,i,s,a]=n,l=iS(`${i}${o}`),c=8*l.byteLength,u=r.length,d=[c,u>=2?c:0,u>=3?c:0,u>=4?c:0];t={format:e,attachment:t.attachment,dataType:l.dataType,components:u,channels:r,integer:l.integer,signed:l.signed,normalized:l.normalized,bitsPerChannel:d,bytesPerPixel:l.byteLength*r.length,packed:t.packed,srgb:t.srgb},"-webgl"===a&&(t.webgl=!0),"-srgb"===s&&(t.srgb=!0)}return e.endsWith("-webgl")&&(t.webgl=!0),e.endsWith("-srgb")&&(t.srgb=!0),t}class ES{}class BS{features;disabledFeatures;constructor(e=[],t){this.features=new Set(e),this.disabledFeatures=t||{}}*[Symbol.iterator](){yield*this.features}has(e){return!this.disabledFeatures?.[e]&&this.features.has(e)}}class IS{static defaultProps={id:null,powerPreference:"high-performance",failIfMajorPerformanceCaveat:!1,createCanvasContext:void 0,onError:e=>eS.error(e.message)(),_reuseDevices:!1,_requestMaxLimits:!0,_factoryDestroyPolicy:"unused",_initializeFeatures:!0,_disabledFeatures:{"compilation-status-async-webgl":!0},_resourceDefaults:{},webgl:{},debug:eS.get("debug")||void 0,debugShaders:eS.get("debug-shaders")||void 0,debugFramebuffers:Boolean(eS.get("debug-framebuffers")),debugWebGL:Boolean(eS.get("debug-webgl")),debugSpectorJS:void 0,debugSpectorJSUrl:void 0,_handle:void 0};get[Symbol.toStringTag](){return"Device"}constructor(e){this.props={...IS.defaultProps,...e},this.id=this.props.id||nS(this[Symbol.toStringTag].toLowerCase())}id;props;userData={};statsManager=ZC;timestamp=0;_reused=!1;_lumaData={};getTextureFormatCapabilities(e){const t=function(e){const t=bS(e),n={format:e,create:t.f??!0,render:t.render??!0,filter:t.filter??!0,blend:t.blend??!0,store:t.store??!0},r=SS(e),o=e.startsWith("depth")||e.startsWith("stencil"),i=r?.signed,s=r?.integer,a=r?.webgl;return n.render&&=!i,n.filter&&=!(o||i||s||a),n}(e),n=e=>("string"==typeof e?this.features.has(e):e)??!0,r=n(t.create),o={format:e,create:r,render:r&&n(t.render),filter:r&&n(t.filter),blend:r&&n(t.blend),store:r&&n(t.store)};return this._getDeviceSpecificTextureFormatCapabilities(o)}isTextureFormatSupported(e,t){return this.getTextureFormatCapabilities(e).create}isTextureFormatFilterable(e){return this.getTextureFormatCapabilities(e).filter}isTextureFormatRenderable(e){return this.getTextureFormatCapabilities(e).render}isTextureFormatCompressed(e){return CS(e)}loseDevice(){return!1}reportError(e){this.props.onError(e)}getDefaultCanvasContext(){if(!this.canvasContext)throw new Error("Device has no default CanvasContext. See props.createCanvasContext");return this.canvasContext}createCommandEncoder(e={}){throw new Error("not implemented")}incrementTimestamp(){return this.timestamp++}onError(e){this.props.onError(e)}getCanvasContext(){return this.getDefaultCanvasContext()}readPixelsToArrayWebGL(e,t){throw new Error("not implemented")}readPixelsToBufferWebGL(e,t){throw new Error("not implemented")}setParametersWebGL(e){throw new Error("not implemented")}getParametersWebGL(e){throw new Error("not implemented")}withParametersWebGL(e,t){throw new Error("not implemented")}clearWebGL(e){throw new Error("not implemented")}resetWebGL(){throw new Error("not implemented")}static _getCanvasContextProps(e){return!0===e.createCanvasContext?{}:e.createCanvasContext}_normalizeBufferProps(e){(e instanceof ArrayBuffer||ArrayBuffer.isView(e))&&(e={data:e});const t={...e};return(e.usage||0)&oS.INDEX&&!e.indexType&&(e.data instanceof Uint32Array?t.indexType="uint32":e.data instanceof Uint16Array?t.indexType="uint16":eS.warn("indices buffer content must be of integer type")()),t}}const RS=nx()&&"undefined"!=typeof document,kS="No matching device found. Ensure `@luma.gl/webgl` and/or `@luma.gl/webgpu` modules are imported.";class TS{static defaultProps={...IS.defaultProps,type:"best-available",adapters:void 0,waitForPageLoad:!0};static pageLoaded=function(){if(RS&&"complete"===document.readyState||"undefined"==typeof window)return Promise.resolve();return new Promise(e=>{window.addEventListener("load",()=>e())})}().then(()=>{eS.probe(2,"DOM is loaded")()});stats=ZC;log=eS;VERSION="9.1.9";spector;preregisteredAdapters=new Map;constructor(){if(globalThis.luma){if(globalThis.luma.VERSION!==this.VERSION)throw eS.error(`Found luma.gl ${globalThis.luma.VERSION} while initialzing ${this.VERSION}`)(),eS.error("'yarn why @luma.gl/core' can help identify the source of the conflict")(),new Error("luma.gl - multiple versions detected: see console log");eS.error("This version of luma.gl has already been initialized")()}eS.log(1,`${this.VERSION} - set luma.log.level=1 (or higher) to trace rendering`)(),globalThis.luma=this}registerAdapters(e){for(const t of e)this.preregisteredAdapters.set(t.type,t)}getSupportedAdapters(e=[]){const t=this.getAdapterMap(e);return Array.from(t).map(([,e])=>e).filter(e=>e.isSupported?.()).map(e=>e.type)}getBestAvailableAdapter(e=[]){const t=this.getAdapterMap(e);return t.get("webgpu")?.isSupported?.()?"webgpu":t.get("webgl")?.isSupported?.()?"webgl":null}setDefaultDeviceProps(e){Object.assign(TS.defaultProps,e)}async createDevice(e={}){(e={...TS.defaultProps,...e}).waitForPageLoad&&await TS.pageLoaded;const t=this.getAdapterMap(e.adapters);let n=e.type||"";"best-available"===n&&(n=this.getBestAvailableAdapter(e.adapters)||n);const r=(this.getAdapterMap(e.adapters)||t).get(n),o=await(r?.create?.(e));if(o)return o;throw new Error(kS)}async attachDevice(e){const t=this.getAdapterMap(e.adapters);let n="";e.handle instanceof WebGL2RenderingContext&&(n="webgl"),e.createCanvasContext&&await TS.pageLoaded,null===e.handle&&(n="unknown");const r=t.get(n),o=await(r?.attach?.(null));if(o)return o;throw new Error(kS)}enforceWebGL2(e=!0,t=[]){const n=this.getAdapterMap(t).get("webgl");n||eS.warn("enforceWebGL2: webgl adapter not found")(),n?.enforceWebGL2?.(e)}getAdapterMap(e=[]){const t=new Map(this.preregisteredAdapters);for(const n of e)t.set(n.type,n);return t}registerDevices(e){eS.warn("luma.registerDevices() is deprecated, use luma.registerAdapters() instead");for(const t of e){const e=t.adapter;e&&this.preregisteredAdapters.set(e.type,e)}}}const PS=new TS;class FS{}class MS{static defaultProps={canvas:null,width:800,height:600,useDevicePixels:!0,autoResize:!0,container:null,visible:!0,alphaMode:"opaque",colorSpace:"srgb"};id;props;canvas;htmlCanvas;offscreenCanvas;type;width=1;height=1;resizeObserver;_canvasSizeInfo={clientWidth:0,clientHeight:0,devicePixelRatio:1};toString(){return`${this[Symbol.toStringTag]}(${this.id})`}constructor(e){if(this.props={...MS.defaultProps,...e},e=this.props,!nx())return this.id="node-canvas-context",this.type="node",this.width=this.props.width,this.height=this.props.height,void(this.canvas=null);if(e.canvas)"string"==typeof e.canvas?this.canvas=function(e){const t=document.getElementById(e);if(!(t instanceof HTMLCanvasElement))throw new Error("Object is not a canvas element");return t}(e.canvas):this.canvas=e.canvas;else{const t=function(e){const{width:t,height:n}=e,r=document.createElement("canvas");return r.id=nS("lumagl-auto-created-canvas"),r.width=t||1,r.height=n||1,r.style.width=Number.isFinite(t)?`${t}px`:"100%",r.style.height=Number.isFinite(n)?`${n}px`:"100%",r}(e),n=function(e){if("string"==typeof e){const t=document.getElementById(e);if(!t)throw new Error(`${e} is not an HTML element`);return t}if(e)return e;return document.body}(e?.container||null);n.insertBefore(t,n.firstChild),this.canvas=t,e?.visible||(this.canvas.style.visibility="hidden")}this.canvas instanceof HTMLCanvasElement?(this.id=this.canvas.id,this.type="html-canvas",this.htmlCanvas=this.canvas):(this.id="offscreen-canvas",this.type="offscreen-canvas",this.offscreenCanvas=this.canvas),this.canvas instanceof HTMLCanvasElement&&e.autoResize&&(this.resizeObserver=new ResizeObserver(e=>{for(const t of e)t.target===this.canvas&&this.update()}),this.resizeObserver.observe(this.canvas))}getDevicePixelRatio(e){if("undefined"!=typeof OffscreenCanvas&&this.canvas instanceof OffscreenCanvas)return 1;if(!(e=void 0===e?this.props.useDevicePixels:e)||e<=0)return 1;if(!0===e){return"undefined"!=typeof window&&window.devicePixelRatio||1}return e}getPixelSize(){switch(this.type){case"node":return[this.width,this.height];case"offscreen-canvas":return[this.canvas.width,this.canvas.height];case"html-canvas":const e=this.getDevicePixelRatio(),t=this.canvas;return t.parentElement?[t.clientWidth*e,t.clientHeight*e]:[this.canvas.width,this.canvas.height];default:throw new Error(this.type)}}getAspect(){const[e,t]=this.getPixelSize();return e/t}cssToDeviceRatio(){try{const[e]=this.getDrawingBufferSize(),t=this._canvasSizeInfo.clientWidth||this.htmlCanvas?.clientWidth;return t?e/t:1}catch{return 1}}cssToDevicePixels(e,t=!0){const n=this.cssToDeviceRatio(),[r,o]=this.getDrawingBufferSize();return function(e,t,n,r,o){const i=e,s=LS(i[0],t,n);let a=US(i[1],t,r,o),l=LS(i[0]+1,t,n);const c=l===n-1?l:l-1;let u;l=US(i[1]+1,t,r,o),o?(l=0===l?l:l+1,u=a,a=l):u=l===r-1?l:l-1;return{x:s,y:a,width:Math.max(c-s+1,1),height:Math.max(u-a+1,1)}}(e,n,r,o,t)}setDevicePixelRatio(e,t={}){if(!this.htmlCanvas)return;let n="width"in t?t.width:this.htmlCanvas.clientWidth,r="height"in t?t.height:this.htmlCanvas.clientHeight;n&&r||(eS.log(1,"Canvas clientWidth/clientHeight is 0")(),e=1,n=this.htmlCanvas.width||1,r=this.htmlCanvas.height||1);const o=this._canvasSizeInfo;if(o.clientWidth!==n||o.clientHeight!==r||o.devicePixelRatio!==e){let t=e;const o=Math.floor(n*t),i=Math.floor(r*t);this.htmlCanvas.width=o,this.htmlCanvas.height=i;if(this.device.gl){const[s,a]=this.getDrawingBufferSize();s===o&&a===i||(t=Math.min(s/n,a/r),this.htmlCanvas.width=Math.floor(n*t),this.htmlCanvas.height=Math.floor(r*t),eS.warn("Device pixel ratio clamped")()),this._canvasSizeInfo.clientWidth=n,this._canvasSizeInfo.clientHeight=r,this._canvasSizeInfo.devicePixelRatio=e}}}getDrawingBufferSize(){const e=this.device.gl;return e?[e.drawingBufferWidth,e.drawingBufferHeight]:this.getPixelSize()}_setAutoCreatedCanvasId(e){"lumagl-auto-created-canvas"===this.htmlCanvas?.id&&(this.htmlCanvas.id=e)}}function LS(e,t,n){return Math.min(Math.round(e*t),n-1)}function US(e,t,n,r){return r?Math.max(0,n-1-Math.round(e*t)):Math.min(Math.round(e*t),n-1)}class OS extends rS{static COPY_SRC=1;static COPY_DST=2;static TEXTURE=4;static STORAGE=8;static RENDER_ATTACHMENT=16;static CubeFaces=["+X","-X","+Y","-Y","+Z","-Z"];static defaultProps={...rS.defaultProps,data:null,dimension:"2d",format:"rgba8unorm",width:void 0,height:void 0,depth:1,mipmaps:!1,compressed:!1,usage:0,mipLevels:void 0,samples:void 0,sampler:{},view:void 0,flipY:void 0};get[Symbol.toStringTag](){return"Texture"}toString(){return`Texture(${this.id},${this.format},${this.width}x${this.height})`}dimension;format;width;height;depth;mipLevels;updateTimestamp;constructor(e,t){if(super(e,t=OS.normalizeProps(e,t),OS.defaultProps),this.dimension=this.props.dimension,this.format=this.props.format,this.width=this.props.width,this.height=this.props.height,this.depth=this.props.depth,void 0===this.props.width||void 0===this.props.height){const e=OS.getTextureDataSize(this.props.data);this.width=e?.width||1,this.height=e?.height||1}this.props.mipmaps&&void 0===this.props.mipLevels&&(this.props.mipLevels="pyramid"),this.mipLevels="pyramid"===this.props.mipLevels?OS.getMipLevelCount(this.width,this.height):this.props.mipLevels||1,this.updateTimestamp=e.incrementTimestamp()}clone(e){return this.device.createTexture({...this.props,...e})}static isExternalImage(e){return"undefined"!=typeof ImageData&&e instanceof ImageData||"undefined"!=typeof ImageBitmap&&e instanceof ImageBitmap||"undefined"!=typeof HTMLImageElement&&e instanceof HTMLImageElement||"undefined"!=typeof HTMLVideoElement&&e instanceof HTMLVideoElement||"undefined"!=typeof VideoFrame&&e instanceof VideoFrame||"undefined"!=typeof HTMLCanvasElement&&e instanceof HTMLCanvasElement||"undefined"!=typeof OffscreenCanvas&&e instanceof OffscreenCanvas}static getExternalImageSize(e){if("undefined"!=typeof ImageData&&e instanceof ImageData||"undefined"!=typeof ImageBitmap&&e instanceof ImageBitmap||"undefined"!=typeof HTMLCanvasElement&&e instanceof HTMLCanvasElement||"undefined"!=typeof OffscreenCanvas&&e instanceof OffscreenCanvas)return{width:e.width,height:e.height};if("undefined"!=typeof HTMLImageElement&&e instanceof HTMLImageElement)return{width:e.naturalWidth,height:e.naturalHeight};if("undefined"!=typeof HTMLVideoElement&&e instanceof HTMLVideoElement)return{width:e.videoWidth,height:e.videoHeight};if("undefined"!=typeof VideoFrame&&e instanceof VideoFrame)return{width:e.displayWidth,height:e.displayHeight};throw new Error("Unknown image type")}static isTextureLevelData(e){const t=e?.data;return ArrayBuffer.isView(t)}static getTextureDataSize(e){if(!e)return null;if(ArrayBuffer.isView(e))return null;if(Array.isArray(e))return OS.getTextureDataSize(e[0]);if(OS.isExternalImage(e))return OS.getExternalImageSize(e);if(e&&"object"==typeof e&&e.constructor===Object){const t=Object.values(e)[0];return{width:t.width,height:t.height}}throw new Error("texture size deduction failed")}static normalizeTextureData(e,t){let n;return n=ArrayBuffer.isView(e)?[{data:e,width:t.width,height:t.height}]:Array.isArray(e)?e:[e],n}static getMipLevelCount(e,t){return Math.floor(Math.log2(Math.max(e,t)))+1}static getCubeFaceDepth(e){switch(e){case"+X":return 0;case"-X":return 1;case"+Y":return 2;case"-Y":return 3;case"+Z":return 4;case"-Z":return 5;default:throw new Error(e)}}static defaultCopyExternalImageOptions={image:void 0,sourceX:0,sourceY:0,width:void 0,height:void 0,depth:1,mipLevel:0,x:0,y:0,z:0,aspect:"all",colorSpace:"srgb",premultipliedAlpha:!1,flipY:!1};static normalizeProps(e,t){const n={...t},r=e?.props?._resourceDefaults?.texture||{};Object.assign(n,r);const{width:o,height:i}=n;return"number"==typeof o&&(n.width=Math.max(1,Math.ceil(o))),"number"==typeof i&&(n.height=Math.max(1,Math.ceil(i))),n}}class DS extends rS{static defaultProps={...rS.defaultProps,format:void 0,dimension:void 0,aspect:"all",baseMipLevel:0,mipLevelCount:void 0,baseArrayLayer:0,arrayLayerCount:void 0};get[Symbol.toStringTag](){return"TextureView"}constructor(e,t){super(e,t,DS.defaultProps)}}function NS(e,t,n,r){if(r?.inlineSource){const r=function(e,t,n){let r="";for(let o=t-2;o<=t;o++){const i=e[o-1];void 0!==i&&(r+=jS(i,t,n))}return r}(t,n);return`\n${r}${e.linePos>0?`${" ".repeat(e.linePos+5)}^^^\n`:""}${e.type.toUpperCase()}: ${e.message}\n\n`}const o="error"===e.type?"red":"#8B4000";return r?.html?`<div class='luma-compiler-log-error' style="color:${o};"><b> ${e.type.toUpperCase()}: ${e.message}</b></div>`:`${e.type.toUpperCase()}: ${e.message}`}function jS(e,t,n){const r=n?.html?e.replaceAll("&","&amp;").replaceAll("<","&lt;").replaceAll(">","&gt;").replaceAll('"',"&quot;").replaceAll("'","&#039;"):e;return`${function(e,t){let n="";for(let r=e.length;r<t;++r)n+=" ";return n+e}(String(t),4)}: ${r}${n?.html?"<br/>":"\n"}`}class QS extends rS{static defaultProps={...rS.defaultProps,language:"auto",stage:void 0,source:"",sourceMap:null,entryPoint:"main",debugShaders:void 0};get[Symbol.toStringTag](){return"Shader"}stage;source;compilationStatus="pending";constructor(e,t){super(e,{id:zS(t={...t,debugShaders:t.debugShaders||e.props.debugShaders||"errors"}),...t},QS.defaultProps),this.stage=this.props.stage,this.source=this.props.source}getCompilationInfoSync(){return null}getTranslatedSource(){return null}async debugShader(){const e=this.props.debugShaders;switch(e){case"never":return;case"errors":if("success"===this.compilationStatus)return}const t=await this.getCompilationInfo();"warnings"===e&&0===t?.length||this._displayShaderLog(t)}_displayShaderLog(e){if("undefined"==typeof document||!document?.createElement)return;const t=HS(this.source),n=`${this.stage} ${t}`;let r=function(e,t,n){let r="";const o=t.split(/\r?\n/),i=e.slice().sort((e,t)=>e.lineNum-t.lineNum);switch(n?.showSourceCode||"no"){case"all":let t=0;for(let e=1;e<=o.length;e++)for(r+=jS(o[e-1],e,n);i.length>t&&i[t].lineNum===e;){const e=i[t++];r+=NS(e,o,e.lineNum,{...n,inlineSource:!1})}return r;case"issues":case"no":for(const i of e)r+=NS(i,o,i.lineNum,{inlineSource:"no"!==n?.showSourceCode});return r}}(e,this.source,{showSourceCode:"all",html:!0});const o=this.getTranslatedSource();o&&(r+=`<br /><br /><h1>Translated Source</h1><br /><br /><code style="user-select:text;"><pre>${o}</pre></code>`);const i=document.createElement("Button");i.innerHTML=`\n<h1>Shader Compilation Error in ${n}</h1><br /><br />\n<code style="user-select:text;"><pre>\n${r}\n</pre></code>`,i.style.top="10px",i.style.left="10px",i.style.position="absolute",i.style.zIndex="9999",i.style.width="100%",i.style.textAlign="left",document.body.appendChild(i);const s=document.getElementsByClassName("luma-compiler-log-error");s[0]?.scrollIntoView(),i.onclick=()=>{const e=`data:text/plain,${encodeURIComponent(this.source)}`;navigator.clipboard.writeText(e)}}}function zS(e){return HS(e.source)||e.id||nS(`unnamed ${e.stage}-shader`)}function HS(e,t="unnamed"){const n=/#define[\s*]SHADER_NAME[\s*]([A-Za-z0-9_-]+)[\s*]/.exec(e);return n?n[1]:t}class GS extends rS{static defaultProps={...rS.defaultProps,type:"color-sampler",addressModeU:"clamp-to-edge",addressModeV:"clamp-to-edge",addressModeW:"clamp-to-edge",magFilter:"nearest",minFilter:"nearest",mipmapFilter:"none",lodMinClamp:0,lodMaxClamp:32,compare:"less-equal",maxAnisotropy:1};get[Symbol.toStringTag](){return"Sampler"}constructor(e,t){super(e,t=GS.normalizeProps(e,t),GS.defaultProps)}static normalizeProps(e,t){return{...t,...e?.props?._resourceDefaults?.sampler||{}}}}class VS extends rS{static defaultProps={...rS.defaultProps,width:1,height:1,colorAttachments:[],depthStencilAttachment:null};get[Symbol.toStringTag](){return"Framebuffer"}width;height;constructor(e,t={}){super(e,t,VS.defaultProps),this.width=this.props.width,this.height=this.props.height}clone(e){const t=this.colorAttachments.map(t=>t.texture.clone(e)),n=this.depthStencilAttachment&&this.depthStencilAttachment.texture.clone(e);return this.device.createFramebuffer({...this.props,colorAttachments:t,depthStencilAttachment:n})}resize(e){let t=!e;if(e){const[n,r]=Array.isArray(e)?e:[e.width,e.height];t=t||r!==this.height||n!==this.width,this.width=n,this.height=r}t&&(eS.log(2,`Resizing framebuffer ${this.id} to ${this.width}x${this.height}`)(),this.resizeAttachments(this.width,this.height))}autoCreateAttachmentTextures(){if(0===this.props.colorAttachments.length&&!this.props.depthStencilAttachment)throw new Error("Framebuffer has noattachments");this.colorAttachments=this.props.colorAttachments.map((e,t)=>{if("string"==typeof e){const n=this.createColorTexture(e,t);return this.attachResource(n),n.view}return e instanceof OS?e.view:e});const e=this.props.depthStencilAttachment;if(e)if("string"==typeof e){const t=this.createDepthStencilTexture(e);this.attachResource(t),this.depthStencilAttachment=t.view}else this.depthStencilAttachment=e instanceof OS?e.view:e}createColorTexture(e,t){return this.device.createTexture({id:`${this.id}-color-attachment-${t}`,usage:OS.RENDER_ATTACHMENT,format:e,width:this.width,height:this.height,sampler:{magFilter:"linear",minFilter:"linear"}})}createDepthStencilTexture(e){return this.device.createTexture({id:`${this.id}-depth-stencil-attachment`,usage:OS.RENDER_ATTACHMENT,format:e,width:this.width,height:this.height,mipmaps:!1})}resizeAttachments(e,t){for(let n=0;n<this.colorAttachments.length;++n)if(this.colorAttachments[n]){const r=this.colorAttachments[n].texture.clone({width:e,height:t});this.destroyAttachedResource(this.colorAttachments[n]),this.colorAttachments[n]=r.view,this.attachResource(r.view)}if(this.depthStencilAttachment){const n=this.depthStencilAttachment.texture.clone({width:e,height:t});this.destroyAttachedResource(this.depthStencilAttachment),this.depthStencilAttachment=n.view,this.attachResource(n)}this.updateAttachments()}}class WS extends rS{static defaultProps={...rS.defaultProps,vs:null,vertexEntryPoint:"vertexMain",vsConstants:{},fs:null,fragmentEntryPoint:"fragmentMain",fsConstants:{},shaderLayout:null,bufferLayout:[],topology:"triangle-list",parameters:{},bindings:{},uniforms:{}};get[Symbol.toStringTag](){return"RenderPipeline"}shaderLayout;bufferLayout;linkStatus="pending";hash="";constructor(e,t){super(e,t,WS.defaultProps),this.shaderLayout=this.props.shaderLayout,this.bufferLayout=this.props.bufferLayout||[]}setUniformsWebGL(e){throw new Error("Use uniform blocks")}}class $S extends rS{static defaultClearColor=[0,0,0,1];static defaultClearDepth=1;static defaultClearStencil=0;static defaultProps={...rS.defaultProps,framebuffer:null,parameters:void 0,clearColor:$S.defaultClearColor,clearColors:void 0,clearDepth:$S.defaultClearDepth,clearStencil:$S.defaultClearStencil,depthReadOnly:!1,stencilReadOnly:!1,discard:!1,occlusionQuerySet:void 0,timestampQuerySet:void 0,beginTimestampIndex:void 0,endTimestampIndex:void 0};get[Symbol.toStringTag](){return"RenderPass"}constructor(e,t){super(e,t=$S.normalizeProps(e,t),$S.defaultProps)}static normalizeProps(e,t){const n=e.props._resourceDefaults?.renderPass;return{...n,...t}}}class KS extends rS{static defaultProps={...rS.defaultProps,shader:void 0,entryPoint:void 0,constants:{},shaderLayout:void 0};get[Symbol.toStringTag](){return"ComputePipeline"}hash="";shaderLayout;constructor(e,t){super(e,t,KS.defaultProps),this.shaderLayout=t.shaderLayout}}class XS extends rS{static defaultProps={...rS.defaultProps,measureExecutionTime:void 0};get[Symbol.toStringTag](){return"CommandEncoder"}constructor(e,t){super(e,t,XS.defaultProps)}}class YS extends rS{static defaultProps={...rS.defaultProps};get[Symbol.toStringTag](){return"CommandBuffer"}constructor(e,t){super(e,t,YS.defaultProps)}}const qS={f32:["f32",1],"vec2<f32>":["f32",2],"vec3<f32>":["f32",3],"vec4<f32>":["f32",4],f16:["f16",1],"vec2<f16>":["f16",2],"vec3<f16>":["f16",3],"vec4<f16>":["f16",4],i32:["i32",1],"vec2<i32>":["i32",2],"vec3<i32>":["i32",3],"vec4<i32>":["i32",4],u32:["u32",1],"vec2<u32>":["u32",2],"vec3<u32>":["u32",3],"vec4<u32>":["u32",4]},JS={f32:4,f16:2,i32:4,u32:4};function ZS(e){let t;e.endsWith("-webgl")&&(e.replace("-webgl",""),t=!0);const[n,r]=e.split("x"),o=n,i=r?parseInt(r):1,s=iS(o),a={type:o,components:i,byteLength:s.byteLength*i,integer:s.integer,signed:s.signed,normalized:s.normalized};return t&&(a.webglOnly=!0),a}function eE(e,t){const n={};for(const r of e.attributes){const o=tE(e,t,r.name);o&&(n[r.name]=o)}return n}function tE(e,t,n){const r=function(e,t){const n=e.attributes.find(e=>e.name===t);n||eS.warn(`shader layout attribute "${t}" not present in shader`);return n||null}(e,n),o=function(e,t){!function(e){for(const t of e)(t.attributes&&t.format||!t.attributes&&!t.format)&&eS.warn(`BufferLayout ${name} must have either 'attributes' or 'format' field`)}(e);let n=function(e,t){for(const n of e)if(n.format&&n.name===t)return{attributeName:n.name,bufferName:t,stepMode:n.stepMode,vertexFormat:n.format,byteOffset:0,byteStride:n.byteStride||0};return null}(e,t);if(n)return n;if(n=function(e,t){for(const n of e){let e=n.byteStride;if("number"!=typeof n.byteStride)for(const t of n.attributes||[]){e+=ZS(t.format).byteLength}const r=n.attributes?.find(e=>e.attribute===t);if(r)return{attributeName:r.attribute,bufferName:n.name,stepMode:n.stepMode,vertexFormat:r.format,byteOffset:r.byteOffset,byteStride:e}}return null}(e,t),n)return n;return eS.warn(`layout for attribute "${t}" not present in buffer layout`),null}(t,n);if(!r)return null;const i=function(e){const[t,n]=qS[e],r="i32"===t||"u32"===t,o="u32"!==t,i=JS[t]*n,s=function(e,t){let n;switch(e){case"f32":n="float32";break;case"i32":n="sint32";break;case"u32":n="uint32";break;case"f16":return t<=2?"float16x2":"float16x4"}return 1===t?n:`${n}x${t}`}(t,n);return{dataType:t,components:n,defaultVertexFormat:s,byteLength:i,integer:r,signed:o}}(r.type),s=o?.vertexFormat||i.defaultVertexFormat,a=ZS(s);return{attributeName:o?.attributeName||r.name,bufferName:o?.bufferName||r.name,location:r.location,shaderType:r.type,shaderDataType:i.dataType,shaderComponents:i.components,vertexFormat:s,bufferDataType:a.type,bufferComponents:a.components,normalized:a.normalized,integer:i.integer,stepMode:o?.stepMode||r.stepMode||"vertex",byteOffset:o?.byteOffset||0,byteStride:o?.byteStride||0}}class nE extends rS{static defaultProps={...rS.defaultProps,renderPipeline:null};get[Symbol.toStringTag](){return"VertexArray"}maxVertexAttributes;attributeInfos;indexBuffer=null;attributes;constructor(e,t){super(e,t,nE.defaultProps),this.maxVertexAttributes=e.limits.maxVertexAttributes,this.attributes=new Array(this.maxVertexAttributes).fill(null);const{shaderLayout:n,bufferLayout:r}=t.renderPipeline||{};if(!n||!r)throw new Error("VertexArray");this.attributeInfos=function(e,t,n=16){const r=eE(e,t),o=new Array(n).fill(null);for(const i of Object.values(r))o[i.location]=i;return o}(n,r,this.maxVertexAttributes)}setConstantWebGL(e,t){this.device.reportError(new Error("constant attributes not supported"))}}class rE extends rS{static defaultProps={...rS.defaultProps,layout:void 0,buffers:{}};get[Symbol.toStringTag](){return"TransformFeedback"}constructor(e,t){super(e,t,rE.defaultProps)}}class oE extends rS{static defaultProps={...rS.defaultProps,type:void 0,count:void 0};get[Symbol.toStringTag](){return"QuerySet"}constructor(e,t){super(e,t,oE.defaultProps)}}const iE={f32:{type:"f32",components:1},i32:{type:"i32",components:1},u32:{type:"u32",components:1},"vec2<f32>":{type:"f32",components:2},"vec3<f32>":{type:"f32",components:3},"vec4<f32>":{type:"f32",components:4},"vec2<i32>":{type:"i32",components:2},"vec3<i32>":{type:"i32",components:3},"vec4<i32>":{type:"i32",components:4},"vec2<u32>":{type:"u32",components:2},"vec3<u32>":{type:"u32",components:3},"vec4<u32>":{type:"u32",components:4},"mat2x2<f32>":{type:"f32",components:4},"mat2x3<f32>":{type:"f32",components:6},"mat2x4<f32>":{type:"f32",components:8},"mat3x2<f32>":{type:"f32",components:6},"mat3x3<f32>":{type:"f32",components:9},"mat3x4<f32>":{type:"f32",components:12},"mat4x2<f32>":{type:"f32",components:8},"mat4x3<f32>":{type:"f32",components:12},"mat4x4<f32>":{type:"f32",components:16}};function sE(e){return iE[e]}function aE(e,t){switch(t){case 1:return e;case 2:return e+e%2;default:return e+(4-e%4)%4}}let lE;function cE(e){return(!lE||lE.byteLength<e)&&(lE=new ArrayBuffer(e)),lE}function uE(e){return Array.isArray(e)?0===e.length||"number"==typeof e[0]:function(e){return ArrayBuffer.isView(e)&&!(e instanceof DataView)}(e)}class dE{layout={};byteLength;constructor(e){let t=0;for(const[r,o]of Object.entries(e)){const e=sE(o),{type:n,components:i}=e;t=aE(t,i);const s=t;t+=i,this.layout[r]={type:n,size:i,offset:s}}t+=(4-t%4)%4;const n=4*t;this.byteLength=Math.max(n,1024)}getData(e){const t=cE(Math.max(this.byteLength,1024)),n={i32:new Int32Array(t),u32:new Uint32Array(t),f32:new Float32Array(t),f16:new Uint16Array(t)};for(const[r,o]of Object.entries(e)){const e=this.layout[r];if(!e){eS.warn(`Supplied uniform value ${r} not present in uniform block layout`)();continue}const{type:t,size:i,offset:s}=e,a=n[t];if(1===i){if("number"!=typeof o&&"boolean"!=typeof o){eS.warn(`Supplied value for single component uniform ${r} is not a number: ${o}`)();continue}a[s]=Number(o)}else{if(!uE(o)){eS.warn(`Supplied value for multi component / array uniform ${r} is not a numeric array: ${o}`)();continue}a.set(o,s)}}return new Uint8Array(t)}has(e){return Boolean(this.layout[e])}get(e){return this.layout[e]}}class AE{name;uniforms={};modifiedUniforms={};modified=!0;bindingLayout={};needsRedraw="initialized";constructor(e){if(this.name=e?.name||"unnamed",e?.name&&e?.shaderLayout){const t=e?.shaderLayout.bindings?.find(t=>"uniform"===t.type&&t.name===e?.name);if(!t)throw new Error(e?.name);const n=t;for(const e of n.uniforms||[])this.bindingLayout[e.name]=e}}setUniforms(e){for(const[t,n]of Object.entries(e))this._setUniform(t,n),this.needsRedraw||this.setNeedsRedraw(`${this.name}.${t}=${n}`)}setNeedsRedraw(e){this.needsRedraw=this.needsRedraw||e}getAllUniforms(){return this.modifiedUniforms={},this.needsRedraw=!1,this.uniforms||{}}_setUniform(e,t){var n;(function(e,t){if(e!==t)return!1;const n=e,r=t;if(!uE(n))return!1;if(uE(r)&&n.length===r.length)for(let o=0;o<n.length;++o)if(r[o]!==n[o])return!1;return!0})(this.uniforms[e],t)||(this.uniforms[e]=uE(n=t)?n.slice():n,this.modifiedUniforms[e]=!0,this.modified=!0)}}class hE{uniformBlocks=new Map;uniformBufferLayouts=new Map;uniformBuffers=new Map;constructor(e){for(const[t,n]of Object.entries(e)){const e=t,r=new dE(n.uniformTypes||{});this.uniformBufferLayouts.set(e,r);const o=new AE({name:t});o.setUniforms(n.defaultUniforms||{}),this.uniformBlocks.set(e,o)}}destroy(){for(const e of this.uniformBuffers.values())e.destroy()}setUniforms(e){for(const[t,n]of Object.entries(e))this.uniformBlocks.get(t)?.setUniforms(n);this.updateUniformBuffers()}getUniformBufferByteLength(e){return this.uniformBufferLayouts.get(e)?.byteLength||0}getUniformBufferData(e){const t=this.uniformBlocks.get(e)?.getAllUniforms()||{};return this.uniformBufferLayouts.get(e)?.getData(t)}createUniformBuffer(e,t,n){n&&this.setUniforms(n);const r=this.getUniformBufferByteLength(t),o=e.createBuffer({usage:oS.UNIFORM|oS.COPY_DST,byteLength:r}),i=this.getUniformBufferData(t);return o.write(i),o}getManagedUniformBuffer(e,t){if(!this.uniformBuffers.get(t)){const n=this.getUniformBufferByteLength(t),r=e.createBuffer({usage:oS.UNIFORM|oS.COPY_DST,byteLength:n});this.uniformBuffers.set(t,r)}return this.uniformBuffers.get(t)}updateUniformBuffers(){let e=!1;for(const t of this.uniformBlocks.keys()){const n=this.updateUniformBuffer(t);e||=n}return e&&eS.log(3,`UniformStore.updateUniformBuffers(): ${e}`)(),e}updateUniformBuffer(e){const t=this.uniformBlocks.get(e);let n=this.uniformBuffers.get(e),r=!1;if(n&&t?.needsRedraw){r||=t.needsRedraw;const o=this.getUniformBufferData(e);n=this.uniformBuffers.get(e),n?.write(o);const i=this.uniformBlocks.get(e)?.getAllUniforms();eS.log(4,`Writing to uniform buffer ${String(e)}`,o,i)()}return r}}function pE(e){const t=ArrayBuffer.isView(e)?e.constructor:e;switch(t){case Float32Array:return"float32";case Uint16Array:return"uint16";case Uint32Array:return"uint32";case Uint8Array:case Uint8ClampedArray:return"uint8";case Int8Array:return"sint8";case Int16Array:return"sint16";case Int32Array:return"sint32";default:throw new Error(t.constructor.name)}}function fE(e){switch(e){case"float32":return Float32Array;case"uint32":return Uint32Array;case"sint32":return Int32Array;case"uint16":case"unorm16":return Uint16Array;case"sint16":case"snorm16":return Int16Array;case"uint8":case"unorm8":return Uint8Array;case"sint8":case"snorm8":return Int8Array;default:throw new Error(e)}}function gE(e,t,n){if(!t||t>4)throw new Error(`size ${t}`);const r=t;let o=pE(e);if("uint8"===o&&n&&1===r)return"unorm8-webgl";if("uint8"===o&&n&&3===r)return"unorm8x3-webgl";if("uint8"===o||"sint8"===o){if(1===r||3===r)throw new Error(`size: ${t}`);return n&&(o=o.replace("int","norm")),`${o}x${r}`}if("uint16"===o||"sint16"===o){if(1===r||3===r)throw new Error(`size: ${t}`);return n&&(o=o.replace("int","norm")),`${o}x${r}`}return 1===r?o:`${o}x${r}`}class mE{bufferLayouts;constructor(e){this.bufferLayouts=e}getBufferLayout(e){return this.bufferLayouts.find(t=>t.name===e)||null}getAttributeNamesForBuffer(e){return e.attributes?e.attributes?.map(e=>e.attribute):[e.name]}mergeBufferLayouts(e,t){const n=[...e];for(const r of t){const e=n.findIndex(e=>e.name===r.name);e<0?n.push(r):n[e]=r}return n}getBufferIndex(e){const t=this.bufferLayouts.findIndex(t=>t.name===e);return-1===t&&eS.warn(`BufferLayout: Missing buffer for "${e}".`)(),t}}let yE=class{constructor(e,t){this.name=e,this.attributes=t,this.size=0}get isArray(){return!1}get isStruct(){return!1}get isTemplate(){return!1}get isPointer(){return!1}getTypeName(){return this.name}},vE=class{constructor(e,t,n){this.name=e,this.type=t,this.attributes=n,this.offset=0,this.size=0}get isArray(){return this.type.isArray}get isStruct(){return this.type.isStruct}get isTemplate(){return this.type.isTemplate}get align(){return this.type.isStruct?this.type.align:0}get members(){return this.type.isStruct?this.type.members:null}get format(){return this.type.isArray||this.type.isTemplate?this.type.format:null}get count(){return this.type.isArray?this.type.count:0}get stride(){return this.type.isArray?this.type.stride:this.size}},bE=class extends yE{constructor(e,t){super(e,t),this.members=[],this.align=0,this.startLine=-1,this.endLine=-1,this.inUse=!1}get isStruct(){return!0}},wE=class extends yE{constructor(e,t){super(e,t),this.count=0,this.stride=0}get isArray(){return!0}getTypeName(){return`array<${this.format.getTypeName()}, ${this.count}>`}},xE=class extends yE{constructor(e,t,n){super(e,n),this.format=t}get isPointer(){return!0}getTypeName(){return`&${this.format.getTypeName()}`}},_E=class extends yE{constructor(e,t,n,r){super(e,n),this.format=t,this.access=r}get isTemplate(){return!0}getTypeName(){let e=this.name;if(null!==this.format){if("vec2"===e||"vec3"===e||"vec4"===e||"mat2x2"===e||"mat2x3"===e||"mat2x4"===e||"mat3x2"===e||"mat3x3"===e||"mat3x4"===e||"mat4x2"===e||"mat4x3"===e||"mat4x4"===e){if("f32"===this.format.name)return e+="f",e;if("i32"===this.format.name)return e+="i",e;if("u32"===this.format.name)return e+="u",e;if("bool"===this.format.name)return e+="b",e;if("f16"===this.format.name)return e+="h",e}e+=`<${this.format.name}>`}else if("vec2"===e||"vec3"===e||"vec4"===e)return e;return e}};var CE,SE;(SE=CE||(CE={}))[SE.Uniform=0]="Uniform",SE[SE.Storage=1]="Storage",SE[SE.Texture=2]="Texture",SE[SE.Sampler=3]="Sampler",SE[SE.StorageTexture=4]="StorageTexture";let EE=class{constructor(e,t,n,r,o,i,s){this.name=e,this.type=t,this.group=n,this.binding=r,this.attributes=o,this.resourceType=i,this.access=s}get isArray(){return this.type.isArray}get isStruct(){return this.type.isStruct}get isTemplate(){return this.type.isTemplate}get size(){return this.type.size}get align(){return this.type.isStruct?this.type.align:0}get members(){return this.type.isStruct?this.type.members:null}get format(){return this.type.isArray||this.type.isTemplate?this.type.format:null}get count(){return this.type.isArray?this.type.count:0}get stride(){return this.type.isArray?this.type.stride:this.size}},BE=class{constructor(e,t){this.name=e,this.type=t}},IE=class{constructor(e,t,n,r){this.name=e,this.type=t,this.locationType=n,this.location=r,this.interpolation=null}},RE=class{constructor(e,t,n,r){this.name=e,this.type=t,this.locationType=n,this.location=r}};class kE{constructor(e,t,n,r){this.name=e,this.type=t,this.attributes=n,this.id=r}}let TE=class{constructor(e,t,n){this.name=e,this.type=t,this.attributes=n}},PE=class{constructor(e,t=null,n){this.stage=null,this.inputs=[],this.outputs=[],this.arguments=[],this.returnType=null,this.resources=[],this.overrides=[],this.startLine=-1,this.endLine=-1,this.inUse=!1,this.calls=new Set,this.name=e,this.stage=t,this.attributes=n}},FE=class{constructor(){this.vertex=[],this.fragment=[],this.compute=[]}};function ME(e){var t=(32768&e)>>15,n=(31744&e)>>10,r=1023&e;return 0==n?(t?-1:1)*Math.pow(2,-14)*(r/Math.pow(2,10)):31==n?r?NaN:1/0*(t?-1:1):(t?-1:1)*Math.pow(2,n-15)*(1+r/Math.pow(2,10))}const LE=new Float32Array(1),UE=new Int32Array(LE.buffer),OE=new Uint16Array(1);function DE(e){LE[0]=e;const t=UE[0],n=t>>31&1;let r=t>>23&255,o=8388607&t;if(255===r)return OE[0]=n<<15|31744|(0!==o?512:0),OE[0];if(0===r){if(0===o)return OE[0]=n<<15,OE[0];o|=8388608;let e=113;for(;!(8388608&o);)o<<=1,e--;return r=127-e,o&=8388607,r>0?(o=(o>>126-r)+(o>>127-r&1),OE[0]=n<<15|r<<10|o>>13,OE[0]):(OE[0]=n<<15,OE[0])}return r=r-127+15,r>=31?(OE[0]=n<<15|31744,OE[0]):r<=0?r<-10?(OE[0]=n<<15,OE[0]):(o=(8388608|o)>>1-r,OE[0]=n<<15|o>>13,OE[0]):(o>>=13,OE[0]=n<<15|r<<10|o,OE[0])}const NE=new Uint32Array(1),jE=new Float32Array(NE.buffer,0,1);function QE(e){const t=112+(e>>6&31)<<23|(63&e)<<17;return NE[0]=t,jE[0]}function zE(e,t,n,r){const o=[0,0,0,0];for(let i=0;i<r;++i)switch(n){case"8unorm":o[i]=e[t]/255,t++;break;case"8snorm":o[i]=e[t]/255*2-1,t++;break;case"8uint":o[i]=e[t],t++;break;case"8sint":o[i]=e[t]-127,t++;break;case"16uint":o[i]=e[t]|e[t+1]<<8,t+=2;break;case"16sint":o[i]=(e[t]|e[t+1]<<8)-32768,t+=2;break;case"16float":o[i]=ME(e[t]|e[t+1]<<8),t+=2;break;case"32uint":case"32sint":o[i]=e[t]|e[t+1]<<8|e[t+2]<<16|e[t+3]<<24,t+=4;break;case"32float":o[i]=new Float32Array(e.buffer,t,1)[0],t+=4}return o}function HE(e,t,n,r,o){for(let i=0;i<r;++i)switch(n){case"8unorm":e[t]=255*o[i],t++;break;case"8snorm":e[t]=.5*(o[i]+1)*255,t++;break;case"8uint":e[t]=o[i],t++;break;case"8sint":e[t]=o[i]+127,t++;break;case"16uint":new Uint16Array(e.buffer,t,1)[0]=o[i],t+=2;break;case"16sint":new Int16Array(e.buffer,t,1)[0]=o[i],t+=2;break;case"16float":{const n=DE(o[i]);new Uint16Array(e.buffer,t,1)[0]=n,t+=2;break}case"32uint":new Uint32Array(e.buffer,t,1)[0]=o[i],t+=4;break;case"32sint":new Int32Array(e.buffer,t,1)[0]=o[i],t+=4;break;case"32float":new Float32Array(e.buffer,t,1)[0]=o[i],t+=4}return o}const GE={r8unorm:{bytesPerBlock:1,blockWidth:1,blockHeight:1,isCompressed:!1,channels:1},r8snorm:{bytesPerBlock:1,blockWidth:1,blockHeight:1,isCompressed:!1,channels:1},r8uint:{bytesPerBlock:1,blockWidth:1,blockHeight:1,isCompressed:!1,channels:1},r8sint:{bytesPerBlock:1,blockWidth:1,blockHeight:1,isCompressed:!1,channels:1},rg8unorm:{bytesPerBlock:2,blockWidth:1,blockHeight:1,isCompressed:!1,channels:2},rg8snorm:{bytesPerBlock:2,blockWidth:1,blockHeight:1,isCompressed:!1,channels:2},rg8uint:{bytesPerBlock:2,blockWidth:1,blockHeight:1,isCompressed:!1,channels:2},rg8sint:{bytesPerBlock:2,blockWidth:1,blockHeight:1,isCompressed:!1,channels:2},rgba8unorm:{bytesPerBlock:4,blockWidth:1,blockHeight:1,isCompressed:!1,channels:4},"rgba8unorm-srgb":{bytesPerBlock:4,blockWidth:1,blockHeight:1,isCompressed:!1,channels:4},rgba8snorm:{bytesPerBlock:4,blockWidth:1,blockHeight:1,isCompressed:!1,channels:4},rgba8uint:{bytesPerBlock:4,blockWidth:1,blockHeight:1,isCompressed:!1,channels:4},rgba8sint:{bytesPerBlock:4,blockWidth:1,blockHeight:1,isCompressed:!1,channels:4},bgra8unorm:{bytesPerBlock:4,blockWidth:1,blockHeight:1,isCompressed:!1,channels:4},"bgra8unorm-srgb":{bytesPerBlock:4,blockWidth:1,blockHeight:1,isCompressed:!1,channels:4},r16uint:{bytesPerBlock:2,blockWidth:1,blockHeight:1,isCompressed:!1,channels:1},r16sint:{bytesPerBlock:2,blockWidth:1,blockHeight:1,isCompressed:!1,channels:1},r16float:{bytesPerBlock:2,blockWidth:1,blockHeight:1,isCompressed:!1,channels:1},rg16uint:{bytesPerBlock:4,blockWidth:1,blockHeight:1,isCompressed:!1,channels:2},rg16sint:{bytesPerBlock:4,blockWidth:1,blockHeight:1,isCompressed:!1,channels:2},rg16float:{bytesPerBlock:4,blockWidth:1,blockHeight:1,isCompressed:!1,channels:2},rgba16uint:{bytesPerBlock:8,blockWidth:1,blockHeight:1,isCompressed:!1,channels:4},rgba16sint:{bytesPerBlock:8,blockWidth:1,blockHeight:1,isCompressed:!1,channels:4},rgba16float:{bytesPerBlock:8,blockWidth:1,blockHeight:1,isCompressed:!1,channels:4},r32uint:{bytesPerBlock:4,blockWidth:1,blockHeight:1,isCompressed:!1,channels:1},r32sint:{bytesPerBlock:4,blockWidth:1,blockHeight:1,isCompressed:!1,channels:1},r32float:{bytesPerBlock:4,blockWidth:1,blockHeight:1,isCompressed:!1,channels:1},rg32uint:{bytesPerBlock:8,blockWidth:1,blockHeight:1,isCompressed:!1,channels:2},rg32sint:{bytesPerBlock:8,blockWidth:1,blockHeight:1,isCompressed:!1,channels:2},rg32float:{bytesPerBlock:8,blockWidth:1,blockHeight:1,isCompressed:!1,channels:2},rgba32uint:{bytesPerBlock:16,blockWidth:1,blockHeight:1,isCompressed:!1,channels:4},rgba32sint:{bytesPerBlock:16,blockWidth:1,blockHeight:1,isCompressed:!1,channels:4},rgba32float:{bytesPerBlock:16,blockWidth:1,blockHeight:1,isCompressed:!1,channels:4},rgb10a2uint:{bytesPerBlock:4,blockWidth:1,blockHeight:1,isCompressed:!1,channels:4},rgb10a2unorm:{bytesPerBlock:4,blockWidth:1,blockHeight:1,isCompressed:!1,channels:4},rg11b10ufloat:{bytesPerBlock:4,blockWidth:1,blockHeight:1,isCompressed:!1,channels:4},stencil8:{bytesPerBlock:1,blockWidth:1,blockHeight:1,isCompressed:!1,isDepthStencil:!0,hasDepth:!1,hasStencil:!0,channels:1},depth16unorm:{bytesPerBlock:2,blockWidth:1,blockHeight:1,isCompressed:!1,isDepthStencil:!0,hasDepth:!0,hasStencil:!1,channels:1},depth24plus:{bytesPerBlock:4,blockWidth:1,blockHeight:1,isCompressed:!1,isDepthStencil:!0,hasDepth:!0,hasStencil:!1,depthOnlyFormat:"depth32float",channels:1},"depth24plus-stencil8":{bytesPerBlock:8,blockWidth:1,blockHeight:1,isCompressed:!1,isDepthStencil:!0,hasDepth:!0,hasStencil:!0,depthOnlyFormat:"depth32float",channels:1},depth32float:{bytesPerBlock:4,blockWidth:1,blockHeight:1,isCompressed:!1,isDepthStencil:!0,hasDepth:!0,hasStencil:!1,channels:1},"depth32float-stencil8":{bytesPerBlock:8,blockWidth:1,blockHeight:1,isCompressed:!1,isDepthStencil:!0,hasDepth:!0,hasStencil:!0,stencilOnlyFormat:"depth32float",channels:1},rgb9e5ufloat:{bytesPerBlock:4,blockWidth:1,blockHeight:1,isCompressed:!1,channels:4},"bc1-rgba-unorm":{bytesPerBlock:8,blockWidth:4,blockHeight:4,isCompressed:!0,channels:4},"bc1-rgba-unorm-srgb":{bytesPerBlock:8,blockWidth:4,blockHeight:4,isCompressed:!0,channels:4},"bc2-rgba-unorm":{bytesPerBlock:16,blockWidth:4,blockHeight:4,isCompressed:!0,channels:4},"bc2-rgba-unorm-srgb":{bytesPerBlock:16,blockWidth:4,blockHeight:4,isCompressed:!0,channels:4},"bc3-rgba-unorm":{bytesPerBlock:16,blockWidth:4,blockHeight:4,isCompressed:!0,channels:4},"bc3-rgba-unorm-srgb":{bytesPerBlock:16,blockWidth:4,blockHeight:4,isCompressed:!0,channels:4},"bc4-r-unorm":{bytesPerBlock:8,blockWidth:4,blockHeight:4,isCompressed:!0,channels:1},"bc4-r-snorm":{bytesPerBlock:8,blockWidth:4,blockHeight:4,isCompressed:!0,channels:1},"bc5-rg-unorm":{bytesPerBlock:16,blockWidth:4,blockHeight:4,isCompressed:!0,channels:2},"bc5-rg-snorm":{bytesPerBlock:16,blockWidth:4,blockHeight:4,isCompressed:!0,channels:2},"bc6h-rgb-ufloat":{bytesPerBlock:16,blockWidth:4,blockHeight:4,isCompressed:!0,channels:4},"bc6h-rgb-float":{bytesPerBlock:16,blockWidth:4,blockHeight:4,isCompressed:!0,channels:4},"bc7-rgba-unorm":{bytesPerBlock:16,blockWidth:4,blockHeight:4,isCompressed:!0,channels:4},"bc7-rgba-unorm-srgb":{bytesPerBlock:16,blockWidth:4,blockHeight:4,isCompressed:!0,channels:4},"etc2-rgb8unorm":{bytesPerBlock:8,blockWidth:4,blockHeight:4,isCompressed:!0,channels:4},"etc2-rgb8unorm-srgb":{bytesPerBlock:8,blockWidth:4,blockHeight:4,isCompressed:!0,channels:4},"etc2-rgb8a1unorm":{bytesPerBlock:8,blockWidth:4,blockHeight:4,isCompressed:!0,channels:4},"etc2-rgb8a1unorm-srgb":{bytesPerBlock:8,blockWidth:4,blockHeight:4,isCompressed:!0,channels:4},"etc2-rgba8unorm":{bytesPerBlock:16,blockWidth:4,blockHeight:4,isCompressed:!0,channels:4},"etc2-rgba8unorm-srgb":{bytesPerBlock:16,blockWidth:4,blockHeight:4,isCompressed:!0,channels:4},"eac-r11unorm":{bytesPerBlock:8,blockWidth:1,blockHeight:1,isCompressed:!0,channels:1},"eac-r11snorm":{bytesPerBlock:8,blockWidth:1,blockHeight:1,isCompressed:!0,channels:1},"eac-rg11unorm":{bytesPerBlock:16,blockWidth:1,blockHeight:1,isCompressed:!0,channels:2},"eac-rg11snorm":{bytesPerBlock:16,blockWidth:1,blockHeight:1,isCompressed:!0,channels:2},"astc-4x4-unorm":{bytesPerBlock:16,blockWidth:4,blockHeight:4,isCompressed:!0,channels:4},"astc-4x4-unorm-srgb":{bytesPerBlock:16,blockWidth:4,blockHeight:4,isCompressed:!0,channels:4},"astc-5x4-unorm":{bytesPerBlock:16,blockWidth:5,blockHeight:4,isCompressed:!0,channels:4},"astc-5x4-unorm-srgb":{bytesPerBlock:16,blockWidth:5,blockHeight:4,isCompressed:!0,channels:4},"astc-5x5-unorm":{bytesPerBlock:16,blockWidth:5,blockHeight:5,isCompressed:!0,channels:4},"astc-5x5-unorm-srgb":{bytesPerBlock:16,blockWidth:5,blockHeight:5,isCompressed:!0,channels:4},"astc-6x5-unorm":{bytesPerBlock:16,blockWidth:6,blockHeight:5,isCompressed:!0,channels:4},"astc-6x5-unorm-srgb":{bytesPerBlock:16,blockWidth:6,blockHeight:5,isCompressed:!0,channels:4},"astc-6x6-unorm":{bytesPerBlock:16,blockWidth:6,blockHeight:6,isCompressed:!0,channels:4},"astc-6x6-unorm-srgb":{bytesPerBlock:16,blockWidth:6,blockHeight:6,isCompressed:!0,channels:4},"astc-8x5-unorm":{bytesPerBlock:16,blockWidth:8,blockHeight:5,isCompressed:!0,channels:4},"astc-8x5-unorm-srgb":{bytesPerBlock:16,blockWidth:8,blockHeight:5,isCompressed:!0,channels:4},"astc-8x6-unorm":{bytesPerBlock:16,blockWidth:8,blockHeight:6,isCompressed:!0,channels:4},"astc-8x6-unorm-srgb":{bytesPerBlock:16,blockWidth:8,blockHeight:6,isCompressed:!0,channels:4},"astc-8x8-unorm":{bytesPerBlock:16,blockWidth:8,blockHeight:8,isCompressed:!0,channels:4},"astc-8x8-unorm-srgb":{bytesPerBlock:16,blockWidth:8,blockHeight:8,isCompressed:!0,channels:4},"astc-10x5-unorm":{bytesPerBlock:16,blockWidth:10,blockHeight:5,isCompressed:!0,channels:4},"astc-10x5-unorm-srgb":{bytesPerBlock:16,blockWidth:10,blockHeight:5,isCompressed:!0,channels:4},"astc-10x6-unorm":{bytesPerBlock:16,blockWidth:10,blockHeight:6,isCompressed:!0,channels:4},"astc-10x6-unorm-srgb":{bytesPerBlock:16,blockWidth:10,blockHeight:6,isCompressed:!0,channels:4},"astc-10x8-unorm":{bytesPerBlock:16,blockWidth:10,blockHeight:8,isCompressed:!0,channels:4},"astc-10x8-unorm-srgb":{bytesPerBlock:16,blockWidth:10,blockHeight:8,isCompressed:!0,channels:4},"astc-10x10-unorm":{bytesPerBlock:16,blockWidth:10,blockHeight:10,isCompressed:!0,channels:4},"astc-10x10-unorm-srgb":{bytesPerBlock:16,blockWidth:10,blockHeight:10,isCompressed:!0,channels:4},"astc-12x10-unorm":{bytesPerBlock:16,blockWidth:12,blockHeight:10,isCompressed:!0,channels:4},"astc-12x10-unorm-srgb":{bytesPerBlock:16,blockWidth:12,blockHeight:10,isCompressed:!0,channels:4},"astc-12x12-unorm":{bytesPerBlock:16,blockWidth:12,blockHeight:12,isCompressed:!0,channels:4},"astc-12x12-unorm-srgb":{bytesPerBlock:16,blockWidth:12,blockHeight:12,isCompressed:!0,channels:4}};let VE=class e{constructor(){this.id=e._id++,this.line=0}get isAstNode(){return!0}get astNodeType(){return""}search(e){e(this)}searchBlock(e,t){if(e){t(WE.instance);for(const n of e)n instanceof Array?this.searchBlock(n,t):n.search(t);t($E.instance)}}constEvaluate(e,t){throw new Error("Cannot evaluate node")}constEvaluateString(e){return this.constEvaluate(e).toString()}};VE._id=0;let WE=class extends VE{};WE.instance=new WE;let $E=class extends VE{};$E.instance=new $E;const KE=new Set(["all","all","any","select","arrayLength","abs","acos","acosh","asin","asinh","atan","atanh","atan2","ceil","clamp","cos","cosh","countLeadingZeros","countOneBits","countTrailingZeros","cross","degrees","determinant","distance","dot","dot4U8Packed","dot4I8Packed","exp","exp2","extractBits","faceForward","firstLeadingBit","firstTrailingBit","floor","fma","fract","frexp","insertBits","inverseSqrt","ldexp","length","log","log2","max","min","mix","modf","normalize","pow","quantizeToF16","radians","reflect","refract","reverseBits","round","saturate","sign","sin","sinh","smoothStep","sqrt","step","tan","tanh","transpose","trunc","dpdx","dpdxCoarse","dpdxFine","dpdy","dpdyCoarse","dpdyFine","fwidth","fwidthCoarse","fwidthFine","textureDimensions","textureGather","textureGatherCompare","textureLoad","textureNumLayers","textureNumLevels","textureNumSamples","textureSample","textureSampleBias","textureSampleCompare","textureSampleCompareLevel","textureSampleGrad","textureSampleLevel","textureSampleBaseClampToEdge","textureStore","atomicLoad","atomicStore","atomicAdd","atomicSub","atomicMax","atomicMin","atomicAnd","atomicOr","atomicXor","atomicExchange","atomicCompareExchangeWeak","pack4x8snorm","pack4x8unorm","pack4xI8","pack4xU8","pack4x8Clamp","pack4xU8Clamp","pack2x16snorm","pack2x16unorm","pack2x16float","unpack4x8snorm","unpack4x8unorm","unpack4xI8","unpack4xU8","unpack2x16snorm","unpack2x16unorm","unpack2x16float","storageBarrier","textureBarrier","workgroupBarrier","workgroupUniformLoad","subgroupAdd","subgroupExclusiveAdd","subgroupInclusiveAdd","subgroupAll","subgroupAnd","subgroupAny","subgroupBallot","subgroupBroadcast","subgroupBroadcastFirst","subgroupElect","subgroupMax","subgroupMin","subgroupMul","subgroupExclusiveMul","subgroupInclusiveMul","subgroupOr","subgroupShuffle","subgroupShuffleDown","subgroupShuffleUp","subgroupShuffleXor","subgroupXor","quadBroadcast","quadSwapDiagonal","quadSwapX","quadSwapY"]);let XE=class extends VE{constructor(){super()}};class YE extends XE{constructor(e,t,n,r,o,i){super(),this.calls=new Set,this.name=e,this.args=t,this.returnType=n,this.body=r,this.startLine=o,this.endLine=i}get astNodeType(){return"function"}search(e){if(this.attributes)for(const t of this.attributes)e(t);e(this);for(const t of this.args)e(t);this.searchBlock(this.body,e)}}let qE=class extends XE{constructor(e){super(),this.expression=e}get astNodeType(){return"staticAssert"}search(e){this.expression.search(e)}},JE=class extends XE{constructor(e,t){super(),this.condition=e,this.body=t}get astNodeType(){return"while"}search(e){this.condition.search(e),this.searchBlock(this.body,e)}};class ZE extends XE{constructor(e,t){super(),this.body=e,this.loopId=t}get astNodeType(){return"continuing"}search(e){this.searchBlock(this.body,e)}}let eB=class extends XE{constructor(e,t,n,r){super(),this.init=e,this.condition=t,this.increment=n,this.body=r}get astNodeType(){return"for"}search(e){var t,n,r;null===(t=this.init)||void 0===t||t.search(e),null===(n=this.condition)||void 0===n||n.search(e),null===(r=this.increment)||void 0===r||r.search(e),this.searchBlock(this.body,e)}},tB=class extends XE{constructor(e,t,n,r,o){super(),this.attributes=null,this.name=e,this.type=t,this.storage=n,this.access=r,this.value=o}get astNodeType(){return"var"}search(e){var t;e(this),null===(t=this.value)||void 0===t||t.search(e)}},nB=class extends XE{constructor(e,t,n){super(),this.attributes=null,this.name=e,this.type=t,this.value=n}get astNodeType(){return"override"}search(e){var t;null===(t=this.value)||void 0===t||t.search(e)}},rB=class extends XE{constructor(e,t,n,r,o){super(),this.attributes=null,this.name=e,this.type=t,this.storage=n,this.access=r,this.value=o}get astNodeType(){return"let"}search(e){var t;e(this),null===(t=this.value)||void 0===t||t.search(e)}},oB=class extends XE{constructor(e,t,n,r,o){super(),this.attributes=null,this.name=e,this.type=t,this.storage=n,this.access=r,this.value=o}get astNodeType(){return"const"}constEvaluate(e,t){return this.value.constEvaluate(e,t)}search(e){var t;e(this),null===(t=this.value)||void 0===t||t.search(e)}};var iB,sB,aB,lB;(e=>{e.increment="++",e.decrement="--"})(iB||(iB={})),(e=>{e.parse=function(t){const n=t;if("parse"==n)throw new Error("Invalid value for IncrementOperator");return e[n]}})(iB||(iB={}));class cB extends XE{constructor(e,t){super(),this.operator=e,this.variable=t}get astNodeType(){return"increment"}search(e){this.variable.search(e)}}(e=>{e.assign="=",e.addAssign="+=",e.subtractAssin="-=",e.multiplyAssign="*=",e.divideAssign="/=",e.moduloAssign="%=",e.andAssign="&=",e.orAssign="|=",e.xorAssign="^=",e.shiftLeftAssign="<<=",e.shiftRightAssign=">>="})(sB||(sB={})),(sB||(sB={})).parse=function(e){const t=e;if("parse"==t)throw new Error("Invalid value for AssignOperator");return t};class uB extends XE{constructor(e,t,n){super(),this.operator=e,this.variable=t,this.value=n}get astNodeType(){return"assign"}search(e){this.variable.search(e),this.value.search(e)}}let dB=class extends XE{constructor(e,t){super(),this.name=e,this.args=t}get astNodeType(){return"call"}isBuiltin(){return KE.has(this.name)}search(e){for(const t of this.args)t.search(e);e(this)}},AB=class extends XE{constructor(e,t){super(),this.body=e,this.continuing=t}get astNodeType(){return"loop"}search(e){var t;this.searchBlock(this.body,e),null===(t=this.continuing)||void 0===t||t.search(e)}},hB=class extends XE{constructor(e,t){super(),this.condition=e,this.cases=t}get astNodeType(){return"switch"}search(e){e(this);for(const t of this.cases)t.search(e)}};class pB extends XE{constructor(e,t,n,r){super(),this.condition=e,this.body=t,this.elseif=n,this.else=r}get astNodeType(){return"if"}search(e){this.condition.search(e),this.searchBlock(this.body,e),this.searchBlock(this.elseif,e),this.searchBlock(this.else,e)}}class fB extends XE{constructor(e){super(),this.value=e}get astNodeType(){return"return"}search(e){var t;null===(t=this.value)||void 0===t||t.search(e)}}class gB extends XE{constructor(e){super(),this.name=e}get astNodeType(){return"enable"}}class mB extends XE{constructor(e){super(),this.extensions=e}get astNodeType(){return"requires"}}class yB extends XE{constructor(e,t){super(),this.severity=e,this.rule=t}get astNodeType(){return"diagnostic"}}class vB extends XE{constructor(e,t){super(),this.name=e,this.type=t}get astNodeType(){return"alias"}}let bB=class extends XE{constructor(){super()}get astNodeType(){return"discard"}},wB=class extends XE{constructor(){super(),this.condition=null,this.loopId=-1}get astNodeType(){return"break"}},xB=class extends XE{constructor(){super(),this.loopId=-1}get astNodeType(){return"continue"}},_B=class e extends XE{constructor(e){super(),this.attributes=null,this.name=e}get astNodeType(){return"type"}get isStruct(){return!1}get isArray(){return!1}static maxFormatType(t){let n=t[0];if("f32"===n.name)return n;for(let r=1;r<t.length;++r){const o=e._priority.get(n.name);e._priority.get(t[r].name)<o&&(n=t[r])}return"x32"===n.name?e.i32:n}getTypeName(){return this.name}};_B.x32=new _B("x32"),_B.f32=new _B("f32"),_B.i32=new _B("i32"),_B.u32=new _B("u32"),_B.f16=new _B("f16"),_B.bool=new _B("bool"),_B.void=new _B("void"),_B._priority=new Map([["f32",0],["f16",1],["u32",2],["i32",3],["x32",3]]);let CB=class extends _B{constructor(e){super(e)}},SB=class extends _B{constructor(e,t,n,r){super(e),this.members=t,this.startLine=n,this.endLine=r}get astNodeType(){return"struct"}get isStruct(){return!0}getMemberIndex(e){for(let t=0;t<this.members.length;t++)if(this.members[t].name==e)return t;return-1}search(e){for(const t of this.members)e(t)}},EB=class extends _B{constructor(e,t,n){super(e),this.format=t,this.access=n}get astNodeType(){return"template"}getTypeName(){let e=this.name;if(null!==this.format){if("vec2"===e||"vec3"===e||"vec4"===e||"mat2x2"===e||"mat2x3"===e||"mat2x4"===e||"mat3x2"===e||"mat3x3"===e||"mat3x4"===e||"mat4x2"===e||"mat4x3"===e||"mat4x4"===e){if("f32"===this.format.name)return e+="f",e;if("i32"===this.format.name)return e+="i",e;if("u32"===this.format.name)return e+="u",e;if("bool"===this.format.name)return e+="b",e;if("f16"===this.format.name)return e+="h",e}e+=`<${this.format.name}>`}else if("vec2"===e||"vec3"===e||"vec4"===e)return e;return e}};EB.vec2f=new EB("vec2",_B.f32,null),EB.vec3f=new EB("vec3",_B.f32,null),EB.vec4f=new EB("vec4",_B.f32,null),EB.vec2i=new EB("vec2",_B.i32,null),EB.vec3i=new EB("vec3",_B.i32,null),EB.vec4i=new EB("vec4",_B.i32,null),EB.vec2u=new EB("vec2",_B.u32,null),EB.vec3u=new EB("vec3",_B.u32,null),EB.vec4u=new EB("vec4",_B.u32,null),EB.vec2h=new EB("vec2",_B.f16,null),EB.vec3h=new EB("vec3",_B.f16,null),EB.vec4h=new EB("vec4",_B.f16,null),EB.vec2b=new EB("vec2",_B.bool,null),EB.vec3b=new EB("vec3",_B.bool,null),EB.vec4b=new EB("vec4",_B.bool,null),EB.mat2x2f=new EB("mat2x2",_B.f32,null),EB.mat2x3f=new EB("mat2x3",_B.f32,null),EB.mat2x4f=new EB("mat2x4",_B.f32,null),EB.mat3x2f=new EB("mat3x2",_B.f32,null),EB.mat3x3f=new EB("mat3x3",_B.f32,null),EB.mat3x4f=new EB("mat3x4",_B.f32,null),EB.mat4x2f=new EB("mat4x2",_B.f32,null),EB.mat4x3f=new EB("mat4x3",_B.f32,null),EB.mat4x4f=new EB("mat4x4",_B.f32,null),EB.mat2x2h=new EB("mat2x2",_B.f16,null),EB.mat2x3h=new EB("mat2x3",_B.f16,null),EB.mat2x4h=new EB("mat2x4",_B.f16,null),EB.mat3x2h=new EB("mat3x2",_B.f16,null),EB.mat3x3h=new EB("mat3x3",_B.f16,null),EB.mat3x4h=new EB("mat3x4",_B.f16,null),EB.mat4x2h=new EB("mat4x2",_B.f16,null),EB.mat4x3h=new EB("mat4x3",_B.f16,null),EB.mat4x4h=new EB("mat4x4",_B.f16,null),EB.mat2x2i=new EB("mat2x2",_B.i32,null),EB.mat2x3i=new EB("mat2x3",_B.i32,null),EB.mat2x4i=new EB("mat2x4",_B.i32,null),EB.mat3x2i=new EB("mat3x2",_B.i32,null),EB.mat3x3i=new EB("mat3x3",_B.i32,null),EB.mat3x4i=new EB("mat3x4",_B.i32,null),EB.mat4x2i=new EB("mat4x2",_B.i32,null),EB.mat4x3i=new EB("mat4x3",_B.i32,null),EB.mat4x4i=new EB("mat4x4",_B.i32,null),EB.mat2x2u=new EB("mat2x2",_B.u32,null),EB.mat2x3u=new EB("mat2x3",_B.u32,null),EB.mat2x4u=new EB("mat2x4",_B.u32,null),EB.mat3x2u=new EB("mat3x2",_B.u32,null),EB.mat3x3u=new EB("mat3x3",_B.u32,null),EB.mat3x4u=new EB("mat3x4",_B.u32,null),EB.mat4x2u=new EB("mat4x2",_B.u32,null),EB.mat4x3u=new EB("mat4x3",_B.u32,null),EB.mat4x4u=new EB("mat4x4",_B.u32,null);let BB=class extends _B{constructor(e,t,n,r){super(e),this.storage=t,this.type=n,this.access=r}get astNodeType(){return"pointer"}},IB=class extends _B{constructor(e,t,n,r){super(e),this.attributes=t,this.format=n,this.count=r}get astNodeType(){return"array"}get isArray(){return!0}},RB=class extends _B{constructor(e,t,n){super(e),this.format=t,this.access=n}get astNodeType(){return"sampler"}},kB=class extends VE{constructor(){super(),this.postfix=null}},TB=class extends kB{constructor(e){super(),this.value=e}get astNodeType(){return"stringExpr"}toString(){return this.value}constEvaluateString(){return this.value}},PB=class extends kB{constructor(e,t){super(),this.type=e,this.args=t}get astNodeType(){return"createExpr"}search(e){if(e(this),this.args)for(const t of this.args)t.search(e)}constEvaluate(e,t){return t&&(t[0]=this.type),e.evalExpression(this,e.context)}},FB=class extends kB{constructor(e,t){super(),this.cachedReturnValue=null,this.name=e,this.args=t}get astNodeType(){return"callExpr"}setCachedReturnValue(e){this.cachedReturnValue=e}get isBuiltin(){return KE.has(this.name)}constEvaluate(e,t){return e.evalExpression(this,e.context)}search(e){for(const t of this.args)t.search(e);e(this)}},MB=class extends kB{constructor(e){super(),this.name=e}get astNodeType(){return"varExpr"}search(e){e(this),this.postfix&&this.postfix.search(e)}constEvaluate(e,t){return e.evalExpression(this,e.context)}};class LB extends kB{constructor(e,t){super(),this.name=e,this.initializer=t}get astNodeType(){return"constExpr"}constEvaluate(e,t){if(this.initializer){const t=e.evalExpression(this.initializer,e.context);return null!==t&&this.postfix?t.getSubData(e,this.postfix,e.context):t}return null}search(e){this.initializer.search(e)}}class UB extends kB{constructor(e,t){super(),this.value=e,this.type=t}get astNodeType(){return"literalExpr"}constEvaluate(e,t){return void 0!==t&&(t[0]=this.type),this.value}get isScalar(){return this.value instanceof ZB}get isVector(){return this.value instanceof tI||this.value instanceof nI}get scalarValue(){return this.value instanceof ZB?this.value.value:0}get vectorValue(){return this.value instanceof tI||this.value instanceof nI?this.value.data:new Float32Array(0)}}let OB=class extends kB{constructor(e,t){super(),this.type=e,this.value=t}get astNodeType(){return"bitcastExpr"}search(e){this.value.search(e)}},DB=class extends kB{constructor(e){super(),this.index=e}search(e){this.index.search(e)}};class NB extends kB{constructor(){super()}}class jB extends NB{constructor(e,t){super(),this.operator=e,this.right=t}get astNodeType(){return"unaryOp"}constEvaluate(e,t){return e.evalExpression(this,e.context)}search(e){this.right.search(e)}}class QB extends NB{constructor(e,t,n){super(),this.operator=e,this.left=t,this.right=n}get astNodeType(){return"binaryOp"}_getPromotedType(e,t){return e.name===t.name?e:"f32"===e.name||"f32"===t.name?_B.f32:"u32"===e.name||"u32"===t.name?_B.u32:_B.i32}constEvaluate(e,t){return e.evalExpression(this,e.context)}search(e){this.left.search(e),this.right.search(e)}}class zB extends VE{constructor(e){super(),this.body=e}search(e){e(this),this.searchBlock(this.body,e)}}class HB extends kB{constructor(){super()}get astNodeType(){return"default"}}let GB=class extends zB{constructor(e,t){super(t),this.selectors=e}get astNodeType(){return"case"}search(e){this.searchBlock(this.body,e)}};class VB extends zB{constructor(e){super(e)}get astNodeType(){return"default"}search(e){this.searchBlock(this.body,e)}}class WB extends VE{constructor(e,t,n){super(),this.name=e,this.type=t,this.attributes=n}get astNodeType(){return"argument"}}class $B extends VE{constructor(e,t){super(),this.condition=e,this.body=t}get astNodeType(){return"elseif"}search(e){this.condition.search(e),this.searchBlock(this.body,e)}}let KB=class extends VE{constructor(e,t,n){super(),this.name=e,this.type=t,this.attributes=n}get astNodeType(){return"member"}};class XB extends VE{constructor(e,t){super(),this.name=e,this.value=t}get astNodeType(){return"attribute"}}class YB{constructor(e,t){this.parent=null,this.typeInfo=e,this.parent=t,this.id=YB._id++}clone(){throw`Clone: Not implemented for ${this.constructor.name}`}setDataValue(e,t,n,r){}getSubData(e,t,n){return null}toString(){return`<${this.typeInfo.getTypeName()}>`}}YB._id=0;let qB=class extends YB{constructor(){super(new yE("void",null),null)}toString(){return"void"}};qB.void=new qB;class JB extends YB{constructor(e){super(new xE("pointer",e.typeInfo,null),null),this.reference=e}clone(){return this}setDataValue(e,t,n,r){this.reference.setDataValue(e,t,n,r)}getSubData(e,t,n){return t?this.reference.getSubData(e,t,n):this}toString(){return`&${this.reference.toString()}`}}class ZB extends YB{constructor(e,t,n=null){super(t,n),e instanceof Int32Array||e instanceof Uint32Array||e instanceof Float32Array?this.data=e:"x32"===this.typeInfo.name?e-Math.floor(e)!==0?this.data=new Float32Array([e]):this.data=e>=0?new Uint32Array([e]):new Int32Array([e]):"i32"===this.typeInfo.name||"bool"===this.typeInfo.name?this.data=new Int32Array([e]):"u32"===this.typeInfo.name?this.data=new Uint32Array([e]):("f32"===this.typeInfo.name||"f16"===this.typeInfo.name)&&(this.data=new Float32Array([e]))}clone(){if(this.data instanceof Float32Array)return new ZB(new Float32Array(this.data),this.typeInfo,null);if(this.data instanceof Int32Array)return new ZB(new Int32Array(this.data),this.typeInfo,null);if(this.data instanceof Uint32Array)return new ZB(new Uint32Array(this.data),this.typeInfo,null);throw"ScalarData: Invalid data type"}get value(){return this.data[0]}set value(e){this.data[0]=e}setDataValue(e,t,n,r){if(n)return;if(!(t instanceof ZB))return;let o=t.data[0];"i32"===this.typeInfo.name||"u32"===this.typeInfo.name?o=Math.floor(o):"bool"===this.typeInfo.name&&(o=o?1:0),this.data[0]=o}getSubData(e,t,n){return t?null:this}toString(){return`${this.value}`}}function eI(e,t,n){const r=t.length;return 2===r?"f32"===n?new tI(new Float32Array(t),e.getTypeInfo("vec2f")):"i32"===n||"bool"===n?new tI(new Int32Array(t),e.getTypeInfo("vec2i")):"u32"===n?new tI(new Uint32Array(t),e.getTypeInfo("vec2u")):"f16"===n?new tI(new Float32Array(t),e.getTypeInfo("vec2h")):null:3===r?"f32"===n?new tI(new Float32Array(t),e.getTypeInfo("vec3f")):"i32"===n||"bool"===n?new tI(new Int32Array(t),e.getTypeInfo("vec3i")):"u32"===n?new tI(new Uint32Array(t),e.getTypeInfo("vec3u")):"f16"===n?new tI(new Float32Array(t),e.getTypeInfo("vec3h")):null:4===r?"f32"===n?new tI(new Float32Array(t),e.getTypeInfo("vec4f")):"i32"===n||"bool"===n?new tI(new Int32Array(t),e.getTypeInfo("vec4i")):"u32"===n?new tI(new Uint32Array(t),e.getTypeInfo("vec4u")):"f16"===n?new tI(new Float32Array(t),e.getTypeInfo("vec4h")):null:null}class tI extends YB{constructor(e,t,n=null){if(super(t,n),e instanceof Float32Array||e instanceof Uint32Array||e instanceof Int32Array)this.data=e;else{const t=this.typeInfo.name;"vec2f"===t||"vec3f"===t||"vec4f"===t?this.data=new Float32Array(e):"vec2i"===t||"vec3i"===t||"vec4i"===t?this.data=new Int32Array(e):"vec2u"===t||"vec3u"===t||"vec4u"===t?this.data=new Uint32Array(e):"vec2h"===t||"vec3h"===t||"vec4h"===t?this.data=new Float32Array(e):"vec2b"===t||"vec3b"===t||"vec4b"===t?this.data=new Int32Array(e):("vec2"===t||"vec3"===t||"vec4"===t)&&(this.data=new Float32Array(e))}}clone(){if(this.data instanceof Float32Array)return new tI(new Float32Array(this.data),this.typeInfo,null);if(this.data instanceof Int32Array)return new tI(new Int32Array(this.data),this.typeInfo,null);if(this.data instanceof Uint32Array)return new tI(new Uint32Array(this.data),this.typeInfo,null);throw"VectorData: Invalid data type"}setDataValue(e,t,n,r){n instanceof TB||t instanceof tI&&(this.data=t.data)}getSubData(e,t,n){if(null===t)return this;let r=e.getTypeInfo("f32");if(this.typeInfo instanceof _E)r=this.typeInfo.format||r;else{const t=this.typeInfo.name;"vec2f"===t||"vec3f"===t||"vec4f"===t?r=e.getTypeInfo("f32"):"vec2i"===t||"vec3i"===t||"vec4i"===t?r=e.getTypeInfo("i32"):"vec2b"===t||"vec3b"===t||"vec4b"===t?r=e.getTypeInfo("bool"):"vec2u"===t||"vec3u"===t||"vec4u"===t?r=e.getTypeInfo("u32"):("vec2h"===t||"vec3h"===t||"vec4h"===t)&&(r=e.getTypeInfo("f16"))}let o=this;for(;null!==t&&null!==o;){if(t instanceof DB){const i=t.index;let s=-1;if(i instanceof UB){if(!(i.value instanceof ZB))return null;s=i.value.value}else{const t=e.evalExpression(i,n);if(!(t instanceof ZB))return null;s=t.value}if(s<0||s>=o.data.length)return null;if(o.data instanceof Float32Array){const e=new Float32Array(o.data.buffer,o.data.byteOffset+4*s,1);return new ZB(e,r)}if(o.data instanceof Int32Array){const e=new Int32Array(o.data.buffer,o.data.byteOffset+4*s,1);return new ZB(e,r)}if(o.data instanceof Uint32Array){const e=new Uint32Array(o.data.buffer,o.data.byteOffset+4*s,1);return new ZB(e,r)}throw"GetSubData: Invalid data type"}if(!(t instanceof TB))return null;{const n=t.value.toLowerCase();if(1===n.length){let e=0;if("x"===n||"r"===n)e=0;else if("y"===n||"g"===n)e=1;else if("z"===n||"b"===n)e=2;else{if("w"!==n&&"a"!==n)return null;e=3}if(this.data instanceof Float32Array){let t=new Float32Array(this.data.buffer,this.data.byteOffset+4*e,1);return new ZB(t,r,this)}if(this.data instanceof Int32Array){let t=new Int32Array(this.data.buffer,this.data.byteOffset+4*e,1);return new ZB(t,r,this)}if(this.data instanceof Uint32Array){let t=new Uint32Array(this.data.buffer,this.data.byteOffset+4*e,1);return new ZB(t,r,this)}}const i=[];for(const e of n)"x"===e||"r"===e?i.push(this.data[0]):"y"===e||"g"===e?i.push(this.data[1]):"z"===e||"b"===e?i.push(this.data[2]):("w"===e||"a"===e)&&i.push(this.data[3]);o=eI(e,i,r.name)}t=t.postfix}return o}toString(){let e=`${this.data[0]}`;for(let t=1;t<this.data.length;++t)e+=`, ${this.data[t]}`;return e}}class nI extends YB{constructor(e,t,n=null){super(t,n),e instanceof Float32Array?this.data=e:this.data=new Float32Array(e)}clone(){return new nI(new Float32Array(this.data),this.typeInfo,null)}setDataValue(e,t,n,r){n instanceof TB||t instanceof nI&&(this.data=t.data)}getSubData(e,t,n){if(null===t)return this;const r=this.typeInfo.name;if(e.getTypeInfo("f32"),this.typeInfo instanceof _E)this.typeInfo.format;else if(r.endsWith("f"))e.getTypeInfo("f32");else if(r.endsWith("i"))e.getTypeInfo("i32");else if(r.endsWith("u"))e.getTypeInfo("u32");else{if(!r.endsWith("h"))return null;e.getTypeInfo("f16")}if(t instanceof DB){const o=t.index;let i=-1;if(o instanceof UB){if(!(o.value instanceof ZB))return null;i=o.value.value}else{const t=e.evalExpression(o,n);if(!(t instanceof ZB))return null;i=t.value}if(i<0||i>=this.data.length)return null;const s=r.endsWith("h")?"h":"f";let a;if("mat2x2"===r||"mat2x2f"===r||"mat2x2h"===r||"mat3x2"===r||"mat3x2f"===r||"mat3x2h"===r||"mat4x2"===r||"mat4x2f"===r||"mat4x2h"===r)a=new tI(new Float32Array(this.data.buffer,this.data.byteOffset+2*i*4,2),e.getTypeInfo(`vec2${s}`));else if("mat2x3"===r||"mat2x3f"===r||"mat2x3h"===r||"mat3x3"===r||"mat3x3f"===r||"mat3x3h"===r||"mat4x3"===r||"mat4x3f"===r||"mat4x3h"===r)a=new tI(new Float32Array(this.data.buffer,this.data.byteOffset+3*i*4,3),e.getTypeInfo(`vec3${s}`));else{if("mat2x4"!==r&&"mat2x4f"!==r&&"mat2x4h"!==r&&"mat3x4"!==r&&"mat3x4f"!==r&&"mat3x4h"!==r&&"mat4x4"!==r&&"mat4x4f"!==r&&"mat4x4h"!==r)return null;a=new tI(new Float32Array(this.data.buffer,this.data.byteOffset+4*i*4,4),e.getTypeInfo(`vec4${s}`))}return t.postfix?a.getSubData(e,t.postfix,n):a}return null}toString(){let e=`${this.data[0]}`;for(let t=1;t<this.data.length;++t)e+=`, ${this.data[t]}`;return e}}let rI=class e extends YB{constructor(e,t,n=0,r=null){super(t,r),this.buffer=e instanceof ArrayBuffer?e:e.buffer,this.offset=n}clone(){const t=new Uint8Array(new Uint8Array(this.buffer,this.offset,this.typeInfo.size));return new e(t.buffer,this.typeInfo,0,null)}setDataValue(e,t,n,r){if(null===t)return;let o=this.offset,i=this.typeInfo;for(;n;){if(n instanceof DB){if(i instanceof wE){const t=n.index;if(t instanceof UB){if(!(t.value instanceof ZB))return;o+=t.value.value*i.stride}else{const n=e.evalExpression(t,r);if(!(n instanceof ZB))return;o+=n.value*i.stride}i=i.format}}else{if(!(n instanceof TB))return;{const e=n.value;if(i instanceof bE){let t=!1;for(const n of i.members)if(n.name===e){o+=n.offset,i=n.type,t=!0;break}if(!t)return}else if(i instanceof yE){const n=i.getTypeName();let r=0;if("x"===e||"r"===e)r=0;else if("y"===e||"g"===e)r=1;else if("z"===e||"b"===e)r=2;else{if("w"!==e&&"a"!==e)return;r=3}if(!(t instanceof ZB))return;const s=t.value;return"vec2f"===n?void(new Float32Array(this.buffer,o,2)[r]=s):"vec3f"===n?void(new Float32Array(this.buffer,o,3)[r]=s):"vec4f"===n?void(new Float32Array(this.buffer,o,4)[r]=s):"vec2i"===n?void(new Int32Array(this.buffer,o,2)[r]=s):"vec3i"===n?void(new Int32Array(this.buffer,o,3)[r]=s):"vec4i"===n?void(new Int32Array(this.buffer,o,4)[r]=s):"vec2u"===n?void(new Uint32Array(this.buffer,o,2)[r]=s):"vec3u"===n?void(new Uint32Array(this.buffer,o,3)[r]=s):"vec4u"===n?void(new Uint32Array(this.buffer,o,4)[r]=s):void 0}}}n=n.postfix}this.setData(e,t,i,o,r)}setData(t,n,r,o,i){const s=r.getTypeName();if("f32"!==s&&"f16"!==s)if("i32"!==s&&"atomic<i32>"!==s&&"x32"!==s)if("u32"!==s&&"atomic<u32>"!==s)if("bool"!==s){if("vec2f"===s||"vec2h"===s){const e=new Float32Array(this.buffer,o,2);return void(n instanceof tI?(e[0]=n.data[0],e[1]=n.data[1]):(e[0]=n[0],e[1]=n[1]))}if("vec3f"===s||"vec3h"===s){const e=new Float32Array(this.buffer,o,3);return void(n instanceof tI?(e[0]=n.data[0],e[1]=n.data[1],e[2]=n.data[2]):(e[0]=n[0],e[1]=n[1],e[2]=n[2]))}if("vec4f"===s||"vec4h"===s){const e=new Float32Array(this.buffer,o,4);return void(n instanceof tI?(e[0]=n.data[0],e[1]=n.data[1],e[2]=n.data[2],e[3]=n.data[3]):(e[0]=n[0],e[1]=n[1],e[2]=n[2],e[3]=n[3]))}if("vec2i"===s){const e=new Int32Array(this.buffer,o,2);return void(n instanceof tI?(e[0]=n.data[0],e[1]=n.data[1]):(e[0]=n[0],e[1]=n[1]))}if("vec3i"===s){const e=new Int32Array(this.buffer,o,3);return void(n instanceof tI?(e[0]=n.data[0],e[1]=n.data[1],e[2]=n.data[2]):(e[0]=n[0],e[1]=n[1],e[2]=n[2]))}if("vec4i"===s){const e=new Int32Array(this.buffer,o,4);return void(n instanceof tI?(e[0]=n.data[0],e[1]=n.data[1],e[2]=n.data[2],e[3]=n.data[3]):(e[0]=n[0],e[1]=n[1],e[2]=n[2],e[3]=n[3]))}if("vec2u"===s){const e=new Uint32Array(this.buffer,o,2);return void(n instanceof tI?(e[0]=n.data[0],e[1]=n.data[1]):(e[0]=n[0],e[1]=n[1]))}if("vec3u"===s){const e=new Uint32Array(this.buffer,o,3);return void(n instanceof tI?(e[0]=n.data[0],e[1]=n.data[1],e[2]=n.data[2]):(e[0]=n[0],e[1]=n[1],e[2]=n[2]))}if("vec4u"===s){const e=new Uint32Array(this.buffer,o,4);return void(n instanceof tI?(e[0]=n.data[0],e[1]=n.data[1],e[2]=n.data[2],e[3]=n.data[3]):(e[0]=n[0],e[1]=n[1],e[2]=n[2],e[3]=n[3]))}if("vec2b"===s){const e=new Uint32Array(this.buffer,o,2);return void(n instanceof tI?(e[0]=n.data[0],e[1]=n.data[1]):(e[0]=n[0],e[1]=n[1]))}if("vec3b"===s){const e=new Uint32Array(this.buffer,o,3);return void(n instanceof tI?(e[0]=n.data[0],e[1]=n.data[1],e[2]=n.data[2]):(e[0]=n[0],e[1]=n[1],e[2]=n[2]))}if("vec4b"===s){const e=new Uint32Array(this.buffer,o,4);return void(n instanceof tI?(e[0]=n.data[0],e[1]=n.data[1],e[2]=n.data[2],e[3]=n.data[3]):(e[0]=n[0],e[1]=n[1],e[2]=n[2],e[3]=n[3]))}if("mat2x2f"===s||"mat2x2h"===s){const e=new Float32Array(this.buffer,o,4);return void(n instanceof nI?(e[0]=n.data[0],e[1]=n.data[1],e[2]=n.data[2],e[3]=n.data[3]):(e[0]=n[0],e[1]=n[1],e[2]=n[2],e[3]=n[3]))}if("mat2x3f"===s||"mat2x3h"===s){const e=new Float32Array(this.buffer,o,6);return void(n instanceof nI?(e[0]=n.data[0],e[1]=n.data[1],e[2]=n.data[2],e[3]=n.data[3],e[4]=n.data[4],e[5]=n.data[5]):(e[0]=n[0],e[1]=n[1],e[2]=n[2],e[3]=n[3],e[4]=n[4],e[5]=n[5]))}if("mat2x4f"===s||"mat2x4h"===s){const e=new Float32Array(this.buffer,o,8);return void(n instanceof nI?(e[0]=n.data[0],e[1]=n.data[1],e[2]=n.data[2],e[3]=n.data[3],e[4]=n.data[4],e[5]=n.data[5],e[6]=n.data[6],e[7]=n.data[7]):(e[0]=n[0],e[1]=n[1],e[2]=n[2],e[3]=n[3],e[4]=n[4],e[5]=n[5],e[6]=n[6],e[7]=n[7]))}if("mat3x2f"===s||"mat3x2h"===s){const e=new Float32Array(this.buffer,o,6);return void(n instanceof nI?(e[0]=n.data[0],e[1]=n.data[1],e[2]=n.data[2],e[3]=n.data[3],e[4]=n.data[4],e[5]=n.data[5]):(e[0]=n[0],e[1]=n[1],e[2]=n[2],e[3]=n[3],e[4]=n[4],e[5]=n[5]))}if("mat3x3f"===s||"mat3x3h"===s){const e=new Float32Array(this.buffer,o,9);return void(n instanceof nI?(e[0]=n.data[0],e[1]=n.data[1],e[2]=n.data[2],e[3]=n.data[3],e[4]=n.data[4],e[5]=n.data[5],e[6]=n.data[6],e[7]=n.data[7],e[8]=n.data[8]):(e[0]=n[0],e[1]=n[1],e[2]=n[2],e[3]=n[3],e[4]=n[4],e[5]=n[5],e[6]=n[6],e[7]=n[7],e[8]=n[8]))}if("mat3x4f"===s||"mat3x4h"===s){const e=new Float32Array(this.buffer,o,12);return void(n instanceof nI?(e[0]=n.data[0],e[1]=n.data[1],e[2]=n.data[2],e[3]=n.data[3],e[4]=n.data[4],e[5]=n.data[5],e[6]=n.data[6],e[7]=n.data[7],e[8]=n.data[8],e[9]=n.data[9],e[10]=n.data[10],e[11]=n.data[11]):(e[0]=n[0],e[1]=n[1],e[2]=n[2],e[3]=n[3],e[4]=n[4],e[5]=n[5],e[6]=n[6],e[7]=n[7],e[8]=n[8],e[9]=n[9],e[10]=n[10],e[11]=n[11]))}if("mat4x2f"===s||"mat4x2h"===s){const e=new Float32Array(this.buffer,o,8);return void(n instanceof nI?(e[0]=n.data[0],e[1]=n.data[1],e[2]=n.data[2],e[3]=n.data[3],e[4]=n.data[4],e[5]=n.data[5],e[6]=n.data[6],e[7]=n.data[7]):(e[0]=n[0],e[1]=n[1],e[2]=n[2],e[3]=n[3],e[4]=n[4],e[5]=n[5],e[6]=n[6],e[7]=n[7]))}if("mat4x3f"===s||"mat4x3h"===s){const e=new Float32Array(this.buffer,o,12);return void(n instanceof nI?(e[0]=n.data[0],e[1]=n.data[1],e[2]=n.data[2],e[3]=n.data[3],e[4]=n.data[4],e[5]=n.data[5],e[6]=n.data[6],e[7]=n.data[7],e[8]=n.data[8],e[9]=n.data[9],e[10]=n.data[10],e[11]=n.data[11]):(e[0]=n[0],e[1]=n[1],e[2]=n[2],e[3]=n[3],e[4]=n[4],e[5]=n[5],e[6]=n[6],e[7]=n[7],e[8]=n[8],e[9]=n[9],e[10]=n[10],e[11]=n[11]))}if("mat4x4f"===s||"mat4x4h"===s){const e=new Float32Array(this.buffer,o,16);return void(n instanceof nI?(e[0]=n.data[0],e[1]=n.data[1],e[2]=n.data[2],e[3]=n.data[3],e[4]=n.data[4],e[5]=n.data[5],e[6]=n.data[6],e[7]=n.data[7],e[8]=n.data[8],e[9]=n.data[9],e[10]=n.data[10],e[11]=n.data[11],e[12]=n.data[12],e[13]=n.data[13],e[14]=n.data[14],e[15]=n.data[15]):(e[0]=n[0],e[1]=n[1],e[2]=n[2],e[3]=n[3],e[4]=n[4],e[5]=n[5],e[6]=n[6],e[7]=n[7],e[8]=n[8],e[9]=n[9],e[10]=n[10],e[11]=n[11],e[12]=n[12],e[13]=n[13],e[14]=n[14],e[15]=n[15]))}if(n instanceof e&&r===n.typeInfo)return void new Uint8Array(this.buffer,o,n.buffer.byteLength).set(new Uint8Array(n.buffer))}else n instanceof ZB&&(new Int32Array(this.buffer,o,1)[0]=n.value);else n instanceof ZB&&(new Uint32Array(this.buffer,o,1)[0]=n.value);else n instanceof ZB&&(new Int32Array(this.buffer,o,1)[0]=n.value);else n instanceof ZB&&(new Float32Array(this.buffer,o,1)[0]=n.value)}getSubData(t,n,r){var o,i;if(null===n)return this;let s=this.offset,a=this.typeInfo;for(;n;){if(n instanceof DB){const e=n.index,o=e instanceof kB?t.evalExpression(e,r):e;let i=0;if(o instanceof ZB?i=o.value:"number"==typeof o&&(i=o),a instanceof wE)s+=i*a.stride,a=a.format;else{const e=a.getTypeName();("mat4x4"===e||"mat4x4f"===e||"mat4x4h"===e)&&(s+=16*i,a=t.getTypeInfo("vec4f"))}}else{if(!(n instanceof TB))return null;{const e=n.value;if(a instanceof bE){let t=!1;for(const n of a.members)if(n.name===e){s+=n.offset,a=n.type,t=!0;break}if(!t)return null}else if(a instanceof yE){const n=a.getTypeName();if("vec2f"===n||"vec3f"===n||"vec4f"===n||"vec2i"===n||"vec3i"===n||"vec4i"===n||"vec2u"===n||"vec3u"===n||"vec4u"===n||"vec2b"===n||"vec3b"===n||"vec4b"===n||"vec2h"===n||"vec3h"===n||"vec4h"===n||"vec2"===n||"vec3"===n||"vec4"===n){if(e.length>0&&e.length<5){let r="f";const o=[];for(let i=0;i<e.length;++i){const a=e[i].toLowerCase();let l=0;if("x"===a||"r"===a)l=0;else if("y"===a||"g"===a)l=1;else if("z"===a||"b"===a)l=2;else{if("w"!==a&&"a"!==a)return null;l=3}if(1===e.length){if(n.endsWith("f"))return this.buffer.byteLength<s+4*l+4?null:new ZB(new Float32Array(this.buffer,s+4*l,1),t.getTypeInfo("f32"),this);if(n.endsWith("h"))return new ZB(new Float32Array(this.buffer,s+4*l,1),t.getTypeInfo("f16"),this);if(n.endsWith("i"))return new ZB(new Int32Array(this.buffer,s+4*l,1),t.getTypeInfo("i32"),this);if(n.endsWith("b"))return new ZB(new Int32Array(this.buffer,s+4*l,1),t.getTypeInfo("bool"),this);if(n.endsWith("u"))return new ZB(new Uint32Array(this.buffer,s+4*l,1),t.getTypeInfo("i32"),this)}if("vec2f"===n)o.push(new Float32Array(this.buffer,s,2)[l]);else if("vec3f"===n){if(s+12>=this.buffer.byteLength)return null;const e=new Float32Array(this.buffer,s,3);o.push(e[l])}else if("vec4f"===n)o.push(new Float32Array(this.buffer,s,4)[l]);else if("vec2i"===n)r="i",o.push(new Int32Array(this.buffer,s,2)[l]);else if("vec3i"===n)r="i",o.push(new Int32Array(this.buffer,s,3)[l]);else if("vec4i"===n)r="i",o.push(new Int32Array(this.buffer,s,4)[l]);else if("vec2u"===n){r="u";const e=new Uint32Array(this.buffer,s,2);o.push(e[l])}else"vec3u"===n?(r="u",o.push(new Uint32Array(this.buffer,s,3)[l])):"vec4u"===n&&(r="u",o.push(new Uint32Array(this.buffer,s,4)[l]))}return 2===o.length?a=t.getTypeInfo(`vec2${r}`):3===o.length?a=t.getTypeInfo(`vec3${r}`):4===o.length&&(a=t.getTypeInfo(`vec4${r}`)),new tI(o,a,null)}return null}return null}}}n=n.postfix}const l=a.getTypeName();return"f32"===l?new ZB(new Float32Array(this.buffer,s,1),a,this):"i32"===l?new ZB(new Int32Array(this.buffer,s,1),a,this):"u32"===l?new ZB(new Uint32Array(this.buffer,s,1),a,this):"vec2f"===l?new tI(new Float32Array(this.buffer,s,2),a,this):"vec3f"===l?new tI(new Float32Array(this.buffer,s,3),a,this):"vec4f"===l?new tI(new Float32Array(this.buffer,s,4),a,this):"vec2i"===l?new tI(new Int32Array(this.buffer,s,2),a,this):"vec3i"===l?new tI(new Int32Array(this.buffer,s,3),a,this):"vec4i"===l?new tI(new Int32Array(this.buffer,s,4),a,this):"vec2u"===l?new tI(new Uint32Array(this.buffer,s,2),a,this):"vec3u"===l?new tI(new Uint32Array(this.buffer,s,3),a,this):"vec4u"===l?new tI(new Uint32Array(this.buffer,s,4),a,this):a instanceof _E&&"atomic"===a.name?"u32"===(null===(o=a.format)||void 0===o?void 0:o.name)?new ZB(new Uint32Array(this.buffer,s,1)[0],a.format,this):"i32"===(null===(i=a.format)||void 0===i?void 0:i.name)?new ZB(new Int32Array(this.buffer,s,1)[0],a.format,this):null:new e(this.buffer,a,s,this)}toString(){let e="";if(this.typeInfo instanceof wE)if("f32"===this.typeInfo.format.name){const t=new Float32Array(this.buffer,this.offset);e=`[${t[0]}`;for(let n=1;n<t.length;++n)e+=`, ${t[n]}`}else if("i32"===this.typeInfo.format.name){const t=new Int32Array(this.buffer,this.offset);e=`[${t[0]}`;for(let n=1;n<t.length;++n)e+=`, ${t[n]}`}else if("u32"===this.typeInfo.format.name){const t=new Uint32Array(this.buffer,this.offset);e=`[${t[0]}`;for(let n=1;n<t.length;++n)e+=`, ${t[n]}`}else if("vec2f"===this.typeInfo.format.name){const t=new Float32Array(this.buffer,this.offset);e=`[${t[0]}, ${t[1]}]`;for(let n=1;n<t.length/2;++n)e+=`, [${t[2*n]}, ${t[2*n+1]}]`}else if("vec3f"===this.typeInfo.format.name){const t=new Float32Array(this.buffer,this.offset);e=`[${t[0]}, ${t[1]}, ${t[2]}]`;for(let n=4;n<t.length;n+=4)e+=`, [${t[n]}, ${t[n+1]}, ${t[n+2]}]`}else if("vec4f"===this.typeInfo.format.name){const t=new Float32Array(this.buffer,this.offset);e=`[${t[0]}, ${t[1]}, ${t[2]}, ${t[3]}]`;for(let n=4;n<t.length;n+=4)e+=`, [${t[n]}, ${t[n+1]}, ${t[n+2]}, ${t[n+3]}]`}else e="[...]";else this.typeInfo instanceof bE?e+="{...}":e="[...]";return e}};class oI extends YB{constructor(e,t,n,r){super(t,null),this.data=e,this.descriptor=n,this.view=r}clone(){return new oI(this.data,this.typeInfo,this.descriptor,this.view)}get width(){var e,t;const n=this.descriptor.size;return n instanceof Array&&n.length>0?null!==(e=n[0])&&void 0!==e?e:0:n instanceof Object&&null!==(t=n.width)&&void 0!==t?t:0}get height(){var e,t;const n=this.descriptor.size;return n instanceof Array&&n.length>1?null!==(e=n[1])&&void 0!==e?e:0:n instanceof Object&&null!==(t=n.height)&&void 0!==t?t:0}get depthOrArrayLayers(){var e,t;const n=this.descriptor.size;return n instanceof Array&&n.length>2?null!==(e=n[2])&&void 0!==e?e:0:n instanceof Object&&null!==(t=n.depthOrArrayLayers)&&void 0!==t?t:0}get format(){var e;return this.descriptor&&null!==(e=this.descriptor.format)&&void 0!==e?e:"rgba8unorm"}get sampleCount(){var e;return this.descriptor&&null!==(e=this.descriptor.sampleCount)&&void 0!==e?e:1}get mipLevelCount(){var e;return this.descriptor&&null!==(e=this.descriptor.mipLevelCount)&&void 0!==e?e:1}get dimension(){var e;return this.descriptor&&null!==(e=this.descriptor.dimension)&&void 0!==e?e:"2d"}getMipLevelSize(e){if(e>=this.mipLevelCount)return[0,0,0];const t=[this.width,this.height,this.depthOrArrayLayers];for(let n=0;n<t.length;++n)t[n]=Math.max(1,t[n]>>e);return t}get texelByteSize(){const e=this.format,t=GE[e];return t?t.isDepthStencil?4:t.bytesPerBlock:0}get bytesPerRow(){return this.width*this.texelByteSize}get isDepthStencil(){const e=this.format,t=GE[e];return!!t&&t.isDepthStencil}getGpuSize(){const e=this.format,t=GE[e],n=this.width;if(!e||n<=0||!t)return-1;const r=this.height,o=this.depthOrArrayLayers,i=this.dimension;return n/t.blockWidth*("1d"===i?1:r/t.blockHeight)*t.bytesPerBlock*o}getPixel(e,t,n=0,r=0){const o=this.texelByteSize,i=this.bytesPerRow,s=this.height,a=this.data[r];return function(e,t,n,r,o,i,s,a,l){const c=r*(s>>=o)*(i>>=o)+n*s+t*a;switch(l){case"r8unorm":return[zE(e,c,"8unorm",1)[0]];case"r8snorm":return[zE(e,c,"8snorm",1)[0]];case"r8uint":return[zE(e,c,"8uint",1)[0]];case"r8sint":return[zE(e,c,"8sint",1)[0]];case"rg8unorm":{const t=zE(e,c,"8unorm",2);return[t[0],t[1]]}case"rg8snorm":{const t=zE(e,c,"8snorm",2);return[t[0],t[1]]}case"rg8uint":{const t=zE(e,c,"8uint",2);return[t[0],t[1]]}case"rg8sint":{const t=zE(e,c,"8sint",2);return[t[0],t[1]]}case"rgba8unorm-srgb":case"rgba8unorm":{const t=zE(e,c,"8unorm",4);return[t[0],t[1],t[2],t[3]]}case"rgba8snorm":{const t=zE(e,c,"8snorm",4);return[t[0],t[1],t[2],t[3]]}case"rgba8uint":{const t=zE(e,c,"8uint",4);return[t[0],t[1],t[2],t[3]]}case"rgba8sint":{const t=zE(e,c,"8sint",4);return[t[0],t[1],t[2],t[3]]}case"bgra8unorm-srgb":case"bgra8unorm":{const t=zE(e,c,"8unorm",4);return[t[2],t[1],t[0],t[3]]}case"r16uint":return[zE(e,c,"16uint",1)[0]];case"r16sint":return[zE(e,c,"16sint",1)[0]];case"r16float":return[zE(e,c,"16float",1)[0]];case"rg16uint":{const t=zE(e,c,"16uint",2);return[t[0],t[1]]}case"rg16sint":{const t=zE(e,c,"16sint",2);return[t[0],t[1]]}case"rg16float":{const t=zE(e,c,"16float",2);return[t[0],t[1]]}case"rgba16uint":{const t=zE(e,c,"16uint",4);return[t[0],t[1],t[2],t[3]]}case"rgba16sint":{const t=zE(e,c,"16sint",4);return[t[0],t[1],t[2],t[3]]}case"rgba16float":{const t=zE(e,c,"16float",4);return[t[0],t[1],t[2],t[3]]}case"r32uint":return[zE(e,c,"32uint",1)[0]];case"r32sint":return[zE(e,c,"32sint",1)[0]];case"depth16unorm":case"depth24plus":case"depth24plus-stencil8":case"depth32float":case"depth32float-stencil8":case"r32float":return[zE(e,c,"32float",1)[0]];case"rg32uint":{const t=zE(e,c,"32uint",2);return[t[0],t[1]]}case"rg32sint":{const t=zE(e,c,"32sint",2);return[t[0],t[1]]}case"rg32float":{const t=zE(e,c,"32float",2);return[t[0],t[1]]}case"rgba32uint":{const t=zE(e,c,"32uint",4);return[t[0],t[1],t[2],t[3]]}case"rgba32sint":{const t=zE(e,c,"32sint",4);return[t[0],t[1],t[2],t[3]]}case"rgba32float":{const t=zE(e,c,"32float",4);return[t[0],t[1],t[2],t[3]]}case"rg11b10ufloat":{const t=new Uint32Array(e.buffer,c,1)[0],n=(4192256&t)>>11,r=(4290772992&t)>>22;return[QE(2047&t),QE(n),function(e){const t=112+(e>>5&31)<<23|(31&e)<<18;return NE[0]=t,jE[0]}(r),1]}}return null}(new Uint8Array(a),e,t,n,r,s,i,o,this.format)}setPixel(e,t,n,r,o){const i=this.texelByteSize,s=this.bytesPerRow,a=this.height,l=this.data[r];!function(e,t,n,r,o,i,s,a,l,c){const u=r*(s>>=o)*(i>>=o)+n*s+t*a;switch(l){case"r8unorm":return void HE(e,u,"8unorm",1,c);case"r8snorm":return void HE(e,u,"8snorm",1,c);case"r8uint":return void HE(e,u,"8uint",1,c);case"r8sint":return void HE(e,u,"8sint",1,c);case"rg8unorm":return void HE(e,u,"8unorm",2,c);case"rg8snorm":return void HE(e,u,"8snorm",2,c);case"rg8uint":return void HE(e,u,"8uint",2,c);case"rg8sint":return void HE(e,u,"8sint",2,c);case"rgba8unorm-srgb":case"rgba8unorm":case"bgra8unorm-srgb":case"bgra8unorm":return void HE(e,u,"8unorm",4,c);case"rgba8snorm":return void HE(e,u,"8snorm",4,c);case"rgba8uint":return void HE(e,u,"8uint",4,c);case"rgba8sint":return void HE(e,u,"8sint",4,c);case"r16uint":return void HE(e,u,"16uint",1,c);case"r16sint":return void HE(e,u,"16sint",1,c);case"r16float":return void HE(e,u,"16float",1,c);case"rg16uint":return void HE(e,u,"16uint",2,c);case"rg16sint":return void HE(e,u,"16sint",2,c);case"rg16float":return void HE(e,u,"16float",2,c);case"rgba16uint":return void HE(e,u,"16uint",4,c);case"rgba16sint":return void HE(e,u,"16sint",4,c);case"rgba16float":return void HE(e,u,"16float",4,c);case"r32uint":return void HE(e,u,"32uint",1,c);case"r32sint":return void HE(e,u,"32sint",1,c);case"depth16unorm":case"depth24plus":case"depth24plus-stencil8":case"depth32float":case"depth32float-stencil8":case"r32float":return void HE(e,u,"32float",1,c);case"rg32uint":return void HE(e,u,"32uint",2,c);case"rg32sint":return void HE(e,u,"32sint",2,c);case"rg32float":return void HE(e,u,"32float",2,c);case"rgba32uint":return void HE(e,u,"32uint",4,c);case"rgba32sint":return void HE(e,u,"32sint",4,c);case"rgba32float":HE(e,u,"32float",4,c)}}(new Uint8Array(l),e,t,n,r,a,s,i,this.format,o)}}(e=>{e[e.token=0]="token",e[e.keyword=1]="keyword",e[e.reserved=2]="reserved"})(lB||(lB={}));class iI{constructor(e,t,n){this.name=e,this.type=t,this.rule=n}toString(){return this.name}}class sI{}aB=sI,sI.none=new iI("",lB.reserved,""),sI.eof=new iI("EOF",lB.token,""),sI.reserved={asm:new iI("asm",lB.reserved,"asm"),bf16:new iI("bf16",lB.reserved,"bf16"),do:new iI("do",lB.reserved,"do"),enum:new iI("enum",lB.reserved,"enum"),f16:new iI("f16",lB.reserved,"f16"),f64:new iI("f64",lB.reserved,"f64"),handle:new iI("handle",lB.reserved,"handle"),i8:new iI("i8",lB.reserved,"i8"),i16:new iI("i16",lB.reserved,"i16"),i64:new iI("i64",lB.reserved,"i64"),mat:new iI("mat",lB.reserved,"mat"),premerge:new iI("premerge",lB.reserved,"premerge"),regardless:new iI("regardless",lB.reserved,"regardless"),typedef:new iI("typedef",lB.reserved,"typedef"),u8:new iI("u8",lB.reserved,"u8"),u16:new iI("u16",lB.reserved,"u16"),u64:new iI("u64",lB.reserved,"u64"),unless:new iI("unless",lB.reserved,"unless"),using:new iI("using",lB.reserved,"using"),vec:new iI("vec",lB.reserved,"vec"),void:new iI("void",lB.reserved,"void")},sI.keywords={array:new iI("array",lB.keyword,"array"),atomic:new iI("atomic",lB.keyword,"atomic"),bool:new iI("bool",lB.keyword,"bool"),f32:new iI("f32",lB.keyword,"f32"),i32:new iI("i32",lB.keyword,"i32"),mat2x2:new iI("mat2x2",lB.keyword,"mat2x2"),mat2x3:new iI("mat2x3",lB.keyword,"mat2x3"),mat2x4:new iI("mat2x4",lB.keyword,"mat2x4"),mat3x2:new iI("mat3x2",lB.keyword,"mat3x2"),mat3x3:new iI("mat3x3",lB.keyword,"mat3x3"),mat3x4:new iI("mat3x4",lB.keyword,"mat3x4"),mat4x2:new iI("mat4x2",lB.keyword,"mat4x2"),mat4x3:new iI("mat4x3",lB.keyword,"mat4x3"),mat4x4:new iI("mat4x4",lB.keyword,"mat4x4"),ptr:new iI("ptr",lB.keyword,"ptr"),sampler:new iI("sampler",lB.keyword,"sampler"),sampler_comparison:new iI("sampler_comparison",lB.keyword,"sampler_comparison"),struct:new iI("struct",lB.keyword,"struct"),texture_1d:new iI("texture_1d",lB.keyword,"texture_1d"),texture_2d:new iI("texture_2d",lB.keyword,"texture_2d"),texture_2d_array:new iI("texture_2d_array",lB.keyword,"texture_2d_array"),texture_3d:new iI("texture_3d",lB.keyword,"texture_3d"),texture_cube:new iI("texture_cube",lB.keyword,"texture_cube"),texture_cube_array:new iI("texture_cube_array",lB.keyword,"texture_cube_array"),texture_multisampled_2d:new iI("texture_multisampled_2d",lB.keyword,"texture_multisampled_2d"),texture_storage_1d:new iI("texture_storage_1d",lB.keyword,"texture_storage_1d"),texture_storage_2d:new iI("texture_storage_2d",lB.keyword,"texture_storage_2d"),texture_storage_2d_array:new iI("texture_storage_2d_array",lB.keyword,"texture_storage_2d_array"),texture_storage_3d:new iI("texture_storage_3d",lB.keyword,"texture_storage_3d"),texture_depth_2d:new iI("texture_depth_2d",lB.keyword,"texture_depth_2d"),texture_depth_2d_array:new iI("texture_depth_2d_array",lB.keyword,"texture_depth_2d_array"),texture_depth_cube:new iI("texture_depth_cube",lB.keyword,"texture_depth_cube"),texture_depth_cube_array:new iI("texture_depth_cube_array",lB.keyword,"texture_depth_cube_array"),texture_depth_multisampled_2d:new iI("texture_depth_multisampled_2d",lB.keyword,"texture_depth_multisampled_2d"),texture_external:new iI("texture_external",lB.keyword,"texture_external"),u32:new iI("u32",lB.keyword,"u32"),vec2:new iI("vec2",lB.keyword,"vec2"),vec3:new iI("vec3",lB.keyword,"vec3"),vec4:new iI("vec4",lB.keyword,"vec4"),bitcast:new iI("bitcast",lB.keyword,"bitcast"),block:new iI("block",lB.keyword,"block"),break:new iI("break",lB.keyword,"break"),case:new iI("case",lB.keyword,"case"),continue:new iI("continue",lB.keyword,"continue"),continuing:new iI("continuing",lB.keyword,"continuing"),default:new iI("default",lB.keyword,"default"),diagnostic:new iI("diagnostic",lB.keyword,"diagnostic"),discard:new iI("discard",lB.keyword,"discard"),else:new iI("else",lB.keyword,"else"),enable:new iI("enable",lB.keyword,"enable"),fallthrough:new iI("fallthrough",lB.keyword,"fallthrough"),false:new iI("false",lB.keyword,"false"),fn:new iI("fn",lB.keyword,"fn"),for:new iI("for",lB.keyword,"for"),function:new iI("function",lB.keyword,"function"),if:new iI("if",lB.keyword,"if"),let:new iI("let",lB.keyword,"let"),const:new iI("const",lB.keyword,"const"),loop:new iI("loop",lB.keyword,"loop"),while:new iI("while",lB.keyword,"while"),private:new iI("private",lB.keyword,"private"),read:new iI("read",lB.keyword,"read"),read_write:new iI("read_write",lB.keyword,"read_write"),return:new iI("return",lB.keyword,"return"),requires:new iI("requires",lB.keyword,"requires"),storage:new iI("storage",lB.keyword,"storage"),switch:new iI("switch",lB.keyword,"switch"),true:new iI("true",lB.keyword,"true"),alias:new iI("alias",lB.keyword,"alias"),type:new iI("type",lB.keyword,"type"),uniform:new iI("uniform",lB.keyword,"uniform"),var:new iI("var",lB.keyword,"var"),override:new iI("override",lB.keyword,"override"),workgroup:new iI("workgroup",lB.keyword,"workgroup"),write:new iI("write",lB.keyword,"write"),r8unorm:new iI("r8unorm",lB.keyword,"r8unorm"),r8snorm:new iI("r8snorm",lB.keyword,"r8snorm"),r8uint:new iI("r8uint",lB.keyword,"r8uint"),r8sint:new iI("r8sint",lB.keyword,"r8sint"),r16uint:new iI("r16uint",lB.keyword,"r16uint"),r16sint:new iI("r16sint",lB.keyword,"r16sint"),r16float:new iI("r16float",lB.keyword,"r16float"),rg8unorm:new iI("rg8unorm",lB.keyword,"rg8unorm"),rg8snorm:new iI("rg8snorm",lB.keyword,"rg8snorm"),rg8uint:new iI("rg8uint",lB.keyword,"rg8uint"),rg8sint:new iI("rg8sint",lB.keyword,"rg8sint"),r32uint:new iI("r32uint",lB.keyword,"r32uint"),r32sint:new iI("r32sint",lB.keyword,"r32sint"),r32float:new iI("r32float",lB.keyword,"r32float"),rg16uint:new iI("rg16uint",lB.keyword,"rg16uint"),rg16sint:new iI("rg16sint",lB.keyword,"rg16sint"),rg16float:new iI("rg16float",lB.keyword,"rg16float"),rgba8unorm:new iI("rgba8unorm",lB.keyword,"rgba8unorm"),rgba8unorm_srgb:new iI("rgba8unorm_srgb",lB.keyword,"rgba8unorm_srgb"),rgba8snorm:new iI("rgba8snorm",lB.keyword,"rgba8snorm"),rgba8uint:new iI("rgba8uint",lB.keyword,"rgba8uint"),rgba8sint:new iI("rgba8sint",lB.keyword,"rgba8sint"),bgra8unorm:new iI("bgra8unorm",lB.keyword,"bgra8unorm"),bgra8unorm_srgb:new iI("bgra8unorm_srgb",lB.keyword,"bgra8unorm_srgb"),rgb10a2unorm:new iI("rgb10a2unorm",lB.keyword,"rgb10a2unorm"),rg11b10float:new iI("rg11b10float",lB.keyword,"rg11b10float"),rg32uint:new iI("rg32uint",lB.keyword,"rg32uint"),rg32sint:new iI("rg32sint",lB.keyword,"rg32sint"),rg32float:new iI("rg32float",lB.keyword,"rg32float"),rgba16uint:new iI("rgba16uint",lB.keyword,"rgba16uint"),rgba16sint:new iI("rgba16sint",lB.keyword,"rgba16sint"),rgba16float:new iI("rgba16float",lB.keyword,"rgba16float"),rgba32uint:new iI("rgba32uint",lB.keyword,"rgba32uint"),rgba32sint:new iI("rgba32sint",lB.keyword,"rgba32sint"),rgba32float:new iI("rgba32float",lB.keyword,"rgba32float"),static_assert:new iI("static_assert",lB.keyword,"static_assert")},sI.tokens={decimal_float_literal:new iI("decimal_float_literal",lB.token,/((-?[0-9]*\.[0-9]+|-?[0-9]+\.[0-9]*)((e|E)(\+|-)?[0-9]+)?[fh]?)|(-?[0-9]+(e|E)(\+|-)?[0-9]+[fh]?)|(-?[0-9]+[fh])/),hex_float_literal:new iI("hex_float_literal",lB.token,/-?0x((([0-9a-fA-F]*\.[0-9a-fA-F]+|[0-9a-fA-F]+\.[0-9a-fA-F]*)((p|P)(\+|-)?[0-9]+[fh]?)?)|([0-9a-fA-F]+(p|P)(\+|-)?[0-9]+[fh]?))/),int_literal:new iI("int_literal",lB.token,/-?0x[0-9a-fA-F]+|0i?|-?[1-9][0-9]*i?/),uint_literal:new iI("uint_literal",lB.token,/0x[0-9a-fA-F]+u|0u|[1-9][0-9]*u/),name:new iI("name",lB.token,/([_\p{XID_Start}][\p{XID_Continue}]+)|([\p{XID_Start}])/u),ident:new iI("ident",lB.token,/[_a-zA-Z][0-9a-zA-Z_]*/),and:new iI("and",lB.token,"&"),and_and:new iI("and_and",lB.token,"&&"),arrow:new iI("arrow ",lB.token,"->"),attr:new iI("attr",lB.token,"@"),forward_slash:new iI("forward_slash",lB.token,"/"),bang:new iI("bang",lB.token,"!"),bracket_left:new iI("bracket_left",lB.token,"["),bracket_right:new iI("bracket_right",lB.token,"]"),brace_left:new iI("brace_left",lB.token,"{"),brace_right:new iI("brace_right",lB.token,"}"),colon:new iI("colon",lB.token,":"),comma:new iI("comma",lB.token,","),equal:new iI("equal",lB.token,"="),equal_equal:new iI("equal_equal",lB.token,"=="),not_equal:new iI("not_equal",lB.token,"!="),greater_than:new iI("greater_than",lB.token,">"),greater_than_equal:new iI("greater_than_equal",lB.token,">="),shift_right:new iI("shift_right",lB.token,">>"),less_than:new iI("less_than",lB.token,"<"),less_than_equal:new iI("less_than_equal",lB.token,"<="),shift_left:new iI("shift_left",lB.token,"<<"),modulo:new iI("modulo",lB.token,"%"),minus:new iI("minus",lB.token,"-"),minus_minus:new iI("minus_minus",lB.token,"--"),period:new iI("period",lB.token,"."),plus:new iI("plus",lB.token,"+"),plus_plus:new iI("plus_plus",lB.token,"++"),or:new iI("or",lB.token,"|"),or_or:new iI("or_or",lB.token,"||"),paren_left:new iI("paren_left",lB.token,"("),paren_right:new iI("paren_right",lB.token,")"),semicolon:new iI("semicolon",lB.token,";"),star:new iI("star",lB.token,"*"),tilde:new iI("tilde",lB.token,"~"),underscore:new iI("underscore",lB.token,"_"),xor:new iI("xor",lB.token,"^"),plus_equal:new iI("plus_equal",lB.token,"+="),minus_equal:new iI("minus_equal",lB.token,"-="),times_equal:new iI("times_equal",lB.token,"*="),division_equal:new iI("division_equal",lB.token,"/="),modulo_equal:new iI("modulo_equal",lB.token,"%="),and_equal:new iI("and_equal",lB.token,"&="),or_equal:new iI("or_equal",lB.token,"|="),xor_equal:new iI("xor_equal",lB.token,"^="),shift_right_equal:new iI("shift_right_equal",lB.token,">>="),shift_left_equal:new iI("shift_left_equal",lB.token,"<<=")},sI.simpleTokens={"@":aB.tokens.attr,"{":aB.tokens.brace_left,"}":aB.tokens.brace_right,":":aB.tokens.colon,",":aB.tokens.comma,"(":aB.tokens.paren_left,")":aB.tokens.paren_right,";":aB.tokens.semicolon},sI.literalTokens={"&":aB.tokens.and,"&&":aB.tokens.and_and,"->":aB.tokens.arrow,"/":aB.tokens.forward_slash,"!":aB.tokens.bang,"[":aB.tokens.bracket_left,"]":aB.tokens.bracket_right,"=":aB.tokens.equal,"==":aB.tokens.equal_equal,"!=":aB.tokens.not_equal,">":aB.tokens.greater_than,">=":aB.tokens.greater_than_equal,">>":aB.tokens.shift_right,"<":aB.tokens.less_than,"<=":aB.tokens.less_than_equal,"<<":aB.tokens.shift_left,"%":aB.tokens.modulo,"-":aB.tokens.minus,"--":aB.tokens.minus_minus,".":aB.tokens.period,"+":aB.tokens.plus,"++":aB.tokens.plus_plus,"|":aB.tokens.or,"||":aB.tokens.or_or,"*":aB.tokens.star,"~":aB.tokens.tilde,_:aB.tokens.underscore,"^":aB.tokens.xor,"+=":aB.tokens.plus_equal,"-=":aB.tokens.minus_equal,"*=":aB.tokens.times_equal,"/=":aB.tokens.division_equal,"%=":aB.tokens.modulo_equal,"&=":aB.tokens.and_equal,"|=":aB.tokens.or_equal,"^=":aB.tokens.xor_equal,">>=":aB.tokens.shift_right_equal,"<<=":aB.tokens.shift_left_equal},sI.regexTokens={decimal_float_literal:aB.tokens.decimal_float_literal,hex_float_literal:aB.tokens.hex_float_literal,int_literal:aB.tokens.int_literal,uint_literal:aB.tokens.uint_literal,ident:aB.tokens.ident},sI.storage_class=[aB.keywords.function,aB.keywords.private,aB.keywords.workgroup,aB.keywords.uniform,aB.keywords.storage],sI.access_mode=[aB.keywords.read,aB.keywords.write,aB.keywords.read_write],sI.sampler_type=[aB.keywords.sampler,aB.keywords.sampler_comparison],sI.sampled_texture_type=[aB.keywords.texture_1d,aB.keywords.texture_2d,aB.keywords.texture_2d_array,aB.keywords.texture_3d,aB.keywords.texture_cube,aB.keywords.texture_cube_array],sI.multisampled_texture_type=[aB.keywords.texture_multisampled_2d],sI.storage_texture_type=[aB.keywords.texture_storage_1d,aB.keywords.texture_storage_2d,aB.keywords.texture_storage_2d_array,aB.keywords.texture_storage_3d],sI.depth_texture_type=[aB.keywords.texture_depth_2d,aB.keywords.texture_depth_2d_array,aB.keywords.texture_depth_cube,aB.keywords.texture_depth_cube_array,aB.keywords.texture_depth_multisampled_2d],sI.texture_external_type=[aB.keywords.texture_external],sI.any_texture_type=[...aB.sampled_texture_type,...aB.multisampled_texture_type,...aB.storage_texture_type,...aB.depth_texture_type,...aB.texture_external_type],sI.texel_format=[aB.keywords.r8unorm,aB.keywords.r8snorm,aB.keywords.r8uint,aB.keywords.r8sint,aB.keywords.r16uint,aB.keywords.r16sint,aB.keywords.r16float,aB.keywords.rg8unorm,aB.keywords.rg8snorm,aB.keywords.rg8uint,aB.keywords.rg8sint,aB.keywords.r32uint,aB.keywords.r32sint,aB.keywords.r32float,aB.keywords.rg16uint,aB.keywords.rg16sint,aB.keywords.rg16float,aB.keywords.rgba8unorm,aB.keywords.rgba8unorm_srgb,aB.keywords.rgba8snorm,aB.keywords.rgba8uint,aB.keywords.rgba8sint,aB.keywords.bgra8unorm,aB.keywords.bgra8unorm_srgb,aB.keywords.rgb10a2unorm,aB.keywords.rg11b10float,aB.keywords.rg32uint,aB.keywords.rg32sint,aB.keywords.rg32float,aB.keywords.rgba16uint,aB.keywords.rgba16sint,aB.keywords.rgba16float,aB.keywords.rgba32uint,aB.keywords.rgba32sint,aB.keywords.rgba32float],sI.const_literal=[aB.tokens.int_literal,aB.tokens.uint_literal,aB.tokens.decimal_float_literal,aB.tokens.hex_float_literal,aB.keywords.true,aB.keywords.false],sI.literal_or_ident=[aB.tokens.ident,aB.tokens.int_literal,aB.tokens.uint_literal,aB.tokens.decimal_float_literal,aB.tokens.hex_float_literal,aB.tokens.name],sI.element_count_expression=[aB.tokens.int_literal,aB.tokens.uint_literal,aB.tokens.ident],sI.template_types=[aB.keywords.vec2,aB.keywords.vec3,aB.keywords.vec4,aB.keywords.mat2x2,aB.keywords.mat2x3,aB.keywords.mat2x4,aB.keywords.mat3x2,aB.keywords.mat3x3,aB.keywords.mat3x4,aB.keywords.mat4x2,aB.keywords.mat4x3,aB.keywords.mat4x4,aB.keywords.atomic,aB.keywords.bitcast,...aB.any_texture_type],sI.attribute_name=[aB.tokens.ident,aB.keywords.block,aB.keywords.diagnostic],sI.assignment_operators=[aB.tokens.equal,aB.tokens.plus_equal,aB.tokens.minus_equal,aB.tokens.times_equal,aB.tokens.division_equal,aB.tokens.modulo_equal,aB.tokens.and_equal,aB.tokens.or_equal,aB.tokens.xor_equal,aB.tokens.shift_right_equal,aB.tokens.shift_left_equal],sI.increment_operators=[aB.tokens.plus_plus,aB.tokens.minus_minus];class aI{constructor(e,t,n,r,o){this.type=e,this.lexeme=t,this.line=n,this.start=r,this.end=o}toString(){return this.lexeme}isTemplateType(){return-1!=sI.template_types.indexOf(this.type)}isArrayType(){return this.type==sI.keywords.array}isArrayOrTemplateType(){return this.isArrayType()||this.isTemplateType()}}class lI{constructor(e){this._tokens=[],this._start=0,this._current=0,this._line=1,this._source=null!=e?e:""}scanTokens(){for(;!this._isAtEnd();)if(this._start=this._current,!this.scanToken())throw`Invalid syntax at line ${this._line}`;return this._tokens.push(new aI(sI.eof,"",this._line,this._current,this._current)),this._tokens}scanToken(){let e=this._advance();if("\n"==e)return this._line++,!0;if(this._isWhitespace(e))return!0;if("/"==e){if("/"==this._peekAhead()){for(;"\n"!=e;){if(this._isAtEnd())return!0;e=this._advance()}return this._line++,!0}if("*"==this._peekAhead()){this._advance();let t=1;for(;t>0;){if(this._isAtEnd())return!0;if(e=this._advance(),"\n"==e)this._line++;else if("*"==e){if("/"==this._peekAhead()&&(this._advance(),t--,0==t))return!0}else"/"==e&&"*"==this._peekAhead()&&(this._advance(),t++)}return!0}}const t=sI.simpleTokens[e];if(t)return this._addToken(t),!0;let n=sI.none;const r=this._isAlpha(e),o="_"===e;if(this._isAlphaNumeric(e)){let t=this._peekAhead();for(;this._isAlphaNumeric(t);)e+=this._advance(),t=this._peekAhead()}if(r){const t=sI.keywords[e];if(t)return this._addToken(t),!0}if(r||o)return this._addToken(sI.tokens.ident),!0;for(;;){let t=this._findType(e);const r=this._peekAhead();if("-"==e&&this._tokens.length>0){if("="==r)return this._current++,e+=r,this._addToken(sI.tokens.minus_equal),!0;if("-"==r)return this._current++,e+=r,this._addToken(sI.tokens.minus_minus),!0;const n=this._tokens.length-1;if((-1!=sI.literal_or_ident.indexOf(this._tokens[n].type)||this._tokens[n].type==sI.tokens.paren_right)&&">"!=r)return this._addToken(t),!0}if(">"==e&&(">"==r||"="==r)){let e=!1,n=this._tokens.length-1;for(let t=0;t<5&&n>=0&&-1===sI.assignment_operators.indexOf(this._tokens[n].type);++t,--n)if(this._tokens[n].type===sI.tokens.less_than){n>0&&this._tokens[n-1].isArrayOrTemplateType()&&(e=!0);break}if(e)return this._addToken(t),!0}if(t===sI.none){let r=e,o=0;const i=2;for(let e=0;e<i;++e)if(r+=this._peekAhead(e),t=this._findType(r),t!==sI.none){o=e;break}if(t===sI.none)return n!==sI.none&&(this._current--,this._addToken(n),!0);e=r,this._current+=o+1}if(n=t,this._isAtEnd())break;e+=this._advance()}return n!==sI.none&&(this._addToken(n),!0)}_findType(e){for(const t in sI.regexTokens){const n=sI.regexTokens[t];if(this._match(e,n.rule))return n}return sI.literalTokens[e]||sI.none}_match(e,t){const n=t.exec(e);return n&&0==n.index&&n[0]==e}_isAtEnd(){return this._current>=this._source.length}_isAlpha(e){return!this._isNumeric(e)&&!this._isWhitespace(e)&&"_"!==e&&"."!==e&&"("!==e&&")"!==e&&"["!==e&&"]"!==e&&"{"!==e&&"}"!==e&&","!==e&&";"!==e&&":"!==e&&"="!==e&&"!"!==e&&"<"!==e&&">"!==e&&"+"!==e&&"-"!==e&&"*"!==e&&"/"!==e&&"%"!==e&&"&"!==e&&"|"!==e&&"^"!==e&&"~"!==e&&"@"!==e&&"#"!==e&&"?"!==e&&"'"!==e&&"`"!==e&&'"'!==e&&"\\"!==e&&"\n"!==e&&"\r"!==e&&"\t"!==e&&"\0"!==e}_isNumeric(e){return e>="0"&&e<="9"}_isAlphaNumeric(e){return this._isAlpha(e)||this._isNumeric(e)||"_"===e}_isWhitespace(e){return" "==e||"\t"==e||"\r"==e}_advance(e=0){let t=this._source[this._current];return e=e||0,e++,this._current+=e,t}_peekAhead(e=0){return e=e||0,this._current+e>=this._source.length?"\0":this._source[this._current+e]}_addToken(e){const t=this._source.substring(this._start,this._current);this._tokens.push(new aI(e,t,this._line,this._start,this._current))}}function cI(e){return Array.isArray(e)||(null==e?void 0:e.buffer)instanceof ArrayBuffer}const uI=new Float32Array(1),dI=new Uint32Array(uI.buffer),AI=new Uint32Array(uI.buffer),hI=new Int32Array(1),pI=new Float32Array(hI.buffer),fI=new Uint32Array(hI.buffer),gI=new Uint32Array(1),mI=new Float32Array(gI.buffer),yI=new Int32Array(gI.buffer);function vI(e,t,n){if(t===n)return e;if("f32"===t){if("i32"===n||"x32"===n)return uI[0]=e,dI[0];if("u32"===n)return uI[0]=e,AI[0]}else if("i32"===t||"x32"===t){if("f32"===n)return hI[0]=e,pI[0];if("u32"===n)return hI[0]=e,fI[0]}else if("u32"===t){if("f32"===n)return gI[0]=e,mI[0];if("i32"===n||"x32"===n)return gI[0]=e,yI[0]}return e}class bI{constructor(e){this.resources=null,this.inUse=!1,this.info=null,this.node=e}}class wI{constructor(e,t){this.align=e,this.size=t}}let xI=class e{constructor(){this.uniforms=[],this.storage=[],this.textures=[],this.samplers=[],this.aliases=[],this.overrides=[],this.structs=[],this.entry=new FE,this.functions=[],this._types=new Map,this._functions=new Map}_isStorageTexture(e){return"texture_storage_1d"==e.name||"texture_storage_2d"==e.name||"texture_storage_2d_array"==e.name||"texture_storage_3d"==e.name}updateAST(e){for(const t of e)t instanceof YE&&this._functions.set(t.name,new bI(t));for(const t of e)if(t instanceof SB){const e=this.getTypeInfo(t,null);e instanceof bE&&this.structs.push(e)}for(const t of e)if(t instanceof vB)this.aliases.push(this._getAliasInfo(t));else{if(t instanceof nB){const e=t,n=this._getAttributeNum(e.attributes,"id",0),r=null!=e.type?this.getTypeInfo(e.type,e.attributes):null;this.overrides.push(new kE(e.name,r,e.attributes,n));continue}if(this._isUniformVar(t)){const e=t,n=this._getAttributeNum(e.attributes,"group",0),r=this._getAttributeNum(e.attributes,"binding",0),o=this.getTypeInfo(e.type,e.attributes),i=new EE(e.name,o,n,r,e.attributes,CE.Uniform,e.access);i.access||(i.access="read"),this.uniforms.push(i);continue}if(this._isStorageVar(t)){const e=t,n=this._getAttributeNum(e.attributes,"group",0),r=this._getAttributeNum(e.attributes,"binding",0),o=this.getTypeInfo(e.type,e.attributes),i=this._isStorageTexture(o),s=new EE(e.name,o,n,r,e.attributes,i?CE.StorageTexture:CE.Storage,e.access);s.access||(s.access="read"),this.storage.push(s);continue}if(this._isTextureVar(t)){const e=t,n=this._getAttributeNum(e.attributes,"group",0),r=this._getAttributeNum(e.attributes,"binding",0),o=this.getTypeInfo(e.type,e.attributes),i=this._isStorageTexture(o),s=new EE(e.name,o,n,r,e.attributes,i?CE.StorageTexture:CE.Texture,e.access);s.access||(s.access="read"),i?this.storage.push(s):this.textures.push(s);continue}if(this._isSamplerVar(t)){const e=t,n=this._getAttributeNum(e.attributes,"group",0),r=this._getAttributeNum(e.attributes,"binding",0),o=this.getTypeInfo(e.type,e.attributes),i=new EE(e.name,o,n,r,e.attributes,CE.Sampler,e.access);this.samplers.push(i);continue}}for(const t of e)if(t instanceof YE){const e=this._getAttribute(t,"vertex"),n=this._getAttribute(t,"fragment"),r=this._getAttribute(t,"compute"),o=e||n||r,i=new PE(t.name,null==o?void 0:o.name,t.attributes);i.attributes=t.attributes,i.startLine=t.startLine,i.endLine=t.endLine,this.functions.push(i),this._functions.get(t.name).info=i,o&&(this._functions.get(t.name).inUse=!0,i.inUse=!0,i.resources=this._findResources(t,!!o),i.inputs=this._getInputs(t.args),i.outputs=this._getOutputs(t.returnType),this.entry[o.name].push(i)),i.arguments=t.args.map(e=>new TE(e.name,this.getTypeInfo(e.type,e.attributes),e.attributes)),i.returnType=t.returnType?this.getTypeInfo(t.returnType,t.attributes):null;continue}for(const t of this._functions.values())t.info&&(t.info.inUse=t.inUse,this._addCalls(t.node,t.info.calls));for(const t of this._functions.values())t.node.search(e=>{var n,r,o;if(e instanceof XB){if(e.value)if(cI(e.value))for(const i of e.value)for(const e of this.overrides)i===e.name&&(null===(n=t.info)||void 0===n||n.overrides.push(e));else for(const i of this.overrides)e.value===i.name&&(null===(r=t.info)||void 0===r||r.overrides.push(i))}else if(e instanceof MB)for(const i of this.overrides)e.name===i.name&&(null===(o=t.info)||void 0===o||o.overrides.push(i))});for(const t of this.uniforms)this._markStructsInUse(t.type);for(const t of this.storage)this._markStructsInUse(t.type)}getFunctionInfo(e){for(const t of this.functions)if(t.name==e)return t;return null}getStructInfo(e){for(const t of this.structs)if(t.name==e)return t;return null}getOverrideInfo(e){for(const t of this.overrides)if(t.name==e)return t;return null}_markStructsInUse(e){if(e)if(e.isStruct){if(e.inUse=!0,e.members)for(const t of e.members)this._markStructsInUse(t.type)}else if(e.isArray)this._markStructsInUse(e.format);else if(e.isTemplate)e.format&&this._markStructsInUse(e.format);else{const t=this._getAlias(e.name);t&&this._markStructsInUse(t)}}_addCalls(e,t){var n;for(const r of e.calls){const e=null===(n=this._functions.get(r.name))||void 0===n?void 0:n.info;e&&t.add(e)}}findResource(e,t,n){if(n){for(const r of this.entry.compute)if(r.name===n)for(const n of r.resources)if(n.group==e&&n.binding==t)return n;for(const r of this.entry.vertex)if(r.name===n)for(const n of r.resources)if(n.group==e&&n.binding==t)return n;for(const r of this.entry.fragment)if(r.name===n)for(const n of r.resources)if(n.group==e&&n.binding==t)return n}for(const r of this.uniforms)if(r.group==e&&r.binding==t)return r;for(const r of this.storage)if(r.group==e&&r.binding==t)return r;for(const r of this.textures)if(r.group==e&&r.binding==t)return r;for(const r of this.samplers)if(r.group==e&&r.binding==t)return r;return null}_findResource(e){for(const t of this.uniforms)if(t.name==e)return t;for(const t of this.storage)if(t.name==e)return t;for(const t of this.textures)if(t.name==e)return t;for(const t of this.samplers)if(t.name==e)return t;return null}_markStructsFromAST(e){const t=this.getTypeInfo(e,null);this._markStructsInUse(t)}_findResources(e,t){const n=[],r=this,o=[];return e.search(i=>{if(i instanceof WE)o.push({});else if(i instanceof $E)o.pop();else if(i instanceof tB){const e=i;t&&null!==e.type&&this._markStructsFromAST(e.type),o.length>0&&(o[o.length-1][e.name]=e)}else if(i instanceof PB){const e=i;t&&null!==e.type&&this._markStructsFromAST(e.type)}else if(i instanceof rB){const e=i;t&&null!==e.type&&this._markStructsFromAST(e.type),o.length>0&&(o[o.length-1][e.name]=e)}else if(i instanceof MB){const e=i;if(o.length>0&&o[o.length-1][e.name])return;const t=r._findResource(e.name);t&&n.push(t)}else if(i instanceof FB){const o=i,s=r._functions.get(o.name);s&&(t&&(s.inUse=!0),e.calls.add(s.node),null===s.resources&&(s.resources=r._findResources(s.node,t)),n.push(...s.resources))}else if(i instanceof dB){const o=i,s=r._functions.get(o.name);s&&(t&&(s.inUse=!0),e.calls.add(s.node),null===s.resources&&(s.resources=r._findResources(s.node,t)),n.push(...s.resources))}}),[...new Map(n.map(e=>[e.name,e])).values()]}getBindGroups(){const e=[];function t(t,n){t>=e.length&&(e.length=t+1),void 0===e[t]&&(e[t]=[]),n>=e[t].length&&(e[t].length=n+1)}for(const n of this.uniforms)t(n.group,n.binding),e[n.group][n.binding]=n;for(const n of this.storage)t(n.group,n.binding),e[n.group][n.binding]=n;for(const n of this.textures)t(n.group,n.binding),e[n.group][n.binding]=n;for(const n of this.samplers)t(n.group,n.binding),e[n.group][n.binding]=n;return e}_getOutputs(e,t=void 0){if(void 0===t&&(t=[]),e instanceof SB)this._getStructOutputs(e,t);else{const n=this._getOutputInfo(e);null!==n&&t.push(n)}return t}_getStructOutputs(e,t){for(const n of e.members)if(n.type instanceof SB)this._getStructOutputs(n.type,t);else{const e=this._getAttribute(n,"location")||this._getAttribute(n,"builtin");if(null!==e){const r=this.getTypeInfo(n.type,n.type.attributes),o=this._parseInt(e.value),i=new RE(n.name,r,e.name,o);t.push(i)}}}_getOutputInfo(e){const t=this._getAttribute(e,"location")||this._getAttribute(e,"builtin");if(null!==t){const n=this.getTypeInfo(e,e.attributes),r=this._parseInt(t.value);return new RE("",n,t.name,r)}return null}_getInputs(e,t=void 0){void 0===t&&(t=[]);for(const n of e)if(n.type instanceof SB)this._getStructInputs(n.type,t);else{const e=this._getInputInfo(n);null!==e&&t.push(e)}return t}_getStructInputs(e,t){for(const n of e.members)if(n.type instanceof SB)this._getStructInputs(n.type,t);else{const e=this._getInputInfo(n);null!==e&&t.push(e)}}_getInputInfo(e){const t=this._getAttribute(e,"location")||this._getAttribute(e,"builtin");if(null!==t){const n=this._getAttribute(e,"interpolation"),r=this.getTypeInfo(e.type,e.attributes),o=this._parseInt(t.value),i=new IE(e.name,r,t.name,o);return null!==n&&(i.interpolation=this._parseString(n.value)),i}return null}_parseString(e){return e instanceof Array&&(e=e[0]),e}_parseInt(e){e instanceof Array&&(e=e[0]);const t=parseInt(e);return isNaN(t)?e:t}_getAlias(e){for(const t of this.aliases)if(t.name==e)return t.type;return null}_getAliasInfo(e){return new BE(e.name,this.getTypeInfo(e.type,null))}getTypeInfoByName(e){for(const t of this.structs)if(t.name==e)return t;for(const t of this.aliases)if(t.name==e)return t.type;return null}getTypeInfo(e,t=null){if(this._types.has(e))return this._types.get(e);if(e instanceof BB){const n=e.type?this.getTypeInfo(e.type,e.attributes):null,r=new xE(e.name,n,t);return this._types.set(e,r),this._updateTypeInfo(r),r}if(e instanceof IB){const n=e,r=n.format?this.getTypeInfo(n.format,n.attributes):null,o=new wE(n.name,t);return o.format=r,o.count=n.count,this._types.set(e,o),this._updateTypeInfo(o),o}if(e instanceof SB){const n=e,r=new bE(n.name,t);r.startLine=n.startLine,r.endLine=n.endLine;for(const e of n.members){const t=this.getTypeInfo(e.type,e.attributes);r.members.push(new vE(e.name,t,e.attributes))}return this._types.set(e,r),this._updateTypeInfo(r),r}if(e instanceof RB){const n=e,r=n.format instanceof _B,o=n.format?r?this.getTypeInfo(n.format,null):new yE(n.format,null):null,i=new _E(n.name,o,t,n.access);return this._types.set(e,i),this._updateTypeInfo(i),i}if(e instanceof EB){const n=e,r=n.format?this.getTypeInfo(n.format,null):null,o=new _E(n.name,r,t,n.access);return this._types.set(e,o),this._updateTypeInfo(o),o}const n=new yE(e.name,t);return this._types.set(e,n),this._updateTypeInfo(n),n}_updateTypeInfo(e){var t,n,r;const o=this._getTypeSize(e);if(e.size=null!==(t=null==o?void 0:o.size)&&void 0!==t?t:0,e instanceof wE&&e.format){const t=this._getTypeSize(e.format);e.stride=Math.max(null!==(n=null==t?void 0:t.size)&&void 0!==n?n:0,null!==(r=null==t?void 0:t.align)&&void 0!==r?r:0),this._updateTypeInfo(e.format)}e instanceof xE&&this._updateTypeInfo(e.format),e instanceof bE&&this._updateStructInfo(e)}_updateStructInfo(e){var t;let n=0,r=0,o=0,i=0;for(let s=0,a=e.members.length;s<a;++s){const a=e.members[s],l=this._getTypeSize(a);if(!l)continue;null!==(t=this._getAlias(a.type.name))&&void 0!==t||a.type;const c=l.align,u=l.size;n=this._roundUp(c,n+r),r=u,o=n,i=Math.max(i,c),a.offset=n,a.size=u,this._updateTypeInfo(a.type)}e.size=this._roundUp(i,o+r),e.align=i}_getTypeSize(t){var n,r;if(null==t)return null;const o=this._getAttributeNum(t.attributes,"size",0),i=this._getAttributeNum(t.attributes,"align",0);if(t instanceof vE&&(t=t.type),t instanceof yE){const e=this._getAlias(t.name);null!==e&&(t=e)}{const r=e._typeInfo[t.name];if(void 0!==r){const e="f16"===(null===(n=t.format)||void 0===n?void 0:n.name)?2:1;return new wI(Math.max(i,r.align/e),Math.max(o,r.size/e))}}{const n=e._typeInfo[t.name.substring(0,t.name.length-1)];if(n){const e="h"===t.name[t.name.length-1]?2:1;return new wI(Math.max(i,n.align/e),Math.max(o,n.size/e))}}if(t instanceof wE){let e=t,n=8,s=8;const a=this._getTypeSize(e.format);return null!==a&&(s=a.size,n=a.align),s=e.count*this._getAttributeNum(null!==(r=null==t?void 0:t.attributes)&&void 0!==r?r:null,"stride",this._roundUp(n,s)),o&&(s=o),new wI(Math.max(i,n),Math.max(o,s))}if(t instanceof bE){let e=0,n=0,r=0,s=0,a=0;for(const o of t.members){const t=this._getTypeSize(o.type);null!==t&&(e=Math.max(t.align,e),r=this._roundUp(t.align,r+s),s=t.size,a=r)}return n=this._roundUp(e,a+s),new wI(Math.max(i,e),Math.max(o,n))}return null}_isUniformVar(e){return e instanceof tB&&"uniform"==e.storage}_isStorageVar(e){return e instanceof tB&&"storage"==e.storage}_isTextureVar(t){return t instanceof tB&&null!==t.type&&-1!=e._textureTypes.indexOf(t.type.name)}_isSamplerVar(t){return t instanceof tB&&null!==t.type&&-1!=e._samplerTypes.indexOf(t.type.name)}_getAttribute(e,t){const n=e;if(!n||!n.attributes)return null;const r=n.attributes;for(let o of r)if(o.name==t)return o;return null}_getAttributeNum(e,t,n){if(null===e)return n;for(let r of e)if(r.name==t){let e=null!==r&&null!==r.value?r.value:n;return e instanceof Array&&(e=e[0]),"number"==typeof e?e:"string"==typeof e?parseInt(e):n}return n}_roundUp(e,t){return Math.ceil(t/e)*e}};xI._typeInfo={f16:{align:2,size:2},i32:{align:4,size:4},u32:{align:4,size:4},f32:{align:4,size:4},atomic:{align:4,size:4},vec2:{align:8,size:8},vec3:{align:16,size:12},vec4:{align:16,size:16},mat2x2:{align:8,size:16},mat3x2:{align:8,size:24},mat4x2:{align:8,size:32},mat2x3:{align:16,size:32},mat3x3:{align:16,size:48},mat4x3:{align:16,size:64},mat2x4:{align:16,size:32},mat3x4:{align:16,size:48},mat4x4:{align:16,size:64}},xI._textureTypes=sI.any_texture_type.map(e=>e.name),xI._samplerTypes=sI.sampler_type.map(e=>e.name);let _I=0;class CI{constructor(e,t,n){this.id=_I++,this.name=e,this.value=t,this.node=n}clone(){return new CI(this.name,this.value,this.node)}}let SI=class e{constructor(e){this.id=_I++,this.name=e.name,this.node=e}clone(){return new e(this.node)}},EI=class e{constructor(e){this.parent=null,this.variables=new Map,this.functions=new Map,this.currentFunctionName="",this.id=_I++,e&&(this.parent=e,this.currentFunctionName=e.currentFunctionName)}getVariable(e){var t;return this.variables.has(e)?null!==(t=this.variables.get(e))&&void 0!==t?t:null:this.parent?this.parent.getVariable(e):null}getFunction(e){var t;return this.functions.has(e)?null!==(t=this.functions.get(e))&&void 0!==t?t:null:this.parent?this.parent.getFunction(e):null}createVariable(e,t,n){this.variables.set(e,new CI(e,t,null!=n?n:null))}setVariable(e,t,n){const r=this.getVariable(e);null!==r?r.value=t:this.createVariable(e,t,n)}getVariableValue(e){var t;const n=this.getVariable(e);return null!==(t=null==n?void 0:n.value)&&void 0!==t?t:null}clone(){return new e(this)}},BI=class{evalExpression(e,t){return null}getTypeInfo(e){return null}getVariableName(e,t){return""}},II=class{constructor(e){this.exec=e}getTypeInfo(e){return this.exec.getTypeInfo(e)}All(e,t){const n=this.exec.evalExpression(e.args[0],t);let r=!0;if(n instanceof tI)return n.data.forEach(e=>{e||(r=!1)}),new ZB(r?1:0,this.getTypeInfo("bool"));throw new Error(`All() expects a vector argument. Line ${e.line}`)}Any(e,t){const n=this.exec.evalExpression(e.args[0],t);if(n instanceof tI){const e=n.data.some(e=>e);return new ZB(e?1:0,this.getTypeInfo("bool"))}throw new Error(`Any() expects a vector argument. Line ${e.line}`)}Select(e,t){const n=this.exec.evalExpression(e.args[2],t);if(!(n instanceof ZB))throw new Error(`Select() expects a bool condition. Line ${e.line}`);return n.value?this.exec.evalExpression(e.args[1],t):this.exec.evalExpression(e.args[0],t)}ArrayLength(e,t){let n=e.args[0];n instanceof jB&&(n=n.right);const r=this.exec.evalExpression(n,t);if(r instanceof rI&&0===r.typeInfo.size){const e=r.typeInfo,t=r.buffer.byteLength/e.stride;return new ZB(t,this.getTypeInfo("u32"))}return new ZB(r.typeInfo.size,this.getTypeInfo("u32"))}Abs(e,t){const n=this.exec.evalExpression(e.args[0],t);if(n instanceof tI)return new tI(n.data.map(e=>Math.abs(e)),n.typeInfo);const r=n;return new ZB(Math.abs(r.value),r.typeInfo)}Acos(e,t){const n=this.exec.evalExpression(e.args[0],t);if(n instanceof tI)return new tI(n.data.map(e=>Math.acos(e)),n.typeInfo);const r=n;return new ZB(Math.acos(r.value),n.typeInfo)}Acosh(e,t){const n=this.exec.evalExpression(e.args[0],t);if(n instanceof tI)return new tI(n.data.map(e=>Math.acosh(e)),n.typeInfo);const r=n;return new ZB(Math.acosh(r.value),n.typeInfo)}Asin(e,t){const n=this.exec.evalExpression(e.args[0],t);if(n instanceof tI)return new tI(n.data.map(e=>Math.asin(e)),n.typeInfo);const r=n;return new ZB(Math.asin(r.value),n.typeInfo)}Asinh(e,t){const n=this.exec.evalExpression(e.args[0],t);if(n instanceof tI)return new tI(n.data.map(e=>Math.asinh(e)),n.typeInfo);const r=n;return new ZB(Math.asinh(r.value),n.typeInfo)}Atan(e,t){const n=this.exec.evalExpression(e.args[0],t);if(n instanceof tI)return new tI(n.data.map(e=>Math.atan(e)),n.typeInfo);const r=n;return new ZB(Math.atan(r.value),n.typeInfo)}Atanh(e,t){const n=this.exec.evalExpression(e.args[0],t);if(n instanceof tI)return new tI(n.data.map(e=>Math.atanh(e)),n.typeInfo);const r=n;return new ZB(Math.atanh(r.value),n.typeInfo)}Atan2(e,t){const n=this.exec.evalExpression(e.args[0],t),r=this.exec.evalExpression(e.args[1],t);if(n instanceof tI&&r instanceof tI)return new tI(n.data.map((e,t)=>Math.atan2(e,r.data[t])),n.typeInfo);const o=n,i=r;return new ZB(Math.atan2(o.value,i.value),n.typeInfo)}Ceil(e,t){const n=this.exec.evalExpression(e.args[0],t);if(n instanceof tI)return new tI(n.data.map(e=>Math.ceil(e)),n.typeInfo);const r=n;return new ZB(Math.ceil(r.value),n.typeInfo)}_clamp(e,t,n){return Math.min(Math.max(e,t),n)}Clamp(e,t){const n=this.exec.evalExpression(e.args[0],t),r=this.exec.evalExpression(e.args[1],t),o=this.exec.evalExpression(e.args[2],t);if(n instanceof tI&&r instanceof tI&&o instanceof tI)return new tI(n.data.map((e,t)=>this._clamp(e,r.data[t],o.data[t])),n.typeInfo);const i=n,s=r,a=o;return new ZB(this._clamp(i.value,s.value,a.value),n.typeInfo)}Cos(e,t){const n=this.exec.evalExpression(e.args[0],t);if(n instanceof tI)return new tI(n.data.map(e=>Math.cos(e)),n.typeInfo);const r=n;return new ZB(Math.cos(r.value),n.typeInfo)}Cosh(e,t){const n=this.exec.evalExpression(e.args[0],t);if(n instanceof tI)return new tI(n.data.map(e=>Math.cosh(e)),n.typeInfo);const r=n;return new ZB(Math.cos(r.value),n.typeInfo)}CountLeadingZeros(e,t){const n=this.exec.evalExpression(e.args[0],t);if(n instanceof tI)return new tI(n.data.map(e=>Math.clz32(e)),n.typeInfo);const r=n;return new ZB(Math.clz32(r.value),n.typeInfo)}_countOneBits(e){let t=0;for(;0!==e;)1&e&&t++,e>>=1;return t}CountOneBits(e,t){const n=this.exec.evalExpression(e.args[0],t);if(n instanceof tI)return new tI(n.data.map(e=>this._countOneBits(e)),n.typeInfo);const r=n;return new ZB(this._countOneBits(r.value),n.typeInfo)}_countTrailingZeros(e){if(0===e)return 32;let t=0;for(;!(1&e);)e>>=1,t++;return t}CountTrailingZeros(e,t){const n=this.exec.evalExpression(e.args[0],t);if(n instanceof tI)return new tI(n.data.map(e=>this._countTrailingZeros(e)),n.typeInfo);const r=n;return new ZB(this._countTrailingZeros(r.value),n.typeInfo)}Cross(e,t){const n=this.exec.evalExpression(e.args[0],t),r=this.exec.evalExpression(e.args[1],t);if(n instanceof tI&&r instanceof tI){if(3!==n.data.length||3!==r.data.length)return null;const e=n.data,t=r.data;return new tI([e[1]*t[2]-t[1]*e[2],e[2]*t[0]-t[2]*e[0],e[0]*t[1]-t[0]*e[1]],n.typeInfo)}return null}Degrees(e,t){const n=this.exec.evalExpression(e.args[0],t),r=180/Math.PI;return n instanceof tI?new tI(n.data.map(e=>e*r),n.typeInfo):new ZB(n.value*r,this.getTypeInfo("f32"))}Determinant(e,t){const n=this.exec.evalExpression(e.args[0],t);if(n instanceof nI){const e=n.data,t=n.typeInfo.getTypeName(),r=t.endsWith("h")?this.getTypeInfo("f16"):this.getTypeInfo("f32");if("mat2x2"===t||"mat2x2f"===t||"mat2x2h"===t)return new ZB(e[0]*e[3]-e[1]*e[2],r);if("mat2x3"===t||"mat2x3f"===t||"mat2x3h"===t)return new ZB(e[0]*(e[4]*e[8]-e[5]*e[7])-e[1]*(e[3]*e[8]-e[5]*e[6])+e[2]*(e[3]*e[7]-e[4]*e[6]),r);if("mat2x4"===t||"mat2x4f"===t||"mat2x4h"===t);else if("mat3x2"===t||"mat3x2f"===t||"mat3x2h"===t);else if("mat3x3"===t||"mat3x3f"===t||"mat3x3h"===t)return new ZB(e[0]*(e[4]*e[8]-e[5]*e[7])-e[1]*(e[3]*e[8]-e[5]*e[6])+e[2]*(e[3]*e[7]-e[4]*e[6]),r)}return null}Distance(e,t){const n=this.exec.evalExpression(e.args[0],t),r=this.exec.evalExpression(e.args[1],t);if(n instanceof tI&&r instanceof tI){let e=0;for(let t=0;t<n.data.length;++t)e+=(n.data[t]-r.data[t])*(n.data[t]-r.data[t]);return new ZB(Math.sqrt(e),this.getTypeInfo("f32"))}const o=n,i=r;return new ZB(Math.abs(o.value-i.value),n.typeInfo)}_dot(e,t){let n=0;for(let r=0;r<e.length;++r)n+=t[r]*e[r];return n}Dot(e,t){const n=this.exec.evalExpression(e.args[0],t),r=this.exec.evalExpression(e.args[1],t);return n instanceof tI&&r instanceof tI?new ZB(this._dot(n.data,r.data),this.getTypeInfo("f32")):null}Dot4U8Packed(e,t){return null}Dot4I8Packed(e,t){return null}Exp(e,t){const n=this.exec.evalExpression(e.args[0],t);if(n instanceof tI)return new tI(n.data.map(e=>Math.exp(e)),n.typeInfo);const r=n;return new ZB(Math.exp(r.value),n.typeInfo)}Exp2(e,t){const n=this.exec.evalExpression(e.args[0],t);if(n instanceof tI)return new tI(n.data.map(e=>Math.pow(2,e)),n.typeInfo);const r=n;return new ZB(Math.pow(2,r.value),n.typeInfo)}ExtractBits(e,t){const n=this.exec.evalExpression(e.args[0],t),r=this.exec.evalExpression(e.args[1],t),o=this.exec.evalExpression(e.args[2],t);if("u32"!==r.typeInfo.name&&"x32"!==r.typeInfo.name)return null;if("u32"!==o.typeInfo.name&&"x32"!==o.typeInfo.name)return null;const i=r.value,s=o.value;if(n instanceof tI)return new tI(n.data.map(e=>e>>i&(1<<s)-1),n.typeInfo);if("i32"!==n.typeInfo.name&&"x32"!==n.typeInfo.name)return null;const a=n.value;return new ZB(a>>i&(1<<s)-1,this.getTypeInfo("i32"))}FaceForward(e,t){const n=this.exec.evalExpression(e.args[0],t),r=this.exec.evalExpression(e.args[1],t),o=this.exec.evalExpression(e.args[2],t);if(n instanceof tI&&r instanceof tI&&o instanceof tI){const e=this._dot(r.data,o.data);return new tI(e<0?Array.from(n.data):n.data.map(e=>-e),n.typeInfo)}return null}_firstLeadingBit(e){return 0===e?-1:31-Math.clz32(e)}FirstLeadingBit(e,t){const n=this.exec.evalExpression(e.args[0],t);if(n instanceof tI)return new tI(n.data.map(e=>this._firstLeadingBit(e)),n.typeInfo);const r=n;return new ZB(this._firstLeadingBit(r.value),n.typeInfo)}_firstTrailingBit(e){return 0===e?-1:Math.log2(e&-e)}FirstTrailingBit(e,t){const n=this.exec.evalExpression(e.args[0],t);if(n instanceof tI)return new tI(n.data.map(e=>this._firstTrailingBit(e)),n.typeInfo);const r=n;return new ZB(this._firstTrailingBit(r.value),n.typeInfo)}Floor(e,t){const n=this.exec.evalExpression(e.args[0],t);if(n instanceof tI)return new tI(n.data.map(e=>Math.floor(e)),n.typeInfo);const r=n;return new ZB(Math.floor(r.value),n.typeInfo)}Fma(e,t){const n=this.exec.evalExpression(e.args[0],t),r=this.exec.evalExpression(e.args[1],t),o=this.exec.evalExpression(e.args[2],t);if(n instanceof tI&&r instanceof tI&&o instanceof tI)return n.data.length!==r.data.length||n.data.length!==o.data.length?null:new tI(n.data.map((e,t)=>e*r.data[t]+o.data[t]),n.typeInfo);const i=n,s=r,a=o;return new ZB(i.value*s.value+a.value,i.typeInfo)}Fract(e,t){const n=this.exec.evalExpression(e.args[0],t);if(n instanceof tI)return new tI(n.data.map(e=>e-Math.floor(e)),n.typeInfo);const r=n;return new ZB(r.value-Math.floor(r.value),n.typeInfo)}Frexp(e,t){return null}InsertBits(e,t){const n=this.exec.evalExpression(e.args[0],t),r=this.exec.evalExpression(e.args[1],t),o=this.exec.evalExpression(e.args[2],t),i=this.exec.evalExpression(e.args[3],t);if("u32"!==o.typeInfo.name&&"x32"!==o.typeInfo.name)return null;const s=o.value,a=(1<<i.value)-1<<s,l=~a;if(n instanceof tI&&r instanceof tI)return new tI(n.data.map((e,t)=>e&l|r.data[t]<<s&a),n.typeInfo);const c=n.value,u=r.value;return new ZB(c&l|u<<s&a,n.typeInfo)}InverseSqrt(e,t){const n=this.exec.evalExpression(e.args[0],t);if(n instanceof tI)return new tI(n.data.map(e=>1/Math.sqrt(e)),n.typeInfo);const r=n;return new ZB(1/Math.sqrt(r.value),n.typeInfo)}Ldexp(e,t){return null}Length(e,t){const n=this.exec.evalExpression(e.args[0],t);if(n instanceof tI){let e=0;return n.data.forEach(t=>{e+=t*t}),new ZB(Math.sqrt(e),this.getTypeInfo("f32"))}const r=n;return new ZB(Math.abs(r.value),n.typeInfo)}Log(e,t){const n=this.exec.evalExpression(e.args[0],t);if(n instanceof tI)return new tI(n.data.map(e=>Math.log(e)),n.typeInfo);const r=n;return new ZB(Math.log(r.value),n.typeInfo)}Log2(e,t){const n=this.exec.evalExpression(e.args[0],t);if(n instanceof tI)return new tI(n.data.map(e=>Math.log2(e)),n.typeInfo);const r=n;return new ZB(Math.log2(r.value),n.typeInfo)}Max(e,t){const n=this.exec.evalExpression(e.args[0],t),r=this.exec.evalExpression(e.args[1],t);if(n instanceof tI&&r instanceof tI)return new tI(n.data.map((e,t)=>Math.max(e,r.data[t])),n.typeInfo);const o=n,i=r;return new ZB(Math.max(o.value,i.value),n.typeInfo)}Min(e,t){const n=this.exec.evalExpression(e.args[0],t),r=this.exec.evalExpression(e.args[1],t);if(n instanceof tI&&r instanceof tI)return new tI(n.data.map((e,t)=>Math.min(e,r.data[t])),n.typeInfo);const o=n,i=r;return new ZB(Math.min(o.value,i.value),n.typeInfo)}Mix(e,t){const n=this.exec.evalExpression(e.args[0],t),r=this.exec.evalExpression(e.args[1],t),o=this.exec.evalExpression(e.args[2],t);if(n instanceof tI&&r instanceof tI&&o instanceof tI)return new tI(n.data.map((e,t)=>n.data[t]*(1-o.data[t])+r.data[t]*o.data[t]),n.typeInfo);const i=r,s=o;return new ZB(n.value*(1-s.value)+i.value*s.value,n.typeInfo)}Modf(e,t){const n=this.exec.evalExpression(e.args[0],t),r=this.exec.evalExpression(e.args[1],t);if(n instanceof tI&&r instanceof tI)return new tI(n.data.map((e,t)=>e%r.data[t]),n.typeInfo);const o=r;return new ZB(n.value%o.value,n.typeInfo)}Normalize(e,t){const n=this.exec.evalExpression(e.args[0],t);if(n instanceof tI){const r=this.Length(e,t).value;return new tI(n.data.map(e=>e/r),n.typeInfo)}return null}Pow(e,t){const n=this.exec.evalExpression(e.args[0],t),r=this.exec.evalExpression(e.args[1],t);if(n instanceof tI&&r instanceof tI)return new tI(n.data.map((e,t)=>Math.pow(e,r.data[t])),n.typeInfo);const o=n,i=r;return new ZB(Math.pow(o.value,i.value),n.typeInfo)}QuantizeToF16(e,t){const n=this.exec.evalExpression(e.args[0],t);return n instanceof tI?new tI(n.data.map(e=>e),n.typeInfo):new ZB(n.value,n.typeInfo)}Radians(e,t){const n=this.exec.evalExpression(e.args[0],t);return n instanceof tI?new tI(n.data.map(e=>e*Math.PI/180),n.typeInfo):new ZB(n.value*Math.PI/180,this.getTypeInfo("f32"))}Reflect(e,t){let n=this.exec.evalExpression(e.args[0],t),r=this.exec.evalExpression(e.args[1],t);if(n instanceof tI&&r instanceof tI){const e=this._dot(n.data,r.data);return new tI(n.data.map((t,n)=>t-2*e*r.data[n]),n.typeInfo)}return null}Refract(e,t){let n=this.exec.evalExpression(e.args[0],t),r=this.exec.evalExpression(e.args[1],t),o=this.exec.evalExpression(e.args[2],t);if(n instanceof tI&&r instanceof tI&&o instanceof ZB){const e=this._dot(r.data,n.data);return new tI(n.data.map((t,n)=>{const i=1-o.value*o.value*(1-e*e);if(i<0)return 0;const s=Math.sqrt(i);return o.value*t-(o.value*e+s)*r.data[n]}),n.typeInfo)}return null}ReverseBits(e,t){return null}Round(e,t){const n=this.exec.evalExpression(e.args[0],t);if(n instanceof tI)return new tI(n.data.map(e=>Math.round(e)),n.typeInfo);const r=n;return new ZB(Math.round(r.value),n.typeInfo)}Saturate(e,t){const n=this.exec.evalExpression(e.args[0],t);if(n instanceof tI)return new tI(n.data.map(e=>Math.min(Math.max(e,0),1)),n.typeInfo);const r=n;return new ZB(Math.min(Math.max(r.value,0),1),n.typeInfo)}Sign(e,t){const n=this.exec.evalExpression(e.args[0],t);if(n instanceof tI)return new tI(n.data.map(e=>Math.sign(e)),n.typeInfo);const r=n;return new ZB(Math.sign(r.value),n.typeInfo)}Sin(e,t){const n=this.exec.evalExpression(e.args[0],t);if(n instanceof tI)return new tI(n.data.map(e=>Math.sin(e)),n.typeInfo);const r=n;return new ZB(Math.sin(r.value),n.typeInfo)}Sinh(e,t){const n=this.exec.evalExpression(e.args[0],t);if(n instanceof tI)return new tI(n.data.map(e=>Math.sinh(e)),n.typeInfo);const r=n;return new ZB(Math.sinh(r.value),n.typeInfo)}_smoothstep(e,t,n){const r=Math.min(Math.max((n-e)/(t-e),0),1);return r*r*(3-2*r)}SmoothStep(e,t){const n=this.exec.evalExpression(e.args[0],t),r=this.exec.evalExpression(e.args[1],t),o=this.exec.evalExpression(e.args[2],t);if(o instanceof tI&&n instanceof tI&&r instanceof tI)return new tI(o.data.map((e,t)=>this._smoothstep(n.data[t],r.data[t],e)),o.typeInfo);const i=n,s=r,a=o;return new ZB(this._smoothstep(i.value,s.value,a.value),o.typeInfo)}Sqrt(e,t){const n=this.exec.evalExpression(e.args[0],t);if(n instanceof tI)return new tI(n.data.map(e=>Math.sqrt(e)),n.typeInfo);const r=n;return new ZB(Math.sqrt(r.value),n.typeInfo)}Step(e,t){const n=this.exec.evalExpression(e.args[0],t),r=this.exec.evalExpression(e.args[1],t);if(r instanceof tI&&n instanceof tI)return new tI(r.data.map((e,t)=>e<n.data[t]?0:1),r.typeInfo);const o=n;return new ZB(r.value<o.value?0:1,o.typeInfo)}Tan(e,t){const n=this.exec.evalExpression(e.args[0],t);if(n instanceof tI)return new tI(n.data.map(e=>Math.tan(e)),n.typeInfo);const r=n;return new ZB(Math.tan(r.value),n.typeInfo)}Tanh(e,t){const n=this.exec.evalExpression(e.args[0],t);if(n instanceof tI)return new tI(n.data.map(e=>Math.tanh(e)),n.typeInfo);const r=n;return new ZB(Math.tanh(r.value),n.typeInfo)}_getTransposeType(e){const t=e.getTypeName();return"mat2x2f"===t||"mat2x2h"===t?e:"mat2x3f"===t?this.getTypeInfo("mat3x2f"):"mat2x3h"===t?this.getTypeInfo("mat3x2h"):"mat2x4f"===t?this.getTypeInfo("mat4x2f"):"mat2x4h"===t?this.getTypeInfo("mat4x2h"):"mat3x2f"===t?this.getTypeInfo("mat2x3f"):"mat3x2h"===t?this.getTypeInfo("mat2x3h"):"mat3x3f"===t||"mat3x3h"===t?e:"mat3x4f"===t?this.getTypeInfo("mat4x3f"):"mat3x4h"===t?this.getTypeInfo("mat4x3h"):"mat4x2f"===t?this.getTypeInfo("mat2x4f"):"mat4x2h"===t?this.getTypeInfo("mat2x4h"):"mat4x3f"===t?this.getTypeInfo("mat3x4f"):"mat4x3h"===t?this.getTypeInfo("mat3x4h"):e}Transpose(e,t){const n=this.exec.evalExpression(e.args[0],t);if(!(n instanceof nI))return null;const r=this._getTransposeType(n.typeInfo);if("mat2x2"===n.typeInfo.name||"mat2x2f"===n.typeInfo.name||"mat2x2h"===n.typeInfo.name){const e=n.data;return new nI([e[0],e[2],e[1],e[3]],r)}if("mat2x3"===n.typeInfo.name||"mat2x3f"===n.typeInfo.name||"mat2x3h"===n.typeInfo.name){const e=n.data;return new nI([e[0],e[3],e[6],e[1],e[4],e[7]],r)}if("mat2x4"===n.typeInfo.name||"mat2x4f"===n.typeInfo.name||"mat2x4h"===n.typeInfo.name){const e=n.data;return new nI([e[0],e[4],e[8],e[12],e[1],e[5],e[9],e[13]],r)}if("mat3x2"===n.typeInfo.name||"mat3x2f"===n.typeInfo.name||"mat3x2h"===n.typeInfo.name){const e=n.data;return new nI([e[0],e[3],e[1],e[4],e[2],e[5]],r)}if("mat3x3"===n.typeInfo.name||"mat3x3f"===n.typeInfo.name||"mat3x3h"===n.typeInfo.name){const e=n.data;return new nI([e[0],e[3],e[6],e[1],e[4],e[7],e[2],e[5],e[8]],r)}if("mat3x4"===n.typeInfo.name||"mat3x4f"===n.typeInfo.name||"mat3x4h"===n.typeInfo.name){const e=n.data;return new nI([e[0],e[4],e[8],e[12],e[1],e[5],e[9],e[13],e[2],e[6],e[10],e[14]],r)}if("mat4x2"===n.typeInfo.name||"mat4x2f"===n.typeInfo.name||"mat4x2h"===n.typeInfo.name){const e=n.data;return new nI([e[0],e[4],e[1],e[5],e[2],e[6]],r)}if("mat4x3"===n.typeInfo.name||"mat4x3f"===n.typeInfo.name||"mat4x3h"===n.typeInfo.name){const e=n.data;return new nI([e[0],e[4],e[8],e[1],e[5],e[9],e[2],e[6],e[10]],r)}if("mat4x4"===n.typeInfo.name||"mat4x4f"===n.typeInfo.name||"mat4x4h"===n.typeInfo.name){const e=n.data;return new nI([e[0],e[4],e[8],e[12],e[1],e[5],e[9],e[13],e[2],e[6],e[10],e[14],e[3],e[7],e[11],e[15]],r)}return null}Trunc(e,t){const n=this.exec.evalExpression(e.args[0],t);if(n instanceof tI)return new tI(n.data.map(e=>Math.trunc(e)),n.typeInfo);const r=n;return new ZB(Math.trunc(r.value),n.typeInfo)}Dpdx(e,t){return null}DpdxCoarse(e,t){return null}DpdxFine(e,t){return null}Dpdy(e,t){return null}DpdyCoarse(e,t){return null}DpdyFine(e,t){return null}Fwidth(e,t){return null}FwidthCoarse(e,t){return null}FwidthFine(e,t){return null}TextureDimensions(e,t){const n=e.args[0],r=e.args.length>1?this.exec.evalExpression(e.args[1],t).value:0;if(n instanceof MB){const e=n.name,o=t.getVariableValue(e);if(o instanceof oI){if(r<0||r>=o.mipLevelCount)return null;const e=o.getMipLevelSize(r),t=o.dimension;return"1d"===t?new ZB(e[0],this.getTypeInfo("u32")):"3d"===t?new tI(e,this.getTypeInfo("vec3u")):"2d"===t?new tI(e.slice(0,2),this.getTypeInfo("vec2u")):null}return null}return null}TextureGather(e,t){return null}TextureGatherCompare(e,t){return null}TextureLoad(e,t){const n=e.args[0],r=this.exec.evalExpression(e.args[1],t),o=e.args.length>2?this.exec.evalExpression(e.args[2],t).value:0;if(!(r instanceof tI)||2!==r.data.length)return null;if(n instanceof MB){const e=n.name,i=t.getVariableValue(e);if(i instanceof oI){const e=Math.floor(r.data[0]),t=Math.floor(r.data[1]);if(e<0||e>=i.width||t<0||t>=i.height)return null;const n=i.getPixel(e,t,0,o);return null===n?null:new tI(n,this.getTypeInfo("vec4f"))}return null}return null}TextureNumLayers(e,t){const n=e.args[0];if(n instanceof MB){const e=n.name,r=t.getVariableValue(e);return r instanceof oI?new ZB(r.depthOrArrayLayers,this.getTypeInfo("u32")):null}return null}TextureNumLevels(e,t){const n=e.args[0];if(n instanceof MB){const e=n.name,r=t.getVariableValue(e);return r instanceof oI?new ZB(r.mipLevelCount,this.getTypeInfo("u32")):null}return null}TextureNumSamples(e,t){const n=e.args[0];if(n instanceof MB){const e=n.name,r=t.getVariableValue(e);return r instanceof oI?new ZB(r.sampleCount,this.getTypeInfo("u32")):null}return null}TextureSample(e,t){return null}TextureSampleBias(e,t){return null}TextureSampleCompare(e,t){return null}TextureSampleCompareLevel(e,t){return null}TextureSampleGrad(e,t){return null}TextureSampleLevel(e,t){return null}TextureSampleBaseClampToEdge(e,t){return null}TextureStore(e,t){const n=e.args[0],r=this.exec.evalExpression(e.args[1],t),o=4===e.args.length?this.exec.evalExpression(e.args[2],t).value:0,i=4===e.args.length?this.exec.evalExpression(e.args[3],t).data:this.exec.evalExpression(e.args[2],t).data;if(4!==i.length)return null;if(!(r instanceof tI)||2!==r.data.length)return null;if(n instanceof MB){const e=n.name,s=t.getVariableValue(e);if(s instanceof oI){const e=s.getMipLevelSize(0),t=Math.floor(r.data[0]),n=Math.floor(r.data[1]);return t<0||t>=e[0]||n<0||n>=e[1]||s.setPixel(t,n,0,o,Array.from(i)),null}return null}return null}AtomicLoad(e,t){let n=e.args[0];n instanceof jB&&(n=n.right);const r=this.exec.getVariableName(n,t);return t.getVariable(r).value.getSubData(this.exec,n.postfix,t)}AtomicStore(e,t){let n=e.args[0];n instanceof jB&&(n=n.right);const r=this.exec.getVariableName(n,t),o=t.getVariable(r);let i=e.args[1];const s=this.exec.evalExpression(i,t),a=o.value.getSubData(this.exec,n.postfix,t);return a instanceof ZB&&s instanceof ZB&&(a.value=s.value),o.value instanceof rI&&o.value.setDataValue(this.exec,a,n.postfix,t),null}AtomicAdd(e,t){let n=e.args[0];n instanceof jB&&(n=n.right);const r=this.exec.getVariableName(n,t),o=t.getVariable(r);let i=e.args[1];const s=this.exec.evalExpression(i,t),a=o.value.getSubData(this.exec,n.postfix,t),l=new ZB(a.value,a.typeInfo);return a instanceof ZB&&s instanceof ZB&&(a.value+=s.value),o.value instanceof rI&&o.value.setDataValue(this.exec,a,n.postfix,t),l}AtomicSub(e,t){let n=e.args[0];n instanceof jB&&(n=n.right);const r=this.exec.getVariableName(n,t),o=t.getVariable(r);let i=e.args[1];const s=this.exec.evalExpression(i,t),a=o.value.getSubData(this.exec,n.postfix,t),l=new ZB(a.value,a.typeInfo);return a instanceof ZB&&s instanceof ZB&&(a.value-=s.value),o.value instanceof rI&&o.value.setDataValue(this.exec,a,n.postfix,t),l}AtomicMax(e,t){let n=e.args[0];n instanceof jB&&(n=n.right);const r=this.exec.getVariableName(n,t),o=t.getVariable(r);let i=e.args[1];const s=this.exec.evalExpression(i,t),a=o.value.getSubData(this.exec,n.postfix,t),l=new ZB(a.value,a.typeInfo);return a instanceof ZB&&s instanceof ZB&&(a.value=Math.max(a.value,s.value)),o.value instanceof rI&&o.value.setDataValue(this.exec,a,n.postfix,t),l}AtomicMin(e,t){let n=e.args[0];n instanceof jB&&(n=n.right);const r=this.exec.getVariableName(n,t),o=t.getVariable(r);let i=e.args[1];const s=this.exec.evalExpression(i,t),a=o.value.getSubData(this.exec,n.postfix,t),l=new ZB(a.value,a.typeInfo);return a instanceof ZB&&s instanceof ZB&&(a.value=Math.min(a.value,s.value)),o.value instanceof rI&&o.value.setDataValue(this.exec,a,n.postfix,t),l}AtomicAnd(e,t){let n=e.args[0];n instanceof jB&&(n=n.right);const r=this.exec.getVariableName(n,t),o=t.getVariable(r);let i=e.args[1];const s=this.exec.evalExpression(i,t),a=o.value.getSubData(this.exec,n.postfix,t),l=new ZB(a.value,a.typeInfo);return a instanceof ZB&&s instanceof ZB&&(a.value=a.value&s.value),o.value instanceof rI&&o.value.setDataValue(this.exec,a,n.postfix,t),l}AtomicOr(e,t){let n=e.args[0];n instanceof jB&&(n=n.right);const r=this.exec.getVariableName(n,t),o=t.getVariable(r);let i=e.args[1];const s=this.exec.evalExpression(i,t),a=o.value.getSubData(this.exec,n.postfix,t),l=new ZB(a.value,a.typeInfo);return a instanceof ZB&&s instanceof ZB&&(a.value=a.value|s.value),o.value instanceof rI&&o.value.setDataValue(this.exec,a,n.postfix,t),l}AtomicXor(e,t){let n=e.args[0];n instanceof jB&&(n=n.right);const r=this.exec.getVariableName(n,t),o=t.getVariable(r);let i=e.args[1];const s=this.exec.evalExpression(i,t),a=o.value.getSubData(this.exec,n.postfix,t),l=new ZB(a.value,a.typeInfo);return a instanceof ZB&&s instanceof ZB&&(a.value=a.value^s.value),o.value instanceof rI&&o.value.setDataValue(this.exec,a,n.postfix,t),l}AtomicExchange(e,t){let n=e.args[0];n instanceof jB&&(n=n.right);const r=this.exec.getVariableName(n,t),o=t.getVariable(r);let i=e.args[1];const s=this.exec.evalExpression(i,t),a=o.value.getSubData(this.exec,n.postfix,t),l=new ZB(a.value,a.typeInfo);return a instanceof ZB&&s instanceof ZB&&(a.value=s.value),o.value instanceof rI&&o.value.setDataValue(this.exec,a,n.postfix,t),l}AtomicCompareExchangeWeak(e,t){return null}Pack4x8snorm(e,t){return null}Pack4x8unorm(e,t){return null}Pack4xI8(e,t){return null}Pack4xU8(e,t){return null}Pack4x8Clamp(e,t){return null}Pack4xU8Clamp(e,t){return null}Pack2x16snorm(e,t){return null}Pack2x16unorm(e,t){return null}Pack2x16float(e,t){return null}Unpack4x8snorm(e,t){return null}Unpack4x8unorm(e,t){return null}Unpack4xI8(e,t){return null}Unpack4xU8(e,t){return null}Unpack2x16snorm(e,t){return null}Unpack2x16unorm(e,t){return null}Unpack2x16float(e,t){return null}StorageBarrier(e,t){return null}TextureBarrier(e,t){return null}WorkgroupBarrier(e,t){return null}WorkgroupUniformLoad(e,t){return null}SubgroupAdd(e,t){return null}SubgroupExclusiveAdd(e,t){return null}SubgroupInclusiveAdd(e,t){return null}SubgroupAll(e,t){return null}SubgroupAnd(e,t){return null}SubgroupAny(e,t){return null}SubgroupBallot(e,t){return null}SubgroupBroadcast(e,t){return null}SubgroupBroadcastFirst(e,t){return null}SubgroupElect(e,t){return null}SubgroupMax(e,t){return null}SubgroupMin(e,t){return null}SubgroupMul(e,t){return null}SubgroupExclusiveMul(e,t){return null}SubgroupInclusiveMul(e,t){return null}SubgroupOr(e,t){return null}SubgroupShuffle(e,t){return null}SubgroupShuffleDown(e,t){return null}SubgroupShuffleUp(e,t){return null}SubgroupShuffleXor(e,t){return null}SubgroupXor(e,t){return null}QuadBroadcast(e,t){return null}QuadSwapDiagonal(e,t){return null}QuadSwapX(e,t){return null}QuadSwapY(e,t){return null}};const RI={vec2:2,vec2f:2,vec2i:2,vec2u:2,vec2b:2,vec2h:2,vec3:3,vec3f:3,vec3i:3,vec3u:3,vec3b:3,vec3h:3,vec4:4,vec4f:4,vec4i:4,vec4u:4,vec4b:4,vec4h:4},kI={mat2x2:[2,2,4],mat2x2f:[2,2,4],mat2x2h:[2,2,4],mat2x3:[2,3,6],mat2x3f:[2,3,6],mat2x3h:[2,3,6],mat2x4:[2,4,8],mat2x4f:[2,4,8],mat2x4h:[2,4,8],mat3x2:[3,2,6],mat3x2f:[3,2,6],mat3x2h:[3,2,6],mat3x3:[3,3,9],mat3x3f:[3,3,9],mat3x3h:[3,3,9],mat3x4:[3,4,12],mat3x4f:[3,4,12],mat3x4h:[3,4,12],mat4x2:[4,2,8],mat4x2f:[4,2,8],mat4x2h:[4,2,8],mat4x3:[4,3,12],mat4x3f:[4,3,12],mat4x3h:[4,3,12],mat4x4:[4,4,16],mat4x4f:[4,4,16],mat4x4h:[4,4,16]};class TI extends BI{constructor(e,t){var n;super(),this.ast=null!=e?e:[],this.reflection=new xI,this.reflection.updateAST(this.ast),this.context=null!==(n=null==t?void 0:t.clone())&&void 0!==n?n:new EI,this.builtins=new II(this),this.typeInfo={bool:this.getTypeInfo(_B.bool),i32:this.getTypeInfo(_B.i32),u32:this.getTypeInfo(_B.u32),f32:this.getTypeInfo(_B.f32),f16:this.getTypeInfo(_B.f16),vec2f:this.getTypeInfo(EB.vec2f),vec2u:this.getTypeInfo(EB.vec2u),vec2i:this.getTypeInfo(EB.vec2i),vec2h:this.getTypeInfo(EB.vec2h),vec3f:this.getTypeInfo(EB.vec3f),vec3u:this.getTypeInfo(EB.vec3u),vec3i:this.getTypeInfo(EB.vec3i),vec3h:this.getTypeInfo(EB.vec3h),vec4f:this.getTypeInfo(EB.vec4f),vec4u:this.getTypeInfo(EB.vec4u),vec4i:this.getTypeInfo(EB.vec4i),vec4h:this.getTypeInfo(EB.vec4h),mat2x2f:this.getTypeInfo(EB.mat2x2f),mat2x3f:this.getTypeInfo(EB.mat2x3f),mat2x4f:this.getTypeInfo(EB.mat2x4f),mat3x2f:this.getTypeInfo(EB.mat3x2f),mat3x3f:this.getTypeInfo(EB.mat3x3f),mat3x4f:this.getTypeInfo(EB.mat3x4f),mat4x2f:this.getTypeInfo(EB.mat4x2f),mat4x3f:this.getTypeInfo(EB.mat4x3f),mat4x4f:this.getTypeInfo(EB.mat4x4f)}}getVariableValue(e){var t,n;const r=null!==(n=null===(t=this.context.getVariable(e))||void 0===t?void 0:t.value)&&void 0!==n?n:null;if(null===r)return null;if(r instanceof ZB)return r.value;if(r instanceof tI)return Array.from(r.data);if(r instanceof nI)return Array.from(r.data);if(r instanceof rI&&r.typeInfo instanceof wE){if("u32"===r.typeInfo.format.name)return Array.from(new Uint32Array(r.buffer,r.offset,r.typeInfo.count));if("i32"===r.typeInfo.format.name)return Array.from(new Int32Array(r.buffer,r.offset,r.typeInfo.count));if("f32"===r.typeInfo.format.name)return Array.from(new Float32Array(r.buffer,r.offset,r.typeInfo.count))}return null}execute(e){(e=null!=e?e:{}).constants&&this._setOverrides(e.constants,this.context),this._execStatements(this.ast,this.context)}dispatchWorkgroups(e,t,n,r){const o=this.context.clone();(r=null!=r?r:{}).constants&&this._setOverrides(r.constants,o),this._execStatements(this.ast,o);const i=o.getFunction(e);if(!i)return;if("number"==typeof t)t=[t,1,1];else{if(0===t.length)return;1===t.length?t=[t[0],1,1]:2===t.length?t=[t[0],t[1],1]:t.length>3&&(t=[t[0],t[1],t[2]])}const s=t[0],a=t[1],l=t[2],c=this.getTypeInfo("vec3u");o.setVariable("@num_workgroups",new tI(t,c));const u=this.reflection.getFunctionInfo(e);for(const d in n)for(const e in n[d]){const t=n[d][e];o.variables.forEach(n=>{var r;const o=n.node;if(null==o?void 0:o.attributes){let i=null,s=null;for(const e of o.attributes)"binding"===e.name?i=e.value:"group"===e.name&&(s=e.value);if(e==i&&d==s){let i=!1;for(const t of u.resources)if(t.name===n.name&&t.group===parseInt(d)&&t.binding===parseInt(e)){i=!0;break}if(i)if(void 0!==t.texture&&void 0!==t.descriptor){const e=new oI(t.texture,this.getTypeInfo(o.type),t.descriptor,null!==(r=t.texture.view)&&void 0!==r?r:null);n.value=e}else void 0!==t.uniform?n.value=new rI(t.uniform,this.getTypeInfo(o.type)):n.value=new rI(t,this.getTypeInfo(o.type))}}})}for(let d=0;d<l;++d)for(let e=0;e<a;++e)for(let t=0;t<s;++t)o.setVariable("@workgroup_id",new tI([t,e,d],this.getTypeInfo("vec3u"))),this._dispatchWorkgroup(i,[t,e,d],o)}execStatement(e,t){if(e instanceof fB)return this.evalExpression(e.value,t);if(e instanceof wB){if(e.condition){const n=this.evalExpression(e.condition,t);if(!(n instanceof ZB))throw new Error("Invalid break-if condition");if(!n.value)return null}return TI._breakObj}if(e instanceof xB)return TI._continueObj;if(e instanceof rB)this._let(e,t);else if(e instanceof tB)this._var(e,t);else if(e instanceof oB)this._const(e,t);else if(e instanceof YE)this._function(e,t);else{if(e instanceof pB)return this._if(e,t);if(e instanceof hB)return this._switch(e,t);if(e instanceof eB)return this._for(e,t);if(e instanceof JE)return this._while(e,t);if(e instanceof AB)return this._loop(e,t);if(e instanceof ZE){const n=t.clone();return n.currentFunctionName=t.currentFunctionName,this._execStatements(e.body,n)}if(e instanceof uB)this._assign(e,t);else if(e instanceof cB)this._increment(e,t);else{if(e instanceof SB)return null;if(e instanceof nB){const n=e.name;null===t.getVariable(n)&&t.setVariable(n,new ZB(0,this.getTypeInfo("u32")))}else if(e instanceof dB)this._call(e,t);else{if(e instanceof yB)return null;if(e instanceof vB)return null}}}return null}evalExpression(e,t){return e instanceof QB?this._evalBinaryOp(e,t):e instanceof UB?this._evalLiteral(e,t):e instanceof MB?this._evalVariable(e,t):e instanceof FB?this._evalCall(e,t):e instanceof PB?this._evalCreate(e,t):e instanceof LB?this._evalConst(e,t):e instanceof OB?this._evalBitcast(e,t):e instanceof jB?this._evalUnaryOp(e,t):null}getTypeInfo(e){var t;if(e instanceof _B){const t=this.reflection.getTypeInfo(e);if(null!==t)return t}let n=null!==(t=this.typeInfo[e])&&void 0!==t?t:null;return null!==n||(n=this.reflection.getTypeInfoByName(e)),n}_setOverrides(e,t){for(const n in e){const r=e[n],o=this.reflection.getOverrideInfo(n);null!==o&&(null===o.type&&(o.type=this.getTypeInfo("u32")),"u32"===o.type.name||"i32"===o.type.name||"f32"===o.type.name||"f16"===o.type.name?t.setVariable(n,new ZB(r,o.type)):"bool"===o.type.name?t.setVariable(n,new ZB(r?1:0,o.type)):("vec2"===o.type.name||"vec3"===o.type.name||"vec4"===o.type.name||"vec2f"===o.type.name||"vec3f"===o.type.name||"vec4f"===o.type.name||"vec2i"===o.type.name||"vec3i"===o.type.name||"vec4i"===o.type.name||"vec2u"===o.type.name||"vec3u"===o.type.name||"vec4u"===o.type.name||"vec2h"===o.type.name||"vec3h"===o.type.name||"vec4h"===o.type.name)&&t.setVariable(n,new tI(r,o.type)))}}_dispatchWorkgroup(e,t,n){const r=[1,1,1];for(const c of e.node.attributes)if("workgroup_size"===c.name){if(c.value.length>0){const e=n.getVariableValue(c.value[0]);r[0]=e instanceof ZB?e.value:parseInt(c.value[0])}if(c.value.length>1){const e=n.getVariableValue(c.value[1]);r[1]=e instanceof ZB?e.value:parseInt(c.value[1])}if(c.value.length>2){const e=n.getVariableValue(c.value[2]);r[2]=e instanceof ZB?e.value:parseInt(c.value[2])}}const o=this.getTypeInfo("vec3u"),i=this.getTypeInfo("u32");n.setVariable("@workgroup_size",new tI(r,o));const s=r[0],a=r[1],l=r[2];for(let c=0,u=0;c<l;++c)for(let l=0;l<a;++l)for(let a=0;a<s;++a,++u){const s=[a,l,c],d=[a+t[0]*r[0],l+t[1]*r[1],c+t[2]*r[2]];n.setVariable("@local_invocation_id",new tI(s,o)),n.setVariable("@global_invocation_id",new tI(d,o)),n.setVariable("@local_invocation_index",new ZB(u,i)),this._dispatchExec(e,n)}}_dispatchExec(e,t){for(const n of e.node.args)for(const e of n.attributes)if("builtin"===e.name){const r=`@${e.value}`,o=t.getVariable(r);void 0!==o&&t.variables.set(n.name,o)}this._execStatements(e.node.body,t)}getVariableName(e,t){for(;e instanceof jB;)e=e.right;return e instanceof MB?e.name:null}_execStatements(e,t){for(const n of e){if(n instanceof Array){const e=t.clone(),r=this._execStatements(n,e);if(r)return r;continue}const e=this.execStatement(n,t);if(e)return e}return null}_call(e,t){const n=t.clone();n.currentFunctionName=e.name;const r=t.getFunction(e.name);if(r){for(let t=0;t<r.node.args.length;++t){const o=r.node.args[t],i=this.evalExpression(e.args[t],n);n.setVariable(o.name,i,o)}this._execStatements(r.node.body,n)}else e.isBuiltin?this._callBuiltinFunction(e,n):this.getTypeInfo(e.name)&&this._evalCreate(e,t)}_increment(e,t){const n=this.getVariableName(e.variable,t),r=t.getVariable(n);r&&("++"===e.operator?r.value instanceof ZB&&r.value.value++:"--"===e.operator&&r.value instanceof ZB&&r.value.value--)}_getVariableData(e,t){if(e instanceof MB){const n=this.getVariableName(e,t),r=t.getVariable(n);return null===r?null:r.value.getSubData(this,e.postfix,t)}if(e instanceof jB){if("*"===e.operator){const n=this._getVariableData(e.right,t);return n instanceof JB?n.reference.getSubData(this,e.postfix,t):null}if("&"===e.operator){const n=this._getVariableData(e.right,t);return new JB(n)}}return null}_assign(e,t){let n=null,r="<var>",o=null;if(e.variable instanceof jB){const n=this._getVariableData(e.variable,t),r=this.evalExpression(e.value,t),o=e.operator;if("="===o){if(n instanceof ZB||n instanceof tI||n instanceof nI){if(r instanceof ZB||r instanceof tI||r instanceof nI&&n.data.length===r.data.length)return void n.data.set(r.data)}else if(n instanceof rI&&r instanceof rI&&n.buffer.byteLength-n.offset>=r.buffer.byteLength-r.offset)return void(n.buffer.byteLength%4==0?new Uint32Array(n.buffer,n.offset,n.typeInfo.size/4).set(new Uint32Array(r.buffer,r.offset,r.typeInfo.size/4)):new Uint8Array(n.buffer,n.offset,n.typeInfo.size).set(new Uint8Array(r.buffer,r.offset,r.typeInfo.size)));return null}if("+="===o)return(n instanceof ZB||n instanceof tI||n instanceof nI)&&(r instanceof ZB||r instanceof tI||r instanceof nI)?void n.data.set(r.data.map((e,t)=>n.data[t]+e)):void 0;if("-="===o)return(n instanceof ZB||n instanceof tI||n instanceof nI)&&(r instanceof ZB||r instanceof tI||r instanceof nI)?void n.data.set(r.data.map((e,t)=>n.data[t]-e)):void 0}if(e.variable instanceof jB){if("*"===e.variable.operator){r=this.getVariableName(e.variable.right,t);const o=t.getVariable(r);if(!(o&&o.value instanceof JB))return;n=o.value.reference;let i=e.variable.postfix;if(!i){let t=e.variable.right;for(;t instanceof jB;){if(t.postfix){i=t.postfix;break}t=t.right}}i&&(n=n.getSubData(this,i,t))}}else{o=e.variable.postfix,r=this.getVariableName(e.variable,t);const i=t.getVariable(r);if(null===i)return;n=i.value}if(n instanceof JB&&(n=n.reference),null===n)return;const i=this.evalExpression(e.value,t),s=e.operator;if("="!==s){const e=n.getSubData(this,o,t);if(e instanceof tI&&i instanceof ZB){const t=e.data,n=i.value;if("+="===s)for(let e=0;e<t.length;++e)t[e]+=n;else if("-="===s)for(let e=0;e<t.length;++e)t[e]-=n;else if("*="===s)for(let e=0;e<t.length;++e)t[e]*=n;else if("/="===s)for(let e=0;e<t.length;++e)t[e]/=n;else if("%="===s)for(let e=0;e<t.length;++e)t[e]%=n;else if("&="===s)for(let e=0;e<t.length;++e)t[e]&=n;else if("|="===s)for(let e=0;e<t.length;++e)t[e]|=n;else if("^="===s)for(let e=0;e<t.length;++e)t[e]^=n;else if("<<="===s)for(let e=0;e<t.length;++e)t[e]<<=n;else if(">>="===s)for(let e=0;e<t.length;++e)t[e]>>=n}else if(e instanceof tI&&i instanceof tI){const t=e.data,n=i.data;if(t.length!==n.length)return;if("+="===s)for(let e=0;e<t.length;++e)t[e]+=n[e];else if("-="===s)for(let e=0;e<t.length;++e)t[e]-=n[e];else if("*="===s)for(let e=0;e<t.length;++e)t[e]*=n[e];else if("/="===s)for(let e=0;e<t.length;++e)t[e]/=n[e];else if("%="===s)for(let e=0;e<t.length;++e)t[e]%=n[e];else if("&="===s)for(let e=0;e<t.length;++e)t[e]&=n[e];else if("|="===s)for(let e=0;e<t.length;++e)t[e]|=n[e];else if("^="===s)for(let e=0;e<t.length;++e)t[e]^=n[e];else if("<<="===s)for(let e=0;e<t.length;++e)t[e]<<=n[e];else if(">>="===s)for(let e=0;e<t.length;++e)t[e]>>=n[e]}else{if(!(e instanceof ZB&&i instanceof ZB))return;"+="===s?e.value+=i.value:"-="===s?e.value-=i.value:"*="===s?e.value*=i.value:"/="===s?e.value/=i.value:"%="===s?e.value%=i.value:"&="===s?e.value&=i.value:"|="===s?e.value|=i.value:"^="===s?e.value^=i.value:"<<="===s?e.value<<=i.value:">>="===s&&(e.value>>=i.value)}return void(n instanceof rI&&n.setDataValue(this,e,o,t))}if(n instanceof rI)n.setDataValue(this,i,o,t);else if(o){if(!(n instanceof tI||n instanceof nI))return;if(o instanceof DB){const e=this.evalExpression(o.index,t).value;if(n instanceof tI){if(!(i instanceof ZB))return;n.data[e]=i.value}else{if(!(n instanceof nI))return;{const e=this.evalExpression(o.index,t).value;if(e<0)return;if(!(i instanceof tI))return;{const t=n.typeInfo.getTypeName();if("mat2x2"===t||"mat2x2f"===t||"mat2x2h"===t){if(!(e<2&&2===i.data.length))return;n.data[2*e]=i.data[0],n.data[2*e+1]=i.data[1]}else if("mat2x3"===t||"mat2x3f"===t||"mat2x3h"===t){if(!(e<2&&3===i.data.length))return;n.data[3*e]=i.data[0],n.data[3*e+1]=i.data[1],n.data[3*e+2]=i.data[2]}else if("mat2x4"===t||"mat2x4f"===t||"mat2x4h"===t){if(!(e<2&&4===i.data.length))return;n.data[4*e]=i.data[0],n.data[4*e+1]=i.data[1],n.data[4*e+2]=i.data[2],n.data[4*e+3]=i.data[3]}else if("mat3x2"===t||"mat3x2f"===t||"mat3x2h"===t){if(!(e<3&&2===i.data.length))return;n.data[2*e]=i.data[0],n.data[2*e+1]=i.data[1]}else if("mat3x3"===t||"mat3x3f"===t||"mat3x3h"===t){if(!(e<3&&3===i.data.length))return;n.data[3*e]=i.data[0],n.data[3*e+1]=i.data[1],n.data[3*e+2]=i.data[2]}else if("mat3x4"===t||"mat3x4f"===t||"mat3x4h"===t){if(!(e<3&&4===i.data.length))return;n.data[4*e]=i.data[0],n.data[4*e+1]=i.data[1],n.data[4*e+2]=i.data[2],n.data[4*e+3]=i.data[3]}else if("mat4x2"===t||"mat4x2f"===t||"mat4x2h"===t){if(!(e<4&&2===i.data.length))return;n.data[2*e]=i.data[0],n.data[2*e+1]=i.data[1]}else if("mat4x3"===t||"mat4x3f"===t||"mat4x3h"===t){if(!(e<4&&3===i.data.length))return;n.data[3*e]=i.data[0],n.data[3*e+1]=i.data[1],n.data[3*e+2]=i.data[2]}else{if("mat4x4"!==t&&"mat4x4f"!==t&&"mat4x4h"!==t)return;if(!(e<4&&4===i.data.length))return;n.data[4*e]=i.data[0],n.data[4*e+1]=i.data[1],n.data[4*e+2]=i.data[2],n.data[4*e+3]=i.data[3]}}}}}else if(o instanceof TB){const e=o.value;if(!(n instanceof tI))return;if(i instanceof ZB){if(e.length>1)return;if("x"===e)n.data[0]=i.value;else if("y"===e){if(n.data.length<2)return;n.data[1]=i.value}else if("z"===e){if(n.data.length<3)return;n.data[2]=i.value}else if("w"===e){if(n.data.length<4)return;n.data[3]=i.value}}else{if(!(i instanceof tI))return;if(e.length!==i.data.length)return;for(let t=0;t<e.length;++t){const r=e[t];if("x"===r||"r"===r)n.data[0]=i.data[t];else if("y"===r||"g"===r){if(i.data.length<2)return;n.data[1]=i.data[t]}else if("z"===r||"b"===r){if(i.data.length<3)return;n.data[2]=i.data[t]}else{if("w"!==r&&"a"!==r)return;if(i.data.length<4)return;n.data[3]=i.data[t]}}}}}else n instanceof ZB&&i instanceof ZB?n.value=i.value:(n instanceof tI&&i instanceof tI||n instanceof nI&&i instanceof nI)&&n.data.set(i.data)}_function(e,t){const n=new SI(e);t.functions.set(e.name,n)}_const(e,t){let n=null;null!==e.value&&(n=this.evalExpression(e.value,t)),t.createVariable(e.name,n,e)}_let(e,t){let n=null;if(null!==e.value){if(n=this.evalExpression(e.value,t),null===n)return;e.value instanceof jB||(n=n.clone())}else{const r=e.type.name;if("f32"===r||"i32"===r||"u32"===r||"bool"===r||"f16"===r||"vec2"===r||"vec3"===r||"vec4"===r||"vec2f"===r||"vec3f"===r||"vec4f"===r||"vec2i"===r||"vec3i"===r||"vec4i"===r||"vec2u"===r||"vec3u"===r||"vec4u"===r||"vec2h"===r||"vec3h"===r||"vec4h"===r||"vec2b"===r||"vec3b"===r||"vec4b"===r||"mat2x2"===r||"mat2x3"===r||"mat2x4"===r||"mat3x2"===r||"mat3x3"===r||"mat3x4"===r||"mat4x2"===r||"mat4x3"===r||"mat4x4"===r||"mat2x2f"===r||"mat2x3f"===r||"mat2x4f"===r||"mat3x2f"===r||"mat3x3f"===r||"mat3x4f"===r||"mat4x2f"===r||"mat4x3f"===r||"mat4x4f"===r||"mat2x2h"===r||"mat2x3h"===r||"mat2x4h"===r||"mat3x2h"===r||"mat3x3h"===r||"mat3x4h"===r||"mat4x2h"===r||"mat4x3h"===r||"mat4x4h"===r||"array"===r){const r=new PB(e.type,[]);n=this._evalCreate(r,t)}}t.createVariable(e.name,n,e)}_var(e,t){let n=null;if(null!==e.value){if(n=this.evalExpression(e.value,t),null===n)return;e.value instanceof jB||(n=n.clone())}else{if(null===e.type)return;const r=e.type.name;if("f32"===r||"i32"===r||"u32"===r||"bool"===r||"f16"===r||"vec2"===r||"vec3"===r||"vec4"===r||"vec2f"===r||"vec3f"===r||"vec4f"===r||"vec2i"===r||"vec3i"===r||"vec4i"===r||"vec2u"===r||"vec3u"===r||"vec4u"===r||"vec2h"===r||"vec3h"===r||"vec4h"===r||"vec2b"===r||"vec3b"===r||"vec4b"===r||"mat2x2"===r||"mat2x3"===r||"mat2x4"===r||"mat3x2"===r||"mat3x3"===r||"mat3x4"===r||"mat4x2"===r||"mat4x3"===r||"mat4x4"===r||"mat2x2f"===r||"mat2x3f"===r||"mat2x4f"===r||"mat3x2f"===r||"mat3x3f"===r||"mat3x4f"===r||"mat4x2f"===r||"mat4x3f"===r||"mat4x4f"===r||"mat2x2h"===r||"mat2x3h"===r||"mat2x4h"===r||"mat3x2h"===r||"mat3x3h"===r||"mat3x4h"===r||"mat4x2h"===r||"mat4x3h"===r||"mat4x4h"===r||e.type instanceof IB||e.type instanceof SB||e.type instanceof EB){const r=new PB(e.type,[]);n=this._evalCreate(r,t)}}t.createVariable(e.name,n,e)}_switch(e,t){t=t.clone();const n=this.evalExpression(e.condition,t);if(!(n instanceof ZB))return null;let r=null;for(const o of e.cases)if(o instanceof GB)for(const e of o.selectors){if(e instanceof HB){r=o;continue}const i=this.evalExpression(e,t);if(!(i instanceof ZB))return null;if(i.value===n.value)return this._execStatements(o.body,t)}else o instanceof VB&&(r=o);return r?this._execStatements(r.body,t):null}_if(e,t){t=t.clone();const n=this.evalExpression(e.condition,t);if(!(n instanceof ZB))return null;if(n.value)return this._execStatements(e.body,t);for(const r of e.elseif){const e=this.evalExpression(r.condition,t);if(!(e instanceof ZB))return null;if(e.value)return this._execStatements(r.body,t)}return e.else?this._execStatements(e.else,t):null}_getScalarValue(e){return e instanceof ZB?e.value:0}_for(e,t){for(t=t.clone(),this.execStatement(e.init,t);this._getScalarValue(this.evalExpression(e.condition,t));){const n=this._execStatements(e.body,t);if(n===TI._breakObj)break;if(null!==n&&n!==TI._continueObj)return n;this.execStatement(e.increment,t)}return null}_loop(e,t){for(t=t.clone();;){const n=this._execStatements(e.body,t);if(n===TI._breakObj)break;if(n===TI._continueObj){if(e.continuing&&this._execStatements(e.continuing.body,t)===TI._breakObj)break}else if(null!==n)return n}return null}_while(e,t){for(t=t.clone();this._getScalarValue(this.evalExpression(e.condition,t));){const n=this._execStatements(e.body,t);if(n===TI._breakObj)break;if(n!==TI._continueObj&&null!==n)return n}return null}_evalBitcast(e,t){const n=this.evalExpression(e.value,t),r=e.type;if(n instanceof ZB){const e=vI(n.value,n.typeInfo.name,r.name);return new ZB(e,this.getTypeInfo(r))}if(n instanceof tI){const e=n.typeInfo.getTypeName();let t="";if(e.endsWith("f"))t="f32";else if(e.endsWith("i"))t="i32";else if(e.endsWith("u"))t="u32";else if(e.endsWith("b"))t="bool";else{if(!e.endsWith("h"))return null;t="f16"}const o=r.getTypeName();let i="";if(o.endsWith("f"))i="f32";else if(o.endsWith("i"))i="i32";else if(o.endsWith("u"))i="u32";else if(o.endsWith("b"))i="bool";else{if(!o.endsWith("h"))return null;i="f16"}const s=function(e,t,n){if(t===n)return e;const r=new Array(e.length);for(let o=0;o<e.length;o++)r[o]=vI(e[o],t,n);return r}(Array.from(n.data),t,i);return new tI(s,this.getTypeInfo(r))}return null}_evalConst(e,t){return t.getVariableValue(e.name).clone().getSubData(this,e.postfix,t)}_evalCreate(e,t){var n;if(e instanceof PB){if(null===e.type)return qB.void;switch(e.type.getTypeName()){case"bool":case"i32":case"u32":case"f32":case"f16":return this._callConstructorValue(e,t);case"vec2":case"vec3":case"vec4":case"vec2f":case"vec3f":case"vec4f":case"vec2h":case"vec3h":case"vec4h":case"vec2i":case"vec3i":case"vec4i":case"vec2u":case"vec3u":case"vec4u":case"vec2b":case"vec3b":case"vec4b":return this._callConstructorVec(e,t);case"mat2x2":case"mat2x2f":case"mat2x2h":case"mat2x3":case"mat2x3f":case"mat2x3h":case"mat2x4":case"mat2x4f":case"mat2x4h":case"mat3x2":case"mat3x2f":case"mat3x2h":case"mat3x3":case"mat3x3f":case"mat3x3h":case"mat3x4":case"mat3x4f":case"mat3x4h":case"mat4x2":case"mat4x2f":case"mat4x2h":case"mat4x3":case"mat4x3f":case"mat4x3h":case"mat4x4":case"mat4x4f":case"mat4x4h":return this._callConstructorMatrix(e,t)}}e instanceof PB?e.type.name:e.name;const r=e instanceof PB?this.getTypeInfo(e.type):this.getTypeInfo(e.name);if(null===r)return null;if(0===r.size)return null;const o=new rI(new ArrayBuffer(r.size),r,0);if(r instanceof bE){if(e.args)for(let i=0;i<e.args.length;++i){const n=r.members[i],s=e.args[i],a=this.evalExpression(s,t);o.setData(this,a,n.type,n.offset,t)}}else if(r instanceof wE){let i=0;if(e.args)for(let s=0;s<e.args.length;++s){const a=e.args[s],l=this.evalExpression(a,t);null===r.format&&("x32"===(null===(n=l.typeInfo)||void 0===n?void 0:n.name)?r.format=this.getTypeInfo("i32"):r.format=l.typeInfo),o.setData(this,l,r.format,i,t),i+=r.stride}}return e instanceof PB?o.getSubData(this,e.postfix,t):o}_evalLiteral(e,t){const n=this.getTypeInfo(e.type),r=n.name;return"x32"===r||"u32"===r||"f32"===r||"f16"===r||"i32"===r||"bool"===r?new ZB(e.scalarValue,n):"vec2"===r||"vec3"===r||"vec4"===r||"vec2f"===r||"vec3f"===r||"vec4f"===r||"vec2h"===r||"vec3h"===r||"vec4h"===r||"vec2i"===r||"vec3i"===r||"vec4i"===r||"vec2u"===r||"vec3u"===r||"vec4u"===r?this._callConstructorVec(e,t):"mat2x2"===r||"mat2x3"===r||"mat2x4"===r||"mat3x2"===r||"mat3x3"===r||"mat3x4"===r||"mat4x2"===r||"mat4x3"===r||"mat4x4"===r||"mat2x2f"===r||"mat2x3f"===r||"mat2x4f"===r||"mat3x2f"===r||"mat3x3f"===r||"mat3x4f"===r||"mat4x2f"===r||"mat4x3f"===r||"mat4x4f"===r||"mat2x2h"===r||"mat2x3h"===r||"mat2x4h"===r||"mat3x2h"===r||"mat3x3h"===r||"mat3x4h"===r||"mat4x2h"===r||"mat4x3h"===r||"mat4x4h"===r?this._callConstructorMatrix(e,t):e.value}_evalVariable(e,t){const n=t.getVariableValue(e.name);return null===n?n:n.getSubData(this,e.postfix,t)}_maxFormatTypeInfo(e){let t=e[0];if("f32"===t.name)return t;for(let n=1;n<e.length;++n){const r=TI._priority.get(t.name);TI._priority.get(e[n].name)<r&&(t=e[n])}return"x32"===t.name?this.getTypeInfo("i32"):t}_evalUnaryOp(e,t){const n=this.evalExpression(e.right,t);if("&"===e.operator)return new JB(n);if("*"===e.operator)return n instanceof JB?n.reference.getSubData(this,e.postfix,t):null;const r=n instanceof ZB?n.value:n instanceof tI?Array.from(n.data):null;switch(e.operator){case"+":{if(cI(r)){const e=r.map((e,t)=>+e);return new tI(e,n.typeInfo)}const e=r,t=this._maxFormatTypeInfo([n.typeInfo,n.typeInfo]);return new ZB(+e,t)}case"-":{if(cI(r)){const e=r.map((e,t)=>-e);return new tI(e,n.typeInfo)}const e=r,t=this._maxFormatTypeInfo([n.typeInfo,n.typeInfo]);return new ZB(-e,t)}case"!":{if(cI(r)){const e=r.map((e,t)=>e?0:1);return new tI(e,n.typeInfo)}const e=r,t=this._maxFormatTypeInfo([n.typeInfo,n.typeInfo]);return new ZB(e?0:1,t)}case"~":{if(cI(r)){const e=r.map((e,t)=>~e);return new tI(e,n.typeInfo)}const e=r,t=this._maxFormatTypeInfo([n.typeInfo,n.typeInfo]);return new ZB(~e,t)}}return null}_evalBinaryOp(e,t){const n=this.evalExpression(e.left,t),r=this.evalExpression(e.right,t),o=n instanceof ZB?n.value:n instanceof tI||n instanceof nI?Array.from(n.data):null,i=r instanceof ZB?r.value:r instanceof tI||r instanceof nI?Array.from(r.data):null;switch(e.operator){case"+":{if(cI(o)&&cI(i)){const e=o,t=i;if(e.length!==t.length)return null;const r=e.map((e,n)=>e+t[n]);return new tI(r,n.typeInfo)}if(cI(o)){const e=i,t=o.map((t,n)=>t+e);return new tI(t,n.typeInfo)}if(cI(i)){const e=o,t=i.map((t,n)=>e+t);return new tI(t,r.typeInfo)}const e=o,t=i,s=this._maxFormatTypeInfo([n.typeInfo,r.typeInfo]);return new ZB(e+t,s)}case"-":{if(cI(o)&&cI(i)){const e=o,t=i;if(e.length!==t.length)return null;const r=e.map((e,n)=>e-t[n]);return new tI(r,n.typeInfo)}if(cI(o)){const e=i,t=o.map((t,n)=>t-e);return new tI(t,n.typeInfo)}if(cI(i)){const e=o,t=i.map((t,n)=>e-t);return new tI(t,r.typeInfo)}const e=o,t=i,s=this._maxFormatTypeInfo([n.typeInfo,r.typeInfo]);return new ZB(e-t,s)}case"*":{if(cI(o)&&cI(i)){const e=o,t=i;if(n instanceof nI&&r instanceof nI){const o=function(e,t,n,r){if(void 0===kI[t.name]||void 0===kI[r.name])return null;const o=kI[t.name][0],i=kI[t.name][1],s=kI[r.name][0];if(o!==kI[r.name][1])return null;const a=new Array(s*i);for(let l=0;l<i;l++)for(let t=0;t<s;t++){let r=0;for(let s=0;s<o;s++)r+=e[s*i+l]*n[t*o+s];a[l*s+t]=r}return a}(e,n.typeInfo,t,r.typeInfo);if(null===o)return null;const i=kI[r.typeInfo.name][0],s=kI[n.typeInfo.name][1],a=this.getTypeInfo(`mat${i}x${s}f`);return new nI(o,a)}if(n instanceof nI&&r instanceof tI){const o=function(e,t,n,r){if(void 0===kI[t.name]||void 0===RI[r.name])return null;const o=kI[t.name][0],i=kI[t.name][1];if(o!==n.length)return null;const s=new Array(i);for(let a=0;a<i;a++){let t=0;for(let r=0;r<o;r++)t+=e[r*i+a]*n[r];s[a]=t}return s}(e,n.typeInfo,t,r.typeInfo);return null===o?null:new tI(o,r.typeInfo)}if(n instanceof tI&&r instanceof nI){const o=function(e,t,n,r){if(void 0===RI[t.name]||void 0===kI[r.name])return null;const o=kI[r.name][0],i=kI[r.name][1];if(i!==e.length)return null;const s=[];for(let a=0;a<o;a++){let t=0;for(let r=0;r<i;r++)t+=e[r]*n[r*o+a];s[a]=t}return s}(e,n.typeInfo,t,r.typeInfo);return null===o?null:new tI(o,n.typeInfo)}{if(e.length!==t.length)return null;const r=e.map((e,n)=>e*t[n]);return new tI(r,n.typeInfo)}}if(cI(o)){const e=i,t=o.map((t,n)=>t*e);return n instanceof nI?new nI(t,n.typeInfo):new tI(t,n.typeInfo)}if(cI(i)){const e=o,t=i.map((t,n)=>e*t);return r instanceof nI?new nI(t,r.typeInfo):new tI(t,r.typeInfo)}const e=o,t=i,s=this._maxFormatTypeInfo([n.typeInfo,r.typeInfo]);return new ZB(e*t,s)}case"%":{if(cI(o)&&cI(i)){const e=o,t=i;if(e.length!==t.length)return null;const r=e.map((e,n)=>e%t[n]);return new tI(r,n.typeInfo)}if(cI(o)){const e=i,t=o.map((t,n)=>t%e);return new tI(t,n.typeInfo)}if(cI(i)){const e=o,t=i.map((t,n)=>e%t);return new tI(t,r.typeInfo)}const e=o,t=i,s=this._maxFormatTypeInfo([n.typeInfo,r.typeInfo]);return new ZB(e%t,s)}case"/":{if(cI(o)&&cI(i)){const e=o,t=i;if(e.length!==t.length)return null;const r=e.map((e,n)=>e/t[n]);return new tI(r,n.typeInfo)}if(cI(o)){const e=i,t=o.map((t,n)=>t/e);return new tI(t,n.typeInfo)}if(cI(i)){const e=o,t=i.map((t,n)=>e/t);return new tI(t,r.typeInfo)}const e=o,t=i,s=this._maxFormatTypeInfo([n.typeInfo,r.typeInfo]);return new ZB(e/t,s)}case"&":{if(cI(o)&&cI(i)){const e=o,t=i;if(e.length!==t.length)return null;const r=e.map((e,n)=>e&t[n]);return new tI(r,n.typeInfo)}if(cI(o)){const e=i,t=o.map((t,n)=>t&e);return new tI(t,n.typeInfo)}if(cI(i)){const e=o,t=i.map((t,n)=>e&t);return new tI(t,r.typeInfo)}const e=o,t=i,s=this._maxFormatTypeInfo([n.typeInfo,r.typeInfo]);return new ZB(e&t,s)}case"|":{if(cI(o)&&cI(i)){const e=o,t=i;if(e.length!==t.length)return null;const r=e.map((e,n)=>e|t[n]);return new tI(r,n.typeInfo)}if(cI(o)){const e=i,t=o.map((t,n)=>t|e);return new tI(t,n.typeInfo)}if(cI(i)){const e=o,t=i.map((t,n)=>e|t);return new tI(t,r.typeInfo)}const e=o,t=i,s=this._maxFormatTypeInfo([n.typeInfo,r.typeInfo]);return new ZB(e|t,s)}case"^":{if(cI(o)&&cI(i)){const e=o,t=i;if(e.length!==t.length)return null;const r=e.map((e,n)=>e^t[n]);return new tI(r,n.typeInfo)}if(cI(o)){const e=i,t=o.map((t,n)=>t^e);return new tI(t,n.typeInfo)}if(cI(i)){const e=o,t=i.map((t,n)=>e^t);return new tI(t,r.typeInfo)}const e=o,t=i,s=this._maxFormatTypeInfo([n.typeInfo,r.typeInfo]);return new ZB(e^t,s)}case"<<":{if(cI(o)&&cI(i)){const e=o,t=i;if(e.length!==t.length)return null;const r=e.map((e,n)=>e<<t[n]);return new tI(r,n.typeInfo)}if(cI(o)){const e=i,t=o.map((t,n)=>t<<e);return new tI(t,n.typeInfo)}if(cI(i)){const e=o,t=i.map((t,n)=>e<<t);return new tI(t,r.typeInfo)}const e=o,t=i,s=this._maxFormatTypeInfo([n.typeInfo,r.typeInfo]);return new ZB(e<<t,s)}case">>":{if(cI(o)&&cI(i)){const e=o,t=i;if(e.length!==t.length)return null;const r=e.map((e,n)=>e>>t[n]);return new tI(r,n.typeInfo)}if(cI(o)){const e=i,t=o.map((t,n)=>t>>e);return new tI(t,n.typeInfo)}if(cI(i)){const e=o,t=i.map((t,n)=>e>>t);return new tI(t,r.typeInfo)}const e=o,t=i,s=this._maxFormatTypeInfo([n.typeInfo,r.typeInfo]);return new ZB(e>>t,s)}case">":if(cI(o)&&cI(i)){const e=o,t=i;if(e.length!==t.length)return null;const r=e.map((e,n)=>e>t[n]?1:0);return new tI(r,n.typeInfo)}if(cI(o)){const e=i,t=o.map((t,n)=>t>e?1:0);return new tI(t,n.typeInfo)}if(cI(i)){const e=o,t=i.map((t,n)=>e>t?1:0);return new tI(t,r.typeInfo)}return new ZB(o>i?1:0,this.getTypeInfo("bool"));case"<":if(cI(o)&&cI(i)){const e=o,t=i;if(e.length!==t.length)return null;const r=e.map((e,n)=>e<t[n]?1:0);return new tI(r,n.typeInfo)}if(cI(o)){const e=i,t=o.map((t,n)=>t<e?1:0);return new tI(t,n.typeInfo)}if(cI(i)){const e=o,t=i.map((t,n)=>e<t?1:0);return new tI(t,r.typeInfo)}return new ZB(o<i?1:0,this.getTypeInfo("bool"));case"==":if(cI(o)&&cI(i)){const e=o,t=i;if(e.length!==t.length)return null;const r=e.map((e,n)=>e===t[n]?1:0);return new tI(r,n.typeInfo)}if(cI(o)){const e=i,t=o.map((t,n)=>t==e?1:0);return new tI(t,n.typeInfo)}if(cI(i)){const e=o,t=i.map((t,n)=>e==t?1:0);return new tI(t,r.typeInfo)}return new ZB(o===i?1:0,this.getTypeInfo("bool"));case"!=":if(cI(o)&&cI(i)){const e=o,t=i;if(e.length!==t.length)return null;const r=e.map((e,n)=>e!==t[n]?1:0);return new tI(r,n.typeInfo)}if(cI(o)){const e=i,t=o.map((t,n)=>t!==e?1:0);return new tI(t,n.typeInfo)}if(cI(i)){const e=o,t=i.map((t,n)=>e!==t?1:0);return new tI(t,r.typeInfo)}return new ZB(o!==i?1:0,this.getTypeInfo("bool"));case">=":if(cI(o)&&cI(i)){const e=o,t=i;if(e.length!==t.length)return null;const r=e.map((e,n)=>e>=t[n]?1:0);return new tI(r,n.typeInfo)}if(cI(o)){const e=i,t=o.map((t,n)=>t>=e?1:0);return new tI(t,n.typeInfo)}if(cI(i)){const e=o,t=i.map((t,n)=>e>=t?1:0);return new tI(t,r.typeInfo)}return new ZB(o>=i?1:0,this.getTypeInfo("bool"));case"<=":if(cI(o)&&cI(i)){const e=o,t=i;if(e.length!==t.length)return null;const r=e.map((e,n)=>e<=t[n]?1:0);return new tI(r,n.typeInfo)}if(cI(o)){const e=i,t=o.map((t,n)=>t<=e?1:0);return new tI(t,n.typeInfo)}if(cI(i)){const e=o,t=i.map((t,n)=>e<=t?1:0);return new tI(t,r.typeInfo)}return new ZB(o<=i?1:0,this.getTypeInfo("bool"));case"&&":if(cI(o)&&cI(i)){const e=o,t=i;if(e.length!==t.length)return null;const r=e.map((e,n)=>e&&t[n]?1:0);return new tI(r,n.typeInfo)}if(cI(o)){const e=i,t=o.map((t,n)=>t&&e?1:0);return new tI(t,n.typeInfo)}if(cI(i)){const e=o,t=i.map((t,n)=>e&&t?1:0);return new tI(t,r.typeInfo)}return new ZB(o&&i?1:0,this.getTypeInfo("bool"));case"||":if(cI(o)&&cI(i)){const e=o,t=i;if(e.length!==t.length)return null;const r=e.map((e,n)=>e||t[n]?1:0);return new tI(r,n.typeInfo)}if(cI(o)){const e=i,t=o.map((t,n)=>t||e?1:0);return new tI(t,n.typeInfo)}if(cI(i)){const e=o,t=i.map((t,n)=>e||t?1:0);return new tI(t,r.typeInfo)}return new ZB(o||i?1:0,this.getTypeInfo("bool"))}return null}_evalCall(e,t){if(null!==e.cachedReturnValue)return e.cachedReturnValue;const n=t.clone();n.currentFunctionName=e.name;const r=t.getFunction(e.name);if(!r)return e.isBuiltin?this._callBuiltinFunction(e,n):this.getTypeInfo(e.name)?this._evalCreate(e,t):null;for(let o=0;o<r.node.args.length;++o){const t=r.node.args[o],i=this.evalExpression(e.args[o],n);n.createVariable(t.name,i,t)}return this._execStatements(r.node.body,n)}_callBuiltinFunction(e,t){switch(e.name){case"all":return this.builtins.All(e,t);case"any":return this.builtins.Any(e,t);case"select":return this.builtins.Select(e,t);case"arrayLength":return this.builtins.ArrayLength(e,t);case"abs":return this.builtins.Abs(e,t);case"acos":return this.builtins.Acos(e,t);case"acosh":return this.builtins.Acosh(e,t);case"asin":return this.builtins.Asin(e,t);case"asinh":return this.builtins.Asinh(e,t);case"atan":return this.builtins.Atan(e,t);case"atanh":return this.builtins.Atanh(e,t);case"atan2":return this.builtins.Atan2(e,t);case"ceil":return this.builtins.Ceil(e,t);case"clamp":return this.builtins.Clamp(e,t);case"cos":return this.builtins.Cos(e,t);case"cosh":return this.builtins.Cosh(e,t);case"countLeadingZeros":return this.builtins.CountLeadingZeros(e,t);case"countOneBits":return this.builtins.CountOneBits(e,t);case"countTrailingZeros":return this.builtins.CountTrailingZeros(e,t);case"cross":return this.builtins.Cross(e,t);case"degrees":return this.builtins.Degrees(e,t);case"determinant":return this.builtins.Determinant(e,t);case"distance":return this.builtins.Distance(e,t);case"dot":return this.builtins.Dot(e,t);case"dot4U8Packed":return this.builtins.Dot4U8Packed(e,t);case"dot4I8Packed":return this.builtins.Dot4I8Packed(e,t);case"exp":return this.builtins.Exp(e,t);case"exp2":return this.builtins.Exp2(e,t);case"extractBits":return this.builtins.ExtractBits(e,t);case"faceForward":return this.builtins.FaceForward(e,t);case"firstLeadingBit":return this.builtins.FirstLeadingBit(e,t);case"firstTrailingBit":return this.builtins.FirstTrailingBit(e,t);case"floor":return this.builtins.Floor(e,t);case"fma":return this.builtins.Fma(e,t);case"fract":return this.builtins.Fract(e,t);case"frexp":return this.builtins.Frexp(e,t);case"insertBits":return this.builtins.InsertBits(e,t);case"inverseSqrt":return this.builtins.InverseSqrt(e,t);case"ldexp":return this.builtins.Ldexp(e,t);case"length":return this.builtins.Length(e,t);case"log":return this.builtins.Log(e,t);case"log2":return this.builtins.Log2(e,t);case"max":return this.builtins.Max(e,t);case"min":return this.builtins.Min(e,t);case"mix":return this.builtins.Mix(e,t);case"modf":return this.builtins.Modf(e,t);case"normalize":return this.builtins.Normalize(e,t);case"pow":return this.builtins.Pow(e,t);case"quantizeToF16":return this.builtins.QuantizeToF16(e,t);case"radians":return this.builtins.Radians(e,t);case"reflect":return this.builtins.Reflect(e,t);case"refract":return this.builtins.Refract(e,t);case"reverseBits":return this.builtins.ReverseBits(e,t);case"round":return this.builtins.Round(e,t);case"saturate":return this.builtins.Saturate(e,t);case"sign":return this.builtins.Sign(e,t);case"sin":return this.builtins.Sin(e,t);case"sinh":return this.builtins.Sinh(e,t);case"smoothstep":return this.builtins.SmoothStep(e,t);case"sqrt":return this.builtins.Sqrt(e,t);case"step":return this.builtins.Step(e,t);case"tan":return this.builtins.Tan(e,t);case"tanh":return this.builtins.Tanh(e,t);case"transpose":return this.builtins.Transpose(e,t);case"trunc":return this.builtins.Trunc(e,t);case"dpdx":return this.builtins.Dpdx(e,t);case"dpdxCoarse":return this.builtins.DpdxCoarse(e,t);case"dpdxFine":return this.builtins.DpdxFine(e,t);case"dpdy":return this.builtins.Dpdy(e,t);case"dpdyCoarse":return this.builtins.DpdyCoarse(e,t);case"dpdyFine":return this.builtins.DpdyFine(e,t);case"fwidth":return this.builtins.Fwidth(e,t);case"fwidthCoarse":return this.builtins.FwidthCoarse(e,t);case"fwidthFine":return this.builtins.FwidthFine(e,t);case"textureDimensions":return this.builtins.TextureDimensions(e,t);case"textureGather":return this.builtins.TextureGather(e,t);case"textureGatherCompare":return this.builtins.TextureGatherCompare(e,t);case"textureLoad":return this.builtins.TextureLoad(e,t);case"textureNumLayers":return this.builtins.TextureNumLayers(e,t);case"textureNumLevels":return this.builtins.TextureNumLevels(e,t);case"textureNumSamples":return this.builtins.TextureNumSamples(e,t);case"textureSample":return this.builtins.TextureSample(e,t);case"textureSampleBias":return this.builtins.TextureSampleBias(e,t);case"textureSampleCompare":return this.builtins.TextureSampleCompare(e,t);case"textureSampleCompareLevel":return this.builtins.TextureSampleCompareLevel(e,t);case"textureSampleGrad":return this.builtins.TextureSampleGrad(e,t);case"textureSampleLevel":return this.builtins.TextureSampleLevel(e,t);case"textureSampleBaseClampToEdge":return this.builtins.TextureSampleBaseClampToEdge(e,t);case"textureStore":return this.builtins.TextureStore(e,t);case"atomicLoad":return this.builtins.AtomicLoad(e,t);case"atomicStore":return this.builtins.AtomicStore(e,t);case"atomicAdd":return this.builtins.AtomicAdd(e,t);case"atomicSub":return this.builtins.AtomicSub(e,t);case"atomicMax":return this.builtins.AtomicMax(e,t);case"atomicMin":return this.builtins.AtomicMin(e,t);case"atomicAnd":return this.builtins.AtomicAnd(e,t);case"atomicOr":return this.builtins.AtomicOr(e,t);case"atomicXor":return this.builtins.AtomicXor(e,t);case"atomicExchange":return this.builtins.AtomicExchange(e,t);case"atomicCompareExchangeWeak":return this.builtins.AtomicCompareExchangeWeak(e,t);case"pack4x8snorm":return this.builtins.Pack4x8snorm(e,t);case"pack4x8unorm":return this.builtins.Pack4x8unorm(e,t);case"pack4xI8":return this.builtins.Pack4xI8(e,t);case"pack4xU8":return this.builtins.Pack4xU8(e,t);case"pack4x8Clamp":return this.builtins.Pack4x8Clamp(e,t);case"pack4xU8Clamp":return this.builtins.Pack4xU8Clamp(e,t);case"pack2x16snorm":return this.builtins.Pack2x16snorm(e,t);case"pack2x16unorm":return this.builtins.Pack2x16unorm(e,t);case"pack2x16float":return this.builtins.Pack2x16float(e,t);case"unpack4x8snorm":return this.builtins.Unpack4x8snorm(e,t);case"unpack4x8unorm":return this.builtins.Unpack4x8unorm(e,t);case"unpack4xI8":return this.builtins.Unpack4xI8(e,t);case"unpack4xU8":return this.builtins.Unpack4xU8(e,t);case"unpack2x16snorm":return this.builtins.Unpack2x16snorm(e,t);case"unpack2x16unorm":return this.builtins.Unpack2x16unorm(e,t);case"unpack2x16float":return this.builtins.Unpack2x16float(e,t);case"storageBarrier":return this.builtins.StorageBarrier(e,t);case"textureBarrier":return this.builtins.TextureBarrier(e,t);case"workgroupBarrier":return this.builtins.WorkgroupBarrier(e,t);case"workgroupUniformLoad":return this.builtins.WorkgroupUniformLoad(e,t);case"subgroupAdd":return this.builtins.SubgroupAdd(e,t);case"subgroupExclusiveAdd":return this.builtins.SubgroupExclusiveAdd(e,t);case"subgroupInclusiveAdd":return this.builtins.SubgroupInclusiveAdd(e,t);case"subgroupAll":return this.builtins.SubgroupAll(e,t);case"subgroupAnd":return this.builtins.SubgroupAnd(e,t);case"subgroupAny":return this.builtins.SubgroupAny(e,t);case"subgroupBallot":return this.builtins.SubgroupBallot(e,t);case"subgroupBroadcast":return this.builtins.SubgroupBroadcast(e,t);case"subgroupBroadcastFirst":return this.builtins.SubgroupBroadcastFirst(e,t);case"subgroupElect":return this.builtins.SubgroupElect(e,t);case"subgroupMax":return this.builtins.SubgroupMax(e,t);case"subgroupMin":return this.builtins.SubgroupMin(e,t);case"subgroupMul":return this.builtins.SubgroupMul(e,t);case"subgroupExclusiveMul":return this.builtins.SubgroupExclusiveMul(e,t);case"subgroupInclusiveMul":return this.builtins.SubgroupInclusiveMul(e,t);case"subgroupOr":return this.builtins.SubgroupOr(e,t);case"subgroupShuffle":return this.builtins.SubgroupShuffle(e,t);case"subgroupShuffleDown":return this.builtins.SubgroupShuffleDown(e,t);case"subgroupShuffleUp":return this.builtins.SubgroupShuffleUp(e,t);case"subgroupShuffleXor":return this.builtins.SubgroupShuffleXor(e,t);case"subgroupXor":return this.builtins.SubgroupXor(e,t);case"quadBroadcast":return this.builtins.QuadBroadcast(e,t);case"quadSwapDiagonal":return this.builtins.QuadSwapDiagonal(e,t);case"quadSwapX":return this.builtins.QuadSwapX(e,t);case"quadSwapY":return this.builtins.QuadSwapY(e,t)}const n=t.getFunction(e.name);if(n){const r=t.clone();for(let t=0;t<n.node.args.length;++t){const o=n.node.args[t],i=this.evalExpression(e.args[t],r);r.setVariable(o.name,i,o)}return this._execStatements(n.node.body,r)}return null}_callConstructorValue(e,t){if(!e.args||0===e.args.length)return new ZB(0,this.getTypeInfo(e.type));const n=this.evalExpression(e.args[0],t);return n.typeInfo=this.getTypeInfo(e.type),n.getSubData(this,e.postfix,t).clone()}_callConstructorVec(e,t){const n=this.getTypeInfo(e.type),r=e.type.getTypeName(),o=RI[r];if(void 0===o)return null;const i=[];if(e instanceof UB)if(e.isVector){const t=e.vectorValue;for(const e of t)i.push(e)}else i.push(e.scalarValue);else if(e.args)for(const s of e.args){const e=this.evalExpression(s,t);if(e instanceof tI){const t=e.data;for(let e=0;e<t.length;++e){let n=t[e];i.push(n)}}else if(e instanceof ZB){let t=e.value;i.push(t)}}if(e.type instanceof EB&&null===e.type.format&&(e.type.format=EB.f32),0===i.length){const r=new Array(o).fill(0);return new tI(r,n).getSubData(this,e.postfix,t)}if(1===i.length)for(;i.length<o;)i.push(i[0]);return i.length<o?null:new tI(i.length>o?i.slice(0,o):i,n).getSubData(this,e.postfix,t)}_callConstructorMatrix(e,t){const n=this.getTypeInfo(e.type),r=e.type.getTypeName(),o=kI[r];if(void 0===o)return null;const i=[];if(e instanceof UB)if(e.isVector){const t=e.vectorValue;for(const e of t)i.push(e)}else i.push(e.scalarValue);else if(e.args)for(const s of e.args){const e=this.evalExpression(s,t);e instanceof tI?i.push(...e.data):e instanceof ZB?i.push(e.value):e instanceof nI&&i.push(...e.data)}if(n instanceof _E&&null===n.format&&(n.format=this.getTypeInfo("f32")),0===i.length){const r=new Array(o[2]).fill(0);return new nI(r,n).getSubData(this,e.postfix,t)}return i.length!==o[2]?null:new nI(i,n).getSubData(this,e.postfix,t)}}TI._breakObj=new YB(new yE("BREAK",null),null),TI._continueObj=new YB(new yE("CONTINUE",null),null),TI._priority=new Map([["f32",0],["f16",1],["u32",2],["i32",3],["x32",3]]);class PI{constructor(){this.constants=new Map,this.aliases=new Map,this.structs=new Map}}let FI=class{constructor(){this._tokens=[],this._current=0,this._currentLine=1,this._deferArrayCountEval=[],this._currentLoop=[],this._context=new PI,this._exec=new TI,this._forwardTypeCount=0}parse(e){this._initialize(e),this._deferArrayCountEval.length=0;const t=[];for(;!this._isAtEnd();){const e=this._global_decl_or_directive();if(!e)break;t.push(e)}if(this._deferArrayCountEval.length>0){for(const e of this._deferArrayCountEval){const t=e.arrayType,r=e.countNode;if(r instanceof MB){const e=r.name,o=this._context.constants.get(e);if(o)try{const e=o.constEvaluate(this._exec);t.count=e}catch(n){}}}this._deferArrayCountEval.length=0}if(this._forwardTypeCount>0)for(const r of t)r.search(e=>{e instanceof KB||e instanceof BB?e.type=this._forwardType(e.type):e instanceof IB?e.format=this._forwardType(e.format):e instanceof tB||e instanceof rB||e instanceof oB?e.type=this._forwardType(e.type):e instanceof YE?e.returnType=this._forwardType(e.returnType):e instanceof WB&&(e.type=this._forwardType(e.type))});return t}_forwardType(e){if(e instanceof CB){const t=this._getType(e.name);if(t)return t}else e instanceof BB?e.type=this._forwardType(e.type):e instanceof IB&&(e.format=this._forwardType(e.format));return e}_initialize(e){if(e)if("string"==typeof e){const t=new lI(e);this._tokens=t.scanTokens()}else this._tokens=e;else this._tokens=[];this._current=0}_updateNode(e,t){return e.line=null!=t?t:this._currentLine,e}_error(e,t){return{token:e,message:t,toString:()=>`${t}`}}_isAtEnd(){return this._current>=this._tokens.length||this._peek().type==sI.eof}_match(e){if(e instanceof iI)return!!this._check(e)&&(this._advance(),!0);for(let t=0,n=e.length;t<n;++t){const n=e[t];if(this._check(n))return this._advance(),!0}return!1}_consume(e,t){if(this._check(e))return this._advance();throw this._error(this._peek(),`${t}. Line:${this._currentLine}`)}_check(e){if(this._isAtEnd())return!1;const t=this._peek();if(e instanceof Array){const n=t.type;let r=!1;for(const t of e){if(n===t)return!0;t===sI.tokens.name&&(r=!0)}if(r){const e=sI.tokens.name.rule.exec(t.lexeme);if(e&&0==e.index&&e[0]==t.lexeme)return!0}return!1}if(t.type===e)return!0;if(e===sI.tokens.name){const e=sI.tokens.name.rule.exec(t.lexeme);return e&&0==e.index&&e[0]==t.lexeme}return!1}_advance(){var e,t;return this._currentLine=null!==(t=null===(e=this._peek())||void 0===e?void 0:e.line)&&void 0!==t?t:-1,this._isAtEnd()||this._current++,this._previous()}_peek(){return this._tokens[this._current]}_previous(){return this._tokens[this._current-1]}_global_decl_or_directive(){for(;this._match(sI.tokens.semicolon)&&!this._isAtEnd(););if(this._match(sI.keywords.alias)){const e=this._type_alias();return this._consume(sI.tokens.semicolon,"Expected ';'"),this._exec.reflection.updateAST([e]),e}if(this._match(sI.keywords.diagnostic)){const e=this._diagnostic();return this._consume(sI.tokens.semicolon,"Expected ';'"),this._exec.reflection.updateAST([e]),e}if(this._match(sI.keywords.requires)){const e=this._requires_directive();return this._consume(sI.tokens.semicolon,"Expected ';'"),this._exec.reflection.updateAST([e]),e}if(this._match(sI.keywords.enable)){const e=this._enable_directive();return this._consume(sI.tokens.semicolon,"Expected ';'"),this._exec.reflection.updateAST([e]),e}const e=this._attribute();if(this._check(sI.keywords.var)){const t=this._global_variable_decl();return null!=t&&(t.attributes=e),this._consume(sI.tokens.semicolon,"Expected ';'."),this._exec.reflection.updateAST([t]),t}if(this._check(sI.keywords.override)){const t=this._override_variable_decl();return null!=t&&(t.attributes=e),this._consume(sI.tokens.semicolon,"Expected ';'."),this._exec.reflection.updateAST([t]),t}if(this._check(sI.keywords.let)){const t=this._global_let_decl();return null!=t&&(t.attributes=e),this._consume(sI.tokens.semicolon,"Expected ';'."),this._exec.reflection.updateAST([t]),t}if(this._check(sI.keywords.const)){const t=this._global_const_decl();return null!=t&&(t.attributes=e),this._consume(sI.tokens.semicolon,"Expected ';'."),this._exec.reflection.updateAST([t]),t}if(this._check(sI.keywords.struct)){const t=this._struct_decl();return null!=t&&(t.attributes=e),this._exec.reflection.updateAST([t]),t}if(this._check(sI.keywords.fn)){const t=this._function_decl();return null!=t&&(t.attributes=e),this._exec.reflection.updateAST([t]),t}return null}_function_decl(){if(!this._match(sI.keywords.fn))return null;const e=this._currentLine,t=this._consume(sI.tokens.ident,"Expected function name.").toString();this._consume(sI.tokens.paren_left,"Expected '(' for function arguments.");const n=[];if(!this._check(sI.tokens.paren_right))do{if(this._check(sI.tokens.paren_right))break;const e=this._attribute(),t=this._consume(sI.tokens.name,"Expected argument name.").toString();this._consume(sI.tokens.colon,"Expected ':' for argument type.");const r=this._attribute(),o=this._type_decl();null!=o&&(o.attributes=r,n.push(this._updateNode(new WB(t,o,e))))}while(this._match(sI.tokens.comma));this._consume(sI.tokens.paren_right,"Expected ')' after function arguments.");let r=null;if(this._match(sI.tokens.arrow)){const e=this._attribute();r=this._type_decl(),null!=r&&(r.attributes=e)}const o=this._compound_statement(),i=this._currentLine;return this._updateNode(new YE(t,n,r,o,e,i),e)}_compound_statement(){const e=[];for(this._consume(sI.tokens.brace_left,"Expected '{' for block.");!this._check(sI.tokens.brace_right);){const t=this._statement();null!==t&&e.push(t)}return this._consume(sI.tokens.brace_right,"Expected '}' for block."),e}_statement(){for(;this._match(sI.tokens.semicolon)&&!this._isAtEnd(););if(this._check(sI.tokens.attr)&&this._attribute(),this._check(sI.keywords.if))return this._if_statement();if(this._check(sI.keywords.switch))return this._switch_statement();if(this._check(sI.keywords.loop))return this._loop_statement();if(this._check(sI.keywords.for))return this._for_statement();if(this._check(sI.keywords.while))return this._while_statement();if(this._check(sI.keywords.continuing))return this._continuing_statement();if(this._check(sI.keywords.static_assert))return this._static_assert_statement();if(this._check(sI.tokens.brace_left))return this._compound_statement();let e=null;if(this._check(sI.keywords.return))e=this._return_statement();else if(this._check([sI.keywords.var,sI.keywords.let,sI.keywords.const]))e=this._variable_statement();else if(this._match(sI.keywords.discard))e=this._updateNode(new bB);else if(this._match(sI.keywords.break)){const t=this._updateNode(new wB);if(this._currentLoop.length>0){const e=this._currentLoop[this._currentLoop.length-1];t.loopId=e.id}e=t,this._check(sI.keywords.if)&&(this._advance(),t.condition=this._optional_paren_expression())}else if(this._match(sI.keywords.continue)){const t=this._updateNode(new xB);if(!(this._currentLoop.length>0))throw this._error(this._peek(),`Continue statement must be inside a loop. Line: ${t.line}`);{const e=this._currentLoop[this._currentLoop.length-1];t.loopId=e.id}e=t}else e=this._increment_decrement_statement()||this._func_call_statement()||this._assignment_statement();return null!=e&&this._consume(sI.tokens.semicolon,"Expected ';' after statement."),e}_static_assert_statement(){if(!this._match(sI.keywords.static_assert))return null;const e=this._currentLine,t=this._optional_paren_expression();return this._updateNode(new qE(t),e)}_while_statement(){if(!this._match(sI.keywords.while))return null;const e=this._updateNode(new JE(null,null));return this._currentLoop.push(e),e.condition=this._optional_paren_expression(),this._check(sI.tokens.attr)&&this._attribute(),e.body=this._compound_statement(),this._currentLoop.pop(),e}_continuing_statement(){const e=this._currentLoop.length>0?this._currentLoop[this._currentLoop.length-1].id:-1;if(!this._match(sI.keywords.continuing))return null;const t=this._currentLine,n=this._compound_statement();return this._updateNode(new ZE(n,e),t)}_for_statement(){if(!this._match(sI.keywords.for))return null;this._consume(sI.tokens.paren_left,"Expected '('.");const e=this._updateNode(new eB(null,null,null,null));return this._currentLoop.push(e),e.init=this._check(sI.tokens.semicolon)?null:this._for_init(),this._consume(sI.tokens.semicolon,"Expected ';'."),e.condition=this._check(sI.tokens.semicolon)?null:this._short_circuit_or_expression(),this._consume(sI.tokens.semicolon,"Expected ';'."),e.increment=this._check(sI.tokens.paren_right)?null:this._for_increment(),this._consume(sI.tokens.paren_right,"Expected ')'."),this._check(sI.tokens.attr)&&this._attribute(),e.body=this._compound_statement(),this._currentLoop.pop(),e}_for_init(){return this._variable_statement()||this._func_call_statement()||this._assignment_statement()}_for_increment(){return this._func_call_statement()||this._increment_decrement_statement()||this._assignment_statement()}_variable_statement(){if(this._check(sI.keywords.var)){const e=this._variable_decl();if(null===e)throw this._error(this._peek(),"Variable declaration expected.");let t=null;return this._match(sI.tokens.equal)&&(t=this._short_circuit_or_expression()),this._updateNode(new tB(e.name,e.type,e.storage,e.access,t),e.line)}if(this._match(sI.keywords.let)){const e=this._currentLine,t=this._consume(sI.tokens.name,"Expected name for let.").toString();let n=null;if(this._match(sI.tokens.colon)){const e=this._attribute();n=this._type_decl(),null!=n&&(n.attributes=e)}this._consume(sI.tokens.equal,"Expected '=' for let.");const r=this._short_circuit_or_expression();return this._updateNode(new rB(t,n,null,null,r),e)}if(this._match(sI.keywords.const)){const e=this._currentLine,t=this._consume(sI.tokens.name,"Expected name for const.").toString();let n=null;if(this._match(sI.tokens.colon)){const e=this._attribute();n=this._type_decl(),null!=n&&(n.attributes=e)}this._consume(sI.tokens.equal,"Expected '=' for const.");const r=this._short_circuit_or_expression();return null===n&&r instanceof UB&&(n=r.type),this._updateNode(new oB(t,n,null,null,r),e)}return null}_increment_decrement_statement(){const e=this._current,t=this._unary_expression();if(null==t)return null;if(!this._check(sI.increment_operators))return this._current=e,null;const n=this._consume(sI.increment_operators,"Expected increment operator");return this._updateNode(new cB(n.type===sI.tokens.plus_plus?iB.increment:iB.decrement,t))}_assignment_statement(){let e=null;const t=this._currentLine;if(this._check(sI.tokens.brace_right))return null;let n=this._match(sI.tokens.underscore);if(n||(e=this._unary_expression()),!n&&null==e)return null;const r=this._consume(sI.assignment_operators,"Expected assignment operator."),o=this._short_circuit_or_expression();return this._updateNode(new uB(sB.parse(r.lexeme),e,o),t)}_func_call_statement(){if(!this._check(sI.tokens.ident))return null;const e=this._currentLine,t=this._current,n=this._consume(sI.tokens.ident,"Expected function name."),r=this._argument_expression_list();return null===r?(this._current=t,null):this._updateNode(new dB(n.lexeme,r),e)}_loop_statement(){if(!this._match(sI.keywords.loop))return null;this._check(sI.tokens.attr)&&this._attribute(),this._consume(sI.tokens.brace_left,"Expected '{' for loop.");const e=this._updateNode(new AB([],null));this._currentLoop.push(e);let t=this._statement();for(;null!==t;){if(Array.isArray(t))for(let n of t)e.body.push(n);else e.body.push(t);if(t instanceof ZE){e.continuing=t;break}t=this._statement()}return this._currentLoop.pop(),this._consume(sI.tokens.brace_right,"Expected '}' for loop."),e}_switch_statement(){if(!this._match(sI.keywords.switch))return null;const e=this._updateNode(new hB(null,[]));if(this._currentLoop.push(e),e.condition=this._optional_paren_expression(),this._check(sI.tokens.attr)&&this._attribute(),this._consume(sI.tokens.brace_left,"Expected '{' for switch."),e.cases=this._switch_body(),null==e.cases||0==e.cases.length)throw this._error(this._previous(),"Expected 'case' or 'default'.");return this._consume(sI.tokens.brace_right,"Expected '}' for switch."),this._currentLoop.pop(),e}_switch_body(){const e=[];let t=!1;for(;this._check([sI.keywords.default,sI.keywords.case]);){if(this._match(sI.keywords.case)){const n=this._case_selectors();for(const e of n)if(e instanceof HB){if(t)throw this._error(this._previous(),"Multiple default cases in switch statement.");t=!0;break}this._match(sI.tokens.colon),this._check(sI.tokens.attr)&&this._attribute(),this._consume(sI.tokens.brace_left,"Exected '{' for switch case.");const r=this._case_body();this._consume(sI.tokens.brace_right,"Exected '}' for switch case."),e.push(this._updateNode(new GB(n,r)))}if(this._match(sI.keywords.default)){if(t)throw this._error(this._previous(),"Multiple default cases in switch statement.");this._match(sI.tokens.colon),this._check(sI.tokens.attr)&&this._attribute(),this._consume(sI.tokens.brace_left,"Exected '{' for switch default.");const n=this._case_body();this._consume(sI.tokens.brace_right,"Exected '}' for switch default."),e.push(this._updateNode(new VB(n)))}}return e}_case_selectors(){const e=[];for(this._match(sI.keywords.default)?e.push(this._updateNode(new HB)):e.push(this._shift_expression());this._match(sI.tokens.comma);)this._match(sI.keywords.default)?e.push(this._updateNode(new HB)):e.push(this._shift_expression());return e}_case_body(){if(this._match(sI.keywords.fallthrough))return this._consume(sI.tokens.semicolon,"Expected ';'"),[];let e=this._statement();if(null==e)return[];e instanceof Array||(e=[e]);const t=this._case_body();return 0==t.length?e:[...e,t[0]]}_if_statement(){if(!this._match(sI.keywords.if))return null;const e=this._currentLine,t=this._optional_paren_expression();this._check(sI.tokens.attr)&&this._attribute();const n=this._compound_statement();let r=[];this._match_elseif()&&(this._check(sI.tokens.attr)&&this._attribute(),r=this._elseif_statement(r));let o=null;return this._match(sI.keywords.else)&&(this._check(sI.tokens.attr)&&this._attribute(),o=this._compound_statement()),this._updateNode(new pB(t,n,r,o),e)}_match_elseif(){return this._tokens[this._current].type===sI.keywords.else&&this._tokens[this._current+1].type===sI.keywords.if&&(this._advance(),this._advance(),!0)}_elseif_statement(e=[]){const t=this._optional_paren_expression(),n=this._compound_statement();return e.push(this._updateNode(new $B(t,n))),this._match_elseif()&&(this._check(sI.tokens.attr)&&this._attribute(),this._elseif_statement(e)),e}_return_statement(){if(!this._match(sI.keywords.return))return null;const e=this._short_circuit_or_expression();return this._updateNode(new fB(e))}_short_circuit_or_expression(){let e=this._short_circuit_and_expr();for(;this._match(sI.tokens.or_or);)e=this._updateNode(new QB(this._previous().toString(),e,this._short_circuit_and_expr()));return e}_short_circuit_and_expr(){let e=this._inclusive_or_expression();for(;this._match(sI.tokens.and_and);)e=this._updateNode(new QB(this._previous().toString(),e,this._inclusive_or_expression()));return e}_inclusive_or_expression(){let e=this._exclusive_or_expression();for(;this._match(sI.tokens.or);)e=this._updateNode(new QB(this._previous().toString(),e,this._exclusive_or_expression()));return e}_exclusive_or_expression(){let e=this._and_expression();for(;this._match(sI.tokens.xor);)e=this._updateNode(new QB(this._previous().toString(),e,this._and_expression()));return e}_and_expression(){let e=this._equality_expression();for(;this._match(sI.tokens.and);)e=this._updateNode(new QB(this._previous().toString(),e,this._equality_expression()));return e}_equality_expression(){const e=this._relational_expression();return this._match([sI.tokens.equal_equal,sI.tokens.not_equal])?this._updateNode(new QB(this._previous().toString(),e,this._relational_expression())):e}_relational_expression(){let e=this._shift_expression();for(;this._match([sI.tokens.less_than,sI.tokens.greater_than,sI.tokens.less_than_equal,sI.tokens.greater_than_equal]);)e=this._updateNode(new QB(this._previous().toString(),e,this._shift_expression()));return e}_shift_expression(){let e=this._additive_expression();for(;this._match([sI.tokens.shift_left,sI.tokens.shift_right]);)e=this._updateNode(new QB(this._previous().toString(),e,this._additive_expression()));return e}_additive_expression(){let e=this._multiplicative_expression();for(;this._match([sI.tokens.plus,sI.tokens.minus]);)e=this._updateNode(new QB(this._previous().toString(),e,this._multiplicative_expression()));return e}_multiplicative_expression(){let e=this._unary_expression();for(;this._match([sI.tokens.star,sI.tokens.forward_slash,sI.tokens.modulo]);)e=this._updateNode(new QB(this._previous().toString(),e,this._unary_expression()));return e}_unary_expression(){return this._match([sI.tokens.minus,sI.tokens.bang,sI.tokens.tilde,sI.tokens.star,sI.tokens.and])?this._updateNode(new jB(this._previous().toString(),this._unary_expression())):this._singular_expression()}_singular_expression(){const e=this._primary_expression(),t=this._postfix_expression();return t&&(e.postfix=t),e}_postfix_expression(){if(this._match(sI.tokens.bracket_left)){const e=this._short_circuit_or_expression();this._consume(sI.tokens.bracket_right,"Expected ']'.");const t=this._updateNode(new DB(e)),n=this._postfix_expression();return n&&(t.postfix=n),t}if(this._match(sI.tokens.period)){const e=this._consume(sI.tokens.name,"Expected member name."),t=this._postfix_expression(),n=this._updateNode(new TB(e.lexeme));return t&&(n.postfix=t),n}return null}_getStruct(e){return this._context.aliases.has(e)?this._context.aliases.get(e).type:this._context.structs.has(e)?this._context.structs.get(e):null}_getType(e){const t=this._getStruct(e);if(null!==t)return t;switch(e){case"void":return _B.void;case"bool":return _B.bool;case"i32":return _B.i32;case"u32":return _B.u32;case"f32":return _B.f32;case"f16":return _B.f16;case"vec2f":return EB.vec2f;case"vec3f":return EB.vec3f;case"vec4f":return EB.vec4f;case"vec2i":return EB.vec2i;case"vec3i":return EB.vec3i;case"vec4i":return EB.vec4i;case"vec2u":return EB.vec2u;case"vec3u":return EB.vec3u;case"vec4u":return EB.vec4u;case"vec2h":return EB.vec2h;case"vec3h":return EB.vec3h;case"vec4h":return EB.vec4h;case"mat2x2f":return EB.mat2x2f;case"mat2x3f":return EB.mat2x3f;case"mat2x4f":return EB.mat2x4f;case"mat3x2f":return EB.mat3x2f;case"mat3x3f":return EB.mat3x3f;case"mat3x4f":return EB.mat3x4f;case"mat4x2f":return EB.mat4x2f;case"mat4x3f":return EB.mat4x3f;case"mat4x4f":return EB.mat4x4f;case"mat2x2h":return EB.mat2x2h;case"mat2x3h":return EB.mat2x3h;case"mat2x4h":return EB.mat2x4h;case"mat3x2h":return EB.mat3x2h;case"mat3x3h":return EB.mat3x3h;case"mat3x4h":return EB.mat3x4h;case"mat4x2h":return EB.mat4x2h;case"mat4x3h":return EB.mat4x3h;case"mat4x4h":return EB.mat4x4h;case"mat2x2i":return EB.mat2x2i;case"mat2x3i":return EB.mat2x3i;case"mat2x4i":return EB.mat2x4i;case"mat3x2i":return EB.mat3x2i;case"mat3x3i":return EB.mat3x3i;case"mat3x4i":return EB.mat3x4i;case"mat4x2i":return EB.mat4x2i;case"mat4x3i":return EB.mat4x3i;case"mat4x4i":return EB.mat4x4i;case"mat2x2u":return EB.mat2x2u;case"mat2x3u":return EB.mat2x3u;case"mat2x4u":return EB.mat2x4u;case"mat3x2u":return EB.mat3x2u;case"mat3x3u":return EB.mat3x3u;case"mat3x4u":return EB.mat3x4u;case"mat4x2u":return EB.mat4x2u;case"mat4x3u":return EB.mat4x3u;case"mat4x4u":return EB.mat4x4u}return null}_validateTypeRange(e,t){if("i32"===t.name){if(e<-2147483648||e>2147483647)throw this._error(this._previous(),`Value out of range for i32: ${e}. Line: ${this._currentLine}.`)}else if("u32"===t.name&&(e<0||e>4294967295))throw this._error(this._previous(),`Value out of range for u32: ${e}. Line: ${this._currentLine}.`)}_primary_expression(){if(this._match(sI.tokens.ident)){const e=this._previous().toString();if(this._check(sI.tokens.paren_left)){const t=this._argument_expression_list(),n=this._getType(e);return null!==n?this._updateNode(new PB(n,t)):this._updateNode(new FB(e,t))}if(this._context.constants.has(e)){const t=this._context.constants.get(e);return this._updateNode(new LB(e,t.value))}return this._updateNode(new MB(e))}if(this._match(sI.tokens.int_literal)){const e=this._previous().toString();let t=e.endsWith("i")||e.endsWith("i")?_B.i32:e.endsWith("u")||e.endsWith("U")?_B.u32:_B.x32;const n=parseInt(e);return this._validateTypeRange(n,t),this._updateNode(new UB(new ZB(n,this._exec.getTypeInfo(t)),t))}if(this._match(sI.tokens.uint_literal)){const e=parseInt(this._previous().toString());return this._validateTypeRange(e,_B.u32),this._updateNode(new UB(new ZB(e,this._exec.getTypeInfo(_B.u32)),_B.u32))}if(this._match([sI.tokens.decimal_float_literal,sI.tokens.hex_float_literal])){let e=this._previous().toString(),t=e.endsWith("h");t&&(e=e.substring(0,e.length-1));const n=parseFloat(e);this._validateTypeRange(n,t?_B.f16:_B.f32);const r=t?_B.f16:_B.f32;return this._updateNode(new UB(new ZB(n,this._exec.getTypeInfo(r)),r))}if(this._match([sI.keywords.true,sI.keywords.false])){let e=this._previous().toString()===sI.keywords.true.rule;return this._updateNode(new UB(new ZB(e?1:0,this._exec.getTypeInfo(_B.bool)),_B.bool))}if(this._check(sI.tokens.paren_left))return this._paren_expression();if(this._match(sI.keywords.bitcast)){this._consume(sI.tokens.less_than,"Expected '<'.");const e=this._type_decl();this._consume(sI.tokens.greater_than,"Expected '>'.");const t=this._paren_expression();return this._updateNode(new OB(e,t))}const e=this._type_decl(),t=this._argument_expression_list();return this._updateNode(new PB(e,t))}_argument_expression_list(){if(!this._match(sI.tokens.paren_left))return null;const e=[];do{if(this._check(sI.tokens.paren_right))break;const t=this._short_circuit_or_expression();e.push(t)}while(this._match(sI.tokens.comma));return this._consume(sI.tokens.paren_right,"Expected ')' for agument list"),e}_optional_paren_expression(){this._match(sI.tokens.paren_left);const e=this._short_circuit_or_expression();return this._match(sI.tokens.paren_right),e}_paren_expression(){this._consume(sI.tokens.paren_left,"Expected '('.");const e=this._short_circuit_or_expression();return this._consume(sI.tokens.paren_right,"Expected ')'."),e}_struct_decl(){if(!this._match(sI.keywords.struct))return null;const e=this._currentLine,t=this._consume(sI.tokens.ident,"Expected name for struct.").toString();this._consume(sI.tokens.brace_left,"Expected '{' for struct body.");const n=[];for(;!this._check(sI.tokens.brace_right);){const e=this._attribute(),t=this._consume(sI.tokens.name,"Expected variable name.").toString();this._consume(sI.tokens.colon,"Expected ':' for struct member type.");const r=this._attribute(),o=this._type_decl();null!=o&&(o.attributes=r),this._check(sI.tokens.brace_right)?this._match(sI.tokens.comma):this._consume(sI.tokens.comma,"Expected ',' for struct member."),n.push(this._updateNode(new KB(t,o,e)))}this._consume(sI.tokens.brace_right,"Expected '}' after struct body.");const r=this._currentLine,o=this._updateNode(new SB(t,n,e,r),e);return this._context.structs.set(t,o),o}_global_variable_decl(){const e=this._variable_decl();if(!e)return null;if(this._match(sI.tokens.equal)){const t=this._const_expression();e.value=t}if(null!==e.type&&e.value instanceof UB){if("x32"!==e.value.type.name&&e.type.getTypeName()!==e.value.type.getTypeName())throw this._error(this._peek(),`Invalid cast from ${e.value.type.name} to ${e.type.name}. Line:${this._currentLine}`);e.value.isScalar&&this._validateTypeRange(e.value.scalarValue,e.type),e.value.type=e.type}else null===e.type&&e.value instanceof UB&&(e.type="x32"===e.value.type.name?_B.i32:e.value.type,e.value.isScalar&&this._validateTypeRange(e.value.scalarValue,e.type));return e}_override_variable_decl(){const e=this._override_decl();return e&&this._match(sI.tokens.equal)&&(e.value=this._const_expression()),e}_global_const_decl(){var e;if(!this._match(sI.keywords.const))return null;const t=this._consume(sI.tokens.name,"Expected variable name"),n=this._currentLine;let r=null;if(this._match(sI.tokens.colon)){const e=this._attribute();r=this._type_decl(),null!=r&&(r.attributes=e)}let o=null;this._consume(sI.tokens.equal,"const declarations require an assignment");const i=this._short_circuit_or_expression();try{let e=[_B.f32],n=i.constEvaluate(this._exec,e);n instanceof ZB&&this._validateTypeRange(n.value,e[0]),e[0]instanceof EB&&null===e[0].format&&n.typeInfo instanceof _E&&null!==n.typeInfo.format&&("f16"===n.typeInfo.format.name?e[0].format=_B.f16:"f32"===n.typeInfo.format.name?e[0].format=_B.f32:"i32"===n.typeInfo.format.name?e[0].format=_B.i32:"u32"===n.typeInfo.format.name?e[0].format=_B.u32:"bool"===n.typeInfo.format.name&&(e[0].format=_B.bool)),o=this._updateNode(new UB(n,e[0])),this._exec.context.setVariable(t.toString(),n)}catch(hee){o=i}if(null!==r&&o instanceof UB){if("x32"!==o.type.name&&r.getTypeName()!==o.type.getTypeName())throw this._error(this._peek(),`Invalid cast from ${o.type.name} to ${r.name}. Line:${this._currentLine}`);o.type=r,o.isScalar&&this._validateTypeRange(o.scalarValue,o.type)}else null===r&&o instanceof UB&&(r=null!==(e=null==o?void 0:o.type)&&void 0!==e?e:_B.f32,r===_B.x32&&(r=_B.i32));const s=this._updateNode(new oB(t.toString(),r,"","",o),n);return this._context.constants.set(s.name,s),s}_global_let_decl(){if(!this._match(sI.keywords.let))return null;const e=this._currentLine,t=this._consume(sI.tokens.name,"Expected variable name");let n=null;if(this._match(sI.tokens.colon)){const e=this._attribute();n=this._type_decl(),null!=n&&(n.attributes=e)}let r=null;if(this._match(sI.tokens.equal)&&(r=this._const_expression()),null!==n&&r instanceof UB){if("x32"!==r.type.name&&n.getTypeName()!==r.type.getTypeName())throw this._error(this._peek(),`Invalid cast from ${r.type.name} to ${n.name}. Line:${this._currentLine}`);r.type=n}else null===n&&r instanceof UB&&(n="x32"===r.type.name?_B.i32:r.type);return r instanceof UB&&r.isScalar&&this._validateTypeRange(r.scalarValue,n),this._updateNode(new rB(t.toString(),n,"","",r),e)}_const_expression(){return this._short_circuit_or_expression()}_variable_decl(){if(!this._match(sI.keywords.var))return null;const e=this._currentLine;let t="",n="";this._match(sI.tokens.less_than)&&(t=this._consume(sI.storage_class,"Expected storage_class.").toString(),this._match(sI.tokens.comma)&&(n=this._consume(sI.access_mode,"Expected access_mode.").toString()),this._consume(sI.tokens.greater_than,"Expected '>'."));const r=this._consume(sI.tokens.name,"Expected variable name");let o=null;if(this._match(sI.tokens.colon)){const e=this._attribute();o=this._type_decl(),null!=o&&(o.attributes=e)}return this._updateNode(new tB(r.toString(),o,t,n,null),e)}_override_decl(){if(!this._match(sI.keywords.override))return null;const e=this._consume(sI.tokens.name,"Expected variable name");let t=null;if(this._match(sI.tokens.colon)){const e=this._attribute();t=this._type_decl(),null!=t&&(t.attributes=e)}return this._updateNode(new nB(e.toString(),t,null))}_diagnostic(){this._consume(sI.tokens.paren_left,"Expected '('");const e=this._consume(sI.tokens.ident,"Expected severity control name.");this._consume(sI.tokens.comma,"Expected ','");let t=this._consume(sI.tokens.ident,"Expected diagnostic rule name.").toString();return this._match(sI.tokens.period)&&(t+=`.${this._consume(sI.tokens.ident,"Expected diagnostic message.").toString()}`),this._consume(sI.tokens.paren_right,"Expected ')'"),this._updateNode(new yB(e.toString(),t))}_enable_directive(){const e=this._consume(sI.tokens.ident,"identity expected.");return this._updateNode(new gB(e.toString()))}_requires_directive(){const e=[this._consume(sI.tokens.ident,"identity expected.").toString()];for(;this._match(sI.tokens.comma);){const t=this._consume(sI.tokens.ident,"identity expected.");e.push(t.toString())}return this._updateNode(new mB(e))}_type_alias(){const e=this._consume(sI.tokens.ident,"identity expected.");this._consume(sI.tokens.equal,"Expected '=' for type alias.");let t=this._type_decl();if(null===t)throw this._error(this._peek(),"Expected Type for Alias.");this._context.aliases.has(t.name)&&(t=this._context.aliases.get(t.name).type);const n=this._updateNode(new vB(e.toString(),t));return this._context.aliases.set(n.name,n),n}_type_decl(){if(this._check([sI.tokens.ident,...sI.texel_format,sI.keywords.bool,sI.keywords.f32,sI.keywords.i32,sI.keywords.u32])){const e=this._advance().toString();if(this._context.structs.has(e))return this._context.structs.get(e);if(this._context.aliases.has(e))return this._context.aliases.get(e).type;if(!this._getType(e)){const t=this._updateNode(new CB(e));return this._forwardTypeCount++,t}return this._updateNode(new _B(e))}let e=this._texture_sampler_types();if(e)return e;if(this._check(sI.template_types)){let e=this._advance().toString(),t=null,n=null;return this._match(sI.tokens.less_than)&&(t=this._type_decl(),n=null,this._match(sI.tokens.comma)&&(n=this._consume(sI.access_mode,"Expected access_mode for pointer").toString()),this._consume(sI.tokens.greater_than,"Expected '>' for type.")),this._updateNode(new EB(e,t,n))}if(this._match(sI.keywords.ptr)){let e=this._previous().toString();this._consume(sI.tokens.less_than,"Expected '<' for pointer.");const t=this._consume(sI.storage_class,"Expected storage_class for pointer");this._consume(sI.tokens.comma,"Expected ',' for pointer.");const n=this._type_decl();let r=null;return this._match(sI.tokens.comma)&&(r=this._consume(sI.access_mode,"Expected access_mode for pointer").toString()),this._consume(sI.tokens.greater_than,"Expected '>' for pointer."),this._updateNode(new BB(e,t.toString(),n,r))}const t=this._attribute();if(this._match(sI.keywords.array)){let e=null,r=-1;const o=this._previous();let i=null;if(this._match(sI.tokens.less_than)){e=this._type_decl(),this._context.aliases.has(e.name)&&(e=this._context.aliases.get(e.name).type);let t="";if(this._match(sI.tokens.comma)){i=this._shift_expression();try{t=i.constEvaluate(this._exec).toString(),i=null}catch(n){t="1"}}this._consume(sI.tokens.greater_than,"Expected '>' for array."),r=t?parseInt(t):0}const s=this._updateNode(new IB(o.toString(),t,e,r));return i&&this._deferArrayCountEval.push({arrayType:s,countNode:i}),s}return null}_texture_sampler_types(){if(this._match(sI.sampler_type))return this._updateNode(new RB(this._previous().toString(),null,null));if(this._match(sI.depth_texture_type))return this._updateNode(new RB(this._previous().toString(),null,null));if(this._match(sI.sampled_texture_type)||this._match(sI.multisampled_texture_type)){const e=this._previous();this._consume(sI.tokens.less_than,"Expected '<' for sampler type.");const t=this._type_decl();return this._consume(sI.tokens.greater_than,"Expected '>' for sampler type."),this._updateNode(new RB(e.toString(),t,null))}if(this._match(sI.storage_texture_type)){const e=this._previous();this._consume(sI.tokens.less_than,"Expected '<' for sampler type.");const t=this._consume(sI.texel_format,"Invalid texel format.").toString();this._consume(sI.tokens.comma,"Expected ',' after texel format.");const n=this._consume(sI.access_mode,"Expected access mode for storage texture type.").toString();return this._consume(sI.tokens.greater_than,"Expected '>' for sampler type."),this._updateNode(new RB(e.toString(),t,n))}return null}_attribute(){let e=[];for(;this._match(sI.tokens.attr);){const t=this._consume(sI.attribute_name,"Expected attribute name"),n=this._updateNode(new XB(t.toString(),null));if(this._match(sI.tokens.paren_left)){if(n.value=this._consume(sI.literal_or_ident,"Expected attribute value").toString(),this._check(sI.tokens.comma)){this._advance();do{const e=this._consume(sI.literal_or_ident,"Expected attribute value").toString();n.value instanceof Array||(n.value=[n.value]),n.value.push(e)}while(this._match(sI.tokens.comma))}this._consume(sI.tokens.paren_right,"Expected ')'")}e.push(n)}return 0==e.length?null:e}};class MI extends xI{constructor(e){super(),e&&this.update(e)}update(e){const t=(new FI).parse(e);this.updateAST(t)}}function LI(e){const t={attributes:[],bindings:[]};let n;try{n=function(e){try{return new MI(e)}catch(t){if(t instanceof Error)throw t;let e="WGSL parse error";throw"object"==typeof t&&t?.message&&(e+=`: ${t.message} `),"object"==typeof t&&t?.token&&(e+=t.token.line||""),new Error(e,{cause:t})}}(e)}catch(i){return eS.error(i.message)(),t}for(const s of n.uniforms){const e=[];for(const t of s.type?.members||[])e.push({name:t.name,type:UI(t.type)});t.bindings.push({type:"uniform",name:s.name,group:s.group,location:s.binding,members:e})}for(const s of n.textures)t.bindings.push({type:"texture",name:s.name,group:s.group,location:s.binding});for(const s of n.samplers)t.bindings.push({type:"sampler",name:s.name,group:s.group,location:s.binding});const r=n.entry.vertex[0],o=r?.inputs.length||0;for(let s=0;s<o;s++){const e=r.inputs[s];if("location"===e.locationType){const n=UI(e.type);t.attributes.push({name:e.name,location:Number(e.location),type:n})}}return t}function UI(e){return e.format?`${e.name}<${e.format.name}>`:e.name}globalThis.mathgl=globalThis.mathgl||{config:{EPSILON:1e-12,debug:!1,precision:4,printTypes:!1,printDegrees:!1,printRowMajor:!0,_cartographicRadians:!1}};const OI=globalThis.mathgl.config;function DI(e,{precision:t=OI.precision}={}){return e=function(e){return Math.round(e/OI.EPSILON)*OI.EPSILON}(e),`${parseFloat(e.toPrecision(t))}`}function NI(e){return Array.isArray(e)||ArrayBuffer.isView(e)&&!(e instanceof DataView)}function jI(e,t,n){return function(e,t,n){if(NI(e)){const r=e;n=n||function(e){return e.clone?e.clone():new Array(e.length)}(r);for(let o=0;o<n.length&&o<r.length;++o){const r="number"==typeof e?e:e[o];n[o]=t(r,o,n)}return n}return t(e)}(e,e=>Math.max(t,Math.min(n,e)))}function QI(e,t,n){return NI(e)?e.map((e,r)=>QI(e,t[r],n)):n*t+(1-n)*e}function zI(e,t,n){const r=OI.EPSILON;try{if(e===t)return!0;if(NI(e)&&NI(t)){if(e.length!==t.length)return!1;for(let n=0;n<e.length;++n)if(!zI(e[n],t[n]))return!1;return!0}return e&&e.equals?e.equals(t):t&&t.equals?t.equals(e):"number"==typeof e&&"number"==typeof t&&Math.abs(e-t)<=OI.EPSILON*Math.max(1,Math.abs(e),Math.abs(t))}finally{OI.EPSILON=r}}class HI extends Array{clone(){return(new this.constructor).copy(this)}fromArray(e,t=0){for(let n=0;n<this.ELEMENTS;++n)this[n]=e[n+t];return this.check()}toArray(e=[],t=0){for(let n=0;n<this.ELEMENTS;++n)e[t+n]=this[n];return e}toObject(e){return e}from(e){return Array.isArray(e)?this.copy(e):this.fromObject(e)}to(e){return e===this?this:NI(e)?this.toArray(e):this.toObject(e)}toTarget(e){return e?this.to(e):this}toFloat32Array(){return new Float32Array(this)}toString(){return this.formatString(OI)}formatString(e){let t="";for(let n=0;n<this.ELEMENTS;++n)t+=(n>0?", ":"")+DI(this[n],e);return`${e.printTypes?this.constructor.name:""}[${t}]`}equals(e){if(!e||this.length!==e.length)return!1;for(let t=0;t<this.ELEMENTS;++t)if(!zI(this[t],e[t]))return!1;return!0}exactEquals(e){if(!e||this.length!==e.length)return!1;for(let t=0;t<this.ELEMENTS;++t)if(this[t]!==e[t])return!1;return!0}negate(){for(let e=0;e<this.ELEMENTS;++e)this[e]=-this[e];return this.check()}lerp(e,t,n){if(void 0===n)return this.lerp(this,e,t);for(let r=0;r<this.ELEMENTS;++r){const o=e[r],i="number"==typeof t?t:t[r];this[r]=o+n*(i-o)}return this.check()}min(e){for(let t=0;t<this.ELEMENTS;++t)this[t]=Math.min(e[t],this[t]);return this.check()}max(e){for(let t=0;t<this.ELEMENTS;++t)this[t]=Math.max(e[t],this[t]);return this.check()}clamp(e,t){for(let n=0;n<this.ELEMENTS;++n)this[n]=Math.min(Math.max(this[n],e[n]),t[n]);return this.check()}add(...e){for(const t of e)for(let e=0;e<this.ELEMENTS;++e)this[e]+=t[e];return this.check()}subtract(...e){for(const t of e)for(let e=0;e<this.ELEMENTS;++e)this[e]-=t[e];return this.check()}scale(e){if("number"==typeof e)for(let t=0;t<this.ELEMENTS;++t)this[t]*=e;else for(let t=0;t<this.ELEMENTS&&t<e.length;++t)this[t]*=e[t];return this.check()}multiplyByScalar(e){for(let t=0;t<this.ELEMENTS;++t)this[t]*=e;return this.check()}check(){if(OI.debug&&!this.validate())throw new Error(`math.gl: ${this.constructor.name} some fields set to invalid numbers'`);return this}validate(){let e=this.length===this.ELEMENTS;for(let t=0;t<this.ELEMENTS;++t)e=e&&Number.isFinite(this[t]);return e}sub(e){return this.subtract(e)}setScalar(e){for(let t=0;t<this.ELEMENTS;++t)this[t]=e;return this.check()}addScalar(e){for(let t=0;t<this.ELEMENTS;++t)this[t]+=e;return this.check()}subScalar(e){return this.addScalar(-e)}multiplyScalar(e){for(let t=0;t<this.ELEMENTS;++t)this[t]*=e;return this.check()}divideScalar(e){return this.multiplyByScalar(1/e)}clampScalar(e,t){for(let n=0;n<this.ELEMENTS;++n)this[n]=Math.min(Math.max(this[n],e),t);return this.check()}get elements(){return this}}function GI(e){if(!Number.isFinite(e))throw new Error(`Invalid number ${JSON.stringify(e)}`);return e}function VI(e,t,n=""){if(OI.debug&&!function(e,t){if(e.length!==t)return!1;for(let n=0;n<e.length;++n)if(!Number.isFinite(e[n]))return!1;return!0}(e,t))throw new Error(`math.gl: ${n} some fields set to invalid numbers'`);return e}function WI(e,t){if(!e)throw new Error(`math.gl assertion ${t}`)}let $I=class extends HI{get x(){return this[0]}set x(e){this[0]=GI(e)}get y(){return this[1]}set y(e){this[1]=GI(e)}len(){return Math.sqrt(this.lengthSquared())}magnitude(){return this.len()}lengthSquared(){let e=0;for(let t=0;t<this.ELEMENTS;++t)e+=this[t]*this[t];return e}magnitudeSquared(){return this.lengthSquared()}distance(e){return Math.sqrt(this.distanceSquared(e))}distanceSquared(e){let t=0;for(let n=0;n<this.ELEMENTS;++n){const r=this[n]-e[n];t+=r*r}return GI(t)}dot(e){let t=0;for(let n=0;n<this.ELEMENTS;++n)t+=this[n]*e[n];return GI(t)}normalize(){const e=this.magnitude();if(0!==e)for(let t=0;t<this.ELEMENTS;++t)this[t]/=e;return this.check()}multiply(...e){for(const t of e)for(let e=0;e<this.ELEMENTS;++e)this[e]*=t[e];return this.check()}divide(...e){for(const t of e)for(let e=0;e<this.ELEMENTS;++e)this[e]/=t[e];return this.check()}lengthSq(){return this.lengthSquared()}distanceTo(e){return this.distance(e)}distanceToSquared(e){return this.distanceSquared(e)}getComponent(e){return WI(e>=0&&e<this.ELEMENTS,"index is out of range"),GI(this[e])}setComponent(e,t){return WI(e>=0&&e<this.ELEMENTS,"index is out of range"),this[e]=t,this.check()}addVectors(e,t){return this.copy(e).add(t)}subVectors(e,t){return this.copy(e).subtract(t)}multiplyVectors(e,t){return this.copy(e).multiply(t)}addScaledVector(e,t){return this.add(new this.constructor(e).multiplyScalar(t))}};const KI=1e-6;let XI="undefined"!=typeof Float32Array?Float32Array:Array;function YI(e,t,n){return e[0]=t[0]+n[0],e[1]=t[1]+n[1],e}function qI(e,t,n,r){const o=t[0],i=t[1];return e[0]=o+r*(n[0]-o),e[1]=i+r*(n[1]-i),e}function JI(e,t,n){const r=t[0],o=t[1];return e[0]=n[0]*r+n[3]*o+n[6],e[1]=n[1]*r+n[4]*o+n[7],e}function ZI(e,t,n){const r=t[0],o=t[1];return e[0]=n[0]*r+n[4]*o+n[12],e[1]=n[1]*r+n[5]*o+n[13],e}function eR(e,t,n){const r=t[0],o=t[1],i=n[3]*r+n[7]*o||1;return e[0]=(n[0]*r+n[4]*o)/i,e[1]=(n[1]*r+n[5]*o)/i,e}function tR(e,t,n){const r=t[0],o=t[1],i=t[2],s=n[3]*r+n[7]*o+n[11]*i||1;return e[0]=(n[0]*r+n[4]*o+n[8]*i)/s,e[1]=(n[1]*r+n[5]*o+n[9]*i)/s,e[2]=(n[2]*r+n[6]*o+n[10]*i)/s,e}function nR(e,t,n){const r=t[0],o=t[1],i=t[2];return e[0]=n[0]*r+n[3]*o+n[6]*i,e[1]=n[1]*r+n[4]*o+n[7]*i,e[2]=n[2]*r+n[5]*o+n[8]*i,e[3]=t[3],e}!function(){const e=function(){const e=new XI(2);return XI!=Float32Array&&(e[0]=0,e[1]=0),e}()}();class rR extends $I{constructor(e=0,t=0){super(2),NI(e)&&1===arguments.length?this.copy(e):(OI.debug&&(GI(e),GI(t)),this[0]=e,this[1]=t)}set(e,t){return this[0]=e,this[1]=t,this.check()}copy(e){return this[0]=e[0],this[1]=e[1],this.check()}fromObject(e){return OI.debug&&(GI(e.x),GI(e.y)),this[0]=e.x,this[1]=e.y,this.check()}toObject(e){return e.x=this[0],e.y=this[1],e}get ELEMENTS(){return 2}horizontalAngle(){return Math.atan2(this.y,this.x)}verticalAngle(){return Math.atan2(this.x,this.y)}transform(e){return this.transformAsPoint(e)}transformAsPoint(e){return ZI(this,this,e),this.check()}transformAsVector(e){return eR(this,this,e),this.check()}transformByMatrix3(e){return JI(this,this,e),this.check()}transformByMatrix2x3(e){return function(e,t,n){const r=t[0],o=t[1];e[0]=n[0]*r+n[2]*o+n[4],e[1]=n[1]*r+n[3]*o+n[5]}(this,this,e),this.check()}transformByMatrix2(e){return function(e,t,n){const r=t[0],o=t[1];e[0]=n[0]*r+n[2]*o,e[1]=n[1]*r+n[3]*o}(this,this,e),this.check()}}function oR(){const e=new XI(3);return XI!=Float32Array&&(e[0]=0,e[1]=0,e[2]=0),e}function iR(e,t,n){const r=new XI(3);return r[0]=e,r[1]=t,r[2]=n,r}function sR(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]}function aR(e,t,n){const r=t[0],o=t[1],i=t[2],s=n[0],a=n[1],l=n[2];return e[0]=o*l-i*a,e[1]=i*s-r*l,e[2]=r*a-o*s,e}function lR(e,t,n){const r=t[0],o=t[1],i=t[2];let s=n[3]*r+n[7]*o+n[11]*i+n[15];return s=s||1,e[0]=(n[0]*r+n[4]*o+n[8]*i+n[12])/s,e[1]=(n[1]*r+n[5]*o+n[9]*i+n[13])/s,e[2]=(n[2]*r+n[6]*o+n[10]*i+n[14])/s,e}function cR(e,t,n){const r=t[0],o=t[1],i=t[2];return e[0]=r*n[0]+o*n[3]+i*n[6],e[1]=r*n[1]+o*n[4]+i*n[7],e[2]=r*n[2]+o*n[5]+i*n[8],e}function uR(e,t,n){const r=n[0],o=n[1],i=n[2],s=n[3],a=t[0],l=t[1],c=t[2];let u=o*c-i*l,d=i*a-r*c,A=r*l-o*a,h=o*A-i*d,p=i*u-r*A,f=r*d-o*u;const g=2*s;return u*=g,d*=g,A*=g,h*=2,p*=2,f*=2,e[0]=a+u+h,e[1]=l+d+p,e[2]=c+A+f,e}const dR=function(e,t,n){return e[0]=t[0]-n[0],e[1]=t[1]-n[1],e[2]=t[2]-n[2],e},AR=function(e){const t=e[0],n=e[1],r=e[2];return Math.sqrt(t*t+n*n+r*r)},hR=function(e){const t=e[0],n=e[1],r=e[2];return t*t+n*n+r*r};!function(){const e=oR()}();const pR=[0,0,0];let fR,gR;class mR extends $I{static get ZERO(){return fR||(fR=new mR(0,0,0),Object.freeze(fR)),fR}constructor(e=0,t=0,n=0){super(-0,-0,-0),1===arguments.length&&NI(e)?this.copy(e):(OI.debug&&(GI(e),GI(t),GI(n)),this[0]=e,this[1]=t,this[2]=n)}set(e,t,n){return this[0]=e,this[1]=t,this[2]=n,this.check()}copy(e){return this[0]=e[0],this[1]=e[1],this[2]=e[2],this.check()}fromObject(e){return OI.debug&&(GI(e.x),GI(e.y),GI(e.z)),this[0]=e.x,this[1]=e.y,this[2]=e.z,this.check()}toObject(e){return e.x=this[0],e.y=this[1],e.z=this[2],e}get ELEMENTS(){return 3}get z(){return this[2]}set z(e){this[2]=GI(e)}angle(e){return function(e,t){const n=e[0],r=e[1],o=e[2],i=t[0],s=t[1],a=t[2],l=Math.sqrt((n*n+r*r+o*o)*(i*i+s*s+a*a)),c=l&&sR(e,t)/l;return Math.acos(Math.min(Math.max(c,-1),1))}(this,e)}cross(e){return aR(this,this,e),this.check()}rotateX({radians:e,origin:t=pR}){return function(e,t,n,r){const o=[],i=[];o[0]=t[0]-n[0],o[1]=t[1]-n[1],o[2]=t[2]-n[2],i[0]=o[0],i[1]=o[1]*Math.cos(r)-o[2]*Math.sin(r),i[2]=o[1]*Math.sin(r)+o[2]*Math.cos(r),e[0]=i[0]+n[0],e[1]=i[1]+n[1],e[2]=i[2]+n[2]}(this,this,t,e),this.check()}rotateY({radians:e,origin:t=pR}){return function(e,t,n,r){const o=[],i=[];o[0]=t[0]-n[0],o[1]=t[1]-n[1],o[2]=t[2]-n[2],i[0]=o[2]*Math.sin(r)+o[0]*Math.cos(r),i[1]=o[1],i[2]=o[2]*Math.cos(r)-o[0]*Math.sin(r),e[0]=i[0]+n[0],e[1]=i[1]+n[1],e[2]=i[2]+n[2]}(this,this,t,e),this.check()}rotateZ({radians:e,origin:t=pR}){return function(e,t,n,r){const o=[],i=[];o[0]=t[0]-n[0],o[1]=t[1]-n[1],o[2]=t[2]-n[2],i[0]=o[0]*Math.cos(r)-o[1]*Math.sin(r),i[1]=o[0]*Math.sin(r)+o[1]*Math.cos(r),i[2]=o[2],e[0]=i[0]+n[0],e[1]=i[1]+n[1],e[2]=i[2]+n[2]}(this,this,t,e),this.check()}transform(e){return this.transformAsPoint(e)}transformAsPoint(e){return lR(this,this,e),this.check()}transformAsVector(e){return tR(this,this,e),this.check()}transformByMatrix3(e){return cR(this,this,e),this.check()}transformByMatrix2(e){return function(e,t,n){const r=t[0],o=t[1];e[0]=n[0]*r+n[2]*o,e[1]=n[1]*r+n[3]*o,e[2]=t[2]}(this,this,e),this.check()}transformByQuaternion(e){return uR(this,this,e),this.check()}}class yR extends $I{static get ZERO(){return gR||(gR=new yR(0,0,0,0),Object.freeze(gR)),gR}constructor(e=0,t=0,n=0,r=0){super(-0,-0,-0,-0),NI(e)&&1===arguments.length?this.copy(e):(OI.debug&&(GI(e),GI(t),GI(n),GI(r)),this[0]=e,this[1]=t,this[2]=n,this[3]=r)}set(e,t,n,r){return this[0]=e,this[1]=t,this[2]=n,this[3]=r,this.check()}copy(e){return this[0]=e[0],this[1]=e[1],this[2]=e[2],this[3]=e[3],this.check()}fromObject(e){return OI.debug&&(GI(e.x),GI(e.y),GI(e.z),GI(e.w)),this[0]=e.x,this[1]=e.y,this[2]=e.z,this[3]=e.w,this}toObject(e){return e.x=this[0],e.y=this[1],e.z=this[2],e.w=this[3],e}get ELEMENTS(){return 4}get z(){return this[2]}set z(e){this[2]=GI(e)}get w(){return this[3]}set w(e){this[3]=GI(e)}transform(e){return lR(this,this,e),this.check()}transformByMatrix3(e){return nR(this,this,e),this.check()}transformByMatrix2(e){return function(e,t,n){const r=t[0],o=t[1];e[0]=n[0]*r+n[2]*o,e[1]=n[1]*r+n[3]*o,e[2]=t[2],e[3]=t[3]}(this,this,e),this.check()}transformByQuaternion(e){return uR(this,this,e),this.check()}applyMatrix4(e){return e.transform(this,this),this}}class vR extends HI{toString(){let e="[";if(OI.printRowMajor){e+="row-major:";for(let t=0;t<this.RANK;++t)for(let n=0;n<this.RANK;++n)e+=` ${this[n*this.RANK+t]}`}else{e+="column-major:";for(let t=0;t<this.ELEMENTS;++t)e+=` ${this[t]}`}return e+="]",e}getElementIndex(e,t){return t*this.RANK+e}getElement(e,t){return this[t*this.RANK+e]}setElement(e,t,n){return this[t*this.RANK+e]=GI(n),this}getColumn(e,t=new Array(this.RANK).fill(-0)){const n=e*this.RANK;for(let r=0;r<this.RANK;++r)t[r]=this[n+r];return t}setColumn(e,t){const n=e*this.RANK;for(let r=0;r<this.RANK;++r)this[n+r]=t[r];return this}}function bR(e,t,n){const r=t[0],o=t[1],i=t[2],s=t[3],a=t[4],l=t[5],c=t[6],u=t[7],d=t[8],A=n[0],h=n[1],p=n[2],f=n[3],g=n[4],m=n[5],y=n[6],v=n[7],b=n[8];return e[0]=A*r+h*s+p*c,e[1]=A*o+h*a+p*u,e[2]=A*i+h*l+p*d,e[3]=f*r+g*s+m*c,e[4]=f*o+g*a+m*u,e[5]=f*i+g*l+m*d,e[6]=y*r+v*s+b*c,e[7]=y*o+v*a+b*u,e[8]=y*i+v*l+b*d,e}function wR(e,t,n){const r=n[0],o=n[1];return e[0]=r*t[0],e[1]=r*t[1],e[2]=r*t[2],e[3]=o*t[3],e[4]=o*t[4],e[5]=o*t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e}var xR,_R;(_R=xR||(xR={}))[_R.COL0ROW0=0]="COL0ROW0",_R[_R.COL0ROW1=1]="COL0ROW1",_R[_R.COL0ROW2=2]="COL0ROW2",_R[_R.COL1ROW0=3]="COL1ROW0",_R[_R.COL1ROW1=4]="COL1ROW1",_R[_R.COL1ROW2=5]="COL1ROW2",_R[_R.COL2ROW0=6]="COL2ROW0",_R[_R.COL2ROW1=7]="COL2ROW1",_R[_R.COL2ROW2=8]="COL2ROW2";const CR=Object.freeze([1,0,0,0,1,0,0,0,1]);class SR extends vR{static get IDENTITY(){return function(){BR||(BR=new SR,Object.freeze(BR));return BR}()}static get ZERO(){return function(){ER||(ER=new SR([0,0,0,0,0,0,0,0,0]),Object.freeze(ER));return ER}()}get ELEMENTS(){return 9}get RANK(){return 3}get INDICES(){return xR}constructor(e,...t){super(-0,-0,-0,-0,-0,-0,-0,-0,-0),1===arguments.length&&Array.isArray(e)?this.copy(e):t.length>0?this.copy([e,...t]):this.identity()}copy(e){return this[0]=e[0],this[1]=e[1],this[2]=e[2],this[3]=e[3],this[4]=e[4],this[5]=e[5],this[6]=e[6],this[7]=e[7],this[8]=e[8],this.check()}identity(){return this.copy(CR)}fromObject(e){return this.check()}fromQuaternion(e){return function(e,t){const n=t[0],r=t[1],o=t[2],i=t[3],s=n+n,a=r+r,l=o+o,c=n*s,u=r*s,d=r*a,A=o*s,h=o*a,p=o*l,f=i*s,g=i*a,m=i*l;e[0]=1-d-p,e[3]=u-m,e[6]=A+g,e[1]=u+m,e[4]=1-c-p,e[7]=h-f,e[2]=A-g,e[5]=h+f,e[8]=1-c-d}(this,e),this.check()}set(e,t,n,r,o,i,s,a,l){return this[0]=e,this[1]=t,this[2]=n,this[3]=r,this[4]=o,this[5]=i,this[6]=s,this[7]=a,this[8]=l,this.check()}setRowMajor(e,t,n,r,o,i,s,a,l){return this[0]=e,this[1]=r,this[2]=s,this[3]=t,this[4]=o,this[5]=a,this[6]=n,this[7]=i,this[8]=l,this.check()}determinant(){return function(e){const t=e[0],n=e[1],r=e[2],o=e[3],i=e[4],s=e[5],a=e[6],l=e[7],c=e[8];return t*(c*i-s*l)+n*(-c*o+s*a)+r*(l*o-i*a)}(this)}transpose(){return function(e,t){if(e===t){const n=t[1],r=t[2],o=t[5];e[1]=t[3],e[2]=t[6],e[3]=n,e[5]=t[7],e[6]=r,e[7]=o}else e[0]=t[0],e[1]=t[3],e[2]=t[6],e[3]=t[1],e[4]=t[4],e[5]=t[7],e[6]=t[2],e[7]=t[5],e[8]=t[8]}(this,this),this.check()}invert(){return function(e,t){const n=t[0],r=t[1],o=t[2],i=t[3],s=t[4],a=t[5],l=t[6],c=t[7],u=t[8],d=u*s-a*c,A=-u*i+a*l,h=c*i-s*l;let p=n*d+r*A+o*h;p&&(p=1/p,e[0]=d*p,e[1]=(-u*r+o*c)*p,e[2]=(a*r-o*s)*p,e[3]=A*p,e[4]=(u*n-o*l)*p,e[5]=(-a*n+o*i)*p,e[6]=h*p,e[7]=(-c*n+r*l)*p,e[8]=(s*n-r*i)*p)}(this,this),this.check()}multiplyLeft(e){return bR(this,e,this),this.check()}multiplyRight(e){return bR(this,this,e),this.check()}rotate(e){return function(e,t,n){const r=t[0],o=t[1],i=t[2],s=t[3],a=t[4],l=t[5],c=t[6],u=t[7],d=t[8],A=Math.sin(n),h=Math.cos(n);e[0]=h*r+A*s,e[1]=h*o+A*a,e[2]=h*i+A*l,e[3]=h*s-A*r,e[4]=h*a-A*o,e[5]=h*l-A*i,e[6]=c,e[7]=u,e[8]=d}(this,this,e),this.check()}scale(e){return Array.isArray(e)?wR(this,this,e):wR(this,this,[e,e]),this.check()}translate(e){return function(e,t,n){const r=t[0],o=t[1],i=t[2],s=t[3],a=t[4],l=t[5],c=t[6],u=t[7],d=t[8],A=n[0],h=n[1];e[0]=r,e[1]=o,e[2]=i,e[3]=s,e[4]=a,e[5]=l,e[6]=A*r+h*s+c,e[7]=A*o+h*a+u,e[8]=A*i+h*l+d}(this,this,e),this.check()}transform(e,t){let n;switch(e.length){case 2:n=JI(t||[-0,-0],e,this);break;case 3:n=cR(t||[-0,-0,-0],e,this);break;case 4:n=nR(t||[-0,-0,-0,-0],e,this);break;default:throw new Error("Illegal vector")}return VI(n,e.length),n}transformVector(e,t){return this.transform(e,t)}transformVector2(e,t){return this.transform(e,t)}transformVector3(e,t){return this.transform(e,t)}}let ER,BR=null;function IR(e,t){const n=t[0],r=t[1],o=t[2],i=t[3],s=t[4],a=t[5],l=t[6],c=t[7],u=t[8],d=t[9],A=t[10],h=t[11],p=t[12],f=t[13],g=t[14],m=t[15],y=n*a-r*s,v=n*l-o*s,b=n*c-i*s,w=r*l-o*a,x=r*c-i*a,_=o*c-i*l,C=u*f-d*p,S=u*g-A*p,E=u*m-h*p,B=d*g-A*f,I=d*m-h*f,R=A*m-h*g;let k=y*R-v*I+b*B+w*E-x*S+_*C;return k?(k=1/k,e[0]=(a*R-l*I+c*B)*k,e[1]=(o*I-r*R-i*B)*k,e[2]=(f*_-g*x+m*w)*k,e[3]=(A*x-d*_-h*w)*k,e[4]=(l*E-s*R-c*S)*k,e[5]=(n*R-o*E+i*S)*k,e[6]=(g*b-p*_-m*v)*k,e[7]=(u*_-A*b+h*v)*k,e[8]=(s*I-a*E+c*C)*k,e[9]=(r*E-n*I-i*C)*k,e[10]=(p*x-f*b+m*y)*k,e[11]=(d*b-u*x-h*y)*k,e[12]=(a*S-s*B-l*C)*k,e[13]=(n*B-r*S+o*C)*k,e[14]=(f*v-p*w-g*y)*k,e[15]=(u*w-d*v+A*y)*k,e):null}function RR(e,t,n){const r=t[0],o=t[1],i=t[2],s=t[3],a=t[4],l=t[5],c=t[6],u=t[7],d=t[8],A=t[9],h=t[10],p=t[11],f=t[12],g=t[13],m=t[14],y=t[15];let v=n[0],b=n[1],w=n[2],x=n[3];return e[0]=v*r+b*a+w*d+x*f,e[1]=v*o+b*l+w*A+x*g,e[2]=v*i+b*c+w*h+x*m,e[3]=v*s+b*u+w*p+x*y,v=n[4],b=n[5],w=n[6],x=n[7],e[4]=v*r+b*a+w*d+x*f,e[5]=v*o+b*l+w*A+x*g,e[6]=v*i+b*c+w*h+x*m,e[7]=v*s+b*u+w*p+x*y,v=n[8],b=n[9],w=n[10],x=n[11],e[8]=v*r+b*a+w*d+x*f,e[9]=v*o+b*l+w*A+x*g,e[10]=v*i+b*c+w*h+x*m,e[11]=v*s+b*u+w*p+x*y,v=n[12],b=n[13],w=n[14],x=n[15],e[12]=v*r+b*a+w*d+x*f,e[13]=v*o+b*l+w*A+x*g,e[14]=v*i+b*c+w*h+x*m,e[15]=v*s+b*u+w*p+x*y,e}function kR(e,t,n){const r=n[0],o=n[1],i=n[2];let s,a,l,c,u,d,A,h,p,f,g,m;return t===e?(e[12]=t[0]*r+t[4]*o+t[8]*i+t[12],e[13]=t[1]*r+t[5]*o+t[9]*i+t[13],e[14]=t[2]*r+t[6]*o+t[10]*i+t[14],e[15]=t[3]*r+t[7]*o+t[11]*i+t[15]):(s=t[0],a=t[1],l=t[2],c=t[3],u=t[4],d=t[5],A=t[6],h=t[7],p=t[8],f=t[9],g=t[10],m=t[11],e[0]=s,e[1]=a,e[2]=l,e[3]=c,e[4]=u,e[5]=d,e[6]=A,e[7]=h,e[8]=p,e[9]=f,e[10]=g,e[11]=m,e[12]=s*r+u*o+p*i+t[12],e[13]=a*r+d*o+f*i+t[13],e[14]=l*r+A*o+g*i+t[14],e[15]=c*r+h*o+m*i+t[15]),e}function TR(e,t,n){const r=n[0],o=n[1],i=n[2];return e[0]=t[0]*r,e[1]=t[1]*r,e[2]=t[2]*r,e[3]=t[3]*r,e[4]=t[4]*o,e[5]=t[5]*o,e[6]=t[6]*o,e[7]=t[7]*o,e[8]=t[8]*i,e[9]=t[9]*i,e[10]=t[10]*i,e[11]=t[11]*i,e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e}function PR(e,t,n){const r=Math.sin(n),o=Math.cos(n),i=t[4],s=t[5],a=t[6],l=t[7],c=t[8],u=t[9],d=t[10],A=t[11];return t!==e&&(e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[4]=i*o+c*r,e[5]=s*o+u*r,e[6]=a*o+d*r,e[7]=l*o+A*r,e[8]=c*o-i*r,e[9]=u*o-s*r,e[10]=d*o-a*r,e[11]=A*o-l*r,e}function FR(e,t,n){const r=Math.sin(n),o=Math.cos(n),i=t[0],s=t[1],a=t[2],l=t[3],c=t[4],u=t[5],d=t[6],A=t[7];return t!==e&&(e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[0]=i*o+c*r,e[1]=s*o+u*r,e[2]=a*o+d*r,e[3]=l*o+A*r,e[4]=c*o-i*r,e[5]=u*o-s*r,e[6]=d*o-a*r,e[7]=A*o-l*r,e}const MR=function(e,t,n,r,o){const i=1/Math.tan(t/2);if(e[0]=i/n,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=i,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[11]=-1,e[12]=0,e[13]=0,e[15]=0,null!=o&&o!==1/0){const t=1/(r-o);e[10]=(o+r)*t,e[14]=2*o*r*t}else e[10]=-1,e[14]=-2*r;return e};const LR=function(e,t,n,r,o,i,s){const a=1/(t-n),l=1/(r-o),c=1/(i-s);return e[0]=-2*a,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=-2*l,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=2*c,e[11]=0,e[12]=(t+n)*a,e[13]=(o+r)*l,e[14]=(s+i)*c,e[15]=1,e};function UR(e,t,n){return e[0]=t[0]*n,e[1]=t[1]*n,e[2]=t[2]*n,e[3]=t[3]*n,e}function OR(e,t,n){const r=t[0],o=t[1],i=t[2],s=t[3];return e[0]=n[0]*r+n[4]*o+n[8]*i+n[12]*s,e[1]=n[1]*r+n[5]*o+n[9]*i+n[13]*s,e[2]=n[2]*r+n[6]*o+n[10]*i+n[14]*s,e[3]=n[3]*r+n[7]*o+n[11]*i+n[15]*s,e}var DR;!function(){const e=function(){const e=new XI(4);return XI!=Float32Array&&(e[0]=0,e[1]=0,e[2]=0,e[3]=0),e}()}(),function(e){e[e.COL0ROW0=0]="COL0ROW0",e[e.COL0ROW1=1]="COL0ROW1",e[e.COL0ROW2=2]="COL0ROW2",e[e.COL0ROW3=3]="COL0ROW3",e[e.COL1ROW0=4]="COL1ROW0",e[e.COL1ROW1=5]="COL1ROW1",e[e.COL1ROW2=6]="COL1ROW2",e[e.COL1ROW3=7]="COL1ROW3",e[e.COL2ROW0=8]="COL2ROW0",e[e.COL2ROW1=9]="COL2ROW1",e[e.COL2ROW2=10]="COL2ROW2",e[e.COL2ROW3=11]="COL2ROW3",e[e.COL3ROW0=12]="COL3ROW0",e[e.COL3ROW1=13]="COL3ROW1",e[e.COL3ROW2=14]="COL3ROW2",e[e.COL3ROW3=15]="COL3ROW3"}(DR||(DR={}));const NR=45*Math.PI/180,jR=1,QR=.1,zR=500,HR=Object.freeze([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]);class GR extends vR{static get IDENTITY(){return function(){WR||(WR=new GR,Object.freeze(WR));return WR}()}static get ZERO(){return function(){VR||(VR=new GR([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),Object.freeze(VR));return VR}()}get ELEMENTS(){return 16}get RANK(){return 4}get INDICES(){return DR}constructor(e){super(-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0),1===arguments.length&&Array.isArray(e)?this.copy(e):this.identity()}copy(e){return this[0]=e[0],this[1]=e[1],this[2]=e[2],this[3]=e[3],this[4]=e[4],this[5]=e[5],this[6]=e[6],this[7]=e[7],this[8]=e[8],this[9]=e[9],this[10]=e[10],this[11]=e[11],this[12]=e[12],this[13]=e[13],this[14]=e[14],this[15]=e[15],this.check()}set(e,t,n,r,o,i,s,a,l,c,u,d,A,h,p,f){return this[0]=e,this[1]=t,this[2]=n,this[3]=r,this[4]=o,this[5]=i,this[6]=s,this[7]=a,this[8]=l,this[9]=c,this[10]=u,this[11]=d,this[12]=A,this[13]=h,this[14]=p,this[15]=f,this.check()}setRowMajor(e,t,n,r,o,i,s,a,l,c,u,d,A,h,p,f){return this[0]=e,this[1]=o,this[2]=l,this[3]=A,this[4]=t,this[5]=i,this[6]=c,this[7]=h,this[8]=n,this[9]=s,this[10]=u,this[11]=p,this[12]=r,this[13]=a,this[14]=d,this[15]=f,this.check()}toRowMajor(e){return e[0]=this[0],e[1]=this[4],e[2]=this[8],e[3]=this[12],e[4]=this[1],e[5]=this[5],e[6]=this[9],e[7]=this[13],e[8]=this[2],e[9]=this[6],e[10]=this[10],e[11]=this[14],e[12]=this[3],e[13]=this[7],e[14]=this[11],e[15]=this[15],e}identity(){return this.copy(HR)}fromObject(e){return this.check()}fromQuaternion(e){return function(e,t){const n=t[0],r=t[1],o=t[2],i=t[3],s=n+n,a=r+r,l=o+o,c=n*s,u=r*s,d=r*a,A=o*s,h=o*a,p=o*l,f=i*s,g=i*a,m=i*l;e[0]=1-d-p,e[1]=u+m,e[2]=A-g,e[3]=0,e[4]=u-m,e[5]=1-c-p,e[6]=h+f,e[7]=0,e[8]=A+g,e[9]=h-f,e[10]=1-c-d,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1}(this,e),this.check()}frustum(e){const{left:t,right:n,bottom:r,top:o,near:i=QR,far:s=zR}=e;return s===1/0?function(e,t,n,r,o,i){const s=2*i/(n-t),a=2*i/(o-r),l=(n+t)/(n-t),c=(o+r)/(o-r),u=-1,d=-1,A=-2*i;e[0]=s,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=a,e[6]=0,e[7]=0,e[8]=l,e[9]=c,e[10]=u,e[11]=d,e[12]=0,e[13]=0,e[14]=A,e[15]=0}(this,t,n,r,o,i):function(e,t,n,r,o,i,s){const a=1/(n-t),l=1/(o-r),c=1/(i-s);e[0]=2*i*a,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=2*i*l,e[6]=0,e[7]=0,e[8]=(n+t)*a,e[9]=(o+r)*l,e[10]=(s+i)*c,e[11]=-1,e[12]=0,e[13]=0,e[14]=s*i*2*c,e[15]=0}(this,t,n,r,o,i,s),this.check()}lookAt(e){const{eye:t,center:n=[0,0,0],up:r=[0,1,0]}=e;return function(e,t,n,r){let o,i,s,a,l,c,u,d,A,h;const p=t[0],f=t[1],g=t[2],m=r[0],y=r[1],v=r[2],b=n[0],w=n[1],x=n[2];Math.abs(p-b)<KI&&Math.abs(f-w)<KI&&Math.abs(g-x)<KI?function(e){e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1}(e):(d=p-b,A=f-w,h=g-x,o=1/Math.sqrt(d*d+A*A+h*h),d*=o,A*=o,h*=o,i=y*h-v*A,s=v*d-m*h,a=m*A-y*d,o=Math.sqrt(i*i+s*s+a*a),o?(o=1/o,i*=o,s*=o,a*=o):(i=0,s=0,a=0),l=A*a-h*s,c=h*i-d*a,u=d*s-A*i,o=Math.sqrt(l*l+c*c+u*u),o?(o=1/o,l*=o,c*=o,u*=o):(l=0,c=0,u=0),e[0]=i,e[1]=l,e[2]=d,e[3]=0,e[4]=s,e[5]=c,e[6]=A,e[7]=0,e[8]=a,e[9]=u,e[10]=h,e[11]=0,e[12]=-(i*p+s*f+a*g),e[13]=-(l*p+c*f+u*g),e[14]=-(d*p+A*f+h*g),e[15]=1)}(this,t,n,r),this.check()}ortho(e){const{left:t,right:n,bottom:r,top:o,near:i=QR,far:s=zR}=e;return LR(this,t,n,r,o,i,s),this.check()}orthographic(e){const{fovy:t=NR,aspect:n=jR,focalDistance:r=1,near:o=QR,far:i=zR}=e;$R(t);const s=t/2,a=r*Math.tan(s),l=a*n;return this.ortho({left:-l,right:l,bottom:-a,top:a,near:o,far:i})}perspective(e){const{fovy:t=45*Math.PI/180,aspect:n=1,near:r=.1,far:o=500}=e;return $R(t),MR(this,t,n,r,o),this.check()}determinant(){return function(e){const t=e[0],n=e[1],r=e[2],o=e[3],i=e[4],s=e[5],a=e[6],l=e[7],c=e[8],u=e[9],d=e[10],A=e[11],h=e[12],p=e[13],f=e[14],g=t*s-n*i,m=t*a-r*i,y=n*a-r*s,v=c*p-u*h,b=c*f-d*h,w=u*f-d*p;return l*(t*w-n*b+r*v)-o*(i*w-s*b+a*v)+e[15]*(c*y-u*m+d*g)-A*(h*y-p*m+f*g)}(this)}getScale(e=[-0,-0,-0]){return e[0]=Math.sqrt(this[0]*this[0]+this[1]*this[1]+this[2]*this[2]),e[1]=Math.sqrt(this[4]*this[4]+this[5]*this[5]+this[6]*this[6]),e[2]=Math.sqrt(this[8]*this[8]+this[9]*this[9]+this[10]*this[10]),e}getTranslation(e=[-0,-0,-0]){return e[0]=this[12],e[1]=this[13],e[2]=this[14],e}getRotation(e,t){e=e||[-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0],t=t||[-0,-0,-0];const n=this.getScale(t),r=1/n[0],o=1/n[1],i=1/n[2];return e[0]=this[0]*r,e[1]=this[1]*o,e[2]=this[2]*i,e[3]=0,e[4]=this[4]*r,e[5]=this[5]*o,e[6]=this[6]*i,e[7]=0,e[8]=this[8]*r,e[9]=this[9]*o,e[10]=this[10]*i,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}getRotationMatrix3(e,t){e=e||[-0,-0,-0,-0,-0,-0,-0,-0,-0],t=t||[-0,-0,-0];const n=this.getScale(t),r=1/n[0],o=1/n[1],i=1/n[2];return e[0]=this[0]*r,e[1]=this[1]*o,e[2]=this[2]*i,e[3]=this[4]*r,e[4]=this[5]*o,e[5]=this[6]*i,e[6]=this[8]*r,e[7]=this[9]*o,e[8]=this[10]*i,e}transpose(){return function(e,t){if(e===t){const n=t[1],r=t[2],o=t[3],i=t[6],s=t[7],a=t[11];e[1]=t[4],e[2]=t[8],e[3]=t[12],e[4]=n,e[6]=t[9],e[7]=t[13],e[8]=r,e[9]=i,e[11]=t[14],e[12]=o,e[13]=s,e[14]=a}else e[0]=t[0],e[1]=t[4],e[2]=t[8],e[3]=t[12],e[4]=t[1],e[5]=t[5],e[6]=t[9],e[7]=t[13],e[8]=t[2],e[9]=t[6],e[10]=t[10],e[11]=t[14],e[12]=t[3],e[13]=t[7],e[14]=t[11],e[15]=t[15]}(this,this),this.check()}invert(){return IR(this,this),this.check()}multiplyLeft(e){return RR(this,e,this),this.check()}multiplyRight(e){return RR(this,this,e),this.check()}rotateX(e){return PR(this,this,e),this.check()}rotateY(e){return function(e,t,n){const r=Math.sin(n),o=Math.cos(n),i=t[0],s=t[1],a=t[2],l=t[3],c=t[8],u=t[9],d=t[10],A=t[11];t!==e&&(e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[0]=i*o-c*r,e[1]=s*o-u*r,e[2]=a*o-d*r,e[3]=l*o-A*r,e[8]=i*r+c*o,e[9]=s*r+u*o,e[10]=a*r+d*o,e[11]=l*r+A*o}(this,this,e),this.check()}rotateZ(e){return FR(this,this,e),this.check()}rotateXYZ(e){return this.rotateX(e[0]).rotateY(e[1]).rotateZ(e[2])}rotateAxis(e,t){return function(e,t,n,r){let o,i,s,a,l,c,u,d,A,h,p,f,g,m,y,v,b,w,x,_,C,S,E,B,I=r[0],R=r[1],k=r[2],T=Math.sqrt(I*I+R*R+k*k);T<KI||(T=1/T,I*=T,R*=T,k*=T,i=Math.sin(n),o=Math.cos(n),s=1-o,a=t[0],l=t[1],c=t[2],u=t[3],d=t[4],A=t[5],h=t[6],p=t[7],f=t[8],g=t[9],m=t[10],y=t[11],v=I*I*s+o,b=R*I*s+k*i,w=k*I*s-R*i,x=I*R*s-k*i,_=R*R*s+o,C=k*R*s+I*i,S=I*k*s+R*i,E=R*k*s-I*i,B=k*k*s+o,e[0]=a*v+d*b+f*w,e[1]=l*v+A*b+g*w,e[2]=c*v+h*b+m*w,e[3]=u*v+p*b+y*w,e[4]=a*x+d*_+f*C,e[5]=l*x+A*_+g*C,e[6]=c*x+h*_+m*C,e[7]=u*x+p*_+y*C,e[8]=a*S+d*E+f*B,e[9]=l*S+A*E+g*B,e[10]=c*S+h*E+m*B,e[11]=u*S+p*E+y*B,t!==e&&(e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]))}(this,this,e,t),this.check()}scale(e){return TR(this,this,Array.isArray(e)?e:[e,e,e]),this.check()}translate(e){return kR(this,this,e),this.check()}transform(e,t){return 4===e.length?(VI(t=OR(t||[-0,-0,-0,-0],e,this),4),t):this.transformAsPoint(e,t)}transformAsPoint(e,t){const{length:n}=e;let r;switch(n){case 2:r=ZI(t||[-0,-0],e,this);break;case 3:r=lR(t||[-0,-0,-0],e,this);break;default:throw new Error("Illegal vector")}return VI(r,e.length),r}transformAsVector(e,t){let n;switch(e.length){case 2:n=eR(t||[-0,-0],e,this);break;case 3:n=tR(t||[-0,-0,-0],e,this);break;default:throw new Error("Illegal vector")}return VI(n,e.length),n}transformPoint(e,t){return this.transformAsPoint(e,t)}transformVector(e,t){return this.transformAsPoint(e,t)}transformDirection(e,t){return this.transformAsVector(e,t)}makeRotationX(e){return this.identity().rotateX(e)}makeTranslation(e,t,n){return this.identity().translate([e,t,n])}}let VR,WR;function $R(e){if(e>2*Math.PI)throw Error("expected radians")}function KR(){const e=new XI(4);return XI!=Float32Array&&(e[0]=0,e[1]=0,e[2]=0),e[3]=1,e}function XR(e,t,n){n*=.5;const r=Math.sin(n);return e[0]=r*t[0],e[1]=r*t[1],e[2]=r*t[2],e[3]=Math.cos(n),e}function YR(e,t,n){const r=t[0],o=t[1],i=t[2],s=t[3],a=n[0],l=n[1],c=n[2],u=n[3];return e[0]=r*u+s*a+o*c-i*l,e[1]=o*u+s*l+i*a-r*c,e[2]=i*u+s*c+r*l-o*a,e[3]=s*u-r*a-o*l-i*c,e}function qR(e,t,n,r){const o=t[0],i=t[1],s=t[2],a=t[3];let l,c,u,d,A,h=n[0],p=n[1],f=n[2],g=n[3];return l=o*h+i*p+s*f+a*g,l<0&&(l=-l,h=-h,p=-p,f=-f,g=-g),1-l>KI?(c=Math.acos(l),A=Math.sin(c),u=Math.sin((1-r)*c)/A,d=Math.sin(r*c)/A):(u=1-r,d=r),e[0]=u*o+d*h,e[1]=u*i+d*p,e[2]=u*s+d*f,e[3]=u*a+d*g,e}function JR(e,t){const n=t[0]+t[4]+t[8];let r;if(n>0)r=Math.sqrt(n+1),e[3]=.5*r,r=.5/r,e[0]=(t[5]-t[7])*r,e[1]=(t[6]-t[2])*r,e[2]=(t[1]-t[3])*r;else{let n=0;t[4]>t[0]&&(n=1),t[8]>t[3*n+n]&&(n=2);const o=(n+1)%3,i=(n+2)%3;r=Math.sqrt(t[3*n+n]-t[3*o+o]-t[3*i+i]+1),e[n]=.5*r,r=.5/r,e[3]=(t[3*o+i]-t[3*i+o])*r,e[o]=(t[3*o+n]+t[3*n+o])*r,e[i]=(t[3*i+n]+t[3*n+i])*r}return e}const ZR=function(e,t,n){return e[0]=t[0]+n[0],e[1]=t[1]+n[1],e[2]=t[2]+n[2],e[3]=t[3]+n[3],e},ek=UR,tk=function(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]+e[3]*t[3]},nk=function(e,t,n,r){const o=t[0],i=t[1],s=t[2],a=t[3];return e[0]=o+r*(n[0]-o),e[1]=i+r*(n[1]-i),e[2]=s+r*(n[2]-s),e[3]=a+r*(n[3]-a),e},rk=function(e){const t=e[0],n=e[1],r=e[2],o=e[3];return Math.sqrt(t*t+n*n+r*r+o*o)},ok=function(e){const t=e[0],n=e[1],r=e[2],o=e[3];return t*t+n*n+r*r+o*o},ik=function(e,t){const n=t[0],r=t[1],o=t[2],i=t[3];let s=n*n+r*r+o*o+i*i;return s>0&&(s=1/Math.sqrt(s)),e[0]=n*s,e[1]=r*s,e[2]=o*s,e[3]=i*s,e},sk=function(){const e=oR(),t=iR(1,0,0),n=iR(0,1,0);return function(r,o,i){const s=sR(o,i);return s<-.999999?(aR(e,t,o),AR(e)<1e-6&&aR(e,n,o),function(e,t){const n=t[0],r=t[1],o=t[2];let i=n*n+r*r+o*o;i>0&&(i=1/Math.sqrt(i)),e[0]=t[0]*i,e[1]=t[1]*i,e[2]=t[2]*i}(e,e),XR(r,e,Math.PI),r):s>.999999?(r[0]=0,r[1]=0,r[2]=0,r[3]=1,r):(aR(e,o,i),r[0]=e[0],r[1]=e[1],r[2]=e[2],r[3]=1+s,ik(r,r))}}();!function(){const e=KR(),t=KR()}(),function(){const e=function(){const e=new XI(9);return XI!=Float32Array&&(e[1]=0,e[2]=0,e[3]=0,e[5]=0,e[6]=0,e[7]=0),e[0]=1,e[4]=1,e[8]=1,e}()}();const ak=[0,0,0,1];class lk extends HI{constructor(e=0,t=0,n=0,r=1){super(-0,-0,-0,-0),Array.isArray(e)&&1===arguments.length?this.copy(e):this.set(e,t,n,r)}copy(e){return this[0]=e[0],this[1]=e[1],this[2]=e[2],this[3]=e[3],this.check()}set(e,t,n,r){return this[0]=e,this[1]=t,this[2]=n,this[3]=r,this.check()}fromObject(e){return this[0]=e.x,this[1]=e.y,this[2]=e.z,this[3]=e.w,this.check()}fromMatrix3(e){return JR(this,e),this.check()}fromAxisRotation(e,t){return XR(this,e,t),this.check()}identity(){var e;return(e=this)[0]=0,e[1]=0,e[2]=0,e[3]=1,this.check()}setAxisAngle(e,t){return this.fromAxisRotation(e,t)}get ELEMENTS(){return 4}get x(){return this[0]}set x(e){this[0]=GI(e)}get y(){return this[1]}set y(e){this[1]=GI(e)}get z(){return this[2]}set z(e){this[2]=GI(e)}get w(){return this[3]}set w(e){this[3]=GI(e)}len(){return rk(this)}lengthSquared(){return ok(this)}dot(e){return tk(this,e)}rotationTo(e,t){return sk(this,e,t),this.check()}add(e){return ZR(this,this,e),this.check()}calculateW(){return function(e,t){const n=t[0],r=t[1],o=t[2];e[0]=n,e[1]=r,e[2]=o,e[3]=Math.sqrt(Math.abs(1-n*n-r*r-o*o))}(this,this),this.check()}conjugate(){var e,t;return t=this,(e=this)[0]=-t[0],e[1]=-t[1],e[2]=-t[2],e[3]=t[3],this.check()}invert(){return function(e,t){const n=t[0],r=t[1],o=t[2],i=t[3],s=n*n+r*r+o*o+i*i,a=s?1/s:0;e[0]=-n*a,e[1]=-r*a,e[2]=-o*a,e[3]=i*a}(this,this),this.check()}lerp(e,t,n){return void 0===n?this.lerp(this,e,t):(nk(this,e,t,n),this.check())}multiplyRight(e){return YR(this,this,e),this.check()}multiplyLeft(e){return YR(this,e,this),this.check()}normalize(){const e=this.len(),t=e>0?1/e:0;return this[0]=this[0]*t,this[1]=this[1]*t,this[2]=this[2]*t,this[3]=this[3]*t,0===e&&(this[3]=1),this.check()}rotateX(e){return function(e,t,n){n*=.5;const r=t[0],o=t[1],i=t[2],s=t[3],a=Math.sin(n),l=Math.cos(n);e[0]=r*l+s*a,e[1]=o*l+i*a,e[2]=i*l-o*a,e[3]=s*l-r*a}(this,this,e),this.check()}rotateY(e){return function(e,t,n){n*=.5;const r=t[0],o=t[1],i=t[2],s=t[3],a=Math.sin(n),l=Math.cos(n);e[0]=r*l-i*a,e[1]=o*l+s*a,e[2]=i*l+r*a,e[3]=s*l-o*a}(this,this,e),this.check()}rotateZ(e){return function(e,t,n){n*=.5;const r=t[0],o=t[1],i=t[2],s=t[3],a=Math.sin(n),l=Math.cos(n);e[0]=r*l+o*a,e[1]=o*l-r*a,e[2]=i*l+s*a,e[3]=s*l-i*a}(this,this,e),this.check()}scale(e){return ek(this,this,e),this.check()}slerp(e,t,n){let r,o,i;switch(arguments.length){case 1:({start:r=ak,target:o,ratio:i}=e);break;case 2:r=this,o=e,i=t;break;default:r=e,o=t,i=n}return qR(this,r,o,i),this.check()}transformVector4(e,t=new yR){return function(e,t,n){const r=t[0],o=t[1],i=t[2],s=n[0],a=n[1],l=n[2],c=n[3],u=c*r+a*i-l*o,d=c*o+l*r-s*i,A=c*i+s*o-a*r,h=-s*r-a*o-l*i;e[0]=u*c+h*-s+d*-l-A*-a,e[1]=d*c+h*-a+A*-s-u*-l,e[2]=A*c+h*-l+u*-a-d*-s,e[3]=t[3]}(t,e,this),VI(t,4)}lengthSq(){return this.lengthSquared()}setFromAxisAngle(e,t){return this.setAxisAngle(e,t)}premultiply(e){return this.multiplyLeft(e)}multiply(e){return this.multiplyRight(e)}}function ck(e,t=[],n=0){const r=Math.fround(e),o=e-r;return t[n]=r,t[n+1]=o,t}const uk={name:"fp32",vs:"#ifdef LUMA_FP32_TAN_PRECISION_WORKAROUND\n\n// All these functions are for substituting tan() function from Intel GPU only\nconst float TWO_PI = 6.2831854820251465;\nconst float PI_2 = 1.5707963705062866;\nconst float PI_16 = 0.1963495463132858;\n\nconst float SIN_TABLE_0 = 0.19509032368659973;\nconst float SIN_TABLE_1 = 0.3826834261417389;\nconst float SIN_TABLE_2 = 0.5555702447891235;\nconst float SIN_TABLE_3 = 0.7071067690849304;\n\nconst float COS_TABLE_0 = 0.9807852506637573;\nconst float COS_TABLE_1 = 0.9238795042037964;\nconst float COS_TABLE_2 = 0.8314695954322815;\nconst float COS_TABLE_3 = 0.7071067690849304;\n\nconst float INVERSE_FACTORIAL_3 = 1.666666716337204e-01; // 1/3!\nconst float INVERSE_FACTORIAL_5 = 8.333333767950535e-03; // 1/5!\nconst float INVERSE_FACTORIAL_7 = 1.9841270113829523e-04; // 1/7!\nconst float INVERSE_FACTORIAL_9 = 2.75573188446287533e-06; // 1/9!\n\nfloat sin_taylor_fp32(float a) {\n  float r, s, t, x;\n\n  if (a == 0.0) {\n    return 0.0;\n  }\n\n  x = -a * a;\n  s = a;\n  r = a;\n\n  r = r * x;\n  t = r * INVERSE_FACTORIAL_3;\n  s = s + t;\n\n  r = r * x;\n  t = r * INVERSE_FACTORIAL_5;\n  s = s + t;\n\n  r = r * x;\n  t = r * INVERSE_FACTORIAL_7;\n  s = s + t;\n\n  r = r * x;\n  t = r * INVERSE_FACTORIAL_9;\n  s = s + t;\n\n  return s;\n}\n\nvoid sincos_taylor_fp32(float a, out float sin_t, out float cos_t) {\n  if (a == 0.0) {\n    sin_t = 0.0;\n    cos_t = 1.0;\n  }\n  sin_t = sin_taylor_fp32(a);\n  cos_t = sqrt(1.0 - sin_t * sin_t);\n}\n\nfloat tan_taylor_fp32(float a) {\n    float sin_a;\n    float cos_a;\n\n    if (a == 0.0) {\n        return 0.0;\n    }\n\n    // 2pi range reduction\n    float z = floor(a / TWO_PI);\n    float r = a - TWO_PI * z;\n\n    float t;\n    float q = floor(r / PI_2 + 0.5);\n    int j = int(q);\n\n    if (j < -2 || j > 2) {\n        return 1.0 / 0.0;\n    }\n\n    t = r - PI_2 * q;\n\n    q = floor(t / PI_16 + 0.5);\n    int k = int(q);\n    int abs_k = int(abs(float(k)));\n\n    if (abs_k > 4) {\n        return 1.0 / 0.0;\n    } else {\n        t = t - PI_16 * q;\n    }\n\n    float u = 0.0;\n    float v = 0.0;\n\n    float sin_t, cos_t;\n    float s, c;\n    sincos_taylor_fp32(t, sin_t, cos_t);\n\n    if (k == 0) {\n        s = sin_t;\n        c = cos_t;\n    } else {\n        if (abs(float(abs_k) - 1.0) < 0.5) {\n            u = COS_TABLE_0;\n            v = SIN_TABLE_0;\n        } else if (abs(float(abs_k) - 2.0) < 0.5) {\n            u = COS_TABLE_1;\n            v = SIN_TABLE_1;\n        } else if (abs(float(abs_k) - 3.0) < 0.5) {\n            u = COS_TABLE_2;\n            v = SIN_TABLE_2;\n        } else if (abs(float(abs_k) - 4.0) < 0.5) {\n            u = COS_TABLE_3;\n            v = SIN_TABLE_3;\n        }\n        if (k > 0) {\n            s = u * sin_t + v * cos_t;\n            c = u * cos_t - v * sin_t;\n        } else {\n            s = u * sin_t - v * cos_t;\n            c = u * cos_t + v * sin_t;\n        }\n    }\n\n    if (j == 0) {\n        sin_a = s;\n        cos_a = c;\n    } else if (j == 1) {\n        sin_a = c;\n        cos_a = -s;\n    } else if (j == -1) {\n        sin_a = -c;\n        cos_a = s;\n    } else {\n        sin_a = -s;\n        cos_a = -c;\n    }\n    return sin_a / cos_a;\n}\n#endif\n\nfloat tan_fp32(float a) {\n#ifdef LUMA_FP32_TAN_PRECISION_WORKAROUND\n  return tan_taylor_fp32(a);\n#else\n  return tan(a);\n#endif\n}\n"},dk={name:"fp64arithmetic",vs:"\nuniform fp64arithmeticUniforms {\n  uniform float ONE;\n} fp64;\n\n/*\nAbout LUMA_FP64_CODE_ELIMINATION_WORKAROUND\n\nThe purpose of this workaround is to prevent shader compilers from\noptimizing away necessary arithmetic operations by swapping their sequences\nor transform the equation to some 'equivalent' form.\n\nThe method is to multiply an artifical variable, ONE, which will be known to\nthe compiler to be 1 only at runtime. The whole expression is then represented\nas a polynomial with respective to ONE. In the coefficients of all terms, only one a\nand one b should appear\n\nerr = (a + b) * ONE^6 - a * ONE^5 - (a + b) * ONE^4 + a * ONE^3 - b - (a + b) * ONE^2 + a * ONE\n*/\n\n// Divide float number to high and low floats to extend fraction bits\nvec2 split(float a) {\n  const float SPLIT = 4097.0;\n  float t = a * SPLIT;\n#if defined(LUMA_FP64_CODE_ELIMINATION_WORKAROUND)\n  float a_hi = t * fp64.ONE - (t - a);\n  float a_lo = a * fp64.ONE - a_hi;\n#else\n  float a_hi = t - (t - a);\n  float a_lo = a - a_hi;\n#endif\n  return vec2(a_hi, a_lo);\n}\n\n// Divide float number again when high float uses too many fraction bits\nvec2 split2(vec2 a) {\n  vec2 b = split(a.x);\n  b.y += a.y;\n  return b;\n}\n\n// Special sum operation when a > b\nvec2 quickTwoSum(float a, float b) {\n#if defined(LUMA_FP64_CODE_ELIMINATION_WORKAROUND)\n  float sum = (a + b) * fp64.ONE;\n  float err = b - (sum - a) * fp64.ONE;\n#else\n  float sum = a + b;\n  float err = b - (sum - a);\n#endif\n  return vec2(sum, err);\n}\n\n// General sum operation\nvec2 twoSum(float a, float b) {\n  float s = (a + b);\n#if defined(LUMA_FP64_CODE_ELIMINATION_WORKAROUND)\n  float v = (s * fp64.ONE - a) * fp64.ONE;\n  float err = (a - (s - v) * fp64.ONE) * fp64.ONE * fp64.ONE * fp64.ONE + (b - v);\n#else\n  float v = s - a;\n  float err = (a - (s - v)) + (b - v);\n#endif\n  return vec2(s, err);\n}\n\nvec2 twoSub(float a, float b) {\n  float s = (a - b);\n#if defined(LUMA_FP64_CODE_ELIMINATION_WORKAROUND)\n  float v = (s * fp64.ONE - a) * fp64.ONE;\n  float err = (a - (s - v) * fp64.ONE) * fp64.ONE * fp64.ONE * fp64.ONE - (b + v);\n#else\n  float v = s - a;\n  float err = (a - (s - v)) - (b + v);\n#endif\n  return vec2(s, err);\n}\n\nvec2 twoSqr(float a) {\n  float prod = a * a;\n  vec2 a_fp64 = split(a);\n#if defined(LUMA_FP64_CODE_ELIMINATION_WORKAROUND)\n  float err = ((a_fp64.x * a_fp64.x - prod) * fp64.ONE + 2.0 * a_fp64.x *\n    a_fp64.y * fp64.ONE * fp64.ONE) + a_fp64.y * a_fp64.y * fp64.ONE * fp64.ONE * fp64.ONE;\n#else\n  float err = ((a_fp64.x * a_fp64.x - prod) + 2.0 * a_fp64.x * a_fp64.y) + a_fp64.y * a_fp64.y;\n#endif\n  return vec2(prod, err);\n}\n\nvec2 twoProd(float a, float b) {\n  float prod = a * b;\n  vec2 a_fp64 = split(a);\n  vec2 b_fp64 = split(b);\n  float err = ((a_fp64.x * b_fp64.x - prod) + a_fp64.x * b_fp64.y +\n    a_fp64.y * b_fp64.x) + a_fp64.y * b_fp64.y;\n  return vec2(prod, err);\n}\n\nvec2 sum_fp64(vec2 a, vec2 b) {\n  vec2 s, t;\n  s = twoSum(a.x, b.x);\n  t = twoSum(a.y, b.y);\n  s.y += t.x;\n  s = quickTwoSum(s.x, s.y);\n  s.y += t.y;\n  s = quickTwoSum(s.x, s.y);\n  return s;\n}\n\nvec2 sub_fp64(vec2 a, vec2 b) {\n  vec2 s, t;\n  s = twoSub(a.x, b.x);\n  t = twoSub(a.y, b.y);\n  s.y += t.x;\n  s = quickTwoSum(s.x, s.y);\n  s.y += t.y;\n  s = quickTwoSum(s.x, s.y);\n  return s;\n}\n\nvec2 mul_fp64(vec2 a, vec2 b) {\n  vec2 prod = twoProd(a.x, b.x);\n  // y component is for the error\n  prod.y += a.x * b.y;\n#if defined(LUMA_FP64_HIGH_BITS_OVERFLOW_WORKAROUND)\n  prod = split2(prod);\n#endif\n  prod = quickTwoSum(prod.x, prod.y);\n  prod.y += a.y * b.x;\n#if defined(LUMA_FP64_HIGH_BITS_OVERFLOW_WORKAROUND)\n  prod = split2(prod);\n#endif\n  prod = quickTwoSum(prod.x, prod.y);\n  return prod;\n}\n\nvec2 div_fp64(vec2 a, vec2 b) {\n  float xn = 1.0 / b.x;\n#if defined(LUMA_FP64_HIGH_BITS_OVERFLOW_WORKAROUND)\n  vec2 yn = mul_fp64(a, vec2(xn, 0));\n#else\n  vec2 yn = a * xn;\n#endif\n  float diff = (sub_fp64(a, mul_fp64(b, yn))).x;\n  vec2 prod = twoProd(xn, diff);\n  return sum_fp64(yn, prod);\n}\n\nvec2 sqrt_fp64(vec2 a) {\n  if (a.x == 0.0 && a.y == 0.0) return vec2(0.0, 0.0);\n  if (a.x < 0.0) return vec2(0.0 / 0.0, 0.0 / 0.0);\n\n  float x = 1.0 / sqrt(a.x);\n  float yn = a.x * x;\n#if defined(LUMA_FP64_CODE_ELIMINATION_WORKAROUND)\n  vec2 yn_sqr = twoSqr(yn) * fp64.ONE;\n#else\n  vec2 yn_sqr = twoSqr(yn);\n#endif\n  float diff = sub_fp64(a, yn_sqr).x;\n  vec2 prod = twoProd(x * 0.5, diff);\n#if defined(LUMA_FP64_HIGH_BITS_OVERFLOW_WORKAROUND)\n  return sum_fp64(split(yn), prod);\n#else\n  return sum_fp64(vec2(yn, 0.0), prod);\n#endif\n}\n",defaultUniforms:{ONE:1},uniformTypes:{ONE:"f32"},fp64ify:ck,fp64LowPart:function(e){return e-Math.fround(e)},fp64ifyMatrix4:function(e){const t=new Float32Array(32);for(let n=0;n<4;++n)for(let r=0;r<4;++r){const o=4*n+r;ck(e[4*r+n],t,2*o)}return t}},Ak={props:{},uniforms:{},name:"picking",uniformTypes:{isActive:"f32",isAttribute:"f32",isHighlightActive:"f32",useFloatColors:"f32",highlightedObjectColor:"vec3<f32>",highlightColor:"vec4<f32>"},defaultUniforms:{isActive:!1,isAttribute:!1,isHighlightActive:!1,useFloatColors:!0,highlightedObjectColor:[0,0,0],highlightColor:[0,1,1,1]},vs:"uniform pickingUniforms {\n  float isActive;\n  float isAttribute;\n  float isHighlightActive;\n  float useFloatColors;\n  vec3 highlightedObjectColor;\n  vec4 highlightColor;\n} picking;\n\nout vec4 picking_vRGBcolor_Avalid;\n\n// Normalize unsigned byte color to 0-1 range\nvec3 picking_normalizeColor(vec3 color) {\n  return picking.useFloatColors > 0.5 ? color : color / 255.0;\n}\n\n// Normalize unsigned byte color to 0-1 range\nvec4 picking_normalizeColor(vec4 color) {\n  return picking.useFloatColors > 0.5 ? color : color / 255.0;\n}\n\nbool picking_isColorZero(vec3 color) {\n  return dot(color, vec3(1.0)) < 0.00001;\n}\n\nbool picking_isColorValid(vec3 color) {\n  return dot(color, vec3(1.0)) > 0.00001;\n}\n\n// Check if this vertex is highlighted \nbool isVertexHighlighted(vec3 vertexColor) {\n  vec3 highlightedObjectColor = picking_normalizeColor(picking.highlightedObjectColor);\n  return\n    bool(picking.isHighlightActive) && picking_isColorZero(abs(vertexColor - highlightedObjectColor));\n}\n\n// Set the current picking color\nvoid picking_setPickingColor(vec3 pickingColor) {\n  pickingColor = picking_normalizeColor(pickingColor);\n\n  if (bool(picking.isActive)) {\n    // Use alpha as the validity flag. If pickingColor is [0, 0, 0] fragment is non-pickable\n    picking_vRGBcolor_Avalid.a = float(picking_isColorValid(pickingColor));\n\n    if (!bool(picking.isAttribute)) {\n      // Stores the picking color so that the fragment shader can render it during picking\n      picking_vRGBcolor_Avalid.rgb = pickingColor;\n    }\n  } else {\n    // Do the comparison with selected item color in vertex shader as it should mean fewer compares\n    picking_vRGBcolor_Avalid.a = float(isVertexHighlighted(pickingColor));\n  }\n}\n\nvoid picking_setPickingAttribute(float value) {\n  if (bool(picking.isAttribute)) {\n    picking_vRGBcolor_Avalid.r = value;\n  }\n}\n\nvoid picking_setPickingAttribute(vec2 value) {\n  if (bool(picking.isAttribute)) {\n    picking_vRGBcolor_Avalid.rg = value;\n  }\n}\n\nvoid picking_setPickingAttribute(vec3 value) {\n  if (bool(picking.isAttribute)) {\n    picking_vRGBcolor_Avalid.rgb = value;\n  }\n}\n",fs:"uniform pickingUniforms {\n  float isActive;\n  float isAttribute;\n  float isHighlightActive;\n  float useFloatColors;\n  vec3 highlightedObjectColor;\n  vec4 highlightColor;\n} picking;\n\nin vec4 picking_vRGBcolor_Avalid;\n\n/*\n * Returns highlight color if this item is selected.\n */\nvec4 picking_filterHighlightColor(vec4 color) {\n  // If we are still picking, we don't highlight\n  if (picking.isActive > 0.5) {\n    return color;\n  }\n\n  bool selected = bool(picking_vRGBcolor_Avalid.a);\n\n  if (selected) {\n    // Blend in highlight color based on its alpha value\n    float highLightAlpha = picking.highlightColor.a;\n    float blendedAlpha = highLightAlpha + color.a * (1.0 - highLightAlpha);\n    float highLightRatio = highLightAlpha / blendedAlpha;\n\n    vec3 blendedRGB = mix(color.rgb, picking.highlightColor.rgb, highLightRatio);\n    return vec4(blendedRGB, blendedAlpha);\n  } else {\n    return color;\n  }\n}\n\n/*\n * Returns picking color if picking enabled else unmodified argument.\n */\nvec4 picking_filterPickingColor(vec4 color) {\n  if (bool(picking.isActive)) {\n    if (picking_vRGBcolor_Avalid.a == 0.0) {\n      discard;\n    }\n    return picking_vRGBcolor_Avalid;\n  }\n  return color;\n}\n\n/*\n * Returns picking color if picking is enabled if not\n * highlight color if this item is selected, otherwise unmodified argument.\n */\nvec4 picking_filterColor(vec4 color) {\n  vec4 highlightColor = picking_filterHighlightColor(color);\n  return picking_filterPickingColor(highlightColor);\n}\n",getUniforms:function(e={},t){const n={};if(void 0===e.highlightedObjectColor);else if(null===e.highlightedObjectColor)n.isHighlightActive=!1;else{n.isHighlightActive=!0;const t=e.highlightedObjectColor.slice(0,3);n.highlightedObjectColor=t}if(e.highlightColor){const t=Array.from(e.highlightColor,e=>e/255);Number.isFinite(t[3])||(t[3]=1),n.highlightColor=t}void 0!==e.isActive&&(n.isActive=Boolean(e.isActive),n.isAttribute=Boolean(e.isAttribute));void 0!==e.useFloatColors&&(n.useFloatColors=Boolean(e.useFloatColors));return n}};const hk="precision highp int;\n\n// #if (defined(SHADER_TYPE_FRAGMENT) && defined(LIGHTING_FRAGMENT)) || (defined(SHADER_TYPE_VERTEX) && defined(LIGHTING_VERTEX))\nstruct AmbientLight {\n  vec3 color;\n};\n\nstruct PointLight {\n  vec3 color;\n  vec3 position;\n  vec3 attenuation; // 2nd order x:Constant-y:Linear-z:Exponential\n};\n\nstruct DirectionalLight {\n  vec3 color;\n  vec3 direction;\n};\n\nuniform lightingUniforms {\n  int enabled;\n  int lightType;\n\n  int directionalLightCount;\n  int pointLightCount;\n\n  vec3 ambientColor;\n\n  vec3 lightColor0;\n  vec3 lightPosition0;\n  vec3 lightDirection0;\n  vec3 lightAttenuation0;\n\n  vec3 lightColor1;\n  vec3 lightPosition1;\n  vec3 lightDirection1;\n  vec3 lightAttenuation1;\n\n  vec3 lightColor2;\n  vec3 lightPosition2;\n  vec3 lightDirection2;\n  vec3 lightAttenuation2;\n} lighting;\n\nPointLight lighting_getPointLight(int index) {\n  switch (index) {\n    case 0:\n      return PointLight(lighting.lightColor0, lighting.lightPosition0, lighting.lightAttenuation0);\n    case 1:\n      return PointLight(lighting.lightColor1, lighting.lightPosition1, lighting.lightAttenuation1);\n    case 2:\n    default:  \n      return PointLight(lighting.lightColor2, lighting.lightPosition2, lighting.lightAttenuation2);\n  }\n}\n\nDirectionalLight lighting_getDirectionalLight(int index) {\n  switch (index) {\n    case 0:\n      return DirectionalLight(lighting.lightColor0, lighting.lightDirection0);\n    case 1:\n      return DirectionalLight(lighting.lightColor1, lighting.lightDirection1);\n    case 2:\n    default:   \n      return DirectionalLight(lighting.lightColor2, lighting.lightDirection2);\n  }\n} \n\nfloat getPointLightAttenuation(PointLight pointLight, float distance) {\n  return pointLight.attenuation.x\n       + pointLight.attenuation.y * distance\n       + pointLight.attenuation.z * distance * distance;\n}\n\n// #endif\n";var pk,fk;(fk=pk||(pk={}))[fk.POINT=0]="POINT",fk[fk.DIRECTIONAL=1]="DIRECTIONAL";const gk={props:{},uniforms:{},name:"lighting",defines:{MAX_LIGHTS:3},uniformTypes:{enabled:"i32",lightType:"i32",directionalLightCount:"i32",pointLightCount:"i32",ambientLightColor:"vec3<f32>",lightColor0:"vec3<f32>",lightPosition0:"vec3<f32>",lightDirection0:"vec3<f32>",lightAttenuation0:"vec3<f32>",lightColor1:"vec3<f32>",lightPosition1:"vec3<f32>",lightDirection1:"vec3<f32>",lightAttenuation1:"vec3<f32>",lightColor2:"vec3<f32>",lightPosition2:"vec3<f32>",lightDirection2:"vec3<f32>",lightAttenuation2:"vec3<f32>"},defaultUniforms:{enabled:1,lightType:pk.POINT,directionalLightCount:0,pointLightCount:0,ambientLightColor:[.1,.1,.1],lightColor0:[1,1,1],lightPosition0:[1,1,2],lightDirection0:[1,1,1],lightAttenuation0:[1,0,0],lightColor1:[1,1,1],lightPosition1:[1,1,2],lightDirection1:[1,1,1],lightAttenuation1:[1,0,0],lightColor2:[1,1,1],lightPosition2:[1,1,2],lightDirection2:[1,1,1],lightAttenuation2:[1,0,0]},source:"// #if (defined(SHADER_TYPE_FRAGMENT) && defined(LIGHTING_FRAGMENT)) || (defined(SHADER_TYPE_VERTEX) && defined(LIGHTING_VERTEX))\nstruct AmbientLight {\n  color: vec3<f32>,\n};\n\nstruct PointLight {\n  color: vec3<f32>,\n  position: vec3<f32>,\n  attenuation: vec3<f32>, // 2nd order x:Constant-y:Linear-z:Exponential\n};\n\nstruct DirectionalLight {\n  color: vec3<f32>,\n  direction: vec3<f32>,\n};\n\nstruct lightingUniforms {\n  enabled: i32,\n  pointLightCount: i32,\n  directionalLightCount: i32,\n\n  ambientColor: vec3<f32>,\n\n  // TODO - support multiple lights by uncommenting arrays below\n  lightType: i32,\n  lightColor: vec3<f32>,\n  lightDirection: vec3<f32>,\n  lightPosition: vec3<f32>,\n  lightAttenuation: vec3<f32>,\n\n  // AmbientLight ambientLight;\n  // PointLight pointLight[MAX_LIGHTS];\n  // DirectionalLight directionalLight[MAX_LIGHTS];\n};\n\n// Binding 0:1 is reserved for lighting (Note: could go into separate bind group as it is stable across draw calls)\n@binding(1) @group(0) var<uniform> lighting : lightingUniforms;\n\nfn lighting_getPointLight(index: i32) -> PointLight {\n  return PointLight(lighting.lightColor, lighting.lightPosition, lighting.lightAttenuation);\n}\n\nfn lighting_getDirectionalLight(index: i32) -> DirectionalLight {\n  return DirectionalLight(lighting.lightColor, lighting.lightDirection);\n} \n\nfn getPointLightAttenuation(pointLight: PointLight, distance: f32) -> f32 {\n  return pointLight.attenuation.x\n       + pointLight.attenuation.y * distance\n       + pointLight.attenuation.z * distance * distance;\n}\n",vs:hk,fs:hk,getUniforms:function(e,t={}){if(!(e=e?{...e}:e))return{...gk.defaultUniforms};e.lights&&(e={...e,...yk(e.lights),lights:void 0});const{ambientLight:n,pointLights:r,directionalLights:o}=e||{};if(!(n||r&&r.length>0||o&&o.length>0))return{...gk.defaultUniforms,enabled:0};const i={...gk.defaultUniforms,...t,...mk({ambientLight:n,pointLights:r,directionalLights:o})};void 0!==e.enabled&&(i.enabled=e.enabled?1:0);return i}};function mk({ambientLight:e,pointLights:t=[],directionalLights:n=[]}){const r={};r.ambientLightColor=vk(e);let o=0;for(const i of t){r.lightType=pk.POINT;const e=o;r[`lightColor${e}`]=vk(i),r[`lightPosition${e}`]=i.position,r[`lightAttenuation${e}`]=i.attenuation||[1,0,0],o++}for(const i of n){r.lightType=pk.DIRECTIONAL;const e=o;r[`lightColor${e}`]=vk(i),r[`lightDirection${e}`]=i.direction,o++}return o>3&&eS.warn("MAX_LIGHTS exceeded")(),r.directionalLightCount=n.length,r.pointLightCount=t.length,r}function yk(e){const t={pointLights:[],directionalLights:[]};for(const n of e||[])switch(n.type){case"ambient":t.ambientLight=n;break;case"directional":t.directionalLights?.push(n);break;case"point":t.pointLights?.push(n)}return t}function vk(e={}){const{color:t=[0,0,0],intensity:n=1}=e;return t.map(e=>e*n/255)}const bk="uniform phongMaterialUniforms {\n  uniform float ambient;\n  uniform float diffuse;\n  uniform float shininess;\n  uniform vec3  specularColor;\n} material;\n",wk="struct phongMaterialUniforms {\n  ambient: f32,\n  diffuse: f32,\n  shininess: f32,\n  specularColor: vec3<f32>,\n};\n\n@binding(2) @group(0) var<uniform> phongMaterial : phongMaterialUniforms;\n\nfn lighting_getLightColor(surfaceColor: vec3<f32>, light_direction: vec3<f32>, view_direction: vec3<f32>, normal_worldspace: vec3<f32>, color: vec3<f32>) -> vec3<f32> {\n  let halfway_direction: vec3<f32> = normalize(light_direction + view_direction);\n  var lambertian: f32 = dot(light_direction, normal_worldspace);\n  var specular: f32 = 0.0;\n  if (lambertian > 0.0) {\n    let specular_angle = max(dot(normal_worldspace, halfway_direction), 0.0);\n    specular = pow(specular_angle, phongMaterial.shininess);\n  }\n  lambertian = max(lambertian, 0.0);\n  return (lambertian * phongMaterial.diffuse * surfaceColor + specular * phongMaterial.specularColor) * color;\n}\n\nfn lighting_getLightColor2(surfaceColor: vec3<f32>, cameraPosition: vec3<f32>, position_worldspace: vec3<f32>, normal_worldspace: vec3<f32>) -> vec3<f32> {\n  var lightColor: vec3<f32> = surfaceColor;\n\n  if (lighting.enabled == 0) {\n    return lightColor;\n  }\n\n  let view_direction: vec3<f32> = normalize(cameraPosition - position_worldspace);\n  lightColor = phongMaterial.ambient * surfaceColor * lighting.ambientColor;\n\n  if (lighting.lightType == 0) {\n    let pointLight: PointLight  = lighting_getPointLight(0);\n    let light_position_worldspace: vec3<f32> = pointLight.position;\n    let light_direction: vec3<f32> = normalize(light_position_worldspace - position_worldspace);\n    lightColor += lighting_getLightColor(surfaceColor, light_direction, view_direction, normal_worldspace, pointLight.color);\n  } else if (lighting.lightType == 1) {\n    var directionalLight: DirectionalLight = lighting_getDirectionalLight(0);\n    lightColor += lighting_getLightColor(surfaceColor, -directionalLight.direction, view_direction, normal_worldspace, directionalLight.color);\n  }\n  \n  return lightColor;\n  /*\n  for (int i = 0; i < MAX_LIGHTS; i++) {\n    if (i >= lighting.pointLightCount) {\n      break;\n    }\n    PointLight pointLight = lighting.pointLight[i];\n    vec3 light_position_worldspace = pointLight.position;\n    vec3 light_direction = normalize(light_position_worldspace - position_worldspace);\n    lightColor += lighting_getLightColor(surfaceColor, light_direction, view_direction, normal_worldspace, pointLight.color);\n  }\n\n  for (int i = 0; i < MAX_LIGHTS; i++) {\n    if (i >= lighting.directionalLightCount) {\n      break;\n    }\n    DirectionalLight directionalLight = lighting.directionalLight[i];\n    lightColor += lighting_getLightColor(surfaceColor, -directionalLight.direction, view_direction, normal_worldspace, directionalLight.color);\n  }\n  */\n}\n\nfn lighting_getSpecularLightColor(cameraPosition: vec3<f32>, position_worldspace: vec3<f32>, normal_worldspace: vec3<f32>) -> vec3<f32>{\n  var lightColor = vec3<f32>(0, 0, 0);\n  let surfaceColor = vec3<f32>(0, 0, 0);\n\n  if (lighting.enabled == 0) {\n    let view_direction = normalize(cameraPosition - position_worldspace);\n\n    switch (lighting.lightType) {\n      case 0, default: {\n        let pointLight: PointLight = lighting_getPointLight(0);\n        let light_position_worldspace: vec3<f32> = pointLight.position;\n        let light_direction: vec3<f32> = normalize(light_position_worldspace - position_worldspace);\n        lightColor += lighting_getLightColor(surfaceColor, light_direction, view_direction, normal_worldspace, pointLight.color);\n      }\n      case 1: {\n        let directionalLight: DirectionalLight = lighting_getDirectionalLight(0);\n        lightColor += lighting_getLightColor(surfaceColor, -directionalLight.direction, view_direction, normal_worldspace, directionalLight.color);\n      }\n    }\n  }\n  return lightColor;\n}\n",xk={props:{},name:"gouraudMaterial",vs:"uniform phongMaterialUniforms {\n  uniform float ambient;\n  uniform float diffuse;\n  uniform float shininess;\n  uniform vec3  specularColor;\n} material;\n\nvec3 lighting_getLightColor(vec3 surfaceColor, vec3 light_direction, vec3 view_direction, vec3 normal_worldspace, vec3 color) {\n  vec3 halfway_direction = normalize(light_direction + view_direction);\n  float lambertian = dot(light_direction, normal_worldspace);\n  float specular = 0.0;\n  if (lambertian > 0.0) {\n    float specular_angle = max(dot(normal_worldspace, halfway_direction), 0.0);\n    specular = pow(specular_angle, material.shininess);\n  }\n  lambertian = max(lambertian, 0.0);\n  return (lambertian * material.diffuse * surfaceColor + specular * material.specularColor) * color;\n}\n\nvec3 lighting_getLightColor(vec3 surfaceColor, vec3 cameraPosition, vec3 position_worldspace, vec3 normal_worldspace) {\n  vec3 lightColor = surfaceColor;\n\n  if (lighting.enabled == 0) {\n    return lightColor;\n  }\n\n  vec3 view_direction = normalize(cameraPosition - position_worldspace);\n  lightColor = material.ambient * surfaceColor * lighting.ambientColor;\n\n  for (int i = 0; i < lighting.pointLightCount; i++) {\n    PointLight pointLight = lighting_getPointLight(i);\n    vec3 light_position_worldspace = pointLight.position;\n    vec3 light_direction = normalize(light_position_worldspace - position_worldspace);\n    float light_attenuation = getPointLightAttenuation(pointLight, distance(light_position_worldspace, position_worldspace));\n    lightColor += lighting_getLightColor(surfaceColor, light_direction, view_direction, normal_worldspace, pointLight.color / light_attenuation);\n  }\n\n  int totalLights = min(MAX_LIGHTS, lighting.pointLightCount + lighting.directionalLightCount);\n  for (int i = lighting.pointLightCount; i < totalLights; i++) {\n    DirectionalLight directionalLight = lighting_getDirectionalLight(i);\n    lightColor += lighting_getLightColor(surfaceColor, -directionalLight.direction, view_direction, normal_worldspace, directionalLight.color);\n  }\n  \n  return lightColor;\n}\n".replace("phongMaterial","gouraudMaterial"),fs:bk.replace("phongMaterial","gouraudMaterial"),source:wk.replaceAll("phongMaterial","gouraudMaterial"),defines:{LIGHTING_VERTEX:1},dependencies:[gk],uniformTypes:{ambient:"f32",diffuse:"f32",shininess:"f32",specularColor:"vec3<f32>"},defaultUniforms:{ambient:.35,diffuse:.6,shininess:32,specularColor:[.15,.15,.15]},getUniforms(e){const t={...e};return t.specularColor&&(t.specularColor=t.specularColor.map(e=>e/255)),{...xk.defaultUniforms,...t}}},_k="uniform layerUniforms {\n  uniform float opacity;\n} layer;\n",Ck={name:"layer",vs:_k,fs:_k,getUniforms:e=>({opacity:Math.pow(e.opacity,1/2.2)}),uniformTypes:{opacity:"f32"}},Sk="#define SMOOTH_EDGE_RADIUS 0.5",Ek={name:"geometry",source:"const SMOOTH_EDGE_RADIUS: f32 = 0.5;\n\nstruct VertexGeometry {\n  position: vec4<f32>,\n  worldPosition: vec3<f32>,\n  worldPositionAlt: vec3<f32>,\n  normal: vec3<f32>,\n  uv: vec2<f32>,\n  pickingColor: vec3<f32>,\n};\n\nvar<private> geometry_: VertexGeometry = VertexGeometry(\n  vec4<f32>(0.0, 0.0, 1.0, 0.0),\n  vec3<f32>(0.0, 0.0, 0.0),\n  vec3<f32>(0.0, 0.0, 0.0),\n  vec3<f32>(0.0, 0.0, 0.0),\n  vec2<f32>(0.0, 0.0),\n  vec3<f32>(0.0, 0.0, 0.0)\n);\n\nstruct FragmentGeometry {\n  uv: vec2<f32>,\n};\n\nvar<private> fragmentGeometry: FragmentGeometry;\n\nfn smoothedge(edge: f32, x: f32) -> f32 {\n  return smoothstep(edge - SMOOTH_EDGE_RADIUS, edge + SMOOTH_EDGE_RADIUS, x);\n}\n",vs:`${Sk}\n\nstruct VertexGeometry {\n  vec4 position;\n  vec3 worldPosition;\n  vec3 worldPositionAlt;\n  vec3 normal;\n  vec2 uv;\n  vec3 pickingColor;\n} geometry = VertexGeometry(\n  vec4(0.0, 0.0, 1.0, 0.0),\n  vec3(0.0),\n  vec3(0.0),\n  vec3(0.0),\n  vec2(0.0),\n  vec3(0.0)\n);\n`,fs:`${Sk}\n\nstruct FragmentGeometry {\n  vec2 uv;\n} geometry;\n\nfloat smoothedge(float edge, float x) {\n  return smoothstep(edge - SMOOTH_EDGE_RADIUS, edge + SMOOTH_EDGE_RADIUS, x);\n}\n`};var Bk,Ik,Rk,kk,Tk,Pk;(Ik=Bk||(Bk={}))[Ik.Start=1]="Start",Ik[Ik.Move=2]="Move",Ik[Ik.End=4]="End",Ik[Ik.Cancel=8]="Cancel",(kk=Rk||(Rk={}))[kk.None=0]="None",kk[kk.Left=1]="Left",kk[kk.Right=2]="Right",kk[kk.Up=4]="Up",kk[kk.Down=8]="Down",kk[kk.Horizontal=3]="Horizontal",kk[kk.Vertical=12]="Vertical",kk[kk.All=15]="All",(Pk=Tk||(Tk={}))[Pk.Possible=1]="Possible",Pk[Pk.Began=2]="Began",Pk[Pk.Changed=4]="Changed",Pk[Pk.Ended=8]="Ended",Pk[Pk.Recognized=8]="Recognized",Pk[Pk.Cancelled=16]="Cancelled",Pk[Pk.Failed=32]="Failed";const Fk="manipulation",Mk="none",Lk="pan-x",Uk="pan-y";class Ok{constructor(e,t){this.actions="",this.manager=e,this.set(t)}set(e){"compute"===e&&(e=this.compute()),this.manager.element&&(this.manager.element.style.touchAction=e,this.actions=e)}update(){this.set(this.manager.options.touchAction)}compute(){let e=[];for(const t of this.manager.recognizers)t.options.enable&&(e=e.concat(t.getTouchAction()));return function(e){if(e.includes(Mk))return Mk;const t=e.includes(Lk),n=e.includes(Uk);return t&&n?Mk:t||n?t?Lk:Uk:e.includes(Fk)?Fk:"auto"}(e.join(" "))}}function Dk(e){return e.trim().split(/\s+/g)}function Nk(e,t,n){if(e)for(const r of Dk(t))e.addEventListener(r,n,!1)}function jk(e,t,n){if(e)for(const r of Dk(t))e.removeEventListener(r,n,!1)}function Qk(e){return(e.ownerDocument||e).defaultView}function zk(e){const t=e.length;if(1===t)return{x:Math.round(e[0].clientX),y:Math.round(e[0].clientY)};let n=0,r=0,o=0;for(;o<t;)n+=e[o].clientX,r+=e[o].clientY,o++;return{x:Math.round(n/t),y:Math.round(r/t)}}function Hk(e){const t=[];let n=0;for(;n<e.pointers.length;)t[n]={clientX:Math.round(e.pointers[n].clientX),clientY:Math.round(e.pointers[n].clientY)},n++;return{timeStamp:Date.now(),pointers:t,center:zk(t),deltaX:e.deltaX,deltaY:e.deltaY}}function Gk(e,t){const n=t.x-e.x,r=t.y-e.y;return Math.sqrt(n*n+r*r)}function Vk(e,t){const n=t.clientX-e.clientX,r=t.clientY-e.clientY;return Math.sqrt(n*n+r*r)}function Wk(e,t){const n=t.clientX-e.clientX,r=t.clientY-e.clientY;return 180*Math.atan2(r,n)/Math.PI}function $k(e,t){return e===t?Rk.None:Math.abs(e)>=Math.abs(t)?e<0?Rk.Left:Rk.Right:t<0?Rk.Up:Rk.Down}function Kk(e,t,n){return{x:t/e||0,y:n/e||0}}function Xk(e,t){const{session:n}=e,{pointers:r}=t,{length:o}=r;n.firstInput||(n.firstInput=Hk(t)),o>1&&!n.firstMultiple?n.firstMultiple=Hk(t):1===o&&(n.firstMultiple=!1);const{firstInput:i,firstMultiple:s}=n,a=s?s.center:i.center,l=t.center=zk(r);t.timeStamp=Date.now(),t.deltaTime=t.timeStamp-i.timeStamp,t.angle=function(e,t){const n=t.x-e.x,r=t.y-e.y;return 180*Math.atan2(r,n)/Math.PI}(a,l),t.distance=Gk(a,l);const{deltaX:c,deltaY:u}=function(e,t){const n=t.center;let r=e.offsetDelta,o=e.prevDelta;const i=e.prevInput;return t.eventType!==Bk.Start&&i?.eventType!==Bk.End||(o=e.prevDelta={x:i?.deltaX||0,y:i?.deltaY||0},r=e.offsetDelta={x:n.x,y:n.y}),{deltaX:o.x+(n.x-r.x),deltaY:o.y+(n.y-r.y)}}(n,t);t.deltaX=c,t.deltaY=u,t.offsetDirection=$k(t.deltaX,t.deltaY);const d=Kk(t.deltaTime,t.deltaX,t.deltaY);var A,h;t.overallVelocityX=d.x,t.overallVelocityY=d.y,t.overallVelocity=Math.abs(d.x)>Math.abs(d.y)?d.x:d.y,t.scale=s?(A=s.pointers,Vk((h=r)[0],h[1])/Vk(A[0],A[1])):1,t.rotation=s?function(e,t){return Wk(t[1],t[0])-Wk(e[1],e[0])}(s.pointers,r):0,t.maxPointers=n.prevInput?t.pointers.length>n.prevInput.maxPointers?t.pointers.length:n.prevInput.maxPointers:t.pointers.length;let p=e.element;return function(e,t){let n=e;for(;n;){if(n===t)return!0;n=n.parentNode}return!1}(t.srcEvent.target,p)&&(p=t.srcEvent.target),t.target=p,function(e,t){const n=e.lastInterval||t,r=t.timeStamp-n.timeStamp;let o,i,s,a;if(t.eventType!==Bk.Cancel&&(r>25||void 0===n.velocity)){const l=t.deltaX-n.deltaX,c=t.deltaY-n.deltaY,u=Kk(r,l,c);i=u.x,s=u.y,o=Math.abs(u.x)>Math.abs(u.y)?u.x:u.y,a=$k(l,c),e.lastInterval=t}else o=n.velocity,i=n.velocityX,s=n.velocityY,a=n.direction;t.velocity=o,t.velocityX=i,t.velocityY=s,t.direction=a}(n,t),t}let Yk=class{constructor(e){this.evEl="",this.evWin="",this.evTarget="",this.domHandler=e=>{this.manager.options.enable&&this.handler(e)},this.manager=e,this.element=e.element,this.target=e.options.inputTarget||e.element}callback(e,t){!function(e,t,n){const r=n.pointers.length,o=n.changedPointers.length,i=t&Bk.Start&&r-o===0,s=t&(Bk.End|Bk.Cancel)&&r-o===0;n.isFirst=Boolean(i),n.isFinal=Boolean(s),i&&(e.session={}),n.eventType=t;const a=Xk(e,n);e.emit("hammer.input",a),e.recognize(a),e.session.prevInput=a}(this.manager,e,t)}init(){Nk(this.element,this.evEl,this.domHandler),Nk(this.target,this.evTarget,this.domHandler),Nk(Qk(this.element),this.evWin,this.domHandler)}destroy(){jk(this.element,this.evEl,this.domHandler),jk(this.target,this.evTarget,this.domHandler),jk(Qk(this.element),this.evWin,this.domHandler)}};const qk={pointerdown:Bk.Start,pointermove:Bk.Move,pointerup:Bk.End,pointercancel:Bk.Cancel,pointerout:Bk.Cancel};class Jk extends Yk{constructor(e){super(e),this.evEl="pointerdown",this.evWin="pointermove pointerup pointercancel",this.store=this.manager.session.pointerEvents=[],this.init()}handler(e){const{store:t}=this;let n=!1;const r=qk[e.type],o=e.pointerType,i="touch"===o;let s=t.findIndex(t=>t.pointerId===e.pointerId);r&Bk.Start&&(e.buttons||i)?s<0&&(t.push(e),s=t.length-1):r&(Bk.End|Bk.Cancel)&&(n=!0),s<0||(t[s]=e,this.callback(r,{pointers:t,changedPointers:[e],eventType:r,pointerType:o,srcEvent:e}),n&&t.splice(s,1))}}const Zk=["","webkit","Moz","MS","ms","o"];function eT(e,t){const n=t[0].toUpperCase()+t.slice(1);for(const r of Zk){const o=r?r+n:t;if(o in e)return o}}const tT={touchAction:"compute",enable:!0,inputTarget:null,cssProps:{userSelect:"none",userDrag:"none",touchCallout:"none",tapHighlightColor:"rgba(0,0,0,0)"}};class nT{constructor(e,t){this.options={...tT,...t,cssProps:{...tT.cssProps,...t.cssProps},inputTarget:t.inputTarget||e},this.handlers={},this.session={},this.recognizers=[],this.oldCssProps={},this.element=e,this.input=new Jk(this),this.touchAction=new Ok(this,this.options.touchAction),this.toggleCssProps(!0)}set(e){return Object.assign(this.options,e),e.touchAction&&this.touchAction.update(),e.inputTarget&&(this.input.destroy(),this.input.target=e.inputTarget,this.input.init()),this}stop(e){this.session.stopped=e?2:1}recognize(e){const{session:t}=this;if(t.stopped)return;let n;this.session.prevented&&e.srcEvent.preventDefault();const{recognizers:r}=this;let{curRecognizer:o}=t;(!o||o&&o.state&Tk.Recognized)&&(o=t.curRecognizer=null);let i=0;for(;i<r.length;)n=r[i],2===t.stopped||o&&n!==o&&!n.canRecognizeWith(o)?n.reset():n.recognize(e),!o&&n.state&(Tk.Began|Tk.Changed|Tk.Ended)&&(o=t.curRecognizer=n),i++}get(e){const{recognizers:t}=this;for(let n=0;n<t.length;n++)if(t[n].options.event===e)return t[n];return null}add(e){if(Array.isArray(e)){for(const t of e)this.add(t);return this}const t=this.get(e.options.event);return t&&this.remove(t),this.recognizers.push(e),e.manager=this,this.touchAction.update(),e}remove(e){if(Array.isArray(e)){for(const t of e)this.remove(t);return this}const t="string"==typeof e?this.get(e):e;if(t){const{recognizers:e}=this,n=e.indexOf(t);-1!==n&&(e.splice(n,1),this.touchAction.update())}return this}on(e,t){if(!e||!t)return;const{handlers:n}=this;for(const r of Dk(e))n[r]=n[r]||[],n[r].push(t)}off(e,t){if(!e)return;const{handlers:n}=this;for(const r of Dk(e))t?n[r]&&n[r].splice(n[r].indexOf(t),1):delete n[r]}emit(e,t){const n=this.handlers[e]&&this.handlers[e].slice();if(!n||!n.length)return;const r=t;r.type=e,r.preventDefault=function(){t.srcEvent.preventDefault()};let o=0;for(;o<n.length;)n[o](r),o++}destroy(){this.toggleCssProps(!1),this.handlers={},this.session={},this.input.destroy(),this.element=null}toggleCssProps(e){const{element:t}=this;if(t){for(const[n,r]of Object.entries(this.options.cssProps)){const o=eT(t.style,n);e?(this.oldCssProps[o]=t.style[o],t.style[o]=r):t.style[o]=this.oldCssProps[o]||""}e||(this.oldCssProps={})}}}let rT=1;function oT(e){return e&Tk.Cancelled?"cancel":e&Tk.Ended?"end":e&Tk.Changed?"move":e&Tk.Began?"start":""}class iT{constructor(e){this.options=e,this.id=rT++,this.state=Tk.Possible,this.simultaneous={},this.requireFail=[]}set(e){return Object.assign(this.options,e),this.manager.touchAction.update(),this}recognizeWith(e){if(Array.isArray(e)){for(const t of e)this.recognizeWith(t);return this}let t;if("string"==typeof e){if(t=this.manager.get(e),!t)throw new Error(`Cannot find recognizer ${e}`)}else t=e;const{simultaneous:n}=this;return n[t.id]||(n[t.id]=t,t.recognizeWith(this)),this}dropRecognizeWith(e){if(Array.isArray(e)){for(const t of e)this.dropRecognizeWith(t);return this}let t;return t="string"==typeof e?this.manager.get(e):e,t&&delete this.simultaneous[t.id],this}requireFailure(e){if(Array.isArray(e)){for(const t of e)this.requireFailure(t);return this}let t;if("string"==typeof e){if(t=this.manager.get(e),!t)throw new Error(`Cannot find recognizer ${e}`)}else t=e;const{requireFail:n}=this;return-1===n.indexOf(t)&&(n.push(t),t.requireFailure(this)),this}dropRequireFailure(e){if(Array.isArray(e)){for(const t of e)this.dropRequireFailure(t);return this}let t;if(t="string"==typeof e?this.manager.get(e):e,t){const e=this.requireFail.indexOf(t);e>-1&&this.requireFail.splice(e,1)}return this}hasRequireFailures(){return Boolean(this.requireFail.find(e=>e.options.enable))}canRecognizeWith(e){return Boolean(this.simultaneous[e.id])}emit(e){if(!e)return;const{state:t}=this;t<Tk.Ended&&this.manager.emit(this.options.event+oT(t),e),this.manager.emit(this.options.event,e),e.additionalEvent&&this.manager.emit(e.additionalEvent,e),t>=Tk.Ended&&this.manager.emit(this.options.event+oT(t),e)}tryEmit(e){this.canEmit()?this.emit(e):this.state=Tk.Failed}canEmit(){let e=0;for(;e<this.requireFail.length;){if(!(this.requireFail[e].state&(Tk.Failed|Tk.Possible)))return!1;e++}return!0}recognize(e){const t={...e};if(!this.options.enable)return this.reset(),void(this.state=Tk.Failed);this.state&(Tk.Recognized|Tk.Cancelled|Tk.Failed)&&(this.state=Tk.Possible),this.state=this.process(t),this.state&(Tk.Began|Tk.Changed|Tk.Ended|Tk.Cancelled)&&this.tryEmit(t)}getEventNames(){return[this.options.event]}reset(){}}class sT extends iT{attrTest(e){const t=this.options.pointers;return 0===t||e.pointers.length===t}process(e){const{state:t}=this,{eventType:n}=e,r=t&(Tk.Began|Tk.Changed),o=this.attrTest(e);return r&&(n&Bk.Cancel||!o)?t|Tk.Cancelled:r||o?n&Bk.End?t|Tk.Ended:t&Tk.Began?t|Tk.Changed:Tk.Began:Tk.Failed}}class aT extends iT{constructor(e={}){super({enable:!0,event:"tap",pointers:1,taps:1,interval:300,time:250,threshold:9,posThreshold:10,...e}),this.pTime=null,this.pCenter=null,this._timer=null,this._input=null,this.count=0}getTouchAction(){return[Fk]}process(e){const{options:t}=this,n=e.pointers.length===t.pointers,r=e.distance<t.threshold,o=e.deltaTime<t.time;if(this.reset(),e.eventType&Bk.Start&&0===this.count)return this.failTimeout();if(r&&o&&n){if(e.eventType!==Bk.End)return this.failTimeout();const n=!this.pTime||e.timeStamp-this.pTime<t.interval,r=!this.pCenter||Gk(this.pCenter,e.center)<t.posThreshold;this.pTime=e.timeStamp,this.pCenter=e.center,r&&n?this.count+=1:this.count=1,this._input=e;if(0===this.count%t.taps)return this.hasRequireFailures()?(this._timer=setTimeout(()=>{this.state=Tk.Recognized,this.tryEmit(this._input)},t.interval),Tk.Began):Tk.Recognized}return Tk.Failed}failTimeout(){return this._timer=setTimeout(()=>{this.state=Tk.Failed},this.options.interval),Tk.Failed}reset(){clearTimeout(this._timer)}emit(e){this.state===Tk.Recognized&&(e.tapCount=this.count,this.manager.emit(this.options.event,e))}}const lT=["","start","move","end","cancel","up","down","left","right"];class cT extends sT{constructor(e={}){super({enable:!0,pointers:1,event:"pan",threshold:10,direction:Rk.All,...e}),this.pX=null,this.pY=null}getTouchAction(){const{options:{direction:e}}=this,t=[];return e&Rk.Horizontal&&t.push(Uk),e&Rk.Vertical&&t.push(Lk),t}getEventNames(){return lT.map(e=>this.options.event+e)}directionTest(e){const{options:t}=this;let n=!0,{distance:r}=e,{direction:o}=e;const i=e.deltaX,s=e.deltaY;return o&t.direction||(t.direction&Rk.Horizontal?(o=0===i?Rk.None:i<0?Rk.Left:Rk.Right,n=i!==this.pX,r=Math.abs(e.deltaX)):(o=0===s?Rk.None:s<0?Rk.Up:Rk.Down,n=s!==this.pY,r=Math.abs(e.deltaY))),e.direction=o,n&&r>t.threshold&&Boolean(o&t.direction)}attrTest(e){return super.attrTest(e)&&(Boolean(this.state&Tk.Began)||!(this.state&Tk.Began)&&this.directionTest(e))}emit(e){this.pX=e.deltaX,this.pY=e.deltaY;const t=Rk[e.direction].toLowerCase();t&&(e.additionalEvent=this.options.event+t),super.emit(e)}}const uT=["","start","move","end","cancel","in","out"];class dT{constructor(e,t,n){this.element=e,this.callback=t,this.options=n}}const AT=-1!==("undefined"!=typeof navigator&&navigator.userAgent?navigator.userAgent.toLowerCase():"").indexOf("firefox"),hT=4.000244140625;class pT extends dT{constructor(e,t,n){super(e,t,{enable:!0,...n}),this.handleEvent=e=>{if(!this.options.enable)return;let t=e.deltaY;globalThis.WheelEvent&&(AT&&e.deltaMode===globalThis.WheelEvent.DOM_DELTA_PIXEL&&(t/=globalThis.devicePixelRatio),e.deltaMode===globalThis.WheelEvent.DOM_DELTA_LINE&&(t*=40)),0!==t&&t%hT===0&&(t=Math.floor(t/hT)),e.shiftKey&&t&&(t*=.25),this.callback({type:"wheel",center:{x:e.clientX,y:e.clientY},delta:-t,srcEvent:e,pointerType:"mouse",target:e.target})},e.addEventListener("wheel",this.handleEvent,{passive:!1})}destroy(){this.element.removeEventListener("wheel",this.handleEvent)}enableEventType(e,t){"wheel"===e&&(this.options.enable=t)}}const fT=["mousedown","mousemove","mouseup","mouseover","mouseout","mouseleave"];class gT extends dT{constructor(e,t,n){super(e,t,{enable:!0,...n}),this.handleEvent=e=>{this.handleOverEvent(e),this.handleOutEvent(e),this.handleEnterEvent(e),this.handleLeaveEvent(e),this.handleMoveEvent(e)},this.pressed=!1;const{enable:r}=this.options;this.enableMoveEvent=r,this.enableLeaveEvent=r,this.enableEnterEvent=r,this.enableOutEvent=r,this.enableOverEvent=r,fT.forEach(t=>e.addEventListener(t,this.handleEvent))}destroy(){fT.forEach(e=>this.element.removeEventListener(e,this.handleEvent))}enableEventType(e,t){switch(e){case"pointermove":this.enableMoveEvent=t;break;case"pointerover":this.enableOverEvent=t;break;case"pointerout":this.enableOutEvent=t;break;case"pointerenter":this.enableEnterEvent=t;break;case"pointerleave":this.enableLeaveEvent=t}}handleOverEvent(e){this.enableOverEvent&&"mouseover"===e.type&&this._emit("pointerover",e)}handleOutEvent(e){this.enableOutEvent&&"mouseout"===e.type&&this._emit("pointerout",e)}handleEnterEvent(e){this.enableEnterEvent&&"mouseenter"===e.type&&this._emit("pointerenter",e)}handleLeaveEvent(e){this.enableLeaveEvent&&"mouseleave"===e.type&&this._emit("pointerleave",e)}handleMoveEvent(e){if(this.enableMoveEvent)switch(e.type){case"mousedown":e.button>=0&&(this.pressed=!0);break;case"mousemove":0===e.buttons&&(this.pressed=!1),this.pressed||this._emit("pointermove",e);break;case"mouseup":this.pressed=!1}}_emit(e,t){this.callback({type:e,center:{x:t.clientX,y:t.clientY},srcEvent:t,pointerType:"mouse",target:t.target})}}const mT=["keydown","keyup"];class yT extends dT{constructor(e,t,n){super(e,t,{enable:!0,tabIndex:0,...n}),this.handleEvent=e=>{const t=e.target||e.srcElement;"INPUT"===t.tagName&&"text"===t.type||"TEXTAREA"===t.tagName||(this.enableDownEvent&&"keydown"===e.type&&this.callback({type:"keydown",srcEvent:e,key:e.key,target:e.target}),this.enableUpEvent&&"keyup"===e.type&&this.callback({type:"keyup",srcEvent:e,key:e.key,target:e.target}))},this.enableDownEvent=this.options.enable,this.enableUpEvent=this.options.enable,e.tabIndex=this.options.tabIndex,e.style.outline="none",mT.forEach(t=>e.addEventListener(t,this.handleEvent))}destroy(){mT.forEach(e=>this.element.removeEventListener(e,this.handleEvent))}enableEventType(e,t){"keydown"===e&&(this.enableDownEvent=t),"keyup"===e&&(this.enableUpEvent=t)}}class vT extends dT{constructor(e,t,n){super(e,t,n),this.handleEvent=e=>{this.options.enable&&this.callback({type:"contextmenu",center:{x:e.clientX,y:e.clientY},srcEvent:e,pointerType:"mouse",target:e.target})},e.addEventListener("contextmenu",this.handleEvent)}destroy(){this.element.removeEventListener("contextmenu",this.handleEvent)}enableEventType(e,t){"contextmenu"===e&&(this.options.enable=t)}}const bT={pointerdown:1,pointermove:2,pointerup:4,mousedown:1,mousemove:2,mouseup:4};function wT(e){const t=bT[e.srcEvent.type];if(!t)return null;const{buttons:n,button:r}=e.srcEvent;let o=!1,i=!1,s=!1;return 2===t?(o=Boolean(1&n),i=Boolean(4&n),s=Boolean(2&n)):(o=0===r,i=1===r,s=2===r),{leftButton:o,middleButton:i,rightButton:s}}function xT(e,t){const n=e.center;if(!n)return null;const r=t.getBoundingClientRect(),o=r.width/t.offsetWidth||1,i=r.height/t.offsetHeight||1;return{center:n,offsetCenter:{x:(n.x-r.left-t.clientLeft)/o,y:(n.y-r.top-t.clientTop)/i}}}const _T={srcElement:"root",priority:0};class CT{constructor(e,t){this.handleEvent=e=>{if(this.isEmpty())return;const t=this._normalizeEvent(e);let n=e.srcEvent.target;for(;n&&n!==t.rootElement;){if(this._emit(t,n),t.handled)return;n=n.parentNode}this._emit(t,"root")},this.eventManager=e,this.recognizerName=t,this.handlers=[],this.handlersByElement=new Map,this._active=!1}isEmpty(){return!this._active}add(e,t,n,r=!1,o=!1){const{handlers:i,handlersByElement:s}=this,a={..._T,...n};let l=s.get(a.srcElement);l||(l=[],s.set(a.srcElement,l));const c={type:e,handler:t,srcElement:a.srcElement,priority:a.priority};r&&(c.once=!0),o&&(c.passive=!0),i.push(c),this._active=this._active||!c.passive;let u=l.length-1;for(;u>=0&&!(l[u].priority>=c.priority);)u--;l.splice(u+1,0,c)}remove(e,t){const{handlers:n,handlersByElement:r}=this;for(let o=n.length-1;o>=0;o--){const i=n[o];if(i.type===e&&i.handler===t){n.splice(o,1);const e=r.get(i.srcElement);e.splice(e.indexOf(i),1),0===e.length&&r.delete(i.srcElement)}}this._active=n.some(e=>!e.passive)}_emit(e,t){const n=this.handlersByElement.get(t);if(n){let t=!1;const r=()=>{e.handled=!0},o=()=>{e.handled=!0,t=!0},i=[];for(let s=0;s<n.length;s++){const{type:a,handler:l,once:c}=n[s];if(l({...e,type:a,stopPropagation:r,stopImmediatePropagation:o}),c&&i.push(n[s]),t)break}for(let e=0;e<i.length;e++){const{type:t,handler:n}=i[e];this.remove(t,n)}}}_normalizeEvent(e){const t=this.eventManager.getElement();return{...e,...wT(e),...xT(e,t),preventDefault:()=>{e.srcEvent.preventDefault()},stopImmediatePropagation:null,stopPropagation:null,handled:!1,rootElement:t}}}function ST(e){if("recognizer"in e)return e;let t;const n=Array.isArray(e)?[...e]:[e];if("function"==typeof n[0]){t=new(n.shift())(n.shift()||{})}else t=n.shift();return{recognizer:t,recognizeWith:"string"==typeof n[0]?[n[0]]:n[0],requireFailure:"string"==typeof n[1]?[n[1]]:n[1]}}class ET{constructor(e=null,t={}){if(this._onBasicInput=e=>{this.manager.emit(e.srcEvent.type,e)},this._onOtherEvent=e=>{this.manager.emit(e.type,e)},this.options={recognizers:[],events:{},touchAction:"compute",tabIndex:0,cssProps:{},...t},this.events=new Map,this.element=e,e){this.manager=new nT(e,this.options);for(const e of this.options.recognizers){const{recognizer:t,recognizeWith:n,requireFailure:r}=ST(e);this.manager.add(t),n&&t.recognizeWith(n),r&&t.requireFailure(r)}this.manager.on("hammer.input",this._onBasicInput),this.wheelInput=new pT(e,this._onOtherEvent,{enable:!1}),this.moveInput=new gT(e,this._onOtherEvent,{enable:!1}),this.keyInput=new yT(e,this._onOtherEvent,{enable:!1,tabIndex:t.tabIndex}),this.contextmenuInput=new vT(e,this._onOtherEvent,{enable:!1}),this.on(this.options.events)}}getElement(){return this.element}destroy(){this.element&&(this.wheelInput.destroy(),this.moveInput.destroy(),this.keyInput.destroy(),this.contextmenuInput.destroy(),this.manager.destroy())}on(e,t,n){this._addEventHandler(e,t,n,!1)}once(e,t,n){this._addEventHandler(e,t,n,!0)}watch(e,t,n){this._addEventHandler(e,t,n,!1,!0)}off(e,t){this._removeEventHandler(e,t)}_toggleRecognizer(e,t){const{manager:n}=this;if(!n)return;const r=n.get(e);r&&(r.set({enable:t}),n.touchAction.update()),this.wheelInput?.enableEventType(e,t),this.moveInput?.enableEventType(e,t),this.keyInput?.enableEventType(e,t),this.contextmenuInput?.enableEventType(e,t)}_addEventHandler(e,t,n,r,o){if("string"!=typeof e){n=t;for(const[t,i]of Object.entries(e))this._addEventHandler(t,i,n,r,o);return}const{manager:i,events:s}=this;if(!i)return;let a=s.get(e);if(!a){const t=this._getRecognizerName(e)||e;a=new CT(this,t),s.set(e,a),i&&i.on(e,a.handleEvent)}a.add(e,t,n,r,o),a.isEmpty()||this._toggleRecognizer(a.recognizerName,!0)}_removeEventHandler(e,t){if("string"!=typeof e){for(const[t,n]of Object.entries(e))this._removeEventHandler(t,n);return}const{events:n}=this,r=n.get(e);if(r&&(r.remove(e,t),r.isEmpty())){const{recognizerName:e}=r;let t=!1;for(const r of n.values())if(r.recognizerName===e&&!r.isEmpty()){t=!0;break}t||this._toggleRecognizer(e,!1)}}_getRecognizerName(e){return this.manager.recognizers.find(t=>t.getEventNames().includes(e))?.options.event}}const BT={DEFAULT:-1,LNGLAT:1,METER_OFFSETS:2,LNGLAT_OFFSETS:3,CARTESIAN:0};Object.defineProperty(BT,"IDENTITY",{get:()=>(AC.deprecated("COORDINATE_SYSTEM.IDENTITY","COORDINATE_SYSTEM.CARTESIAN")(),0)});const IT={WEB_MERCATOR:1,GLOBE:2,WEB_MERCATOR_AUTO_OFFSET:4,IDENTITY:0},RT={common:0,meters:1,pixels:2},kT={click:"onClick",dblclick:"onClick",panstart:"onDragStart",panmove:"onDrag",panend:"onDragEnd"},TT={multipan:[cT,{threshold:10,direction:Rk.Vertical,pointers:2}],pinch:[class extends sT{constructor(e={}){super({enable:!0,event:"pinch",threshold:0,pointers:2,...e})}getTouchAction(){return[Mk]}getEventNames(){return uT.map(e=>this.options.event+e)}attrTest(e){return super.attrTest(e)&&(Math.abs(e.scale-1)>this.options.threshold||Boolean(this.state&Tk.Began))}emit(e){if(1!==e.scale){const t=e.scale<1?"in":"out";e.additionalEvent=this.options.event+t}super.emit(e)}},{},null,["multipan"]],pan:[cT,{threshold:1},["pinch"],["multipan"]],dblclick:[aT,{event:"dblclick",taps:2}],click:[aT,{event:"click"},null,["dblclick"]]};function PT(e,t){if(e===t)return!0;if(Array.isArray(e)){const n=e.length;if(!t||t.length!==n)return!1;for(let r=0;r<n;r++)if(e[r]!==t[r])return!1;return!0}return!1}function FT(e){let t,n={};return r=>{for(const o in r)if(!PT(r[o],n[o])){t=e(r),n=r;break}return t}}const MT=[0,0,0,0],LT=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,0],UT=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],OT=[0,0,0],DT=[0,0,0],NT=FT(function({viewport:e,devicePixelRatio:t,coordinateSystem:n,coordinateOrigin:r}){const{projectionCenter:o,viewProjectionMatrix:i,originCommon:s,cameraPosCommon:a,shaderCoordinateOrigin:l,geospatialOrigin:c}=function(e,t,n){const{viewMatrixUncentered:r,projectionMatrix:o}=e;let{viewMatrix:i,viewProjectionMatrix:s}=e,a=MT,l=MT,c=e.cameraPosition;const{geospatialOrigin:u,shaderCoordinateOrigin:d,offsetMode:A}=jT(e,t,n);A&&(l=e.projectPosition(u||d),c=[c[0]-l[0],c[1]-l[1],c[2]-l[2]],l[3]=1,a=OR([],l,s),i=r||i,s=RR([],o,i),s=RR([],s,LT));return{viewMatrix:i,viewProjectionMatrix:s,projectionCenter:a,originCommon:l,cameraPosCommon:c,shaderCoordinateOrigin:d,geospatialOrigin:u}}(e,n,r),u=e.getDistanceScales(),d=[e.width*t,e.height*t],A=OR([],[0,0,-e.focalDistance,1],e.projectionMatrix)[3]||1,h={coordinateSystem:n,projectionMode:e.projectionMode,coordinateOrigin:l,commonOrigin:s.slice(0,3),center:o,pseudoMeters:Boolean(e._pseudoMeters),viewportSize:d,devicePixelRatio:t,focalDistance:A,commonUnitsPerMeter:u.unitsPerMeter,commonUnitsPerWorldUnit:u.unitsPerMeter,commonUnitsPerWorldUnit2:OT,scale:e.scale,wrapLongitude:!1,viewProjectionMatrix:i,modelMatrix:UT,cameraPosition:a};if(c){const t=e.getDistanceScales(c);switch(n){case BT.METER_OFFSETS:h.commonUnitsPerWorldUnit=t.unitsPerMeter,h.commonUnitsPerWorldUnit2=t.unitsPerMeter2;break;case BT.LNGLAT:case BT.LNGLAT_OFFSETS:e._pseudoMeters||(h.commonUnitsPerMeter=t.unitsPerMeter),h.commonUnitsPerWorldUnit=t.unitsPerDegree,h.commonUnitsPerWorldUnit2=t.unitsPerDegree2;break;case BT.CARTESIAN:h.commonUnitsPerWorldUnit=[1,1,t.unitsPerMeter[2]],h.commonUnitsPerWorldUnit2=[0,0,t.unitsPerMeter2[2]]}}return h});function jT(e,t,n=DT){n.length<3&&(n=[n[0],n[1],0]);let r,o=n,i=!0;switch(r=t===BT.LNGLAT_OFFSETS||t===BT.METER_OFFSETS?n:e.isGeospatial?[Math.fround(e.longitude),Math.fround(e.latitude),0]:null,e.projectionMode){case IT.WEB_MERCATOR:t!==BT.LNGLAT&&t!==BT.CARTESIAN||(r=[0,0,0],i=!1);break;case IT.WEB_MERCATOR_AUTO_OFFSET:t===BT.LNGLAT?o=r:t===BT.CARTESIAN&&(o=[Math.fround(e.center[0]),Math.fround(e.center[1]),0],r=e.unprojectPosition(o),o[0]-=n[0],o[1]-=n[1],o[2]-=n[2]);break;case IT.IDENTITY:o=e.position.map(Math.fround),o[2]=o[2]||0;break;case IT.GLOBE:i=!1,r=null;break;default:i=!1}return{geospatialOrigin:r,shaderCoordinateOrigin:o,offsetMode:i}}const QT=`${`${Object.keys(BT).map(e=>`const COORDINATE_SYSTEM_${e}: i32 = ${BT[e]};`).join("")}\n${Object.keys(IT).map(e=>`const PROJECTION_MODE_${e}: i32 = ${IT[e]};`).join("")}\n${Object.keys(RT).map(e=>`const UNIT_${e.toUpperCase()}: i32 = ${RT[e]};`).join("")}\n\nconst TILE_SIZE: f32 = 512.0;\nconst PI: f32 = 3.1415926536;\nconst WORLD_SCALE: f32 = TILE_SIZE / (PI * 2.0);\nconst ZERO_64_LOW: vec3<f32> = vec3<f32>(0.0, 0.0, 0.0);\nconst EARTH_RADIUS: f32 = 6370972.0; // meters\nconst GLOBE_RADIUS: f32 = 256.0;\n\n// -----------------------------------------------------------------------------\n// Uniform block (converted from GLSL uniform block)\n// -----------------------------------------------------------------------------\nstruct ProjectUniforms {\n  wrapLongitude: i32,\n  coordinateSystem: i32,\n  commonUnitsPerMeter: vec3<f32>,\n  projectionMode: i32,\n  scale: f32,\n  commonUnitsPerWorldUnit: vec3<f32>,\n  commonUnitsPerWorldUnit2: vec3<f32>,\n  center: vec4<f32>,\n  modelMatrix: mat4x4<f32>,\n  viewProjectionMatrix: mat4x4<f32>,\n  viewportSize: vec2<f32>,\n  devicePixelRatio: f32,\n  focalDistance: f32,\n  cameraPosition: vec3<f32>,\n  coordinateOrigin: vec3<f32>,\n  commonOrigin: vec3<f32>,\n  pseudoMeters: i32,\n};\n\n@group(0) @binding(0)\nvar<uniform> project: ProjectUniforms;\n\n// -----------------------------------------------------------------------------\n// Geometry data\n// (In your GLSL code, "geometry" was assumed to be available globally. In WGSL,\n// you might supply this via vertex attributes or a uniform. Here we define a\n// uniform struct for demonstration.)\n// -----------------------------------------------------------------------------\n\n// Structure to carry additional geometry data used by deck.gl filters.\nstruct Geometry {\n  worldPosition: vec3<f32>,\n  worldPositionAlt: vec3<f32>,\n  position: vec4<f32>,\n  uv: vec2<f32>,\n  pickingColor: vec3<f32>,\n};\n\n// @group(0) @binding(1)\nvar<private> geometry: Geometry;\n`}\n\n// -----------------------------------------------------------------------------\n// Functions\n// -----------------------------------------------------------------------------\n\n// Returns an adjustment factor for commonUnitsPerMeter\nfn _project_size_at_latitude(lat: f32) -> f32 {\n  let y = clamp(lat, -89.9, 89.9);\n  return 1.0 / cos(radians(y));\n}\n\n// Overloaded version: scales a value in meters at a given latitude.\nfn _project_size_at_latitude_m(meters: f32, lat: f32) -> f32 {\n  return meters * project.commonUnitsPerMeter.z * _project_size_at_latitude(lat);\n}\n\n// Computes a non-linear scale factor based on geometry.\n// (Note: This function relies on "geometry" being provided.)\nfn project_size() -> f32 {\n  if (project.projectionMode == PROJECTION_MODE_WEB_MERCATOR &&\n      project.coordinateSystem == COORDINATE_SYSTEM_LNGLAT &&\n      project.pseudoMeters == 0) {\n    if (geometry.position.w == 0.0) {\n      return _project_size_at_latitude(geometry.worldPosition.y);\n    }\n    let y: f32 = geometry.position.y / TILE_SIZE * 2.0 - 1.0;\n    let y2 = y * y;\n    let y4 = y2 * y2;\n    let y6 = y4 * y2;\n    return 1.0 + 4.9348 * y2 + 4.0587 * y4 + 1.5642 * y6;\n  }\n  return 1.0;\n}\n\n// Overloads to scale offsets (meters to world units)\nfn project_size_float(meters: f32) -> f32 {\n  return meters * project.commonUnitsPerMeter.z * project_size();\n}\n\nfn project_size_vec2(meters: vec2<f32>) -> vec2<f32> {\n  return meters * project.commonUnitsPerMeter.xy * project_size();\n}\n\nfn project_size_vec3(meters: vec3<f32>) -> vec3<f32> {\n  return meters * project.commonUnitsPerMeter * project_size();\n}\n\nfn project_size_vec4(meters: vec4<f32>) -> vec4<f32> {\n  return vec4<f32>(meters.xyz * project.commonUnitsPerMeter, meters.w);\n}\n\n// Returns a rotation matrix aligning the zaxis with the given up vector.\nfn project_get_orientation_matrix(up: vec3<f32>) -> mat3x3<f32> {\n  let uz = normalize(up);\n  let ux = select(\n    vec3<f32>(1.0, 0.0, 0.0),\n    normalize(vec3<f32>(uz.y, -uz.x, 0.0)),\n    abs(uz.z) == 1.0\n  );\n  let uy = cross(uz, ux);\n  return mat3x3<f32>(ux, uy, uz);\n}\n\n// Since WGSL does not support "out" parameters, we return a struct.\nstruct RotationResult {\n  needsRotation: bool,\n  transform: mat3x3<f32>,\n};\n\nfn project_needs_rotation(commonPosition: vec3<f32>) -> RotationResult {\n  if (project.projectionMode == PROJECTION_MODE_GLOBE) {\n    return RotationResult(true, project_get_orientation_matrix(commonPosition));\n  } else {\n    return RotationResult(false, mat3x3<f32>());  // identity alternative if needed\n  };\n}\n\n// Projects a normal vector from the current coordinate system to world space.\nfn project_normal(vector: vec3<f32>) -> vec3<f32> {\n  let normal_modelspace = project.modelMatrix * vec4<f32>(vector, 0.0);\n  var n = normalize(normal_modelspace.xyz * project.commonUnitsPerMeter);\n  let rotResult = project_needs_rotation(geometry.position.xyz);\n  if (rotResult.needsRotation) {\n    n = rotResult.transform * n;\n  }\n  return n;\n}\n\n// Applies a scale offset based on y-offset (dy)\nfn project_offset_(offset: vec4<f32>) -> vec4<f32> {\n  let dy: f32 = offset.y;\n  let commonUnitsPerWorldUnit = project.commonUnitsPerWorldUnit + project.commonUnitsPerWorldUnit2 * dy;\n  return vec4<f32>(offset.xyz * commonUnitsPerWorldUnit, offset.w);\n}\n\n// Projects lng/lat coordinates to a unit tile [0,1]\nfn project_mercator_(lnglat: vec2<f32>) -> vec2<f32> {\n  var x = lnglat.x;\n  if (project.wrapLongitude != 0) {\n    x = ((x + 180.0) % 360.0) - 180.0;\n  }\n  let y = clamp(lnglat.y, -89.9, 89.9);\n  return vec2<f32>(\n    radians(x) + PI,\n    PI + log(tan(PI * 0.25 + radians(y) * 0.5))\n  ) * WORLD_SCALE;\n}\n\n// Projects lng/lat/z coordinates for a globe projection.\nfn project_globe_(lnglatz: vec3<f32>) -> vec3<f32> {\n  let lambda = radians(lnglatz.x);\n  let phi = radians(lnglatz.y);\n  let cosPhi = cos(phi);\n  let D = (lnglatz.z / EARTH_RADIUS + 1.0) * GLOBE_RADIUS;\n  return vec3<f32>(\n    sin(lambda) * cosPhi,\n    -cos(lambda) * cosPhi,\n    sin(phi)\n  ) * D;\n}\n\n// Projects positions (with an optional 64-bit low part) from the input\n// coordinate system to the common space.\nfn project_position_vec4_f64(position: vec4<f32>, position64Low: vec3<f32>) -> vec4<f32> {\n  var position_world = project.modelMatrix * position;\n\n  // Work around for a Mac+NVIDIA bug:\n  if (project.projectionMode == PROJECTION_MODE_WEB_MERCATOR) {\n    if (project.coordinateSystem == COORDINATE_SYSTEM_LNGLAT) {\n      return vec4<f32>(\n        project_mercator_(position_world.xy),\n        _project_size_at_latitude_m(position_world.z, position_world.y),\n        position_world.w\n      );\n    }\n    if (project.coordinateSystem == COORDINATE_SYSTEM_CARTESIAN) {\n      position_world = vec4f(position_world.xyz + project.coordinateOrigin, position_world.w);\n    }\n  }\n  if (project.projectionMode == PROJECTION_MODE_GLOBE) {\n    if (project.coordinateSystem == COORDINATE_SYSTEM_LNGLAT) {\n      return vec4<f32>(\n        project_globe_(position_world.xyz),\n        position_world.w\n      );\n    }\n  }\n  if (project.projectionMode == PROJECTION_MODE_WEB_MERCATOR_AUTO_OFFSET) {\n    if (project.coordinateSystem == COORDINATE_SYSTEM_LNGLAT) {\n      if (abs(position_world.y - project.coordinateOrigin.y) > 0.25) {\n        return vec4<f32>(\n          project_mercator_(position_world.xy) - project.commonOrigin.xy,\n          project_size_float(position_world.z),\n          position_world.w\n        );\n      }\n    }\n  }\n  if (project.projectionMode == PROJECTION_MODE_IDENTITY ||\n      (project.projectionMode == PROJECTION_MODE_WEB_MERCATOR_AUTO_OFFSET &&\n       (project.coordinateSystem == COORDINATE_SYSTEM_LNGLAT ||\n        project.coordinateSystem == COORDINATE_SYSTEM_CARTESIAN))) {\n    position_world = vec4f(position_world.xyz - project.coordinateOrigin, position_world.w);\n  }\n\n  return project_offset_(position_world) +\n         project_offset_(project.modelMatrix * vec4<f32>(position64Low, 0.0));\n}\n\n// Overloaded versions for different input types.\nfn project_position_vec4_f32(position: vec4<f32>) -> vec4<f32> {\n  return project_position_vec4_f64(position, ZERO_64_LOW);\n}\n\nfn project_position_vec3_f64(position: vec3<f32>, position64Low: vec3<f32>) -> vec3<f32> {\n  let projected_position = project_position_vec4_f64(vec4<f32>(position, 1.0), position64Low);\n  return projected_position.xyz;\n}\n\nfn project_position_vec3_f32(position: vec3<f32>) -> vec3<f32> {\n  let projected_position = project_position_vec4_f64(vec4<f32>(position, 1.0), ZERO_64_LOW);\n  return projected_position.xyz;\n}\n\nfn project_position_vec2_f32(position: vec2<f32>) -> vec2<f32> {\n  let projected_position = project_position_vec4_f64(vec4<f32>(position, 0.0, 1.0), ZERO_64_LOW);\n  return projected_position.xy;\n}\n\n// Transforms a common space position to clip space.\nfn project_common_position_to_clipspace_with_projection(position: vec4<f32>, viewProjectionMatrix: mat4x4<f32>, center: vec4<f32>) -> vec4<f32> {\n  return viewProjectionMatrix * position + center;\n}\n\n// Uses the project viewProjectionMatrix and center.\nfn project_common_position_to_clipspace(position: vec4<f32>) -> vec4<f32> {\n  return project_common_position_to_clipspace_with_projection(position, project.viewProjectionMatrix, project.center);\n}\n\n// Returns a clip space offset corresponding to a given number of screen pixels.\nfn project_pixel_size_to_clipspace(pixels: vec2<f32>) -> vec2<f32> {\n  let offset = pixels / project.viewportSize * project.devicePixelRatio * 2.0;\n  return offset * project.focalDistance;\n}\n\nfn project_meter_size_to_pixel(meters: f32) -> f32 {\n  return project_size_float(meters) * project.scale;\n}\n\nfn project_unit_size_to_pixel(size: f32, unit: i32) -> f32 {\n  if (unit == UNIT_METERS) {\n    return project_meter_size_to_pixel(size);\n  } else if (unit == UNIT_COMMON) {\n    return size * project.scale;\n  }\n  // UNIT_PIXELS: no scaling applied.\n  return size;\n}\n\nfn project_pixel_size_float(pixels: f32) -> f32 {\n  return pixels / project.scale;\n}\n\nfn project_pixel_size_vec2(pixels: vec2<f32>) -> vec2<f32> {\n  return pixels / project.scale;\n}\n`,zT=Object.keys(BT).map(e=>`const int COORDINATE_SYSTEM_${e} = ${BT[e]};`).join(""),HT=Object.keys(IT).map(e=>`const int PROJECTION_MODE_${e} = ${IT[e]};`).join(""),GT=Object.keys(RT).map(e=>`const int UNIT_${e.toUpperCase()} = ${RT[e]};`).join(""),VT={};const WT={name:"project",dependencies:[uk,Ek],source:QT,vs:`${zT}\n${HT}\n${GT}\nuniform projectUniforms {\nbool wrapLongitude;\nint coordinateSystem;\nvec3 commonUnitsPerMeter;\nint projectionMode;\nfloat scale;\nvec3 commonUnitsPerWorldUnit;\nvec3 commonUnitsPerWorldUnit2;\nvec4 center;\nmat4 modelMatrix;\nmat4 viewProjectionMatrix;\nvec2 viewportSize;\nfloat devicePixelRatio;\nfloat focalDistance;\nvec3 cameraPosition;\nvec3 coordinateOrigin;\nvec3 commonOrigin;\nbool pseudoMeters;\n} project;\nconst float TILE_SIZE = 512.0;\nconst float PI = 3.1415926536;\nconst float WORLD_SCALE = TILE_SIZE / (PI * 2.0);\nconst vec3 ZERO_64_LOW = vec3(0.0);\nconst float EARTH_RADIUS = 6370972.0;\nconst float GLOBE_RADIUS = 256.0;\nfloat project_size_at_latitude(float lat) {\nfloat y = clamp(lat, -89.9, 89.9);\nreturn 1.0 / cos(radians(y));\n}\nfloat project_size() {\nif (project.projectionMode == PROJECTION_MODE_WEB_MERCATOR &&\nproject.coordinateSystem == COORDINATE_SYSTEM_LNGLAT &&\nproject.pseudoMeters == false) {\nif (geometry.position.w == 0.0) {\nreturn project_size_at_latitude(geometry.worldPosition.y);\n}\nfloat y = geometry.position.y / TILE_SIZE * 2.0 - 1.0;\nfloat y2 = y * y;\nfloat y4 = y2 * y2;\nfloat y6 = y4 * y2;\nreturn 1.0 + 4.9348 * y2 + 4.0587 * y4 + 1.5642 * y6;\n}\nreturn 1.0;\n}\nfloat project_size_at_latitude(float meters, float lat) {\nreturn meters * project.commonUnitsPerMeter.z * project_size_at_latitude(lat);\n}\nfloat project_size(float meters) {\nreturn meters * project.commonUnitsPerMeter.z * project_size();\n}\nvec2 project_size(vec2 meters) {\nreturn meters * project.commonUnitsPerMeter.xy * project_size();\n}\nvec3 project_size(vec3 meters) {\nreturn meters * project.commonUnitsPerMeter * project_size();\n}\nvec4 project_size(vec4 meters) {\nreturn vec4(meters.xyz * project.commonUnitsPerMeter, meters.w);\n}\nmat3 project_get_orientation_matrix(vec3 up) {\nvec3 uz = normalize(up);\nvec3 ux = abs(uz.z) == 1.0 ? vec3(1.0, 0.0, 0.0) : normalize(vec3(uz.y, -uz.x, 0));\nvec3 uy = cross(uz, ux);\nreturn mat3(ux, uy, uz);\n}\nbool project_needs_rotation(vec3 commonPosition, out mat3 transform) {\nif (project.projectionMode == PROJECTION_MODE_GLOBE) {\ntransform = project_get_orientation_matrix(commonPosition);\nreturn true;\n}\nreturn false;\n}\nvec3 project_normal(vec3 vector) {\nvec4 normal_modelspace = project.modelMatrix * vec4(vector, 0.0);\nvec3 n = normalize(normal_modelspace.xyz * project.commonUnitsPerMeter);\nmat3 rotation;\nif (project_needs_rotation(geometry.position.xyz, rotation)) {\nn = rotation * n;\n}\nreturn n;\n}\nvec4 project_offset_(vec4 offset) {\nfloat dy = offset.y;\nvec3 commonUnitsPerWorldUnit = project.commonUnitsPerWorldUnit + project.commonUnitsPerWorldUnit2 * dy;\nreturn vec4(offset.xyz * commonUnitsPerWorldUnit, offset.w);\n}\nvec2 project_mercator_(vec2 lnglat) {\nfloat x = lnglat.x;\nif (project.wrapLongitude) {\nx = mod(x + 180., 360.0) - 180.;\n}\nfloat y = clamp(lnglat.y, -89.9, 89.9);\nreturn vec2(\nradians(x) + PI,\nPI + log(tan_fp32(PI * 0.25 + radians(y) * 0.5))\n) * WORLD_SCALE;\n}\nvec3 project_globe_(vec3 lnglatz) {\nfloat lambda = radians(lnglatz.x);\nfloat phi = radians(lnglatz.y);\nfloat cosPhi = cos(phi);\nfloat D = (lnglatz.z / EARTH_RADIUS + 1.0) * GLOBE_RADIUS;\nreturn vec3(\nsin(lambda) * cosPhi,\n-cos(lambda) * cosPhi,\nsin(phi)\n) * D;\n}\nvec4 project_position(vec4 position, vec3 position64Low) {\nvec4 position_world = project.modelMatrix * position;\nif (project.projectionMode == PROJECTION_MODE_WEB_MERCATOR) {\nif (project.coordinateSystem == COORDINATE_SYSTEM_LNGLAT) {\nreturn vec4(\nproject_mercator_(position_world.xy),\nproject_size_at_latitude(position_world.z, position_world.y),\nposition_world.w\n);\n}\nif (project.coordinateSystem == COORDINATE_SYSTEM_CARTESIAN) {\nposition_world.xyz += project.coordinateOrigin;\n}\n}\nif (project.projectionMode == PROJECTION_MODE_GLOBE) {\nif (project.coordinateSystem == COORDINATE_SYSTEM_LNGLAT) {\nreturn vec4(\nproject_globe_(position_world.xyz),\nposition_world.w\n);\n}\n}\nif (project.projectionMode == PROJECTION_MODE_WEB_MERCATOR_AUTO_OFFSET) {\nif (project.coordinateSystem == COORDINATE_SYSTEM_LNGLAT) {\nif (abs(position_world.y - project.coordinateOrigin.y) > 0.25) {\nreturn vec4(\nproject_mercator_(position_world.xy) - project.commonOrigin.xy,\nproject_size(position_world.z),\nposition_world.w\n);\n}\n}\n}\nif (project.projectionMode == PROJECTION_MODE_IDENTITY ||\n(project.projectionMode == PROJECTION_MODE_WEB_MERCATOR_AUTO_OFFSET &&\n(project.coordinateSystem == COORDINATE_SYSTEM_LNGLAT ||\nproject.coordinateSystem == COORDINATE_SYSTEM_CARTESIAN))) {\nposition_world.xyz -= project.coordinateOrigin;\n}\nreturn project_offset_(position_world) + project_offset_(project.modelMatrix * vec4(position64Low, 0.0));\n}\nvec4 project_position(vec4 position) {\nreturn project_position(position, ZERO_64_LOW);\n}\nvec3 project_position(vec3 position, vec3 position64Low) {\nvec4 projected_position = project_position(vec4(position, 1.0), position64Low);\nreturn projected_position.xyz;\n}\nvec3 project_position(vec3 position) {\nvec4 projected_position = project_position(vec4(position, 1.0), ZERO_64_LOW);\nreturn projected_position.xyz;\n}\nvec2 project_position(vec2 position) {\nvec4 projected_position = project_position(vec4(position, 0.0, 1.0), ZERO_64_LOW);\nreturn projected_position.xy;\n}\nvec4 project_common_position_to_clipspace(vec4 position, mat4 viewProjectionMatrix, vec4 center) {\nreturn viewProjectionMatrix * position + center;\n}\nvec4 project_common_position_to_clipspace(vec4 position) {\nreturn project_common_position_to_clipspace(position, project.viewProjectionMatrix, project.center);\n}\nvec2 project_pixel_size_to_clipspace(vec2 pixels) {\nvec2 offset = pixels / project.viewportSize * project.devicePixelRatio * 2.0;\nreturn offset * project.focalDistance;\n}\nfloat project_size_to_pixel(float meters) {\nreturn project_size(meters) * project.scale;\n}\nfloat project_size_to_pixel(float size, int unit) {\nif (unit == UNIT_METERS) return project_size_to_pixel(size);\nif (unit == UNIT_COMMON) return size * project.scale;\nreturn size;\n}\nfloat project_pixel_size(float pixels) {\nreturn pixels / project.scale;\n}\nvec2 project_pixel_size(vec2 pixels) {\nreturn pixels / project.scale;\n}\n`,getUniforms:function(e=VT){return"viewport"in e?function({viewport:e,devicePixelRatio:t=1,modelMatrix:n=null,coordinateSystem:r=BT.DEFAULT,coordinateOrigin:o=DT,autoWrapLongitude:i=!1}){r===BT.DEFAULT&&(r=e.isGeospatial?BT.LNGLAT:BT.CARTESIAN);const s=NT({viewport:e,devicePixelRatio:t,coordinateSystem:r,coordinateOrigin:o});return s.wrapLongitude=i,s.modelMatrix=n||UT,s}(e):{}},uniformTypes:{wrapLongitude:"f32",coordinateSystem:"i32",commonUnitsPerMeter:"vec3<f32>",projectionMode:"i32",scale:"f32",commonUnitsPerWorldUnit:"vec3<f32>",commonUnitsPerWorldUnit2:"vec3<f32>",center:"vec4<f32>",modelMatrix:"mat4x4<f32>",viewProjectionMatrix:"mat4x4<f32>",viewportSize:"vec2<f32>",devicePixelRatio:"f32",focalDistance:"f32",cameraPosition:"vec3<f32>",coordinateOrigin:"vec3<f32>",commonOrigin:"vec3<f32>",pseudoMeters:"f32"}},$T={name:"project32",dependencies:[WT],source:"// Define a structure to hold both the clip-space position and the common position.\nstruct ProjectResult {\n  clipPosition: vec4<f32>,\n  commonPosition: vec4<f32>,\n};\n\n// This function mimics the GLSL version with the 'out' parameter by returning both values.\nfn project_position_to_clipspace_and_commonspace(\n    position: vec3<f32>,\n    position64Low: vec3<f32>,\n    offset: vec3<f32>\n) -> ProjectResult {\n  // Compute the projected position.\n  let projectedPosition: vec3<f32> = project_position_vec3_f64(position, position64Low);\n\n  // Start with the provided offset.\n  var finalOffset: vec3<f32> = offset;\n\n  // Get whether a rotation is needed and the rotation matrix.\n  let rotationResult = project_needs_rotation(projectedPosition);\n\n  // If rotation is needed, update the offset.\n  if (rotationResult.needsRotation) {\n    finalOffset = rotationResult.transform * offset;\n  }\n\n  // Compute the common position.\n  let commonPosition: vec4<f32> = vec4<f32>(projectedPosition + finalOffset, 1.0);\n\n  // Convert to clip-space.\n  let clipPosition: vec4<f32> = project_common_position_to_clipspace(commonPosition);\n\n  return ProjectResult(clipPosition, commonPosition);\n}\n\n// A convenience overload that returns only the clip-space position.\nfn project_position_to_clipspace(\n    position: vec3<f32>,\n    position64Low: vec3<f32>,\n    offset: vec3<f32>\n) -> vec4<f32> {\n  return project_position_to_clipspace_and_commonspace(position, position64Low, offset).clipPosition;\n}\n",vs:"vec4 project_position_to_clipspace(\n  vec3 position, vec3 position64Low, vec3 offset, out vec4 commonPosition\n) {\n  vec3 projectedPosition = project_position(position, position64Low);\n  mat3 rotation;\n  if (project_needs_rotation(projectedPosition, rotation)) {\n    // offset is specified as ENU\n    // when in globe projection, rotate offset so that the ground alighs with the surface of the globe\n    offset = rotation * offset;\n  }\n  commonPosition = vec4(projectedPosition + offset, 1.0);\n  return project_common_position_to_clipspace(commonPosition);\n}\n\nvec4 project_position_to_clipspace(\n  vec3 position, vec3 position64Low, vec3 offset\n) {\n  vec4 commonPosition;\n  return project_position_to_clipspace(position, position64Low, offset, commonPosition);\n}\n"};function KT(e,t){const n=OR([],t,e);return UR(n,n,1/n[3]),n}function XT(e,t){const n=e%t;return n<0?t+n:n}function YT(e,t,n){return e<t?t:e>n?n:e}const qT=Math.log2||function(e){return Math.log(e)*Math.LOG2E};function JT(e,t){if(!e)throw new Error(t||"@math.gl/web-mercator: assertion failed.")}const ZT=Math.PI,eP=ZT/4,tP=ZT/180,nP=180/ZT,rP=512,oP=4003e4,iP=85.051129,sP=1.5;function aP(e){const[t,n]=e;JT(Number.isFinite(t)),JT(Number.isFinite(n)&&n>=-90&&n<=90,"invalid latitude");const r=n*tP;return[rP*(t*tP+ZT)/(2*ZT),rP*(ZT+Math.log(Math.tan(eP+.5*r)))/(2*ZT)]}function lP(e){const[t,n]=e,r=t/rP*(2*ZT)-ZT,o=2*(Math.atan(Math.exp(n/rP*(2*ZT)-ZT))-eP);return[r*nP,o*nP]}function cP(e){const{latitude:t}=e;JT(Number.isFinite(t));const n=Math.cos(t*tP);return qT(oP*n)-9}function uP(e){return 12790407194604047e-21/Math.cos(e*tP)}function dP(e){const{latitude:t,longitude:n,highPrecision:r=!1}=e;JT(Number.isFinite(t)&&Number.isFinite(n));const o=rP,i=Math.cos(t*tP),s=o/360,a=s/i,l=12790407194604047e-21/i,c={unitsPerMeter:[l,l,l],metersPerUnit:[1/l,1/l,1/l],unitsPerDegree:[s,a,l],degreesPerUnit:[.703125,1/a,1/l]};if(r){const e=tP*Math.tan(t*tP)/i,n=s*e/2,r=12790407194604047e-21*e,o=r/a*l;c.unitsPerDegree2=[0,n,r],c.unitsPerMeter2=[o,0,o]}return c}function AP(e,t){const[n,r,o]=e,[i,s,a]=t,{unitsPerMeter:l,unitsPerMeter2:c}=dP({longitude:n,latitude:r,highPrecision:!0}),u=aP(e);u[0]+=i*(l[0]+c[0]*s),u[1]+=s*(l[1]+c[1]*s);const d=lP(u),A=(o||0)+(a||0);return Number.isFinite(o)||Number.isFinite(a)?[d[0],d[1],A]:d}function hP(e){return 2*Math.atan(.5/e)*nP}function pP(e){return.5/Math.tan(.5*e*tP)}function fP(e,t){const[n,r,o=0]=e;return JT(Number.isFinite(n)&&Number.isFinite(r)&&Number.isFinite(o)),KT(t,[n,r,o,1])}function gP(e,t,n=0){const[r,o,i]=e;if(JT(Number.isFinite(r)&&Number.isFinite(o),"invalid pixel coordinate"),Number.isFinite(i)){return KT(t,[r,o,i,1])}const s=KT(t,[r,o,0,1]),a=KT(t,[r,o,1,1]),l=s[2],c=a[2];return qI([],s,a,l===c?0:((n||0)-l)/(c-l))}function mP(e){const{width:t,height:n,bounds:r,minExtent:o=0,maxZoom:i=24,offset:s=[0,0]}=e,[[a,l],[c,u]]=r,d=function(e=0){if("number"==typeof e)return{top:e,bottom:e,left:e,right:e};return JT(Number.isFinite(e.top)&&Number.isFinite(e.bottom)&&Number.isFinite(e.left)&&Number.isFinite(e.right)),e}(e.padding),A=aP([a,YT(u,-85.051129,iP)]),h=aP([c,YT(l,-85.051129,iP)]),p=[Math.max(Math.abs(h[0]-A[0]),o),Math.max(Math.abs(h[1]-A[1]),o)],f=[t-d.left-d.right-2*Math.abs(s[0]),n-d.top-d.bottom-2*Math.abs(s[1])];JT(f[0]>0&&f[1]>0);const g=f[0]/p[0],m=f[1]/p[1],y=(d.right-d.left)/2/g,v=(d.top-d.bottom)/2/m,b=lP([(h[0]+A[0])/2+y,(h[1]+A[1])/2+v]),w=Math.min(i,qT(Math.abs(Math.min(g,m))));return JT(Number.isFinite(w)),{longitude:b[0],latitude:b[1],zoom:w}}const yP=Math.PI/180;function vP(e,t,n){const{pixelUnprojectionMatrix:r}=e,o=KT(r,[t,0,1,1]),i=KT(r,[t,e.height,1,1]),s=lP(qI([],o,i,(n*e.distanceScales.unitsPerMeter[2]-o[2])/(i[2]-o[2])));return s.push(n),s}const bP="\nuniform shadowUniforms {\n  bool drawShadowMap;\n  bool useShadowMap;\n  vec4 color;\n  highp int lightId;\n  float lightCount;\n  mat4 viewProjectionMatrix0;\n  mat4 viewProjectionMatrix1;\n  vec4 projectCenter0;\n  vec4 projectCenter1;\n} shadow;\n",wP=`\n${bP}\n\nconst int max_lights = 2;\n\nout vec3 shadow_vPosition[max_lights];\n\nvec4 shadow_setVertexPosition(vec4 position_commonspace) {\n  mat4 viewProjectionMatrices[max_lights];\n  viewProjectionMatrices[0] = shadow.viewProjectionMatrix0;\n  viewProjectionMatrices[1] = shadow.viewProjectionMatrix1;\n  vec4 projectCenters[max_lights];\n  projectCenters[0] = shadow.projectCenter0;\n  projectCenters[1] = shadow.projectCenter1;\n\n  if (shadow.drawShadowMap) {\n    return project_common_position_to_clipspace(position_commonspace, viewProjectionMatrices[shadow.lightId], projectCenters[shadow.lightId]);\n  }\n  if (shadow.useShadowMap) {\n    for (int i = 0; i < max_lights; i++) {\n      if(i < int(shadow.lightCount)) {\n        vec4 shadowMap_position = project_common_position_to_clipspace(position_commonspace, viewProjectionMatrices[i], projectCenters[i]);\n        shadow_vPosition[i] = (shadowMap_position.xyz / shadowMap_position.w + 1.0) / 2.0;\n      }\n    }\n  }\n  return gl_Position;\n}\n\n`,xP=`\n${bP}\n\nconst int max_lights = 2;\nuniform sampler2D shadow_uShadowMap0;\nuniform sampler2D shadow_uShadowMap1;\n\nin vec3 shadow_vPosition[max_lights];\n\nconst vec4 bitPackShift = vec4(1.0, 255.0, 65025.0, 16581375.0);\nconst vec4 bitUnpackShift = 1.0 / bitPackShift;\nconst vec4 bitMask = vec4(1.0 / 255.0, 1.0 / 255.0, 1.0 / 255.0,  0.0);\n\nfloat shadow_getShadowWeight(vec3 position, sampler2D shadowMap) {\n  vec4 rgbaDepth = texture(shadowMap, position.xy);\n\n  float z = dot(rgbaDepth, bitUnpackShift);\n  return smoothstep(0.001, 0.01, position.z - z);\n}\n\nvec4 shadow_filterShadowColor(vec4 color) {\n  if (shadow.drawShadowMap) {\n    vec4 rgbaDepth = fract(gl_FragCoord.z * bitPackShift);\n    rgbaDepth -= rgbaDepth.gbaa * bitMask;\n    return rgbaDepth;\n  }\n  if (shadow.useShadowMap) {\n    float shadowAlpha = 0.0;\n    shadowAlpha += shadow_getShadowWeight(shadow_vPosition[0], shadow_uShadowMap0);\n    if(shadow.lightCount > 1.0) {\n      shadowAlpha += shadow_getShadowWeight(shadow_vPosition[1], shadow_uShadowMap1);\n    }\n    shadowAlpha *= shadow.color.a / shadow.lightCount;\n    float blendedAlpha = shadowAlpha + color.a * (1.0 - shadowAlpha);\n\n    return vec4(\n      mix(color.rgb, shadow.color.rgb, shadowAlpha / blendedAlpha),\n      blendedAlpha\n    );\n  }\n  return color;\n}\n\n`,_P=FT(function({viewport:e,center:t}){return new GR(e.viewProjectionMatrix).invert().transform(t)}),CP=FT(function({viewport:e,shadowMatrices:t}){const n=[],r=e.pixelUnprojectionMatrix,o=e.isGeospatial?void 0:1,i=[[0,0,o],[e.width,0,o],[0,e.height,o],[e.width,e.height,o],[0,0,-1],[e.width,0,-1],[0,e.height,-1],[e.width,e.height,-1]].map(e=>function(e,t){const[n,r,o]=e,i=gP([n,r,o],t);if(Number.isFinite(o))return i;return[i[0],i[1],0]}(e,r));for(const s of t){const t=s.clone().translate(new mR(e.center).negate()),r=i.map(e=>t.transform(e)),o=(new GR).ortho({left:Math.min(...r.map(e=>e[0])),right:Math.max(...r.map(e=>e[0])),bottom:Math.min(...r.map(e=>e[1])),top:Math.max(...r.map(e=>e[1])),near:Math.min(...r.map(e=>-e[2])),far:Math.max(...r.map(e=>-e[2]))});n.push(o.multiplyRight(s))}return n}),SP=[0,0,0,1],EP=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,0];const BP={name:"shadow",dependencies:[WT],vs:wP,fs:xP,inject:{"vs:DECKGL_FILTER_GL_POSITION":"\n    position = shadow_setVertexPosition(geometry.position);\n    ","fs:DECKGL_FILTER_COLOR":"\n    color = shadow_filterShadowColor(color);\n    "},getUniforms:function(e){const{shadowEnabled:t=!0,project:n}=e;if(!(t&&n&&e.shadowMatrices&&e.shadowMatrices.length))return{drawShadowMap:!1,useShadowMap:!1,shadow_uShadowMap0:e.dummyShadowMap,shadow_uShadowMap1:e.dummyShadowMap};const r=WT.getUniforms(n),o=_P({viewport:n.viewport,center:r.center}),i=[],s=CP({shadowMatrices:e.shadowMatrices,viewport:n.viewport}).slice();for(let l=0;l<e.shadowMatrices.length;l++){const e=s[l],t=e.clone().translate(new mR(n.viewport.center).negate());r.coordinateSystem===BT.LNGLAT&&r.projectionMode===IT.WEB_MERCATOR?(s[l]=t,i[l]=o):(s[l]=e.clone().multiplyRight(EP),i[l]=t.transform(o))}const a={drawShadowMap:Boolean(e.drawToShadowMap),useShadowMap:!!e.shadowMaps&&e.shadowMaps.length>0,color:e.shadowColor||SP,lightId:e.shadowLightId||0,lightCount:e.shadowMatrices.length,shadow_uShadowMap0:e.dummyShadowMap,shadow_uShadowMap1:e.dummyShadowMap};for(let l=0;l<s.length;l++)a[`viewProjectionMatrix${l}`]=s[l],a[`projectCenter${l}`]=i[l];for(let l=0;l<2;l++)a[`shadow_uShadowMap${l}`]=e.shadowMaps&&e.shadowMaps[l]||e.dummyShadowMap;return a},uniformTypes:{drawShadowMap:"f32",useShadowMap:"f32",color:"vec4<f32>",lightId:"i32",lightCount:"f32",viewProjectionMatrix0:"mat4x4<f32>",viewProjectionMatrix1:"mat4x4<f32>",projectCenter0:"vec4<f32>",projectCenter1:"vec4<f32>"}},IP={...Ak,defaultUniforms:{...Ak.defaultUniforms,useFloatColors:!1},inject:{"vs:DECKGL_FILTER_GL_POSITION":"\n    // for picking depth values\n    picking_setPickingAttribute(position.z / position.w);\n  ","vs:DECKGL_FILTER_COLOR":"\n  picking_setPickingColor(geometry.pickingColor);\n  ","fs:DECKGL_FILTER_COLOR":{order:99,injection:"\n  // use highlight color if this fragment belongs to the selected object.\n  color = picking_filterHighlightColor(color);\n\n  // use picking color if rendering to picking FBO.\n  color = picking_filterPickingColor(color);\n    "}}},RP=[Ek],kP=["vs:DECKGL_FILTER_SIZE(inout vec3 size, VertexGeometry geometry)","vs:DECKGL_FILTER_GL_POSITION(inout vec4 position, VertexGeometry geometry)","vs:DECKGL_FILTER_COLOR(inout vec4 color, VertexGeometry geometry)","fs:DECKGL_FILTER_COLOR(inout vec4 color, FragmentGeometry geometry)"],TP=[];function PP(e){const t=qC.getDefaultShaderAssembler();for(const r of RP)t.addDefaultModule(r);const n="glsl"===e?kP:TP;for(const r of n)t.addShaderHook(r);return t}const FP=[255,255,255],MP=1;let LP=0;class UP{constructor(e={}){this.type="ambient";const{color:t=FP}=e,{intensity:n=MP}=e;this.id=e.id||"ambient-"+LP++,this.color=t,this.intensity=n}}const OP=[255,255,255],DP=1,NP=[0,0,-1];let jP=0;class QP{constructor(e={}){this.type="directional";const{color:t=OP}=e,{intensity:n=DP}=e,{direction:r=NP}=e,{_shadow:o=!1}=e;this.id=e.id||"directional-"+jP++,this.color=t,this.intensity=n,this.type="directional",this.direction=new mR(r).normalize().toArray(),this.shadow=o}getProjectedLight(e){return this}}class zP{constructor(e,t={id:"pass"}){const{id:n}=t;this.id=n,this.device=e,this.props={...t}}setProps(e){Object.assign(this.props,e)}render(e){}cleanup(){}}class HP extends zP{constructor(){super(...arguments),this._lastRenderIndex=-1}render(e){const[t,n]=this.device.canvasContext.getDrawingBufferSize(),r=e.clearCanvas??!0,o=e.clearColor??(!!r&&[0,0,0,0]),i=!!r&&1,s=!!r&&0,a=e.colorMask??15,l={viewport:[0,0,t,n]};e.colorMask&&(l.colorMask=a),e.scissorRect&&(l.scissorRect=e.scissorRect);const c=this.device.beginRenderPass({framebuffer:e.target,parameters:l,clearColor:o,clearDepth:i,clearStencil:s});try{return this._drawLayers(c,e)}finally{c.end(),this.device.submit()}}_drawLayers(e,t){const{target:n,shaderModuleProps:r,viewports:o,views:i,onViewportActive:s,clearStack:a=!0}=t;t.pass=t.pass||"unknown",a&&(this._lastRenderIndex=-1);const l=[];for(const c of o){const o=i&&i[c.id];s?.(c);const a=this._getDrawLayerParams(c,t),u=c.subViewports||[c];for(const i of u){const s=this._drawLayersInViewport(e,{target:n,shaderModuleProps:r,viewport:i,view:o,pass:t.pass,layers:t.layers},a);l.push(s)}}return l}_getDrawLayerParams(e,{layers:t,pass:n,isPicking:r=!1,layerFilter:o,cullRect:i,effects:s,shaderModuleProps:a},l=!1){const c=[],u=GP(this._lastRenderIndex+1),d={layer:t[0],viewport:e,isPicking:r,renderPass:n,cullRect:i},A={};for(let h=0;h<t.length;h++){const r=t[h],i=this._shouldDrawLayer(r,d,o,A),p={shouldDrawLayer:i};i&&!l&&(p.shouldDrawLayer=!0,p.layerRenderIndex=u(r,i),p.shaderModuleProps=this._getShaderModuleProps(r,s,n,a),p.layerParameters={...r.context.deck?.props.parameters,...this.getLayerParameters(r,h,e)}),c[h]=p}return c}_drawLayersInViewport(e,{layers:t,shaderModuleProps:n,pass:r,target:o,viewport:i,view:s},a){const l=function(e,{shaderModuleProps:t,target:n,viewport:r}){const o=t?.project?.devicePixelRatio??e.canvasContext.cssToDeviceRatio(),[,i]=e.canvasContext.getDrawingBufferSize(),s=n?n.height:i,a=r;return[a.x*o,s-(a.y+a.height)*o,a.width*o,a.height*o]}(this.device,{shaderModuleProps:n,target:o,viewport:i});if(s&&s.props.clear){const e=!0===s.props.clear?{color:!0,depth:!0}:s.props.clear;this.device.beginRenderPass({framebuffer:o,parameters:{viewport:l,scissorRect:l},clearColor:!!e.color&&[0,0,0,0],clearDepth:!!e.depth&&1}).end()}const c={totalCount:t.length,visibleCount:0,compositeCount:0,pickableCount:0};e.setParameters({viewport:l});for(let d=0;d<t.length;d++){const n=t[d],o=a[d],{shouldDrawLayer:s}=o;if(s&&n.props.pickable&&c.pickableCount++,n.isComposite&&c.compositeCount++,n.isDrawable&&o.shouldDrawLayer){const{layerRenderIndex:t,shaderModuleProps:s,layerParameters:a}=o;c.visibleCount++,this._lastRenderIndex=Math.max(this._lastRenderIndex,t),s.project&&(s.project.viewport=i),n.context.renderPass=e;try{n._drawLayer({renderPass:e,shaderModuleProps:s,uniforms:{layerIndex:t},parameters:a})}catch(u){n.raiseError(u,`drawing ${n} to ${r}`)}}}return c}shouldDrawLayer(e){return!0}getShaderModuleProps(e,t,n){return null}getLayerParameters(e,t,n){return e.props.parameters}_shouldDrawLayer(e,t,n,r){if(!(e.props.visible&&this.shouldDrawLayer(e)))return!1;t.layer=e;let o=e.parent;for(;o;){if(!o.props.visible||!o.filterSubLayer(t))return!1;t.layer=o,o=o.parent}if(n){const e=t.layer.id;if(e in r||(r[e]=n(t)),!r[e])return!1}return e.activateViewport(t.viewport),!0}_getShaderModuleProps(e,t,n,r){const o=this.device.canvasContext.cssToDeviceRatio(),i=e.internalState?.propsInTransition||e.props,s={layer:i,picking:{isActive:!1},project:{viewport:e.context.viewport,devicePixelRatio:o,modelMatrix:i.modelMatrix,coordinateSystem:i.coordinateSystem,coordinateOrigin:i.coordinateOrigin,autoWrapLongitude:e.wrapLongitude}};if(t)for(const a of t)VP(s,a.getShaderModuleProps?.(e,s));return VP(s,this.getShaderModuleProps(e,t,s),r)}}function GP(e=0,t={}){const n={},r=(o,i)=>{const s=o.props._offset,a=o.id,l=o.parent&&o.parent.id;let c;if(l&&!(l in t)&&r(o.parent,!1),l in n){const e=n[l]=n[l]||GP(t[l],t);c=e(o,i),n[a]=e}else Number.isFinite(s)?(c=s+(t[l]||0),n[a]=null):c=e;return i&&c>=e&&(e=c+1),t[a]=c,c};return r}function VP(e,...t){for(const n of t)if(n)for(const t in n)e[t]?Object.assign(e[t],n[t]):e[t]=n[t];return e}class WP extends HP{constructor(e,t){super(e,t);const n=e.createTexture({format:"rgba8unorm",width:1,height:1,sampler:{minFilter:"linear",magFilter:"linear",addressModeU:"clamp-to-edge",addressModeV:"clamp-to-edge"},mipmaps:!0}),r=e.createTexture({format:"depth16unorm",width:1,height:1,mipmaps:!1});this.fbo=e.createFramebuffer({id:"shadowmap",width:1,height:1,colorAttachments:[n],depthStencilAttachment:r})}delete(){this.fbo&&(this.fbo.destroy(),this.fbo=null)}getShadowMap(){return this.fbo.colorAttachments[0].texture}render(e){const t=this.fbo,n=this.device.canvasContext.cssToDeviceRatio(),r=e.viewports[0],o=r.width*n,i=r.height*n;o===t.width&&i===t.height||t.resize({width:o,height:i}),super.render({...e,clearColor:[1,1,1,1],target:t,pass:"shadow"})}getLayerParameters(e,t,n){return{...e.props.parameters,blend:!1,depthWriteEnabled:!0,depthCompare:"less-equal"}}shouldDrawLayer(e){return!1!==e.props.shadowEnabled}getShaderModuleProps(e,t,n){return{shadow:{project:n.project,drawToShadowMap:!0}}}}const $P={color:[255,255,255],intensity:1},KP=[{color:[255,255,255],intensity:1,direction:[-1,3,-1]},{color:[255,255,255],intensity:.9,direction:[1,-8,-2.5]}],XP=[0,0,0,200/255];class YP{constructor(e={}){this.id="lighting-effect",this.shadowColor=XP,this.shadow=!1,this.directionalLights=[],this.pointLights=[],this.shadowPasses=[],this.dummyShadowMap=null,this.setProps(e)}setup(e){this.context=e;const{device:t,deck:n}=e;this.shadow&&!this.dummyShadowMap&&(this._createShadowPasses(t),n._addDefaultShaderModule(BP),this.dummyShadowMap=t.createTexture({width:1,height:1}))}setProps(e){this.ambientLight=void 0,this.directionalLights=[],this.pointLights=[];for(const t in e){const n=e[t];switch(n.type){case"ambient":this.ambientLight=n;break;case"directional":this.directionalLights.push(n);break;case"point":this.pointLights.push(n)}}this._applyDefaultLights(),this.shadow=this.directionalLights.some(e=>e.shadow),this.context&&this.setup(this.context),this.props=e}preRender({layers:e,layerFilter:t,viewports:n,onViewportActive:r,views:o}){if(this.shadow){this.shadowMatrices=this._calculateMatrices();for(let i=0;i<this.shadowPasses.length;i++){this.shadowPasses[i].render({layers:e,layerFilter:t,viewports:n,onViewportActive:r,views:o,shaderModuleProps:{shadow:{shadowLightId:i,dummyShadowMap:this.dummyShadowMap,shadowMatrices:this.shadowMatrices}}})}}}getShaderModuleProps(e,t){const n=this.shadow?{project:t.project,shadowMaps:this.shadowPasses.map(e=>e.getShadowMap()),dummyShadowMap:this.dummyShadowMap,shadowColor:this.shadowColor,shadowMatrices:this.shadowMatrices}:{},r={enabled:!0,ambientLight:this.ambientLight,directionalLights:this.directionalLights.map(t=>t.getProjectedLight({layer:e})),pointLights:this.pointLights.map(t=>t.getProjectedLight({layer:e}))},o=e.props.material;return{shadow:n,lighting:r,phongMaterial:o,gouraudMaterial:o}}cleanup(e){for(const t of this.shadowPasses)t.delete();this.shadowPasses.length=0,this.dummyShadowMap&&(this.dummyShadowMap.destroy(),this.dummyShadowMap=null,e.deck._removeDefaultShaderModule(BP))}_calculateMatrices(){const e=[];for(const t of this.directionalLights){const n=(new GR).lookAt({eye:new mR(t.direction).negate()});e.push(n)}return e}_createShadowPasses(e){for(let t=0;t<this.directionalLights.length;t++){const n=new WP(e);this.shadowPasses[t]=n}}_applyDefaultLights(){const{ambientLight:e,pointLights:t,directionalLights:n}=this;e||0!==t.length||0!==n.length||(this.ambientLight=new UP($P),this.directionalLights.push(new QP(KP[0]),new QP(KP[1])))}}const qP=new class{constructor(e={}){this._pool=[],this.opts={overAlloc:2,poolSize:100},this.setOptions(e)}setOptions(e){Object.assign(this.opts,e)}allocate(e,t,{size:n=1,type:r,padding:o=0,copy:i=!1,initialize:s=!1,maxCount:a}){const l=r||e&&e.constructor||Float32Array,c=t*n+o;if(ArrayBuffer.isView(e)){if(c<=e.length)return e;if(c*e.BYTES_PER_ELEMENT<=e.buffer.byteLength)return new l(e.buffer,0,c)}let u=1/0;a&&(u=a*n+o);const d=this._allocate(l,c,s,u);return e&&i?d.set(e):s||d.fill(0,0,4),this._release(e),d}release(e){this._release(e)}_allocate(e,t,n,r){let o=Math.max(Math.ceil(t*this.opts.overAlloc),1);o>r&&(o=r);const i=this._pool,s=e.BYTES_PER_ELEMENT*o,a=i.findIndex(e=>e.byteLength>=s);if(a>=0){const t=new e(i.splice(a,1)[0],0,o);return n&&t.fill(0),t}return new e(o)}_release(e){if(!ArrayBuffer.isView(e))return;const t=this._pool,{buffer:n}=e,{byteLength:r}=n,o=t.findIndex(e=>e.byteLength>=r);o<0?t.push(n):(o>0||t.length<this.opts.poolSize)&&t.splice(o,0,n),t.length>this.opts.poolSize&&t.shift()}};const JP=new mR;function ZP(e,t,n,r){JP.set(e,t,n);const o=JP.len();return{distance:r/o,normal:new mR(-e/o,-t/o,-n/o)}}function eF(e){return e-Math.fround(e)}let tF;function nF(e,t){const{size:n=1,startIndex:r=0}=t,o=void 0!==t.endIndex?t.endIndex:e.length,i=(o-r)/n;tF=qP.allocate(tF,i,{type:Float32Array,size:2*n});let s=r,a=0;for(;s<o;){for(let t=0;t<n;t++){const r=e[s++];tF[a+t]=r,tF[a+t+n]=eF(r)}a+=2*n}return tF.subarray(0,i*n*2)}function rF(e){let t=null,n=!1;for(const r of e)r&&(t?(n||(t=[[t[0][0],t[0][1]],[t[1][0],t[1][1]]],n=!0),t[0][0]=Math.min(t[0][0],r[0][0]),t[0][1]=Math.min(t[0][1],r[0][1]),t[1][0]=Math.max(t[1][0],r[1][0]),t[1][1]=Math.max(t[1][1],r[1][1])):t=r);return t}const oF=Math.PI/180,iF=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],sF=[0,0,0],aF={unitsPerMeter:[1,1,1],metersPerUnit:[1,1,1]};class lF{constructor(e={}){this._frustumPlanes={},this.id=e.id||this.constructor.displayName||"viewport",this.x=e.x||0,this.y=e.y||0,this.width=e.width||1,this.height=e.height||1,this.zoom=e.zoom||0,this.padding=e.padding,this.distanceScales=e.distanceScales||aF,this.focalDistance=e.focalDistance||1,this.position=e.position||sF,this.modelMatrix=e.modelMatrix||null;const{longitude:t,latitude:n}=e;this.isGeospatial=Number.isFinite(n)&&Number.isFinite(t),this._initProps(e),this._initMatrices(e),this.equals=this.equals.bind(this),this.project=this.project.bind(this),this.unproject=this.unproject.bind(this),this.projectPosition=this.projectPosition.bind(this),this.unprojectPosition=this.unprojectPosition.bind(this),this.projectFlat=this.projectFlat.bind(this),this.unprojectFlat=this.unprojectFlat.bind(this)}get subViewports(){return null}get metersPerPixel(){return this.distanceScales.metersPerUnit[2]/this.scale}get projectionMode(){return this.isGeospatial?this.zoom<12?IT.WEB_MERCATOR:IT.WEB_MERCATOR_AUTO_OFFSET:IT.IDENTITY}equals(e){return e instanceof lF&&(this===e||e.width===this.width&&e.height===this.height&&e.scale===this.scale&&zI(e.projectionMatrix,this.projectionMatrix)&&zI(e.viewMatrix,this.viewMatrix))}project(e,{topLeft:t=!0}={}){const n=fP(this.projectPosition(e),this.pixelProjectionMatrix),[r,o]=n,i=t?o:this.height-o;return 2===e.length?[r,i]:[r,i,n[2]]}unproject(e,{topLeft:t=!0,targetZ:n}={}){const[r,o,i]=e,s=t?o:this.height-o,a=n&&n*this.distanceScales.unitsPerMeter[2],l=gP([r,s,i],this.pixelUnprojectionMatrix,a),[c,u,d]=this.unprojectPosition(l);return Number.isFinite(i)?[c,u,d]:Number.isFinite(n)?[c,u,n]:[c,u]}projectPosition(e){const[t,n]=this.projectFlat(e);return[t,n,(e[2]||0)*this.distanceScales.unitsPerMeter[2]]}unprojectPosition(e){const[t,n]=this.unprojectFlat(e);return[t,n,(e[2]||0)*this.distanceScales.metersPerUnit[2]]}projectFlat(e){if(this.isGeospatial){const t=aP(e);return t[1]=jI(t[1],-318,830),t}return e}unprojectFlat(e){return this.isGeospatial?lP(e):e}getBounds(e={}){const t={targetZ:e.z||0},n=this.unproject([0,0],t),r=this.unproject([this.width,0],t),o=this.unproject([0,this.height],t),i=this.unproject([this.width,this.height],t);return[Math.min(n[0],r[0],o[0],i[0]),Math.min(n[1],r[1],o[1],i[1]),Math.max(n[0],r[0],o[0],i[0]),Math.max(n[1],r[1],o[1],i[1])]}getDistanceScales(e){return e&&this.isGeospatial?dP({longitude:e[0],latitude:e[1],highPrecision:!0}):this.distanceScales}containsPixel({x:e,y:t,width:n=1,height:r=1}){return e<this.x+this.width&&this.x<e+n&&t<this.y+this.height&&this.y<t+r}getFrustumPlanes(){return this._frustumPlanes.near||Object.assign(this._frustumPlanes,{left:ZP((e=this.viewProjectionMatrix)[3]+e[0],e[7]+e[4],e[11]+e[8],e[15]+e[12]),right:ZP(e[3]-e[0],e[7]-e[4],e[11]-e[8],e[15]-e[12]),bottom:ZP(e[3]+e[1],e[7]+e[5],e[11]+e[9],e[15]+e[13]),top:ZP(e[3]-e[1],e[7]-e[5],e[11]-e[9],e[15]-e[13]),near:ZP(e[3]+e[2],e[7]+e[6],e[11]+e[10],e[15]+e[14]),far:ZP(e[3]-e[2],e[7]-e[6],e[11]-e[10],e[15]-e[14])}),this._frustumPlanes;var e}panByPosition(e,t){return null}_initProps(e){const t=e.longitude,n=e.latitude;this.isGeospatial&&(Number.isFinite(e.zoom)||(this.zoom=cP({latitude:n})+Math.log2(this.focalDistance)),this.distanceScales=e.distanceScales||dP({latitude:n,longitude:t}));const r=Math.pow(2,this.zoom);this.scale=r;const{position:o,modelMatrix:i}=e;let s=sF;if(o&&(s=i?new GR(i).transformAsVector(o,[]):o),this.isGeospatial){const e=this.projectPosition([t,n,0]);this.center=new mR(s).scale(this.distanceScales.unitsPerMeter).add(e)}else this.center=this.projectPosition(s)}_initMatrices(e){const{viewMatrix:t=iF,projectionMatrix:n=null,orthographic:r=!1,fovyRadians:o,fovy:i=75,near:s=.1,far:a=1e3,padding:l=null,focalDistance:c=1}=e;this.viewMatrixUncentered=t,this.viewMatrix=(new GR).multiplyRight(t).translate(new mR(this.center).negate()),this.projectionMatrix=n||function({width:e,height:t,orthographic:n,fovyRadians:r,focalDistance:o,padding:i,near:s,far:a}){const l=e/t,c=n?(new GR).orthographic({fovy:r,aspect:l,focalDistance:o,near:s,far:a}):(new GR).perspective({fovy:r,aspect:l,near:s,far:a});if(i){const{left:n=0,right:r=0,top:o=0,bottom:s=0}=i,a=jI((n+e-r)/2,0,e)-e/2,l=jI((o+t-s)/2,0,t)-t/2;c[8]-=2*a/e,c[9]+=2*l/t}return c}({width:this.width,height:this.height,orthographic:r,fovyRadians:o||i*oF,focalDistance:c,padding:l,near:s,far:a});const u=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];var d;RR(u,u,this.projectionMatrix),RR(u,u,this.viewMatrix),this.viewProjectionMatrix=u,this.viewMatrixInverse=IR([],this.viewMatrix)||this.viewMatrix,this.cameraPosition=[(d=this.viewMatrixInverse)[12],d[13],d[14]];const A=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],h=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];TR(A,A,[this.width/2,-this.height/2,1]),kR(A,A,[1,-1,0]),RR(h,A,this.viewProjectionMatrix),this.pixelProjectionMatrix=h,this.pixelUnprojectionMatrix=IR([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],this.pixelProjectionMatrix),this.pixelUnprojectionMatrix||AC.warn("Pixel project matrix not invertible")()}}lF.displayName="Viewport";class cF extends lF{constructor(e={}){const{latitude:t=0,longitude:n=0,zoom:r=0,pitch:o=0,bearing:i=0,nearZMultiplier:s=.1,farZMultiplier:a=1.01,nearZ:l,farZ:c,orthographic:u=!1,projectionMatrix:d,repeat:A=!1,worldOffset:h=0,position:p,padding:f,legacyMeterSizes:g=!1}=e;let{width:m,height:y,altitude:v=1.5}=e;const b=Math.pow(2,r);let w;m=m||1,y=y||1;let x=null;if(d)v=d[5]/2,w=hP(v);else{let n;if(e.fovy?(w=e.fovy,v=pP(w)):w=hP(v),f){const{top:e=0,bottom:t=0}=f;n=[0,jI((e+y-t)/2,0,y)-y/2]}x=function(e){const{width:t,height:n,altitude:r,pitch:o=0,offset:i,center:s,scale:a,nearZMultiplier:l=1,farZMultiplier:c=1}=e;let{fovy:u=hP(sP)}=e;void 0!==r&&(u=hP(r));const d=u*tP,A=o*tP,h=pP(u);let p=h;s&&(p+=s[2]*a/Math.cos(A)/n);const f=d*(.5+(i?i[1]:0)/n),g=Math.sin(f)*p/Math.sin(YT(Math.PI/2-A-f,.01,Math.PI-.01)),m=Math.sin(A)*g+p,y=10*p;return{fov:d,aspect:t/n,focalDistance:h,near:l,far:Math.min(m*c,y)}}({width:m,height:y,scale:b,center:p&&[0,0,p[2]*uP(t)],offset:n,pitch:o,fovy:w,nearZMultiplier:s,farZMultiplier:a}),Number.isFinite(l)&&(x.near=l),Number.isFinite(c)&&(x.far=c)}let _=function(e){const{height:t,pitch:n,bearing:r,altitude:o,scale:i,center:s}=e,a=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];kR(a,a,[0,0,-o]),PR(a,a,-n*tP),FR(a,a,r*tP);const l=i/t;var c,u;return TR(a,a,[l,l,l]),s&&kR(a,a,((c=[])[0]=-(u=s)[0],c[1]=-u[1],c[2]=-u[2],c)),a}({height:y,pitch:o,bearing:i,scale:b,altitude:v});if(h){_=(new GR).translate([512*h,0,0]).multiplyLeft(_)}super({...e,width:m,height:y,viewMatrix:_,longitude:n,latitude:t,zoom:r,...x,fovy:w,focalDistance:v}),this.latitude=t,this.longitude=n,this.zoom=r,this.pitch=o,this.bearing=i,this.altitude=v,this.fovy=w,this.orthographic=u,this._subViewports=A?[]:null,this._pseudoMeters=g,Object.freeze(this)}get subViewports(){if(this._subViewports&&!this._subViewports.length){const e=this.getBounds(),t=Math.floor((e[0]+180)/360),n=Math.ceil((e[2]-180)/360);for(let r=t;r<=n;r++){const e=r?new cF({...this,worldOffset:r}):this;this._subViewports.push(e)}}return this._subViewports}projectPosition(e){if(this._pseudoMeters)return super.projectPosition(e);const[t,n]=this.projectFlat(e);return[t,n,(e[2]||0)*uP(e[1])]}unprojectPosition(e){if(this._pseudoMeters)return super.unprojectPosition(e);const[t,n]=this.unprojectFlat(e);return[t,n,(e[2]||0)/uP(n)]}addMetersToLngLat(e,t){return AP(e,t)}panByPosition(e,t){const n=gP(t,this.pixelUnprojectionMatrix),r=YI([],this.projectFlat(e),((o=[])[0]=-(i=n)[0],o[1]=-i[1],o));var o,i;const s=YI([],this.center,r),[a,l]=this.unprojectFlat(s);return{longitude:a,latitude:l}}getBounds(e={}){const t=function(e,t=0){const{width:n,height:r,unproject:o}=e,i={targetZ:t},s=o([0,r],i),a=o([n,r],i);let l,c;return(e.fovy?.5*e.fovy*yP:Math.atan(.5/e.altitude))>(90-e.pitch)*yP-.01?(l=vP(e,0,t),c=vP(e,n,t)):(l=o([0,0],i),c=o([n,0],i)),[s,a,c,l]}(this,e.z||0);return[Math.min(t[0][0],t[1][0],t[2][0],t[3][0]),Math.min(t[0][1],t[1][1],t[2][1],t[3][1]),Math.max(t[0][0],t[1][0],t[2][0],t[3][0]),Math.max(t[0][1],t[1][1],t[2][1],t[3][1])]}fitBounds(e,t={}){const{width:n,height:r}=this,{longitude:o,latitude:i,zoom:s}=mP({width:n,height:r,bounds:e,...t});return new cF({width:n,height:r,longitude:o,latitude:i,zoom:s})}}cF.displayName="WebMercatorViewport";const uF=[0,0,0];function dF(e,t,n=!1){const r=t.projectPosition(e);if(n&&t instanceof cF){const[n,o,i=0]=e,s=t.getDistanceScales([n,o]);r[2]=i*s.unitsPerMeter[2]}return r}function AF(e,{viewport:t,modelMatrix:n,coordinateSystem:r,coordinateOrigin:o,offsetMode:i}){let[s,a,l=0]=e;switch(n&&([s,a,l]=OR([],[s,a,l,1],n)),r){case BT.LNGLAT:return dF([s,a,l],t,i);case BT.LNGLAT_OFFSETS:return dF([s+o[0],a+o[1],l+(o[2]||0)],t,i);case BT.METER_OFFSETS:return dF(AP(o,[s,a,l]),t,i);default:return t.isGeospatial?[s+o[0],a+o[1],l+o[2]]:t.projectPosition([s,a,l])}}function hF(e,t){const{viewport:n,coordinateSystem:r,coordinateOrigin:o,modelMatrix:i,fromCoordinateSystem:s,fromCoordinateOrigin:a}=function(e){const{viewport:t,modelMatrix:n,coordinateOrigin:r}=e;let{coordinateSystem:o,fromCoordinateSystem:i,fromCoordinateOrigin:s}=e;return o===BT.DEFAULT&&(o=t.isGeospatial?BT.LNGLAT:BT.CARTESIAN),void 0===i&&(i=o),void 0===s&&(s=r),{viewport:t,coordinateSystem:o,coordinateOrigin:r,modelMatrix:n,fromCoordinateSystem:i,fromCoordinateOrigin:s}}(t),{autoOffset:l=!0}=t,{geospatialOrigin:c=uF,shaderCoordinateOrigin:u=uF,offsetMode:d=!1}=l?jT(n,r,o):{},A=AF(e,{viewport:n,modelMatrix:i,coordinateSystem:s,coordinateOrigin:a,offsetMode:d});if(d){const e=n.projectPosition(c||u);dR(A,A,e)}return A}let pF=1,fF=1;class gF{time=0;channels=new Map;animations=new Map;playing=!1;lastEngineTime=-1;constructor(){}addChannel(e){const{delay:t=0,duration:n=Number.POSITIVE_INFINITY,rate:r=1,repeat:o=1}=e,i=pF++,s={time:0,delay:t,duration:n,rate:r,repeat:o};return this._setChannelTime(s,this.time),this.channels.set(i,s),i}removeChannel(e){this.channels.delete(e);for(const[t,n]of this.animations)n.channel===e&&this.detachAnimation(t)}isFinished(e){const t=this.channels.get(e);return void 0!==t&&this.time>=t.delay+t.duration*t.repeat}getTime(e){if(void 0===e)return this.time;const t=this.channels.get(e);return void 0===t?-1:t.time}setTime(e){this.time=Math.max(0,e);const t=this.channels.values();for(const r of t)this._setChannelTime(r,this.time);const n=this.animations.values();for(const r of n){const{animation:e,channel:t}=r;e.setTime(this.getTime(t))}}play(){this.playing=!0}pause(){this.playing=!1,this.lastEngineTime=-1}reset(){this.setTime(0)}attachAnimation(e,t){const n=fF++;return this.animations.set(n,{animation:e,channel:t}),e.setTime(this.getTime(t)),n}detachAnimation(e){this.animations.delete(e)}update(e){this.playing&&(-1===this.lastEngineTime&&(this.lastEngineTime=e),this.setTime(this.time+(e-this.lastEngineTime)),this.lastEngineTime=e)}_setChannelTime(e,t){const n=t-e.delay;n>=e.duration*e.repeat?e.time=e.duration*e.rate:(e.time=Math.max(0,n)%e.duration,e.time*=e.rate)}}let mF=0;const yF={device:null,onAddHTML:()=>"",onInitialize:async()=>null,onRender:()=>{},onFinalize:()=>{},onError:e=>{},stats:PS.stats.get("animation-loop-"+mF++),useDevicePixels:!0,autoResizeViewport:!1,autoResizeDrawingBuffer:!1};class vF{device=null;canvas=null;props;animationProps=null;timeline=null;stats;cpuTime;gpuTime;frameRate;display;needsRedraw="initialized";_initialized=!1;_running=!1;_animationFrameId=null;_nextFramePromise=null;_resolveNextFrame=null;_cpuStartTime=0;_error=null;constructor(e){if(this.props={...yF,...e},!(e=this.props).device)throw new Error("No device provided");const{useDevicePixels:t=!0}=this.props;this.stats=e.stats||new Vx({id:"animation-loop-stats"}),this.cpuTime=this.stats.get("CPU Time"),this.gpuTime=this.stats.get("GPU Time"),this.frameRate=this.stats.get("Frame Rate"),this.setProps({autoResizeViewport:e.autoResizeViewport,autoResizeDrawingBuffer:e.autoResizeDrawingBuffer,useDevicePixels:t}),this.start=this.start.bind(this),this.stop=this.stop.bind(this),this._onMousemove=this._onMousemove.bind(this),this._onMouseleave=this._onMouseleave.bind(this)}destroy(){this.stop(),this._setDisplay(null)}delete(){this.destroy()}setError(e){this.props.onError(e),this._error=Error();const t=this.device?.canvasContext?.canvas;if(t instanceof HTMLCanvasElement){const t=document.createElement("h1");t.innerHTML=e.message,t.style.position="absolute",t.style.top="20%",t.style.left="10px",t.style.color="black",t.style.backgroundColor="red",document.body.appendChild(t)}}setNeedsRedraw(e){return this.needsRedraw=this.needsRedraw||e,this}setProps(e){return"autoResizeViewport"in e&&(this.props.autoResizeViewport=e.autoResizeViewport||!1),"autoResizeDrawingBuffer"in e&&(this.props.autoResizeDrawingBuffer=e.autoResizeDrawingBuffer||!1),"useDevicePixels"in e&&(this.props.useDevicePixels=e.useDevicePixels||!1),this}async start(){if(this._running)return this;this._running=!0;try{let e;return this._initialized||(this._initialized=!0,await this._initDevice(),this._initialize(),await this.props.onInitialize(this._getAnimationProps())),this._running?(!1!==e&&(this._cancelAnimationFrame(),this._requestAnimationFrame()),this):null}catch(e){const t=e instanceof Error?e:new Error("Unknown error");throw this.props.onError(t),t}}stop(){return this._running&&(this.animationProps&&!this._error&&this.props.onFinalize(this.animationProps),this._cancelAnimationFrame(),this._nextFramePromise=null,this._resolveNextFrame=null,this._running=!1),this}redraw(){return this.device?.isLost||this._error||(this._beginFrameTimers(),this._setupFrame(),this._updateAnimationProps(),this._renderFrame(this._getAnimationProps()),this._clearNeedsRedraw(),this._resolveNextFrame&&(this._resolveNextFrame(this),this._nextFramePromise=null,this._resolveNextFrame=null),this._endFrameTimers()),this}attachTimeline(e){return this.timeline=e,this.timeline}detachTimeline(){this.timeline=null}waitForRender(){return this.setNeedsRedraw("waitForRender"),this._nextFramePromise||(this._nextFramePromise=new Promise(e=>{this._resolveNextFrame=e})),this._nextFramePromise}async toDataURL(){if(this.setNeedsRedraw("toDataURL"),await this.waitForRender(),this.canvas instanceof HTMLCanvasElement)return this.canvas.toDataURL();throw new Error("OffscreenCanvas")}_initialize(){this._startEventHandling(),this._initializeAnimationProps(),this._updateAnimationProps(),this._resizeCanvasDrawingBuffer(),this._resizeViewport()}_setDisplay(e){this.display&&(this.display.destroy(),this.display.animationLoop=null),e&&(e.animationLoop=this),this.display=e}_requestAnimationFrame(){var e;this._running&&(this._animationFrameId=(e=this._animationFrame.bind(this),"undefined"!=typeof window&&window.requestAnimationFrame?window.requestAnimationFrame(e):setTimeout(e,1e3/60)))}_cancelAnimationFrame(){var e;null!==this._animationFrameId&&(e=this._animationFrameId,"undefined"!=typeof window&&window.cancelAnimationFrame?window.cancelAnimationFrame(e):clearTimeout(e),this._animationFrameId=null)}_animationFrame(){this._running&&(this.redraw(),this._requestAnimationFrame())}_renderFrame(e){this.display?this.display._renderFrame(e):(this.props.onRender(this._getAnimationProps()),this.device?.submit())}_clearNeedsRedraw(){this.needsRedraw=!1}_setupFrame(){this._resizeCanvasDrawingBuffer(),this._resizeViewport()}_initializeAnimationProps(){const e=this.device?.canvasContext?.canvas;if(!this.device||!e)throw new Error("loop");this.animationProps={animationLoop:this,device:this.device,canvas:e,timeline:this.timeline,useDevicePixels:this.props.useDevicePixels,needsRedraw:!1,width:1,height:1,aspect:1,time:0,startTime:Date.now(),engineTime:0,tick:0,tock:0,_mousePosition:null}}_getAnimationProps(){if(!this.animationProps)throw new Error("animationProps");return this.animationProps}_updateAnimationProps(){if(!this.animationProps)return;const{width:e,height:t,aspect:n}=this._getSizeAndAspect();e===this.animationProps.width&&t===this.animationProps.height||this.setNeedsRedraw("drawing buffer resized"),n!==this.animationProps.aspect&&this.setNeedsRedraw("drawing buffer aspect changed"),this.animationProps.width=e,this.animationProps.height=t,this.animationProps.aspect=n,this.animationProps.needsRedraw=this.needsRedraw,this.animationProps.engineTime=Date.now()-this.animationProps.startTime,this.timeline&&this.timeline.update(this.animationProps.engineTime),this.animationProps.tick=Math.floor(this.animationProps.time/1e3*60),this.animationProps.tock++,this.animationProps.time=this.timeline?this.timeline.getTime():this.animationProps.engineTime}async _initDevice(){if(this.device=await this.props.device,!this.device)throw new Error("No device provided");this.canvas=this.device.canvasContext?.canvas||null}_createInfoDiv(){if(this.canvas&&this.props.onAddHTML){const e=document.createElement("div");document.body.appendChild(e),e.style.position="relative";const t=document.createElement("div");t.style.position="absolute",t.style.left="10px",t.style.bottom="10px",t.style.width="300px",t.style.background="white",this.canvas instanceof HTMLCanvasElement&&e.appendChild(this.canvas),e.appendChild(t);const n=this.props.onAddHTML(t);n&&(t.innerHTML=n)}}_getSizeAndAspect(){if(!this.device)return{width:1,height:1,aspect:1};const[e,t]=this.device?.canvasContext?.getPixelSize()||[1,1];let n=1;const r=this.device?.canvasContext?.canvas;return r&&r.clientHeight?n=r.clientWidth/r.clientHeight:e>0&&t>0&&(n=e/t),{width:e,height:t,aspect:n}}_resizeViewport(){this.props.autoResizeViewport&&this.device.gl&&this.device.gl.viewport(0,0,this.device.gl.drawingBufferWidth,this.device.gl.drawingBufferHeight)}_resizeCanvasDrawingBuffer(){this.props.autoResizeDrawingBuffer&&this.device?.canvasContext?.resize({useDevicePixels:this.props.useDevicePixels})}_beginFrameTimers(){this.frameRate.timeEnd(),this.frameRate.timeStart(),this.cpuTime.timeStart()}_endFrameTimers(){this.cpuTime.timeEnd()}_startEventHandling(){this.canvas&&(this.canvas.addEventListener("mousemove",this._onMousemove.bind(this)),this.canvas.addEventListener("mouseleave",this._onMouseleave.bind(this)))}_onMousemove(e){e instanceof MouseEvent&&(this._getAnimationProps()._mousePosition=[e.offsetX,e.offsetY])}_onMouseleave(e){this._getAnimationProps()._mousePosition=null}}const bF={};function wF(e="id"){bF[e]=bF[e]||1;return`${e}-${bF[e]++}`}class xF{id;userData={};topology;bufferLayout=[];vertexCount;indices;attributes;constructor(e){if(this.id=e.id||wF("geometry"),this.topology=e.topology,this.indices=e.indices||null,this.attributes=e.attributes,this.vertexCount=e.vertexCount,this.bufferLayout=e.bufferLayout||[],this.indices&&!(this.indices.usage&oS.INDEX))throw new Error("Index buffer must have INDEX usage")}destroy(){this.indices?.destroy();for(const e of Object.values(this.attributes))e.destroy()}getVertexCount(){return this.vertexCount}getAttributes(){return this.attributes}getIndexes(){return this.indices||null}_calculateVertexCount(e){return e.byteLength/12}}function _F(e,t){if(t instanceof xF)return t;const n=function(e,t){if(!t.indices)return;const n=t.indices.value;return e.createBuffer({usage:oS.INDEX,data:n})}(e,t),{attributes:r,bufferLayout:o}=function(e,t){const n=[],r={};for(const[i,s]of Object.entries(t.attributes)){let t=i;switch(i){case"POSITION":t="positions";break;case"NORMAL":t="normals";break;case"TEXCOORD_0":t="texCoords";break;case"COLOR_0":t="colors"}if(s){r[t]=e.createBuffer({data:s.value,id:`${i}-buffer`});const{value:o,size:a,normalized:l}=s;n.push({name:t,format:gE(o,a,l)})}}const o=t._calculateVertexCount(t.attributes,t.indices);return{attributes:r,bufferLayout:n,vertexCount:o}}(e,t);return new xF({topology:t.topology||"triangle-list",bufferLayout:o,vertexCount:t.vertexCount,indices:n,attributes:r})}class CF{static defaultProps={...WS.defaultProps};static getDefaultPipelineFactory(e){return e._lumaData.defaultPipelineFactory=e._lumaData.defaultPipelineFactory||new CF(e),e._lumaData.defaultPipelineFactory}device;destroyPolicy;_hashCounter=0;_hashes={};_renderPipelineCache={};_computePipelineCache={};constructor(e){this.device=e,this.destroyPolicy=e.props._factoryDestroyPolicy}createRenderPipeline(e){const t={...WS.defaultProps,...e},n=this._hashRenderPipeline(t);if(!this._renderPipelineCache[n]){const e=this.device.createRenderPipeline({...t,id:t.id?`${t.id}-cached`:void 0});e.hash=n,this._renderPipelineCache[n]={pipeline:e,useCount:0}}return this._renderPipelineCache[n].useCount++,this._renderPipelineCache[n].pipeline}createComputePipeline(e){const t={...KS.defaultProps,...e},n=this._hashComputePipeline(t);if(!this._computePipelineCache[n]){const e=this.device.createComputePipeline({...t,id:t.id?`${t.id}-cached`:void 0});e.hash=n,this._computePipelineCache[n]={pipeline:e,useCount:0}}return this._computePipelineCache[n].useCount++,this._computePipelineCache[n].pipeline}release(e){const t=e.hash,n=e instanceof KS?this._computePipelineCache:this._renderPipelineCache;n[t].useCount--,0===n[t].useCount&&"unused"===this.destroyPolicy&&(n[t].pipeline.destroy(),delete n[t])}_hashComputePipeline(e){return`${this._getHash(e.shader.source)}`}_hashRenderPipeline(e){const t=e.vs?this._getHash(e.vs.source):0,n=e.fs?this._getHash(e.fs.source):0,r=this._getHash(JSON.stringify(e.bufferLayout));if("webgl"===this.device.type)return`${t}/${n}V-BL${r}`;{const o=this._getHash(JSON.stringify(e.parameters));return`${t}/${n}V-T${e.topology}P${o}BL${r}`}}_getHash(e){return void 0===this._hashes[e]&&(this._hashes[e]=this._hashCounter++),this._hashes[e]}}class SF{static defaultProps={...QS.defaultProps};static getDefaultShaderFactory(e){return e._lumaData.defaultShaderFactory||=new SF(e),e._lumaData.defaultShaderFactory}device;destroyPolicy;_cache={};constructor(e){this.device=e,this.destroyPolicy=e.props._factoryDestroyPolicy}createShader(e){const t=this._hashShader(e);let n=this._cache[t];if(!n){const r=this.device.createShader({...e,id:e.id?`${e.id}-cached`:void 0});this._cache[t]=n={shader:r,useCount:0}}return n.useCount++,n.shader}release(e){const t=this._hashShader(e),n=this._cache[t];n&&(n.useCount--,0===n.useCount&&"unused"===this.destroyPolicy&&(delete this._cache[t],n.shader.destroy()))}_hashShader(e){return`${e.stage}:${e.source}`}}let EF=null,BF=null;function IF(e,t,n){if(e===t)return!0;if(!n||!e||!t)return!1;if(Array.isArray(e)){if(!Array.isArray(t)||e.length!==t.length)return!1;for(let r=0;r<e.length;r++)if(!IF(e[r],t[r],n-1))return!1;return!0}if(Array.isArray(t))return!1;if("object"==typeof e&&"object"==typeof t){const r=Object.keys(e),o=Object.keys(t);if(r.length!==o.length)return!1;for(const i of r){if(!t.hasOwnProperty(i))return!1;if(!IF(e[i],t[i],n-1))return!1}return!0}return!1}function RF(e){return function(e){return ArrayBuffer.isView(e)&&!(e instanceof DataView)}(e)||function(e){return!!Array.isArray(e)&&(0===e.length||"number"==typeof e[0])}(e)}function kF(e){const t={bindings:{},uniforms:{}};return Object.keys(e).forEach(n=>{const r=e[n];var o;RF(o=r)||"number"==typeof o||"boolean"==typeof o?t.uniforms[n]=r:t.bindings[n]=r}),t}class TF{options={disableWarnings:!1};modules;moduleUniforms;moduleBindings;constructor(e,t){Object.assign(this.options,t);const n=FC(Object.values(e).filter(e=>e.dependencies));for(const r of n)e[r.name]=r;eS.log(1,"Creating ShaderInputs with modules",Object.keys(e))(),this.modules=e,this.moduleUniforms={},this.moduleBindings={};for(const[r,o]of Object.entries(e))this._addModule(o),o.name&&r!==o.name&&!this.options.disableWarnings&&eS.warn(`Module name: ${r} vs ${o.name}`)()}destroy(){}setProps(e){for(const t of Object.keys(e)){const n=t,r=e[n]||{},o=this.modules[n];if(!o){this.options.disableWarnings||eS.warn(`Module ${t} not found`)();continue}const i=this.moduleUniforms[n],s=this.moduleBindings[n],a=o.getUniforms?.(r,i)||r,{uniforms:l,bindings:c}=kF(a);this.moduleUniforms[n]={...i,...l},this.moduleBindings[n]={...s,...c}}}getModules(){return Object.values(this.modules)}getUniformValues(){return this.moduleUniforms}getBindingValues(){const e={};for(const t of Object.values(this.moduleBindings))Object.assign(e,t);return e}getDebugTable(){const e={};for(const[t,n]of Object.entries(this.moduleUniforms))for(const[r,o]of Object.entries(n))e[`${t}.${r}`]={type:this.modules[t].uniformTypes?.[r],value:String(o)};return e}_addModule(e){const t=e.name;this.moduleUniforms[t]=e.defaultUniforms||{},this.moduleBindings[t]={}}}async function PF(e,t){const n=new Image;return n.crossOrigin="anonymous",n.src=e.startsWith("http")?e:""+e,await n.decode(),t?await createImageBitmap(n,t):await createImageBitmap(n)}class FF{device;id;texture;sampler;view;ready;isReady=!1;destroyed=!1;resolveReady=()=>{};rejectReady=()=>{};get[Symbol.toStringTag](){return"AsyncTexture"}toString(){return`AsyncTexture:"${this.id}"(${this.isReady?"ready":"loading"})`}constructor(e,t){this.device=e,this.id=t.id||wF("async-texture"),"string"==typeof t?.data&&"2d"===t.dimension&&(t={...t,data:PF(t.data)}),this.ready=new Promise((e,t)=>{this.resolveReady=()=>{this.isReady=!0,e()},this.rejectReady=t}),this.initAsync(t)}async initAsync(e){const t=e.data;let n;try{n=await MF(t)}catch(o){this.rejectReady(o)}if(this.destroyed)return;const r={...e,data:n};this.texture=this.device.createTexture(r),this.sampler=this.texture.sampler,this.view=this.texture.view,this.isReady=!0,this.resolveReady()}destroy(){this.texture&&(this.texture.destroy(),this.texture=null),this.destroyed=!0}resize(e){if(!this.isReady)throw new Error("Cannot resize texture before it is ready");if(e.width===this.texture.width&&e.height===this.texture.height)return!1;if(this.texture){const t=this.texture;this.texture=t.clone(e),t.destroy()}return!0}}async function MF(e){if(e=await e,Array.isArray(e))return await Promise.all(e.map(MF));if(e&&"object"==typeof e&&e.constructor===Object){const t=e,n=await Promise.all(Object.values(t)),r=Object.keys(t),o={};for(let e=0;e<r.length;e++)o[r[e]]=n[e];return o}return e}class LF{static defaultProps={...WS.defaultProps,source:void 0,vs:null,fs:null,id:"unnamed",handle:void 0,userData:{},defines:{},modules:[],moduleSettings:void 0,geometry:null,indexBuffer:null,attributes:{},constantAttributes:{},varyings:[],isInstanced:void 0,instanceCount:0,vertexCount:0,shaderInputs:void 0,pipelineFactory:void 0,shaderFactory:void 0,transformFeedback:void 0,shaderAssembler:qC.getDefaultShaderAssembler(),debugShaders:void 0,disableWarnings:void 0};device;id;source;vs;fs;pipelineFactory;shaderFactory;userData={};parameters;topology;bufferLayout;isInstanced=void 0;instanceCount=0;vertexCount;indexBuffer=null;bufferAttributes={};constantAttributes={};bindings={};uniforms={};vertexArray;transformFeedback=null;pipeline;shaderInputs;_uniformStore;_attributeInfos={};_gpuGeometry=null;_getModuleUniforms;props;_pipelineNeedsUpdate="newly created";_needsRedraw="initializing";_destroyed=!1;_lastDrawTimestamp=-1;get[Symbol.toStringTag](){return"Model"}toString(){return`Model(${this.id})`}constructor(e,t){this.props={...LF.defaultProps,...t},t=this.props,this.id=t.id||wF("model"),this.device=e,Object.assign(this.userData,t.userData);const n=Object.fromEntries(this.props.modules?.map(e=>[e.name,e])||[]),r=t.shaderInputs||new TF(n,{disableWarnings:this.props.disableWarnings});this.setShaderInputs(r);const o=function(e){return{type:e.type,shaderLanguage:e.info.shadingLanguage,shaderLanguageVersion:e.info.shadingLanguageVersion,gpu:e.info.gpu,features:e.features}}(e),i=(this.props.modules?.length>0?this.props.modules:this.shaderInputs?.getModules())||[];if("webgpu"===this.device.type&&this.props.source){const{source:e,getUniforms:t}=this.props.shaderAssembler.assembleWGSLShader({platformInfo:o,...this.props,modules:i});this.source=e,this._getModuleUniforms=t,this.props.shaderLayout||=LI(this.source)}else{const{vs:e,fs:t,getUniforms:n}=this.props.shaderAssembler.assembleGLSLShaderPair({platformInfo:o,...this.props,modules:i});this.vs=e,this.fs=t,this._getModuleUniforms=n}this.vertexCount=this.props.vertexCount,this.instanceCount=this.props.instanceCount,this.topology=this.props.topology,this.bufferLayout=this.props.bufferLayout,this.parameters=this.props.parameters,t.geometry&&this.setGeometry(t.geometry),this.pipelineFactory=t.pipelineFactory||CF.getDefaultPipelineFactory(this.device),this.shaderFactory=t.shaderFactory||SF.getDefaultShaderFactory(this.device),this.pipeline=this._updatePipeline(),this.vertexArray=e.createVertexArray({renderPipeline:this.pipeline}),this._gpuGeometry&&this._setGeometryAttributes(this._gpuGeometry),"isInstanced"in t&&(this.isInstanced=t.isInstanced),t.instanceCount&&this.setInstanceCount(t.instanceCount),t.vertexCount&&this.setVertexCount(t.vertexCount),t.indexBuffer&&this.setIndexBuffer(t.indexBuffer),t.attributes&&this.setAttributes(t.attributes),t.constantAttributes&&this.setConstantAttributes(t.constantAttributes),t.bindings&&this.setBindings(t.bindings),t.uniforms&&this.setUniformsWebGL(t.uniforms),t.moduleSettings&&this.updateModuleSettingsWebGL(t.moduleSettings),t.transformFeedback&&(this.transformFeedback=t.transformFeedback),Object.seal(this)}destroy(){this._destroyed||(this.pipelineFactory.release(this.pipeline),this.shaderFactory.release(this.pipeline.vs),this.pipeline.fs&&this.shaderFactory.release(this.pipeline.fs),this._uniformStore.destroy(),this._gpuGeometry?.destroy(),this._destroyed=!0)}needsRedraw(){this._getBindingsUpdateTimestamp()>this._lastDrawTimestamp&&this.setNeedsRedraw("contents of bound textures or buffers updated");const e=this._needsRedraw;return this._needsRedraw=!1,e}setNeedsRedraw(e){this._needsRedraw||=e}predraw(){this.updateShaderInputs(),this.pipeline=this._updatePipeline()}draw(e){const t=this._areBindingsLoading();if(t)return eS.info(2,`>>> DRAWING ABORTED ${this.id}: ${t} not loaded`)(),!1;try{e.pushDebugGroup(`${this}.predraw(${e})`),this.predraw()}finally{e.popDebugGroup()}let n;try{e.pushDebugGroup(`${this}.draw(${e})`),this._logDrawCallStart(),this.pipeline=this._updatePipeline();const t=this._getBindings();this.pipeline.setBindings(t,{disableWarnings:this.props.disableWarnings}),OF(this.uniforms)||this.pipeline.setUniformsWebGL(this.uniforms);const{indexBuffer:r}=this.vertexArray,o=r?r.byteLength/("uint32"===r.indexType?4:2):void 0;n=this.pipeline.draw({renderPass:e,vertexArray:this.vertexArray,isInstanced:this.isInstanced,vertexCount:this.vertexCount,instanceCount:this.instanceCount,indexCount:o,transformFeedback:this.transformFeedback||void 0,parameters:this.parameters,topology:this.topology})}finally{e.popDebugGroup(),this._logDrawCallEnd()}return this._logFramebuffer(e),n?(this._lastDrawTimestamp=this.device.timestamp,this._needsRedraw=!1):this._needsRedraw="waiting for resource initialization",n}setGeometry(e){this._gpuGeometry?.destroy();const t=e&&_F(this.device,e);if(t){this.setTopology(t.topology||"triangle-list");const e=new mE(this.bufferLayout);this.bufferLayout=e.mergeBufferLayouts(t.bufferLayout,this.bufferLayout),this.vertexArray&&this._setGeometryAttributes(t)}this._gpuGeometry=t}setTopology(e){e!==this.topology&&(this.topology=e,this._setPipelineNeedsUpdate("topology"))}setBufferLayout(e){const t=new mE(this.bufferLayout);this.bufferLayout=this._gpuGeometry?t.mergeBufferLayouts(e,this._gpuGeometry.bufferLayout):e,this._setPipelineNeedsUpdate("bufferLayout"),this.pipeline=this._updatePipeline(),this.vertexArray=this.device.createVertexArray({renderPipeline:this.pipeline}),this._gpuGeometry&&this._setGeometryAttributes(this._gpuGeometry)}setParameters(e){IF(e,this.parameters,2)||(this.parameters=e,this._setPipelineNeedsUpdate("parameters"))}setInstanceCount(e){this.instanceCount=e,void 0===this.isInstanced&&e>0&&(this.isInstanced=!0),this.setNeedsRedraw("instanceCount")}setVertexCount(e){this.vertexCount=e,this.setNeedsRedraw("vertexCount")}setShaderInputs(e){this.shaderInputs=e,this._uniformStore=new hE(this.shaderInputs.modules);for(const[t,n]of Object.entries(this.shaderInputs.modules))if(UF(n)){const e=this._uniformStore.getManagedUniformBuffer(this.device,t);this.bindings[`${t}Uniforms`]=e}this.setNeedsRedraw("shaderInputs")}updateShaderInputs(){this._uniformStore.setUniforms(this.shaderInputs.getUniformValues()),this.setBindings(this.shaderInputs.getBindingValues()),this.setNeedsRedraw("shaderInputs")}setBindings(e){Object.assign(this.bindings,e),this.setNeedsRedraw("bindings")}setTransformFeedback(e){this.transformFeedback=e,this.setNeedsRedraw("transformFeedback")}setIndexBuffer(e){this.vertexArray.setIndexBuffer(e),this.setNeedsRedraw("indexBuffer")}setAttributes(e,t){const n=t?.disableWarnings??this.props.disableWarnings;e.indices&&eS.warn(`Model:${this.id} setAttributes() - indexBuffer should be set using setIndexBuffer()`)(),this.bufferLayout=function(e,t){const n=Object.fromEntries(e.attributes.map(e=>[e.name,e.location])),r=t.slice();return r.sort((e,t)=>{const r=e.attributes?e.attributes.map(e=>e.attribute):[e.name],o=t.attributes?t.attributes.map(e=>e.attribute):[t.name];return Math.min(...r.map(e=>n[e]))-Math.min(...o.map(e=>n[e]))}),r}(this.pipeline.shaderLayout,this.bufferLayout);const r=new mE(this.bufferLayout);for(const[o,i]of Object.entries(e)){const e=r.getBufferLayout(o);if(!e){n||eS.warn(`Model(${this.id}): Missing layout for buffer "${o}".`)();continue}const t=r.getAttributeNamesForBuffer(e);let s=!1;for(const n of t){const e=this._attributeInfos[n];if(e){const t="webgpu"===this.device.type?r.getBufferIndex(e.bufferName):e.location;this.vertexArray.setBuffer(t,i),s=!0}}s||n||eS.warn(`Model(${this.id}): Ignoring buffer "${i.id}" for unknown attribute "${o}"`)()}this.setNeedsRedraw("attributes")}setConstantAttributes(e,t){for(const[n,r]of Object.entries(e)){const e=this._attributeInfos[n];e?this.vertexArray.setConstantWebGL(e.location,r):(t?.disableWarnings??this.props.disableWarnings)||eS.warn(`Model "${this.id}: Ignoring constant supplied for unknown attribute "${n}"`)()}this.setNeedsRedraw("constants")}setUniforms(e){this.setUniformsWebGL(e)}setUniformsWebGL(e){OF(e)||(this.pipeline.setUniformsWebGL(e),Object.assign(this.uniforms,e)),this.setNeedsRedraw("uniforms")}updateModuleSettingsWebGL(e){const{bindings:t,uniforms:n}=kF(this._getModuleUniforms(e));Object.assign(this.bindings,t),Object.assign(this.uniforms,n),this.setNeedsRedraw("moduleSettings")}_areBindingsLoading(){for(const e of Object.values(this.bindings))if(e instanceof FF&&!e.isReady)return e.id;return!1}_getBindings(){const e={};for(const[t,n]of Object.entries(this.bindings))n instanceof FF?n.isReady&&(e[t]=n.texture):e[t]=n;return e}_getBindingsUpdateTimestamp(){let e=0;for(const t of Object.values(this.bindings))t instanceof DS?e=Math.max(e,t.texture.updateTimestamp):t instanceof oS||t instanceof OS?e=Math.max(e,t.updateTimestamp):t instanceof FF?e=t.texture?Math.max(e,t.texture.updateTimestamp):1/0:t instanceof GS||(e=Math.max(e,t.buffer.updateTimestamp));return e}_setGeometryAttributes(e){const t={...e.attributes};for(const[n]of Object.entries(t))this.pipeline.shaderLayout.attributes.find(e=>e.name===n)||"positions"===n||delete t[n];this.vertexCount=e.vertexCount,this.setIndexBuffer(e.indices||null),this.setAttributes(e.attributes,{disableWarnings:!0}),this.setAttributes(t,{disableWarnings:this.props.disableWarnings}),this.setNeedsRedraw("geometry attributes")}_setPipelineNeedsUpdate(e){this._pipelineNeedsUpdate||=e,this.setNeedsRedraw(e)}_updatePipeline(){if(this._pipelineNeedsUpdate){let e=null,t=null;this.pipeline&&(eS.log(1,`Model ${this.id}: Recreating pipeline because "${this._pipelineNeedsUpdate}".`)(),e=this.pipeline.vs,t=this.pipeline.fs),this._pipelineNeedsUpdate=!1;const n=this.shaderFactory.createShader({id:`${this.id}-vertex`,stage:"vertex",source:this.source||this.vs,debugShaders:this.props.debugShaders});let r=null;this.source?r=n:this.fs&&(r=this.shaderFactory.createShader({id:`${this.id}-fragment`,stage:"fragment",source:this.source||this.fs,debugShaders:this.props.debugShaders})),this.pipeline=this.pipelineFactory.createRenderPipeline({...this.props,bufferLayout:this.bufferLayout,topology:this.topology,parameters:this.parameters,bindings:this._getBindings(),vs:n,fs:r}),this._attributeInfos=eE(this.pipeline.shaderLayout,this.bufferLayout),e&&this.shaderFactory.release(e),t&&this.shaderFactory.release(t)}return this.pipeline}_lastLogTime=0;_logOpen=!1;_logDrawCallStart(){const e=eS.level>3?0:1e4;eS.level<2||Date.now()-this._lastLogTime<e||(this._lastLogTime=Date.now(),this._logOpen=!0,eS.group(2,`>>> DRAWING MODEL ${this.id}`,{collapsed:eS.level<=2})())}_logDrawCallEnd(){if(this._logOpen){const e=function(e){const t={},n="Values";if(0===e.attributes.length&&!e.varyings?.length)return{"No attributes or varyings":{[n]:"N/A"}};for(const r of e.attributes)r&&(t[`in ${r.location} ${r.name}: ${r.type}`]={[n]:r.stepMode||"vertex"});for(const r of e.varyings||[])t[`out ${r.location} ${r.name}`]={[n]:JSON.stringify(r)};return t}(this.pipeline.shaderLayout,this.id);eS.table(2,e)();const t=this.shaderInputs.getDebugTable();for(const[r,o]of Object.entries(this.uniforms))t[r]={value:o};eS.table(2,t)();const n=this._getAttributeDebugTable();eS.table(2,this._attributeInfos)(),eS.table(2,n)(),eS.groupEnd(2)(),this._logOpen=!1}}_drawCount=0;_logFramebuffer(e){const t=this.device.props.debugFramebuffers;if(this._drawCount++,!t)return;const n=e.props.framebuffer;n&&function(e,{id:t,minimap:n,opaque:r,top:o="0",left:i="0",rgbaScale:s=1}){EF||(EF=document.createElement("canvas"),EF.id=t,EF.title=t,EF.style.zIndex="100",EF.style.position="absolute",EF.style.top=o,EF.style.left=i,EF.style.border="blue 5px solid",EF.style.transform="scaleY(-1)",document.body.appendChild(EF),BF=EF.getContext("2d")),EF.width===e.width&&EF.height===e.height||(EF.width=e.width/2,EF.height=e.height/2,EF.style.width="400px",EF.style.height="400px");const a=e.device.readPixelsToArrayWebGL(e),l=BF?.createImageData(e.width,e.height);if(l){const e=0;for(let t=0;t<a.length;t+=4)l.data[e+t+0]=a[t+0]*s,l.data[e+t+1]=a[t+1]*s,l.data[e+t+2]=a[t+2]*s,l.data[e+t+3]=r?255:a[t+3]*s;BF?.putImageData(l,0,0)}}(n,{id:n.id,minimap:!0})}_getAttributeDebugTable(){const e={};for(const[t,n]of Object.entries(this._attributeInfos)){const r=this.vertexArray.attributes[n.location];e[n.location]={name:t,type:n.shaderType,values:r?this._getBufferOrConstantValues(r,n.bufferDataType):"null"}}if(this.vertexArray.indexBuffer){const{indexBuffer:t}=this.vertexArray,n="uint32"===t.indexType?new Uint32Array(t.debugData):new Uint16Array(t.debugData);e.indices={name:"indices",type:t.indexType,values:n.toString()}}return e}_getBufferOrConstantValues(e,t){const n=fE(t);return(e instanceof oS?new n(e.debugData):e).toString()}}function UF(e){return Boolean(e.uniformTypes&&!OF(e.uniformTypes))}function OF(e){for(const t in e)return!1;return!0}class DF{device;model;transformFeedback;static defaultProps={...LF.defaultProps,outputs:void 0,feedbackBuffers:void 0};static isSupported(e){return"webgl"===e?.info?.type}constructor(e,t=DF.defaultProps){if(!DF.isSupported(e))throw new Error("BufferTransform not yet implemented on WebGPU");this.device=e,this.model=new LF(this.device,{id:t.id||"buffer-transform-model",fs:t.fs||JC(),topology:t.topology||"point-list",varyings:t.outputs||t.varyings,...t}),this.transformFeedback=this.device.createTransformFeedback({layout:this.model.pipeline.shaderLayout,buffers:t.feedbackBuffers}),this.model.setTransformFeedback(this.transformFeedback),Object.seal(this)}destroy(){this.model&&this.model.destroy()}delete(){this.destroy()}run(e){e?.inputBuffers&&this.model.setAttributes(e.inputBuffers),e?.outputBuffers&&this.transformFeedback.setBuffers(e.outputBuffers);const t=this.device.beginRenderPass(e);this.model.draw(t),t.end()}getBuffer(e){return this.transformFeedback.getBuffer(e)}readAsync(e){const t=this.getBuffer(e);if(!t)throw new Error("BufferTransform#getBuffer");if(t instanceof oS)return t.readAsync();const{buffer:n,byteOffset:r=0,byteLength:o=n.byteLength}=t;return n.readAsync(r,o)}}class NF{id;topology;vertexCount;indices;attributes;userData={};constructor(e){const{attributes:t={},indices:n=null,vertexCount:r=null}=e;this.id=e.id||wF("geometry"),this.topology=e.topology,n&&(this.indices=ArrayBuffer.isView(n)?{value:n,size:1}:n),this.attributes={};for(const[o,i]of Object.entries(t)){const e=ArrayBuffer.isView(i)?{value:i}:i;if(!ArrayBuffer.isView(e.value))throw new Error(`${this._print(o)}: must be typed array or object with value as typed array`);if("POSITION"!==o&&"positions"!==o||e.size||(e.size=3),"indices"===o){if(this.indices)throw new Error("Multiple indices detected");this.indices=e}else this.attributes[o]=e}this.indices&&void 0!==this.indices.isIndexed&&(this.indices=Object.assign({},this.indices),delete this.indices.isIndexed),this.vertexCount=r||this._calculateVertexCount(this.attributes,this.indices)}getVertexCount(){return this.vertexCount}getAttributes(){return this.indices?{indices:this.indices,...this.attributes}:this.attributes}_print(e){return`Geometry ${this.id} attribute ${e}`}_setAttributes(e,t){return this}_calculateVertexCount(e,t){if(t)return t.value.length;let n=1/0;for(const r of Object.values(e)){const{value:e,size:t,constant:o}=r;!o&&e&&void 0!==t&&t>=1&&(n=Math.min(n,e.length/t))}return n}}const jF={blendColorOperation:"add",blendColorSrcFactor:"one",blendColorDstFactor:"zero",blendAlphaOperation:"add",blendAlphaSrcFactor:"constant-alpha",blendAlphaDstFactor:"zero"};class QF extends HP{constructor(){super(...arguments),this._colorEncoderState=null}render(e){return"pickingFBO"in e?this._drawPickingBuffer(e):super.render(e)}_drawPickingBuffer({layers:e,layerFilter:t,views:n,viewports:r,onViewportActive:o,pickingFBO:i,deviceRect:{x:s,y:a,width:l,height:c},cullRect:u,effects:d,pass:A="picking",pickZ:h,shaderModuleProps:p}){this.pickZ=h;const f=this._resetColorEncoder(h),g=[s,a,l,c],m=super.render({target:i,layers:e,layerFilter:t,views:n,viewports:r,onViewportActive:o,cullRect:u,effects:d?.filter(e=>e.useInPicking),pass:A,isPicking:!0,shaderModuleProps:p,clearColor:[0,0,0,0],colorMask:15,scissorRect:g});this._colorEncoderState=null;return{decodePickingColor:f&&zF.bind(null,f),stats:m}}shouldDrawLayer(e){const{pickable:t,operation:n}=e.props;return t&&n.includes("draw")||n.includes("terrain")||n.includes("mask")}getShaderModuleProps(e,t,n){return{picking:{isActive:1,isAttribute:this.pickZ},lighting:{enabled:!1}}}getLayerParameters(e,t,n){const r={...e.props.parameters},{pickable:o,operation:i}=e.props;return!this._colorEncoderState||i.includes("terrain")?r.blend=!1:o&&i.includes("draw")&&(Object.assign(r,jF),r.blend=!0,r.blendColor=function(e,t,n){const{byLayer:r,byAlpha:o}=e;let i,s=r.get(t);s?(s.viewports.push(n),i=s.a):(i=r.size+1,i<=255?(s={a:i,layer:t,viewports:[n]},r.set(t,s),o[i]=s):(AC.warn("Too many pickable layers, only picking the first 255")(),i=0));return[0,0,0,i/255]}(this._colorEncoderState,e,n)),r}_resetColorEncoder(e){return this._colorEncoderState=e?null:{byLayer:new Map,byAlpha:[]},this._colorEncoderState}}function zF(e,t){const n=e.byAlpha[t[3]];return n&&{pickedLayer:n.layer,pickedViewports:n.viewports,pickedObjectIndex:n.layer.decodePickingColor(t)}}const HF="Awaiting state",GF="Matched. State transferred from previous layer",VF="Initialized",WF="Discarded. Awaiting garbage collection",$F="No longer matched. Awaiting garbage collection",KF="Finalized! Awaiting garbage collection",XF=Symbol.for("component"),YF=Symbol.for("propTypes"),qF=Symbol.for("deprecatedProps"),JF=Symbol.for("asyncPropDefaults"),ZF=Symbol.for("asyncPropOriginal"),eM=Symbol.for("asyncPropResolved");function tM(e,t=()=>!0){return Array.isArray(e)?nM(e,t,[]):t(e)?[e]:[]}function nM(e,t,n){let r=-1;for(;++r<e.length;){const o=e[r];Array.isArray(o)?nM(o,t,n):t(o)&&n.push(o)}return n}function rM({target:e,source:t,start:n=0,count:r=1}){const o=t.length,i=r*o;let s=0;for(let a=n;s<o;s++)e[a++]=t[s];for(;s<i;)s<i-s?(e.copyWithin(n+s,n,n+s),s*=2):(e.copyWithin(n+s,n,n+i-s),s=i);return e}class oM{constructor(e,t,n){this._loadCount=0,this._subscribers=new Set,this.id=e,this.context=n,this.setData(t)}subscribe(e){this._subscribers.add(e)}unsubscribe(e){this._subscribers.delete(e)}inUse(){return this._subscribers.size>0}delete(){}getData(){return this.isLoaded?this._error?Promise.reject(this._error):this._content:this._loader.then(()=>this.getData())}setData(e,t){if(e===this._data&&!t)return;this._data=e;const n=++this._loadCount;let r=e;"string"==typeof e&&(r=V_(e)),r instanceof Promise?(this.isLoaded=!1,this._loader=r.then(e=>{this._loadCount===n&&(this.isLoaded=!0,this._error=void 0,this._content=e)}).catch(e=>{this._loadCount===n&&(this.isLoaded=!0,this._error=e||!0)})):(this.isLoaded=!0,this._error=void 0,this._content=e);for(const o of this._subscribers)o.onChange(this.getData())}}class iM{constructor(e){this.protocol=e.protocol||"resource://",this._context={device:e.device,gl:e.device?.gl,resourceManager:this},this._resources={},this._consumers={},this._pruneRequest=null}contains(e){return!!e.startsWith(this.protocol)||e in this._resources}add({resourceId:e,data:t,forceUpdate:n=!1,persistent:r=!0}){let o=this._resources[e];o?o.setData(t,n):(o=new oM(e,t,this._context),this._resources[e]=o),o.persistent=r}remove(e){const t=this._resources[e];t&&(t.delete(),delete this._resources[e])}unsubscribe({consumerId:e}){const t=this._consumers[e];if(t){for(const e in t){const n=t[e],r=this._resources[n.resourceId];r&&r.unsubscribe(n)}delete this._consumers[e],this.prune()}}subscribe({resourceId:e,onChange:t,consumerId:n,requestId:r="default"}){const{_resources:o,protocol:i}=this;e.startsWith(i)&&(o[e=e.replace(i,"")]||this.add({resourceId:e,data:null,persistent:!1}));const s=o[e];if(this._track(n,r,s,t),s)return s.getData()}prune(){this._pruneRequest||(this._pruneRequest=setTimeout(()=>this._prune(),0))}finalize(){for(const e in this._resources)this._resources[e].delete()}_track(e,t,n,r){const o=this._consumers,i=o[e]=o[e]||{};let s=i[t];const a=s&&s.resourceId&&this._resources[s.resourceId];a&&(a.unsubscribe(s),this.prune()),n&&(s?(s.onChange=r,s.resourceId=n.id):s={onChange:r,resourceId:n.id},i[t]=s,n.subscribe(s))}_prune(){this._pruneRequest=null;for(const e of Object.keys(this._resources)){const t=this._resources[e];t.persistent||t.inUse()||(t.delete(),delete this._resources[e])}}}class sM{constructor(e,t){this._lastRenderedLayers=[],this._needsRedraw=!1,this._needsUpdate=!1,this._nextLayers=null,this._debug=!1,this._defaultShaderModulesChanged=!1,this.activateViewport=e=>{fC("layerManager.activateViewport",this,e),e&&(this.context.viewport=e)};const{deck:n,stats:r,viewport:o,timeline:i}=t||{};this.layers=[],this.resourceManager=new iM({device:e,protocol:"deck://"}),this.context={mousePosition:null,userData:{},layerManager:this,device:e,gl:e?.gl,deck:n,shaderAssembler:PP(e?.info?.shadingLanguage||"glsl"),defaultShaderModules:[Ck],renderPass:void 0,stats:r||new Vx({id:"deck.gl"}),viewport:o||new lF({id:"DEFAULT-INITIAL-VIEWPORT"}),timeline:i||new gF,resourceManager:this.resourceManager,onError:void 0},Object.seal(this)}finalize(){this.resourceManager.finalize();for(const e of this.layers)this._finalizeLayer(e)}needsRedraw(e={clearRedrawFlags:!1}){let t=this._needsRedraw;e.clearRedrawFlags&&(this._needsRedraw=!1);for(const n of this.layers){const r=n.getNeedsRedraw(e);t=t||r}return t}needsUpdate(){return this._nextLayers&&this._nextLayers!==this._lastRenderedLayers?"layers changed":this._defaultShaderModulesChanged?"shader modules changed":this._needsUpdate}setNeedsRedraw(e){this._needsRedraw=this._needsRedraw||e}setNeedsUpdate(e){this._needsUpdate=this._needsUpdate||e}getLayers({layerIds:e}={}){return e?this.layers.filter(t=>e.find(e=>0===t.id.indexOf(e))):this.layers}setProps(e){"debug"in e&&(this._debug=e.debug),"userData"in e&&(this.context.userData=e.userData),"layers"in e&&(this._nextLayers=e.layers),"onError"in e&&(this.context.onError=e.onError)}setLayers(e,t){fC("layerManager.setLayers",this,t,e),this._lastRenderedLayers=e;const n=tM(e,Boolean);for(const r of n)r.context=this.context;this._updateLayers(this.layers,n)}updateLayers(){const e=this.needsUpdate();e&&(this.setNeedsRedraw(`updating layers: ${e}`),this.setLayers(this._nextLayers||this._lastRenderedLayers,e)),this._nextLayers=null}addDefaultShaderModule(e){const{defaultShaderModules:t}=this.context;t.find(t=>t.name===e.name)||(t.push(e),this._defaultShaderModulesChanged=!0)}removeDefaultShaderModule(e){const{defaultShaderModules:t}=this.context,n=t.findIndex(t=>t.name===e.name);n>=0&&(t.splice(n,1),this._defaultShaderModulesChanged=!0)}_handleError(e,t,n){n.raiseError(t,`${e} of ${n}`)}_updateLayers(e,t){const n={};for(const i of e)n[i.id]?AC.warn(`Multiple old layers with same id ${i.id}`)():n[i.id]=i;if(this._defaultShaderModulesChanged){for(const t of e)t.setNeedsUpdate(),t.setChangeFlags({extensionsChanged:!0});this._defaultShaderModulesChanged=!1}const r=[];this._updateSublayersRecursively(t,n,r),this._finalizeOldLayers(n);let o=!1;for(const i of r)if(i.hasUniformTransition()){o=`Uniform transition in ${i}`;break}this._needsUpdate=o,this.layers=r}_updateSublayersRecursively(e,t,n){for(const o of e){o.context=this.context;const e=t[o.id];null===e&&AC.warn(`Multiple new layers with same id ${o.id}`)(),t[o.id]=null;let i=null;try{this._debug&&e!==o&&o.validateProps(),e?(this._transferLayerState(e,o),this._updateLayer(o)):this._initializeLayer(o),n.push(o),i=o.isComposite?o.getSubLayers():null}catch(r){this._handleError("matching",r,o)}i&&this._updateSublayersRecursively(i,t,n)}}_finalizeOldLayers(e){for(const t in e){const n=e[t];n&&this._finalizeLayer(n)}}_initializeLayer(e){try{e._initialize(),e.lifecycle=VF}catch(t){this._handleError("initialization",t,e)}}_transferLayerState(e,t){t._transferState(e),t.lifecycle=GF,t!==e&&(e.lifecycle=WF)}_updateLayer(e){try{e._update()}catch(t){this._handleError("update",t,e)}}_finalizeLayer(e){this._needsRedraw=this._needsRedraw||`finalized ${e}`,e.lifecycle=$F;try{e._finalize(),e.lifecycle=KF}catch(t){this._handleError("finalization",t,e)}}}function aM(e,t,n){if(e===t)return!0;if(!n||!e||!t)return!1;if(Array.isArray(e)){if(!Array.isArray(t)||e.length!==t.length)return!1;for(let r=0;r<e.length;r++)if(!aM(e[r],t[r],n-1))return!1;return!0}if(Array.isArray(t))return!1;if("object"==typeof e&&"object"==typeof t){const r=Object.keys(e),o=Object.keys(t);if(r.length!==o.length)return!1;for(const i of r){if(!t.hasOwnProperty(i))return!1;if(!aM(e[i],t[i],n-1))return!1}return!0}return!1}class lM{constructor(e){this.views=[],this.width=100,this.height=100,this.viewState={},this.controllers={},this.timeline=e.timeline,this._viewports=[],this._viewportMap={},this._isUpdating=!1,this._needsRedraw="First render",this._needsUpdate="Initialize",this._eventManager=e.eventManager,this._eventCallbacks={onViewStateChange:e.onViewStateChange,onInteractionStateChange:e.onInteractionStateChange},Object.seal(this),this.setProps(e)}finalize(){for(const e in this.controllers){const t=this.controllers[e];t&&t.finalize()}this.controllers={}}needsRedraw(e={clearRedrawFlags:!1}){const t=this._needsRedraw;return e.clearRedrawFlags&&(this._needsRedraw=!1),t}setNeedsUpdate(e){this._needsUpdate=this._needsUpdate||e,this._needsRedraw=this._needsRedraw||e}updateViewStates(){for(const e in this.controllers){const t=this.controllers[e];t&&t.updateTransition()}}getViewports(e){return e?this._viewports.filter(t=>t.containsPixel(e)):this._viewports}getViews(){const e={};return this.views.forEach(t=>{e[t.id]=t}),e}getView(e){return this.views.find(t=>t.id===e)}getViewState(e){const t="string"==typeof e?this.getView(e):e,n=t&&this.viewState[t.getViewStateId()]||this.viewState;return t?t.filterViewState(n):n}getViewport(e){return this._viewportMap[e]}unproject(e,t){const n=this.getViewports(),r={x:e[0],y:e[1]};for(let o=n.length-1;o>=0;--o){const i=n[o];if(i.containsPixel(r)){const n=e.slice();return n[0]-=i.x,n[1]-=i.y,i.unproject(n,t)}}return null}setProps(e){e.views&&this._setViews(e.views),e.viewState&&this._setViewState(e.viewState),("width"in e||"height"in e)&&this._setSize(e.width,e.height),this._isUpdating||this._update()}_update(){this._isUpdating=!0,this._needsUpdate&&(this._needsUpdate=!1,this._rebuildViewports()),this._needsUpdate&&(this._needsUpdate=!1,this._rebuildViewports()),this._isUpdating=!1}_setSize(e,t){e===this.width&&t===this.height||(this.width=e,this.height=t,this.setNeedsUpdate("Size changed"))}_setViews(e){e=tM(e,Boolean);this._diffViews(e,this.views)&&this.setNeedsUpdate("views changed"),this.views=e}_setViewState(e){if(e){!aM(e,this.viewState,3)&&this.setNeedsUpdate("viewState changed"),this.viewState=e}else AC.warn("missing `viewState` or `initialViewState`")()}_createController(e,t){return new(0,t.type)({timeline:this.timeline,eventManager:this._eventManager,onViewStateChange:this._eventCallbacks.onViewStateChange,onStateChange:this._eventCallbacks.onInteractionStateChange,makeViewport:t=>this.getView(e.id)?.makeViewport({viewState:t,width:this.width,height:this.height})})}_updateController(e,t,n,r){const o=e.controller;if(o&&n){const i={...t,...o,id:e.id,x:n.x,y:n.y,width:n.width,height:n.height};return r&&r.constructor===o.type||(r=this._createController(e,i)),r&&r.setProps(i),r}return null}_rebuildViewports(){const{views:e}=this,t=this.controllers;this._viewports=[],this.controllers={};let n=!1;for(let r=e.length;r--;){const o=e[r],i=this.getViewState(o),s=o.makeViewport({viewState:i,width:this.width,height:this.height});let a=t[o.id];const l=Boolean(o.controller);l&&!a&&(n=!0),!n&&l||!a||(a.finalize(),a=null),this.controllers[o.id]=this._updateController(o,i,s,a),s&&this._viewports.unshift(s)}for(const r in t){const e=t[r];e&&!this.controllers[r]&&e.finalize()}this._buildViewportMap()}_buildViewportMap(){this._viewportMap={},this._viewports.forEach(e=>{e.id&&(this._viewportMap[e.id]=this._viewportMap[e.id]||e)})}_diffViews(e,t){return e.length!==t.length||e.some((n,r)=>!e[r].equals(t[r]))}}const cM=/([0-9]+\.?[0-9]*)(%|px)/;function uM(e){switch(typeof e){case"number":return{position:e,relative:!1};case"string":const t=cM.exec(e);if(t&&t.length>=3){const e="%"===t[2],n=parseFloat(t[1]);return{position:e?n/100:n,relative:e}}default:throw new Error(`Could not parse position string ${e}`)}}function dM(e,t){return e.relative?Math.round(e.position*t):e.position}class AM{constructor(e){const{id:t,x:n=0,y:r=0,width:o="100%",height:i="100%",padding:s=null}=e;this.id=t||this.constructor.displayName||"view",this.props={...e,id:this.id},this._x=uM(n),this._y=uM(r),this._width=uM(o),this._height=uM(i),this._padding=s&&{left:uM(s.left||0),right:uM(s.right||0),top:uM(s.top||0),bottom:uM(s.bottom||0)},this.equals=this.equals.bind(this),Object.seal(this)}equals(e){return this===e||this.constructor===e.constructor&&aM(this.props,e.props,2)}makeViewport({width:e,height:t,viewState:n}){n=this.filterViewState(n);const r=this.getDimensions({width:e,height:t});if(!r.height||!r.width)return null;return new(this.getViewportType(n))({...n,...this.props,...r})}getViewStateId(){const{viewState:e}=this.props;return"string"==typeof e?e:e?.id||this.id}filterViewState(e){if(this.props.viewState&&"object"==typeof this.props.viewState){if(!this.props.viewState.id)return this.props.viewState;const t={...e};for(const e in this.props.viewState)"id"!==e&&(t[e]=this.props.viewState[e]);return t}return e}getDimensions({width:e,height:t}){const n={x:dM(this._x,e),y:dM(this._y,t),width:dM(this._width,e),height:dM(this._height,t)};return this._padding&&(n.padding={left:dM(this._padding.left,e),top:dM(this._padding.top,t),right:dM(this._padding.right,e),bottom:dM(this._padding.bottom,t)}),n}get controller(){const e=this.props.controller;return e?!0===e?{type:this.ControllerType}:"function"==typeof e?{type:e}:{type:this.ControllerType,...e}:null}}class hM{constructor(e){this._inProgress=!1,this._handle=null,this.time=0,this.settings={duration:0},this._timeline=e}get inProgress(){return this._inProgress}start(e){this.cancel(),this.settings=e,this._inProgress=!0,this.settings.onStart?.(this)}end(){this._inProgress&&(this._timeline.removeChannel(this._handle),this._handle=null,this._inProgress=!1,this.settings.onEnd?.(this))}cancel(){this._inProgress&&(this.settings.onInterrupt?.(this),this._timeline.removeChannel(this._handle),this._handle=null,this._inProgress=!1)}update(){if(!this._inProgress)return!1;if(null===this._handle){const{_timeline:e,settings:t}=this;this._handle=e.addChannel({delay:e.getTime(),duration:t.duration})}return this.time=this._timeline.getTime(this._handle),this._onUpdate(),this.settings.onUpdate?.(this),this._timeline.isFinished(this._handle)&&this.end(),!0}_onUpdate(){}}const pM=()=>{},fM=2,gM=3,mM=e=>e,yM=1;class vM{constructor(e){this._onTransitionUpdate=e=>{const{time:t,settings:{interpolator:n,startProps:r,endProps:o,duration:i,easing:s}}=e,a=s(t/i),l=n.interpolateProps(r,o,a);this.propsInTransition=this.getControllerState({...this.props,...l}).getViewportProps(),this.onViewStateChange({viewState:this.propsInTransition,oldViewState:this.props})},this.getControllerState=e.getControllerState,this.propsInTransition=null,this.transition=new hM(e.timeline),this.onViewStateChange=e.onViewStateChange||pM,this.onStateChange=e.onStateChange||pM}finalize(){this.transition.cancel()}getViewportInTransition(){return this.propsInTransition}processViewStateChange(e){let t=!1;const n=this.props;if(this.props=e,!n||this._shouldIgnoreViewportChange(n,e))return!1;if(this._isTransitionEnabled(e)){let r=n;if(this.transition.inProgress){const{interruption:e,endProps:t}=this.transition.settings;r={...n,...e===fM?t:this.propsInTransition||n}}this._triggerTransition(r,e),t=!0}else this.transition.cancel();return t}updateTransition(){this.transition.update()}_isTransitionEnabled(e){const{transitionDuration:t,transitionInterpolator:n}=e;return(t>0||"auto"===t)&&Boolean(n)}_isUpdateDueToCurrentTransition(e){return!(!this.transition.inProgress||!this.propsInTransition)&&this.transition.settings.interpolator.arePropsEqual(e,this.propsInTransition)}_shouldIgnoreViewportChange(e,t){if(this.transition.inProgress){return this.transition.settings.interruption===gM||this._isUpdateDueToCurrentTransition(t)}return!this._isTransitionEnabled(t)||t.transitionInterpolator.arePropsEqual(e,t)}_triggerTransition(e,t){const n=this.getControllerState(e),r=this.getControllerState(t).shortestPathFrom(n),o=t.transitionInterpolator,i=o.getDuration?o.getDuration(e,t):t.transitionDuration;if(0===i)return;const s=o.initializeProps(e,r);this.propsInTransition={};const a={duration:i,easing:t.transitionEasing||mM,interpolator:o,interruption:t.transitionInterruption||yM,startProps:s.start,endProps:s.end,onStart:t.onTransitionStart,onUpdate:this._onTransitionUpdate,onInterrupt:this._onTransitionEnd(t.onTransitionInterrupt),onEnd:this._onTransitionEnd(t.onTransitionEnd)};this.transition.start(a),this.onStateChange({inTransition:!0}),this.updateTransition()}_onTransitionEnd(e){return t=>{this.propsInTransition=null,this.onStateChange({inTransition:!1,isZooming:!1,isPanning:!1,isRotating:!1}),e?.(t)}}}function bM(e,t){if(!e)throw new Error(t||"deck.gl: assertion failed.")}class wM{constructor(e){const{compare:t,extract:n,required:r}=e;this._propsToCompare=t,this._propsToExtract=n||t,this._requiredProps=r}arePropsEqual(e,t){for(const n of this._propsToCompare)if(!(n in e)||!(n in t)||!zI(e[n],t[n]))return!1;return!0}initializeProps(e,t){const n={},r={};for(const o of this._propsToExtract)(o in e||o in t)&&(n[o]=e[o],r[o]=t[o]);return this._checkRequiredProps(n),this._checkRequiredProps(r),{start:n,end:r}}getDuration(e,t){return t.transitionDuration}_checkRequiredProps(e){this._requiredProps&&this._requiredProps.forEach(t=>{const n=e[t];bM(Number.isFinite(n)||Array.isArray(n),`${t} is required for transition`)})}}const xM=["longitude","latitude","zoom","bearing","pitch"],_M=["longitude","latitude","zoom"];class CM extends wM{constructor(e={}){const t=Array.isArray(e)?e:e.transitionProps,n=Array.isArray(e)?{}:e;n.transitionProps=Array.isArray(t)?{compare:t,required:t}:t||{compare:xM,required:_M},super(n.transitionProps),this.opts=n}initializeProps(e,t){const n=super.initializeProps(e,t),{makeViewport:r,around:o}=this.opts;if(r&&o){const i=r(e),s=r(t),a=i.unproject(o);n.start.around=o,Object.assign(n.end,{around:s.project(a),aroundPosition:a,width:t.width,height:t.height})}return n}interpolateProps(e,t,n){const r={};for(const o of this._propsToExtract)r[o]=QI(e[o]||0,t[o]||0,n);if(t.aroundPosition&&this.opts.makeViewport){const o=this.opts.makeViewport({...t,...r});Object.assign(r,o.panByPosition(t.aroundPosition,QI(e.around,t.around,n)))}return r}}const SM={transitionDuration:0},EM=e=>1-(1-e)*(1-e),BM=["wheel"],IM=["panstart","panmove","panend"],RM=["pinchstart","pinchmove","pinchend"],kM=["multipanstart","multipanmove","multipanend"],TM=["dblclick"],PM=["keydown"],FM={};let MM=class{constructor(e){this.state={},this._events={},this._interactionState={isDragging:!1},this._customEvents=[],this._eventStartBlocked=null,this._panMove=!1,this.invertPan=!1,this.dragMode="rotate",this.inertia=0,this.scrollZoom=!0,this.dragPan=!0,this.dragRotate=!0,this.doubleClickZoom=!0,this.touchZoom=!0,this.touchRotate=!1,this.keyboard=!0,this.transitionManager=new vM({...e,getControllerState:e=>new this.ControllerState(e),onViewStateChange:this._onTransition.bind(this),onStateChange:this._setInteractionState.bind(this)}),this.handleEvent=this.handleEvent.bind(this),this.eventManager=e.eventManager,this.onViewStateChange=e.onViewStateChange||(()=>{}),this.onStateChange=e.onStateChange||(()=>{}),this.makeViewport=e.makeViewport}set events(e){this.toggleEvents(this._customEvents,!1),this.toggleEvents(e,!0),this._customEvents=e,this.props&&this.setProps(this.props)}finalize(){for(const e in this._events)this._events[e]&&this.eventManager?.off(e,this.handleEvent);this.transitionManager.finalize()}handleEvent(e){this._controllerState=void 0;const t=this._eventStartBlocked;switch(e.type){case"panstart":return!t&&this._onPanStart(e);case"panmove":return this._onPan(e);case"panend":return this._onPanEnd(e);case"pinchstart":return!t&&this._onPinchStart(e);case"pinchmove":return this._onPinch(e);case"pinchend":return this._onPinchEnd(e);case"multipanstart":return!t&&this._onMultiPanStart(e);case"multipanmove":return this._onMultiPan(e);case"multipanend":return this._onMultiPanEnd(e);case"dblclick":return this._onDoubleClick(e);case"wheel":return this._onWheel(e);case"keydown":return this._onKeyDown(e);default:return!1}}get controllerState(){return this._controllerState=this._controllerState||new this.ControllerState({makeViewport:this.makeViewport,...this.props,...this.state}),this._controllerState}getCenter(e){const{x:t,y:n}=this.props,{offsetCenter:r}=e;return[r.x-t,r.y-n]}isPointInBounds(e,t){const{width:n,height:r}=this.props;if(t&&t.handled)return!1;const o=e[0]>=0&&e[0]<=n&&e[1]>=0&&e[1]<=r;return o&&t&&t.stopPropagation(),o}isFunctionKeyPressed(e){const{srcEvent:t}=e;return Boolean(t.metaKey||t.altKey||t.ctrlKey||t.shiftKey)}isDragging(){return this._interactionState.isDragging||!1}blockEvents(e){const t=setTimeout(()=>{this._eventStartBlocked===t&&(this._eventStartBlocked=null)},e);this._eventStartBlocked=t}setProps(e){e.dragMode&&(this.dragMode=e.dragMode),this.props=e,"transitionInterpolator"in e||(e.transitionInterpolator=this._getTransitionProps().transitionInterpolator),this.transitionManager.processViewStateChange(e);const{inertia:t}=e;this.inertia=Number.isFinite(t)?t:!0===t?300:0;const{scrollZoom:n=!0,dragPan:r=!0,dragRotate:o=!0,doubleClickZoom:i=!0,touchZoom:s=!0,touchRotate:a=!1,keyboard:l=!0}=e,c=Boolean(this.onViewStateChange);this.toggleEvents(BM,c&&n),this.toggleEvents(IM,c),this.toggleEvents(RM,c&&(s||a)),this.toggleEvents(kM,c&&a),this.toggleEvents(TM,c&&i),this.toggleEvents(PM,c&&l),this.scrollZoom=n,this.dragPan=r,this.dragRotate=o,this.doubleClickZoom=i,this.touchZoom=s,this.touchRotate=a,this.keyboard=l}updateTransition(){this.transitionManager.updateTransition()}toggleEvents(e,t){this.eventManager&&e.forEach(e=>{this._events[e]!==t&&(this._events[e]=t,t?this.eventManager.on(e,this.handleEvent):this.eventManager.off(e,this.handleEvent))})}updateViewport(e,t=null,n={}){const r={...e.getViewportProps(),...t},o=this.controllerState!==e;if(this.state=e.getState(),this._setInteractionState(n),o){const e=this.controllerState&&this.controllerState.getViewportProps();this.onViewStateChange&&this.onViewStateChange({viewState:r,interactionState:this._interactionState,oldViewState:e,viewId:this.props.id})}}_onTransition(e){this.onViewStateChange({...e,interactionState:this._interactionState,viewId:this.props.id})}_setInteractionState(e){Object.assign(this._interactionState,e),this.onStateChange(this._interactionState)}_onPanStart(e){const t=this.getCenter(e);if(!this.isPointInBounds(t,e))return!1;let n=this.isFunctionKeyPressed(e)||e.rightButton||!1;(this.invertPan||"pan"===this.dragMode)&&(n=!n);const r=this.controllerState[n?"panStart":"rotateStart"]({pos:t});return this._panMove=n,this.updateViewport(r,SM,{isDragging:!0}),!0}_onPan(e){return!!this.isDragging()&&(this._panMove?this._onPanMove(e):this._onPanRotate(e))}_onPanEnd(e){return!!this.isDragging()&&(this._panMove?this._onPanMoveEnd(e):this._onPanRotateEnd(e))}_onPanMove(e){if(!this.dragPan)return!1;const t=this.getCenter(e),n=this.controllerState.pan({pos:t});return this.updateViewport(n,SM,{isDragging:!0,isPanning:!0}),!0}_onPanMoveEnd(e){const{inertia:t}=this;if(this.dragPan&&t&&e.velocity){const n=this.getCenter(e),r=[n[0]+e.velocityX*t/2,n[1]+e.velocityY*t/2],o=this.controllerState.pan({pos:r}).panEnd();this.updateViewport(o,{...this._getTransitionProps(),transitionDuration:t,transitionEasing:EM},{isDragging:!1,isPanning:!0})}else{const e=this.controllerState.panEnd();this.updateViewport(e,null,{isDragging:!1,isPanning:!1})}return!0}_onPanRotate(e){if(!this.dragRotate)return!1;const t=this.getCenter(e),n=this.controllerState.rotate({pos:t});return this.updateViewport(n,SM,{isDragging:!0,isRotating:!0}),!0}_onPanRotateEnd(e){const{inertia:t}=this;if(this.dragRotate&&t&&e.velocity){const n=this.getCenter(e),r=[n[0]+e.velocityX*t/2,n[1]+e.velocityY*t/2],o=this.controllerState.rotate({pos:r}).rotateEnd();this.updateViewport(o,{...this._getTransitionProps(),transitionDuration:t,transitionEasing:EM},{isDragging:!1,isRotating:!0})}else{const e=this.controllerState.rotateEnd();this.updateViewport(e,null,{isDragging:!1,isRotating:!1})}return!0}_onWheel(e){if(!this.scrollZoom)return!1;const t=this.getCenter(e);if(!this.isPointInBounds(t,e))return!1;e.srcEvent.preventDefault();const{speed:n=.01,smooth:r=!1}=!0===this.scrollZoom?{}:this.scrollZoom,{delta:o}=e;let i=2/(1+Math.exp(-Math.abs(o*n)));o<0&&0!==i&&(i=1/i);const s=this.controllerState.zoom({pos:t,scale:i});return this.updateViewport(s,{...this._getTransitionProps({around:t}),transitionDuration:r?250:1},{isZooming:!0,isPanning:!0}),!0}_onMultiPanStart(e){const t=this.getCenter(e);if(!this.isPointInBounds(t,e))return!1;const n=this.controllerState.rotateStart({pos:t});return this.updateViewport(n,SM,{isDragging:!0}),!0}_onMultiPan(e){if(!this.touchRotate)return!1;if(!this.isDragging())return!1;const t=this.getCenter(e);t[0]-=e.deltaX;const n=this.controllerState.rotate({pos:t});return this.updateViewport(n,SM,{isDragging:!0,isRotating:!0}),!0}_onMultiPanEnd(e){if(!this.isDragging())return!1;const{inertia:t}=this;if(this.touchRotate&&t&&e.velocityY){const n=this.getCenter(e),r=[n[0],n[1]+=e.velocityY*t/2],o=this.controllerState.rotate({pos:r});this.updateViewport(o,{...this._getTransitionProps(),transitionDuration:t,transitionEasing:EM},{isDragging:!1,isRotating:!0}),this.blockEvents(t)}else{const e=this.controllerState.rotateEnd();this.updateViewport(e,null,{isDragging:!1,isRotating:!1})}return!0}_onPinchStart(e){const t=this.getCenter(e);if(!this.isPointInBounds(t,e))return!1;const n=this.controllerState.zoomStart({pos:t}).rotateStart({pos:t});return FM._startPinchRotation=e.rotation,FM._lastPinchEvent=e,this.updateViewport(n,SM,{isDragging:!0}),!0}_onPinch(e){if(!this.touchZoom&&!this.touchRotate)return!1;if(!this.isDragging())return!1;let t=this.controllerState;if(this.touchZoom){const{scale:n}=e,r=this.getCenter(e);t=t.zoom({pos:r,scale:n})}if(this.touchRotate){const{rotation:n}=e;t=t.rotate({deltaAngleX:FM._startPinchRotation-n})}return this.updateViewport(t,SM,{isDragging:!0,isPanning:this.touchZoom,isZooming:this.touchZoom,isRotating:this.touchRotate}),FM._lastPinchEvent=e,!0}_onPinchEnd(e){if(!this.isDragging())return!1;const{inertia:t}=this,{_lastPinchEvent:n}=FM;if(this.touchZoom&&t&&n&&e.scale!==n.scale){const r=this.getCenter(e);let o=this.controllerState.rotateEnd();const i=Math.log2(e.scale),s=(i-Math.log2(n.scale))/(e.deltaTime-n.deltaTime),a=Math.pow(2,i+s*t/2);o=o.zoom({pos:r,scale:a}).zoomEnd(),this.updateViewport(o,{...this._getTransitionProps({around:r}),transitionDuration:t,transitionEasing:EM},{isDragging:!1,isPanning:this.touchZoom,isZooming:this.touchZoom,isRotating:!1}),this.blockEvents(t)}else{const e=this.controllerState.zoomEnd().rotateEnd();this.updateViewport(e,null,{isDragging:!1,isPanning:!1,isZooming:!1,isRotating:!1})}return FM._startPinchRotation=null,FM._lastPinchEvent=null,!0}_onDoubleClick(e){if(!this.doubleClickZoom)return!1;const t=this.getCenter(e);if(!this.isPointInBounds(t,e))return!1;const n=this.isFunctionKeyPressed(e),r=this.controllerState.zoom({pos:t,scale:n?.5:2});return this.updateViewport(r,this._getTransitionProps({around:t}),{isZooming:!0,isPanning:!0}),this.blockEvents(100),!0}_onKeyDown(e){if(!this.keyboard)return!1;const t=this.isFunctionKeyPressed(e),{zoomSpeed:n,moveSpeed:r,rotateSpeedX:o,rotateSpeedY:i}=!0===this.keyboard?{}:this.keyboard,{controllerState:s}=this;let a;const l={};switch(e.srcEvent.code){case"Minus":a=t?s.zoomOut(n).zoomOut(n):s.zoomOut(n),l.isZooming=!0;break;case"Equal":a=t?s.zoomIn(n).zoomIn(n):s.zoomIn(n),l.isZooming=!0;break;case"ArrowLeft":t?(a=s.rotateLeft(o),l.isRotating=!0):(a=s.moveLeft(r),l.isPanning=!0);break;case"ArrowRight":t?(a=s.rotateRight(o),l.isRotating=!0):(a=s.moveRight(r),l.isPanning=!0);break;case"ArrowUp":t?(a=s.rotateUp(i),l.isRotating=!0):(a=s.moveUp(r),l.isPanning=!0);break;case"ArrowDown":t?(a=s.rotateDown(i),l.isRotating=!0):(a=s.moveDown(r),l.isPanning=!0);break;default:return!1}return this.updateViewport(a,this._getTransitionProps(),l),!0}_getTransitionProps(e){const{transition:t}=this;return t&&t.transitionInterpolator?e?{...t,transitionInterpolator:new CM({...e,...t.transitionInterpolator.opts,makeViewport:this.controllerState.makeViewport})}:t:SM}};class LM{constructor(e,t){this._viewportProps=this.applyConstraints(e),this._state=t}getViewportProps(){return this._viewportProps}getState(){return this._state}}class UM extends LM{constructor(e){const{width:t,height:n,latitude:r,longitude:o,zoom:i,bearing:s=0,pitch:a=0,altitude:l=1.5,position:c=[0,0,0],maxZoom:u=20,minZoom:d=0,maxPitch:A=60,minPitch:h=0,startPanLngLat:p,startZoomLngLat:f,startRotatePos:g,startBearing:m,startPitch:y,startZoom:v,normalize:b=!0}=e;bM(Number.isFinite(o)),bM(Number.isFinite(r)),bM(Number.isFinite(i)),super({width:t,height:n,latitude:r,longitude:o,zoom:i,bearing:s,pitch:a,altitude:l,maxZoom:u,minZoom:d,maxPitch:A,minPitch:h,normalize:b,position:c},{startPanLngLat:p,startZoomLngLat:f,startRotatePos:g,startBearing:m,startPitch:y,startZoom:v}),this.makeViewport=e.makeViewport}panStart({pos:e}){return this._getUpdatedState({startPanLngLat:this._unproject(e)})}pan({pos:e,startPos:t}){const n=this.getState().startPanLngLat||this._unproject(t);if(!n)return this;const r=this.makeViewport(this.getViewportProps()).panByPosition(n,e);return this._getUpdatedState(r)}panEnd(){return this._getUpdatedState({startPanLngLat:null})}rotateStart({pos:e}){return this._getUpdatedState({startRotatePos:e,startBearing:this.getViewportProps().bearing,startPitch:this.getViewportProps().pitch})}rotate({pos:e,deltaAngleX:t=0,deltaAngleY:n=0}){const{startRotatePos:r,startBearing:o,startPitch:i}=this.getState();if(!r||void 0===o||void 0===i)return this;let s;return s=e?this._getNewRotation(e,r,i,o):{bearing:o+t,pitch:i+n},this._getUpdatedState(s)}rotateEnd(){return this._getUpdatedState({startBearing:null,startPitch:null})}zoomStart({pos:e}){return this._getUpdatedState({startZoomLngLat:this._unproject(e),startZoom:this.getViewportProps().zoom})}zoom({pos:e,startPos:t,scale:n}){let{startZoom:r,startZoomLngLat:o}=this.getState();if(o||(r=this.getViewportProps().zoom,o=this._unproject(t)||this._unproject(e)),!o)return this;const{maxZoom:i,minZoom:s}=this.getViewportProps();let a=r+Math.log2(n);a=jI(a,s,i);const l=this.makeViewport({...this.getViewportProps(),zoom:a});return this._getUpdatedState({zoom:a,...l.panByPosition(o,e)})}zoomEnd(){return this._getUpdatedState({startZoomLngLat:null,startZoom:null})}zoomIn(e=2){return this._zoomFromCenter(e)}zoomOut(e=2){return this._zoomFromCenter(1/e)}moveLeft(e=100){return this._panFromCenter([e,0])}moveRight(e=100){return this._panFromCenter([-e,0])}moveUp(e=100){return this._panFromCenter([0,e])}moveDown(e=100){return this._panFromCenter([0,-e])}rotateLeft(e=15){return this._getUpdatedState({bearing:this.getViewportProps().bearing-e})}rotateRight(e=15){return this._getUpdatedState({bearing:this.getViewportProps().bearing+e})}rotateUp(e=10){return this._getUpdatedState({pitch:this.getViewportProps().pitch+e})}rotateDown(e=10){return this._getUpdatedState({pitch:this.getViewportProps().pitch-e})}shortestPathFrom(e){const t=e.getViewportProps(),n={...this.getViewportProps()},{bearing:r,longitude:o}=n;return Math.abs(r-t.bearing)>180&&(n.bearing=r<0?r+360:r-360),Math.abs(o-t.longitude)>180&&(n.longitude=o<0?o+360:o-360),n}applyConstraints(e){const{maxZoom:t,minZoom:n,zoom:r}=e;e.zoom=jI(r,n,t);const{maxPitch:o,minPitch:i,pitch:s}=e;e.pitch=jI(s,i,o);const{normalize:a=!0}=e;return a&&Object.assign(e,function(e){const{width:t,height:n,pitch:r=0}=e;let{longitude:o,latitude:i,zoom:s,bearing:a=0}=e;(o<-180||o>180)&&(o=XT(o+180,360)-180),(a<-180||a>180)&&(a=XT(a+180,360)-180);const l=qT(n/512);if(s<=l)s=l,i=0;else{const e=n/2/Math.pow(2,s),t=lP([0,e])[1];if(i<t)i=t;else{const t=lP([0,512-e])[1];i>t&&(i=t)}}return{width:t,height:n,longitude:o,latitude:i,zoom:s,pitch:r,bearing:a}}(e)),e}_zoomFromCenter(e){const{width:t,height:n}=this.getViewportProps();return this.zoom({pos:[t/2,n/2],scale:e})}_panFromCenter(e){const{width:t,height:n}=this.getViewportProps();return this.pan({startPos:[t/2,n/2],pos:[t/2+e[0],n/2+e[1]]})}_getUpdatedState(e){return new this.constructor({makeViewport:this.makeViewport,...this.getViewportProps(),...this.getState(),...e})}_unproject(e){const t=this.makeViewport(this.getViewportProps());return e&&t.unproject(e)}_getNewRotation(e,t,n,r){const o=e[0]-t[0],i=e[1]-t[1],s=e[1],a=t[1],{width:l,height:c}=this.getViewportProps(),u=o/l;let d=0;i>0?Math.abs(c-a)>5&&(d=i/(a-c)*1.2):i<0&&a>5&&(d=1-s/a),d=jI(d,-1,1);const{minPitch:A,maxPitch:h}=this.getViewportProps();let p=n;return d>0?p=n+d*(h-n):d<0&&(p=n-d*(A-n)),{pitch:p,bearing:r+180*u}}}class OM extends MM{constructor(){super(...arguments),this.ControllerState=UM,this.transition={transitionDuration:300,transitionInterpolator:new CM({transitionProps:{compare:["longitude","latitude","zoom","bearing","pitch","position"],required:["longitude","latitude","zoom"]}})},this.dragMode="pan"}setProps(e){e.position=e.position||[0,0,0];const t=this.props;super.setProps(e);(!t||t.height!==e.height)&&this.updateViewport(new this.ControllerState({makeViewport:this.makeViewport,...e,...this.state}))}}class DM extends AM{constructor(e={}){super(e)}getViewportType(){return cF}get ControllerType(){return OM}}DM.displayName="MapView";const NM=new YP;class jM{constructor(e){this._resolvedEffects=[],this._defaultEffects=[],this.effects=[],this._context=e,this._needsRedraw="Initial render",this._setEffects([])}addDefaultEffect(e){const t=this._defaultEffects;if(!t.find(t=>t.id===e.id)){const n=t.findIndex(t=>function(e,t){return(e.order??1/0)-(t.order??1/0)}(t,e)>0);n<0?t.push(e):t.splice(n,0,e),e.setup(this._context),this._setEffects(this.effects)}}setProps(e){"effects"in e&&(aM(e.effects,this.effects,1)||this._setEffects(e.effects))}needsRedraw(e={clearRedrawFlags:!1}){const t=this._needsRedraw;return e.clearRedrawFlags&&(this._needsRedraw=!1),t}getEffects(){return this._resolvedEffects}_setEffects(e){const t={};for(const r of this.effects)t[r.id]=r;const n=[];for(const r of e){const e=t[r.id];let o=r;e&&e!==r?e.setProps?(e.setProps(r.props),o=e):e.cleanup(this._context):e||r.setup(this._context),n.push(o),delete t[r.id]}for(const r in t)t[r].cleanup(this._context);this.effects=n,this._resolvedEffects=n.concat(this._defaultEffects),e.some(e=>e instanceof YP)||this._resolvedEffects.push(NM),this._needsRedraw="effects changed"}finalize(){for(const e of this._resolvedEffects)e.cleanup(this._context);this.effects.length=0,this._resolvedEffects.length=0,this._defaultEffects.length=0}}class QM extends HP{shouldDrawLayer(e){const{operation:t}=e.props;return t.includes("draw")||t.includes("terrain")}}class zM{constructor(e){this.device=e,this.layerFilter=null,this.drawPickingColors=!1,this.drawLayersPass=new QM(e),this.pickLayersPass=new QF(e),this.renderCount=0,this._needsRedraw="Initial render",this.renderBuffers=[],this.lastPostProcessEffect=null}setProps(e){this.layerFilter!==e.layerFilter&&(this.layerFilter=e.layerFilter,this._needsRedraw="layerFilter changed"),this.drawPickingColors!==e.drawPickingColors&&(this.drawPickingColors=e.drawPickingColors,this._needsRedraw="drawPickingColors changed")}renderLayers(e){if(!e.viewports.length)return;const t=this.drawPickingColors?this.pickLayersPass:this.drawLayersPass,n={layerFilter:this.layerFilter,isPicking:this.drawPickingColors,...e};n.effects&&this._preRender(n.effects,n);const r=this.lastPostProcessEffect?this.renderBuffers[0]:n.target;this.lastPostProcessEffect&&(n.clearColor=[0,0,0,0],n.clearCanvas=!0);const o=t.render({...n,target:r});n.effects&&this._postRender(n.effects,n),this.renderCount++,fC("deckRenderer.renderLayers",this,o,e)}needsRedraw(e={clearRedrawFlags:!1}){const t=this._needsRedraw;return e.clearRedrawFlags&&(this._needsRedraw=!1),t}finalize(){const{renderBuffers:e}=this;for(const t of e)t.delete();e.length=0}_preRender(e,t){this.lastPostProcessEffect=null,t.preRenderStats=t.preRenderStats||{};for(const n of e)t.preRenderStats[n.id]=n.preRender(t),n.postRender&&(this.lastPostProcessEffect=n.id);this.lastPostProcessEffect&&this._resizeRenderBuffers()}_resizeRenderBuffers(){const{renderBuffers:e}=this,t=this.device.canvasContext.getDrawingBufferSize();0===e.length&&[0,1].map(t=>{const n=this.device.createTexture({sampler:{minFilter:"linear",magFilter:"linear"}});e.push(this.device.createFramebuffer({id:`deck-renderbuffer-${t}`,colorAttachments:[n]}))});for(const n of e)n.resize(t)}_postRender(e,t){const{renderBuffers:n}=this,r={...t,inputBuffer:n[0],swapBuffer:n[1]};for(const o of e)if(o.postRender){r.target=o.id===this.lastPostProcessEffect?t.target:void 0;const e=o.postRender(r);r.inputBuffer=e,r.swapBuffer=e===n[0]?n[1]:n[0]}}}const HM={pickedColor:null,pickedObjectIndex:-1};function GM({pickedColors:e,decodePickingColor:t,deviceX:n,deviceY:r,deviceRadius:o,deviceRect:i}){const{x:s,y:a,width:l,height:c}=i;let u=o*o,d=-1,A=0;for(let h=0;h<c;h++){const t=h+a-r,o=t*t;if(o>u)A+=4*l;else for(let r=0;r<l;r++){if(e[A+3]-1>=0){const e=r+s-n,t=e*e+o;t<=u&&(u=t,d=A)}A+=4}}if(d>=0){const n=e.slice(d,d+4),r=t(n);if(r){const e=Math.floor(d/4/l),t=d/4-e*l;return{...r,pickedColor:n,pickedX:s+t,pickedY:a+e}}AC.error("Picked non-existent layer. Is picking buffer corrupt?")()}return HM}function VM({pickInfo:e,viewports:t,pixelRatio:n,x:r,y:o,z:i}){let s,a=t[0];if(t.length>1&&(a=function(e,t){for(let n=e.length-1;n>=0;n--){const r=e[n];if(r.containsPixel(t))return r}return e[0]}(e?.pickedViewports||t,{x:r,y:o})),a){const e=[r-a.x,o-a.y];void 0!==i&&(e[2]=i),s=a.unproject(e)}return{color:null,layer:null,viewport:a,index:-1,picked:!1,x:r,y:o,pixel:[r,o],coordinate:s,devicePixel:e&&"pickedX"in e?[e.pickedX,e.pickedY]:void 0,pixelRatio:n}}function WM(e){const{pickInfo:t,lastPickedInfo:n,mode:r,layers:o}=e,{pickedColor:i,pickedLayer:s,pickedObjectIndex:a}=t,l=s?[s]:[];if("hover"===r){const e=n.index,t=n.layerId,r=s?s.props.id:null;if(r!==t||a!==e){if(r!==t){const e=o.find(e=>e.props.id===t);e&&l.unshift(e)}n.layerId=r,n.index=a,n.info=null}}const c=VM(e),u=new Map;return u.set(null,c),l.forEach(e=>{let t={...c};e===s&&(t.color=i,t.index=a,t.picked=!0),t=$M({layer:e,info:t,mode:r});const o=t.layer;e===s&&"hover"===r&&(n.info=t),u.set(o.id,t),"hover"===r&&o.updateAutoHighlight(t)}),u}function $M({layer:e,info:t,mode:n}){for(;e&&t;){const r=t.layer||null;t.sourceLayer=r,t.layer=e,t=e.getPickingInfo({info:t,mode:n,sourceLayer:r}),e=e.parent}return t}class KM{constructor(e){this._pickable=!0,this.device=e,this.pickLayersPass=new QF(e),this.lastPickedInfo={index:-1,layerId:null,info:null}}setProps(e){"layerFilter"in e&&(this.layerFilter=e.layerFilter),"_pickable"in e&&(this._pickable=e._pickable)}finalize(){this.pickingFBO&&this.pickingFBO.destroy(),this.depthFBO&&this.depthFBO.destroy()}pickObject(e){return this._pickClosestObject(e)}pickObjects(e){return this._pickVisibleObjects(e)}getLastPickedObject({x:e,y:t,layers:n,viewports:r},o=this.lastPickedInfo.info){const i=o&&o.layer&&o.layer.id,s=o&&o.viewport&&o.viewport.id,a=i?n.find(e=>e.id===i):null,l=s&&r.find(e=>e.id===s)||r[0],c=l&&l.unproject([e-l.x,t-l.y]),u={x:e,y:t,viewport:l,coordinate:c,layer:a};return{...o,...u}}_resizeBuffer(){if(!this.pickingFBO&&(this.pickingFBO=this.device.createFramebuffer({colorAttachments:["rgba8unorm"],depthStencilAttachment:"depth16unorm"}),this.device.isTextureFormatRenderable("rgba32float"))){const e=this.device.createFramebuffer({colorAttachments:["rgba32float"],depthStencilAttachment:"depth16unorm"});this.depthFBO=e}const{canvas:e}=this.device.getDefaultCanvasContext();this.pickingFBO?.resize({width:e.width,height:e.height}),this.depthFBO?.resize({width:e.width,height:e.height})}_getPickable(e){if(!1===this._pickable)return null;const t=e.filter(e=>this.pickLayersPass.shouldDrawLayer(e)&&!e.isComposite);return t.length?t:null}_pickClosestObject({layers:e,views:t,viewports:n,x:r,y:o,radius:i=0,depth:s=1,mode:a="query",unproject3D:l,onViewportActive:c,effects:u}){const d=this.device.canvasContext.cssToDeviceRatio(),A=this._getPickable(e);if(!A||0===n.length)return{result:[],emptyInfo:VM({viewports:n,x:r,y:o,pixelRatio:d})};this._resizeBuffer();const h=this.device.canvasContext.cssToDevicePixels([r,o],!0),p=[h.x+Math.floor(h.width/2),h.y+Math.floor(h.height/2)],f=Math.round(i*d),{width:g,height:m}=this.pickingFBO,y=this._getPickingRect({deviceX:p[0],deviceY:p[1],deviceRadius:f,deviceWidth:g,deviceHeight:m}),v={x:r-i,y:o-i,width:2*i+1,height:2*i+1};let b;const w=[],x=new Set;for(let _=0;_<s;_++){let e,i;if(y){e=GM({...this._drawAndSample({layers:A,views:t,viewports:n,onViewportActive:c,deviceRect:y,cullRect:v,effects:u,pass:`picking:${a}`}),deviceX:p[0],deviceY:p[1],deviceRadius:f,deviceRect:y})}else e={pickedColor:null,pickedObjectIndex:-1};if(e.pickedLayer&&l&&this.depthFBO){const{pickedColors:r}=this._drawAndSample({layers:[e.pickedLayer],views:t,viewports:n,onViewportActive:c,deviceRect:{x:e.pickedX,y:e.pickedY,width:1,height:1},cullRect:v,effects:u,pass:`picking:${a}:z`},!0);r[3]&&(i=r[0])}e.pickedLayer&&_+1<s&&(x.add(e.pickedLayer),e.pickedLayer.disablePickingIndex(e.pickedObjectIndex)),b=WM({pickInfo:e,lastPickedInfo:this.lastPickedInfo,mode:a,layers:A,viewports:n,x:r,y:o,z:i,pixelRatio:d});for(const t of b.values())t.layer&&w.push(t);if(!e.pickedColor)break}for(const _ of x)_.restorePickingColors();return{result:w,emptyInfo:b.get(null)}}_pickVisibleObjects({layers:e,views:t,viewports:n,x:r,y:o,width:i=1,height:s=1,mode:a="query",maxObjects:l=null,onViewportActive:c,effects:u}){const d=this._getPickable(e);if(!d||0===n.length)return[];this._resizeBuffer();const A=this.device.canvasContext.cssToDeviceRatio(),h=this.device.canvasContext.cssToDevicePixels([r,o],!0),p=h.x,f=h.y+h.height,g=this.device.canvasContext.cssToDevicePixels([r+i,o+s],!0),m=g.x+g.width,y=g.y,v={x:p,y:y,width:m-p,height:f-y},b=function({pickedColors:e,decodePickingColor:t}){const n=new Map;if(e)for(let r=0;r<e.length;r+=4)if(e[r+3]-1>=0){const o=e.slice(r,r+4),i=o.join(",");if(!n.has(i)){const e=t(o);e?n.set(i,{...e,color:o}):AC.error("Picked non-existent layer. Is picking buffer corrupt?")()}}return Array.from(n.values())}(this._drawAndSample({layers:d,views:t,viewports:n,onViewportActive:c,deviceRect:v,cullRect:{x:r,y:o,width:i,height:s},effects:u,pass:`picking:${a}`})),w=new Map,x=[],_=Number.isFinite(l);for(let C=0;C<b.length&&!(_&&x.length>=l);C++){const e=b[C];let t={color:e.pickedColor,layer:null,index:e.pickedObjectIndex,picked:!0,x:r,y:o,pixelRatio:A};t=$M({layer:e.pickedLayer,info:t,mode:a});const n=t.layer.id;w.has(n)||w.set(n,new Set);const i=w.get(n),s=t.object??t.index;i.has(s)||(i.add(s),x.push(t))}return x}_drawAndSample({layers:e,views:t,viewports:n,onViewportActive:r,deviceRect:o,cullRect:i,effects:s,pass:a},l=!1){const c=l?this.depthFBO:this.pickingFBO,u={layers:e,layerFilter:this.layerFilter,views:t,viewports:n,onViewportActive:r,pickingFBO:c,deviceRect:o,cullRect:i,effects:s,pass:a,pickZ:l,preRenderStats:{},isPicking:!0};for(const m of s)m.useInPicking&&(u.preRenderStats[m.id]=m.preRender(u));const{decodePickingColor:d}=this.pickLayersPass.render(u),{x:A,y:h,width:p,height:f}=o,g=new(l?Float32Array:Uint8Array)(p*f*4);return this.device.readPixelsToArrayWebGL(c,{sourceX:A,sourceY:h,sourceWidth:p,sourceHeight:f,target:g}),{pickedColors:g,decodePickingColor:d}}_getPickingRect({deviceX:e,deviceY:t,deviceRadius:n,deviceWidth:r,deviceHeight:o}){const i=Math.max(0,e-n),s=Math.max(0,t-n),a=Math.min(r,e+n+1)-i,l=Math.min(o,t+n+1)-s;return a<=0||l<=0?null:{x:i,y:s,width:a,height:l}}}const XM={"top-left":{top:0,left:0},"top-right":{top:0,right:0},"bottom-left":{bottom:0,left:0},"bottom-right":{bottom:0,right:0},fill:{top:0,left:0,bottom:0,right:0}},YM="top-left",qM="__root";class JM{constructor({deck:e,parentElement:t}){this.defaultWidgets=[],this.widgets=[],this.resolvedWidgets=[],this.containers={},this.lastViewports={},this.deck=e,this.parentElement=t}getWidgets(){return this.resolvedWidgets}setProps(e){e.widgets&&!aM(e.widgets,this.widgets,1)&&this._setWidgets(e.widgets)}finalize(){for(const e of this.getWidgets())this._remove(e);this.defaultWidgets.length=0,this.resolvedWidgets.length=0;for(const e in this.containers)this.containers[e].remove()}addDefault(e){this.defaultWidgets.find(t=>t.id===e.id)||(this._add(e),this.defaultWidgets.push(e),this._setWidgets(this.widgets))}_setWidgets(e){const t={};for(const n of this.resolvedWidgets)t[n.id]=n;this.resolvedWidgets.length=0;for(const n of this.defaultWidgets)t[n.id]=null,this.resolvedWidgets.push(n);for(let n of e){const e=t[n.id];e?e.viewId!==n.viewId||e.placement!==n.placement?(this._remove(e),this._add(n)):n!==e&&(e.setProps(n.props),n=e):this._add(n),t[n.id]=null,this.resolvedWidgets.push(n)}for(const n in t){const e=t[n];e&&this._remove(e)}this.widgets=e}_add(e){const{viewId:t=null,placement:n=YM}=e,r=e.onAdd({deck:this.deck,viewId:t});r&&this._getContainer(t,n).append(r),e._element=r}_remove(e){e.onRemove?.(),e._element&&e._element.remove(),e._element=void 0}_getContainer(e,t){const n=e||qM;let r=this.containers[n];r||(r=document.createElement("div"),r.style.pointerEvents="none",r.style.position="absolute",r.style.overflow="hidden",this.parentElement?.append(r),this.containers[n]=r);let o=r.querySelector(`.${t}`);return o||(o=document.createElement("div"),o.className=t,o.style.position="absolute",o.style.zIndex="2",Object.assign(o.style,XM[t]),r.append(o)),o}_updateContainers(){const e=this.deck.width,t=this.deck.height;for(const n in this.containers){const r=this.lastViewports[n]||null,o=n===qM||r,i=this.containers[n];o?(i.style.display="block",i.style.left=`${r?r.x:0}px`,i.style.top=`${r?r.y:0}px`,i.style.width=`${r?r.width:e}px`,i.style.height=`${r?r.height:t}px`):i.style.display="none"}}onRedraw({viewports:e,layers:t}){const n=e.reduce((e,t)=>(e[t.id]=t,e),{});for(const r of this.getWidgets()){const{viewId:o}=r;if(o){const e=n[o];e&&(r.onViewportChange&&r.onViewportChange(e),r.onRedraw?.({viewports:[e],layers:t}))}else{if(r.onViewportChange)for(const t of e)r.onViewportChange(t);r.onRedraw?.({viewports:e,layers:t})}}this.lastViewports=n,this._updateContainers()}onHover(e,t){for(const n of this.getWidgets()){const{viewId:r}=n;r&&r!==e.viewport?.id||n.onHover?.(e,t)}}onEvent(e,t){const n=kT[t.type];if(n)for(const r of this.getWidgets()){const{viewId:o}=r;o&&o!==e.viewport?.id||r[n]?.(e,t)}}}const ZM={zIndex:"1",position:"absolute",pointerEvents:"none",color:"#a0a7b4",backgroundColor:"#29323c",padding:"10px",top:"0",left:"0",display:"none"};class eL{constructor(){this.id="default-tooltip",this.placement="fill",this.props={},this.isVisible=!1}onAdd({deck:e}){const t=document.createElement("div");return t.className="deck-tooltip",Object.assign(t.style,ZM),this.deck=e,this.element=t,t}onRemove(){this.deck=void 0,this.element=void 0}setProps(){}onViewportChange(e){this.isVisible&&e.id===this.lastViewport?.id&&e!==this.lastViewport&&this.setTooltip(null)}onHover(e){const{deck:t}=this,n=t&&t.props.getTooltip;if(!n)return;const r=n(e);this.lastViewport=e.viewport,this.setTooltip(r,e.x,e.y)}setTooltip(e,t,n){const r=this.element;if(r){if("string"==typeof e)r.innerText=e;else{if(!e)return this.isVisible=!1,void(r.style.display="none");e.text&&(r.innerText=e.text),e.html&&(r.innerHTML=e.html),e.className&&(r.className=e.className)}this.isVisible=!0,r.style.display="block",r.style.transform=`translate(${t}px, ${n}px)`,e&&"object"==typeof e&&"style"in e&&Object.assign(r.style,e.style)}}}var tL,nL;(nL=tL||(tL={}))[nL.DEPTH_BUFFER_BIT=256]="DEPTH_BUFFER_BIT",nL[nL.STENCIL_BUFFER_BIT=1024]="STENCIL_BUFFER_BIT",nL[nL.COLOR_BUFFER_BIT=16384]="COLOR_BUFFER_BIT",nL[nL.POINTS=0]="POINTS",nL[nL.LINES=1]="LINES",nL[nL.LINE_LOOP=2]="LINE_LOOP",nL[nL.LINE_STRIP=3]="LINE_STRIP",nL[nL.TRIANGLES=4]="TRIANGLES",nL[nL.TRIANGLE_STRIP=5]="TRIANGLE_STRIP",nL[nL.TRIANGLE_FAN=6]="TRIANGLE_FAN",nL[nL.ZERO=0]="ZERO",nL[nL.ONE=1]="ONE",nL[nL.SRC_COLOR=768]="SRC_COLOR",nL[nL.ONE_MINUS_SRC_COLOR=769]="ONE_MINUS_SRC_COLOR",nL[nL.SRC_ALPHA=770]="SRC_ALPHA",nL[nL.ONE_MINUS_SRC_ALPHA=771]="ONE_MINUS_SRC_ALPHA",nL[nL.DST_ALPHA=772]="DST_ALPHA",nL[nL.ONE_MINUS_DST_ALPHA=773]="ONE_MINUS_DST_ALPHA",nL[nL.DST_COLOR=774]="DST_COLOR",nL[nL.ONE_MINUS_DST_COLOR=775]="ONE_MINUS_DST_COLOR",nL[nL.SRC_ALPHA_SATURATE=776]="SRC_ALPHA_SATURATE",nL[nL.CONSTANT_COLOR=32769]="CONSTANT_COLOR",nL[nL.ONE_MINUS_CONSTANT_COLOR=32770]="ONE_MINUS_CONSTANT_COLOR",nL[nL.CONSTANT_ALPHA=32771]="CONSTANT_ALPHA",nL[nL.ONE_MINUS_CONSTANT_ALPHA=32772]="ONE_MINUS_CONSTANT_ALPHA",nL[nL.FUNC_ADD=32774]="FUNC_ADD",nL[nL.FUNC_SUBTRACT=32778]="FUNC_SUBTRACT",nL[nL.FUNC_REVERSE_SUBTRACT=32779]="FUNC_REVERSE_SUBTRACT",nL[nL.BLEND_EQUATION=32777]="BLEND_EQUATION",nL[nL.BLEND_EQUATION_RGB=32777]="BLEND_EQUATION_RGB",nL[nL.BLEND_EQUATION_ALPHA=34877]="BLEND_EQUATION_ALPHA",nL[nL.BLEND_DST_RGB=32968]="BLEND_DST_RGB",nL[nL.BLEND_SRC_RGB=32969]="BLEND_SRC_RGB",nL[nL.BLEND_DST_ALPHA=32970]="BLEND_DST_ALPHA",nL[nL.BLEND_SRC_ALPHA=32971]="BLEND_SRC_ALPHA",nL[nL.BLEND_COLOR=32773]="BLEND_COLOR",nL[nL.ARRAY_BUFFER_BINDING=34964]="ARRAY_BUFFER_BINDING",nL[nL.ELEMENT_ARRAY_BUFFER_BINDING=34965]="ELEMENT_ARRAY_BUFFER_BINDING",nL[nL.LINE_WIDTH=2849]="LINE_WIDTH",nL[nL.ALIASED_POINT_SIZE_RANGE=33901]="ALIASED_POINT_SIZE_RANGE",nL[nL.ALIASED_LINE_WIDTH_RANGE=33902]="ALIASED_LINE_WIDTH_RANGE",nL[nL.CULL_FACE_MODE=2885]="CULL_FACE_MODE",nL[nL.FRONT_FACE=2886]="FRONT_FACE",nL[nL.DEPTH_RANGE=2928]="DEPTH_RANGE",nL[nL.DEPTH_WRITEMASK=2930]="DEPTH_WRITEMASK",nL[nL.DEPTH_CLEAR_VALUE=2931]="DEPTH_CLEAR_VALUE",nL[nL.DEPTH_FUNC=2932]="DEPTH_FUNC",nL[nL.STENCIL_CLEAR_VALUE=2961]="STENCIL_CLEAR_VALUE",nL[nL.STENCIL_FUNC=2962]="STENCIL_FUNC",nL[nL.STENCIL_FAIL=2964]="STENCIL_FAIL",nL[nL.STENCIL_PASS_DEPTH_FAIL=2965]="STENCIL_PASS_DEPTH_FAIL",nL[nL.STENCIL_PASS_DEPTH_PASS=2966]="STENCIL_PASS_DEPTH_PASS",nL[nL.STENCIL_REF=2967]="STENCIL_REF",nL[nL.STENCIL_VALUE_MASK=2963]="STENCIL_VALUE_MASK",nL[nL.STENCIL_WRITEMASK=2968]="STENCIL_WRITEMASK",nL[nL.STENCIL_BACK_FUNC=34816]="STENCIL_BACK_FUNC",nL[nL.STENCIL_BACK_FAIL=34817]="STENCIL_BACK_FAIL",nL[nL.STENCIL_BACK_PASS_DEPTH_FAIL=34818]="STENCIL_BACK_PASS_DEPTH_FAIL",nL[nL.STENCIL_BACK_PASS_DEPTH_PASS=34819]="STENCIL_BACK_PASS_DEPTH_PASS",nL[nL.STENCIL_BACK_REF=36003]="STENCIL_BACK_REF",nL[nL.STENCIL_BACK_VALUE_MASK=36004]="STENCIL_BACK_VALUE_MASK",nL[nL.STENCIL_BACK_WRITEMASK=36005]="STENCIL_BACK_WRITEMASK",nL[nL.VIEWPORT=2978]="VIEWPORT",nL[nL.SCISSOR_BOX=3088]="SCISSOR_BOX",nL[nL.COLOR_CLEAR_VALUE=3106]="COLOR_CLEAR_VALUE",nL[nL.COLOR_WRITEMASK=3107]="COLOR_WRITEMASK",nL[nL.UNPACK_ALIGNMENT=3317]="UNPACK_ALIGNMENT",nL[nL.PACK_ALIGNMENT=3333]="PACK_ALIGNMENT",nL[nL.MAX_TEXTURE_SIZE=3379]="MAX_TEXTURE_SIZE",nL[nL.MAX_VIEWPORT_DIMS=3386]="MAX_VIEWPORT_DIMS",nL[nL.SUBPIXEL_BITS=3408]="SUBPIXEL_BITS",nL[nL.RED_BITS=3410]="RED_BITS",nL[nL.GREEN_BITS=3411]="GREEN_BITS",nL[nL.BLUE_BITS=3412]="BLUE_BITS",nL[nL.ALPHA_BITS=3413]="ALPHA_BITS",nL[nL.DEPTH_BITS=3414]="DEPTH_BITS",nL[nL.STENCIL_BITS=3415]="STENCIL_BITS",nL[nL.POLYGON_OFFSET_UNITS=10752]="POLYGON_OFFSET_UNITS",nL[nL.POLYGON_OFFSET_FACTOR=32824]="POLYGON_OFFSET_FACTOR",nL[nL.TEXTURE_BINDING_2D=32873]="TEXTURE_BINDING_2D",nL[nL.SAMPLE_BUFFERS=32936]="SAMPLE_BUFFERS",nL[nL.SAMPLES=32937]="SAMPLES",nL[nL.SAMPLE_COVERAGE_VALUE=32938]="SAMPLE_COVERAGE_VALUE",nL[nL.SAMPLE_COVERAGE_INVERT=32939]="SAMPLE_COVERAGE_INVERT",nL[nL.COMPRESSED_TEXTURE_FORMATS=34467]="COMPRESSED_TEXTURE_FORMATS",nL[nL.VENDOR=7936]="VENDOR",nL[nL.RENDERER=7937]="RENDERER",nL[nL.VERSION=7938]="VERSION",nL[nL.IMPLEMENTATION_COLOR_READ_TYPE=35738]="IMPLEMENTATION_COLOR_READ_TYPE",nL[nL.IMPLEMENTATION_COLOR_READ_FORMAT=35739]="IMPLEMENTATION_COLOR_READ_FORMAT",nL[nL.BROWSER_DEFAULT_WEBGL=37444]="BROWSER_DEFAULT_WEBGL",nL[nL.STATIC_DRAW=35044]="STATIC_DRAW",nL[nL.STREAM_DRAW=35040]="STREAM_DRAW",nL[nL.DYNAMIC_DRAW=35048]="DYNAMIC_DRAW",nL[nL.ARRAY_BUFFER=34962]="ARRAY_BUFFER",nL[nL.ELEMENT_ARRAY_BUFFER=34963]="ELEMENT_ARRAY_BUFFER",nL[nL.BUFFER_SIZE=34660]="BUFFER_SIZE",nL[nL.BUFFER_USAGE=34661]="BUFFER_USAGE",nL[nL.CURRENT_VERTEX_ATTRIB=34342]="CURRENT_VERTEX_ATTRIB",nL[nL.VERTEX_ATTRIB_ARRAY_ENABLED=34338]="VERTEX_ATTRIB_ARRAY_ENABLED",nL[nL.VERTEX_ATTRIB_ARRAY_SIZE=34339]="VERTEX_ATTRIB_ARRAY_SIZE",nL[nL.VERTEX_ATTRIB_ARRAY_STRIDE=34340]="VERTEX_ATTRIB_ARRAY_STRIDE",nL[nL.VERTEX_ATTRIB_ARRAY_TYPE=34341]="VERTEX_ATTRIB_ARRAY_TYPE",nL[nL.VERTEX_ATTRIB_ARRAY_NORMALIZED=34922]="VERTEX_ATTRIB_ARRAY_NORMALIZED",nL[nL.VERTEX_ATTRIB_ARRAY_POINTER=34373]="VERTEX_ATTRIB_ARRAY_POINTER",nL[nL.VERTEX_ATTRIB_ARRAY_BUFFER_BINDING=34975]="VERTEX_ATTRIB_ARRAY_BUFFER_BINDING",nL[nL.CULL_FACE=2884]="CULL_FACE",nL[nL.FRONT=1028]="FRONT",nL[nL.BACK=1029]="BACK",nL[nL.FRONT_AND_BACK=1032]="FRONT_AND_BACK",nL[nL.BLEND=3042]="BLEND",nL[nL.DEPTH_TEST=2929]="DEPTH_TEST",nL[nL.DITHER=3024]="DITHER",nL[nL.POLYGON_OFFSET_FILL=32823]="POLYGON_OFFSET_FILL",nL[nL.SAMPLE_ALPHA_TO_COVERAGE=32926]="SAMPLE_ALPHA_TO_COVERAGE",nL[nL.SAMPLE_COVERAGE=32928]="SAMPLE_COVERAGE",nL[nL.SCISSOR_TEST=3089]="SCISSOR_TEST",nL[nL.STENCIL_TEST=2960]="STENCIL_TEST",nL[nL.NO_ERROR=0]="NO_ERROR",nL[nL.INVALID_ENUM=1280]="INVALID_ENUM",nL[nL.INVALID_VALUE=1281]="INVALID_VALUE",nL[nL.INVALID_OPERATION=1282]="INVALID_OPERATION",nL[nL.OUT_OF_MEMORY=1285]="OUT_OF_MEMORY",nL[nL.CONTEXT_LOST_WEBGL=37442]="CONTEXT_LOST_WEBGL",nL[nL.CW=2304]="CW",nL[nL.CCW=2305]="CCW",nL[nL.DONT_CARE=4352]="DONT_CARE",nL[nL.FASTEST=4353]="FASTEST",nL[nL.NICEST=4354]="NICEST",nL[nL.GENERATE_MIPMAP_HINT=33170]="GENERATE_MIPMAP_HINT",nL[nL.BYTE=5120]="BYTE",nL[nL.UNSIGNED_BYTE=5121]="UNSIGNED_BYTE",nL[nL.SHORT=5122]="SHORT",nL[nL.UNSIGNED_SHORT=5123]="UNSIGNED_SHORT",nL[nL.INT=5124]="INT",nL[nL.UNSIGNED_INT=5125]="UNSIGNED_INT",nL[nL.FLOAT=5126]="FLOAT",nL[nL.DOUBLE=5130]="DOUBLE",nL[nL.DEPTH_COMPONENT=6402]="DEPTH_COMPONENT",nL[nL.ALPHA=6406]="ALPHA",nL[nL.RGB=6407]="RGB",nL[nL.RGBA=6408]="RGBA",nL[nL.LUMINANCE=6409]="LUMINANCE",nL[nL.LUMINANCE_ALPHA=6410]="LUMINANCE_ALPHA",nL[nL.UNSIGNED_SHORT_4_4_4_4=32819]="UNSIGNED_SHORT_4_4_4_4",nL[nL.UNSIGNED_SHORT_5_5_5_1=32820]="UNSIGNED_SHORT_5_5_5_1",nL[nL.UNSIGNED_SHORT_5_6_5=33635]="UNSIGNED_SHORT_5_6_5",nL[nL.FRAGMENT_SHADER=35632]="FRAGMENT_SHADER",nL[nL.VERTEX_SHADER=35633]="VERTEX_SHADER",nL[nL.COMPILE_STATUS=35713]="COMPILE_STATUS",nL[nL.DELETE_STATUS=35712]="DELETE_STATUS",nL[nL.LINK_STATUS=35714]="LINK_STATUS",nL[nL.VALIDATE_STATUS=35715]="VALIDATE_STATUS",nL[nL.ATTACHED_SHADERS=35717]="ATTACHED_SHADERS",nL[nL.ACTIVE_ATTRIBUTES=35721]="ACTIVE_ATTRIBUTES",nL[nL.ACTIVE_UNIFORMS=35718]="ACTIVE_UNIFORMS",nL[nL.MAX_VERTEX_ATTRIBS=34921]="MAX_VERTEX_ATTRIBS",nL[nL.MAX_VERTEX_UNIFORM_VECTORS=36347]="MAX_VERTEX_UNIFORM_VECTORS",nL[nL.MAX_VARYING_VECTORS=36348]="MAX_VARYING_VECTORS",nL[nL.MAX_COMBINED_TEXTURE_IMAGE_UNITS=35661]="MAX_COMBINED_TEXTURE_IMAGE_UNITS",nL[nL.MAX_VERTEX_TEXTURE_IMAGE_UNITS=35660]="MAX_VERTEX_TEXTURE_IMAGE_UNITS",nL[nL.MAX_TEXTURE_IMAGE_UNITS=34930]="MAX_TEXTURE_IMAGE_UNITS",nL[nL.MAX_FRAGMENT_UNIFORM_VECTORS=36349]="MAX_FRAGMENT_UNIFORM_VECTORS",nL[nL.SHADER_TYPE=35663]="SHADER_TYPE",nL[nL.SHADING_LANGUAGE_VERSION=35724]="SHADING_LANGUAGE_VERSION",nL[nL.CURRENT_PROGRAM=35725]="CURRENT_PROGRAM",nL[nL.NEVER=512]="NEVER",nL[nL.LESS=513]="LESS",nL[nL.EQUAL=514]="EQUAL",nL[nL.LEQUAL=515]="LEQUAL",nL[nL.GREATER=516]="GREATER",nL[nL.NOTEQUAL=517]="NOTEQUAL",nL[nL.GEQUAL=518]="GEQUAL",nL[nL.ALWAYS=519]="ALWAYS",nL[nL.KEEP=7680]="KEEP",nL[nL.REPLACE=7681]="REPLACE",nL[nL.INCR=7682]="INCR",nL[nL.DECR=7683]="DECR",nL[nL.INVERT=5386]="INVERT",nL[nL.INCR_WRAP=34055]="INCR_WRAP",nL[nL.DECR_WRAP=34056]="DECR_WRAP",nL[nL.NEAREST=9728]="NEAREST",nL[nL.LINEAR=9729]="LINEAR",nL[nL.NEAREST_MIPMAP_NEAREST=9984]="NEAREST_MIPMAP_NEAREST",nL[nL.LINEAR_MIPMAP_NEAREST=9985]="LINEAR_MIPMAP_NEAREST",nL[nL.NEAREST_MIPMAP_LINEAR=9986]="NEAREST_MIPMAP_LINEAR",nL[nL.LINEAR_MIPMAP_LINEAR=9987]="LINEAR_MIPMAP_LINEAR",nL[nL.TEXTURE_MAG_FILTER=10240]="TEXTURE_MAG_FILTER",nL[nL.TEXTURE_MIN_FILTER=10241]="TEXTURE_MIN_FILTER",nL[nL.TEXTURE_WRAP_S=10242]="TEXTURE_WRAP_S",nL[nL.TEXTURE_WRAP_T=10243]="TEXTURE_WRAP_T",nL[nL.TEXTURE_2D=3553]="TEXTURE_2D",nL[nL.TEXTURE=5890]="TEXTURE",nL[nL.TEXTURE_CUBE_MAP=34067]="TEXTURE_CUBE_MAP",nL[nL.TEXTURE_BINDING_CUBE_MAP=34068]="TEXTURE_BINDING_CUBE_MAP",nL[nL.TEXTURE_CUBE_MAP_POSITIVE_X=34069]="TEXTURE_CUBE_MAP_POSITIVE_X",nL[nL.TEXTURE_CUBE_MAP_NEGATIVE_X=34070]="TEXTURE_CUBE_MAP_NEGATIVE_X",nL[nL.TEXTURE_CUBE_MAP_POSITIVE_Y=34071]="TEXTURE_CUBE_MAP_POSITIVE_Y",nL[nL.TEXTURE_CUBE_MAP_NEGATIVE_Y=34072]="TEXTURE_CUBE_MAP_NEGATIVE_Y",nL[nL.TEXTURE_CUBE_MAP_POSITIVE_Z=34073]="TEXTURE_CUBE_MAP_POSITIVE_Z",nL[nL.TEXTURE_CUBE_MAP_NEGATIVE_Z=34074]="TEXTURE_CUBE_MAP_NEGATIVE_Z",nL[nL.MAX_CUBE_MAP_TEXTURE_SIZE=34076]="MAX_CUBE_MAP_TEXTURE_SIZE",nL[nL.TEXTURE0=33984]="TEXTURE0",nL[nL.ACTIVE_TEXTURE=34016]="ACTIVE_TEXTURE",nL[nL.REPEAT=10497]="REPEAT",nL[nL.CLAMP_TO_EDGE=33071]="CLAMP_TO_EDGE",nL[nL.MIRRORED_REPEAT=33648]="MIRRORED_REPEAT",nL[nL.TEXTURE_WIDTH=4096]="TEXTURE_WIDTH",nL[nL.TEXTURE_HEIGHT=4097]="TEXTURE_HEIGHT",nL[nL.FLOAT_VEC2=35664]="FLOAT_VEC2",nL[nL.FLOAT_VEC3=35665]="FLOAT_VEC3",nL[nL.FLOAT_VEC4=35666]="FLOAT_VEC4",nL[nL.INT_VEC2=35667]="INT_VEC2",nL[nL.INT_VEC3=35668]="INT_VEC3",nL[nL.INT_VEC4=35669]="INT_VEC4",nL[nL.BOOL=35670]="BOOL",nL[nL.BOOL_VEC2=35671]="BOOL_VEC2",nL[nL.BOOL_VEC3=35672]="BOOL_VEC3",nL[nL.BOOL_VEC4=35673]="BOOL_VEC4",nL[nL.FLOAT_MAT2=35674]="FLOAT_MAT2",nL[nL.FLOAT_MAT3=35675]="FLOAT_MAT3",nL[nL.FLOAT_MAT4=35676]="FLOAT_MAT4",nL[nL.SAMPLER_2D=35678]="SAMPLER_2D",nL[nL.SAMPLER_CUBE=35680]="SAMPLER_CUBE",nL[nL.LOW_FLOAT=36336]="LOW_FLOAT",nL[nL.MEDIUM_FLOAT=36337]="MEDIUM_FLOAT",nL[nL.HIGH_FLOAT=36338]="HIGH_FLOAT",nL[nL.LOW_INT=36339]="LOW_INT",nL[nL.MEDIUM_INT=36340]="MEDIUM_INT",nL[nL.HIGH_INT=36341]="HIGH_INT",nL[nL.FRAMEBUFFER=36160]="FRAMEBUFFER",nL[nL.RENDERBUFFER=36161]="RENDERBUFFER",nL[nL.RGBA4=32854]="RGBA4",nL[nL.RGB5_A1=32855]="RGB5_A1",nL[nL.RGB565=36194]="RGB565",nL[nL.DEPTH_COMPONENT16=33189]="DEPTH_COMPONENT16",nL[nL.STENCIL_INDEX=6401]="STENCIL_INDEX",nL[nL.STENCIL_INDEX8=36168]="STENCIL_INDEX8",nL[nL.DEPTH_STENCIL=34041]="DEPTH_STENCIL",nL[nL.RENDERBUFFER_WIDTH=36162]="RENDERBUFFER_WIDTH",nL[nL.RENDERBUFFER_HEIGHT=36163]="RENDERBUFFER_HEIGHT",nL[nL.RENDERBUFFER_INTERNAL_FORMAT=36164]="RENDERBUFFER_INTERNAL_FORMAT",nL[nL.RENDERBUFFER_RED_SIZE=36176]="RENDERBUFFER_RED_SIZE",nL[nL.RENDERBUFFER_GREEN_SIZE=36177]="RENDERBUFFER_GREEN_SIZE",nL[nL.RENDERBUFFER_BLUE_SIZE=36178]="RENDERBUFFER_BLUE_SIZE",nL[nL.RENDERBUFFER_ALPHA_SIZE=36179]="RENDERBUFFER_ALPHA_SIZE",nL[nL.RENDERBUFFER_DEPTH_SIZE=36180]="RENDERBUFFER_DEPTH_SIZE",nL[nL.RENDERBUFFER_STENCIL_SIZE=36181]="RENDERBUFFER_STENCIL_SIZE",nL[nL.FRAMEBUFFER_ATTACHMENT_OBJECT_TYPE=36048]="FRAMEBUFFER_ATTACHMENT_OBJECT_TYPE",nL[nL.FRAMEBUFFER_ATTACHMENT_OBJECT_NAME=36049]="FRAMEBUFFER_ATTACHMENT_OBJECT_NAME",nL[nL.FRAMEBUFFER_ATTACHMENT_TEXTURE_LEVEL=36050]="FRAMEBUFFER_ATTACHMENT_TEXTURE_LEVEL",nL[nL.FRAMEBUFFER_ATTACHMENT_TEXTURE_CUBE_MAP_FACE=36051]="FRAMEBUFFER_ATTACHMENT_TEXTURE_CUBE_MAP_FACE",nL[nL.COLOR_ATTACHMENT0=36064]="COLOR_ATTACHMENT0",nL[nL.DEPTH_ATTACHMENT=36096]="DEPTH_ATTACHMENT",nL[nL.STENCIL_ATTACHMENT=36128]="STENCIL_ATTACHMENT",nL[nL.DEPTH_STENCIL_ATTACHMENT=33306]="DEPTH_STENCIL_ATTACHMENT",nL[nL.NONE=0]="NONE",nL[nL.FRAMEBUFFER_COMPLETE=36053]="FRAMEBUFFER_COMPLETE",nL[nL.FRAMEBUFFER_INCOMPLETE_ATTACHMENT=36054]="FRAMEBUFFER_INCOMPLETE_ATTACHMENT",nL[nL.FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT=36055]="FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT",nL[nL.FRAMEBUFFER_INCOMPLETE_DIMENSIONS=36057]="FRAMEBUFFER_INCOMPLETE_DIMENSIONS",nL[nL.FRAMEBUFFER_UNSUPPORTED=36061]="FRAMEBUFFER_UNSUPPORTED",nL[nL.FRAMEBUFFER_BINDING=36006]="FRAMEBUFFER_BINDING",nL[nL.RENDERBUFFER_BINDING=36007]="RENDERBUFFER_BINDING",nL[nL.READ_FRAMEBUFFER=36008]="READ_FRAMEBUFFER",nL[nL.DRAW_FRAMEBUFFER=36009]="DRAW_FRAMEBUFFER",nL[nL.MAX_RENDERBUFFER_SIZE=34024]="MAX_RENDERBUFFER_SIZE",nL[nL.INVALID_FRAMEBUFFER_OPERATION=1286]="INVALID_FRAMEBUFFER_OPERATION",nL[nL.UNPACK_FLIP_Y_WEBGL=37440]="UNPACK_FLIP_Y_WEBGL",nL[nL.UNPACK_PREMULTIPLY_ALPHA_WEBGL=37441]="UNPACK_PREMULTIPLY_ALPHA_WEBGL",nL[nL.UNPACK_COLORSPACE_CONVERSION_WEBGL=37443]="UNPACK_COLORSPACE_CONVERSION_WEBGL",nL[nL.READ_BUFFER=3074]="READ_BUFFER",nL[nL.UNPACK_ROW_LENGTH=3314]="UNPACK_ROW_LENGTH",nL[nL.UNPACK_SKIP_ROWS=3315]="UNPACK_SKIP_ROWS",nL[nL.UNPACK_SKIP_PIXELS=3316]="UNPACK_SKIP_PIXELS",nL[nL.PACK_ROW_LENGTH=3330]="PACK_ROW_LENGTH",nL[nL.PACK_SKIP_ROWS=3331]="PACK_SKIP_ROWS",nL[nL.PACK_SKIP_PIXELS=3332]="PACK_SKIP_PIXELS",nL[nL.TEXTURE_BINDING_3D=32874]="TEXTURE_BINDING_3D",nL[nL.UNPACK_SKIP_IMAGES=32877]="UNPACK_SKIP_IMAGES",nL[nL.UNPACK_IMAGE_HEIGHT=32878]="UNPACK_IMAGE_HEIGHT",nL[nL.MAX_3D_TEXTURE_SIZE=32883]="MAX_3D_TEXTURE_SIZE",nL[nL.MAX_ELEMENTS_VERTICES=33e3]="MAX_ELEMENTS_VERTICES",nL[nL.MAX_ELEMENTS_INDICES=33001]="MAX_ELEMENTS_INDICES",nL[nL.MAX_TEXTURE_LOD_BIAS=34045]="MAX_TEXTURE_LOD_BIAS",nL[nL.MAX_FRAGMENT_UNIFORM_COMPONENTS=35657]="MAX_FRAGMENT_UNIFORM_COMPONENTS",nL[nL.MAX_VERTEX_UNIFORM_COMPONENTS=35658]="MAX_VERTEX_UNIFORM_COMPONENTS",nL[nL.MAX_ARRAY_TEXTURE_LAYERS=35071]="MAX_ARRAY_TEXTURE_LAYERS",nL[nL.MIN_PROGRAM_TEXEL_OFFSET=35076]="MIN_PROGRAM_TEXEL_OFFSET",nL[nL.MAX_PROGRAM_TEXEL_OFFSET=35077]="MAX_PROGRAM_TEXEL_OFFSET",nL[nL.MAX_VARYING_COMPONENTS=35659]="MAX_VARYING_COMPONENTS",nL[nL.FRAGMENT_SHADER_DERIVATIVE_HINT=35723]="FRAGMENT_SHADER_DERIVATIVE_HINT",nL[nL.RASTERIZER_DISCARD=35977]="RASTERIZER_DISCARD",nL[nL.VERTEX_ARRAY_BINDING=34229]="VERTEX_ARRAY_BINDING",nL[nL.MAX_VERTEX_OUTPUT_COMPONENTS=37154]="MAX_VERTEX_OUTPUT_COMPONENTS",nL[nL.MAX_FRAGMENT_INPUT_COMPONENTS=37157]="MAX_FRAGMENT_INPUT_COMPONENTS",nL[nL.MAX_SERVER_WAIT_TIMEOUT=37137]="MAX_SERVER_WAIT_TIMEOUT",nL[nL.MAX_ELEMENT_INDEX=36203]="MAX_ELEMENT_INDEX",nL[nL.RED=6403]="RED",nL[nL.RGB8=32849]="RGB8",nL[nL.RGBA8=32856]="RGBA8",nL[nL.RGB10_A2=32857]="RGB10_A2",nL[nL.TEXTURE_3D=32879]="TEXTURE_3D",nL[nL.TEXTURE_WRAP_R=32882]="TEXTURE_WRAP_R",nL[nL.TEXTURE_MIN_LOD=33082]="TEXTURE_MIN_LOD",nL[nL.TEXTURE_MAX_LOD=33083]="TEXTURE_MAX_LOD",nL[nL.TEXTURE_BASE_LEVEL=33084]="TEXTURE_BASE_LEVEL",nL[nL.TEXTURE_MAX_LEVEL=33085]="TEXTURE_MAX_LEVEL",nL[nL.TEXTURE_COMPARE_MODE=34892]="TEXTURE_COMPARE_MODE",nL[nL.TEXTURE_COMPARE_FUNC=34893]="TEXTURE_COMPARE_FUNC",nL[nL.SRGB=35904]="SRGB",nL[nL.SRGB8=35905]="SRGB8",nL[nL.SRGB8_ALPHA8=35907]="SRGB8_ALPHA8",nL[nL.COMPARE_REF_TO_TEXTURE=34894]="COMPARE_REF_TO_TEXTURE",nL[nL.RGBA32F=34836]="RGBA32F",nL[nL.RGB32F=34837]="RGB32F",nL[nL.RGBA16F=34842]="RGBA16F",nL[nL.RGB16F=34843]="RGB16F",nL[nL.TEXTURE_2D_ARRAY=35866]="TEXTURE_2D_ARRAY",nL[nL.TEXTURE_BINDING_2D_ARRAY=35869]="TEXTURE_BINDING_2D_ARRAY",nL[nL.R11F_G11F_B10F=35898]="R11F_G11F_B10F",nL[nL.RGB9_E5=35901]="RGB9_E5",nL[nL.RGBA32UI=36208]="RGBA32UI",nL[nL.RGB32UI=36209]="RGB32UI",nL[nL.RGBA16UI=36214]="RGBA16UI",nL[nL.RGB16UI=36215]="RGB16UI",nL[nL.RGBA8UI=36220]="RGBA8UI",nL[nL.RGB8UI=36221]="RGB8UI",nL[nL.RGBA32I=36226]="RGBA32I",nL[nL.RGB32I=36227]="RGB32I",nL[nL.RGBA16I=36232]="RGBA16I",nL[nL.RGB16I=36233]="RGB16I",nL[nL.RGBA8I=36238]="RGBA8I",nL[nL.RGB8I=36239]="RGB8I",nL[nL.RED_INTEGER=36244]="RED_INTEGER",nL[nL.RGB_INTEGER=36248]="RGB_INTEGER",nL[nL.RGBA_INTEGER=36249]="RGBA_INTEGER",nL[nL.R8=33321]="R8",nL[nL.RG8=33323]="RG8",nL[nL.R16F=33325]="R16F",nL[nL.R32F=33326]="R32F",nL[nL.RG16F=33327]="RG16F",nL[nL.RG32F=33328]="RG32F",nL[nL.R8I=33329]="R8I",nL[nL.R8UI=33330]="R8UI",nL[nL.R16I=33331]="R16I",nL[nL.R16UI=33332]="R16UI",nL[nL.R32I=33333]="R32I",nL[nL.R32UI=33334]="R32UI",nL[nL.RG8I=33335]="RG8I",nL[nL.RG8UI=33336]="RG8UI",nL[nL.RG16I=33337]="RG16I",nL[nL.RG16UI=33338]="RG16UI",nL[nL.RG32I=33339]="RG32I",nL[nL.RG32UI=33340]="RG32UI",nL[nL.R8_SNORM=36756]="R8_SNORM",nL[nL.RG8_SNORM=36757]="RG8_SNORM",nL[nL.RGB8_SNORM=36758]="RGB8_SNORM",nL[nL.RGBA8_SNORM=36759]="RGBA8_SNORM",nL[nL.RGB10_A2UI=36975]="RGB10_A2UI",nL[nL.TEXTURE_IMMUTABLE_FORMAT=37167]="TEXTURE_IMMUTABLE_FORMAT",nL[nL.TEXTURE_IMMUTABLE_LEVELS=33503]="TEXTURE_IMMUTABLE_LEVELS",nL[nL.UNSIGNED_INT_2_10_10_10_REV=33640]="UNSIGNED_INT_2_10_10_10_REV",nL[nL.UNSIGNED_INT_10F_11F_11F_REV=35899]="UNSIGNED_INT_10F_11F_11F_REV",nL[nL.UNSIGNED_INT_5_9_9_9_REV=35902]="UNSIGNED_INT_5_9_9_9_REV",nL[nL.FLOAT_32_UNSIGNED_INT_24_8_REV=36269]="FLOAT_32_UNSIGNED_INT_24_8_REV",nL[nL.UNSIGNED_INT_24_8=34042]="UNSIGNED_INT_24_8",nL[nL.HALF_FLOAT=5131]="HALF_FLOAT",nL[nL.RG=33319]="RG",nL[nL.RG_INTEGER=33320]="RG_INTEGER",nL[nL.INT_2_10_10_10_REV=36255]="INT_2_10_10_10_REV",nL[nL.CURRENT_QUERY=34917]="CURRENT_QUERY",nL[nL.QUERY_RESULT=34918]="QUERY_RESULT",nL[nL.QUERY_RESULT_AVAILABLE=34919]="QUERY_RESULT_AVAILABLE",nL[nL.ANY_SAMPLES_PASSED=35887]="ANY_SAMPLES_PASSED",nL[nL.ANY_SAMPLES_PASSED_CONSERVATIVE=36202]="ANY_SAMPLES_PASSED_CONSERVATIVE",nL[nL.MAX_DRAW_BUFFERS=34852]="MAX_DRAW_BUFFERS",nL[nL.DRAW_BUFFER0=34853]="DRAW_BUFFER0",nL[nL.DRAW_BUFFER1=34854]="DRAW_BUFFER1",nL[nL.DRAW_BUFFER2=34855]="DRAW_BUFFER2",nL[nL.DRAW_BUFFER3=34856]="DRAW_BUFFER3",nL[nL.DRAW_BUFFER4=34857]="DRAW_BUFFER4",nL[nL.DRAW_BUFFER5=34858]="DRAW_BUFFER5",nL[nL.DRAW_BUFFER6=34859]="DRAW_BUFFER6",nL[nL.DRAW_BUFFER7=34860]="DRAW_BUFFER7",nL[nL.DRAW_BUFFER8=34861]="DRAW_BUFFER8",nL[nL.DRAW_BUFFER9=34862]="DRAW_BUFFER9",nL[nL.DRAW_BUFFER10=34863]="DRAW_BUFFER10",nL[nL.DRAW_BUFFER11=34864]="DRAW_BUFFER11",nL[nL.DRAW_BUFFER12=34865]="DRAW_BUFFER12",nL[nL.DRAW_BUFFER13=34866]="DRAW_BUFFER13",nL[nL.DRAW_BUFFER14=34867]="DRAW_BUFFER14",nL[nL.DRAW_BUFFER15=34868]="DRAW_BUFFER15",nL[nL.MAX_COLOR_ATTACHMENTS=36063]="MAX_COLOR_ATTACHMENTS",nL[nL.COLOR_ATTACHMENT1=36065]="COLOR_ATTACHMENT1",nL[nL.COLOR_ATTACHMENT2=36066]="COLOR_ATTACHMENT2",nL[nL.COLOR_ATTACHMENT3=36067]="COLOR_ATTACHMENT3",nL[nL.COLOR_ATTACHMENT4=36068]="COLOR_ATTACHMENT4",nL[nL.COLOR_ATTACHMENT5=36069]="COLOR_ATTACHMENT5",nL[nL.COLOR_ATTACHMENT6=36070]="COLOR_ATTACHMENT6",nL[nL.COLOR_ATTACHMENT7=36071]="COLOR_ATTACHMENT7",nL[nL.COLOR_ATTACHMENT8=36072]="COLOR_ATTACHMENT8",nL[nL.COLOR_ATTACHMENT9=36073]="COLOR_ATTACHMENT9",nL[nL.COLOR_ATTACHMENT10=36074]="COLOR_ATTACHMENT10",nL[nL.COLOR_ATTACHMENT11=36075]="COLOR_ATTACHMENT11",nL[nL.COLOR_ATTACHMENT12=36076]="COLOR_ATTACHMENT12",nL[nL.COLOR_ATTACHMENT13=36077]="COLOR_ATTACHMENT13",nL[nL.COLOR_ATTACHMENT14=36078]="COLOR_ATTACHMENT14",nL[nL.COLOR_ATTACHMENT15=36079]="COLOR_ATTACHMENT15",nL[nL.SAMPLER_3D=35679]="SAMPLER_3D",nL[nL.SAMPLER_2D_SHADOW=35682]="SAMPLER_2D_SHADOW",nL[nL.SAMPLER_2D_ARRAY=36289]="SAMPLER_2D_ARRAY",nL[nL.SAMPLER_2D_ARRAY_SHADOW=36292]="SAMPLER_2D_ARRAY_SHADOW",nL[nL.SAMPLER_CUBE_SHADOW=36293]="SAMPLER_CUBE_SHADOW",nL[nL.INT_SAMPLER_2D=36298]="INT_SAMPLER_2D",nL[nL.INT_SAMPLER_3D=36299]="INT_SAMPLER_3D",nL[nL.INT_SAMPLER_CUBE=36300]="INT_SAMPLER_CUBE",nL[nL.INT_SAMPLER_2D_ARRAY=36303]="INT_SAMPLER_2D_ARRAY",nL[nL.UNSIGNED_INT_SAMPLER_2D=36306]="UNSIGNED_INT_SAMPLER_2D",nL[nL.UNSIGNED_INT_SAMPLER_3D=36307]="UNSIGNED_INT_SAMPLER_3D",nL[nL.UNSIGNED_INT_SAMPLER_CUBE=36308]="UNSIGNED_INT_SAMPLER_CUBE",nL[nL.UNSIGNED_INT_SAMPLER_2D_ARRAY=36311]="UNSIGNED_INT_SAMPLER_2D_ARRAY",nL[nL.MAX_SAMPLES=36183]="MAX_SAMPLES",nL[nL.SAMPLER_BINDING=35097]="SAMPLER_BINDING",nL[nL.PIXEL_PACK_BUFFER=35051]="PIXEL_PACK_BUFFER",nL[nL.PIXEL_UNPACK_BUFFER=35052]="PIXEL_UNPACK_BUFFER",nL[nL.PIXEL_PACK_BUFFER_BINDING=35053]="PIXEL_PACK_BUFFER_BINDING",nL[nL.PIXEL_UNPACK_BUFFER_BINDING=35055]="PIXEL_UNPACK_BUFFER_BINDING",nL[nL.COPY_READ_BUFFER=36662]="COPY_READ_BUFFER",nL[nL.COPY_WRITE_BUFFER=36663]="COPY_WRITE_BUFFER",nL[nL.COPY_READ_BUFFER_BINDING=36662]="COPY_READ_BUFFER_BINDING",nL[nL.COPY_WRITE_BUFFER_BINDING=36663]="COPY_WRITE_BUFFER_BINDING",nL[nL.FLOAT_MAT2x3=35685]="FLOAT_MAT2x3",nL[nL.FLOAT_MAT2x4=35686]="FLOAT_MAT2x4",nL[nL.FLOAT_MAT3x2=35687]="FLOAT_MAT3x2",nL[nL.FLOAT_MAT3x4=35688]="FLOAT_MAT3x4",nL[nL.FLOAT_MAT4x2=35689]="FLOAT_MAT4x2",nL[nL.FLOAT_MAT4x3=35690]="FLOAT_MAT4x3",nL[nL.UNSIGNED_INT_VEC2=36294]="UNSIGNED_INT_VEC2",nL[nL.UNSIGNED_INT_VEC3=36295]="UNSIGNED_INT_VEC3",nL[nL.UNSIGNED_INT_VEC4=36296]="UNSIGNED_INT_VEC4",nL[nL.UNSIGNED_NORMALIZED=35863]="UNSIGNED_NORMALIZED",nL[nL.SIGNED_NORMALIZED=36764]="SIGNED_NORMALIZED",nL[nL.VERTEX_ATTRIB_ARRAY_INTEGER=35069]="VERTEX_ATTRIB_ARRAY_INTEGER",nL[nL.VERTEX_ATTRIB_ARRAY_DIVISOR=35070]="VERTEX_ATTRIB_ARRAY_DIVISOR",nL[nL.TRANSFORM_FEEDBACK_BUFFER_MODE=35967]="TRANSFORM_FEEDBACK_BUFFER_MODE",nL[nL.MAX_TRANSFORM_FEEDBACK_SEPARATE_COMPONENTS=35968]="MAX_TRANSFORM_FEEDBACK_SEPARATE_COMPONENTS",nL[nL.TRANSFORM_FEEDBACK_VARYINGS=35971]="TRANSFORM_FEEDBACK_VARYINGS",nL[nL.TRANSFORM_FEEDBACK_BUFFER_START=35972]="TRANSFORM_FEEDBACK_BUFFER_START",nL[nL.TRANSFORM_FEEDBACK_BUFFER_SIZE=35973]="TRANSFORM_FEEDBACK_BUFFER_SIZE",nL[nL.TRANSFORM_FEEDBACK_PRIMITIVES_WRITTEN=35976]="TRANSFORM_FEEDBACK_PRIMITIVES_WRITTEN",nL[nL.MAX_TRANSFORM_FEEDBACK_INTERLEAVED_COMPONENTS=35978]="MAX_TRANSFORM_FEEDBACK_INTERLEAVED_COMPONENTS",nL[nL.MAX_TRANSFORM_FEEDBACK_SEPARATE_ATTRIBS=35979]="MAX_TRANSFORM_FEEDBACK_SEPARATE_ATTRIBS",nL[nL.INTERLEAVED_ATTRIBS=35980]="INTERLEAVED_ATTRIBS",nL[nL.SEPARATE_ATTRIBS=35981]="SEPARATE_ATTRIBS",nL[nL.TRANSFORM_FEEDBACK_BUFFER=35982]="TRANSFORM_FEEDBACK_BUFFER",nL[nL.TRANSFORM_FEEDBACK_BUFFER_BINDING=35983]="TRANSFORM_FEEDBACK_BUFFER_BINDING",nL[nL.TRANSFORM_FEEDBACK=36386]="TRANSFORM_FEEDBACK",nL[nL.TRANSFORM_FEEDBACK_PAUSED=36387]="TRANSFORM_FEEDBACK_PAUSED",nL[nL.TRANSFORM_FEEDBACK_ACTIVE=36388]="TRANSFORM_FEEDBACK_ACTIVE",nL[nL.TRANSFORM_FEEDBACK_BINDING=36389]="TRANSFORM_FEEDBACK_BINDING",nL[nL.FRAMEBUFFER_ATTACHMENT_COLOR_ENCODING=33296]="FRAMEBUFFER_ATTACHMENT_COLOR_ENCODING",nL[nL.FRAMEBUFFER_ATTACHMENT_COMPONENT_TYPE=33297]="FRAMEBUFFER_ATTACHMENT_COMPONENT_TYPE",nL[nL.FRAMEBUFFER_ATTACHMENT_RED_SIZE=33298]="FRAMEBUFFER_ATTACHMENT_RED_SIZE",nL[nL.FRAMEBUFFER_ATTACHMENT_GREEN_SIZE=33299]="FRAMEBUFFER_ATTACHMENT_GREEN_SIZE",nL[nL.FRAMEBUFFER_ATTACHMENT_BLUE_SIZE=33300]="FRAMEBUFFER_ATTACHMENT_BLUE_SIZE",nL[nL.FRAMEBUFFER_ATTACHMENT_ALPHA_SIZE=33301]="FRAMEBUFFER_ATTACHMENT_ALPHA_SIZE",nL[nL.FRAMEBUFFER_ATTACHMENT_DEPTH_SIZE=33302]="FRAMEBUFFER_ATTACHMENT_DEPTH_SIZE",nL[nL.FRAMEBUFFER_ATTACHMENT_STENCIL_SIZE=33303]="FRAMEBUFFER_ATTACHMENT_STENCIL_SIZE",nL[nL.FRAMEBUFFER_DEFAULT=33304]="FRAMEBUFFER_DEFAULT",nL[nL.DEPTH24_STENCIL8=35056]="DEPTH24_STENCIL8",nL[nL.DRAW_FRAMEBUFFER_BINDING=36006]="DRAW_FRAMEBUFFER_BINDING",nL[nL.READ_FRAMEBUFFER_BINDING=36010]="READ_FRAMEBUFFER_BINDING",nL[nL.RENDERBUFFER_SAMPLES=36011]="RENDERBUFFER_SAMPLES",nL[nL.FRAMEBUFFER_ATTACHMENT_TEXTURE_LAYER=36052]="FRAMEBUFFER_ATTACHMENT_TEXTURE_LAYER",nL[nL.FRAMEBUFFER_INCOMPLETE_MULTISAMPLE=36182]="FRAMEBUFFER_INCOMPLETE_MULTISAMPLE",nL[nL.UNIFORM_BUFFER=35345]="UNIFORM_BUFFER",nL[nL.UNIFORM_BUFFER_BINDING=35368]="UNIFORM_BUFFER_BINDING",nL[nL.UNIFORM_BUFFER_START=35369]="UNIFORM_BUFFER_START",nL[nL.UNIFORM_BUFFER_SIZE=35370]="UNIFORM_BUFFER_SIZE",nL[nL.MAX_VERTEX_UNIFORM_BLOCKS=35371]="MAX_VERTEX_UNIFORM_BLOCKS",nL[nL.MAX_FRAGMENT_UNIFORM_BLOCKS=35373]="MAX_FRAGMENT_UNIFORM_BLOCKS",nL[nL.MAX_COMBINED_UNIFORM_BLOCKS=35374]="MAX_COMBINED_UNIFORM_BLOCKS",nL[nL.MAX_UNIFORM_BUFFER_BINDINGS=35375]="MAX_UNIFORM_BUFFER_BINDINGS",nL[nL.MAX_UNIFORM_BLOCK_SIZE=35376]="MAX_UNIFORM_BLOCK_SIZE",nL[nL.MAX_COMBINED_VERTEX_UNIFORM_COMPONENTS=35377]="MAX_COMBINED_VERTEX_UNIFORM_COMPONENTS",nL[nL.MAX_COMBINED_FRAGMENT_UNIFORM_COMPONENTS=35379]="MAX_COMBINED_FRAGMENT_UNIFORM_COMPONENTS",nL[nL.UNIFORM_BUFFER_OFFSET_ALIGNMENT=35380]="UNIFORM_BUFFER_OFFSET_ALIGNMENT",nL[nL.ACTIVE_UNIFORM_BLOCKS=35382]="ACTIVE_UNIFORM_BLOCKS",nL[nL.UNIFORM_TYPE=35383]="UNIFORM_TYPE",nL[nL.UNIFORM_SIZE=35384]="UNIFORM_SIZE",nL[nL.UNIFORM_BLOCK_INDEX=35386]="UNIFORM_BLOCK_INDEX",nL[nL.UNIFORM_OFFSET=35387]="UNIFORM_OFFSET",nL[nL.UNIFORM_ARRAY_STRIDE=35388]="UNIFORM_ARRAY_STRIDE",nL[nL.UNIFORM_MATRIX_STRIDE=35389]="UNIFORM_MATRIX_STRIDE",nL[nL.UNIFORM_IS_ROW_MAJOR=35390]="UNIFORM_IS_ROW_MAJOR",nL[nL.UNIFORM_BLOCK_BINDING=35391]="UNIFORM_BLOCK_BINDING",nL[nL.UNIFORM_BLOCK_DATA_SIZE=35392]="UNIFORM_BLOCK_DATA_SIZE",nL[nL.UNIFORM_BLOCK_ACTIVE_UNIFORMS=35394]="UNIFORM_BLOCK_ACTIVE_UNIFORMS",nL[nL.UNIFORM_BLOCK_ACTIVE_UNIFORM_INDICES=35395]="UNIFORM_BLOCK_ACTIVE_UNIFORM_INDICES",nL[nL.UNIFORM_BLOCK_REFERENCED_BY_VERTEX_SHADER=35396]="UNIFORM_BLOCK_REFERENCED_BY_VERTEX_SHADER",nL[nL.UNIFORM_BLOCK_REFERENCED_BY_FRAGMENT_SHADER=35398]="UNIFORM_BLOCK_REFERENCED_BY_FRAGMENT_SHADER",nL[nL.OBJECT_TYPE=37138]="OBJECT_TYPE",nL[nL.SYNC_CONDITION=37139]="SYNC_CONDITION",nL[nL.SYNC_STATUS=37140]="SYNC_STATUS",nL[nL.SYNC_FLAGS=37141]="SYNC_FLAGS",nL[nL.SYNC_FENCE=37142]="SYNC_FENCE",nL[nL.SYNC_GPU_COMMANDS_COMPLETE=37143]="SYNC_GPU_COMMANDS_COMPLETE",nL[nL.UNSIGNALED=37144]="UNSIGNALED",nL[nL.SIGNALED=37145]="SIGNALED",nL[nL.ALREADY_SIGNALED=37146]="ALREADY_SIGNALED",nL[nL.TIMEOUT_EXPIRED=37147]="TIMEOUT_EXPIRED",nL[nL.CONDITION_SATISFIED=37148]="CONDITION_SATISFIED",nL[nL.WAIT_FAILED=37149]="WAIT_FAILED",nL[nL.SYNC_FLUSH_COMMANDS_BIT=1]="SYNC_FLUSH_COMMANDS_BIT",nL[nL.COLOR=6144]="COLOR",nL[nL.DEPTH=6145]="DEPTH",nL[nL.STENCIL=6146]="STENCIL",nL[nL.MIN=32775]="MIN",nL[nL.MAX=32776]="MAX",nL[nL.DEPTH_COMPONENT24=33190]="DEPTH_COMPONENT24",nL[nL.STREAM_READ=35041]="STREAM_READ",nL[nL.STREAM_COPY=35042]="STREAM_COPY",nL[nL.STATIC_READ=35045]="STATIC_READ",nL[nL.STATIC_COPY=35046]="STATIC_COPY",nL[nL.DYNAMIC_READ=35049]="DYNAMIC_READ",nL[nL.DYNAMIC_COPY=35050]="DYNAMIC_COPY",nL[nL.DEPTH_COMPONENT32F=36012]="DEPTH_COMPONENT32F",nL[nL.DEPTH32F_STENCIL8=36013]="DEPTH32F_STENCIL8",nL[nL.INVALID_INDEX=4294967295]="INVALID_INDEX",nL[nL.TIMEOUT_IGNORED=-1]="TIMEOUT_IGNORED",nL[nL.MAX_CLIENT_WAIT_TIMEOUT_WEBGL=37447]="MAX_CLIENT_WAIT_TIMEOUT_WEBGL",nL[nL.UNMASKED_VENDOR_WEBGL=37445]="UNMASKED_VENDOR_WEBGL",nL[nL.UNMASKED_RENDERER_WEBGL=37446]="UNMASKED_RENDERER_WEBGL",nL[nL.MAX_TEXTURE_MAX_ANISOTROPY_EXT=34047]="MAX_TEXTURE_MAX_ANISOTROPY_EXT",nL[nL.TEXTURE_MAX_ANISOTROPY_EXT=34046]="TEXTURE_MAX_ANISOTROPY_EXT",nL[nL.R16_EXT=33322]="R16_EXT",nL[nL.RG16_EXT=33324]="RG16_EXT",nL[nL.RGB16_EXT=32852]="RGB16_EXT",nL[nL.RGBA16_EXT=32859]="RGBA16_EXT",nL[nL.R16_SNORM_EXT=36760]="R16_SNORM_EXT",nL[nL.RG16_SNORM_EXT=36761]="RG16_SNORM_EXT",nL[nL.RGB16_SNORM_EXT=36762]="RGB16_SNORM_EXT",nL[nL.RGBA16_SNORM_EXT=36763]="RGBA16_SNORM_EXT",nL[nL.COMPRESSED_RGB_S3TC_DXT1_EXT=33776]="COMPRESSED_RGB_S3TC_DXT1_EXT",nL[nL.COMPRESSED_RGBA_S3TC_DXT1_EXT=33777]="COMPRESSED_RGBA_S3TC_DXT1_EXT",nL[nL.COMPRESSED_RGBA_S3TC_DXT3_EXT=33778]="COMPRESSED_RGBA_S3TC_DXT3_EXT",nL[nL.COMPRESSED_RGBA_S3TC_DXT5_EXT=33779]="COMPRESSED_RGBA_S3TC_DXT5_EXT",nL[nL.COMPRESSED_SRGB_S3TC_DXT1_EXT=35916]="COMPRESSED_SRGB_S3TC_DXT1_EXT",nL[nL.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT=35917]="COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT",nL[nL.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT=35918]="COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT",nL[nL.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT=35919]="COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT",nL[nL.COMPRESSED_RED_RGTC1_EXT=36283]="COMPRESSED_RED_RGTC1_EXT",nL[nL.COMPRESSED_SIGNED_RED_RGTC1_EXT=36284]="COMPRESSED_SIGNED_RED_RGTC1_EXT",nL[nL.COMPRESSED_RED_GREEN_RGTC2_EXT=36285]="COMPRESSED_RED_GREEN_RGTC2_EXT",nL[nL.COMPRESSED_SIGNED_RED_GREEN_RGTC2_EXT=36286]="COMPRESSED_SIGNED_RED_GREEN_RGTC2_EXT",nL[nL.COMPRESSED_RGBA_BPTC_UNORM_EXT=36492]="COMPRESSED_RGBA_BPTC_UNORM_EXT",nL[nL.COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT=36493]="COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT",nL[nL.COMPRESSED_RGB_BPTC_SIGNED_FLOAT_EXT=36494]="COMPRESSED_RGB_BPTC_SIGNED_FLOAT_EXT",nL[nL.COMPRESSED_RGB_BPTC_UNSIGNED_FLOAT_EXT=36495]="COMPRESSED_RGB_BPTC_UNSIGNED_FLOAT_EXT",nL[nL.COMPRESSED_R11_EAC=37488]="COMPRESSED_R11_EAC",nL[nL.COMPRESSED_SIGNED_R11_EAC=37489]="COMPRESSED_SIGNED_R11_EAC",nL[nL.COMPRESSED_RG11_EAC=37490]="COMPRESSED_RG11_EAC",nL[nL.COMPRESSED_SIGNED_RG11_EAC=37491]="COMPRESSED_SIGNED_RG11_EAC",nL[nL.COMPRESSED_RGB8_ETC2=37492]="COMPRESSED_RGB8_ETC2",nL[nL.COMPRESSED_RGBA8_ETC2_EAC=37493]="COMPRESSED_RGBA8_ETC2_EAC",nL[nL.COMPRESSED_SRGB8_ETC2=37494]="COMPRESSED_SRGB8_ETC2",nL[nL.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC=37495]="COMPRESSED_SRGB8_ALPHA8_ETC2_EAC",nL[nL.COMPRESSED_RGB8_PUNCHTHROUGH_ALPHA1_ETC2=37496]="COMPRESSED_RGB8_PUNCHTHROUGH_ALPHA1_ETC2",nL[nL.COMPRESSED_SRGB8_PUNCHTHROUGH_ALPHA1_ETC2=37497]="COMPRESSED_SRGB8_PUNCHTHROUGH_ALPHA1_ETC2",nL[nL.COMPRESSED_RGB_PVRTC_4BPPV1_IMG=35840]="COMPRESSED_RGB_PVRTC_4BPPV1_IMG",nL[nL.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG=35842]="COMPRESSED_RGBA_PVRTC_4BPPV1_IMG",nL[nL.COMPRESSED_RGB_PVRTC_2BPPV1_IMG=35841]="COMPRESSED_RGB_PVRTC_2BPPV1_IMG",nL[nL.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG=35843]="COMPRESSED_RGBA_PVRTC_2BPPV1_IMG",nL[nL.COMPRESSED_RGB_ETC1_WEBGL=36196]="COMPRESSED_RGB_ETC1_WEBGL",nL[nL.COMPRESSED_RGB_ATC_WEBGL=35986]="COMPRESSED_RGB_ATC_WEBGL",nL[nL.COMPRESSED_RGBA_ATC_EXPLICIT_ALPHA_WEBGL=35986]="COMPRESSED_RGBA_ATC_EXPLICIT_ALPHA_WEBGL",nL[nL.COMPRESSED_RGBA_ATC_INTERPOLATED_ALPHA_WEBGL=34798]="COMPRESSED_RGBA_ATC_INTERPOLATED_ALPHA_WEBGL",nL[nL.COMPRESSED_RGBA_ASTC_4x4_KHR=37808]="COMPRESSED_RGBA_ASTC_4x4_KHR",nL[nL.COMPRESSED_RGBA_ASTC_5x4_KHR=37809]="COMPRESSED_RGBA_ASTC_5x4_KHR",nL[nL.COMPRESSED_RGBA_ASTC_5x5_KHR=37810]="COMPRESSED_RGBA_ASTC_5x5_KHR",nL[nL.COMPRESSED_RGBA_ASTC_6x5_KHR=37811]="COMPRESSED_RGBA_ASTC_6x5_KHR",nL[nL.COMPRESSED_RGBA_ASTC_6x6_KHR=37812]="COMPRESSED_RGBA_ASTC_6x6_KHR",nL[nL.COMPRESSED_RGBA_ASTC_8x5_KHR=37813]="COMPRESSED_RGBA_ASTC_8x5_KHR",nL[nL.COMPRESSED_RGBA_ASTC_8x6_KHR=37814]="COMPRESSED_RGBA_ASTC_8x6_KHR",nL[nL.COMPRESSED_RGBA_ASTC_8x8_KHR=37815]="COMPRESSED_RGBA_ASTC_8x8_KHR",nL[nL.COMPRESSED_RGBA_ASTC_10x5_KHR=37816]="COMPRESSED_RGBA_ASTC_10x5_KHR",nL[nL.COMPRESSED_RGBA_ASTC_10x6_KHR=37817]="COMPRESSED_RGBA_ASTC_10x6_KHR",nL[nL.COMPRESSED_RGBA_ASTC_10x8_KHR=37818]="COMPRESSED_RGBA_ASTC_10x8_KHR",nL[nL.COMPRESSED_RGBA_ASTC_10x10_KHR=37819]="COMPRESSED_RGBA_ASTC_10x10_KHR",nL[nL.COMPRESSED_RGBA_ASTC_12x10_KHR=37820]="COMPRESSED_RGBA_ASTC_12x10_KHR",nL[nL.COMPRESSED_RGBA_ASTC_12x12_KHR=37821]="COMPRESSED_RGBA_ASTC_12x12_KHR",nL[nL.COMPRESSED_SRGB8_ALPHA8_ASTC_4x4_KHR=37840]="COMPRESSED_SRGB8_ALPHA8_ASTC_4x4_KHR",nL[nL.COMPRESSED_SRGB8_ALPHA8_ASTC_5x4_KHR=37841]="COMPRESSED_SRGB8_ALPHA8_ASTC_5x4_KHR",nL[nL.COMPRESSED_SRGB8_ALPHA8_ASTC_5x5_KHR=37842]="COMPRESSED_SRGB8_ALPHA8_ASTC_5x5_KHR",nL[nL.COMPRESSED_SRGB8_ALPHA8_ASTC_6x5_KHR=37843]="COMPRESSED_SRGB8_ALPHA8_ASTC_6x5_KHR",nL[nL.COMPRESSED_SRGB8_ALPHA8_ASTC_6x6_KHR=37844]="COMPRESSED_SRGB8_ALPHA8_ASTC_6x6_KHR",nL[nL.COMPRESSED_SRGB8_ALPHA8_ASTC_8x5_KHR=37845]="COMPRESSED_SRGB8_ALPHA8_ASTC_8x5_KHR",nL[nL.COMPRESSED_SRGB8_ALPHA8_ASTC_8x6_KHR=37846]="COMPRESSED_SRGB8_ALPHA8_ASTC_8x6_KHR",nL[nL.COMPRESSED_SRGB8_ALPHA8_ASTC_8x8_KHR=37847]="COMPRESSED_SRGB8_ALPHA8_ASTC_8x8_KHR",nL[nL.COMPRESSED_SRGB8_ALPHA8_ASTC_10x5_KHR=37848]="COMPRESSED_SRGB8_ALPHA8_ASTC_10x5_KHR",nL[nL.COMPRESSED_SRGB8_ALPHA8_ASTC_10x6_KHR=37849]="COMPRESSED_SRGB8_ALPHA8_ASTC_10x6_KHR",nL[nL.COMPRESSED_SRGB8_ALPHA8_ASTC_10x8_KHR=37850]="COMPRESSED_SRGB8_ALPHA8_ASTC_10x8_KHR",nL[nL.COMPRESSED_SRGB8_ALPHA8_ASTC_10x10_KHR=37851]="COMPRESSED_SRGB8_ALPHA8_ASTC_10x10_KHR",nL[nL.COMPRESSED_SRGB8_ALPHA8_ASTC_12x10_KHR=37852]="COMPRESSED_SRGB8_ALPHA8_ASTC_12x10_KHR",nL[nL.COMPRESSED_SRGB8_ALPHA8_ASTC_12x12_KHR=37853]="COMPRESSED_SRGB8_ALPHA8_ASTC_12x12_KHR",nL[nL.QUERY_COUNTER_BITS_EXT=34916]="QUERY_COUNTER_BITS_EXT",nL[nL.CURRENT_QUERY_EXT=34917]="CURRENT_QUERY_EXT",nL[nL.QUERY_RESULT_EXT=34918]="QUERY_RESULT_EXT",nL[nL.QUERY_RESULT_AVAILABLE_EXT=34919]="QUERY_RESULT_AVAILABLE_EXT",nL[nL.TIME_ELAPSED_EXT=35007]="TIME_ELAPSED_EXT",nL[nL.TIMESTAMP_EXT=36392]="TIMESTAMP_EXT",nL[nL.GPU_DISJOINT_EXT=36795]="GPU_DISJOINT_EXT",nL[nL.COMPLETION_STATUS_KHR=37297]="COMPLETION_STATUS_KHR",nL[nL.DEPTH_CLAMP_EXT=34383]="DEPTH_CLAMP_EXT",nL[nL.FIRST_VERTEX_CONVENTION_WEBGL=36429]="FIRST_VERTEX_CONVENTION_WEBGL",nL[nL.LAST_VERTEX_CONVENTION_WEBGL=36430]="LAST_VERTEX_CONVENTION_WEBGL",nL[nL.PROVOKING_VERTEX_WEBL=36431]="PROVOKING_VERTEX_WEBL",nL[nL.POLYGON_MODE_WEBGL=2880]="POLYGON_MODE_WEBGL",nL[nL.POLYGON_OFFSET_LINE_WEBGL=10754]="POLYGON_OFFSET_LINE_WEBGL",nL[nL.LINE_WEBGL=6913]="LINE_WEBGL",nL[nL.FILL_WEBGL=6914]="FILL_WEBGL",nL[nL.MAX_CLIP_DISTANCES_WEBGL=3378]="MAX_CLIP_DISTANCES_WEBGL",nL[nL.MAX_CULL_DISTANCES_WEBGL=33529]="MAX_CULL_DISTANCES_WEBGL",nL[nL.MAX_COMBINED_CLIP_AND_CULL_DISTANCES_WEBGL=33530]="MAX_COMBINED_CLIP_AND_CULL_DISTANCES_WEBGL",nL[nL.CLIP_DISTANCE0_WEBGL=12288]="CLIP_DISTANCE0_WEBGL",nL[nL.CLIP_DISTANCE1_WEBGL=12289]="CLIP_DISTANCE1_WEBGL",nL[nL.CLIP_DISTANCE2_WEBGL=12290]="CLIP_DISTANCE2_WEBGL",nL[nL.CLIP_DISTANCE3_WEBGL=12291]="CLIP_DISTANCE3_WEBGL",nL[nL.CLIP_DISTANCE4_WEBGL=12292]="CLIP_DISTANCE4_WEBGL",nL[nL.CLIP_DISTANCE5_WEBGL=12293]="CLIP_DISTANCE5_WEBGL",nL[nL.CLIP_DISTANCE6_WEBGL=12294]="CLIP_DISTANCE6_WEBGL",nL[nL.CLIP_DISTANCE7_WEBGL=12295]="CLIP_DISTANCE7_WEBGL",nL[nL.POLYGON_OFFSET_CLAMP_EXT=36379]="POLYGON_OFFSET_CLAMP_EXT",nL[nL.LOWER_LEFT_EXT=36001]="LOWER_LEFT_EXT",nL[nL.UPPER_LEFT_EXT=36002]="UPPER_LEFT_EXT",nL[nL.NEGATIVE_ONE_TO_ONE_EXT=37726]="NEGATIVE_ONE_TO_ONE_EXT",nL[nL.ZERO_TO_ONE_EXT=37727]="ZERO_TO_ONE_EXT",nL[nL.CLIP_ORIGIN_EXT=37724]="CLIP_ORIGIN_EXT",nL[nL.CLIP_DEPTH_MODE_EXT=37725]="CLIP_DEPTH_MODE_EXT",nL[nL.SRC1_COLOR_WEBGL=35065]="SRC1_COLOR_WEBGL",nL[nL.SRC1_ALPHA_WEBGL=34185]="SRC1_ALPHA_WEBGL",nL[nL.ONE_MINUS_SRC1_COLOR_WEBGL=35066]="ONE_MINUS_SRC1_COLOR_WEBGL",nL[nL.ONE_MINUS_SRC1_ALPHA_WEBGL=35067]="ONE_MINUS_SRC1_ALPHA_WEBGL",nL[nL.MAX_DUAL_SOURCE_DRAW_BUFFERS_WEBGL=35068]="MAX_DUAL_SOURCE_DRAW_BUFFERS_WEBGL",nL[nL.MIRROR_CLAMP_TO_EDGE_EXT=34627]="MIRROR_CLAMP_TO_EDGE_EXT";const rL={3042:!1,32773:new Float32Array([0,0,0,0]),32777:32774,34877:32774,32969:1,32968:0,32971:1,32970:0,3106:new Float32Array([0,0,0,0]),3107:[!0,!0,!0,!0],2884:!1,2885:1029,2929:!1,2931:1,2932:513,2928:new Float32Array([0,1]),2930:!0,3024:!0,35725:null,36006:null,36007:null,34229:null,34964:null,2886:2305,33170:4352,2849:1,32823:!1,32824:0,10752:0,32926:!1,32928:!1,32938:1,32939:!1,3089:!1,3088:new Int32Array([0,0,1024,1024]),2960:!1,2961:0,2968:4294967295,36005:4294967295,2962:519,2967:0,2963:4294967295,34816:519,36003:0,36004:4294967295,2964:7680,2965:7680,2966:7680,34817:7680,34818:7680,34819:7680,2978:[0,0,1024,1024],36389:null,36662:null,36663:null,35053:null,35055:null,35723:4352,36010:null,35977:!1,3333:4,3317:4,37440:!1,37441:!1,37443:37444,3330:0,3332:0,3331:0,3314:0,32878:0,3316:0,3315:0,32877:0},oL=(e,t,n)=>t?e.enable(n):e.disable(n),iL=(e,t,n)=>e.hint(n,t),sL=(e,t,n)=>e.pixelStorei(n,t),aL=(e,t,n)=>{const r=36006===n?36009:36008;return e.bindFramebuffer(r,t)},lL=(e,t,n)=>{const r={34964:34962,36662:36662,36663:36663,35053:35051,35055:35052}[n];e.bindBuffer(r,t)};function cL(e){return Array.isArray(e)||ArrayBuffer.isView(e)&&!(e instanceof DataView)}const uL={3042:oL,32773:(e,t)=>e.blendColor(...t),32777:"blendEquation",34877:"blendEquation",32969:"blendFunc",32968:"blendFunc",32971:"blendFunc",32970:"blendFunc",3106:(e,t)=>e.clearColor(...t),3107:(e,t)=>e.colorMask(...t),2884:oL,2885:(e,t)=>e.cullFace(t),2929:oL,2931:(e,t)=>e.clearDepth(t),2932:(e,t)=>e.depthFunc(t),2928:(e,t)=>e.depthRange(...t),2930:(e,t)=>e.depthMask(t),3024:oL,35723:iL,35725:(e,t)=>e.useProgram(t),36007:(e,t)=>e.bindRenderbuffer(36161,t),36389:(e,t)=>e.bindTransformFeedback?.(36386,t),34229:(e,t)=>e.bindVertexArray(t),36006:aL,36010:aL,34964:lL,36662:lL,36663:lL,35053:lL,35055:lL,2886:(e,t)=>e.frontFace(t),33170:iL,2849:(e,t)=>e.lineWidth(t),32823:oL,32824:"polygonOffset",10752:"polygonOffset",35977:oL,32926:oL,32928:oL,32938:"sampleCoverage",32939:"sampleCoverage",3089:oL,3088:(e,t)=>e.scissor(...t),2960:oL,2961:(e,t)=>e.clearStencil(t),2968:(e,t)=>e.stencilMaskSeparate(1028,t),36005:(e,t)=>e.stencilMaskSeparate(1029,t),2962:"stencilFuncFront",2967:"stencilFuncFront",2963:"stencilFuncFront",34816:"stencilFuncBack",36003:"stencilFuncBack",36004:"stencilFuncBack",2964:"stencilOpFront",2965:"stencilOpFront",2966:"stencilOpFront",34817:"stencilOpBack",34818:"stencilOpBack",34819:"stencilOpBack",2978:(e,t)=>e.viewport(...t),34383:oL,10754:oL,12288:oL,12289:oL,12290:oL,12291:oL,12292:oL,12293:oL,12294:oL,12295:oL,3333:sL,3317:sL,37440:sL,37441:sL,37443:sL,3330:sL,3332:sL,3331:sL,3314:sL,32878:sL,3316:sL,3315:sL,32877:sL,framebuffer:(e,t)=>{const n=t&&"handle"in t?t.handle:t;return e.bindFramebuffer(36160,n)},blend:(e,t)=>t?e.enable(3042):e.disable(3042),blendColor:(e,t)=>e.blendColor(...t),blendEquation:(e,t)=>{const n="number"==typeof t?[t,t]:t;e.blendEquationSeparate(...n)},blendFunc:(e,t)=>{const n=2===t?.length?[...t,...t]:t;e.blendFuncSeparate(...n)},clearColor:(e,t)=>e.clearColor(...t),clearDepth:(e,t)=>e.clearDepth(t),clearStencil:(e,t)=>e.clearStencil(t),colorMask:(e,t)=>e.colorMask(...t),cull:(e,t)=>t?e.enable(2884):e.disable(2884),cullFace:(e,t)=>e.cullFace(t),depthTest:(e,t)=>t?e.enable(2929):e.disable(2929),depthFunc:(e,t)=>e.depthFunc(t),depthMask:(e,t)=>e.depthMask(t),depthRange:(e,t)=>e.depthRange(...t),dither:(e,t)=>t?e.enable(3024):e.disable(3024),derivativeHint:(e,t)=>{e.hint(35723,t)},frontFace:(e,t)=>e.frontFace(t),mipmapHint:(e,t)=>e.hint(33170,t),lineWidth:(e,t)=>e.lineWidth(t),polygonOffsetFill:(e,t)=>t?e.enable(32823):e.disable(32823),polygonOffset:(e,t)=>e.polygonOffset(...t),sampleCoverage:(e,t)=>e.sampleCoverage(t[0],t[1]||!1),scissorTest:(e,t)=>t?e.enable(3089):e.disable(3089),scissor:(e,t)=>e.scissor(...t),stencilTest:(e,t)=>t?e.enable(2960):e.disable(2960),stencilMask:(e,t)=>{t=cL(t)?t:[t,t];const[n,r]=t;e.stencilMaskSeparate(1028,n),e.stencilMaskSeparate(1029,r)},stencilFunc:(e,t)=>{t=cL(t)&&3===t.length?[...t,...t]:t;const[n,r,o,i,s,a]=t;e.stencilFuncSeparate(1028,n,r,o),e.stencilFuncSeparate(1029,i,s,a)},stencilOp:(e,t)=>{t=cL(t)&&3===t.length?[...t,...t]:t;const[n,r,o,i,s,a]=t;e.stencilOpSeparate(1028,n,r,o),e.stencilOpSeparate(1029,i,s,a)},viewport:(e,t)=>e.viewport(...t)};function dL(e,t,n){return void 0!==t[e]?t[e]:n[e]}const AL={blendEquation:(e,t,n)=>e.blendEquationSeparate(dL(32777,t,n),dL(34877,t,n)),blendFunc:(e,t,n)=>e.blendFuncSeparate(dL(32969,t,n),dL(32968,t,n),dL(32971,t,n),dL(32970,t,n)),polygonOffset:(e,t,n)=>e.polygonOffset(dL(32824,t,n),dL(10752,t,n)),sampleCoverage:(e,t,n)=>e.sampleCoverage(dL(32938,t,n),dL(32939,t,n)),stencilFuncFront:(e,t,n)=>e.stencilFuncSeparate(1028,dL(2962,t,n),dL(2967,t,n),dL(2963,t,n)),stencilFuncBack:(e,t,n)=>e.stencilFuncSeparate(1029,dL(34816,t,n),dL(36003,t,n),dL(36004,t,n)),stencilOpFront:(e,t,n)=>e.stencilOpSeparate(1028,dL(2964,t,n),dL(2965,t,n),dL(2966,t,n)),stencilOpBack:(e,t,n)=>e.stencilOpSeparate(1029,dL(34817,t,n),dL(34818,t,n),dL(34819,t,n))},hL={enable:(e,t)=>e({[t]:!0}),disable:(e,t)=>e({[t]:!1}),pixelStorei:(e,t,n)=>e({[t]:n}),hint:(e,t,n)=>e({[t]:n}),useProgram:(e,t)=>e({35725:t}),bindRenderbuffer:(e,t,n)=>e({36007:n}),bindTransformFeedback:(e,t,n)=>e({36389:n}),bindVertexArray:(e,t)=>e({34229:t}),bindFramebuffer:(e,t,n)=>{switch(t){case 36160:return e({36006:n,36010:n});case 36009:return e({36006:n});case 36008:return e({36010:n});default:return null}},bindBuffer:(e,t,n)=>{const r={34962:[34964],36662:[36662],36663:[36663],35051:[35053],35052:[35055]}[t];return r?e({[r]:n}):{valueChanged:!0}},blendColor:(e,t,n,r,o)=>e({32773:new Float32Array([t,n,r,o])}),blendEquation:(e,t)=>e({32777:t,34877:t}),blendEquationSeparate:(e,t,n)=>e({32777:t,34877:n}),blendFunc:(e,t,n)=>e({32969:t,32968:n,32971:t,32970:n}),blendFuncSeparate:(e,t,n,r,o)=>e({32969:t,32968:n,32971:r,32970:o}),clearColor:(e,t,n,r,o)=>e({3106:new Float32Array([t,n,r,o])}),clearDepth:(e,t)=>e({2931:t}),clearStencil:(e,t)=>e({2961:t}),colorMask:(e,t,n,r,o)=>e({3107:[t,n,r,o]}),cullFace:(e,t)=>e({2885:t}),depthFunc:(e,t)=>e({2932:t}),depthRange:(e,t,n)=>e({2928:new Float32Array([t,n])}),depthMask:(e,t)=>e({2930:t}),frontFace:(e,t)=>e({2886:t}),lineWidth:(e,t)=>e({2849:t}),polygonOffset:(e,t,n)=>e({32824:t,10752:n}),sampleCoverage:(e,t,n)=>e({32938:t,32939:n}),scissor:(e,t,n,r,o)=>e({3088:new Int32Array([t,n,r,o])}),stencilMask:(e,t)=>e({2968:t,36005:t}),stencilMaskSeparate:(e,t,n)=>e({[1028===t?2968:36005]:n}),stencilFunc:(e,t,n,r)=>e({2962:t,2967:n,2963:r,34816:t,36003:n,36004:r}),stencilFuncSeparate:(e,t,n,r,o)=>e({[1028===t?2962:34816]:n,[1028===t?2967:36003]:r,[1028===t?2963:36004]:o}),stencilOp:(e,t,n,r)=>e({2964:t,2965:n,2966:r,34817:t,34818:n,34819:r}),stencilOpSeparate:(e,t,n,r,o)=>e({[1028===t?2964:34817]:n,[1028===t?2965:34818]:r,[1028===t?2966:34819]:o}),viewport:(e,t,n,r,o)=>e({2978:[t,n,r,o]})},pL=(e,t)=>e.isEnabled(t),fL={3042:pL,2884:pL,2929:pL,3024:pL,32823:pL,32926:pL,32928:pL,3089:pL,2960:pL,35977:pL},gL=new Set([34016,36388,36387,35983,35368,34965,35739,35738,3074,34853,34854,34855,34856,34857,34858,34859,34860,34861,34862,34863,34864,34865,34866,34867,34868,35097,32873,35869,32874,34068]);function mL(e,t){if(function(e){for(const t in e)return!1;return!0}(t))return;const n={};for(const o in t){const r=Number(o),i=uL[o];i&&("string"==typeof i?n[i]=!0:i(e,t[o],r))}const r=e.state&&e.state.cache;if(r)for(const o in n){(0,AL[o])(e,t,r)}}function yL(e,t=rL){if("number"==typeof t){const n=t,r=fL[n];return r?r(e,n):e.getParameter(n)}const n=Array.isArray(t)?t:Object.keys(t),r={};for(const o of n){const t=fL[o];r[o]=t?t(e,Number(o)):e.getParameter(Number(o))}return r}function vL(e,t){if(e===t)return!0;const n=Array.isArray(e)||ArrayBuffer.isView(e),r=Array.isArray(t)||ArrayBuffer.isView(t);if(n&&r&&e.length===t.length){for(let n=0;n<e.length;++n)if(e[n]!==t[n])return!1;return!0}return!1}class bL{static get(e){return e.state}gl;program=null;stateStack=[];enable=!0;cache=null;log;initialized=!1;constructor(e,t){this.gl=e,this.log=t?.log||(()=>{}),this._updateCache=this._updateCache.bind(this),Object.seal(this)}push(e={}){this.stateStack.push({})}pop(){const e=this.stateStack[this.stateStack.length-1];mL(this.gl,e),this.stateStack.pop()}trackState(e,t){if(this.cache=t.copyState?yL(e):Object.assign({},rL),this.initialized)throw new Error("WebGLStateTracker");this.initialized=!0,this.gl.state=this,function(e){const t=e.useProgram.bind(e);e.useProgram=function(n){const r=bL.get(e);r.program!==n&&(t(n),r.program=n)}}(e);for(const n in hL){xL(e,n,hL[n])}wL(e,"getParameter"),wL(e,"isEnabled")}_updateCache(e){let t,n=!1;const r=this.stateStack.length>0?this.stateStack[this.stateStack.length-1]:null;for(const o in e){const i=e[o],s=this.cache[o];vL(i,s)||(n=!0,t=s,r&&!(o in r)&&(r[o]=s),this.cache[o]=i)}return{valueChanged:n,oldValue:t}}}function wL(e,t){const n=e[t].bind(e);e[t]=function(t){if(void 0===t||gL.has(t))return n(t);const r=bL.get(e);return t in r.cache||(r.cache[t]=n(t)),r.enable?r.cache[t]:n(t)},Object.defineProperty(e[t],"name",{value:`${t}-from-cache`,configurable:!1})}function xL(e,t,n){if(!e[t])return;const r=e[t].bind(e);e[t]=function(...t){const o=bL.get(e),{valueChanged:i,oldValue:s}=n(o._updateCache,...t);return i&&r(...t),s},Object.defineProperty(e[t],"name",{value:`${t}-to-cache`,configurable:!1})}function _L(e,t,n){return void 0===n[t]&&(n[t]=e.getExtension(t)||null),n[t]}function CL(e,t){const n=e.getParameter(7936),r=e.getParameter(7937);_L(e,"WEBGL_debug_renderer_info",t);const o=t.WEBGL_debug_renderer_info,i=e.getParameter(o?o.UNMASKED_VENDOR_WEBGL:7936)||n,s=e.getParameter(o?o.UNMASKED_RENDERER_WEBGL:7937)||r,a=e.getParameter(7938),l=SL(i,s),c=function(e,t){if(/Metal/i.exec(e)||/Metal/i.exec(t))return"metal";if(/ANGLE/i.exec(e)||/ANGLE/i.exec(t))return"opengl";return"unknown"}(i,s),u=function(e,t){if(/SwiftShader/i.exec(e)||/SwiftShader/i.exec(t))return"cpu";switch(SL(e,t)){case"intel":return"integrated";case"software":return"cpu";case"unknown":return"unknown";default:return"discrete"}}(i,s);return{type:"webgl",gpu:l,gpuType:u,gpuBackend:c,vendor:i,renderer:s,version:a,shadingLanguage:"glsl",shadingLanguageVersion:300}}function SL(e,t){return/NVIDIA/i.exec(e)||/NVIDIA/i.exec(t)?"nvidia":/INTEL/i.exec(e)||/INTEL/i.exec(t)?"intel":/Apple/i.exec(e)||/Apple/i.exec(t)?"apple":/AMD/i.exec(e)||/AMD/i.exec(t)||/ATI/i.exec(e)||/ATI/i.exec(t)?"amd":/SwiftShader/i.exec(e)||/SwiftShader/i.exec(t)?"software":"unknown"}function EL(e){switch(e){case"uint8":case"unorm8":return 5121;case"sint8":case"snorm8":return 5120;case"uint16":case"unorm16":return 5123;case"sint16":case"snorm16":return 5122;case"uint32":return 5125;case"sint32":return 5124;case"float16":return 5131;case"float32":return 5126}throw new Error(String(e))}const BL="WEBGL_compressed_texture_s3tc",IL="WEBGL_compressed_texture_s3tc_srgb",RL="EXT_texture_compression_rgtc",kL="EXT_texture_compression_bptc",TL="EXT_texture_norm16",PL="EXT_render_snorm",FL={"float32-renderable-webgl":["EXT_color_buffer_float"],"float16-renderable-webgl":["EXT_color_buffer_half_float"],"rgb9e5ufloat-renderable-webgl":["WEBGL_render_shared_exponent"],"snorm8-renderable-webgl":[PL],"norm16-renderable-webgl":[TL],"snorm16-renderable-webgl":[TL,PL],"float32-filterable":["OES_texture_float_linear"],"float16-filterable-webgl":["OES_texture_half_float_linear"],"texture-filterable-anisotropic-webgl":["EXT_texture_filter_anisotropic"],"texture-blend-float-webgl":["EXT_float_blend"],"texture-compression-bc":[BL,IL,RL,kL],"texture-compression-bc5-webgl":[RL],"texture-compression-bc7-webgl":[kL],"texture-compression-etc2":["WEBGL_compressed_texture_etc"],"texture-compression-astc":["WEBGL_compressed_texture_astc"],"texture-compression-etc1-webgl":["WEBGL_compressed_texture_etc1"],"texture-compression-pvrtc-webgl":["WEBGL_compressed_texture_pvrtc"],"texture-compression-atc-webgl":["WEBGL_compressed_texture_atc"]};const ML={r8unorm:{gl:33321,rb:!0},r8snorm:{gl:36756},r8uint:{gl:33330,rb:!0},r8sint:{gl:33329,rb:!0},rg8unorm:{gl:33323,rb:!0},rg8snorm:{gl:36757},rg8uint:{gl:33336,rb:!0},rg8sint:{gl:33335,rb:!0},r16uint:{gl:33332,rb:!0},r16sint:{gl:33331,rb:!0},r16float:{gl:33325,rb:!0},"r16unorm-webgl":{gl:33322,rb:!0},"r16snorm-webgl":{gl:36760},"rgba4unorm-webgl":{gl:32854,rb:!0},"rgb565unorm-webgl":{gl:36194,rb:!0},"rgb5a1unorm-webgl":{gl:32855,rb:!0},"rgb8unorm-webgl":{gl:32849},"rgb8snorm-webgl":{gl:36758},rgba8unorm:{gl:32856},"rgba8unorm-srgb":{gl:35907},rgba8snorm:{gl:36759},rgba8uint:{gl:36220},rgba8sint:{gl:36238},bgra8unorm:{},"bgra8unorm-srgb":{},rg16uint:{gl:33338},rg16sint:{gl:33337},rg16float:{gl:33327,rb:!0},"rg16unorm-webgl":{gl:33324},"rg16snorm-webgl":{gl:36761},r32uint:{gl:33334,rb:!0},r32sint:{gl:33333,rb:!0},r32float:{gl:33326},rgb9e5ufloat:{gl:35901},rg11b10ufloat:{gl:35898,rb:!0},rgb10a2unorm:{gl:32857,rb:!0},"rgb10a2uint-webgl":{gl:36975,rb:!0},"rgb16unorm-webgl":{gl:32852},"rgb16snorm-webgl":{gl:36762},rg32uint:{gl:33340,rb:!0},rg32sint:{gl:33339,rb:!0},rg32float:{gl:33328,rb:!0},rgba16uint:{gl:36214,rb:!0},rgba16sint:{gl:36232,rb:!0},rgba16float:{gl:34842},"rgba16unorm-webgl":{gl:32859,rb:!0},"rgba16snorm-webgl":{gl:36763},"rgb32float-webgl":{gl:34837,x:"EXT_color_buffer_float",dataFormat:6407,types:[5126]},rgba32uint:{gl:36208,rb:!0},rgba32sint:{gl:36226,rb:!0},rgba32float:{gl:34836,rb:!0},stencil8:{gl:36168,rb:!0},depth16unorm:{gl:33189,dataFormat:6402,types:[5123],rb:!0},depth24plus:{gl:33190,dataFormat:6402,types:[5125]},depth32float:{gl:36012,dataFormat:6402,types:[5126],rb:!0},"depth24plus-stencil8":{gl:35056,rb:!0,depthTexture:!0,dataFormat:34041,types:[34042]},"depth32float-stencil8":{gl:36013,dataFormat:34041,types:[36269],rb:!0},"bc1-rgb-unorm-webgl":{gl:33776,x:BL},"bc1-rgb-unorm-srgb-webgl":{gl:35916,x:IL},"bc1-rgba-unorm":{gl:33777,x:BL},"bc1-rgba-unorm-srgb":{gl:35916,x:IL},"bc2-rgba-unorm":{gl:33778,x:BL},"bc2-rgba-unorm-srgb":{gl:35918,x:IL},"bc3-rgba-unorm":{gl:33779,x:BL},"bc3-rgba-unorm-srgb":{gl:35919,x:IL},"bc4-r-unorm":{gl:36283,x:RL},"bc4-r-snorm":{gl:36284,x:RL},"bc5-rg-unorm":{gl:36285,x:RL},"bc5-rg-snorm":{gl:36286,x:RL},"bc6h-rgb-ufloat":{gl:36495,x:kL},"bc6h-rgb-float":{gl:36494,x:kL},"bc7-rgba-unorm":{gl:36492,x:kL},"bc7-rgba-unorm-srgb":{gl:36493,x:kL},"etc2-rgb8unorm":{gl:37492},"etc2-rgb8unorm-srgb":{gl:37494},"etc2-rgb8a1unorm":{gl:37496},"etc2-rgb8a1unorm-srgb":{gl:37497},"etc2-rgba8unorm":{gl:37493},"etc2-rgba8unorm-srgb":{gl:37495},"eac-r11unorm":{gl:37488},"eac-r11snorm":{gl:37489},"eac-rg11unorm":{gl:37490},"eac-rg11snorm":{gl:37491},"astc-4x4-unorm":{gl:37808},"astc-4x4-unorm-srgb":{gl:37840},"astc-5x4-unorm":{gl:37809},"astc-5x4-unorm-srgb":{gl:37841},"astc-5x5-unorm":{gl:37810},"astc-5x5-unorm-srgb":{gl:37842},"astc-6x5-unorm":{gl:37811},"astc-6x5-unorm-srgb":{gl:37843},"astc-6x6-unorm":{gl:37812},"astc-6x6-unorm-srgb":{gl:37844},"astc-8x5-unorm":{gl:37813},"astc-8x5-unorm-srgb":{gl:37845},"astc-8x6-unorm":{gl:37814},"astc-8x6-unorm-srgb":{gl:37846},"astc-8x8-unorm":{gl:37815},"astc-8x8-unorm-srgb":{gl:37847},"astc-10x5-unorm":{gl:37819},"astc-10x5-unorm-srgb":{gl:37851},"astc-10x6-unorm":{gl:37817},"astc-10x6-unorm-srgb":{gl:37849},"astc-10x8-unorm":{gl:37818},"astc-10x8-unorm-srgb":{gl:37850},"astc-10x10-unorm":{gl:37819},"astc-10x10-unorm-srgb":{gl:37851},"astc-12x10-unorm":{gl:37820},"astc-12x10-unorm-srgb":{gl:37852},"astc-12x12-unorm":{gl:37821},"astc-12x12-unorm-srgb":{gl:37853},"pvrtc-rgb4unorm-webgl":{gl:35840},"pvrtc-rgba4unorm-webgl":{gl:35842},"pvrtc-rbg2unorm-webgl":{gl:35841},"pvrtc-rgba2unorm-webgl":{gl:35843},"etc1-rbg-unorm-webgl":{gl:36196},"atc-rgb-unorm-webgl":{gl:35986},"atc-rgba-unorm-webgl":{gl:35986},"atc-rgbai-unorm-webgl":{gl:34798}};function LL(e){const t=ML[e],n=function(e){const t=ML[e],n=t?.gl;if(void 0===n)throw new Error(`Unsupported texture format ${e}`);return n}(e),r=SS(e);return{internalFormat:n,format:t?.dataFormat||UL(r.channels,r.integer,r.normalized,n),type:r.dataType?EL(r.dataType):t?.types?.[0]||5121,compressed:r.compressed||!1}}function UL(e,t,n,r){if(6408===r||6407===r)return r;switch(e){case"r":return t&&!n?36244:6403;case"rg":return t&&!n?33320:33319;case"rgb":return t&&!n?36248:6407;case"rgba":return t&&!n?36249:6408;case"bgra":throw new Error("bgra pixels not supported by WebGL");default:return 6408}}const OL={"depth-clip-control":"EXT_depth_clamp","timer-query-webgl":"EXT_disjoint_timer_query_webgl2","compilation-status-async-webgl":"KHR_parallel_shader_compile","polygon-mode-webgl":"WEBGL_polygon_mode","provoking-vertex-webgl":"WEBGL_provoking_vertex","shader-clip-cull-distance-webgl":"WEBGL_clip_cull_distance","shader-noperspective-interpolation-webgl":"NV_shader_noperspective_interpolation","shader-conservative-depth-webgl":"EXT_conservative_depth"};class DL extends BS{gl;extensions;testedFeatures=new Set;constructor(e,t,n){super([],n),this.gl=e,this.extensions=t,_L(e,"EXT_color_buffer_float",t)}*[Symbol.iterator](){const e=this.getFeatures();for(const t of e)this.has(t)&&(yield t);return[]}has(e){return!this.disabledFeatures?.[e]&&(this.testedFeatures.has(e)||(this.testedFeatures.add(e),function(e){return e in FL}(e)&&function(e,t,n){return(FL[t]||[]).every(t=>_L(e,t,n))}(this.gl,e,this.extensions)&&this.features.add(e),this.getWebGLFeature(e)&&this.features.add(e)),this.features.has(e))}initializeFeatures(){const e=this.getFeatures().filter(e=>"polygon-mode-webgl"!==e);for(const t of e)this.has(t)}getFeatures(){return[...Object.keys(OL),...Object.keys(FL)]}getWebGLFeature(e){const t=OL[e];return"string"==typeof t?Boolean(_L(this.gl,t,this.extensions)):Boolean(t)}}class NL extends ES{get maxTextureDimension1D(){return 0}get maxTextureDimension2D(){return this.getParameter(3379)}get maxTextureDimension3D(){return this.getParameter(32883)}get maxTextureArrayLayers(){return this.getParameter(35071)}get maxBindGroups(){return 0}get maxDynamicUniformBuffersPerPipelineLayout(){return 0}get maxDynamicStorageBuffersPerPipelineLayout(){return 0}get maxSampledTexturesPerShaderStage(){return this.getParameter(35660)}get maxSamplersPerShaderStage(){return this.getParameter(35661)}get maxStorageBuffersPerShaderStage(){return 0}get maxStorageTexturesPerShaderStage(){return 0}get maxUniformBuffersPerShaderStage(){return this.getParameter(35375)}get maxUniformBufferBindingSize(){return this.getParameter(35376)}get maxStorageBufferBindingSize(){return 0}get minUniformBufferOffsetAlignment(){return this.getParameter(35380)}get minStorageBufferOffsetAlignment(){return 0}get maxVertexBuffers(){return 16}get maxVertexAttributes(){return this.getParameter(34921)}get maxVertexBufferArrayStride(){return 2048}get maxInterStageShaderComponents(){return this.getParameter(35659)}get maxComputeWorkgroupStorageSize(){return 0}get maxComputeInvocationsPerWorkgroup(){return 0}get maxComputeWorkgroupSizeX(){return 0}get maxComputeWorkgroupSizeY(){return 0}get maxComputeWorkgroupSizeZ(){return 0}get maxComputeWorkgroupsPerDimension(){return 0}gl;limits={};constructor(e){super(),this.gl=e}getParameter(e){return void 0===this.limits[e]&&(this.limits[e]=this.gl.getParameter(e)),this.limits[e]||0}}class jL extends VS{device;gl;handle;colorAttachments=[];depthStencilAttachment=null;constructor(e,t){super(e,t);const n=null===t.handle;this.device=e,this.gl=e.gl,this.handle=this.props.handle||n?this.props.handle:this.gl.createFramebuffer(),n||(e.setSpectorMetadata(this.handle,{id:this.props.id,props:this.props}),this.autoCreateAttachmentTextures(),this.updateAttachments())}destroy(){super.destroy(),this.destroyed||null===this.handle||this.gl.deleteFramebuffer(this.handle)}updateAttachments(){const e=this.gl.bindFramebuffer(36160,this.handle);for(let t=0;t<this.colorAttachments.length;++t){const e=this.colorAttachments[t];if(e){const n=36064+t;this._attachTextureView(n,e)}}if(this.depthStencilAttachment){const e=function(e){switch(SS(e).attachment){case"depth":return 36096;case"stencil":return 36128;case"depth-stencil":return 33306;default:throw new Error(`Not a depth stencil format: ${e}`)}}(this.depthStencilAttachment.props.format);this._attachTextureView(e,this.depthStencilAttachment)}if(this.device.props.debug){const e=this.gl.checkFramebufferStatus(36160);if(36053!==e)throw new Error(`Framebuffer ${function(e){switch(e){case 36053:return"success";case 36054:return"Mismatched attachments";case 36055:return"No attachments";case 36057:return"Height/width mismatch";case 36061:return"Unsupported or split attachments";case 36182:return"Samples mismatch";default:return`${e}`}}(e)}`)}this.gl.bindFramebuffer(36160,e)}_attachTextureView(e,t){const{gl:n}=this.device,{texture:r}=t,o=t.props.baseMipLevel,i=t.props.baseArrayLayer;switch(n.bindTexture(r.glTarget,r.handle),r.glTarget){case 35866:case 32879:n.framebufferTextureLayer(36160,e,r.handle,o,i);break;case 34067:const t=function(e){return e<34069?e+34069:e}(i);n.framebufferTexture2D(36160,e,t,r.handle,o);break;case 3553:n.framebufferTexture2D(36160,e,3553,r.handle,o);break;default:throw new Error("Illegal texture type")}n.bindTexture(r.glTarget,null)}}class QL extends MS{device;format="rgba8unorm";depthStencilFormat="depth24plus";presentationSize;_framebuffer=null;get[Symbol.toStringTag](){return"WebGLCanvasContext"}constructor(e,t){super(t),this.device=e,this.presentationSize=[-1,-1],this._setAutoCreatedCanvasId(`${this.device.id}-canvas`),this.update()}getCurrentFramebuffer(){return this.update(),this._framebuffer=this._framebuffer||new jL(this.device,{handle:null}),this._framebuffer}update(){const e=this.getPixelSize();(e[0]!==this.presentationSize[0]||e[1]!==this.presentationSize[1])&&(this.presentationSize=e,this.resize())}resize(e){if(this.device.gl&&this.canvas){const t=this.getDevicePixelRatio(e?.useDevicePixels);return void this.setDevicePixelRatio(t,e)}}commit(){}}async function zL(e,t){const n=document.getElementsByTagName("head")[0];if(!n)throw new Error("loadScript");const r=document.createElement("script");return r.setAttribute("type","text/javascript"),r.setAttribute("src",e),new Promise((t,o)=>{r.onload=t,r.onerror=t=>o(new Error(`Unable to load script '${e}': ${t}`)),n.appendChild(r)})}let HL=null,GL=!1;const VL={debugSpectorJS:eS.get("debug-spectorjs"),debugSpectorJSUrl:"https://cdn.jsdelivr.net/npm/spectorjs@0.9.30/dist/spector.bundle.js",gl:void 0};function WL(e){return e.luma=e.luma||{},e.luma}function $L(e,t={}){return t.debugWebGL||t.traceWebGL?function(e,t){if(!globalThis.WebGLDebugUtils)return eS.warn("webgl-debug not loaded")(),e;const n=WL(e);if(n.debugContext)return n.debugContext;globalThis.WebGLDebugUtils.init({...tL,...e});const r=globalThis.WebGLDebugUtils.makeDebugContext(e,XL.bind(null,t),YL.bind(null,t));for(const s in tL)s in r||"number"!=typeof tL[s]||(r[s]=tL[s]);class o{}Object.setPrototypeOf(r,Object.getPrototypeOf(e)),Object.setPrototypeOf(o,r);const i=Object.create(o);return n.realContext=e,n.debugContext=i,i.debug=!0,i}(e,t):function(e){const t=WL(e);return t.realContext?t.realContext:e}(e)}function KL(e,t){t=Array.from(t).map(e=>void 0===e?"undefined":e);let n=globalThis.WebGLDebugUtils.glFunctionArgsToString(e,t);return n=`${n.slice(0,100)}${n.length>100?"...":""}`,`gl.${e}(${n})`}function XL(e,t,n,r){r=Array.from(r).map(e=>void 0===e?"undefined":e);const o=`${globalThis.WebGLDebugUtils.glEnumToString(t)} in gl.${n}(${globalThis.WebGLDebugUtils.glFunctionArgsToString(n,r)})`;eS.error(o)()}function YL(e,t,n){let r="";eS.level>=1&&(r=KL(t,n),e.traceWebGL&&eS.log(1,r)());for(const o of n)void 0===o&&(r=r||KL(t,n))}const qL={};function JL(e="id"){qL[e]=qL[e]||1;return`${e}-${qL[e]++}`}class ZL extends oS{device;gl;handle;glTarget;glUsage;glIndexType=5123;byteLength;bytesUsed;constructor(e,t={}){super(e,t),this.device=e,this.gl=this.device.gl;const n="object"==typeof t?t.handle:void 0;this.handle=n||this.gl.createBuffer(),e.setSpectorMetadata(this.handle,{...this.props,data:typeof this.props.data}),this.glTarget=function(e){if(e&oS.INDEX)return 34963;if(e&oS.VERTEX)return 34962;if(e&oS.UNIFORM)return 35345;return 34962}(this.props.usage),this.glUsage=function(e){if(e&oS.INDEX)return 35044;if(e&oS.VERTEX)return 35044;if(e&oS.UNIFORM)return 35048;return 35044}(this.props.usage),this.glIndexType="uint32"===this.props.indexType?5125:5123,t.data?this._initWithData(t.data,t.byteOffset,t.byteLength):this._initWithByteLength(t.byteLength||0)}_initWithData(e,t=0,n=e.byteLength+t){const r=this.glTarget;this.gl.bindBuffer(r,this.handle),this.gl.bufferData(r,n,this.glUsage),this.gl.bufferSubData(r,t,e),this.gl.bindBuffer(r,null),this.bytesUsed=n,this.byteLength=n,this._setDebugData(e,t,n),this.trackAllocatedMemory(n)}_initWithByteLength(e){let t=e;0===e&&(t=new Float32Array(0));const n=this.glTarget;return this.gl.bindBuffer(n,this.handle),this.gl.bufferData(n,t,this.glUsage),this.gl.bindBuffer(n,null),this.bytesUsed=e,this.byteLength=e,this._setDebugData(null,0,e),this.trackAllocatedMemory(e),this}destroy(){!this.destroyed&&this.handle&&(this.removeStats(),this.trackDeallocatedMemory(),this.gl.deleteBuffer(this.handle),this.destroyed=!0,this.handle=null)}write(e,t=0){const n=36663;this.gl.bindBuffer(n,this.handle),this.gl.bufferSubData(n,t,e),this.gl.bindBuffer(n,null),this._setDebugData(e,t,e.byteLength)}async readAsync(e=0,t){return this.readSyncWebGL(e,t)}readSyncWebGL(e=0,t){t=t??this.byteLength-e;const n=new Uint8Array(t);return this.gl.bindBuffer(36662,this.handle),this.gl.getBufferSubData(36662,e,n,0,t),this.gl.bindBuffer(36662,null),this._setDebugData(n,e,t),n}}function eU(e){const t=e.toLowerCase();return["warning","error","info"].includes(t)?t:"info"}class tU extends QS{device;handle;constructor(e,t){switch(super(e,t),this.device=e,this.props.stage){case"vertex":this.handle=this.props.handle||this.device.gl.createShader(35633);break;case"fragment":this.handle=this.props.handle||this.device.gl.createShader(35632);break;default:throw new Error(this.props.stage)}this._compile(this.source)}destroy(){this.handle&&(this.removeStats(),this.device.gl.deleteShader(this.handle),this.destroyed=!0)}get asyncCompilationStatus(){return this._waitForCompilationComplete().then(()=>this.compilationStatus)}async getCompilationInfo(){return await this._waitForCompilationComplete(),this.getCompilationInfoSync()}getCompilationInfoSync(){const e=this.device.gl.getShaderInfoLog(this.handle);return e?function(e){const t=e.split(/\r?\n/),n=[];for(const r of t){if(r.length<=1)continue;const e=r.split(":");if(2===e.length){const[t,r]=e;n.push({message:r.trim(),type:eU(t),lineNum:0,linePos:0});continue}const[t,o,i,...s]=e;let a=parseInt(i,10);isNaN(a)&&(a=0);let l=parseInt(o,10);isNaN(l)&&(l=0),n.push({message:s.join(":").trim(),type:eU(t),lineNum:a,linePos:l})}return n}(e):[]}getTranslatedSource(){const e=this.device.getExtension("WEBGL_debug_shaders").WEBGL_debug_shaders;return e?.getTranslatedShaderSource(this.handle)||null}async _compile(e){e=e.startsWith("#version ")?e:`#version 300 es\n${e}`;const{gl:t}=this.device;if(t.shaderSource(this.handle,e),t.compileShader(this.handle),this.device.props.debug){if(this.device.features.has("compilation-status-async-webgl"))eS.once(1,"Shader compilation is asynchronous")(),await this._waitForCompilationComplete(),eS.info(2,`Shader ${this.id} - async compilation complete: ${this.compilationStatus}`)(),this._getCompilationStatus(),this.debugShader();else if(this._getCompilationStatus(),this.debugShader(),"error"===this.compilationStatus)throw new Error(`GLSL compilation errors in ${this.props.stage} shader ${this.props.id}`)}else this.compilationStatus="pending"}async _waitForCompilationComplete(){const e=async e=>await new Promise(t=>setTimeout(t,e));if(!this.device.features.has("compilation-status-async-webgl"))return void(await e(10));const{gl:t}=this.device;for(;;){if(t.getShaderParameter(this.handle,37297))return;await e(10)}}_getCompilationStatus(){this.compilationStatus=this.device.gl.getShaderParameter(this.handle,35713)?"success":"error"}}function nU(e,t,n,r){if(function(e){let t=!0;for(const n in e){t=!1;break}return t}(t))return r(e);const o=e;o.pushState();try{return function(e,t){const n=e,{gl:r}=n;if(t.cullMode)switch(t.cullMode){case"none":r.disable(2884);break;case"front":r.enable(2884),r.cullFace(1028);break;case"back":r.enable(2884),r.cullFace(1029)}t.frontFace&&r.frontFace(aU("frontFace",t.frontFace,{ccw:2305,cw:2304}));t.unclippedDepth&&e.features.has("depth-clip-control")&&r.enable(34383);void 0!==t.depthBias&&(r.enable(32823),r.polygonOffset(t.depthBias,t.depthBiasSlopeScale||0));if(t.provokingVertex&&e.features.has("provoking-vertex-webgl")){const e=n.getExtension("WEBGL_provoking_vertex").WEBGL_provoking_vertex,r=aU("provokingVertex",t.provokingVertex,{first:36429,last:36430});e?.provokingVertexWEBGL(r)}if((t.polygonMode||t.polygonOffsetLine)&&e.features.has("polygon-mode-webgl")){if(t.polygonMode){const e=n.getExtension("WEBGL_polygon_mode").WEBGL_polygon_mode,r=aU("polygonMode",t.polygonMode,{fill:6914,line:6913});e?.polygonModeWEBGL(1028,r),e?.polygonModeWEBGL(1029,r)}t.polygonOffsetLine&&r.enable(10754)}e.features.has("shader-clip-cull-distance-webgl")&&(t.clipDistance0&&r.enable(12288),t.clipDistance1&&r.enable(12289),t.clipDistance2&&r.enable(12290),t.clipDistance3&&r.enable(12291),t.clipDistance4&&r.enable(12292),t.clipDistance5&&r.enable(12293),t.clipDistance6&&r.enable(12294),t.clipDistance7&&r.enable(12295));void 0!==t.depthWriteEnabled&&r.depthMask(t.depthWriteEnabled);t.depthCompare&&("always"!==t.depthCompare?r.enable(2929):r.disable(2929),r.depthFunc(rU("depthCompare",t.depthCompare)));if(t.stencilWriteMask){const e=t.stencilWriteMask;r.stencilMaskSeparate(1028,e),r.stencilMaskSeparate(1029,e)}t.stencilReadMask&&eS.warn("stencilReadMask not supported under WebGL");if(t.stencilCompare){const e=t.stencilReadMask||4294967295,n=rU("depthCompare",t.stencilCompare);"always"!==t.stencilCompare?r.enable(2960):r.disable(2960),r.stencilFuncSeparate(1028,n,0,e),r.stencilFuncSeparate(1029,n,0,e)}if(t.stencilPassOperation&&t.stencilFailOperation&&t.stencilDepthFailOperation){const e=oU("stencilPassOperation",t.stencilPassOperation),n=oU("stencilFailOperation",t.stencilFailOperation),o=oU("stencilDepthFailOperation",t.stencilDepthFailOperation);r.stencilOpSeparate(1028,n,o,e),r.stencilOpSeparate(1029,n,o,e)}switch(t.blend){case!0:r.enable(3042);break;case!1:r.disable(3042)}if(t.blendColorOperation||t.blendAlphaOperation){const e=iU("blendColorOperation",t.blendColorOperation||"add"),n=iU("blendAlphaOperation",t.blendAlphaOperation||"add");r.blendEquationSeparate(e,n);const o=sU("blendColorSrcFactor",t.blendColorSrcFactor||"one"),i=sU("blendColorDstFactor",t.blendColorDstFactor||"zero"),s=sU("blendAlphaSrcFactor",t.blendAlphaSrcFactor||"one"),a=sU("blendAlphaDstFactor",t.blendAlphaDstFactor||"zero");r.blendFuncSeparate(o,i,s,a)}}(e,t),mL(o.gl,n),r(e)}finally{o.popState()}}function rU(e,t){return aU(e,t,{never:512,less:513,equal:514,"less-equal":515,greater:516,"not-equal":517,"greater-equal":518,always:519})}function oU(e,t){return aU(e,t,{keep:7680,zero:0,replace:7681,invert:5386,"increment-clamp":7682,"decrement-clamp":7683,"increment-wrap":34055,"decrement-wrap":34056})}function iU(e,t){return aU(e,t,{add:32774,subtract:32778,"reverse-subtract":32779,min:32775,max:32776})}function sU(e,t){return aU(e,t,{one:1,zero:0,"src-color":768,"one-minus-src-color":769,"dst-color":774,"one-minus-dst-color":775,"src-alpha":770,"one-minus-src-alpha":771,"dst-alpha":772,"one-minus-dst-alpha":773,"src-alpha-saturated":776,"constant-color":32769,"one-minus-constant-color":32770,"constant-alpha":32771,"one-minus-constant-alpha":32772})}function aU(e,t,n){if(!(t in n))throw new Error(function(e,t){return`Illegal parameter ${t} for ${e}`}(e,t));return n[t]}function lU(e){const t={};return e.addressModeU&&(t[10242]=cU(e.addressModeU)),e.addressModeV&&(t[10243]=cU(e.addressModeV)),e.addressModeW&&(t[32882]=cU(e.addressModeW)),e.magFilter&&(t[10240]=uU(e.magFilter)),(e.minFilter||e.mipmapFilter)&&(t[10241]=function(e,t="none"){if(!t)return uU(e);switch(t){case"none":return uU(e);case"nearest":return"nearest"===e?9984:9986;case"linear":return"nearest"===e?9985:9987}}(e.minFilter||"linear",e.mipmapFilter)),void 0!==e.lodMinClamp&&(t[33082]=e.lodMinClamp),void 0!==e.lodMaxClamp&&(t[33083]=e.lodMaxClamp),"comparison-sampler"===e.type&&(t[34892]=34894),e.compare&&(t[34893]=rU("compare",e.compare)),e.maxAnisotropy&&(t[34046]=e.maxAnisotropy),t}function cU(e){switch(e){case"clamp-to-edge":return 33071;case"repeat":return 10497;case"mirror-repeat":return 33648}}function uU(e){switch(e){case"nearest":return 9728;case"linear":return 9729}}class dU extends GS{device;handle;parameters;constructor(e,t){super(e,t),this.device=e,this.parameters=lU(t),this.handle=this.handle||this.device.gl.createSampler(),this._setSamplerParameters(this.parameters)}destroy(){this.handle&&(this.device.gl.deleteSampler(this.handle),this.handle=void 0)}toString(){return`Sampler(${this.id},${JSON.stringify(this.props)})`}_setSamplerParameters(e){for(const[t,n]of Object.entries(e)){const e=Number(t);switch(e){case 33082:case 33083:this.device.gl.samplerParameterf(this.handle,e,n);break;default:this.device.gl.samplerParameteri(this.handle,e,n)}}}}class AU extends DS{device;gl;handle;texture;constructor(e,t){super(e,{...OS.defaultProps,...t}),this.device=e,this.gl=this.device.gl,this.handle=null,this.texture=t.texture}}function hU(e){switch(e){case 6406:case 33326:case 6403:case 36244:return 1;case 33339:case 33340:case 33328:case 33320:case 33319:return 2;case 6407:case 36248:case 34837:return 3;case 6408:case 36249:case 34836:return 4;default:return 0}}function pU(e,t,n){if(function(e){for(const t in e)return!1;return!0}(t))return n(e);const{nocatch:r=!0}=t,o=bL.get(e);let i;if(o.push(),mL(e,t),r)i=n(e),o.pop();else try{i=n(e)}finally{o.pop()}return i}function fU(e,t,n,r){const{width:o,height:i}=r,{dimension:s,depth:a=0,mipLevel:l=0}=r,{x:c=0,y:u=0,z:d=0}=r,{glFormat:A,glType:h}=r,p=mU(r.glTarget,s,a),f=r.flipY?{37440:!0}:{};pU(e,f,()=>{switch(s){case"2d-array":case"3d":e.bindTexture(p,t),e.texSubImage3D(p,l,c,u,d,o,i,a,A,h,n),e.bindTexture(p,null);break;case"2d":case"cube":e.bindTexture(p,t),e.texSubImage2D(p,l,c,u,o,i,A,h,n),e.bindTexture(p,null);break;default:throw new Error(s)}})}function gU(e,t,n){const{dimension:r,width:o,height:i,depth:s=0,mipLevel:a=0,byteOffset:l=0}=n,{x:c=0,y:u=0,z:d=0}=n,{glFormat:A,glType:h,compressed:p}=n,f=mU(n.glTarget,r,s);switch(r){case"2d-array":case"3d":p?e.compressedTexSubImage3D(f,a,c,u,d,o,i,s,A,t,l):e.texSubImage3D(f,a,c,u,d,o,i,s,A,h,t,l);break;case"2d":case"cube":p?e.compressedTexSubImage2D(f,a,c,u,o,i,A,t,l):e.texSubImage2D(f,a,c,u,o,i,A,h,t,l);break;default:throw new Error(r)}}function mU(e,t,n){return"cube"===t?34069+n:e}function yU(e,t){const{sourceX:n=0,sourceY:r=0,sourceAttachment:o=0}=t||{};let{target:i=null,sourceWidth:s,sourceHeight:a,sourceDepth:l,sourceFormat:c,sourceType:u}=t||{};const{framebuffer:d,deleteFramebuffer:A}=vU(e),{gl:h,handle:p}=d;s||=d.width,a||=d.height;const f=d.colorAttachments[o]?.texture;if(!f)throw new Error(`Invalid framebuffer attachment ${o}`);l=f?.depth||1,c||=f?.glFormat||6408,u||=f?.glType||5121,i=function(e,t,n,r,o){if(e)return e;t||=5121;const i=function(e,t){const{clamped:n=!0}=t||{};switch(e){case 5126:return Float32Array;case 5123:case 33635:case 32819:case 32820:return Uint16Array;case 5125:return Uint32Array;case 5121:return n?Uint8ClampedArray:Uint8Array;case 5120:return Int8Array;case 5122:return Int16Array;case 5124:return Int32Array;default:throw new Error("Failed to deduce typed array type from GL constant")}}(t,{clamped:!1}),s=hU(n);return new i(r*o*s)}(i,u,c,s,a),u=u||function(e){switch(ArrayBuffer.isView(e)?e.constructor:e){case Float32Array:return 5126;case Uint16Array:return 5123;case Uint32Array:return 5125;case Uint8Array:case Uint8ClampedArray:return 5121;case Int8Array:return 5120;case Int16Array:return 5122;case Int32Array:return 5124;default:throw new Error("Failed to deduce GL constant from typed array")}}(i);const g=h.bindFramebuffer(36160,p);return h.readBuffer(36064+o),h.readPixels(n,r,s,a,c,u,i),h.readBuffer(36064),h.bindFramebuffer(36160,g||null),A&&d.destroy(),i}function vU(e){return e instanceof VS?{framebuffer:e,deleteFramebuffer:!1}:{framebuffer:bU(e),deleteFramebuffer:!0}}function bU(e,t){const{device:n,width:r,height:o,id:i}=e;return n.createFramebuffer({...t,id:`framebuffer-for-${i}`,width:r,height:o,colorAttachments:[e]})}class wU extends OS{device;gl;handle;sampler=void 0;view=void 0;mipmaps;compressed;glTarget;glFormat;glType;glInternalFormat;textureUnit=0;constructor(e,t){super(e,t);const n={...this.props};n.data=t.data,this.device=e,this.gl=this.device.gl,this.glTarget=function(e){switch(e){case"1d":break;case"2d":return 3553;case"3d":return 32879;case"cube":return 34067;case"2d-array":return 35866}throw new Error(e)}(this.props.dimension);const r=LL(this.props.format);this.glInternalFormat=r.internalFormat,this.glFormat=r.format,this.glType=r.type,this.compressed=r.compressed,this.mipmaps=Boolean(this.props.mipmaps),this._initialize(n),Object.seal(this)}_initialize(e){this.handle=this.props.handle||this.gl.createTexture(),this.device.setSpectorMetadata(this.handle,{...this.props,data:e.data});let{width:t,height:n}=e;if(!t||!n){const r=OS.getTextureDataSize(e.data);t=r?.width||1,n=r?.height||1}if(this.width=t,this.height=n,this.depth=e.depth,this.setSampler(e.sampler),this.view=new AU(this.device,{...this.props,texture:this}),this.bind(),function(e,t,n){const{dimension:r,width:o,height:i,depth:s=0}=n,{glInternalFormat:a}=n,l=n.glTarget;switch(r){case"2d-array":case"3d":e.texStorage3D(l,t,a,o,i,s);break;default:e.texStorage2D(l,t,a,o,i)}}(this.gl,this.mipLevels,this),e.data)switch(e.dimension){case"1d":this.setTexture1DData(e.data);break;case"2d":this.setTexture2DData(e.data);break;case"3d":this.setTexture3DData(e.data);break;case"cube":this.setTextureCubeData(e.data);break;case"2d-array":this.setTextureArrayData(e.data);break;case"cube-array":this.setTextureCubeArrayData(e.data);break;default:throw new Error(e.dimension)}this.mipmaps&&this.generateMipmap()}destroy(){this.handle&&(this.gl.deleteTexture(this.handle),this.removeStats(),this.trackDeallocatedMemory("Texture"),this.destroyed=!0)}createView(e){return new AU(this.device,{...e,texture:this})}setSampler(e={}){let t;e instanceof dU?(this.sampler=e,t=e.props):(this.sampler=new dU(this.device,e),t=e);const n=lU(t);this._setSamplerParameters(n)}generateMipmap(e){if(this.device.isTextureFormatRenderable(this.props.format)&&this.device.isTextureFormatFilterable(this.props.format)||(eS.warn(`${this} is not renderable or filterable, may not be able to generate mipmaps`)(),e?.force))try{this.gl.bindTexture(this.glTarget,this.handle),this.gl.generateMipmap(this.glTarget)}catch(t){eS.warn(`Error generating mipmap for ${this}: ${t.message}`)()}finally{this.gl.bindTexture(this.glTarget,null)}}copyExternalImage(e){const t=OS.getExternalImageSize(e.image),n={...OS.defaultCopyExternalImageOptions,...t,...e},{image:r,depth:o,mipLevel:i,x:s,y:a,z:l,flipY:c}=n;let{width:u,height:d}=n;const{dimension:A,glTarget:h,glFormat:p,glInternalFormat:f,glType:g}=this;if(u=Math.min(u,this.width-s),d=Math.min(d,this.height-a),e.sourceX||e.sourceY)throw new Error("WebGL does not support sourceX/sourceY)");return fU(this.device.gl,this.handle,r,{dimension:A,mipLevel:i,x:s,y:a,z:l,width:u,height:d,depth:o,glFormat:p,glType:g,glTarget:h,flipY:c}),{width:n.width,height:n.height}}setTexture1DData(e){throw new Error("setTexture1DData not supported in WebGL.")}setTexture2DData(e,t=0){this.bind();const n=OS.normalizeTextureData(e,this);n.length>1&&!1!==this.props.mipmaps&&eS.warn(`Texture ${this.id} mipmap and multiple LODs.`)();for(let r=0;r<n.length;r++){const e=n[r];this._setMipLevel(t,r,e)}this.unbind()}setTexture3DData(e){if("3d"!==this.props.dimension)throw new Error(this.id);ArrayBuffer.isView(e)&&(this.bind(),gU(this.device.gl,e,this),this.unbind())}setTextureCubeData(e,t=0){if("cube"!==this.props.dimension)throw new Error(this.id);for(const n of OS.CubeFaces)this.setTextureCubeFaceData(e[n],n)}setTextureArrayData(e){if("2d-array"!==this.props.dimension)throw new Error(this.id);throw new Error("setTextureArrayData not implemented.")}setTextureCubeArrayData(e){throw new Error("setTextureCubeArrayData not supported in WebGL2.")}setTextureCubeFaceData(e,t,n=0){Array.isArray(e)&&e.length>1&&!1!==this.props.mipmaps&&eS.warn(`${this.id} has mipmap and multiple LODs.`)();const r=OS.CubeFaces.indexOf(t);this.setTexture2DData(e,r)}update(){throw new Error("Texture.update() not implemented. Use ExternalTexture")}setImageDataForFace(e){const{face:t,width:n,height:r,pixels:o,data:i,format:s=6408,type:a=5121}=e,{gl:l}=this,c=o||i;this.bind(),c instanceof Promise?c.then(n=>this.setImageDataForFace(Object.assign({},e,{face:t,data:n,pixels:n}))):this.width||this.height?l.texImage2D(t,0,s,n,r,0,s,a,c):l.texImage2D(t,0,s,s,a,c)}_getImageDataMap(e){for(let t=0;t<OS.CubeFaces.length;++t){const n=OS.CubeFaces[t];e[n]&&(e[34069+t]=e[n],delete e[n])}return e}_setSamplerParameters(e){eS.log(1,`${this.id} sampler parameters`,this.device.getGLKeys(e))(),this.gl.bindTexture(this.glTarget,this.handle);for(const[t,n]of Object.entries(e)){const e=Number(t),r=n;switch(e){case 33082:case 33083:this.gl.texParameterf(this.glTarget,e,r);break;case 10241:case 10242:case 10243:default:this.gl.texParameteri(this.glTarget,e,r);break;case 34046:this.device.features.has("texture-filterable-anisotropic-webgl")&&this.gl.texParameteri(this.glTarget,e,r)}}this.gl.bindTexture(this.glTarget,null)}_setMipLevel(e,t,n,r=this.glTarget){if(OS.isExternalImage(n))fU(this.device.gl,this.handle,n,{...this,depth:e,mipLevel:t,glTarget:r,flipY:this.props.flipY});else{if(!OS.isTextureLevelData(n))throw new Error("Texture: invalid image data");gU(this.device.gl,n.data,{...this,depth:e,mipLevel:t,glTarget:r})}}getActiveUnit(){return this.gl.getParameter(34016)-33984}bind(e){const{gl:t}=this;return void 0!==e&&(this.textureUnit=e,t.activeTexture(33984+e)),t.bindTexture(this.glTarget,this.handle),e}unbind(e){const{gl:t}=this;return void 0!==e&&(this.textureUnit=e,t.activeTexture(33984+e)),t.bindTexture(this.glTarget,null),e}}const xU=[1,2,4,8];class _U extends $S{device;glParameters;constructor(e,t){let n;if(super(e,t),this.device=e,!t?.parameters?.viewport)if(t?.framebuffer){const{width:e,height:r}=t.framebuffer;n=[0,0,e,r]}else{const[t,r]=e.getCanvasContext().getDrawingBufferSize();n=[0,0,t,r]}this.device.pushState(),this.setParameters({viewport:n,...this.props.parameters});const r=this.props.framebuffer;if(r?.handle)if(this.props.framebuffer){const e=this.props.framebuffer.colorAttachments.map((e,t)=>36064+t);this.device.gl.drawBuffers(e)}else this.device.gl.drawBuffers([1029]);this.clear()}end(){this.device.popState()}pushDebugGroup(e){}popDebugGroup(){}insertDebugMarker(e){}setParameters(e={}){const t={...this.glParameters};t.framebuffer=this.props.framebuffer||null,this.props.depthReadOnly&&(t.depthMask=!this.props.depthReadOnly),t.stencilMask=this.props.stencilReadOnly?0:1,t[35977]=this.props.discard,e.viewport&&(e.viewport.length>=6?(t.viewport=e.viewport.slice(0,4),t.depthRange=[e.viewport[4],e.viewport[5]]):t.viewport=e.viewport),e.scissorRect&&(t.scissorTest=!0,t.scissor=e.scissorRect),e.blendConstant&&(t.blendColor=e.blendConstant),e.stencilReference&&(e[2967]=e.stencilReference),e.colorMask&&(t.colorMask=xU.map(t=>Boolean(t&e.colorMask))),this.glParameters=t,mL(this.device.gl,t)}beginOcclusionQuery(e){const t=this.props.occlusionQuerySet;t?.beginOcclusionQuery()}endOcclusionQuery(){const e=this.props.occlusionQuerySet;e?.endOcclusionQuery()}clear(){const e={...this.glParameters};let t=0;this.props.clearColors&&this.props.clearColors.forEach((e,t)=>{e&&this.clearColorBuffer(t,e)}),!1!==this.props.clearColor&&void 0===this.props.clearColors&&(t|=16384,e.clearColor=this.props.clearColor),!1!==this.props.clearDepth&&(t|=256,e.clearDepth=this.props.clearDepth),!1!==this.props.clearStencil&&(t|=1024,e.clearStencil=this.props.clearStencil),0!==t&&pU(this.device.gl,e,()=>{this.device.gl.clear(t)})}clearColorBuffer(e=0,t=[0,0,0,0]){pU(this.device.gl,{framebuffer:this.props.framebuffer},()=>{switch(t.constructor){case Int8Array:case Int16Array:case Int32Array:this.device.gl.clearBufferiv(6144,e,t);break;case Uint8Array:case Uint8ClampedArray:case Uint16Array:case Uint32Array:this.device.gl.clearBufferuiv(6144,e,t);break;case Float32Array:this.device.gl.clearBufferfv(6144,e,t);break;default:throw new Error("clearColorBuffer: color must be typed array")}})}}function CU(e){return SU.includes(e)}const SU=[35678,35680,35679,35682,36289,36292,36293,36298,36299,36300,36303,36306,36307,36308,36311],EU={5126:[5126,1,"float","f32","float32"],35664:[5126,2,"vec2","vec2<f32>","float32x2"],35665:[5126,3,"vec3","vec3<f32>","float32x3"],35666:[5126,4,"vec4","vec4<f32>","float32x4"],5124:[5124,1,"int","i32","sint32"],35667:[5124,2,"ivec2","vec2<i32>","sint32x2"],35668:[5124,3,"ivec3","vec3<i32>","sint32x3"],35669:[5124,4,"ivec4","vec4<i32>","sint32x4"],5125:[5125,1,"uint","u32","uint32"],36294:[5125,2,"uvec2","vec2<u32>","uint32x2"],36295:[5125,3,"uvec3","vec3<u32>","uint32x3"],36296:[5125,4,"uvec4","vec4<u32>","uint32x4"],35670:[5126,1,"bool","f32","float32"],35671:[5126,2,"bvec2","vec2<f32>","float32x2"],35672:[5126,3,"bvec3","vec3<f32>","float32x3"],35673:[5126,4,"bvec4","vec4<f32>","float32x4"],35674:[5126,8,"mat2","mat2x2<f32>"],35685:[5126,8,"mat2x3","mat2x3<f32>"],35686:[5126,8,"mat2x4","mat2x4<f32>"],35687:[5126,12,"mat3x2","mat3x2<f32>"],35675:[5126,12,"mat3","mat3x3<f32>"],35688:[5126,12,"mat3x4","mat3x4<f32>"],35689:[5126,16,"mat4x2","mat4x2<f32>"],35690:[5126,16,"mat4x3","mat4x3<f32>"],35676:[5126,16,"mat4","mat4x4<f32>"]};function BU(e){const t=EU[e];if(!t)throw new Error("uniform");const[n,r,,o]=t;return{format:o,components:r,glType:n}}function IU(e){const t=EU[e];if(!t)throw new Error("attribute");const[,n,,r,o]=t;return{attributeType:r,vertexFormat:o,components:n}}function RU(e,t){const n={attributes:[],bindings:[]};n.attributes=function(e,t){const n=[],r=e.getProgramParameter(t,35721);for(let o=0;o<r;o++){const r=e.getActiveAttrib(t,o);if(!r)throw new Error("activeInfo");const{name:i,type:s}=r,a=e.getAttribLocation(t,i);if(a>=0){const{attributeType:e}=IU(s),t=/instance/i.test(i)?"instance":"vertex";n.push({name:i,location:a,stepMode:t,type:e})}}return n.sort((e,t)=>e.location-t.location),n}(e,t);const r=function(e,t){const n=(n,r)=>e.getActiveUniformBlockParameter(t,n,r),r=[],o=e.getProgramParameter(t,35382);for(let i=0;i<o;i++){const o={name:e.getActiveUniformBlockName(t,i)||"",location:n(i,35391),byteLength:n(i,35392),vertex:n(i,35396),fragment:n(i,35398),uniformCount:n(i,35394),uniforms:[]},s=n(i,35395)||[],a=e.getActiveUniforms(t,s,35383),l=e.getActiveUniforms(t,s,35384),c=e.getActiveUniforms(t,s,35387),u=e.getActiveUniforms(t,s,35388);for(let n=0;n<o.uniformCount;++n){const r=e.getActiveUniform(t,s[n]);if(!r)throw new Error("activeInfo");o.uniforms.push({name:r.name,format:BU(a[n]).format,type:a[n],arrayLength:l[n],byteOffset:c[n],byteStride:u[n]})}r.push(o)}return r.sort((e,t)=>e.location-t.location),r}(e,t);for(const a of r){const e=a.uniforms.map(e=>({name:e.name,format:e.format,byteOffset:e.byteOffset,byteStride:e.byteStride,arrayLength:e.arrayLength}));n.bindings.push({type:"uniform",name:a.name,group:0,location:a.location,visibility:(a.vertex?1:0)&(a.fragment?2:0),minBindingSize:a.byteLength,uniforms:e})}const o=function(e,t){const n=[],r=e.getProgramParameter(t,35718);for(let o=0;o<r;o++){const r=e.getActiveUniform(t,o);if(!r)throw new Error("activeInfo");const{name:i,size:s,type:a}=r,{name:l,isArray:c}=PU(i);let u=e.getUniformLocation(t,l);const d={location:u,name:l,size:s,type:a,isArray:c};if(n.push(d),d.size>1)for(let o=0;o<d.size;o++){const r=`${l}[${o}]`;u=e.getUniformLocation(t,r);const i={...d,name:r,location:u};n.push(i)}}return n}(e,t);let i=0;for(const a of o)if(CU(a.type)){const{viewDimension:e,sampleType:t}=TU(a.type);n.bindings.push({type:"texture",name:a.name,group:0,location:i,viewDimension:e,sampleType:t}),a.textureUnit=i,i+=1}o.length&&(n.uniforms=o);const s=function(e,t){const n=[],r=e.getProgramParameter(t,35971);for(let o=0;o<r;o++){const r=e.getTransformFeedbackVarying(t,o);if(!r)throw new Error("activeInfo");const{name:i,type:s,size:a}=r,{glType:l,components:c}=BU(s),u={location:o,name:i,type:l,size:a*c};n.push(u)}return n.sort((e,t)=>e.location-t.location),n}(e,t);return s?.length&&(n.varyings=s),n}const kU={35678:["2d","float"],35680:["cube","float"],35679:["3d","float"],35682:["3d","depth"],36289:["2d-array","float"],36292:["2d-array","depth"],36293:["cube","float"],36298:["2d","sint"],36299:["3d","sint"],36300:["cube","sint"],36303:["2d-array","uint"],36306:["2d","uint"],36307:["3d","uint"],36308:["cube","uint"],36311:["2d-array","uint"]};function TU(e){const t=kU[e];if(!t)throw new Error("sampler");const[n,r]=t;return{viewDimension:n,sampleType:r}}function PU(e){if("]"!==e[e.length-1])return{name:e,length:1,isArray:!1};const t=/([^[]*)(\[[0-9]+\])?/.exec(e);if(!t||t.length<2)throw new Error(`Failed to parse GLSL uniform name ${e}`);return{name:t[1],length:t[2]?1:0,isArray:Boolean(t[2])}}function FU(e,t,n,r){const o=e;let i=r;!0===i&&(i=1),!1===i&&(i=0);const s="number"==typeof i?[i]:i;switch(n){case 35678:case 35680:case 35679:case 35682:case 36289:case 36292:case 36293:case 36298:case 36299:case 36300:case 36303:case 36306:case 36307:case 36308:case 36311:if("number"!=typeof r)throw new Error("samplers must be set to integers");return e.uniform1i(t,r);case 5126:return e.uniform1fv(t,s);case 35664:return e.uniform2fv(t,s);case 35665:return e.uniform3fv(t,s);case 35666:return e.uniform4fv(t,s);case 5124:case 35670:return e.uniform1iv(t,s);case 35667:case 35671:return e.uniform2iv(t,s);case 35668:case 35672:return e.uniform3iv(t,s);case 35669:case 35673:return e.uniform4iv(t,s);case 5125:return o.uniform1uiv(t,s,1);case 36294:return o.uniform2uiv(t,s,2);case 36295:return o.uniform3uiv(t,s,3);case 36296:return o.uniform4uiv(t,s,4);case 35674:return e.uniformMatrix2fv(t,!1,s);case 35675:return e.uniformMatrix3fv(t,!1,s);case 35676:return e.uniformMatrix4fv(t,!1,s);case 35685:return o.uniformMatrix2x3fv(t,!1,s);case 35686:return o.uniformMatrix2x4fv(t,!1,s);case 35687:return o.uniformMatrix3x2fv(t,!1,s);case 35688:return o.uniformMatrix3x4fv(t,!1,s);case 35689:return o.uniformMatrix4x2fv(t,!1,s);case 35690:return o.uniformMatrix4x3fv(t,!1,s)}throw new Error("Illegal uniform")}function MU(e){const t={bindings:{},uniforms:{}};return Object.keys(e).forEach(n=>{const r=e[n];var o;null!==RF(o=r)||"number"==typeof o||"boolean"==typeof o?t.uniforms[n]=r:t.bindings[n]=r}),t}class LU extends WS{device;handle;vs;fs;introspectedLayout;uniforms={};bindings={};varyings=null;_uniformCount=0;_uniformSetters={};constructor(e,t){super(e,t),this.device=e,this.handle=this.props.handle||this.device.gl.createProgram(),this.device.setSpectorMetadata(this.handle,{id:this.props.id}),this.vs=t.vs,this.fs=t.fs;const{varyings:n,bufferMode:r=35981}=t;n&&n.length>0&&(this.varyings=n,this.device.gl.transformFeedbackVaryings(this.handle,n,r)),this._linkShaders(),eS.time(1,`RenderPipeline ${this.id} - shaderLayout introspection`)(),this.introspectedLayout=RU(this.device.gl,this.handle),eS.timeEnd(1,`RenderPipeline ${this.id} - shaderLayout introspection`)(),this.shaderLayout=function(e,t){const n={...e,attributes:e.attributes.map(e=>({...e}))};for(const r of t?.attributes||[]){const e=n.attributes.find(e=>e.name===r.name);e?(e.type=r.type||e.type,e.stepMode=r.stepMode||e.stepMode):eS.warn(`shader layout attribute ${r.name} not present in shader`)}return n}(this.introspectedLayout,t.shaderLayout)}destroy(){this.handle&&(this.device.gl.deleteProgram(this.handle),this.destroyed=!0)}setBindings(e,t){for(const[n,r]of Object.entries(e)){const e=this.shaderLayout.bindings.find(e=>e.name===n)||this.shaderLayout.bindings.find(e=>e.name===`${n}Uniforms`);if(!e){const e=this.shaderLayout.bindings.map(e=>`"${e.name}"`).join(", ");t?.disableWarnings||eS.warn(`No binding "${n}" in render pipeline "${this.id}", expected one of ${e}`,r)();continue}switch(r||eS.warn(`Unsetting binding "${n}" in render pipeline "${this.id}"`)(),e.type){case"uniform":if(!(r instanceof ZL||r.buffer instanceof ZL))throw new Error("buffer value");break;case"texture":if(!(r instanceof AU||r instanceof wU||r instanceof jL))throw new Error("texture value");break;case"sampler":eS.warn(`Ignoring sampler ${n}`)();break;default:throw new Error(e.type)}this.bindings[n]=r}}draw(e){const{renderPass:t,parameters:n=this.props.parameters,topology:r=this.props.topology,vertexArray:o,vertexCount:i,instanceCount:s,isInstanced:a=!1,firstVertex:l=0,transformFeedback:c}=e,u=function(e){switch(e){case"point-list":return 0;case"line-list":return 1;case"line-strip":return 3;case"triangle-list":return 4;case"triangle-strip":return 5;default:throw new Error(e)}}(r),d=Boolean(o.indexBuffer),A=o.indexBuffer?.glIndexType;if("success"!==this.linkStatus)return eS.info(2,`RenderPipeline:${this.id}.draw() aborted - waiting for shader linking`)(),!1;if(!this._areTexturesRenderable())return eS.info(2,`RenderPipeline:${this.id}.draw() aborted - textures not yet loaded`)(),!1;this.device.gl.useProgram(this.handle),o.bindBeforeRender(t),c&&c.begin(this.props.topology),this._applyBindings(),this._applyUniforms();const h=t;return nU(this.device,n,h.glParameters,()=>{d&&a?this.device.gl.drawElementsInstanced(u,i||0,A,l,s||0):d?this.device.gl.drawElements(u,i||0,A,l):a?this.device.gl.drawArraysInstanced(u,l,i||0,s||0):this.device.gl.drawArrays(u,l,i||0),c&&c.end()}),o.unbindAfterRender(t),!0}setUniformsWebGL(e){const{bindings:t}=MU(e);Object.keys(t).forEach(e=>{eS.warn(`Unsupported value "${JSON.stringify(t[e])}" used in setUniforms() for key ${e}. Use setBindings() instead?`)()}),Object.assign(this.uniforms,e)}async _linkShaders(){const{gl:e}=this.device;if(e.attachShader(this.handle,this.vs.handle),e.attachShader(this.handle,this.fs.handle),eS.time(4,`linkProgram for ${this.id}`)(),e.linkProgram(this.handle),eS.timeEnd(4,`linkProgram for ${this.id}`)(),eS.level,!this.device.features.has("compilation-status-async-webgl")){const e=this._getLinkStatus();return void this._reportLinkStatus(e)}eS.once(1,"RenderPipeline linking is asynchronous")(),await this._waitForLinkComplete(),eS.info(2,`RenderPipeline ${this.id} - async linking complete: ${this.linkStatus}`)();const t=this._getLinkStatus();this._reportLinkStatus(t)}async _reportLinkStatus(e){if("success"!==e){switch(this.vs.compilationStatus){case"error":throw this.vs.debugShader(),new Error(`Error during compilation of shader ${this.vs.id}`);case"pending":this.vs.asyncCompilationStatus.then(()=>this.vs.debugShader())}switch(this.fs?.compilationStatus){case"error":throw this.fs.debugShader(),new Error(`Error during compilation of shader ${this.fs.id}`);case"pending":this.fs.asyncCompilationStatus.then(()=>this.fs.debugShader())}const t=this.device.gl.getProgramInfoLog(this.handle);throw new Error(`Error during ${e}: ${t}`)}}_getLinkStatus(){const{gl:e}=this.device;if(!e.getProgramParameter(this.handle,35714))return this.linkStatus="error","linking";e.validateProgram(this.handle);return e.getProgramParameter(this.handle,35715)?(this.linkStatus="success","success"):(this.linkStatus="error","validation")}async _waitForLinkComplete(){const e=async e=>await new Promise(t=>setTimeout(t,e));if(!this.device.features.has("compilation-status-async-webgl"))return void(await e(10));const{gl:t}=this.device;for(;;){if(t.getProgramParameter(this.handle,37297))return;await e(10)}}_areTexturesRenderable(){let e=!0;for(const t of this.shaderLayout.bindings)this.bindings[t.name]||this.bindings[t.name.replace(/Uniforms$/,"")]||(eS.warn(`Binding ${t.name} not found in ${this.id}`)(),e=!1);return e}_applyBindings(){if("success"!==this.linkStatus)return;const{gl:e}=this.device;e.useProgram(this.handle);let t=0,n=0;for(const r of this.shaderLayout.bindings){const o=this.bindings[r.name]||this.bindings[r.name.replace(/Uniforms$/,"")];if(!o)throw new Error(`No value for binding ${r.name} in ${this.id}`);switch(r.type){case"uniform":const{name:i}=r,s=e.getUniformBlockIndex(this.handle,i);if(4294967295===s)throw new Error(`Invalid uniform block name ${i}`);e.uniformBlockBinding(this.handle,n,s),o instanceof ZL?e.bindBufferBase(35345,n,o.handle):e.bindBufferRange(35345,n,o.buffer.handle,o.offset||0,o.size||o.buffer.byteLength-o.offset),n+=1;break;case"texture":if(!(o instanceof AU||o instanceof wU||o instanceof jL))throw new Error("texture");let a;if(o instanceof AU)a=o.texture;else if(o instanceof wU)a=o;else{if(!(o instanceof jL&&o.colorAttachments[0]instanceof AU))throw new Error("No texture");eS.warn("Passing framebuffer in texture binding may be deprecated. Use fbo.colorAttachments[0] instead")(),a=o.colorAttachments[0].texture}e.activeTexture(33984+t),e.bindTexture(a.glTarget,a.handle),t+=1;break;case"sampler":break;case"storage":case"read-only-storage":throw new Error(`binding type '${r.type}' not supported in WebGL`)}}}_applyUniforms(){for(const e of this.shaderLayout.uniforms||[]){const{name:t,location:n,type:r,textureUnit:o}=e,i=this.uniforms[t]??o;void 0!==i&&FU(this.device.gl,n,r,i)}}}class UU extends YS{device;commands=[];constructor(e){super(e,{}),this.device=e}submitCommands(e=this.commands){for(const t of e)switch(t.name){case"copy-buffer-to-buffer":OU(this.device,t.options);break;case"copy-buffer-to-texture":DU(this.device,t.options);break;case"copy-texture-to-buffer":NU(this.device,t.options);break;case"copy-texture-to-texture":jU(this.device,t.options);break;default:throw new Error(t.name)}}}function OU(e,t){const n=t.sourceBuffer,r=t.destinationBuffer;e.gl.bindBuffer(36662,n.handle),e.gl.bindBuffer(36663,r.handle),e.gl.copyBufferSubData(36662,36663,t.sourceOffset??0,t.destinationOffset??0,t.size),e.gl.bindBuffer(36662,null),e.gl.bindBuffer(36663,null)}function DU(e,t){throw new Error("Not implemented")}function NU(e,t){const{sourceTexture:n,mipLevel:r=0,aspect:o="all",width:i=t.sourceTexture.width,height:s=t.sourceTexture.height,depthOrArrayLayers:a=0,origin:l=[0,0],destinationBuffer:c,byteOffset:u=0,bytesPerRow:d,rowsPerImage:A}=t;if("all"!==o)throw new Error("aspect not supported in WebGL");if(0!==r||0!==a||d||A)throw new Error("not implemented");const{framebuffer:h,destroyFramebuffer:p}=QU(n);let f;try{const t=c,n=i||h.width,r=s||h.height,o=LL(h.colorAttachments[0].texture.props.format),a=o.format,d=o.type;e.gl.bindBuffer(35051,t.handle),f=e.gl.bindFramebuffer(36160,h.handle),e.gl.readPixels(l[0],l[1],n,r,a,d,u)}finally{e.gl.bindBuffer(35051,null),void 0!==f&&e.gl.bindFramebuffer(36160,f),p&&h.destroy()}}function jU(e,t){const{sourceTexture:n,destinationMipLevel:r=0,origin:o=[0,0],destinationOrigin:i=[0,0],destinationTexture:s}=t;let{width:a=t.destinationTexture.width,height:l=t.destinationTexture.height}=t;const{framebuffer:c,destroyFramebuffer:u}=QU(n),[d,A]=o,[h,p,f]=i,g=e.gl.bindFramebuffer(36160,c.handle);let m,y=null;if(!(s instanceof wU))throw new Error("invalid destination");switch(y=s,a=Number.isFinite(a)?a:y.width,l=Number.isFinite(l)?l:y.height,y.bind(0),m=y.glTarget,m){case 3553:case 34067:e.gl.copyTexSubImage2D(m,r,h,p,d,A,a,l);break;case 35866:case 32879:e.gl.copyTexSubImage3D(m,r,h,p,f,d,A,a,l)}y&&y.unbind(),e.gl.bindFramebuffer(36160,g),u&&c.destroy()}function QU(e){if(e instanceof OS){const{width:t,height:n,id:r}=e;return{framebuffer:e.device.createFramebuffer({id:`framebuffer-for-${r}`,width:t,height:n,colorAttachments:[e]}),destroyFramebuffer:!0}}return{framebuffer:e,destroyFramebuffer:!1}}class zU extends XS{device;commandBuffer;constructor(e,t){super(e,t),this.device=e,this.commandBuffer=new UU(e)}destroy(){}finish(){this.commandBuffer.submitCommands()}copyBufferToBuffer(e){this.commandBuffer.commands.push({name:"copy-buffer-to-buffer",options:e})}copyBufferToTexture(e){this.commandBuffer.commands.push({name:"copy-buffer-to-texture",options:e})}copyTextureToBuffer(e){this.commandBuffer.commands.push({name:"copy-texture-to-buffer",options:e})}copyTextureToTexture(e){this.commandBuffer.commands.push({name:"copy-texture-to-texture",options:e})}pushDebugGroup(e){}popDebugGroup(){}insertDebugMarker(e){}resolveQuerySet(e,t,n){}}class HU extends nE{get[Symbol.toStringTag](){return"VertexArray"}device;handle;buffer=null;bufferValue=null;static isConstantAttributeZeroSupported(e){return"Chrome"==(nx()?tx()?"Electron":(ex.userAgent||"").indexOf("Edge")>-1?"Edge":globalThis.chrome?"Chrome":globalThis.safari?"Safari":globalThis.mozInnerScreenX?"Firefox":"Unknown":"Node")}constructor(e,t){super(e,t),this.device=e,this.handle=this.device.gl.createVertexArray()}destroy(){super.destroy(),this.buffer&&this.buffer?.destroy(),this.handle&&(this.device.gl.deleteVertexArray(this.handle),this.handle=void 0)}setIndexBuffer(e){const t=e;if(t&&34963!==t.glTarget)throw new Error("Use .setBuffer()");this.device.gl.bindVertexArray(this.handle),this.device.gl.bindBuffer(34963,t?t.handle:null),this.indexBuffer=t,this.device.gl.bindVertexArray(null)}setBuffer(e,t){const n=t;if(34963===n.glTarget)throw new Error("Use .setIndexBuffer()");const{size:r,type:o,stride:i,offset:s,normalized:a,integer:l,divisor:c}=this._getAccessor(e);this.device.gl.bindVertexArray(this.handle),this.device.gl.bindBuffer(34962,n.handle),l?this.device.gl.vertexAttribIPointer(e,r,o,i,s):this.device.gl.vertexAttribPointer(e,r,o,a,i,s),this.device.gl.bindBuffer(34962,null),this.device.gl.enableVertexAttribArray(e),this.device.gl.vertexAttribDivisor(e,c||0),this.attributes[e]=n,this.device.gl.bindVertexArray(null)}setConstantWebGL(e,t){this._enable(e,!1),this.attributes[e]=t}bindBeforeRender(){this.device.gl.bindVertexArray(this.handle),this._applyConstantAttributes()}unbindAfterRender(){this.device.gl.bindVertexArray(null)}_applyConstantAttributes(){for(let e=0;e<this.maxVertexAttributes;++e){const t=this.attributes[e];ArrayBuffer.isView(t)&&this.device.setConstantAttributeWebGL(e,t)}}_getAccessor(e){const t=this.attributeInfos[e];if(!t)throw new Error(`Unknown attribute location ${e}`);const n=EL(t.bufferDataType);return{size:t.bufferComponents,type:n,stride:t.byteStride,offset:t.byteOffset,normalized:t.normalized,integer:t.integer,divisor:"instance"===t.stepMode?1:0}}_enable(e,t=!0){const n=HU.isConstantAttributeZeroSupported(this.device);(t||(n||0!==e))&&(e=Number(e),this.device.gl.bindVertexArray(this.handle),t?this.device.gl.enableVertexAttribArray(e):this.device.gl.disableVertexAttribArray(e),this.device.gl.bindVertexArray(null))}getConstantBuffer(e,t){const n=function(e){if(Array.isArray(e))return new Float32Array(e);return e}(t),r=n.byteLength*e,o=n.length*e;if(this.buffer&&r!==this.buffer.byteLength)throw new Error(`Buffer size is immutable, byte length ${r} !== ${this.buffer.byteLength}.`);let i=!this.buffer;if(this.buffer=this.buffer||this.device.createBuffer({byteLength:r}),i=i||!function(e,t){if(!e||!t||e.length!==t.length||e.constructor!==t.constructor)return!1;for(let n=0;n<e.length;++n)if(e[n]!==t[n])return!1;return!0}(n,this.bufferValue),i){const e=function(e,t){return new e(cE(e.BYTES_PER_ELEMENT*t),0,t)}(t.constructor,o);!function(e){const{target:t,source:n,start:r=0,count:o=1}=e,i=n.length,s=o*i;let a=0;for(let l=r;a<i;a++)t[l++]=n[a];for(;a<s;)a<s-a?(t.copyWithin(r+a,r,r+a),a*=2):(t.copyWithin(r+a,r,r+s-a),a=s);e.target}({target:e,source:n,start:0,count:o}),this.buffer.write(e),this.bufferValue=t}return this.buffer}}class GU extends rE{device;gl;handle;layout;buffers={};unusedBuffers={};bindOnUse=!0;_bound=!1;constructor(e,t){super(e,t),this.device=e,this.gl=e.gl,this.handle=this.props.handle||this.gl.createTransformFeedback(),this.layout=this.props.layout,t.buffers&&this.setBuffers(t.buffers),Object.seal(this)}destroy(){this.gl.deleteTransformFeedback(this.handle),super.destroy()}begin(e="point-list"){this.gl.bindTransformFeedback(36386,this.handle),this.bindOnUse&&this._bindBuffers(),this.gl.beginTransformFeedback(function(e){switch(e){case"point-list":return 0;case"line-list":case"line-strip":return 1;case"triangle-list":case"triangle-strip":return 4;default:throw new Error(e)}}(e))}end(){this.gl.endTransformFeedback(),this.bindOnUse&&this._unbindBuffers(),this.gl.bindTransformFeedback(36386,null)}setBuffers(e){this.buffers={},this.unusedBuffers={},this.bind(()=>{for(const t in e)this.setBuffer(t,e[t])})}setBuffer(e,t){const n=this._getVaryingIndex(e),{buffer:r,byteLength:o,byteOffset:i}=this._getBufferRange(t);if(n<0)return this.unusedBuffers[e]=r,void eS.warn(`${this.id} unusedBuffers varying buffer ${e}`)();this.buffers[n]={buffer:r,byteLength:o,byteOffset:i},this.bindOnUse||this._bindBuffer(n,r,i,o)}getBuffer(e){if(VU(e))return this.buffers[e]||null;const t=this._getVaryingIndex(e);return t>=0?this.buffers[t]:null}bind(e=this.handle){if("function"!=typeof e)return this.gl.bindTransformFeedback(36386,e),this;let t;return this._bound?t=e():(this.gl.bindTransformFeedback(36386,this.handle),this._bound=!0,t=e(),this._bound=!1,this.gl.bindTransformFeedback(36386,null)),t}unbind(){this.bind(null)}_getBufferRange(e){if(e instanceof ZL)return{buffer:e,byteOffset:0,byteLength:e.byteLength};const{buffer:t,byteOffset:n=0,byteLength:r=e.buffer.byteLength}=e;return{buffer:t,byteOffset:n,byteLength:r}}_getVaryingIndex(e){if(VU(e))return Number(e);for(const t of this.layout.varyings)if(e===t.name)return t.location;return-1}_bindBuffers(){for(const e in this.buffers){const{buffer:t,byteLength:n,byteOffset:r}=this._getBufferRange(this.buffers[e]);this._bindBuffer(Number(e),t,r,n)}}_unbindBuffers(){for(const e in this.buffers)this.gl.bindBufferBase(35982,Number(e),null)}_bindBuffer(e,t,n=0,r){const o=t&&t.handle;o&&void 0!==r?this.gl.bindBufferRange(35982,e,o,n,r):this.gl.bindBufferBase(35982,e,o)}}function VU(e){return"number"==typeof e?Number.isInteger(e):/^\d+$/.test(e)}class WU extends oE{device;handle;target=null;_queryPending=!1;_pollingPromise=null;get[Symbol.toStringTag](){return"Query"}constructor(e,t){if(super(e,t),this.device=e,t.count>1)throw new Error("WebGL QuerySet can only have one value");this.handle=this.device.gl.createQuery(),Object.seal(this)}destroy(){this.device.gl.deleteQuery(this.handle)}beginTimestampQuery(){return this._begin(35007)}endTimestampQuery(){this._end()}beginOcclusionQuery(e){return this._begin(e?.conservative?36202:35887)}endOcclusionQuery(){this._end()}beginTransformFeedbackQuery(){return this._begin(35976)}endTransformFeedbackQuery(){this._end()}async resolveQuery(){return[await this.pollQuery()]}_begin(e){this._queryPending||(this.target=e,this.device.gl.beginQuery(this.target,this.handle))}_end(){this._queryPending||this.target&&(this.device.gl.endQuery(this.target),this.target=null,this._queryPending=!0)}isResultAvailable(){if(!this._queryPending)return!1;const e=this.device.gl.getQueryParameter(this.handle,34919);return e&&(this._queryPending=!1),e}isTimerDisjoint(){return this.device.gl.getParameter(36795)}getResult(){return this.device.gl.getQueryParameter(this.handle,34918)}getTimerMilliseconds(){return this.getResult()/1e6}pollQuery(e=Number.POSITIVE_INFINITY){if(this._pollingPromise)return this._pollingPromise;let t=0;return this._pollingPromise=new Promise((n,r)=>{const o=()=>{this.isResultAvailable()?(n(this.getResult()),this._pollingPromise=null):t++>e?(r("Timed out"),this._pollingPromise=null):requestAnimationFrame(o)};requestAnimationFrame(o)}),this._pollingPromise}}class $U extends IS{type="webgl";handle;features;limits;info;canvasContext;lost;_resolveContextLost;gl;debug=!1;_canvasSizeInfo={clientWidth:0,clientHeight:0,devicePixelRatio:1};_extensions={};_polyfilled=!1;spectorJS;constructor(e){super({...e,id:e.id||JL("webgl-device")});const t=IS._getCanvasContextProps(e);if(!t)throw new Error("WebGLDevice requires props.createCanvasContext to be set");let n=t.canvas?.gl?.device;if(n)throw new Error(`WebGL context already attached to device ${n.id}`);this.canvasContext=new QL(this,t),this.lost=new Promise(e=>{this._resolveContextLost=e});const r={...e.webgl};"premultiplied"===t.alphaMode&&(r.premultipliedAlpha=!0),void 0!==e.powerPreference&&(r.powerPreference=e.powerPreference);const o=this.props._handle||function(e,t,n){let r="";const o={preserveDrawingBuffer:!0,...n};let i=null;if(i||=e.getContext("webgl2",o),o.failIfMajorPerformanceCaveat&&(r||="Only software GPU is available. Set `failIfMajorPerformanceCaveat: false` to allow."),i||n.failIfMajorPerformanceCaveat||(o.failIfMajorPerformanceCaveat=!1,i=e.getContext("webgl2",o),i.luma||={},i.luma.softwareRenderer=!0),i||(i=e.getContext("webgl",{}),i&&(i=null,r||="Your browser only supports WebGL1")),!i)throw r||="Your browser does not support WebGL",new Error(`Failed to create WebGL context: ${r}`);const{onContextLost:s,onContextRestored:a}=t;return e.addEventListener("webglcontextlost",e=>s(e),!1),e.addEventListener("webglcontextrestored",e=>a(e),!1),i.luma||={},i}(this.canvasContext.canvas,{onContextLost:e=>this._resolveContextLost?.({reason:"destroyed",message:"Entered sleep mode, or too many apps or browser tabs are using the GPU."}),onContextRestored:e=>{}},r);if(!o)throw new Error("WebGL context creation failed");if(n=o.device,n){if(e._reuseDevices)return eS.log(1,`Not creating a new Device, instead returning a reference to Device ${n.id} already attached to WebGL context`,n)(),n._reused=!0,n;throw new Error(`WebGL context already attached to device ${n.id}`)}this.handle=o,this.gl=o,this.spectorJS=function(e){if(!(e={...VL,...e}).debugSpectorJS)return null;if(!HL&&globalThis.SPECTOR&&!globalThis.luma?.spector){eS.probe(1,"SPECTOR found and initialized. Start with `luma.spector.displayUI()`")();const{Spector:e}=globalThis.SPECTOR;HL=new e,globalThis.luma&&(globalThis.luma.spector=HL)}if(!HL)return null;if(GL||(GL=!0,HL.spyCanvases(),HL?.onCaptureStarted.add(e=>eS.info("Spector capture started:",e)()),HL?.onCapture.add(e=>{eS.info("Spector capture complete:",e)(),HL?.getResultUI(),HL?.resultView.display(),HL?.resultView.addCapture(e)})),e.gl){const t=e.gl,n=t.device;HL?.startCapture(e.gl,500),t.device=n,new Promise(e=>setTimeout(e,2e3)).then(e=>{eS.info("Spector capture stopped after 2 seconds")(),HL?.stopCapture()})}return HL}({...this.props,gl:this.handle}),this.gl.device=this,this.gl._version=2,this.info=CL(this.gl,this._extensions),this.limits=new NL(this.gl),this.features=new DL(this.gl,this._extensions,this.props._disabledFeatures),this.props._initializeFeatures&&this.features.initializeFeatures(),!1!==t.autoResize&&this.canvasContext.resize();new bL(this.gl,{log:(...e)=>eS.log(1,...e)()}).trackState(this.gl,{copyState:!1});const i=e.debugWebGL||e.debug,s=e.debugWebGL;i&&(this.gl=$L(this.gl,{debugWebGL:i,traceWebGL:s}),eS.warn("WebGL debug mode activated. Performance reduced.")(),e.debugWebGL&&(eS.level=Math.max(eS.level,1)))}destroy(){this.props._reuseDevices||this._reused||delete this.gl.device}get isLost(){return this.gl.isContextLost()}createCanvasContext(e){throw new Error("WebGL only supports a single canvas")}createBuffer(e){const t=this._normalizeBufferProps(e);return new ZL(this,t)}createTexture(e){return new wU(this,e)}createExternalTexture(e){throw new Error("createExternalTexture() not implemented")}createSampler(e){return new dU(this,e)}createShader(e){return new tU(this,e)}createFramebuffer(e){return new jL(this,e)}createVertexArray(e){return new HU(this,e)}createTransformFeedback(e){return new GU(this,e)}createQuerySet(e){return new WU(this,e)}createRenderPipeline(e){return new LU(this,e)}beginRenderPass(e){return new _U(this,e)}createComputePipeline(e){throw new Error("ComputePipeline not supported in WebGL")}beginComputePass(e){throw new Error("ComputePass not supported in WebGL")}renderPass=null;createCommandEncoder(e={}){return new zU(this,e)}submit(){this.renderPass?.end(),this.renderPass=null}readPixelsToArrayWebGL(e,t){return yU(e,t)}readPixelsToBufferWebGL(e,t){return function(e,t){const{target:n,sourceX:r=0,sourceY:o=0,sourceFormat:i=6408,targetByteOffset:s=0}=t||{};let{sourceWidth:a,sourceHeight:l,sourceType:c}=t||{};const{framebuffer:u,deleteFramebuffer:d}=vU(e);a=a||u.width,l=l||u.height;const A=u;c=c||5121;let h=n;if(!h){const e=s+a*l*hU(i)*function(e){switch(e){case 5121:return 1;case 33635:case 32819:case 32820:return 2;case 5126:return 4;default:return 0}}(c);h=A.device.createBuffer({byteLength:e})}const p=e.device.createCommandEncoder();return p.copyTextureToBuffer({sourceTexture:e,width:a,height:l,origin:[r,o],destinationBuffer:h,byteOffset:s}),p.destroy(),d&&u.destroy(),h}(e,t)}setParametersWebGL(e){mL(this.gl,e)}getParametersWebGL(e){return yL(this.gl,e)}withParametersWebGL(e,t){return pU(this.gl,e,t)}resetWebGL(){eS.warn("WebGLDevice.resetWebGL is deprecated, use only for debugging")(),mL(this.gl,rL)}_getDeviceSpecificTextureFormatCapabilities(e){return function(e,t,n){let r=t.create;const o=ML[t.format];return void 0===o?.gl&&(r=!1),o?.x&&(r=r&&Boolean(_L(e,o.x,n))),{format:t.format,create:r&&t.create,render:r&&t.render,filter:r&&t.filter,blend:r&&t.blend,store:r&&t.store}}(this.gl,e,this._extensions)}loseDevice(){let e=!1;const t=this.getExtension("WEBGL_lose_context").WEBGL_lose_context;return t&&(e=!0,t.loseContext()),this._resolveContextLost?.({reason:"destroyed",message:"Application triggered context loss"}),e}pushState(){bL.get(this.gl).push()}popState(){bL.get(this.gl).pop()}setSpectorMetadata(e,t){e.__SPECTOR_Metadata=t}getGLKey(e,t){const n=Number(e);for(const r in this.gl)if(this.gl[r]===n)return`GL.${r}`;return t?.emptyIfUnknown?"":String(e)}getGLKeys(e){const t={emptyIfUnknown:!0};return Object.entries(e).reduce((e,[n,r])=>(e[`${n}:${this.getGLKey(n,t)}`]=`${r}:${this.getGLKey(r,t)}`,e),{})}_constants;setConstantAttributeWebGL(e,t){const n=this.limits.maxVertexAttributes;this._constants=this._constants||new Array(n).fill(null);const r=this._constants[e];switch(r&&function(e,t){if(!e||!t||e.length!==t.length||e.constructor!==t.constructor)return!1;for(let n=0;n<e.length;++n)if(e[n]!==t[n])return!1;return!0}(r,t)&&eS.info(1,`setConstantAttributeWebGL(${e}) could have been skipped, value unchanged`)(),this._constants[e]=t,t.constructor){case Float32Array:!function(e,t,n){switch(n.length){case 1:e.gl.vertexAttrib1fv(t,n);break;case 2:e.gl.vertexAttrib2fv(t,n);break;case 3:e.gl.vertexAttrib3fv(t,n);break;case 4:e.gl.vertexAttrib4fv(t,n)}}(this,e,t);break;case Int32Array:!function(e,t,n){e.gl.vertexAttribI4iv(t,n)}(this,e,t);break;case Uint32Array:!function(e,t,n){e.gl.vertexAttribI4uiv(t,n)}(this,e,t);break;default:throw new Error("constant")}}getExtension(e){return _L(this.gl,e,this._extensions),this._extensions}}const KU={WEBGL_depth_texture:{UNSIGNED_INT_24_8_WEBGL:34042},OES_element_index_uint:{},OES_texture_float:{},OES_texture_half_float:{HALF_FLOAT_OES:5131},EXT_color_buffer_float:{},OES_standard_derivatives:{FRAGMENT_SHADER_DERIVATIVE_HINT_OES:35723},EXT_frag_depth:{},EXT_blend_minmax:{MIN_EXT:32775,MAX_EXT:32776},EXT_shader_texture_lod:{}},XU=e=>({drawBuffersWEBGL:t=>e.drawBuffers(t),COLOR_ATTACHMENT0_WEBGL:36064,COLOR_ATTACHMENT1_WEBGL:36065,COLOR_ATTACHMENT2_WEBGL:36066,COLOR_ATTACHMENT3_WEBGL:36067}),YU=e=>({VERTEX_ARRAY_BINDING_OES:34229,createVertexArrayOES:()=>e.createVertexArray(),deleteVertexArrayOES:t=>e.deleteVertexArray(t),isVertexArrayOES:t=>e.isVertexArray(t),bindVertexArrayOES:t=>e.bindVertexArray(t)}),qU=e=>({VERTEX_ATTRIB_ARRAY_DIVISOR_ANGLE:35070,drawArraysInstancedANGLE:(...t)=>e.drawArraysInstanced(...t),drawElementsInstancedANGLE:(...t)=>e.drawElementsInstanced(...t),vertexAttribDivisorANGLE:(...t)=>e.vertexAttribDivisor(...t)});function JU(e=!0){const t=HTMLCanvasElement.prototype;if(!e&&t.originalGetContext)return t.getContext=t.originalGetContext,void(t.originalGetContext=void 0);t.originalGetContext=t.getContext,t.getContext=function(e,t){if("webgl"===e||"experimental-webgl"===e){const e=this.originalGetContext("webgl2",t);return e instanceof HTMLElement&&function(e){e.getExtension("EXT_color_buffer_float");const t={...KU,WEBGL_disjoint_timer_query:e.getExtension("EXT_disjoint_timer_query_webgl2"),WEBGL_draw_buffers:XU(e),OES_vertex_array_object:YU(e),ANGLE_instanced_arrays:qU(e)},n=e.getExtension;e.getExtension=function(r){const o=n.call(e,r);return o||(r in t?t[r]:null)};const r=e.getSupportedExtensions;e.getSupportedExtensions=function(){const n=r.apply(e)||[];return n?.concat(Object.keys(t))}}(e),e}return this.originalGetContext(e,t)}}const ZU=new class extends FS{type="webgl";constructor(){super(),IS.defaultProps={...IS.defaultProps,...VL},$U.adapter=this}isSupported(){return"undefined"!=typeof WebGL2RenderingContext}enforceWebGL2(e){JU(e)}async attach(e){if(e instanceof $U)return e;if(e?.device instanceof IS)return e.device;if(!function(e){if("undefined"!=typeof WebGL2RenderingContext&&e instanceof WebGL2RenderingContext)return!0;return Boolean(e&&Number.isFinite(e._version))}(e))throw new Error("Invalid WebGL2RenderingContext");return new $U({_handle:e,createCanvasContext:{canvas:e.canvas,autoResize:!1}})}async create(e={}){eS.groupCollapsed(1,"WebGLDevice created")();const t=[];(e.debugWebGL||e.debug)&&t.push(async function(){nx()&&!globalThis.WebGLDebugUtils&&(globalThis.global=globalThis.global||globalThis,globalThis.global.module={},await zL("https://unpkg.com/webgl-debug@2.0.1/index.js"))}()),e.debugSpectorJS&&t.push(async function(e){if(!globalThis.SPECTOR)try{await zL(e.debugSpectorJSUrl||VL.debugSpectorJSUrl)}catch(t){eS.warn(String(t))}}(e));const n=await Promise.allSettled(t);for(const i of n)"rejected"===i.status&&eS.error(`Failed to initialize debug libraries ${i.reason}`)();const r=new $U(e),o=`${r._reused?"Reusing":"Created"} device with WebGL2 ${r.debug?"debug ":""}context: ${r.info.vendor}, ${r.info.renderer} for canvas: ${r.canvasContext.id}`;return eS.probe(1,o)(),eS.table(1,r.info)(),eS.groupEnd(1)(),r}};function eO(){}const tO={id:"",width:"100%",height:"100%",style:null,viewState:null,initialViewState:null,pickingRadius:0,layerFilter:null,parameters:{},parent:null,device:null,deviceProps:{},gl:null,canvas:null,layers:[],effects:[],views:null,controller:null,useDevicePixels:!0,touchAction:"none",eventRecognizerOptions:{},_framebuffer:null,_animate:!1,_pickable:!0,_typedArrayManagerProps:{},_customRender:null,widgets:[],onDeviceInitialized:eO,onWebGLInitialized:eO,onResize:eO,onViewStateChange:eO,onInteractionStateChange:eO,onBeforeRender:eO,onAfterRender:eO,onLoad:eO,onError:e=>AC.error(e.message,e.cause)(),onHover:null,onClick:null,onDragStart:null,onDrag:null,onDragEnd:null,_onMetrics:null,getCursor:({isDragging:e})=>e?"grabbing":"grab",getTooltip:null,debug:!1,drawPickingColors:!1};class nO{constructor(e){this.width=0,this.height=0,this.userData={},this.device=null,this.canvas=null,this.viewManager=null,this.layerManager=null,this.effectManager=null,this.deckRenderer=null,this.deckPicker=null,this.eventManager=null,this.widgetManager=null,this.tooltip=null,this.animationLoop=null,this.cursorState={isHovering:!1,isDragging:!1},this.stats=new Vx({id:"deck.gl"}),this.metrics={fps:0,setPropsTime:0,updateAttributesTime:0,framesRedrawn:0,pickTime:0,pickCount:0,gpuTime:0,gpuTimePerFrame:0,cpuTime:0,cpuTimePerFrame:0,bufferMemory:0,textureMemory:0,renderbufferMemory:0,gpuMemory:0},this._metricsCounter=0,this._needsRedraw="Initial render",this._pickRequest={mode:"hover",x:-1,y:-1,radius:0,event:null},this._lastPointerDownInfo=null,this._onPointerMove=e=>{const{_pickRequest:t}=this;if("pointerleave"===e.type)t.x=-1,t.y=-1,t.radius=0;else{if(e.leftButton||e.rightButton)return;{const n=e.offsetCenter;if(!n)return;t.x=n.x,t.y=n.y,t.radius=this.props.pickingRadius}}this.layerManager&&(this.layerManager.context.mousePosition={x:t.x,y:t.y}),t.event=e},this._onEvent=e=>{const t=kT[e.type],n=e.offsetCenter;if(!t||!n||!this.layerManager)return;const r=this.layerManager.getLayers(),o=this.deckPicker.getLastPickedObject({x:n.x,y:n.y,layers:r,viewports:this.getViewports(n)},this._lastPointerDownInfo),{layer:i}=o,s=i&&(i[t]||i.props[t]),a=this.props[t];let l=!1;s&&(l=s.call(i,o,e)),l||(a?.(o,e),this.widgetManager.onEvent(o,e))},this._onPointerDown=e=>{if("webgpu"===this.device?.type)return;const t=e.offsetCenter,n=this._pick("pickObject","pickObject Time",{x:t.x,y:t.y,radius:this.props.pickingRadius});this._lastPointerDownInfo=n.result[0]||n.emptyInfo},this.props={...tO,...e},(e=this.props).viewState&&e.initialViewState&&AC.warn("View state tracking is disabled. Use either `initialViewState` for auto update or `viewState` for manual update.")(),this.viewState=this.props.initialViewState,e.device&&(this.device=e.device);let t=this.device;!t&&e.gl&&(e.gl instanceof WebGLRenderingContext&&AC.error("WebGL1 context not supported.")(),t=ZU.attach(e.gl)),t||(t=PS.createDevice({type:"best-available",_reuseDevices:!0,adapters:[ZU],...e.deviceProps,createCanvasContext:{canvas:this._createCanvas(e),useDevicePixels:this.props.useDevicePixels,autoResize:!1}})),this.animationLoop=this._createAnimationLoop(t,e),this.setProps(e),e._typedArrayManagerProps&&qP.setOptions(e._typedArrayManagerProps),this.animationLoop.start()}finalize(){this.animationLoop?.stop(),this.animationLoop?.destroy(),this.animationLoop=null,this._lastPointerDownInfo=null,this.layerManager?.finalize(),this.layerManager=null,this.viewManager?.finalize(),this.viewManager=null,this.effectManager?.finalize(),this.effectManager=null,this.deckRenderer?.finalize(),this.deckRenderer=null,this.deckPicker?.finalize(),this.deckPicker=null,this.eventManager?.destroy(),this.eventManager=null,this.widgetManager?.finalize(),this.widgetManager=null,this.props.canvas||this.props.device||this.props.gl||!this.canvas||(this.canvas.parentElement?.removeChild(this.canvas),this.canvas=null)}setProps(e){this.stats.get("setProps Time").timeStart(),"onLayerHover"in e&&AC.removed("onLayerHover","onHover")(),"onLayerClick"in e&&AC.removed("onLayerClick","onClick")(),e.initialViewState&&!aM(this.props.initialViewState,e.initialViewState,3)&&(this.viewState=e.initialViewState),Object.assign(this.props,e),this._setCanvasSize(this.props);const t=Object.create(this.props);Object.assign(t,{views:this._getViews(),width:this.width,height:this.height,viewState:this._getViewState()}),this.animationLoop?.setProps(t),this.layerManager&&(this.viewManager.setProps(t),this.layerManager.activateViewport(this.getViewports()[0]),this.layerManager.setProps(t),this.effectManager.setProps(t),this.deckRenderer.setProps(t),this.deckPicker.setProps(t),this.widgetManager.setProps(t)),this.stats.get("setProps Time").timeEnd()}needsRedraw(e={clearRedrawFlags:!1}){if(!this.layerManager)return!1;if(this.props._animate)return"Deck._animate";let t=this._needsRedraw;e.clearRedrawFlags&&(this._needsRedraw=!1);const n=this.viewManager.needsRedraw(e),r=this.layerManager.needsRedraw(e),o=this.effectManager.needsRedraw(e),i=this.deckRenderer.needsRedraw(e);return t=t||n||r||o||i,t}redraw(e){if(!this.layerManager)return;let t=this.needsRedraw({clearRedrawFlags:!0});t=e||t,t&&(this.stats.get("Redraw Count").incrementCount(),this.props._customRender?this.props._customRender(t):this._drawLayers(t))}get isInitialized(){return null!==this.viewManager}getViews(){return bM(this.viewManager),this.viewManager.views}getViewports(e){return bM(this.viewManager),this.viewManager.getViewports(e)}getCanvas(){return this.canvas}pickObject(e){const t=this._pick("pickObject","pickObject Time",e).result;return t.length?t[0]:null}pickMultipleObjects(e){return e.depth=e.depth||10,this._pick("pickObject","pickMultipleObjects Time",e).result}pickObjects(e){return this._pick("pickObjects","pickObjects Time",e)}_addResources(e,t=!1){for(const n in e)this.layerManager.resourceManager.add({resourceId:n,data:e[n],forceUpdate:t})}_removeResources(e){for(const t of e)this.layerManager.resourceManager.remove(t)}_addDefaultEffect(e){this.effectManager.addDefaultEffect(e)}_addDefaultShaderModule(e){this.layerManager.addDefaultShaderModule(e)}_removeDefaultShaderModule(e){this.layerManager?.removeDefaultShaderModule(e)}_pick(e,t,n){bM(this.deckPicker);const{stats:r}=this;r.get("Pick Count").incrementCount(),r.get(t).timeStart();const o=this.deckPicker[e]({layers:this.layerManager.getLayers(n),views:this.viewManager.getViews(),viewports:this.getViewports(n),onViewportActive:this.layerManager.activateViewport,effects:this.effectManager.getEffects(),...n});return r.get(t).timeEnd(),o}_createCanvas(e){let t=e.canvas;if("string"==typeof t&&(t=document.getElementById(t),bM(t)),!t){t=document.createElement("canvas"),t.id=e.id||"deckgl-overlay";(e.parent||document.body).appendChild(t)}return Object.assign(t.style,e.style),t}_setCanvasSize(e){if(!this.canvas)return;const{width:t,height:n}=e;if(t||0===t){const e=Number.isFinite(t)?`${t}px`:t;this.canvas.style.width=e}if(n||0===n){const t=Number.isFinite(n)?`${n}px`:n;this.canvas.style.position=e.style?.position||"absolute",this.canvas.style.height=t}}_updateCanvasSize(){const{canvas:e}=this;if(!e)return;const t=e.clientWidth??e.width,n=e.clientHeight??e.height;t===this.width&&n===this.height||(this.width=t,this.height=n,this.viewManager?.setProps({width:t,height:n}),this.layerManager?.activateViewport(this.getViewports()[0]),this.props.onResize({width:t,height:n}))}_createAnimationLoop(e,t){const{gl:n,onError:r,useDevicePixels:o}=t;return new vF({device:e,useDevicePixels:o,autoResizeDrawingBuffer:!n,autoResizeViewport:!1,onInitialize:e=>this._setDevice(e.device),onRender:this._onRenderFrame.bind(this),onError:r})}_getViewState(){return this.props.viewState||this.viewState}_getViews(){const{views:e}=this.props,t=Array.isArray(e)?e:e?[e]:[new DM({id:"default-view"})];return t.length&&this.props.controller&&(t[0].props.controller=this.props.controller),t}_onContextLost(){const{onError:e}=this.props;this.animationLoop&&e&&e(new Error("WebGL context is lost"))}_pickAndCallback(){if("webgpu"===this.device?.type)return;const{_pickRequest:e}=this;if(e.event){const{result:t,emptyInfo:n}=this._pick("pickObject","pickObject Time",e);this.cursorState.isHovering=t.length>0;let r=n,o=!1;for(const i of t)r=i,o=i.layer?.onHover(i,e.event)||o;o||(this.props.onHover?.(r,e.event),this.widgetManager.onHover(r,e.event)),e.event=null}}_updateCursor(){const e=this.props.parent||this.canvas;e&&(e.style.cursor=this.props.getCursor(this.cursorState))}_setDevice(e){if(this.device=e,!this.animationLoop)return;this.canvas||(this.canvas=this.device.canvasContext?.canvas),"webgl"===this.device.type&&this.device.setParametersWebGL({blend:!0,blendFunc:[770,771,1,771],polygonOffsetFill:!0,depthTest:!0,depthFunc:515}),this.props.onDeviceInitialized(this.device),"webgl"===this.device.type&&this.props.onWebGLInitialized(this.device.gl);const t=new gF;t.play(),this.animationLoop.attachTimeline(t),this.eventManager=new ET(this.props.parent||this.canvas,{touchAction:this.props.touchAction,recognizers:Object.keys(TT).map(e=>{const[t,n,r,o]=TT[e],i=this.props.eventRecognizerOptions?.[e];return{recognizer:new t({...n,...i,event:e}),recognizeWith:r,requestFailure:o}}),events:{pointerdown:this._onPointerDown,pointermove:this._onPointerMove,pointerleave:this._onPointerMove}});for(const r in kT)this.eventManager.on(r,this._onEvent);this.viewManager=new lM({timeline:t,eventManager:this.eventManager,onViewStateChange:this._onViewStateChange.bind(this),onInteractionStateChange:this._onInteractionStateChange.bind(this),views:this._getViews(),viewState:this._getViewState(),width:this.width,height:this.height});const n=this.viewManager.getViewports()[0];this.layerManager=new sM(this.device,{deck:this,stats:this.stats,viewport:n,timeline:t}),this.effectManager=new jM({deck:this,device:this.device}),this.deckRenderer=new zM(this.device),this.deckPicker=new KM(this.device),this.widgetManager=new JM({deck:this,parentElement:this.canvas?.parentElement}),this.widgetManager.addDefault(new eL),this.setProps(this.props),this._updateCanvasSize(),this.props.onLoad()}_drawLayers(e,t){const{device:n,gl:r}=this.layerManager.context;this.props.onBeforeRender({device:n,gl:r});const o={target:this.props._framebuffer,layers:this.layerManager.getLayers(),viewports:this.viewManager.getViewports(),onViewportActive:this.layerManager.activateViewport,views:this.viewManager.getViews(),pass:"screen",effects:this.effectManager.getEffects(),...t};this.deckRenderer?.renderLayers(o),"screen"===o.pass&&this.widgetManager.onRedraw({viewports:o.viewports,layers:o.layers}),this.props.onAfterRender({device:n,gl:r})}_onRenderFrame(){this._getFrameStats(),this._metricsCounter++%60==0&&(this._getMetrics(),this.stats.reset(),AC.table(4,this.metrics)(),this.props._onMetrics&&this.props._onMetrics(this.metrics)),this._updateCanvasSize(),this._updateCursor(),this.layerManager.updateLayers(),"webgpu"!==this.device?.type&&this._pickAndCallback(),this.redraw(),this.viewManager&&this.viewManager.updateViewStates()}_onViewStateChange(e){const t=this.props.onViewStateChange(e)||e.viewState;this.viewState&&(this.viewState={...this.viewState,[e.viewId]:t},this.props.viewState||this.viewManager&&this.viewManager.setProps({viewState:this.viewState}))}_onInteractionStateChange(e){this.cursorState.isDragging=e.isDragging||!1,this.props.onInteractionStateChange(e)}_getFrameStats(){const{stats:e}=this;e.get("frameRate").timeEnd(),e.get("frameRate").timeStart();const t=this.animationLoop.stats;e.get("GPU Time").addTime(t.get("GPU Time").lastTiming),e.get("CPU Time").addTime(t.get("CPU Time").lastTiming)}_getMetrics(){const{metrics:e,stats:t}=this;e.fps=t.get("frameRate").getHz(),e.setPropsTime=t.get("setProps Time").time,e.updateAttributesTime=t.get("Update Attributes").time,e.framesRedrawn=t.get("Redraw Count").count,e.pickTime=t.get("pickObject Time").time+t.get("pickMultipleObjects Time").time+t.get("pickObjects Time").time,e.pickCount=t.get("Pick Count").count,e.gpuTime=t.get("GPU Time").time,e.cpuTime=t.get("CPU Time").time,e.gpuTimePerFrame=t.get("GPU Time").getAverageTime(),e.cpuTimePerFrame=t.get("CPU Time").getAverageTime();const n=PS.stats.get("Memory Usage");e.bufferMemory=n.get("Buffer Memory").count,e.textureMemory=n.get("Texture Memory").count,e.renderbufferMemory=n.get("Renderbuffer Memory").count,e.gpuMemory=n.get("GPU Memory").count}}nO.defaultProps=tO,nO.VERSION=mC;const rO=pE;function oO(e,t,n){const r="webgpu"===n&&"uint8"===t.type?"unorm8":t.type;return{attribute:e,format:t.size>1?`${r}x${t.size}`:t.type,byteOffset:t.offset||0}}function iO(e){return e.stride||e.size*e.bytesPerElement}function sO(e,t){t.offset&&AC.removed("shaderAttribute.offset","vertexOffset, elementOffset")();const n=iO(e),r=(void 0!==t.vertexOffset?t.vertexOffset:e.vertexOffset||0)*n+(t.elementOffset||0)*e.bytesPerElement+(e.offset||0);return{...t,offset:r,stride:n}}class aO{constructor(e,t,n){this._buffer=null,this.device=e,this.id=t.id||"",this.size=t.size||1;const r=t.logicalType||t.type,o="float64"===r;let i,{defaultValue:s}=t;s=Number.isFinite(s)?[s]:s||new Array(this.size).fill(0),i=o?"float32":!r&&t.isIndexed?"uint32":r||"float32";let a=function(e){switch(e){case"float64":return Float64Array;case"uint8":case"unorm8":return Uint8ClampedArray;default:return fE(e)}}(r||i);this.doublePrecision=o,o&&!1===t.fp64&&(a=Float32Array),this.value=null,this.settings={...t,defaultType:a,defaultValue:s,logicalType:r,type:i,normalized:i.includes("norm"),size:this.size,bytesPerElement:a.BYTES_PER_ELEMENT},this.state={...n,externalBuffer:null,bufferAccessor:this.settings,allocatedValue:null,numInstances:0,bounds:null,constant:!1}}get isConstant(){return this.state.constant}get buffer(){return this._buffer}get byteOffset(){const e=this.getAccessor();return e.vertexOffset?e.vertexOffset*iO(e):0}get numInstances(){return this.state.numInstances}set numInstances(e){this.state.numInstances=e}delete(){this._buffer&&(this._buffer.delete(),this._buffer=null),qP.release(this.state.allocatedValue)}getBuffer(){return this.state.constant?null:this.state.externalBuffer||this._buffer}getValue(e=this.id,t=null){const n={};if(this.state.constant){const r=this.value;if(t){const o=sO(this.getAccessor(),t),i=o.offset/r.BYTES_PER_ELEMENT,s=o.size||this.size;n[e]=r.subarray(i,i+s)}else n[e]=r}else n[e]=this.getBuffer();return this.doublePrecision&&(this.value instanceof Float64Array?n[`${e}64Low`]=n[e]:n[`${e}64Low`]=new Float32Array(this.size)),n}_getBufferLayout(e=this.id,t=null){const n=this.getAccessor(),r=[],o={name:this.id,byteStride:iO(n),attributes:r};if(this.doublePrecision){const o=function(e,t){const n=sO(e,t);return{high:n,low:{...n,offset:n.offset+4*e.size}}}(n,t||{});r.push(oO(e,{...n,...o.high},this.device.type),oO(`${e}64Low`,{...n,...o.low},this.device.type))}else if(t){const o=sO(n,t);r.push(oO(e,{...n,...o},this.device.type))}else r.push(oO(e,n,this.device.type));return o}setAccessor(e){this.state.bufferAccessor=e}getAccessor(){return this.state.bufferAccessor}getBounds(){if(this.state.bounds)return this.state.bounds;let e=null;if(this.state.constant&&this.value){const t=Array.from(this.value);e=[t,t]}else{const{value:t,numInstances:n,size:r}=this,o=n*r;if(t&&o&&t.length>=o){const n=new Array(r).fill(1/0),i=new Array(r).fill(-1/0);for(let e=0;e<o;)for(let o=0;o<r;o++){const r=t[e++];r<n[o]&&(n[o]=r),r>i[o]&&(i[o]=r)}e=[n,i]}}return this.state.bounds=e,e}setData(e){const{state:t}=this;let n;n=ArrayBuffer.isView(e)?{value:e}:e instanceof oS?{buffer:e}:e;const r={...this.settings,...n};if(ArrayBuffer.isView(n.value)){if(!n.type){if(this.doublePrecision&&n.value instanceof Float64Array)r.type="float32";else{const e=rO(n.value);r.type=r.normalized?e.replace("int","norm"):e}}r.bytesPerElement=n.value.BYTES_PER_ELEMENT,r.stride=iO(r)}if(t.bounds=null,n.constant){let e=n.value;e=this._normalizeValue(e,[],0),this.settings.normalized&&(e=this.normalizeConstant(e));if(!(!t.constant||!this._areValuesEqual(e,this.value)))return!1;t.externalBuffer=null,t.constant=!0,this.value=ArrayBuffer.isView(e)?e:new Float32Array(e)}else if(n.buffer){const e=n.buffer;t.externalBuffer=e,t.constant=!1,this.value=n.value||null}else if(n.value){this._checkExternalBuffer(n);let e=n.value;t.externalBuffer=null,t.constant=!1,this.value=e;let{buffer:o}=this;const i=iO(r),s=(r.vertexOffset||0)*i;if(this.doublePrecision&&e instanceof Float64Array&&(e=nF(e,r)),this.settings.isIndexed){const t=this.settings.defaultType;e.constructor!==t&&(e=new t(e))}const a=e.byteLength+s+2*i;(!o||o.byteLength<a)&&(o=this._createBuffer(a)),o.write(e,s)}return this.setAccessor(r),!0}updateSubBuffer(e={}){this.state.bounds=null;const t=this.value,{startOffset:n=0,endOffset:r}=e;this.buffer.write(this.doublePrecision&&t instanceof Float64Array?nF(t,{size:this.size,startIndex:n,endIndex:r}):t.subarray(n,r),n*t.BYTES_PER_ELEMENT+this.byteOffset)}allocate(e,t=!1){const{state:n}=this,r=n.allocatedValue,o=qP.allocate(r,e+1,{size:this.size,type:this.settings.defaultType,copy:t});this.value=o;const{byteOffset:i}=this;let{buffer:s}=this;return(!s||s.byteLength<o.byteLength+i)&&(s=this._createBuffer(o.byteLength+i),t&&r&&s.write(r instanceof Float64Array?nF(r,this):r,i)),n.allocatedValue=o,n.constant=!1,n.externalBuffer=null,this.setAccessor(this.settings),!0}_checkExternalBuffer(e){const{value:t}=e;if(!ArrayBuffer.isView(t))throw new Error(`Attribute ${this.id} value is not TypedArray`);const n=this.settings.defaultType;let r=!1;if(this.doublePrecision&&(r=t.BYTES_PER_ELEMENT<4),r)throw new Error(`Attribute ${this.id} does not support ${t.constructor.name}`);t instanceof n||!this.settings.normalized||"normalized"in e||AC.warn(`Attribute ${this.id} is normalized`)()}normalizeConstant(e){switch(this.settings.type){case"snorm8":return new Float32Array(e).map(e=>(e+128)/255*2-1);case"snorm16":return new Float32Array(e).map(e=>(e+32768)/65535*2-1);case"unorm8":return new Float32Array(e).map(e=>e/255);case"unorm16":return new Float32Array(e).map(e=>e/65535);default:return e}}_normalizeValue(e,t,n){const{defaultValue:r,size:o}=this.settings;if(Number.isFinite(e))return t[n]=e,t;if(!e){let e=o;for(;--e>=0;)t[n+e]=r[e];return t}switch(o){case 4:t[n+3]=Number.isFinite(e[3])?e[3]:r[3];case 3:t[n+2]=Number.isFinite(e[2])?e[2]:r[2];case 2:t[n+1]=Number.isFinite(e[1])?e[1]:r[1];case 1:t[n+0]=Number.isFinite(e[0])?e[0]:r[0];break;default:let i=o;for(;--i>=0;)t[n+i]=Number.isFinite(e[i])?e[i]:r[i]}return t}_areValuesEqual(e,t){if(!e||!t)return!1;const{size:n}=this;for(let r=0;r<n;r++)if(e[r]!==t[r])return!1;return!0}_createBuffer(e){this._buffer&&this._buffer.destroy();const{isIndexed:t,type:n}=this.settings;return this._buffer=this.device.createBuffer({...this._buffer?.props,id:this.id,usage:(t?oS.INDEX:oS.VERTEX)|oS.COPY_DST,indexType:t?n:void 0,byteLength:e}),this._buffer}}const lO=[],cO=[];function uO(e,t=0,n=1/0){let r=lO;const o={index:-1,data:e,target:[]};return e?"function"==typeof e[Symbol.iterator]?r=e:e.length>0&&(cO.length=e.length,r=cO):r=lO,(t>0||Number.isFinite(n))&&(r=(Array.isArray(r)?r:Array.from(r)).slice(t,n),o.index=t-1),{iterable:r,objectInfo:o}}function dO(e){return e&&e[Symbol.asyncIterator]}function AO(e,t){const{size:n,stride:r,offset:o,startIndices:i,nested:s}=t,a=e.BYTES_PER_ELEMENT,l=r?r/a:n,c=o?o/a:0,u=Math.floor((e.length-c)/l);return(t,{index:r,target:o})=>{if(!i){const t=r*l+c;for(let r=0;r<n;r++)o[r]=e[t+r];return o}const a=i[r],d=i[r+1]||u;let A;if(s){A=new Array(d-a);for(let t=a;t<d;t++){const r=t*l+c;o=new Array(n);for(let t=0;t<n;t++)o[t]=e[r+t];A[t-a]=o}}else if(l===n)A=e.subarray(a*n+c,d*n+c);else{A=new e.constructor((d-a)*n);let t=0;for(let r=a;r<d;r++){const o=r*l+c;for(let r=0;r<n;r++)A[t++]=e[o+r]}}return A}}const hO=[],pO=[[0,1/0]];const fO={interpolation:{duration:0,easing:e=>e},spring:{stiffness:.05,damping:.5}};function gO(e,t){if(!e)return null;Number.isFinite(e)&&(e={type:"interpolation",duration:e});const n=e.type||"interpolation";return{...fO[n],...t,...e,type:n}}class mO extends aO{constructor(e,t){super(e,t,{startIndices:null,lastExternalBuffer:null,binaryValue:null,binaryAccessor:null,needsUpdate:!0,needsRedraw:!1,layoutChanged:!1,updateRanges:pO}),this.constant=!1,this.settings.update=t.update||(t.accessor?this._autoUpdater:void 0),Object.seal(this.settings),Object.seal(this.state),this._validateAttributeUpdaters()}get startIndices(){return this.state.startIndices}set startIndices(e){this.state.startIndices=e}needsUpdate(){return this.state.needsUpdate}needsRedraw({clearChangedFlags:e=!1}={}){const t=this.state.needsRedraw;return this.state.needsRedraw=t&&!e,t}layoutChanged(){return this.state.layoutChanged}setAccessor(e){var t,n,r;(t=this.state).layoutChanged||(t.layoutChanged=(n=e,r=this.getAccessor(),!(n.type===r.type&&n.size===r.size&&iO(n)===iO(r)&&(n.offset||0)===(r.offset||0)))),super.setAccessor(e)}getUpdateTriggers(){const{accessor:e}=this.settings;return[this.id].concat("function"!=typeof e&&e||[])}supportsTransition(){return Boolean(this.settings.transition)}getTransitionSetting(e){if(!e||!this.supportsTransition())return null;const{accessor:t}=this.settings,n=this.settings.transition;return gO(Array.isArray(t)?e[t.find(t=>e[t])]:e[t],n)}setNeedsUpdate(e=this.id,t){if(this.state.needsUpdate=this.state.needsUpdate||e,this.setNeedsRedraw(e),t){const{startRow:e=0,endRow:n=1/0}=t;this.state.updateRanges=function(e,t){if(e===pO)return e;if(t[0]<0&&(t[0]=0),t[0]>=t[1])return e;const n=[],r=e.length;let o=0;for(let i=0;i<r;i++){const r=e[i];r[1]<t[0]?(n.push(r),o=i+1):r[0]>t[1]?n.push(r):t=[Math.min(r[0],t[0]),Math.max(r[1],t[1])]}return n.splice(o,0,t),n}(this.state.updateRanges,[e,n])}else this.state.updateRanges=pO}clearNeedsUpdate(){this.state.needsUpdate=!1,this.state.updateRanges=hO}setNeedsRedraw(e=this.id){this.state.needsRedraw=this.state.needsRedraw||e}allocate(e){const{state:t,settings:n}=this;return!n.noAlloc&&(!!n.update&&(super.allocate(e,t.updateRanges!==pO),!0))}updateBuffer({numInstances:e,data:t,props:n,context:r}){if(!this.needsUpdate())return!1;const{state:{updateRanges:o},settings:{update:i,noAlloc:s}}=this;let a=!0;if(i){for(const[s,a]of o)i.call(r,this,{data:t,startRow:s,endRow:a,props:n,numInstances:e});if(this.value)if(this.constant||!this.buffer||this.buffer.byteLength<this.value.byteLength+this.byteOffset)this.setData({value:this.value,constant:this.constant}),this.constant=!1;else for(const[t,n]of o){const r=Number.isFinite(t)?this.getVertexOffset(t):0,o=Number.isFinite(n)?this.getVertexOffset(n):s||!Number.isFinite(e)?this.value.length:e*this.size;super.updateSubBuffer({startOffset:r,endOffset:o})}else;this._checkAttributeArray()}else a=!1;return this.clearNeedsUpdate(),this.setNeedsRedraw(),a}setConstantValue(e){if("webgpu"===this.device.type||void 0===e||"function"==typeof e)return!1;return this.setData({constant:!0,value:e})&&this.setNeedsRedraw(),this.clearNeedsUpdate(),!0}setExternalBuffer(e){const{state:t}=this;return e?(this.clearNeedsUpdate(),t.lastExternalBuffer===e||(t.lastExternalBuffer=e,this.setNeedsRedraw(),this.setData(e)),!0):(t.lastExternalBuffer=null,!1)}setBinaryValue(e,t=null){const{state:n,settings:r}=this;if(!e)return n.binaryValue=null,n.binaryAccessor=null,!1;if(r.noAlloc)return!1;if(n.binaryValue===e)return this.clearNeedsUpdate(),!0;n.binaryValue=e,this.setNeedsRedraw();if(r.transform||t!==this.startIndices){ArrayBuffer.isView(e)&&(e={value:e});const o=e;bM(ArrayBuffer.isView(o.value),`invalid ${r.accessor}`);const i=Boolean(o.size)&&o.size!==this.size;return n.binaryAccessor=AO(o.value,{size:o.size||this.size,stride:o.stride,offset:o.offset,startIndices:t,nested:i}),!1}return this.clearNeedsUpdate(),this.setData(e),!0}getVertexOffset(e){const{startIndices:t}=this;return(t?e<t.length?t[e]:this.numInstances:e)*this.size}getValue(){const e=this.settings.shaderAttributes,t=super.getValue();if(!e)return t;for(const n in e)Object.assign(t,super.getValue(n,e[n]));return t}getBufferLayout(e){this.state.layoutChanged=!1;const t=this.settings.shaderAttributes,n=super._getBufferLayout(),{stepMode:r}=this.settings;if(n.stepMode="dynamic"===r?e?e.isInstanced?"instance":"vertex":"instance":r??"vertex",!t)return n;for(const o in t){const e=super._getBufferLayout(o,t[o]);n.attributes.push(...e.attributes)}return n}_autoUpdater(e,{data:t,startRow:n,endRow:r,props:o,numInstances:i}){if(e.constant&&"webgpu"!==this.context.device.type)return;const{settings:s,state:a,value:l,size:c,startIndices:u}=e,{accessor:d,transform:A}=s;let h=a.binaryAccessor||("function"==typeof d?d:o[d]);"function"!=typeof h&&(h=()=>h),bM("function"==typeof h,`accessor "${d}" is not a function`);let p=e.getVertexOffset(n);const{iterable:f,objectInfo:g}=uO(t,n,r);for(const m of f){g.index++;let t=h(m,g);if(A&&(t=A.call(this,t)),u){const n=(g.index<u.length-1?u[g.index+1]:i)-u[g.index];if(t&&Array.isArray(t[0])){let n=p;for(const r of t)e._normalizeValue(r,l,n),n+=c}else t&&t.length>c?l.set(t,p):(e._normalizeValue(t,g.target,0),rM({target:l,source:g.target,start:p,count:n}));p+=n*c}else e._normalizeValue(t,l,p),p+=c}}_validateAttributeUpdaters(){const{settings:e}=this;if(!(e.noAlloc||"function"==typeof e.update))throw new Error(`Attribute ${this.id} missing update or accessor`)}_checkAttributeArray(){const{value:e}=this,t=Math.min(4,this.size);if(e&&e.length>=t){let n=!0;switch(t){case 4:n=n&&Number.isFinite(e[3]);case 3:n=n&&Number.isFinite(e[2]);case 2:n=n&&Number.isFinite(e[1]);case 1:n=n&&Number.isFinite(e[0]);break;default:n=!1}if(!n)throw new Error(`Illegal attribute generated for ${this.id}`)}}}function yO(e){const{source:t,target:n,start:r=0,size:o,getData:i}=e,s=e.end||n.length,a=t.length,l=s-r;if(a>l)return void n.set(t.subarray(0,l),r);if(n.set(t,r),!i)return;let c=a;for(;c<l;){const e=i(c,t);for(let t=0;t<o;t++)n[r+c]=e[t]||0,c++}}function vO(e){switch(e){case 1:return"float";case 2:return"vec2";case 3:return"vec3";case 4:return"vec4";default:throw new Error(`No defined attribute type for size "${e}"`)}}function bO(e){switch(e){case 1:return"float32";case 2:return"float32x2";case 3:return"float32x3";case 4:return"float32x4";default:throw new Error("invalid type size")}}function wO(e){e.push(e.shift())}function xO({device:e,source:t,target:n}){return(!n||n.byteLength<t.byteLength)&&(n?.destroy(),n=e.createBuffer({byteLength:t.byteLength,usage:t.usage})),n}function _O({device:e,buffer:t,attribute:n,fromLength:r,toLength:o,fromStartIndices:i,getData:s=e=>e}){const a=n.doublePrecision&&n.value instanceof Float64Array?2:1,l=n.size*a,c=n.byteOffset,u=n.settings.bytesPerElement<4?c/n.settings.bytesPerElement*4:c,d=n.startIndices,A=i&&d,h=n.isConstant;if(!A&&t&&r>=o)return t;const p=n.value instanceof Float64Array?Float32Array:n.value.constructor,f=h?n.value:new p(n.getBuffer().readSyncWebGL(c,o*p.BYTES_PER_ELEMENT).buffer);if(n.settings.normalized&&!h){const e=s;s=(t,r)=>n.normalizeConstant(e(t,r))}const g=h?(e,t)=>s(f,t):(e,t)=>s(f.subarray(e+c,e+c+l),t),m=t?new Float32Array(t.readSyncWebGL(u,4*r).buffer):new Float32Array(0),y=new Float32Array(o);return function({source:e,target:t,size:n,getData:r,sourceStartIndices:o,targetStartIndices:i}){if(!o||!i)return yO({source:e,target:t,size:n,getData:r}),t;let s=0,a=0;const l=r&&((e,t)=>r(e+a,t)),c=Math.min(o.length,i.length);for(let u=1;u<c;u++){const r=o[u]*n,c=i[u]*n;yO({source:e.subarray(s,r),target:t,start:a,end:c,size:n,getData:l}),s=r,a=c}a<t.length&&yO({source:[],target:t,start:a,size:n,getData:l})}({source:m,target:y,sourceStartIndices:i,targetStartIndices:d,size:l,getData:g}),(!t||t.byteLength<y.byteLength+u)&&(t?.destroy(),t=e.createBuffer({byteLength:y.byteLength+u,usage:35050})),t.write(y,u),t}class CO{constructor({device:e,attribute:t,timeline:n}){this.buffers=[],this.currentLength=0,this.device=e,this.transition=new hM(n),this.attribute=t,this.attributeInTransition=function(e){const{device:t,settings:n,value:r}=e,o=new mO(t,n);return o.setData({value:r instanceof Float64Array?new Float64Array(0):new Float32Array(0),normalized:n.normalized}),o}(t),this.currentStartIndices=t.startIndices}get inProgress(){return this.transition.inProgress}start(e,t,n=1/0){this.settings=e,this.currentStartIndices=this.attribute.startIndices,this.currentLength=function(e,t){const{doublePrecision:n,settings:r,value:o,size:i}=e,s=n&&o instanceof Float64Array?2:1;let a=0;const{shaderAttributes:l}=e.settings;if(l)for(const c of Object.values(l))a=Math.max(a,c.vertexOffset??0);return(r.noAlloc?o.length:(t+a)*i)*s}(this.attribute,t),this.transition.start({...e,duration:n})}update(){const e=this.transition.update();return e&&this.onUpdate(),e}setBuffer(e){this.attributeInTransition.setData({buffer:e,normalized:this.attribute.settings.normalized,value:this.attributeInTransition.value})}cancel(){this.transition.cancel()}delete(){this.cancel();for(const e of this.buffers)e.destroy();this.buffers.length=0}}const SO={name:"interpolation",vs:"uniform interpolationUniforms {\n  float time;\n} interpolation;\n",uniformTypes:{time:"f32"}},EO="#version 300 es\n#define SHADER_NAME interpolation-transition-vertex-shader\n\nin ATTRIBUTE_TYPE aFrom;\nin ATTRIBUTE_TYPE aTo;\nout ATTRIBUTE_TYPE vCurrent;\n\nvoid main(void) {\n  vCurrent = mix(aFrom, aTo, interpolation.time);\n  gl_Position = vec4(0.0);\n}\n",BO="#version 300 es\n#define SHADER_NAME interpolation-transition-vertex-shader\n\nin ATTRIBUTE_TYPE aFrom;\nin ATTRIBUTE_TYPE aFrom64Low;\nin ATTRIBUTE_TYPE aTo;\nin ATTRIBUTE_TYPE aTo64Low;\nout ATTRIBUTE_TYPE vCurrent;\nout ATTRIBUTE_TYPE vCurrent64Low;\n\nvec2 mix_fp64(vec2 a, vec2 b, float x) {\n  vec2 range = sub_fp64(b, a);\n  return sum_fp64(a, mul_fp64(range, vec2(x, 0.0)));\n}\n\nvoid main(void) {\n  for (int i=0; i<ATTRIBUTE_SIZE; i++) {\n    vec2 value = mix_fp64(vec2(aFrom[i], aFrom64Low[i]), vec2(aTo[i], aTo64Low[i]), interpolation.time);\n    vCurrent[i] = value.x;\n    vCurrent64Low[i] = value.y;\n  }\n  gl_Position = vec4(0.0);\n}\n";function IO(e){return e.doublePrecision&&e.value instanceof Float64Array}const RO={name:"spring",vs:"uniform springUniforms {\n  float damping;\n  float stiffness;\n} spring;\n",uniformTypes:{damping:"f32",stiffness:"f32"}},kO="#version 300 es\n#define SHADER_NAME spring-transition-vertex-shader\n\n#define EPSILON 0.00001\n\nin ATTRIBUTE_TYPE aPrev;\nin ATTRIBUTE_TYPE aCur;\nin ATTRIBUTE_TYPE aTo;\nout ATTRIBUTE_TYPE vNext;\nout float vIsTransitioningFlag;\n\nATTRIBUTE_TYPE getNextValue(ATTRIBUTE_TYPE cur, ATTRIBUTE_TYPE prev, ATTRIBUTE_TYPE dest) {\n  ATTRIBUTE_TYPE velocity = cur - prev;\n  ATTRIBUTE_TYPE delta = dest - cur;\n  ATTRIBUTE_TYPE force = delta * spring.stiffness;\n  ATTRIBUTE_TYPE resistance = velocity * spring.damping;\n  return force - resistance + velocity + cur;\n}\n\nvoid main(void) {\n  bool isTransitioning = length(aCur - aPrev) > EPSILON || length(aTo - aCur) > EPSILON;\n  vIsTransitioningFlag = isTransitioning ? 1.0 : 0.0;\n\n  vNext = getNextValue(aCur, aPrev, aTo);\n  gl_Position = vec4(0, 0, 0, 1);\n  gl_PointSize = 100.0;\n}\n",TO="#version 300 es\n#define SHADER_NAME spring-transition-is-transitioning-fragment-shader\n\nin float vIsTransitioningFlag;\n\nout vec4 fragColor;\n\nvoid main(void) {\n  if (vIsTransitioningFlag == 0.0) {\n    discard;\n  }\n  fragColor = vec4(1.0);\n}";const PO={interpolation:class extends CO{constructor({device:e,attribute:t,timeline:n}){super({device:e,attribute:t,timeline:n}),this.type="interpolation",this.transform=function(e,t){const n=t.size,r=vO(n),o=bO(n),i=t.getBufferLayout();if(IO(t))return new DF(e,{vs:BO,bufferLayout:[{name:"aFrom",byteStride:8*n,attributes:[{attribute:"aFrom",format:o,byteOffset:0},{attribute:"aFrom64Low",format:o,byteOffset:4*n}]},{name:"aTo",byteStride:8*n,attributes:[{attribute:"aTo",format:o,byteOffset:0},{attribute:"aTo64Low",format:o,byteOffset:4*n}]}],modules:[dk,SO],defines:{ATTRIBUTE_TYPE:r,ATTRIBUTE_SIZE:n},moduleSettings:{},varyings:["vCurrent","vCurrent64Low"],bufferMode:35980,disableWarnings:!0});return new DF(e,{vs:EO,bufferLayout:[{name:"aFrom",format:o},{name:"aTo",format:i.attributes[0].format}],modules:[SO],defines:{ATTRIBUTE_TYPE:r},varyings:["vCurrent"],disableWarnings:!0})}(e,t)}start(e,t){const n=this.currentLength,r=this.currentStartIndices;if(super.start(e,t,e.duration),e.duration<=0)return void this.transition.cancel();const{buffers:o,attribute:i}=this;wO(o),o[0]=_O({device:this.device,buffer:o[0],attribute:i,fromLength:n,toLength:this.currentLength,fromStartIndices:r,getData:e.enter}),o[1]=xO({device:this.device,source:o[0],target:o[1]}),this.setBuffer(o[1]);const{transform:s}=this,a=s.model;let l=Math.floor(this.currentLength/i.size);IO(i)&&(l/=2),a.setVertexCount(l),i.isConstant?(a.setAttributes({aFrom:o[0]}),a.setConstantAttributes({aTo:i.value})):a.setAttributes({aFrom:o[0],aTo:i.getBuffer()}),s.transformFeedback.setBuffers({vCurrent:o[1]})}onUpdate(){const{duration:e,easing:t}=this.settings,{time:n}=this.transition;let r=n/e;t&&(r=t(r));const{model:o}=this.transform,i={time:r};o.shaderInputs.setProps({interpolation:i}),this.transform.run({discard:!0})}delete(){super.delete(),this.transform.destroy()}},spring:class extends CO{constructor({device:e,attribute:t,timeline:n}){super({device:e,attribute:t,timeline:n}),this.type="spring",this.texture=function(e){return e.createTexture({data:new Uint8Array(4),format:"rgba8unorm",mipmaps:!1,width:1,height:1})}(e),this.framebuffer=function(e,t){return e.createFramebuffer({id:"spring-transition-is-transitioning-framebuffer",width:1,height:1,colorAttachments:[t]})}(e,this.texture),this.transform=function(e,t){const n=vO(t.size),r=bO(t.size);return new DF(e,{vs:kO,fs:TO,bufferLayout:[{name:"aPrev",format:r},{name:"aCur",format:r},{name:"aTo",format:t.getBufferLayout().attributes[0].format}],varyings:["vNext"],modules:[RO],defines:{ATTRIBUTE_TYPE:n},parameters:{depthCompare:"always",blendColorOperation:"max",blendColorSrcFactor:"one",blendColorDstFactor:"one",blendAlphaOperation:"max",blendAlphaSrcFactor:"one",blendAlphaDstFactor:"one"}})}(e,t)}start(e,t){const n=this.currentLength,r=this.currentStartIndices;super.start(e,t);const{buffers:o,attribute:i}=this;for(let a=0;a<2;a++)o[a]=_O({device:this.device,buffer:o[a],attribute:i,fromLength:n,toLength:this.currentLength,fromStartIndices:r,getData:e.enter});o[2]=xO({device:this.device,source:o[0],target:o[2]}),this.setBuffer(o[1]);const{model:s}=this.transform;s.setVertexCount(Math.floor(this.currentLength/i.size)),i.isConstant?s.setConstantAttributes({aTo:i.value}):s.setAttributes({aTo:i.getBuffer()})}onUpdate(){const{buffers:e,transform:t,framebuffer:n,transition:r}=this,o=this.settings;t.model.setAttributes({aPrev:e[0],aCur:e[1]}),t.transformFeedback.setBuffers({vNext:e[2]});const i={stiffness:o.stiffness,damping:o.damping};t.model.shaderInputs.setProps({spring:i}),t.run({framebuffer:n,discard:!1,parameters:{viewport:[0,0,1,1]},clearColor:[0,0,0,0]}),wO(e),this.setBuffer(e[1]);this.device.readPixelsToArrayWebGL(n)[0]>0||r.end()}delete(){super.delete(),this.transform.destroy(),this.texture.destroy(),this.framebuffer.destroy()}}};class FO{constructor(e,{id:t,timeline:n}){if(!e)throw new Error("AttributeTransitionManager is constructed without device");this.id=t,this.device=e,this.timeline=n,this.transitions={},this.needsRedraw=!1,this.numInstances=1}finalize(){for(const e in this.transitions)this._removeTransition(e)}update({attributes:e,transitions:t,numInstances:n}){this.numInstances=n||1;for(const r in e){const n=e[r],o=n.getTransitionSetting(t);o&&this._updateAttribute(r,n,o)}for(const r in this.transitions){const n=e[r];n&&n.getTransitionSetting(t)||this._removeTransition(r)}}hasAttribute(e){const t=this.transitions[e];return t&&t.inProgress}getAttributes(){const e={};for(const t in this.transitions){const n=this.transitions[t];n.inProgress&&(e[t]=n.attributeInTransition)}return e}run(){if(0===this.numInstances)return!1;for(const t in this.transitions){this.transitions[t].update()&&(this.needsRedraw=!0)}const e=this.needsRedraw;return this.needsRedraw=!1,e}_removeTransition(e){this.transitions[e].delete(),delete this.transitions[e]}_updateAttribute(e,t,n){const r=this.transitions[e];let o=!r||r.type!==n.type;if(o){r&&this._removeTransition(e);const i=PO[n.type];i?this.transitions[e]=new i({attribute:t,timeline:this.timeline,device:this.device}):(AC.error(`unsupported transition type '${n.type}'`)(),o=!1)}(o||t.needsRedraw())&&(this.needsRedraw=!0,this.transitions[e].start(n,this.numInstances))}}const MO="attributeManager.invalidate";class LO{constructor(e,{id:t="attribute-manager",stats:n,timeline:r}={}){this.mergeBoundsMemoized=FT(rF),this.id=t,this.device=e,this.attributes={},this.updateTriggers={},this.needsRedraw=!0,this.userData={},this.stats=n,this.attributeTransitionManager=new FO(e,{id:`${t}-transitions`,timeline:r}),Object.seal(this)}finalize(){for(const e in this.attributes)this.attributes[e].delete();this.attributeTransitionManager.finalize()}getNeedsRedraw(e={clearRedrawFlags:!1}){const t=this.needsRedraw;return this.needsRedraw=this.needsRedraw&&!e.clearRedrawFlags,t&&this.id}setNeedsRedraw(){this.needsRedraw=!0}add(e){this._add(e)}addInstanced(e){this._add(e,{stepMode:"instance"})}remove(e){for(const t of e)void 0!==this.attributes[t]&&(this.attributes[t].delete(),delete this.attributes[t])}invalidate(e,t){const n=this._invalidateTrigger(e,t);fC(MO,this,e,n)}invalidateAll(e){for(const t in this.attributes)this.attributes[t].setNeedsUpdate(t,e);fC(MO,this,"all")}update({data:e,numInstances:t,startIndices:n=null,transitions:r,props:o={},buffers:i={},context:s={}}){let a=!1;fC("attributeManager.updateStart",this),this.stats&&this.stats.get("Update Attributes").timeStart();for(const l in this.attributes){const r=this.attributes[l],c=r.settings.accessor;r.startIndices=n,r.numInstances=t,o[l]&&AC.removed(`props.${l}`,`data.attributes.${l}`)(),r.setExternalBuffer(i[l])||r.setBinaryValue("string"==typeof c?i[c]:void 0,e.startIndices)||"string"==typeof c&&!i[c]&&r.setConstantValue(o[c])||r.needsUpdate()&&(a=!0,this._updateAttribute({attribute:r,numInstances:t,data:e,props:o,context:s})),this.needsRedraw=this.needsRedraw||r.needsRedraw()}a&&fC("attributeManager.updateEnd",this,t),this.stats&&this.stats.get("Update Attributes").timeEnd(),this.attributeTransitionManager.update({attributes:this.attributes,numInstances:t,transitions:r})}updateTransition(){const{attributeTransitionManager:e}=this,t=e.run();return this.needsRedraw=this.needsRedraw||t,t}getAttributes(){return{...this.attributes,...this.attributeTransitionManager.getAttributes()}}getBounds(e){const t=e.map(e=>this.attributes[e]?.getBounds());return this.mergeBoundsMemoized(t)}getChangedAttributes(e={clearChangedFlags:!1}){const{attributes:t,attributeTransitionManager:n}=this,r={...n.getAttributes()};for(const o in t){const i=t[o];i.needsRedraw(e)&&!n.hasAttribute(o)&&(r[o]=i)}return r}getBufferLayouts(e){return Object.values(this.getAttributes()).map(t=>t.getBufferLayout(e))}_add(e,t){for(const n in e){const r=e[n],o={...r,id:n,size:(r.isIndexed?1:r.size)||1,...t};this.attributes[n]=new mO(this.device,o)}this._mapUpdateTriggersToAttributes()}_mapUpdateTriggersToAttributes(){const e={};for(const t in this.attributes){this.attributes[t].getUpdateTriggers().forEach(n=>{e[n]||(e[n]=[]),e[n].push(t)})}this.updateTriggers=e}_invalidateTrigger(e,t){const{attributes:n,updateTriggers:r}=this,o=r[e];return o&&o.forEach(e=>{const r=n[e];r&&r.setNeedsUpdate(r.id,t)}),o}_updateAttribute(e){const{attribute:t,numInstances:n}=e;if(fC("attribute.updateStart",t),t.constant)return void t.setConstantValue(t.value);t.allocate(n)&&fC("attribute.allocate",t,n);t.updateBuffer(e)&&(this.needsRedraw=!0,fC("attribute.updateEnd",t,n))}}const UO=1e-5;function OO(e,t,n,r,o){const i=t-e;return(n-t)*o+-i*r+i+t}function DO(e,t){if(Array.isArray(e)){let n=0;for(let r=0;r<e.length;r++){const o=e[r]-t[r];n+=o*o}return Math.sqrt(n)}return Math.abs(e-t)}const NO={interpolation:class extends hM{get value(){return this._value}_onUpdate(){const{time:e,settings:{fromValue:t,toValue:n,duration:r,easing:o}}=this,i=o(e/r);this._value=QI(t,n,i)}},spring:class extends hM{get value(){return this._currValue}_onUpdate(){const{fromValue:e,toValue:t,damping:n,stiffness:r}=this.settings,{_prevValue:o=e,_currValue:i=e}=this;let s=function(e,t,n,r,o){if(Array.isArray(n)){const i=[];for(let s=0;s<n.length;s++)i[s]=OO(e[s],t[s],n[s],r,o);return i}return OO(e,t,n,r,o)}(o,i,t,n,r);const a=DO(s,t),l=DO(s,i);a<UO&&l<UO&&(s=t,this.end()),this._prevValue=i,this._currValue=s}}};class jO{constructor(e){this.transitions=new Map,this.timeline=e}get active(){return this.transitions.size>0}add(e,t,n,r){const{transitions:o}=this;if(o.has(e)){const n=o.get(e),{value:r=n.settings.fromValue}=n;t=r,this.remove(e)}if(!(r=gO(r)))return;const i=NO[r.type];if(!i)return void AC.error(`unsupported transition type '${r.type}'`)();const s=new i(this.timeline);s.start({...r,fromValue:t,toValue:n}),o.set(e,s)}remove(e){const{transitions:t}=this;t.has(e)&&(t.get(e).cancel(),t.delete(e))}update(){const e={};for(const[t,n]of this.transitions)n.update(),e[t]=n.value,n.inProgress||this.remove(t);return e}clear(){for(const e of this.transitions.keys())this.remove(e)}}function QO(e,t){const n=HO({newProps:e,oldProps:t,propTypes:e[YF],ignoreProps:{data:null,updateTriggers:null,extensions:null,transitions:null}}),r=function(e,t){if(null===t)return"oldProps is null, initial diff";let n=!1;const{dataComparator:r,_dataDiff:o}=e;r?r(e.data,t.data)||(n="Data comparator detected a change"):e.data!==t.data&&(n="A new data container was supplied");n&&o&&(n=o(e.data,t.data)||n);return n}(e,t);let o=!1;return r||(o=function(e,t){if(null===t)return{all:!0};if("all"in e.updateTriggers){if(WO(e,t,"all"))return{all:!0}}const n={};let r=!1;for(const o in e.updateTriggers)if("all"!==o){WO(e,t,o)&&(n[o]=!0,r=!0)}return!!r&&n}(e,t)),{dataChanged:r,propsChanged:n,updateTriggersChanged:o,extensionsChanged:VO(e,t),transitionsChanged:zO(e,t)}}function zO(e,t){if(!e.transitions)return!1;const n={},r=e[YF];let o=!1;for(const i in e.transitions){const s=r[i],a=s&&s.type;("number"===a||"color"===a||"array"===a)&&GO(e[i],t[i],s)&&(n[i]=!0,o=!0)}return!!o&&n}function HO({newProps:e,oldProps:t,ignoreProps:n={},propTypes:r={},triggerName:o="props"}){if(t===e)return!1;if("object"!=typeof e||null===e)return`${o} changed shallowly`;if("object"!=typeof t||null===t)return`${o} changed shallowly`;for(const i of Object.keys(e))if(!(i in n)){if(!(i in t))return`${o}.${i} added`;const n=GO(e[i],t[i],r[i]);if(n)return`${o}.${i} ${n}`}for(const i of Object.keys(t))if(!(i in n)){if(!(i in e))return`${o}.${i} dropped`;if(!Object.hasOwnProperty.call(e,i)){const n=GO(e[i],t[i],r[i]);if(n)return`${o}.${i} ${n}`}}return!1}function GO(e,t,n){let r=n&&n.equal;return r&&!r(e,t,n)?"changed deeply":r||(r=e&&t&&e.equals,!r||r.call(e,t))?r||t===e?null:"changed shallowly":"changed deeply"}function VO(e,t){if(null===t)return!0;const n=t.extensions,{extensions:r}=e;if(r===n)return!1;if(!n||!r)return!0;if(r.length!==n.length)return!0;for(let o=0;o<r.length;o++)if(!r[o].equals(n[o]))return!0;return!1}function WO(e,t,n){let r=e.updateTriggers[n];r=null==r?{}:r;let o=t.updateTriggers[n];o=null==o?{}:o;return HO({oldProps:o,newProps:r,triggerName:n})}function $O(e){if(null===(t=e)||"object"!=typeof t)throw new Error("count(): argument not an object");var t;if("function"==typeof e.count)return e.count();if(Number.isFinite(e.size))return e.size;if(Number.isFinite(e.length))return e.length;if(function(e){return null!==e&&"object"==typeof e&&e.constructor===Object}(e))return Object.keys(e).length;throw new Error("count(): argument not a container")}function KO(e,t){if(!t)return e;const n={...e,...t};if("defines"in t&&(n.defines={...e.defines,...t.defines}),"modules"in t&&(n.modules=(e.modules||[]).concat(t.modules),t.modules.some(e=>"project64"===e.name))){const e=n.modules.findIndex(e=>"project32"===e.name);e>=0&&n.modules.splice(e,1)}if("inject"in t)if(e.inject){const r={...e.inject};for(const e in t.inject)r[e]=(r[e]||"")+t.inject[e];n.inject=r}else n.inject=t.inject;return n}const XO={minFilter:"linear",mipmapFilter:"linear",magFilter:"linear",addressModeU:"clamp-to-edge",addressModeV:"clamp-to-edge"},YO={};const qO={boolean:{validate:(e,t)=>!0,equal:(e,t,n)=>Boolean(e)===Boolean(t)},number:{validate:(e,t)=>Number.isFinite(e)&&(!("max"in t)||e<=t.max)&&(!("min"in t)||e>=t.min)},color:{validate:(e,t)=>t.optional&&!e||eD(e)&&(3===e.length||4===e.length),equal:(e,t,n)=>aM(e,t,1)},accessor:{validate(e,t){const n=tD(e);return"function"===n||n===tD(t.value)},equal:(e,t,n)=>"function"==typeof t||aM(e,t,1)},array:{validate:(e,t)=>t.optional&&!e||eD(e),equal(e,t,n){const{compare:r}=n,o=Number.isInteger(r)?r:r?1:0;return r?aM(e,t,o):e===t}},object:{equal(e,t,n){if(n.ignore)return!0;const{compare:r}=n,o=Number.isInteger(r)?r:r?1:0;return r?aM(e,t,o):e===t}},function:{validate:(e,t)=>t.optional&&!e||"function"==typeof e,equal:(e,t,n)=>!n.compare&&!1!==n.ignore||e===t},data:{transform:(e,t,n)=>{if(!e)return e;const{dataTransform:r}=n.props;return r?r(e):"string"==typeof e.shape&&e.shape.endsWith("-table")&&Array.isArray(e.data)?e.data:e}},image:{transform:(e,t,n)=>{const r=n.context;return r&&r.device?function(e,t,n,r){if(n instanceof OS)return n;n.constructor&&"Object"!==n.constructor.name&&(n={data:n});let o=null;n.compressed&&(o={minFilter:"linear",mipmapFilter:n.data.length>1?"nearest":"linear"});const i=t.createTexture({...n,sampler:{...XO,...o,...r},mipmaps:!0});return YO[i.id]=e,i}(n.id,r.device,e,{...t.parameters,...n.props.textureParameters}):null},release:(e,t,n)=>{var r,o;r=n.id,(o=e)&&o instanceof OS&&YO[o.id]===r&&(o.delete(),delete YO[o.id])}}};function JO(e,t){switch(tD(t)){case"object":return ZO(e,t);case"array":return ZO(e,{type:"array",value:t,compare:!1});case"boolean":return ZO(e,{type:"boolean",value:t});case"number":return ZO(e,{type:"number",value:t});case"function":return ZO(e,{type:"function",value:t,compare:!0});default:return{name:e,type:"unknown",value:t}}}function ZO(e,t){return"type"in t?{name:e,...qO[t.type],...t}:"value"in t?{name:e,type:tD(t.value),...t}:{name:e,type:"object",value:t}}function eD(e){return Array.isArray(e)||ArrayBuffer.isView(e)}function tD(e){return eD(e)?"array":null===e?"null":typeof e}const nD="_mergedDefaultProps";function rD(e,t){if(!(e instanceof lD.constructor))return{};let n=nD;if(t)for(const o of t){const e=o.constructor;e&&(n+=`:${e.extensionName||e.name}`)}const r=sD(e,n);return r||(e[n]=function(e,t){const n=e.prototype;if(!n)return null;const r=Object.getPrototypeOf(e),o=rD(r),i=sD(e,"defaultProps")||{},s=function(e){const t={},n={},r={};for(const[o,i]of Object.entries(e)){const e=i?.deprecatedFor;if(e)r[o]=Array.isArray(e)?e:[e];else{const e=JO(o,i);t[o]=e,n[o]=e.value}}return{propTypes:t,defaultProps:n,deprecatedProps:r}}(i),a=Object.assign(Object.create(null),o,s.defaultProps),l=Object.assign(Object.create(null),o?.[YF],s.propTypes),c=Object.assign(Object.create(null),o?.[qF],s.deprecatedProps);for(const u of t){const e=rD(u.constructor);e&&(Object.assign(a,e),Object.assign(l,e[YF]),Object.assign(c,e[qF]))}(function(e,t){const n=function(e){const t=e.componentName;t||AC.warn(`${e.name}.componentName not specified`)();return t||e.name}(t);Object.defineProperties(e,{id:{writable:!0,value:n}})})(a,e),function(e,t){const n={},r={};for(const o in t){const e=t[o],{name:i,value:s}=e;e.async&&(n[i]=s,r[i]=oD(i))}e[JF]=n,e[ZF]={},Object.defineProperties(e,r)}(a,l),function(e,t){for(const n in t)Object.defineProperty(e,n,{enumerable:!1,set(e){const r=`${this.id}: ${n}`;for(const o of t[n])iD(this,o)||(this[o]=e);AC.deprecated(r,t[n].join("/"))()}})}(a,c),a[YF]=l,a[qF]=c,0!==t.length||iD(e,"_propTypes")||(e._propTypes=l);return a}(e,t||[]))}function oD(e){return{enumerable:!0,set(t){"string"==typeof t||t instanceof Promise||dO(t)?this[ZF][e]=t:this[eM][e]=t},get(){if(this[eM]){if(e in this[eM]){return this[eM][e]||this[JF][e]}if(e in this[ZF]){const t=this[XF]&&this[XF].internalState;if(t&&t.hasAsyncProp(e))return t.getAsyncProp(e)||this[JF][e]}}return this[JF][e]}}}function iD(e,t){return Object.prototype.hasOwnProperty.call(e,t)}function sD(e,t){return iD(e,t)&&e[t]}let aD=0;class lD{constructor(...e){this.props=function(e,t){let n;for(let i=t.length-1;i>=0;i--){const e=t[i];"extensions"in e&&(n=e.extensions)}const r=rD(e.constructor,n),o=Object.create(r);o[XF]=e,o[ZF]={},o[eM]={};for(let i=0;i<t.length;++i){const e=t[i];for(const t in e)o[t]=e[t]}return Object.freeze(o),o}(this,e),this.id=this.props.id,this.count=aD++}clone(e){const{props:t}=this,n={};for(const r in t[JF])r in t[eM]?n[r]=t[eM][r]:r in t[ZF]&&(n[r]=t[ZF][r]);return new this.constructor({...t,...n,...e})}}lD.componentName="Component",lD.defaultProps={};const cD=Object.freeze({});class uD{constructor(e){this.component=e,this.asyncProps={},this.onAsyncPropUpdated=()=>{},this.oldProps=null,this.oldAsyncProps=null}finalize(){for(const e in this.asyncProps){const t=this.asyncProps[e];t&&t.type&&t.type.release&&t.type.release(t.resolvedValue,t.type,this.component)}this.asyncProps={},this.component=null,this.resetOldProps()}getOldProps(){return this.oldAsyncProps||this.oldProps||cD}resetOldProps(){this.oldAsyncProps=null,this.oldProps=this.component?this.component.props:null}hasAsyncProp(e){return e in this.asyncProps}getAsyncProp(e){const t=this.asyncProps[e];return t&&t.resolvedValue}isAsyncPropLoading(e){if(e){const t=this.asyncProps[e];return Boolean(t&&t.pendingLoadCount>0&&t.pendingLoadCount!==t.resolvedLoadCount)}for(const t in this.asyncProps)if(this.isAsyncPropLoading(t))return!0;return!1}reloadAsyncProp(e,t){this._watchPromise(e,Promise.resolve(t))}setAsyncProps(e){this.component=e[XF]||this.component;const t=e[eM]||{},n=e[ZF]||e,r=e[JF]||{};for(const o in t){const e=t[o];this._createAsyncPropData(o,r[o]),this._updateAsyncProp(o,e),t[o]=this.getAsyncProp(o)}for(const o in n){const e=n[o];this._createAsyncPropData(o,r[o]),this._updateAsyncProp(o,e)}}_fetch(e,t){return null}_onResolve(e,t){}_onError(e,t){}_updateAsyncProp(e,t){this._didAsyncInputValueChange(e,t)&&("string"==typeof t&&(t=this._fetch(e,t)),t instanceof Promise?this._watchPromise(e,t):dO(t)?this._resolveAsyncIterable(e,t):this._setPropValue(e,t))}_freezeAsyncOldProps(){if(!this.oldAsyncProps&&this.oldProps){this.oldAsyncProps=Object.create(this.oldProps);for(const e in this.asyncProps)Object.defineProperty(this.oldAsyncProps,e,{enumerable:!0,value:this.oldProps[e]})}}_didAsyncInputValueChange(e,t){const n=this.asyncProps[e];return t!==n.resolvedValue&&t!==n.lastValue&&(n.lastValue=t,!0)}_setPropValue(e,t){this._freezeAsyncOldProps();const n=this.asyncProps[e];n&&(t=this._postProcessValue(n,t),n.resolvedValue=t,n.pendingLoadCount++,n.resolvedLoadCount=n.pendingLoadCount)}_setAsyncPropValue(e,t,n){const r=this.asyncProps[e];r&&n>=r.resolvedLoadCount&&void 0!==t&&(this._freezeAsyncOldProps(),r.resolvedValue=t,r.resolvedLoadCount=n,this.onAsyncPropUpdated(e,t))}_watchPromise(e,t){const n=this.asyncProps[e];if(n){n.pendingLoadCount++;const r=n.pendingLoadCount;t.then(t=>{this.component&&(t=this._postProcessValue(n,t),this._setAsyncPropValue(e,t,r),this._onResolve(e,t))}).catch(t=>{this._onError(e,t)})}}async _resolveAsyncIterable(e,t){if("data"!==e)return void this._setPropValue(e,t);const n=this.asyncProps[e];if(!n)return;n.pendingLoadCount++;const r=n.pendingLoadCount;let o=[],i=0;for await(const s of t){if(!this.component)return;const{dataTransform:t}=this.component.props;o=t?t(s,o):o.concat(s),Object.defineProperty(o,"__diff",{enumerable:!1,value:[{startRow:i,endRow:o.length}]}),i=o.length,this._setAsyncPropValue(e,o,r)}this._onResolve(e,o)}_postProcessValue(e,t){const n=e.type;return n&&this.component&&(n.release&&n.release(e.resolvedValue,n,this.component),n.transform)?n.transform(t,n,this.component):t}_createAsyncPropData(e,t){if(!this.asyncProps[e]){const n=this.component&&this.component.props[YF];this.asyncProps[e]={type:n&&n[e],lastValue:null,resolvedValue:t,pendingLoadCount:0,resolvedLoadCount:0}}}}class dD extends uD{constructor({attributeManager:e,layer:t}){super(t),this.attributeManager=e,this.needsRedraw=!0,this.needsUpdate=!0,this.subLayers=null,this.usesPickingColorCache=!1}get layer(){return this.component}_fetch(e,t){const n=this.layer,r=n?.props.fetch;return r?r(t,{propName:e,layer:n}):super._fetch(e,t)}_onResolve(e,t){const n=this.layer;if(n){const r=n.props.onDataLoad;"data"===e&&r&&r(t,{propName:e,layer:n})}}_onError(e,t){const n=this.layer;n&&n.raiseError(t,`loading ${e} of ${this.layer}`)}}const AD=2**24-1,hD=Object.freeze([]),pD=FT(({oldViewport:e,viewport:t})=>e.equals(t));let fD=new Uint8ClampedArray(0);const gD={data:{type:"data",value:hD,async:!0},dataComparator:{type:"function",value:null,optional:!0},_dataDiff:{type:"function",value:e=>e&&e.__diff,optional:!0},dataTransform:{type:"function",value:null,optional:!0},onDataLoad:{type:"function",value:null,optional:!0},onError:{type:"function",value:null,optional:!0},fetch:{type:"function",value:(e,{propName:t,layer:n,loaders:r,loadOptions:o,signal:i})=>{const{resourceManager:s}=n.context;o=o||n.getLoadOptions(),r=r||n.props.loaders,i&&(o={...o,fetch:{...o?.fetch,signal:i}});let a=s.contains(e);return a||o||(s.add({resourceId:e,data:V_(e,r),persistent:!1}),a=!0),a?s.subscribe({resourceId:e,onChange:e=>n.internalState?.reloadAsyncProp(t,e),consumerId:n.id,requestId:t}):V_(e,r,o)}},updateTriggers:{},visible:!0,pickable:!1,opacity:{type:"number",min:0,max:1,value:1},operation:"draw",onHover:{type:"function",value:null,optional:!0},onClick:{type:"function",value:null,optional:!0},onDragStart:{type:"function",value:null,optional:!0},onDrag:{type:"function",value:null,optional:!0},onDragEnd:{type:"function",value:null,optional:!0},coordinateSystem:BT.DEFAULT,coordinateOrigin:{type:"array",value:[0,0,0],compare:!0},modelMatrix:{type:"array",value:null,compare:!0,optional:!0},wrapLongitude:!1,positionFormat:"XYZ",colorFormat:"RGBA",parameters:{type:"object",value:{},optional:!0,compare:2},loadOptions:{type:"object",value:null,optional:!0,ignore:!0},transitions:null,extensions:[],loaders:{type:"array",value:[],optional:!0,ignore:!0},getPolygonOffset:{type:"function",value:({layerIndex:e})=>[0,100*-e]},highlightedObjectIndex:null,autoHighlight:!1,highlightColor:{type:"accessor",value:[0,0,128,128]}};class mD extends lD{constructor(){super(...arguments),this.internalState=null,this.lifecycle=HF,this.parent=null}static get componentName(){return Object.prototype.hasOwnProperty.call(this,"layerName")?this.layerName:""}get root(){let e=this;for(;e.parent;)e=e.parent;return e}toString(){return`${this.constructor.layerName||this.constructor.name}({id: '${this.props.id}'})`}project(e){bM(this.internalState);const t=this.internalState.viewport||this.context.viewport,n=AF(e,{viewport:t,modelMatrix:this.props.modelMatrix,coordinateOrigin:this.props.coordinateOrigin,coordinateSystem:this.props.coordinateSystem}),[r,o,i]=fP(n,t.pixelProjectionMatrix);return 2===e.length?[r,o]:[r,o,i]}unproject(e){bM(this.internalState);return(this.internalState.viewport||this.context.viewport).unproject(e)}projectPosition(e,t){bM(this.internalState);return hF(e,{viewport:this.internalState.viewport||this.context.viewport,modelMatrix:this.props.modelMatrix,coordinateOrigin:this.props.coordinateOrigin,coordinateSystem:this.props.coordinateSystem,...t})}get isComposite(){return!1}get isDrawable(){return!0}setState(e){this.setChangeFlags({stateChanged:!0}),Object.assign(this.state,e),this.setNeedsRedraw()}setNeedsRedraw(){this.internalState&&(this.internalState.needsRedraw=!0)}setNeedsUpdate(){this.internalState&&(this.context.layerManager.setNeedsUpdate(String(this)),this.internalState.needsUpdate=!0)}get isLoaded(){return!!this.internalState&&!this.internalState.isAsyncPropLoading()}get wrapLongitude(){return this.props.wrapLongitude}isPickable(){return this.props.pickable&&this.props.visible}getModels(){const e=this.state;return e&&(e.models||e.model&&[e.model])||[]}setShaderModuleProps(...e){for(const t of this.getModels())t.shaderInputs.setProps(...e)}getAttributeManager(){return this.internalState&&this.internalState.attributeManager}getCurrentLayer(){return this.internalState&&this.internalState.layer}getLoadOptions(){return this.props.loadOptions}use64bitPositions(){const{coordinateSystem:e}=this.props;return e===BT.DEFAULT||e===BT.LNGLAT||e===BT.CARTESIAN}onHover(e,t){return this.props.onHover&&this.props.onHover(e,t)||!1}onClick(e,t){return this.props.onClick&&this.props.onClick(e,t)||!1}nullPickingColor(){return[0,0,0]}encodePickingColor(e,t=[]){return t[0]=e+1&255,t[1]=e+1>>8&255,t[2]=e+1>>8>>8&255,t}decodePickingColor(e){bM(e instanceof Uint8Array);const[t,n,r]=e;return t+256*n+65536*r-1}getNumInstances(){return Number.isFinite(this.props.numInstances)?this.props.numInstances:this.state&&void 0!==this.state.numInstances?this.state.numInstances:$O(this.props.data)}getStartIndices(){return this.props.startIndices?this.props.startIndices:this.state&&this.state.startIndices?this.state.startIndices:null}getBounds(){return this.getAttributeManager()?.getBounds(["positions","instancePositions"])}getShaders(e){e=KO(e,{disableWarnings:!0,modules:this.context.defaultShaderModules});for(const t of this.props.extensions)e=KO(e,t.getShaders.call(this,t));return e}shouldUpdateState(e){return e.changeFlags.propsOrDataChanged}updateState(e){const t=this.getAttributeManager(),{dataChanged:n}=e.changeFlags;if(n&&t)if(Array.isArray(n))for(const r of n)t.invalidateAll(r);else t.invalidateAll();if(t){const{props:n}=e,r=this.internalState.hasPickingBuffer,o=Number.isInteger(n.highlightedObjectIndex)||n.pickable||n.extensions.some(e=>e.getNeedsPickingBuffer.call(this,e));if(r!==o){this.internalState.hasPickingBuffer=o;const{pickingColors:e,instancePickingColors:n}=t.attributes,r=e||n;r&&(o&&r.constant&&(r.constant=!1,t.invalidate(r.id)),r.value||o||(r.constant=!0,r.value=[0,0,0]))}}}finalizeState(e){for(const n of this.getModels())n.destroy();const t=this.getAttributeManager();t&&t.finalize(),this.context&&this.context.resourceManager.unsubscribe({consumerId:this.id}),this.internalState&&(this.internalState.uniformTransitions.clear(),this.internalState.finalize())}draw(e){for(const t of this.getModels())t.draw(e.renderPass)}getPickingInfo({info:e,mode:t,sourceLayer:n}){const{index:r}=e;return r>=0&&Array.isArray(this.props.data)&&(e.object=this.props.data[r]),e}raiseError(e,t){t&&(e=new Error(`${t}: ${e.message}`,{cause:e})),this.props.onError?.(e)||this.context?.onError?.(e,this)}getNeedsRedraw(e={clearRedrawFlags:!1}){return this._getNeedsRedraw(e)}needsUpdate(){return!!this.internalState&&(this.internalState.needsUpdate||this.hasUniformTransition()||this.shouldUpdateState(this._getUpdateParams()))}hasUniformTransition(){return this.internalState?.uniformTransitions.active||!1}activateViewport(e){if(!this.internalState)return;const t=this.internalState.viewport;this.internalState.viewport=e,t&&pD({oldViewport:t,viewport:e})||(this.setChangeFlags({viewportChanged:!0}),this.isComposite?this.needsUpdate()&&this.setNeedsUpdate():this._update())}invalidateAttribute(e="all"){const t=this.getAttributeManager();t&&("all"===e?t.invalidateAll():t.invalidate(e))}updateAttributes(e){let t=!1;for(const n in e)e[n].layoutChanged()&&(t=!0);for(const n of this.getModels())this._setModelAttributes(n,e,t)}_updateAttributes(){const e=this.getAttributeManager();if(!e)return;const t=this.props,n=this.getNumInstances(),r=this.getStartIndices();e.update({data:t.data,numInstances:n,startIndices:r,props:t,transitions:t.transitions,buffers:t.data.attributes,context:this});const o=e.getChangedAttributes({clearChangedFlags:!0});this.updateAttributes(o)}_updateAttributeTransition(){const e=this.getAttributeManager();e&&e.updateTransition()}_updateUniformTransition(){const{uniformTransitions:e}=this.internalState;if(e.active){const t=e.update(),n=Object.create(this.props);for(const e in t)Object.defineProperty(n,e,{value:t[e]});return n}return this.props}calculateInstancePickingColors(e,{numInstances:t}){if(e.constant)return;const n=Math.floor(fD.length/4);if(this.internalState.usesPickingColorCache=!0,n<t){t>AD&&AC.warn("Layer has too many data objects. Picking might not be able to distinguish all objects.")(),fD=qP.allocate(fD,t,{size:4,copy:!0,maxCount:Math.max(t,AD)});const e=Math.floor(fD.length/4),r=[0,0,0];for(let t=n;t<e;t++)this.encodePickingColor(t,r),fD[4*t+0]=r[0],fD[4*t+1]=r[1],fD[4*t+2]=r[2],fD[4*t+3]=0}e.value=fD.subarray(0,4*t)}_setModelAttributes(e,t,n=!1){if(!Object.keys(t).length)return;if(n){const n=this.getAttributeManager();e.setBufferLayout(n.getBufferLayouts(e)),t=n.getAttributes()}const r=e.userData?.excludeAttributes||{},o={},i={};for(const s in t){if(r[s])continue;const n=t[s].getValue();for(const r in n){const a=n[r];a instanceof oS?t[s].settings.isIndexed?e.setIndexBuffer(a):o[r]=a:a&&(i[r]=a)}}e.setAttributes(o),e.setConstantAttributes(i)}disablePickingIndex(e){const t=this.props.data;if(!("attributes"in t))return void this._disablePickingIndex(e);const{pickingColors:n,instancePickingColors:r}=this.getAttributeManager().attributes,o=n||r,i=o&&t.attributes&&t.attributes[o.id];if(i&&i.value){const n=i.value,r=this.encodePickingColor(e);for(let e=0;e<t.length;e++){const t=o.getVertexOffset(e);n[t]===r[0]&&n[t+1]===r[1]&&n[t+2]===r[2]&&this._disablePickingIndex(e)}}else this._disablePickingIndex(e)}_disablePickingIndex(e){const{pickingColors:t,instancePickingColors:n}=this.getAttributeManager().attributes,r=t||n;if(!r)return;const o=r.getVertexOffset(e),i=r.getVertexOffset(e+1);r.buffer.write(new Uint8Array(i-o),o)}restorePickingColors(){const{pickingColors:e,instancePickingColors:t}=this.getAttributeManager().attributes,n=e||t;n&&(this.internalState.usesPickingColorCache&&n.value.buffer!==fD.buffer&&(n.value=fD.subarray(0,n.value.length)),n.updateSubBuffer({startOffset:0}))}_initialize(){bM(!this.internalState),bM(Number.isFinite(this.props.coordinateSystem)),fC("layer.initialize",this);const e=this._getAttributeManager();e&&e.addInstanced({instancePickingColors:{type:"uint8",size:4,noAlloc:!0,update:this.calculateInstancePickingColors}}),this.internalState=new dD({attributeManager:e,layer:this}),this._clearChangeFlags(),this.state={},Object.defineProperty(this.state,"attributeManager",{get:()=>(AC.deprecated("layer.state.attributeManager","layer.getAttributeManager()")(),e)}),this.internalState.uniformTransitions=new jO(this.context.timeline),this.internalState.onAsyncPropUpdated=this._onAsyncPropUpdated.bind(this),this.internalState.setAsyncProps(this.props),this.initializeState(this.context);for(const t of this.props.extensions)t.initializeState.call(this,this.context,t);this.setChangeFlags({dataChanged:"init",propsChanged:"init",viewportChanged:!0,extensionsChanged:!0}),this._update()}_transferState(e){fC("layer.matched",this,this===e);const{state:t,internalState:n}=e;this!==e&&(this.internalState=n,this.state=t,this.internalState.setAsyncProps(this.props),this._diffProps(this.props,this.internalState.getOldProps()))}_update(){const e=this.needsUpdate();if(fC("layer.update",this,e),!e)return;const t=this.props,n=this.context,r=this.internalState,o=n.viewport,i=this._updateUniformTransition();r.propsInTransition=i,n.viewport=r.viewport||o,this.props=i;try{const e=this._getUpdateParams(),t=this.getModels();if(n.device)this.updateState(e);else try{this.updateState(e)}catch(s){}for(const n of this.props.extensions)n.updateState.call(this,e,n);this.setNeedsRedraw(),this._updateAttributes();const r=this.getModels()[0]!==t[0];this._postUpdate(e,r)}finally{n.viewport=o,this.props=t,this._clearChangeFlags(),r.needsUpdate=!1,r.resetOldProps()}}_finalize(){fC("layer.finalize",this),this.finalizeState(this.context);for(const e of this.props.extensions)e.finalizeState.call(this,this.context,e)}_drawLayer({renderPass:e,shaderModuleProps:t=null,uniforms:n={},parameters:r={}}){this._updateAttributeTransition();const o=this.props,i=this.context;this.props=this.internalState.propsInTransition||o;try{t&&this.setShaderModuleProps(t);const{getPolygonOffset:o}=this.props,s=o&&o(n)||[0,0];i.device instanceof $U&&i.device.setParametersWebGL({polygonOffset:s});for(const e of this.getModels())"webgpu"===e.device.type?e.setParameters({...e.parameters,...r}):e.setParameters(r);if(i.device instanceof $U)i.device.withParametersWebGL(r,()=>{const o={renderPass:e,shaderModuleProps:t,uniforms:n,parameters:r,context:i};for(const e of this.props.extensions)e.draw.call(this,o,e);this.draw(o)});else{const o={renderPass:e,shaderModuleProps:t,uniforms:n,parameters:r,context:i};for(const e of this.props.extensions)e.draw.call(this,o,e);this.draw(o)}}finally{this.props=o}}getChangeFlags(){return this.internalState?.changeFlags}setChangeFlags(e){if(!this.internalState)return;const{changeFlags:t}=this.internalState;for(const r in e)if(e[r]){let n=!1;if("dataChanged"===r){const o=e[r],i=t[r];o&&Array.isArray(i)&&(t.dataChanged=Array.isArray(o)?i.concat(o):o,n=!0)}t[r]||(t[r]=e[r],n=!0),n&&fC("layer.changeFlag",this,r,e)}const n=Boolean(t.dataChanged||t.updateTriggersChanged||t.propsChanged||t.extensionsChanged);t.propsOrDataChanged=n,t.somethingChanged=n||t.viewportChanged||t.stateChanged}_clearChangeFlags(){this.internalState.changeFlags={dataChanged:!1,propsChanged:!1,updateTriggersChanged:!1,viewportChanged:!1,stateChanged:!1,extensionsChanged:!1,propsOrDataChanged:!1,somethingChanged:!1}}_diffProps(e,t){const n=QO(e,t);if(n.updateTriggersChanged)for(const r in n.updateTriggersChanged)n.updateTriggersChanged[r]&&this.invalidateAttribute(r);if(n.transitionsChanged)for(const r in n.transitionsChanged)this.internalState.uniformTransitions.add(r,t[r],e[r],e.transitions?.[r]);return this.setChangeFlags(n)}validateProps(){!function(e){const t=e[YF];for(const n in t){const r=t[n],{validate:o}=r;if(o&&!o(e[n],r))throw new Error(`Invalid prop ${n}: ${e[n]}`)}}(this.props)}updateAutoHighlight(e){this.props.autoHighlight&&!Number.isInteger(this.props.highlightedObjectIndex)&&this._updateAutoHighlight(e)}_updateAutoHighlight(e){const t={highlightedObjectColor:e.picked?e.color:null},{highlightColor:n}=this.props;e.picked&&"function"==typeof n&&(t.highlightColor=n(e)),this.setShaderModuleProps({picking:t}),this.setNeedsRedraw()}_getAttributeManager(){const e=this.context;return new LO(e.device,{id:this.props.id,stats:e.stats,timeline:e.timeline})}_postUpdate(e,t){const{props:n,oldProps:r}=e,o=this.state.model;o?.isInstanced&&o.setInstanceCount(this.getNumInstances());const{autoHighlight:i,highlightedObjectIndex:s,highlightColor:a}=n;if(t||r.autoHighlight!==i||r.highlightedObjectIndex!==s||r.highlightColor!==a){const e={};Array.isArray(a)&&(e.highlightColor=a),(t||r.autoHighlight!==i||s!==r.highlightedObjectIndex)&&(e.highlightedObjectColor=Number.isFinite(s)&&s>=0?this.encodePickingColor(s):null),this.setShaderModuleProps({picking:e})}}_getUpdateParams(){return{props:this.props,oldProps:this.internalState.getOldProps(),context:this.context,changeFlags:this.internalState.changeFlags}}_getNeedsRedraw(e){if(!this.internalState)return!1;let t=!1;t=t||this.internalState.needsRedraw&&this.id;const n=this.getAttributeManager(),r=!!n&&n.getNeedsRedraw(e);if(t=t||r,t)for(const o of this.props.extensions)o.onNeedsRedraw.call(this,o);return this.internalState.needsRedraw=this.internalState.needsRedraw&&!e.clearRedrawFlags,t}_onAsyncPropUpdated(){this._diffProps(this.props,this.internalState.getOldProps()),this.setNeedsUpdate()}}mD.defaultProps=gD,mD.layerName="Layer";class yD extends mD{get isComposite(){return!0}get isDrawable(){return!1}get isLoaded(){return super.isLoaded&&this.getSubLayers().every(e=>e.isLoaded)}getSubLayers(){return this.internalState&&this.internalState.subLayers||[]}initializeState(e){}setState(e){super.setState(e),this.setNeedsUpdate()}getPickingInfo({info:e}){const{object:t}=e;return t&&t.__source&&t.__source.parent&&t.__source.parent.id===this.id?(e.object=t.__source.object,e.index=t.__source.index,e):e}filterSubLayer(e){return!0}shouldRenderSubLayer(e,t){return t&&t.length}getSubLayerClass(e,t){const{_subLayerProps:n}=this.props;return n&&n[e]&&n[e].type||t}getSubLayerRow(e,t,n){return e.__source={parent:this,object:t,index:n},e}getSubLayerAccessor(e){if("function"==typeof e){const t={index:-1,data:this.props.data,target:[]};return(n,r)=>n&&n.__source?(t.index=n.__source.index,e(n.__source.object,t)):e(n,r)}return e}getSubLayerProps(e={}){const{opacity:t,pickable:n,visible:r,parameters:o,getPolygonOffset:i,highlightedObjectIndex:s,autoHighlight:a,highlightColor:l,coordinateSystem:c,coordinateOrigin:u,wrapLongitude:d,positionFormat:A,modelMatrix:h,extensions:p,fetch:f,operation:g,_subLayerProps:m}=this.props,y={id:"",updateTriggers:{},opacity:t,pickable:n,visible:r,parameters:o,getPolygonOffset:i,highlightedObjectIndex:s,autoHighlight:a,highlightColor:l,coordinateSystem:c,coordinateOrigin:u,wrapLongitude:d,positionFormat:A,modelMatrix:h,extensions:p,fetch:f,operation:g},v=m&&e.id&&m[e.id],b=v&&v.updateTriggers,w=e.id||"sublayer";if(v){const t=this.props[YF],n=e.type?e.type._propTypes:{};for(const e in v){const r=n[e]||t[e];r&&"accessor"===r.type&&(v[e]=this.getSubLayerAccessor(v[e]))}}Object.assign(y,e,v),y.id=`${this.props.id}-${w}`,y.updateTriggers={all:this.props.updateTriggers?.all,...e.updateTriggers,...b};for(const x of p){const e=x.getSubLayerProps.call(this,x);e&&Object.assign(y,e,{updateTriggers:Object.assign(y.updateTriggers,e.updateTriggers)})}return y}_updateAutoHighlight(e){for(const t of this.getSubLayers())t.updateAutoHighlight(e)}_getAttributeManager(){return null}_postUpdate(e,t){let n=this.internalState.subLayers;const r=!n||this.needsUpdate();if(r){n=tM(this.renderLayers(),Boolean),this.internalState.subLayers=n}fC("compositeLayer.renderLayers",this,r,n);for(const o of n)o.parent=this}}yD.layerName="CompositeLayer";const vD=Math.PI/180,bD=180/Math.PI,wD=6370972,xD=256;function _D(){const e=4018225162502676e-20,t=Math.PI/180*xD;return{unitsPerMeter:[e,e,e],unitsPerMeter2:[0,0,0],metersPerUnit:[24886.609375,24886.609375,24886.609375],unitsPerDegree:[t,t,e],unitsPerDegree2:[0,0,0],degreesPerUnit:[1/t,1/t,24886.609375]}}class CD extends lF{constructor(e={}){const{longitude:t=0,zoom:n=0,nearZMultiplier:r=.5,farZMultiplier:o=1,resolution:i=10}=e;let{latitude:s=0,height:a,altitude:l=1.5,fovy:c}=e;s=Math.max(Math.min(s,iP),-85.051129),a=a||1,c?l=pP(c):c=hP(l);const u=1/Math.PI/Math.cos(s*Math.PI/180),d=Math.pow(2,n)*u,A=e.nearZ??r,h=e.farZ??(l+512*d/a)*o,p=(new GR).lookAt({eye:[0,-l,0],up:[0,0,1]});p.rotateX(s*vD),p.rotateZ(-t*vD),p.scale(d/a),super({...e,height:a,viewMatrix:p,longitude:t,latitude:s,zoom:n,distanceScales:_D(),fovy:c,focalDistance:l,near:A,far:h}),this.scale=d,this.latitude=s,this.longitude=t,this.resolution=i}get projectionMode(){return IT.GLOBE}getDistanceScales(){return this.distanceScales}getBounds(e={}){const t={targetZ:e.z||0},n=this.unproject([0,this.height/2],t),r=this.unproject([this.width/2,0],t),o=this.unproject([this.width,this.height/2],t),i=this.unproject([this.width/2,this.height],t);return o[0]<this.longitude&&(o[0]+=360),n[0]>this.longitude&&(n[0]-=360),[Math.min(n[0],o[0],r[0],i[0]),Math.min(n[1],o[1],r[1],i[1]),Math.max(n[0],o[0],r[0],i[0]),Math.max(n[1],o[1],r[1],i[1])]}unproject(e,{topLeft:t=!0,targetZ:n}={}){const[r,o,i]=e,s=t?o:this.height-o,{pixelUnprojectionMatrix:a}=this;let l;if(Number.isFinite(i))l=SD(a,[r,s,i,1]);else{const e=SD(a,[r,s,-1,1]),t=SD(a,[r,s,1,1]),o=((n||0)/wD+1)*xD,i=hR(dR([],e,t)),c=hR(e),u=hR(t),d=4*((4*c*u-(i-c-u)**2)/16)/i;l=function(e,t,n,r){const o=t[0],i=t[1],s=t[2];return e[0]=o+r*(n[0]-o),e[1]=i+r*(n[1]-i),e[2]=s+r*(n[2]-s),e}([],e,t,(Math.sqrt(c-d)-Math.sqrt(Math.max(0,o*o-d)))/Math.sqrt(i))}const[c,u,d]=this.unprojectPosition(l);return Number.isFinite(i)?[c,u,d]:Number.isFinite(n)?[c,u,n]:[c,u]}projectPosition(e){const[t,n,r=0]=e,o=t*vD,i=n*vD,s=Math.cos(i),a=(r/wD+1)*xD;return[Math.sin(o)*s*a,-Math.cos(o)*s*a,Math.sin(i)*a]}unprojectPosition(e){const[t,n,r]=e,o=AR(e),i=Math.asin(r/o);return[Math.atan2(t,-n)*bD,i*bD,(o/xD-1)*wD]}projectFlat(e){return e}unprojectFlat(e){return e}panByPosition(e,t){const n=this.unproject(t);return{longitude:e[0]-n[0]+this.longitude,latitude:e[1]-n[1]+this.latitude}}}function SD(e,t){const n=OR([],t,e);return UR(n,n,1/n[3]),n}class ED{static get componentName(){return Object.prototype.hasOwnProperty.call(this,"extensionName")?this.extensionName:""}constructor(e){e&&(this.opts=e)}equals(e){return this===e||this.constructor===e.constructor&&aM(this.opts,e.opts,1)}getShaders(e){return null}getSubLayerProps(e){const{defaultProps:t}=e.constructor,n={updateTriggers:{}};for(const r in t)if(r in this.props){const e=t[r],o=this.props[r];n[r]=o,e&&"accessor"===e.type&&(n.updateTriggers[r]=this.props.updateTriggers[r],"function"==typeof o&&(n[r]=this.getSubLayerAccessor(o)))}return n}initializeState(e,t){}updateState(e,t){}onNeedsRedraw(e){}getNeedsPickingBuffer(e){return!1}draw(e,t){}finalizeState(e,t){}}ED.defaultProps={},ED.extensionName="LayerExtension";class BD{constructor(e){this.indexStarts=[0],this.vertexStarts=[0],this.vertexCount=0,this.instanceCount=0;const{attributes:t={}}=e;this.typedArrayManager=qP,this.attributes={},this._attributeDefs=t,this.opts=e,this.updateGeometry(e)}updateGeometry(e){Object.assign(this.opts,e);const{data:t,buffers:n={},getGeometry:r,geometryBuffer:o,positionFormat:i,dataChanged:s,normalize:a=!0}=this.opts;if(this.data=t,this.getGeometry=r,this.positionSize=o&&o.size||("XY"===i?2:3),this.buffers=n,this.normalize=a,o&&(bM(t.startIndices),this.getGeometry=this.getGeometryFromBuffer(o),a||(n.vertexPositions=o)),this.geometryBuffer=n.vertexPositions,Array.isArray(s))for(const l of s)this._rebuildGeometry(l);else this._rebuildGeometry()}updatePartialGeometry({startRow:e,endRow:t}){this._rebuildGeometry({startRow:e,endRow:t})}getGeometryFromBuffer(e){const t=e.value||e;return ArrayBuffer.isView(t)?AO(t,{size:this.positionSize,offset:e.offset,stride:e.stride,startIndices:this.data.startIndices}):null}_allocate(e,t){const{attributes:n,buffers:r,_attributeDefs:o,typedArrayManager:i}=this;for(const s in o)if(s in r)i.release(n[s]),n[s]=null;else{const r=o[s];r.copy=t,n[s]=i.allocate(n[s],e,r)}}_forEachGeometry(e,t,n){const{data:r,getGeometry:o}=this,{iterable:i,objectInfo:s}=uO(r,t,n);for(const a of i){s.index++;e(o?o(a,s):null,s.index)}}_rebuildGeometry(e){if(!this.data)return;let{indexStarts:t,vertexStarts:n,instanceCount:r}=this;const{data:o,geometryBuffer:i}=this,{startRow:s=0,endRow:a=1/0}=e||{},l={};if(e||(t=[0],n=[0]),this.normalize||!i)this._forEachGeometry((e,t)=>{const r=e&&this.normalizeGeometry(e);l[t]=r,n[t+1]=n[t]+(r?this.getGeometrySize(r):0)},s,a),r=n[n.length-1];else if(n=o.startIndices,r=n[o.length]||0,ArrayBuffer.isView(i))r=r||i.length/this.positionSize;else if(i instanceof oS){const e=4*this.positionSize;r=r||i.byteLength/e}else if(i.buffer){const e=i.stride||4*this.positionSize;r=r||i.buffer.byteLength/e}else if(i.value){const e=i.value,t=i.stride/e.BYTES_PER_ELEMENT||this.positionSize;r=r||e.length/t}this._allocate(r,Boolean(e)),this.indexStarts=t,this.vertexStarts=n,this.instanceCount=r;const c={};this._forEachGeometry((e,o)=>{const i=l[o]||e;c.vertexStart=n[o],c.indexStart=t[o];const s=o<n.length-1?n[o+1]:r;c.geometrySize=s-n[o],c.geometryIndex=o,this.updateGeometryAttributes(i,c)},s,a),this.vertexCount=t[t.length-1]}}const ID="uniform dataFilterUniforms {\n  bool useSoftMargin;\n  bool enabled;\n  bool transformSize;\n  bool transformColor;\n#ifdef DATAFILTER_TYPE\n  DATAFILTER_TYPE min;\n  DATAFILTER_TYPE softMin;\n  DATAFILTER_TYPE softMax;\n  DATAFILTER_TYPE max;\n#ifdef DATAFILTER_DOUBLE\n  DATAFILTER_TYPE min64High;\n  DATAFILTER_TYPE max64High;\n#endif\n#endif\n#ifdef DATACATEGORY_TYPE\n  highp uvec4 categoryBitMask;\n#endif\n} dataFilter;\n",RD=`\n${ID}\n\n#ifdef DATAFILTER_TYPE\n  in DATAFILTER_TYPE filterValues;\n#ifdef DATAFILTER_DOUBLE\n  in DATAFILTER_TYPE filterValues64Low;\n#endif\n#endif\n\n#ifdef DATACATEGORY_TYPE\n  in DATACATEGORY_TYPE filterCategoryValues;\n#endif\n\nout float dataFilter_value;\n\nfloat dataFilter_reduceValue(float value) {\n  return value;\n}\nfloat dataFilter_reduceValue(vec2 value) {\n  return min(value.x, value.y);\n}\nfloat dataFilter_reduceValue(vec3 value) {\n  return min(min(value.x, value.y), value.z);\n}\nfloat dataFilter_reduceValue(vec4 value) {\n  return min(min(value.x, value.y), min(value.z, value.w));\n}\n\n#ifdef DATAFILTER_TYPE\n  void dataFilter_setValue(DATAFILTER_TYPE valueFromMin, DATAFILTER_TYPE valueFromMax) {\n    if (dataFilter.useSoftMargin) {\n      // smoothstep results are undefined if edge0  edge1\n      // Fallback to ignore filterSoftRange if it is truncated by filterRange\n      DATAFILTER_TYPE leftInRange = mix(\n        smoothstep(dataFilter.min, dataFilter.softMin, valueFromMin),\n        step(dataFilter.min, valueFromMin),\n        step(dataFilter.softMin, dataFilter.min)\n      );\n      DATAFILTER_TYPE rightInRange = mix(\n        1.0 - smoothstep(dataFilter.softMax, dataFilter.max, valueFromMax),\n        step(valueFromMax, dataFilter.max),\n        step(dataFilter.max, dataFilter.softMax)\n      );\n      dataFilter_value = dataFilter_reduceValue(leftInRange * rightInRange);\n    } else {\n      dataFilter_value = dataFilter_reduceValue(\n        step(dataFilter.min, valueFromMin) * step(valueFromMax, dataFilter.max)\n      );\n    }\n  }\n#endif\n\n#ifdef DATACATEGORY_TYPE\n  void dataFilter_setCategoryValue(DATACATEGORY_TYPE category) {\n    #if DATACATEGORY_CHANNELS == 1 // One 128-bit mask\n    uint dataFilter_masks = dataFilter.categoryBitMask[category / 32u];\n    #elif DATACATEGORY_CHANNELS == 2 // Two 64-bit masks\n    uvec2 dataFilter_masks = uvec2(\n      dataFilter.categoryBitMask[category.x / 32u],\n      dataFilter.categoryBitMask[category.y / 32u + 2u]\n    );\n    #elif DATACATEGORY_CHANNELS == 3 // Three 32-bit masks\n    uvec3 dataFilter_masks = dataFilter.categoryBitMask.xyz;\n    #else // Four 32-bit masks\n    uvec4 dataFilter_masks = dataFilter.categoryBitMask;\n    #endif\n\n    // Shift mask and extract relevant bits\n    DATACATEGORY_TYPE dataFilter_bits = DATACATEGORY_TYPE(dataFilter_masks) >> (category & 31u);\n    dataFilter_bits &= 1u;\n\n    #if DATACATEGORY_CHANNELS == 1\n    if(dataFilter_bits == 0u) dataFilter_value = 0.0;\n    #else\n    if(any(equal(dataFilter_bits, DATACATEGORY_TYPE(0u)))) dataFilter_value = 0.0;\n    #endif\n  }\n#endif\n\n`,kD=`\n${ID}\n\nin float dataFilter_value;\n\n`;function TD(e){if(!e||!("extensions"in e))return{};const{filterRange:t=[-1,1],filterEnabled:n=!0,filterTransformSize:r=!0,filterTransformColor:o=!0,categoryBitMask:i}=e,s=e.filterSoftRange||t;return{...Number.isFinite(t[0])?{min:t[0],softMin:s[0],softMax:s[1],max:t[1]}:{min:t.map(e=>e[0]),softMin:s.map(e=>e[0]),softMax:s.map(e=>e[1]),max:t.map(e=>e[1])},enabled:n,useSoftMargin:Boolean(e.filterSoftRange),transformSize:n&&r,transformColor:n&&o,...i&&{categoryBitMask:i}}}const PD={"vs:#main-start":"\n    dataFilter_value = 1.0;\n    if (dataFilter.enabled) {\n      #ifdef DATAFILTER_TYPE\n        #ifdef DATAFILTER_DOUBLE\n          dataFilter_setValue(\n            filterValues - dataFilter.min64High + filterValues64Low,\n            filterValues - dataFilter.max64High + filterValues64Low\n          );\n        #else\n          dataFilter_setValue(filterValues, filterValues);\n        #endif\n      #endif\n\n      #ifdef DATACATEGORY_TYPE\n        dataFilter_setCategoryValue(filterCategoryValues);\n      #endif\n    }\n  ","vs:#main-end":"\n    if (dataFilter_value == 0.0) {\n      gl_Position = vec4(0.);\n    }\n  ","vs:DECKGL_FILTER_SIZE":"\n    if (dataFilter.transformSize) {\n      size = size * dataFilter_value;\n    }\n  ","fs:DECKGL_FILTER_COLOR":"\n    if (dataFilter_value == 0.0) discard;\n    if (dataFilter.transformColor) {\n      color.a *= dataFilter_value;\n    }\n  "};function FD(e){const{categorySize:t,filterSize:n,fp64:r}=e,o={useSoftMargin:"i32",enabled:"i32",transformSize:"i32",transformColor:"i32"};if(n){const e=1===n?"f32":`vec${n}<f32>`;o.min=e,o.softMin=e,o.softMax=e,o.max=e,r&&(o.min64High=e,o.max64High=e)}return t&&(o.categoryBitMask="vec4<i32>"),o}const MD={name:"dataFilter",vs:RD,fs:kD,inject:PD,getUniforms:TD,uniformTypesFromOptions:FD},LD={name:"dataFilter",vs:RD,fs:kD,inject:PD,getUniforms:function(e){if(!e||!("extensions"in e))return{};const t=TD(e);if(Number.isFinite(t.min)){const e=Math.fround(t.min);t.min-=e,t.softMin-=e,t.min64High=e;const n=Math.fround(t.max);t.max-=n,t.softMax-=n,t.max64High=n}else{const e=t.min.map(Math.fround);t.min=t.min.map((t,n)=>t-e[n]),t.softMin=t.softMin.map((t,n)=>t-e[n]),t.min64High=e;const n=t.max.map(Math.fround);t.max=t.max.map((e,t)=>e-n[t]),t.softMax=t.softMax.map((e,t)=>e-n[t]),t.max64High=n}return t},uniformTypesFromOptions:FD},UD=["float32-renderable-webgl","texture-blend-float-webgl"];const OD={blend:!0,blendColorSrcFactor:"one",blendColorDstFactor:"one",blendAlphaSrcFactor:"one",blendAlphaDstFactor:"one",blendColorOperation:"add",blendAlphaOperation:"add",depthCompare:"never"},DD={categorySize:0,filterSize:1,fp64:!1,countItems:!1},ND={1:"uint",2:"uvec2",3:"uvec3",4:"uvec4"},jD={1:"float",2:"vec2",3:"vec3",4:"vec4"};class QD extends ED{constructor(e={}){super({...DD,...e})}getShaders(e){const{categorySize:t,filterSize:n,fp64:r}=e.opts,o={};t&&(o.DATACATEGORY_TYPE=ND[t],o.DATACATEGORY_CHANNELS=t),n&&(o.DATAFILTER_TYPE=jD[n],o.DATAFILTER_DOUBLE=Boolean(r));const i=r?LD:MD;return i.uniformTypes=i.uniformTypesFromOptions(e.opts),{modules:[i],defines:o}}initializeState(e,t){const n=this.getAttributeManager(),{categorySize:r,filterSize:o,fp64:i}=t.opts;n&&(o&&n.add({filterValues:{size:o,type:i?"float64":"float32",stepMode:"dynamic",accessor:"getFilterValue"}}),r&&n.add({filterCategoryValues:{size:r,stepMode:"dynamic",accessor:"getFilterCategory",type:"uint32",transform:1===r?e=>t._getCategoryKey.call(this,e,0):e=>e.map((e,n)=>t._getCategoryKey.call(this,e,n))}}));const{device:s}=this.context;if(n&&t.opts.countItems){const e=function(e){return UD.every(t=>e.features.has(t))}(s);n.add({filterVertexIndices:{size:e?1:2,vertexOffset:1,type:"unorm8",accessor:(t,{index:n})=>{const r=t&&t.__source?t.__source.index:n;return e?(r+1)%255:[(r+1)%255,Math.floor(r/255)%255]},shaderAttributes:{filterPrevIndices:{vertexOffset:0},filterIndices:{vertexOffset:1}}}});const r=function(e,t){return t?e.createFramebuffer({width:1,height:1,colorAttachments:[e.createTexture({format:"rgba32float",mipmaps:!1})]}):e.createFramebuffer({width:256,height:64,colorAttachments:[e.createTexture({format:"rgba8unorm",mipmaps:!1})]})}(s,e),o=function(e,t,n,r){return n.defines.NON_INSTANCED_MODEL=1,r&&(n.defines.FLOAT_TARGET=1),new LF(e,{id:"data-filter-aggregation-model",vertexCount:1,isInstanced:!1,topology:"point-list",disableWarnings:!0,vs:"#version 300 es\n#define SHADER_NAME data-filter-vertex-shader\n\n#ifdef FLOAT_TARGET\n  in float filterIndices;\n  in float filterPrevIndices;\n#else\n  in vec2 filterIndices;\n  in vec2 filterPrevIndices;\n#endif\n\nout vec4 vColor;\nconst float component = 1.0 / 255.0;\n\nvoid main() {\n  #ifdef FLOAT_TARGET\n    dataFilter_value *= float(filterIndices != filterPrevIndices);\n    gl_Position = vec4(0.0, 0.0, 0.0, 1.0);\n    vColor = vec4(0.0, 0.0, 0.0, 1.0);\n  #else\n    // Float texture is not supported: pack result into 4 channels x 256 px x 64px\n    dataFilter_value *= float(filterIndices.x != filterPrevIndices.x);\n    float col = filterIndices.x;\n    float row = filterIndices.y * 4.0;\n    float channel = floor(row);\n    row = fract(row);\n    vColor = component * vec4(bvec4(channel == 0.0, channel == 1.0, channel == 2.0, channel == 3.0));\n    gl_Position = vec4(col * 2.0 - 1.0, row * 2.0 - 1.0, 0.0, 1.0);\n  #endif\n  gl_PointSize = 1.0;\n}\n",fs:"#version 300 es\n#define SHADER_NAME data-filter-fragment-shader\nprecision highp float;\n\nin vec4 vColor;\n\nout vec4 fragColor;\n\nvoid main() {\n  if (dataFilter_value < 0.5) {\n    discard;\n  }\n  fragColor = vColor;\n}\n",bufferLayout:t,...n})}(s,n.getBufferLayouts({isInstanced:!1}),t.getShaders.call(this,t),e);this.setState({filterFBO:r,filterModel:o})}}updateState({props:e,oldProps:t,changeFlags:n},r){const o=this.getAttributeManager(),{categorySize:i}=r.opts;if(this.state.filterModel){const n=o.attributes.filterValues?.needsUpdate()||o.attributes.filterCategoryValues?.needsUpdate()||e.filterEnabled!==t.filterEnabled||e.filterRange!==t.filterRange||e.filterSoftRange!==t.filterSoftRange||e.filterCategories!==t.filterCategories;n&&this.setState({filterNeedsUpdate:n})}if(o?.attributes.filterCategoryValues){(o.attributes.filterCategoryValues.needsUpdate()||!aM(e.filterCategories,t.filterCategories,2))&&this.setState({categoryBitMask:null});n.dataChanged&&(this.setState({categoryMap:Array(i).fill(0).map(()=>({}))}),o.attributes.filterCategoryValues.setNeedsUpdate("categoryMap"))}}draw(e,t){const n=this.state.filterFBO,r=this.state.filterModel,o=this.state.filterNeedsUpdate;this.state.categoryBitMask||t._updateCategoryBitMask.call(this,e,t);const{onFilteredItemsChange:i,extensions:s,filterEnabled:a,filterRange:l,filterSoftRange:c,filterTransformSize:u,filterTransformColor:d,filterCategories:A}=this.props,h={extensions:s,filterEnabled:a,filterRange:l,filterSoftRange:c,filterTransformSize:u,filterTransformColor:d,filterCategories:A};if(this.state.categoryBitMask&&(h.categoryBitMask=this.state.categoryBitMask),this.setShaderModuleProps({dataFilter:h}),o&&i&&r){const e=this.getAttributeManager(),{attributes:{filterValues:t,filterCategoryValues:o,filterVertexIndices:s}}=e;r.setVertexCount(this.getNumInstances());const a={...t?.getValue(),...o?.getValue(),...s?.getValue()};r.setAttributes(a),r.shaderInputs.setProps({dataFilter:h});const l=[0,0,n.width,n.height],c=r.device.beginRenderPass({id:"data-filter-aggregation",framebuffer:n,parameters:{viewport:l},clearColor:[0,0,0,0]});r.setParameters(OD),r.draw(c),c.end();const u=r.device.readPixelsToArrayWebGL(n);let d=0;for(let n=0;n<u.length;n++)d+=u[n];i({id:this.id,count:d}),this.state.filterNeedsUpdate=!1}}finalizeState(){const e=this.state.filterFBO,t=this.state.filterModel;e?.destroy(),t?.destroy()}_updateCategoryBitMask(e,t){const{categorySize:n}=t.opts;if(!n)return;const{filterCategories:r}=this.props,o=new Uint32Array([0,0,0,0]),i=1===n?[r]:r,s=1===n?128:2===n?64:32;for(let a=0;a<i.length;a++){const e=i[a];for(const n of e){const e=t._getCategoryKey.call(this,n,a);if(e<s){o[a*(s/32)+Math.floor(e/32)]+=Math.pow(2,e%32)}else AC.warn(`Exceeded maximum number of categories (${s})`)()}}this.state.categoryBitMask=o}_getCategoryKey(e,t){const n=this.state.categoryMap[t];return e in n||(n[e]=Object.keys(n).length),n[e]}}QD.defaultProps={getFilterValue:{type:"accessor",value:0},getFilterCategory:{type:"accessor",value:0},onFilteredItemsChange:{type:"function",value:null,optional:!0},filterEnabled:!0,filterRange:[-1,1],filterSoftRange:null,filterCategories:[0],filterTransformSize:!0,filterTransformColor:!0},QD.extensionName="DataFilterExtension";const zD={local:"Typically neighborhood streets and small rural roads for local use.",arterial:"Major urban roads between neighborhoods.",highway:"Major highways running through the country."},HD=[{value:"ROAD_PRIORITY_UNSPECIFIED",label:"Unspecified",description:"Default placeholder when priority is unknown.",category:"local"},{value:"ROAD_PRIORITY_NON_TRAFFIC",label:"Non-Traffic",description:"Pedestrian malls, utility, or emergency-only paths.",category:"local"},{value:"ROAD_PRIORITY_TERMINAL",label:"Terminal",description:"Dead-end accesses meant only for reaching a destination.",category:"local"},{value:"ROAD_PRIORITY_LOCAL",label:"Local",description:"Neighborhood streets and small rural roads for local use.",category:"local"},{value:"ROAD_PRIORITY_MINOR_ARTERIAL",label:"Minor Arterial",description:"Collectors guiding traffic from locals to larger arterials.",category:"arterial"},{value:"ROAD_PRIORITY_MAJOR_ARTERIAL",label:"Major Arterial",description:"High-capacity urban roads between neighborhoods.",category:"arterial"},{value:"ROAD_PRIORITY_SECONDARY_ROAD",label:"Secondary Road",description:"Connects arterials to primary highways or regional routes.",category:"arterial"},{value:"ROAD_PRIORITY_PRIMARY_HIGHWAY",label:"Primary Highway",description:"Major highways with few access restrictions.",category:"highway"},{value:"ROAD_PRIORITY_LIMITED_ACCESS",label:"Limited Access",description:"Expressways with spaced intersections and frontage roads.",category:"highway"},{value:"ROAD_PRIORITY_CONTROLLED_ACCESS",label:"Controlled Access",description:"Freeways accessible only via grade-separated ramps.",category:"highway"}],GD=Object.entries({local:"Local Roads",arterial:"Arterial Roads",highway:"Highways"}).map(([e,t])=>({id:e,label:t,description:zD[e]})),VD=HD.reduce((e,t)=>(e[t.value]=t.label,e),{}),WD=HD.map(e=>e.value);new QD({categorySize:1});const $D=[96,96,96,100],KD={failed:[220,38,38,255],pending:[245,158,11,255],synced:[34,197,94,255],unsynced:[251,146,60,255],validating:[59,130,246,255],invalid:[185,28,28,255]},XD=[0,191,255,255],YD=[68,13,250,255],qD=[168,85,247,255],JD=[0,191,255,200],ZD=[37,99,235,255],eN=[147,51,234,255],tN=[255,235,59,255],nN=[71,85,105,200],rN=[156,163,175,255],oN=[34,0,141,255],iN=16,sN=3,aN=25,lN={failed:[255,59,48,255],pending:[255,204,0,255],synced:[52,199,89,255],unsynced:[255,149,0,255],validating:[0,122,255,255],invalid:[255,45,85,255]},cN=[0,199,190,255],uN=[68,13,250,255],dN=[252,123,237,255],AN=[0,199,190,255],hN=[0,122,255,255],pN=[255,100,255,255],fN=[255,235,59,255],gN=[255,255,255,255],mN=[255,255,255,255],yN=[34,0,141,255],vN=[255,255,255,150],bN=[96,96,96,255],wN=[168,85,247,255],xN=[255,152,0,255],_N=[255,235,59,255],CN=[76,175,80,255],SN=[128,128,128,200],EN=[255,255,255,255],BN=[252,123,237,255],IN=[255,149,0,255],RN=[255,204,0,255],kN=[52,199,89,255],TN=[180,180,180,200],PN=e=>{try{localStorage.setItem("selectedRoadPriorities",JSON.stringify(e))}catch(t){}},FN=(e,t)=>({roadsNetwork:{roads:[],isLoading:!1,error:void 0},roadSelection:{mode:"none",selectedRoadIds:[],highlightedRoads:[],validationStatus:"idle",validationResult:null,isValidating:!1,error:null,isPreview:!1},selectedRoadPriorities:WD,setRoadsNetwork:t=>{e(e=>({roadsNetwork:{...e.roadsNetwork,roads:t,isLoading:!1,error:void 0}}))},setRoadsLoading:t=>{e(e=>({roadsNetwork:{...e.roadsNetwork,isLoading:t}}))},setRoadsError:t=>{e(e=>({roadsNetwork:{...e.roadsNetwork,error:t,isLoading:!1}}))},clearRoadsNetwork:()=>{e(()=>({roadsNetwork:{roads:[],isLoading:!1,error:void 0}}))},startStretchMode:(t,n={})=>{const{isPreview:r=!1}=n;e(e=>({roadSelection:{...e.roadSelection,mode:"stretch",selectedRoadIds:t.map(e=>parseInt(e.id)),highlightedRoads:t,validationStatus:"valid",validationResult:null,isValidating:!1,error:null,isPreview:r}}))},startMultiSelectMode:t=>{e(e=>({roadSelection:{...e.roadSelection,mode:"multi-select",selectedRoadIds:[parseInt(t.id)],highlightedRoads:[t],validationStatus:"idle",validationResult:null,isValidating:!1,error:null,isPreview:!1}}))},addRoadToSelection:n=>{const{roadSelection:r}=t(),o=parseInt(n.id);r.selectedRoadIds.includes(o)||e(e=>({roadSelection:{...e.roadSelection,selectedRoadIds:[...e.roadSelection.selectedRoadIds,o],highlightedRoads:[...e.roadSelection.highlightedRoads,n],isPreview:!1}}))},removeRoadFromSelection:t=>{e(e=>({roadSelection:{...e.roadSelection,selectedRoadIds:e.roadSelection.selectedRoadIds.filter(e=>e!==t),highlightedRoads:e.roadSelection.highlightedRoads.filter(e=>parseInt(e.id)!==t),isPreview:!1}}))},clearRoadSelection:()=>{e(()=>({roadSelection:{mode:"none",selectedRoadIds:[],highlightedRoads:[],validationStatus:"idle",validationResult:null,isValidating:!1,error:null,isPreview:!1}}))},setValidationResult:t=>{e(e=>({roadSelection:{...e.roadSelection,validationResult:t,validationStatus:t?.is_continuous?"valid":"invalid",isPreview:!1}}))},setValidationStatus:t=>{e(e=>({roadSelection:{...e.roadSelection,validationStatus:t,isPreview:!1}}))},setIsValidating:t=>{e(e=>({roadSelection:{...e.roadSelection,isValidating:t,isPreview:!1}}))},setRoadSelectionError:t=>{e(e=>({roadSelection:{...e.roadSelection,error:t,isPreview:!1}}))},exitSelectionMode:()=>{e(()=>({roadSelection:{mode:"none",selectedRoadIds:[],highlightedRoads:[],validationStatus:"idle",validationResult:null,isValidating:!1,error:null,isPreview:!1}}))},setSelectedRoadPriorities:t=>{PN(t),e(()=>({selectedRoadPriorities:t}))},toggleRoadPriorityFilter:t=>{e(e=>{const n=e.selectedRoadPriorities.includes(t)?e.selectedRoadPriorities.filter(e=>e!==t):[...e.selectedRoadPriorities,t];return PN(n),{selectedRoadPriorities:n}})},resetRoadPriorityFilters:()=>{PN(WD),e({selectedRoadPriorities:WD})}});function MN(e,t){const n=LN(t.lat-e.lat),r=LN(t.lng-e.lng),o=Math.sin(n/2)*Math.sin(n/2)+Math.cos(LN(e.lat))*Math.cos(LN(t.lat))*Math.sin(r/2)*Math.sin(r/2);return 6371e3*(2*Math.atan2(Math.sqrt(o),Math.sqrt(1-o)))}function LN(e){return e*(Math.PI/180)}function UN(e,t,n){const r=e.lng-t.lng,o=e.lat-t.lat,i=n.lng-t.lng,s=n.lat-t.lat,a=i*i+s*s;if(0===a)return t;const l=(r*i+o*s)/a;let c,u;return l<0?(c=t.lng,u=t.lat):l>1?(c=n.lng,u=n.lat):(c=t.lng+l*i,u=t.lat+l*s),{lat:u,lng:c}}function ON(e,t,n,r){if(!n||!t)return{snappedPoint:e,isSnapped:!1,distance:0};try{const n=function(e){const t=[];let n=0,r=0,o=0;for(;n<e.length;){let i,s=0,a=0;do{i=e.charCodeAt(n++)-63,a|=(31&i)<<s,s+=5}while(i>=32);r+=1&a?~(a>>1):a>>1,s=0,a=0;do{i=e.charCodeAt(n++)-63,a|=(31&i)<<s,s+=5}while(i>=32);o+=1&a?~(a>>1):a>>1,t.push({lat:r/1e5,lng:o/1e5})}return t}(t),o=function(e,t,n=10){if(t.length<2)return{snappedPoint:e,distance:0,isSnapped:!1};let r=t[0],o=MN(e,t[0]);for(let s=0;s<t.length-1;s++){const n=UN(e,t[s],t[s+1]),i=MN(e,n);i<o&&(o=i,r=n)}const i=o<=n;return{snappedPoint:i?r:e,distance:o,isSnapped:i}}(e,n,r);return{snappedPoint:o.snappedPoint,isSnapped:o.isSnapped,distance:o.distance}}catch(o){return{snappedPoint:e,isSnapped:!1,distance:0}}}function DN(e,t){let n=0;for(let r=0;r<t.length-1;r++){const o=t[r],i=UN(e,o,t[r+1]);if(MN(e,i)<10){for(let e=0;e<=r;e++)n+=e<r?MN(t[e],t[e+1]):MN(o,i);break}}return n}function NN(e){return new Worker("/assets/segmentation-worker-CuqIL114.js",{type:"module",name:e?.name})}function jN(e,t){const n=pb(e.map(e=>[e[0],e[1]])),r=Ab([t.lng,t.lat]),o=dw(n,r,{units:"kilometers"}).geometry.coordinates;let i=0,s=Number.MAX_VALUE;for(let a=0;a<e.length-1;a++){const n=e[a],o=e[a+1],l=dw(pb([[n[0],n[1]],[o[0],o[1]]]),r,{units:"kilometers"}),c=Fb(Ab([t.lng,t.lat]),l,"kilometers");c<s&&(s=c,i=a+1)}return{index:i,coordinate:o}}function QN(e){return function(e){if(e.length<2)return 0;let t=0;for(let n=0;n<e.length-1;n++)t+=Fb(Ab([e[n][0],e[n][1]]),Ab([e[n+1][0],e[n+1][1]]),"kilometers");return t}(e)}function zN(e,t,n,r,o){const i=function(e){const t=[0];for(let n=0;n<e.length-1;n++){const r=e[n],o=e[n+1],i=Fb(Ab([r[0],r[1]]),Ab([o[0],o[1]]),"kilometers");t.push(t[n]+i)}return t}(e),s=[],a=n>=i[i.length-1];let l=0,c=e.length-1;if(t>0)for(let d=0;d<i.length-1;d++){if(i[d]<=t&&i[d+1]>=t){l=d;break}if(i[d]>=t){l=d;break}}else l=0;if(a)c=e.length-1;else for(let d=0;d<i.length-1;d++){if(i[d]<=n&&i[d+1]>=n){c=d+1;break}if(i[d]>=n){c=d;break}}l=Math.max(0,Math.min(l,e.length-1)),c=Math.max(l,Math.min(c,e.length-1));if(r&&o&&(l===c||c===l+1&&i[l]<t&&i[c]>n)&&r&&o)s.push(r),r[0]===o[0]&&r[1]===o[1]||s.push(o);else{if(r)s.push(r);else if(0===t&&e.length>0){const t=e[0];(!o||Math.abs(t[0]-o[0])>=1e-10||Math.abs(t[1]-o[1])>=1e-10)&&s.push(t),l=Math.max(1,l)}for(let a=l;a<=c;a++){const l=e[a],c=i[a];if(c<t||c>n)continue;const u=r&&Math.abs(l[0]-r[0])<1e-10&&Math.abs(l[1]-r[1])<1e-10,d=o&&Math.abs(l[0]-o[0])<1e-10&&Math.abs(l[1]-o[1])<1e-10;u||d||s.push(l)}if(o){const e=s[s.length-1];e&&e[0]===o[0]&&e[1]===o[1]||s.push(o)}else if(a&&e.length>0){const t=e[e.length-1],n=s[s.length-1];n&&n[0]===t[0]&&n[1]===t[1]||s.push(t)}}const u=[];for(let d=0;d<s.length;d++)0!==d&&s[d][0]===s[d-1][0]&&s[d][1]===s[d-1][1]||u.push(s[d]);return u.length>=2?u:s}const HN=(e,t)=>{let n=null,r=null;const o=()=>(n||(n=new NN,n.onmessage=n=>{const{type:o,payload:i}=n.data,s=i.requestId;if(r&&r===s)if("SEGMENTS_CHUNK"===o){if(i.isComplete&&r===s){const n=t().segmentation.distanceKm;e(e=>({segmentation:{...e.segmentation,previewSegments:i.segments,selectedSegmentIds:new Set(i.segments.map(e=>e.id)),isCalculating:!1,error:void 0,calculatedDistanceKm:n}})),r=null}}else"ERROR"===o&&r===s&&(e(e=>({segmentation:{...e.segmentation,isCalculating:!1,error:i.error||"Segmentation calculation failed. Please try again.",previewSegments:[]}})),r=null)},n.onerror=t=>{const n=r;null!==n&&(e(e=>({segmentation:{...e.segmentation,isCalculating:!1,error:"Segmentation calculation failed. Please try again with different parameters.",previewSegments:[]}})),r===n&&(r=null))}),n),i=function(e,t){let n;return(...r)=>{clearTimeout(n),n=setTimeout(()=>e(...r),t)}}(()=>{const{segmentation:n}=t();if(n.targetRoute)if("distance"!==n.type||n.distanceKm){e(e=>({segmentation:{...e.segmentation,isCalculating:!0,error:void 0}}));try{if(!n.targetRoute.encodedPolyline)throw new Error("Route has no encoded polyline");const t=Sw(n.targetRoute.encodedPolyline);if(!t.coordinates||0===t.coordinates.length)throw new Error("Invalid route coordinates");const i=t.coordinates,s=[0];for(let e=0;e<i.length-1;e++){const t=Fb(Ab([i[e][0],i[e][1]]),Ab([i[e+1][0],i[e+1][1]]),"kilometers");s.push(s[e]+t)}const a=s[s.length-1];if(e(e=>({segmentation:{...e.segmentation,calculatedRouteLengthKm:a}})),"distance"===n.type&&n.distanceKm){const t=n.distanceKm;if(n.calculatedDistanceKm===t&&n.previewSegments.length>0&&!n.error)return void e(e=>({segmentation:{...e.segmentation,isCalculating:!1}}));if(a<=t+.001)return r=null,void e(e=>({segmentation:{...e.segmentation,isCalculating:!1,error:`ROUTE_LENGTH_${a}_SEGMENT_DISTANCE_${t}`,previewSegments:[],calculatedDistanceKm:void 0}}));const i=Math.ceil(a/t);if(i>1e4)return r=null,void e(e=>({segmentation:{...e.segmentation,isCalculating:!1,error:`MAX_SEGMENTS_EXCEEDED_${i}_LIMIT_10000_ROUTE_LENGTH_${a}_DISTANCE_${t}`,previewSegments:[],calculatedDistanceKm:void 0}}));const s=o(),l=`${Date.now()}-${Math.random()}`;return r=l,void s.postMessage({type:"CALCULATE_SEGMENTS",payload:{encodedPolyline:n.targetRoute.encodedPolyline,distanceKm:t,routeId:n.targetRoute.id,requestId:l}})}let l=[];if("manual"!==n.type&&"intersections"!==n.type){if(!n.distanceKm)throw new Error("Distance is required for distance-based segmentation");const e=o(),t=`${Date.now()}-${Math.random()}`;return r=t,void e.postMessage({type:"CALCULATE_SEGMENTS",payload:{encodedPolyline:n.targetRoute.encodedPolyline,distanceKm:n.distanceKm,routeId:n.targetRoute.id,requestId:t}})}{const e=[0];for(let t=0;t<i.length-1;t++){const n=Fb(Ab([i[t][0],i[t][1]]),Ab([i[t+1][0],i[t+1][1]]),"kilometers");e.push(e[t]+n)}l=n.cutPoints.map(n=>{const r=jN(t.coordinates,n.coordinates),o=[n.coordinates.lng,n.coordinates.lat];let s=0;const a=Math.max(0,Math.min(r.index-1,e.length-2));if(s=e[a]||0,a<i.length-1){const e=i[a],t=i[a+1],n=dw(pb([[e[0],e[1]],[t[0],t[1]]]),Ab(o),{units:"kilometers"});s+=Fb(Ab([e[0],e[1]]),n,"kilometers")}return{index:r.index,coordinate:[n.coordinates.lng,n.coordinates.lat],distanceAlongRoute:s}}).sort((e,t)=>e.distanceAlongRoute-t.distanceAlongRoute)}const c=[];if(("manual"===n.type||"intersections"===n.type)&&l.length>0){if(l.some(e=>void 0!==e.distanceAlongRoute)){const e=l[0],t=zN(i,0,e.distanceAlongRoute||0,void 0,e.coordinate);if(t.length>=2){const r=(e.distanceAlongRoute||0)-0,o={id:"temp-segment-0",routeId:n.targetRoute.id,name:"Segment 1",linestringGeoJson:{type:"LineString",coordinates:t},segmentOrder:1,distanceKm:r,createdAt:(new Date).toISOString()};c.push(o)}for(let s=1;s<l.length;s++){const e=l[s-1],t=l[s],r=zN(i,e.distanceAlongRoute||0,t.distanceAlongRoute||a,e.coordinate,t.coordinate);if(r.length>=2){const o=e.distanceAlongRoute||0,i=(t.distanceAlongRoute||a)-o;c.push({id:`temp-segment-${s}`,routeId:n.targetRoute.id,name:`Segment ${s+1}`,linestringGeoJson:{type:"LineString",coordinates:r},segmentOrder:s+1,distanceKm:i,createdAt:(new Date).toISOString()})}}const r=l[l.length-1],o=zN(i,r.distanceAlongRoute||0,a,r.coordinate,void 0);if(o.length>=2){const e=r.distanceAlongRoute||0,t=a-e;c.push({id:`temp-segment-${c.length}`,routeId:n.targetRoute.id,name:`Segment ${c.length+1}`,linestringGeoJson:{type:"LineString",coordinates:o},segmentOrder:c.length+1,distanceKm:t,createdAt:(new Date).toISOString()})}}else{const e=l[0],t=[i[0]];for(let n=1;n<e.index;n++)t.push(i[n]);t.push(e.coordinate),t.length>=2&&c.push({id:"temp-segment-0",routeId:n.targetRoute.id,name:"Segment 1",linestringGeoJson:{type:"LineString",coordinates:t},segmentOrder:1,distanceKm:QN(t),createdAt:(new Date).toISOString()});for(let s=1;s<l.length;s++){const e=l[s-1],t=l[s];if(t.index<=e.index)continue;const r=[e.coordinate];for(let n=e.index;n<t.index;n++)r.push(i[n]);r.push(t.coordinate),r.length>=2&&c.push({id:`temp-segment-${s}`,routeId:n.targetRoute.id,name:`Segment ${s+1}`,linestringGeoJson:{type:"LineString",coordinates:r},segmentOrder:s+1,distanceKm:QN(r),createdAt:(new Date).toISOString()})}const r=l[l.length-1],o=[r.coordinate];for(let n=r.index;n<i.length;n++)o.push(i[n]);o.length>=2&&c.push({id:`temp-segment-${c.length}`,routeId:n.targetRoute.id,name:`Segment ${c.length+1}`,linestringGeoJson:{type:"LineString",coordinates:o},segmentOrder:c.length+1,distanceKm:QN(o),createdAt:(new Date).toISOString()})}}const u=new Set(c.map(e=>e.id));e(e=>({segmentation:{...e.segmentation,previewSegments:c,selectedSegmentIds:u,isCalculating:!1}}))}catch(i){e(e=>({segmentation:{...e.segmentation,isCalculating:!1,error:i.message}}))}}else e(e=>({segmentation:{...e.segmentation,isCalculating:!1,error:void 0,previewSegments:[]}}))},300);return{segmentation:{targetRoute:null,cutPoints:[],type:"manual",distanceKm:void 0,isActive:!1,previewSegments:[],selectedSegmentIds:new Set,hoveredSegmentId:null,isCalculating:!1,error:void 0,snapToRoute:!0,snapPrecision:10,isDragging:!1,dragStartPosition:void 0,snapshots:[],calculatedRouteLengthKm:void 0,calculatedDistanceKm:void 0},startSegmentation:(t,n)=>{$N.temporal.getState().clear(),e(()=>({segmentation:{targetRoute:t,cutPoints:[],type:n,distanceKm:void 0,isActive:!0,previewSegments:[],selectedSegmentIds:new Set,hoveredSegmentId:null,isCalculating:!1,error:void 0,snapToRoute:!0,snapPrecision:10,isDragging:!1,dragStartPosition:void 0,snapshots:[]}}));const{setMapMode:r,mapMode:o}=JN.getState();"individual_drawing"!==o&&r("segmentation")},addCutPoint:n=>{const{segmentation:r}=t(),o="manual"===r.type;let s={...n};if(o){if(!r.targetRoute?.encodedPolyline)return void e(e=>({segmentation:{...e.segmentation,error:"Cannot add manual cut: route data is missing."}}));{const t=ON(n.coordinates,r.targetRoute.encodedPolyline,!0,r.snapPrecision);if(!t.isSnapped)return void e(e=>({segmentation:{...e.segmentation,error:`Click is too far from the route. Please click directly on the route (within ${r.snapPrecision}m).`}}));s={...n,coordinates:t.snappedPoint,snappedCoordinates:t.snappedPoint,isSnapped:!0};try{const e=Sw(r.targetRoute.encodedPolyline);if("LineString"===e.type){const n=e.coordinates.map(([e,t])=>({lat:t,lng:e}));s.distanceFromStart=DN(t.snappedPoint,n)}}catch(a){}}}else if(r.snapToRoute&&r.targetRoute?.encodedPolyline){const e=ON(n.coordinates,r.targetRoute.encodedPolyline,r.snapToRoute,r.snapPrecision);if(s={...n,coordinates:e.snappedPoint,snappedCoordinates:e.isSnapped?e.snappedPoint:void 0,isSnapped:e.isSnapped},e.isSnapped&&r.targetRoute.encodedPolyline)try{const t=Sw(r.targetRoute.encodedPolyline);if("LineString"===t.type){const n=t.coordinates.map(([e,t])=>({lat:t,lng:e}));s.distanceFromStart=DN(e.snappedPoint,n)}}catch(a){}}e(e=>({segmentation:{...e.segmentation,error:void 0}})),e(e=>({segmentation:{...e.segmentation,cutPoints:[...e.segmentation.cutPoints,s]}})),i()},removeCutPoint:n=>{const{segmentation:r}=t();r.cutPoints.find(e=>e.id===n)&&(e(e=>({segmentation:{...e.segmentation,cutPoints:e.segmentation.cutPoints.filter(e=>e.id!==n)}})),i())},updateCutPoint:(n,r)=>{const{segmentation:o}=t();o.cutPoints.find(e=>e.id===n)&&(e(e=>({segmentation:{...e.segmentation,cutPoints:e.segmentation.cutPoints.map(e=>e.id===n?{...e,coordinates:r}:e)}})),i())},clearCutPoints:()=>{e(e=>({segmentation:{...e.segmentation,cutPoints:[]}}))},stopSegmentation:()=>{e(e=>({segmentation:{...e.segmentation,targetRoute:null,cutPoints:[],type:"manual",distanceKm:void 0,isActive:!1,previewSegments:[],selectedSegmentIds:new Set,hoveredSegmentId:null,isCalculating:!1,error:void 0,snapToRoute:!0,snapPrecision:10,isDragging:!1,dragStartPosition:void 0,snapshots:[]}}));const{setMapMode:t,mapMode:n}=JN.getState();"individual_drawing"!==n&&t("view")},setDistanceKm:n=>{const{segmentation:o}=t();if(n<.01)e(e=>({segmentation:{...e.segmentation,distanceKm:n,error:"Distance must be at least 0.01 km",previewSegments:[]}}));else{if(o.targetRoute){let t=null;if(o.targetRoute.encodedPolyline)try{const e=Sw(o.targetRoute.encodedPolyline);if(e.coordinates&&e.coordinates.length>0){const n=e.coordinates,r=[0];for(let e=0;e<n.length-1;e++){const t=Fb(Ab([n[e][0],n[e][1]]),Ab([n[e+1][0],n[e+1][1]]),"kilometers");r.push(r[e]+t)}t=r[r.length-1]}}catch(s){const e=o.targetRoute;t=e.distance}else{const e=o.targetRoute;t=e.distance}if(null!==t&&t<=n+.001)return r=null,void e(e=>({segmentation:{...e.segmentation,distanceKm:n,error:`ROUTE_LENGTH_${t}_SEGMENT_DISTANCE_${n}`,previewSegments:[],isCalculating:!1,calculatedDistanceKm:void 0}}))}e(e=>({segmentation:{...e.segmentation,distanceKm:n,error:void 0}})),i()}},calculatePreviewSegments:()=>{i()},clearPreviewSegments:()=>{e(e=>({segmentation:{...e.segmentation,previewSegments:[],selectedSegmentIds:new Set,hoveredSegmentId:null}}))},toggleSegmentSelection:t=>{e(e=>{const n=new Set(e.segmentation.selectedSegmentIds);return n.has(t)?n.delete(t):n.add(t),{segmentation:{...e.segmentation,selectedSegmentIds:n}}})},selectAllSegments:()=>{e(e=>{const t=new Set(e.segmentation.previewSegments.map(e=>e.id));return{segmentation:{...e.segmentation,selectedSegmentIds:t}}})},deselectAllSegments:()=>{e(e=>({segmentation:{...e.segmentation,selectedSegmentIds:new Set}}))},setHoveredSegmentId:t=>{e(e=>({segmentation:{...e.segmentation,hoveredSegmentId:t}}))},setSnapToRoute:t=>{e(e=>({segmentation:{...e.segmentation,snapToRoute:t}}))},setSnapPrecision:t=>{e(e=>({segmentation:{...e.segmentation,snapPrecision:t}}))},startDragging:(t,n)=>{e(e=>({segmentation:{...e.segmentation,isDragging:!0,dragStartPosition:n,cutPoints:e.segmentation.cutPoints.map(e=>e.id===t?{...e,isDragging:!0}:e)}}))},updateDragging:(n,r)=>{const{segmentation:o}=t();let s=r,a=!1;if(o.snapToRoute&&o.targetRoute?.encodedPolyline){const e=ON(r,o.targetRoute.encodedPolyline,o.snapToRoute,o.snapPrecision);s=e.snappedPoint,a=e.isSnapped}e(e=>({segmentation:{...e.segmentation,cutPoints:e.segmentation.cutPoints.map(e=>e.id===n?{...e,coordinates:s,isSnapped:a,snappedCoordinates:a?s:e.snappedCoordinates}:e)}})),i()},endDragging:(n,r)=>{const{segmentation:o}=t();o.cutPoints.find(e=>e.id===n)&&o.dragStartPosition&&e(e=>({segmentation:{...e.segmentation,isDragging:!1,dragStartPosition:void 0,cutPoints:e.segmentation.cutPoints.map(e=>e.id===n?{...e,isDragging:!1,coordinates:r}:e)}})),i()},applySegmentation:async n=>{const{segmentation:r}=t();if(!r.targetRoute)throw new Error("No target route selected");try{const{routesApi:e}=await Ie(async()=>{const{routesApi:e}=await Promise.resolve().then(()=>Ej);return{routesApi:e}},[]),o=await e.applySegmentation(r.targetRoute.id,n);if(!o.success)throw new Error(o.message||"Failed to apply segmentation");{const{updateRoute:e}=JN.getState();e(r.targetRoute.id,{isSegmented:!0,roads:n.segments,segmentCount:n.segments.length,segmentationType:n.type,updatedAt:(new Date).toISOString()}),t().stopSegmentation()}}catch(o){throw e(e=>({segmentation:{...e.segmentation,error:o.message}})),o}},createSnapshot:n=>{const{segmentation:r}=t();if(!r.targetRoute)return;const o={id:`snapshot_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,routeId:r.targetRoute.id,cutPoints:[...r.cutPoints],segments:[...r.previewSegments],createdAt:new Date,description:n};e(e=>({segmentation:{...e.segmentation,snapshots:[o,...e.segmentation.snapshots.slice(0,9)]}}))},restoreSnapshot:n=>{const{segmentation:r}=t(),o=r.snapshots.find(e=>e.id===n);o&&(e(e=>({segmentation:{...e.segmentation,cutPoints:[...o.cutPoints],previewSegments:[...o.segments]}})),i())},getSnapshots:()=>{const{segmentation:e}=t();return e.snapshots},loadExistingCutPoints:n=>{try{const r=n.cutPoints.map((e,n)=>({id:e.id,routeId:t().segmentation.targetRoute?.id||"",coordinates:e.coordinates,cutOrder:n,distanceFromStart:0,createdAt:(new Date).toISOString(),updatedAt:(new Date).toISOString(),isSnapped:!0}));e(e=>({segmentation:{...e.segmentation,cutPoints:r,type:n.segmentationType||"manual",distanceKm:n.distanceKm}})),t().calculatePreviewSegments()}catch(r){throw r}},clearSegmentation:()=>{r=null,e(e=>({segmentation:{...e.segmentation,targetRoute:null,cutPoints:[],type:"manual",distanceKm:void 0,isActive:!1,previewSegments:[],selectedSegmentIds:new Set,hoveredSegmentId:null,isCalculating:!1,error:void 0,snapToRoute:!0,snapPrecision:10,isDragging:!1,dragStartPosition:void 0,history:[],historyIndex:-1,snapshots:[]}}))},fetchIntersectionsAndCreateSegments:async()=>{const{segmentation:n}=t();if(n.targetRoute?.encodedPolyline){e(e=>({segmentation:{...e.segmentation,isCalculating:!0,error:void 0}}));try{const{routesApi:r}=await Ie(async()=>{const{routesApi:e}=await Promise.resolve().then(()=>xj);return{routesApi:e}},void 0),o=await r.getIntersections(n.targetRoute.encodedPolyline);if(!o.success)throw new Error(o.message||"Failed to fetch intersections");const i=o.data.features||[];if(0===i.length)return void e(e=>({segmentation:{...e.segmentation,isCalculating:!1,error:"No intersections found along this route",cutPoints:[]}}));const s=Sw(n.targetRoute.encodedPolyline),a=i.map((e,t)=>{if("Point"!==e.geometry.type)return null;const[r,o]=e.geometry.coordinates,i=jN(s.coordinates,{lat:o,lng:r});return{id:`intersection-${t}-${Date.now()}`,routeId:n.targetRoute.id,coordinates:{lat:i.coordinate[1],lng:i.coordinate[0]},cutOrder:t,distanceFromStart:0,createdAt:(new Date).toISOString(),updatedAt:(new Date).toISOString(),isSnapped:!0}}).filter(e=>null!==e),l=s.coordinates,c=(pb(l.map(e=>[e[0],e[1]])),[0]);for(let e=0;e<l.length-1;e++){const t=Fb(Ab([l[e][0],l[e][1]]),Ab([l[e+1][0],l[e+1][1]]),"kilometers");c.push(c[e]+t)}const u=a.map(e=>{const t=jN(s.coordinates,e.coordinates),n=Math.max(0,Math.min(t.index-1,c.length-2));let r=c[n]||0;if(n<l.length-1){const t=l[n],o=l[n+1],i=dw(pb([[t[0],t[1]],[o[0],o[1]]]),Ab([e.coordinates.lng,e.coordinates.lat]),{units:"kilometers"});r+=Fb(Ab([t[0],t[1]]),i,"kilometers")}return{cutPoint:e,distanceAlongRoute:r}}).sort((e,t)=>e.distanceAlongRoute-t.distanceAlongRoute).map((e,t)=>({...e.cutPoint,cutOrder:t,distanceFromStart:1e3*e.distanceAlongRoute}));e(e=>({segmentation:{...e.segmentation,cutPoints:u,isCalculating:!1,error:void 0}})),t().calculatePreviewSegments()}catch(r){e(e=>({segmentation:{...e.segmentation,isCalculating:!1,error:r.message||"Failed to fetch intersections"}}))}}else e(e=>({segmentation:{...e.segmentation,isCalculating:!1,error:"Route has no encoded polyline"}}))},switchToManualMode:()=>{$N.temporal.getState().clear(),e(e=>({segmentation:{...e.segmentation,type:"manual",error:void 0,previewSegments:[]}})),i()},switchToDistanceMode:()=>{$N.temporal.getState().clear(),e(e=>({segmentation:{...e.segmentation,type:"distance",cutPoints:[],distanceKm:void 0,error:void 0,previewSegments:[]}})),i()}}},GN=(e,t)=>({hoveredFeature:null,currentZoom:void 0,showTileLayerArrows:!1,markerDragEndTime:0,selectedRouteHoveredSegmentId:null,roadsTilesTimestamp:Date.now(),routesTilesTimestamp:Date.now(),routesTileCache:new Map,refreshTrigger:Date.now(),drawingCompletionMenuPosition:null,setHoveredFeature:t=>{e(()=>({hoveredFeature:t}))},setCurrentZoom:n=>{const r=t().showTileLayerArrows,o=void 0!==n&&n>=16;e(()=>({currentZoom:n,...r!==o&&{showTileLayerArrows:o}}))},setMarkerDragEndTime:t=>{e(()=>({markerDragEndTime:t}))},setSelectedRouteHoveredSegmentId:t=>{e(()=>({selectedRouteHoveredSegmentId:t}))},refreshRoadsTilesTimestamp:()=>{e(()=>({roadsTilesTimestamp:Date.now()}))},refreshRoutesTilesTimestamp:()=>{e(()=>({routesTilesTimestamp:Date.now(),routesTileCache:new Map}))},refreshTilesTimestamp:()=>{e(()=>({roadsTilesTimestamp:Date.now(),routesTilesTimestamp:Date.now(),routesTileCache:new Map}))},setRefreshTrigger:()=>{e(()=>({refreshTrigger:Date.now()}))},updateRouteTilesFromWebSocket:n=>{const r=t().routesTileCache;r.delete(n),e(()=>({routesTileCache:new Map(r),routesTilesTimestamp:Date.now()}))},showDrawingCompletionMenu:(t,n)=>{e(()=>({drawingCompletionMenuPosition:{lat:t,lng:n}}))},hideDrawingCompletionMenu:()=>{e(()=>({drawingCompletionMenuPosition:null}))}}),VN=(e,t)=>({uploadedRoutes:{routes:[],isVisible:!0,focusRouteIds:[]},snappedRoads:{roads:[],isVisible:!0,isLoading:!1,routeMarkers:[],isDraggingMarker:!1,hoveredRouteId:null,previewRoads:[],editingStates:{}},selectedUploadedRouteId:null,isAddingWaypoint:!1,waypointAddingRouteId:null,editingSavedRouteId:null,addUploadedRoute:t=>{e(e=>({uploadedRoutes:{...e.uploadedRoutes,routes:[...e.uploadedRoutes.routes,t]}}))},updateUploadedRoute:(t,n)=>{e(e=>({uploadedRoutes:{...e.uploadedRoutes,routes:e.uploadedRoutes.routes.map(e=>e.id===t?{...e,...n}:e)}}))},removeUploadedRoute:t=>{e(e=>({uploadedRoutes:{...e.uploadedRoutes,routes:e.uploadedRoutes.routes.filter(e=>e.id!==t)}}))},clearUploadedRoutes:()=>{e(e=>({uploadedRoutes:{...e.uploadedRoutes,routes:[]}}))},setUploadedRoutesVisibility:t=>{e(e=>({uploadedRoutes:{...e.uploadedRoutes,isVisible:t}}))},focusOnUploadedRoutes:t=>{e(e=>({uploadedRoutes:{...e.uploadedRoutes,focusRouteIds:t}}))},clearUploadedRouteFocus:()=>{e(e=>({uploadedRoutes:{...e.uploadedRoutes,focusRouteIds:[]}}))},addSnappedRoads:(t,n)=>{e(e=>{const r=n.map((e,n)=>({id:`${t}-snapped-${n}`,uploadedRouteId:t,feature:e}));return{snappedRoads:{...e.snappedRoads,roads:[...e.snappedRoads.roads,...r]}}})},removeSnappedRoadsForRoute:t=>{e(e=>({snappedRoads:{...e.snappedRoads,roads:e.snappedRoads.roads.filter(e=>e.uploadedRouteId!==t)}}))},clearSnappedRoads:()=>{e(e=>({snappedRoads:{...e.snappedRoads,roads:[]}}))},addPreviewRoads:(t,n)=>{e(e=>{const r=n.map((e,n)=>({id:`${t}-preview-${n}`,uploadedRouteId:t,feature:e})),o=e.snappedRoads.previewRoads.filter(e=>e.uploadedRouteId!==t);return{snappedRoads:{...e.snappedRoads,previewRoads:[...o,...r]}}})},removePreviewRoadsForRoute:t=>{e(e=>({snappedRoads:{...e.snappedRoads,previewRoads:e.snappedRoads.previewRoads.filter(e=>e.uploadedRouteId!==t)}}))},setSnappedRoadsVisibility:t=>{e(e=>({snappedRoads:{...e.snappedRoads,isVisible:t}}))},setSnappedRoadsLoading:t=>{e(e=>({snappedRoads:{...e.snappedRoads,isLoading:t}}))},setOptimizedRouteMarkers:(t,n,r)=>{e(e=>{const o=e.snappedRoads.routeMarkers.findIndex(e=>e.routeId===t);let i;return o>=0?(i=[...e.snappedRoads.routeMarkers],i[o]={...i[o],routeId:t,startMarker:n,endMarker:r}):i=[...e.snappedRoads.routeMarkers,{routeId:t,startMarker:n,endMarker:r,waypoints:[]}],{snappedRoads:{...e.snappedRoads,routeMarkers:i,isDraggingMarker:!1}}})},updateOptimizedRouteMarker:(t,n,r)=>{e(e=>{const o=e.snappedRoads.routeMarkers.map(e=>e.routeId===t?{...e,["start"===n?"startMarker":"endMarker"]:r}:e),i=e.snappedRoads.editingStates[t],s=i?{...e.snappedRoads.editingStates,[t]:{...i,temporaryMarkers:{...i.temporaryMarkers,["start"===n?"startMarker":"endMarker"]:r}}}:e.snappedRoads.editingStates;return{snappedRoads:{...e.snappedRoads,routeMarkers:o,editingStates:s}}})},removeOptimizedRouteMarkers:t=>{e(e=>({snappedRoads:{...e.snappedRoads,routeMarkers:e.snappedRoads.routeMarkers.filter(e=>e.routeId!==t)}}))},clearAllOptimizedRouteMarkers:()=>{e(e=>({snappedRoads:{...e.snappedRoads,routeMarkers:[],isDraggingMarker:!1}}))},setDraggingMarker:t=>{e(e=>({snappedRoads:{...e.snappedRoads,isDraggingMarker:t}}))},setHoveredRouteId:t=>{e(e=>({snappedRoads:{...e.snappedRoads,hoveredRouteId:t}}))},setSelectedUploadedRouteId:t=>{e({selectedUploadedRouteId:t})},addWaypoint:(t,n)=>{e(e=>{const r=e.snappedRoads.routeMarkers.find(e=>e.routeId===t);if(!r)return e;const o={id:`waypoint_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,position:n,order:r.waypoints.length},i=e.snappedRoads.routeMarkers.map(e=>e.routeId===t?{...e,waypoints:[...e.waypoints,o]}:e),s=e.snappedRoads.editingStates[t],a=s?{...e.snappedRoads.editingStates,[t]:{...s,temporaryMarkers:{...s.temporaryMarkers,waypoints:[...s.temporaryMarkers.waypoints,o]}}}:e.snappedRoads.editingStates;return{snappedRoads:{...e.snappedRoads,routeMarkers:i,editingStates:a},isAddingWaypoint:!1,waypointAddingRouteId:null}})},removeWaypoint:(t,n)=>{e(e=>{const r=e.snappedRoads.routeMarkers.map(e=>{if(e.routeId!==t)return e;const r=e.waypoints.filter(e=>e.id!==n).map((e,t)=>({...e,order:t}));return{...e,waypoints:r}}),o=e.snappedRoads.editingStates[t],i=o?{...e.snappedRoads.editingStates,[t]:{...o,temporaryMarkers:{...o.temporaryMarkers,waypoints:o.temporaryMarkers.waypoints.filter(e=>e.id!==n).map((e,t)=>({...e,order:t}))}}}:e.snappedRoads.editingStates;return{snappedRoads:{...e.snappedRoads,routeMarkers:r,editingStates:i}}})},updateWaypoint:(t,n,r)=>{e(e=>{const o=e.snappedRoads.routeMarkers.map(e=>e.routeId!==t?e:{...e,waypoints:e.waypoints.map(e=>e.id===n?{...e,position:r}:e)}),i=e.snappedRoads.editingStates[t],s=i?{...e.snappedRoads.editingStates,[t]:{...i,temporaryMarkers:{...i.temporaryMarkers,waypoints:i.temporaryMarkers.waypoints.map(e=>e.id===n?{...e,position:r}:e)}}}:e.snappedRoads.editingStates;return{snappedRoads:{...e.snappedRoads,routeMarkers:o,editingStates:s}}})},moveWaypointUp:(t,n)=>{e(e=>{const r=e.snappedRoads.routeMarkers.map(e=>{if(e.routeId!==t)return e;const r=[...e.waypoints].sort((e,t)=>e.order-t.order),o=r.findIndex(e=>e.id===n);if(o<0)return e;if(0===o){const t=r[0].position,n=e.startMarker;return{...e,startMarker:t,waypoints:[{...r[0],position:n},...r.slice(1)].map((e,t)=>({...e,order:t}))}}[r[o-1],r[o]]=[r[o],r[o-1]];const i=r.map((e,t)=>({...e,order:t}));return{...e,waypoints:i}}),o=e.snappedRoads.editingStates[t],i=o?{...e.snappedRoads.editingStates,[t]:{...o,temporaryMarkers:(()=>{const e=o.temporaryMarkers,t=[...e.waypoints].sort((e,t)=>e.order-t.order),r=t.findIndex(e=>e.id===n);if(r<0)return e;if(0===r){const n=t[0].position,r=e.startMarker;return{...e,startMarker:n,waypoints:[{...t[0],position:r},...t.slice(1)].map((e,t)=>({...e,order:t}))}}return[t[r-1],t[r]]=[t[r],t[r-1]],{...e,waypoints:t.map((e,t)=>({...e,order:t}))}})()}}:e.snappedRoads.editingStates;return{snappedRoads:{...e.snappedRoads,routeMarkers:r,editingStates:i}}})},moveWaypointDown:(t,n)=>{e(e=>{const r=e.snappedRoads.routeMarkers.map(e=>{if(e.routeId!==t)return e;const r=[...e.waypoints].sort((e,t)=>e.order-t.order),o=r.findIndex(e=>e.id===n);if(o<0)return e;if(o>=r.length-1){const t=r[o].position,n=e.endMarker;return{...e,endMarker:t,waypoints:r.slice(0,-1).concat([{...r[o],position:n}]).map((e,t)=>({...e,order:t}))}}[r[o],r[o+1]]=[r[o+1],r[o]];const i=r.map((e,t)=>({...e,order:t}));return{...e,waypoints:i}}),o=e.snappedRoads.editingStates[t],i=o?{...e.snappedRoads.editingStates,[t]:{...o,temporaryMarkers:(()=>{const e=o.temporaryMarkers,t=[...e.waypoints].sort((e,t)=>e.order-t.order),r=t.findIndex(e=>e.id===n);if(r<0)return e;if(r>=t.length-1){const n=t[r].position,o=e.endMarker;return{...e,endMarker:n,waypoints:t.slice(0,-1).concat([{...t[r],position:o}]).map((e,t)=>({...e,order:t}))}}return[t[r],t[r+1]]=[t[r+1],t[r]],{...e,waypoints:t.map((e,t)=>({...e,order:t}))}})()}}:e.snappedRoads.editingStates;return{snappedRoads:{...e.snappedRoads,routeMarkers:r,editingStates:i}}})},moveOriginDown:t=>{e(e=>{const n=e.snappedRoads.routeMarkers.map(e=>{if(e.routeId!==t)return e;const n=[...e.waypoints].sort((e,t)=>e.order-t.order);if(0===n.length)return e;const r=n[0].position,o=e.startMarker;return{...e,startMarker:r,waypoints:[{...n[0],position:o},...n.slice(1)].map((e,t)=>({...e,order:t}))}}),r=e.snappedRoads.editingStates[t],o=r?{...e.snappedRoads.editingStates,[t]:{...r,temporaryMarkers:(()=>{const e=r.temporaryMarkers,t=[...e.waypoints].sort((e,t)=>e.order-t.order);if(0===t.length)return e;const n=t[0].position,o=e.startMarker;return{...e,startMarker:n,waypoints:[{...t[0],position:o},...t.slice(1)].map((e,t)=>({...e,order:t}))}})()}}:e.snappedRoads.editingStates;return{snappedRoads:{...e.snappedRoads,routeMarkers:n,editingStates:o}}})},moveDestinationUp:t=>{e(e=>{const n=e.snappedRoads.routeMarkers.map(e=>{if(e.routeId!==t)return e;const n=[...e.waypoints].sort((e,t)=>e.order-t.order);if(0===n.length)return e;const r=n[n.length-1].position,o=e.endMarker;return{...e,endMarker:r,waypoints:n.slice(0,-1).concat([{...n[n.length-1],position:o}]).map((e,t)=>({...e,order:t}))}}),r=e.snappedRoads.editingStates[t],o=r?{...e.snappedRoads.editingStates,[t]:{...r,temporaryMarkers:(()=>{const e=r.temporaryMarkers,t=[...e.waypoints].sort((e,t)=>e.order-t.order);if(0===t.length)return e;const n=t[t.length-1].position,o=e.endMarker;return{...e,endMarker:n,waypoints:t.slice(0,-1).concat([{...t[t.length-1],position:o}]).map((e,t)=>({...e,order:t}))}})()}}:e.snappedRoads.editingStates;return{snappedRoads:{...e.snappedRoads,routeMarkers:n,editingStates:o}}})},setAddingWaypointMode:t=>{e({isAddingWaypoint:null!==t,waypointAddingRouteId:t})},cancelAddingWaypoint:()=>{e({isAddingWaypoint:!1,waypointAddingRouteId:null})},swapRouteStartEnd:t=>{e(e=>{const n=e.snappedRoads.routeMarkers.find(e=>e.routeId===t);if(!n)return e;const r=n.endMarker,o=n.startMarker,i=n.waypoints.map((e,t)=>({...e,order:n.waypoints.length-1-t})).reverse(),s=e.snappedRoads.routeMarkers.map(e=>e.routeId===t?{...e,startMarker:r,endMarker:o,waypoints:i}:e),a=e.snappedRoads.editingStates[t],l=a?{...e.snappedRoads.editingStates,[t]:{...a,temporaryMarkers:{...a.temporaryMarkers,startMarker:r,endMarker:o,waypoints:i}}}:e.snappedRoads.editingStates;return{snappedRoads:{...e.snappedRoads,routeMarkers:s,editingStates:l}}})},hasUnsavedChanges:e=>{const n=t(),r=n.snappedRoads.previewRoads.some(t=>t.uploadedRouteId===e),o=n.snappedRoads.editingStates[e];if(o){const e=o.originalMarkers,t=o.temporaryMarkers,n=e.startMarker.lat!==t.startMarker.lat||e.startMarker.lng!==t.startMarker.lng||e.endMarker.lat!==t.endMarker.lat||e.endMarker.lng!==t.endMarker.lng||e.waypoints.length!==t.waypoints.length||e.waypoints.some((e,n)=>t.waypoints[n]?.position.lat!==e.position.lat||t.waypoints[n]?.position.lng!==e.position.lng);return r||n}return r},initializeRouteEditing:t=>{e(e=>{const n=e.snappedRoads.routeMarkers.find(e=>e.routeId===t);if(!n)return e;const r={routeId:n.routeId,startMarker:{...n.startMarker},endMarker:{...n.endMarker},waypoints:n.waypoints.map(e=>({...e}))},o={routeId:n.routeId,startMarker:{...n.startMarker},endMarker:{...n.endMarker},waypoints:n.waypoints.map(e=>({...e}))},i={routeId:t,temporaryMarkers:r,originalMarkers:o};return{snappedRoads:{...e.snappedRoads,editingStates:{...e.snappedRoads.editingStates,[t]:i}}}})},getEditingState:e=>t().snappedRoads.editingStates[e]||null,saveRouteChanges:t=>{e(e=>{const n=e.snappedRoads.editingStates[t],r=n?e.snappedRoads.routeMarkers.map(e=>e.routeId===t?n.temporaryMarkers:e):e.snappedRoads.routeMarkers,o=e.snappedRoads.previewRoads.filter(e=>e.uploadedRouteId===t),i=e.snappedRoads.previewRoads.filter(e=>e.uploadedRouteId!==t),s=e.snappedRoads.roads.filter(e=>e.uploadedRouteId!==t),a={...e.snappedRoads.editingStates};return delete a[t],{snappedRoads:{...e.snappedRoads,routeMarkers:r,roads:[...s,...o],previewRoads:i,editingStates:a}}})},discardRouteChanges:t=>{e(e=>{const n=e.snappedRoads.editingStates[t],r=n?e.snappedRoads.routeMarkers.map(e=>e.routeId===t?n.originalMarkers:e):e.snappedRoads.routeMarkers,o=e.snappedRoads.previewRoads.filter(e=>e.uploadedRouteId!==t),i={...e.snappedRoads.editingStates};delete i[t];const s=r.find(e=>e.routeId===t);let a=i;if(s){const e={routeId:s.routeId,startMarker:{...s.startMarker},endMarker:{...s.endMarker},waypoints:s.waypoints.map(e=>({...e}))},n={routeId:s.routeId,startMarker:{...s.startMarker},endMarker:{...s.endMarker},waypoints:s.waypoints.map(e=>({...e}))},r={routeId:t,temporaryMarkers:e,originalMarkers:n};a={...i,[t]:r}}return{snappedRoads:{...e.snappedRoads,routeMarkers:r,previewRoads:o,editingStates:a}}})},setEditingSavedRouteId:t=>{e({editingSavedRouteId:t})}}),WN=(e,t)=>({layerVisibility:{},layerOrder:[],clearAllDrawing:()=>{t().clearIndividualRoute(),t().clearPolygonDrawing(),t().clearSegmentation()},toggleLayerVisibility:t=>{e(e=>({layerVisibility:{...e.layerVisibility,[t]:!e.layerVisibility[t]}}))},setLayerVisibility:(t,n)=>{e(e=>({...e,layerVisibility:{...e.layerVisibility,[t]:n}}))},moveLayerUp:e=>{const n=t(),r=n.layerOrder,o=r.indexOf(e);if(o>0){const e=[...r];[e[o-1],e[o]]=[e[o],e[o-1]],n.reorderLayers(e)}},moveLayerDown:e=>{const n=t(),r=n.layerOrder,o=r.indexOf(e);if(o>=0&&o<r.length-1){const e=[...r];[e[o],e[o+1]]=[e[o+1],e[o]],n.reorderLayers(e)}},reorderLayers:t=>{e(e=>({...e,layerOrder:t}))}}),$N=Wv()((KN=(...e)=>({...Dw(...e),...Nw(...e),...Kw(...e),...FN(...e),...HN(...e),...GN(...e),...VN(...e),...WN(...e)}),XN={limit:50,partialize:e=>({individualRoute:{...e.individualRoute,currentRouteId:null,validationError:null},segmentation:{...e.segmentation,cutPoints:e.segmentation.cutPoints,distanceKm:e.segmentation.distanceKm,type:e.segmentation.type,isCalculating:!1,error:void 0,previewSegments:[]},roadImport:{panelRoutes:e.roadImport.panelRoutes,selectionMode:e.roadImport.selectionMode,importedRoads:e.roadImport.importedRoads,importedPolygon:e.roadImport.importedPolygon,hoveredRoadId:null,pendingModeSwitch:e.roadImport.pendingModeSwitch,multiSelectTempSelection:e.roadImport.multiSelectTempSelection,multiSelectValidationResult:null,multiSelectValidating:!1,routeInMaking:e.roadImport.routeInMaking,routeInMakingRoadIds:e.roadImport.routeInMakingRoadIds}}),equality:(e,t)=>{if(t.segmentation.isDragging)return!0;const n=JSON.stringify(e.segmentation.cutPoints)!==JSON.stringify(t.segmentation.cutPoints)||e.segmentation.distanceKm!==t.segmentation.distanceKm||e.segmentation.type!==t.segmentation.type,r=e.individualRoute.points.length!==t.individualRoute.points.length||JSON.stringify(e.individualRoute.points)!==JSON.stringify(t.individualRoute.points),o=JSON.stringify(e.roadImport.panelRoutes)!==JSON.stringify(t.roadImport.panelRoutes)||JSON.stringify(e.roadImport.multiSelectTempSelection)!==JSON.stringify(t.roadImport.multiSelectTempSelection)||e.roadImport.selectionMode!==t.roadImport.selectionMode||JSON.stringify(e.roadImport.routeInMaking)!==JSON.stringify(t.roadImport.routeInMaking)||JSON.stringify(e.roadImport.routeInMakingRoadIds)!==JSON.stringify(t.roadImport.routeInMakingRoadIds)||JSON.stringify(e.roadImport.routeInMaking)!==JSON.stringify(t.roadImport.routeInMaking)||JSON.stringify(e.roadImport.routeInMakingRoadIds)!==JSON.stringify(t.roadImport.routeInMakingRoadIds);return!(n||r||o)}},(e,t,n)=>{n.temporal=Hv(XN?.wrapTemporal?.(Yv(e,t,XN))||Yv(e,t,XN));const r=XN?.handleSet?.(n.temporal.getState()._handleSet)||n.temporal.getState()._handleSet,o=e=>{if(!n.temporal.getState().isTracking)return;const o=XN?.partialize?.(t())||t(),i=XN?.diff?.(e,o);null===i||XN?.equality?.(e,o)||r(e,void 0,o,i)},i=n.setState;return n.setState=(...e)=>{const n=XN?.partialize?.(t())||t();i(...e),o(n)},KN((...n)=>{const r=XN?.partialize?.(t())||t();e(...n),o(r)},t,n)}));var KN,XN;$N.temporal;let YN=null,qN=null;$N.subscribe(e=>{const t=e.segmentation.cutPoints.map(e=>e.id).sort().join(","),n={targetRouteId:e.segmentation.targetRoute?.id,type:e.segmentation.type,distanceKm:e.segmentation.distanceKm,cutPointsLength:e.segmentation.cutPoints.length,cutPointsKey:t,isActive:e.segmentation.isActive};if(qN&&qN.targetRouteId===n.targetRouteId&&qN.type===n.type&&qN.distanceKm===n.distanceKm&&qN.cutPointsLength===n.cutPointsLength&&qN.cutPointsKey===n.cutPointsKey&&qN.isActive===n.isActive)return;const r=e.segmentation,o=r.isActive&&r.targetRoute?`${r.targetRoute.id}-${r.type}-${r.distanceKm||0}-${r.cutPoints.length}-${JSON.stringify(r.cutPoints.map(e=>e.id))}`:null;o&&o!==YN&&r.targetRoute&&(r.cutPoints.length>0||"distance"===r.type)&&setTimeout(()=>{const e=$N.getState();e.segmentation.isActive&&e.segmentation.targetRoute&&e.calculatePreviewSegments&&e.calculatePreviewSegments()},0),YN=o,qN=n});const JN=Wv()(Xv((e,t)=>({projectId:null,projectData:null,routes:[],selectedRoute:null,mapMode:"view",mapType:"roadmap",panels:{left:{visible:!0,collapsed:!1},right:{visible:!1}},leftPanelExpanded:!1,currentFolder:null,routeToScrollTo:null,routeSearchQuery:null,activePanel:null,rightPanelType:null,selectedRoutePanelVisible:!1,roadPriorityPanelOpen:!1,priorityFilterPanelExpanded:!0,routeNamingDialogOpen:!1,pendingFile:null,pendingFeatureCount:0,pendingProperties:[],viewport:null,showSelectedRouteSegments:!1,showIndividualMarkers:!0,dynamicIslandHeight:0,pendingModeSwitch:null,pendingUploadClear:!1,setProject:(t,n)=>{e({projectId:t,projectData:n,selectedRoute:null,mapMode:"view"})},setProjectData:t=>{e({projectData:t})},setRoutes:t=>{e(e=>{const n=e.selectedRoute&&t.find(t=>t.id===e.selectedRoute?.id)?t.find(t=>t.id===e.selectedRoute?.id)||null:e.selectedRoute;return{routes:t,selectedRoute:n}})},clearProject:()=>{e({projectId:null,projectData:null,routes:[],selectedRoute:null,mapMode:"view"})},addRoute:t=>{e(e=>({routes:[...e.routes,t]}))},updateRoute:(t,n)=>{e(e=>({routes:e.routes.map(e=>{if(e.id===t){const t={...e};n.segments&&(t.segments=[...n.segments]),n.roads&&(t.roads=[...n.roads]);return{...t,...n}}return e}),selectedRoute:e.selectedRoute?.id===t?(()=>{const t={...e.selectedRoute};n.segments&&(t.segments=[...n.segments]),n.roads&&(t.roads=[...n.roads]);return{...t,...n}})():e.selectedRoute}))},removeRoute:t=>{e(e=>({routes:e.routes.filter(e=>e.id!==t),selectedRoute:e.selectedRoute?.id===t?null:e.selectedRoute}))},setSelectedRoute:n=>{const r=n&&t().routes.find(e=>e.id===n)||null;e({selectedRoute:r})},selectRoute:n=>{if(!n)return void e({selectedRoute:null,routeSearchQuery:null,panels:{...t().panels,right:{...t().panels.right,visible:!1}}});const r=t().routes.find(e=>e.id===n);r&&e({selectedRoute:r,panels:{...t().panels,right:{...t().panels.right,visible:!0}}})},clearRoutes:()=>{e({routes:[],selectedRoute:null})},loadRouteForEditing:(t,n,r,o)=>{const{clearRouteGenerationKey:i}=$N.getState();r(null),o(),i(),n(t),r(t.id),e({mapMode:"individual_drawing"})},exitEditMode:()=>{const{clearPoints:t,setRouteUUID:n}=$N.getState();t(),n(null),e({mapMode:"view",routeSearchQuery:null})},setMapMode:n=>{const r=t().mapMode;if(r!==n){const{roadImport:t,clearRoadImport:o,clearAllDrawing:i,exitSelectionMode:s}=$N.getState();if("road_selection"===r&&t&&(t.panelRoutes.length>0||t.lassoFilteredRoadIds&&t.lassoFilteredRoadIds.length>0))return void $N.getState().setPendingModeSwitch({from:r,to:n});const{uploadedRoutes:a}=$N.getState(),l="editing_uploaded_route"===n,c="editing_uploaded_route"===r;if(a.routes.length>0&&!l&&!c&&("upload_routes"===r||"individual_drawing"===n||"polygon_drawing"===n||"lasso_selection"===n))return void e({pendingModeSwitch:{from:r,to:n}});const{individualRoute:u,editingSavedRouteId:d,hasUnsavedChanges:A}=$N.getState(),h="individual_drawing"===r&&u.points.length>0&&"individual_drawing"!==n,p="individual_drawing"===r&&"individual_drawing"!==n&&null!==d&&A(d);if(h||p)return void e({pendingModeSwitch:{from:r,to:n}});const{polygonDrawing:f}=$N.getState();if("polygon_drawing"===r&&f.points.length>0&&"polygon_drawing"!==n)return void e({pendingModeSwitch:{from:r,to:n}});i(),$N.temporal.getState().clear(),"road_selection"===r&&o(),e({selectedRoute:null}),s(),e({mapMode:n})}},setPendingModeSwitch:t=>{e({pendingModeSwitch:t})},setPendingUploadClear:t=>{e({pendingUploadClear:t})},setMapType:t=>{e({mapType:t})},toggleMapType:()=>{e(e=>({mapType:"roadmap"===e.mapType?"hybrid":"roadmap"}))},toggleLeftPanel:()=>{e(e=>({panels:{...e.panels,left:{...e.panels.left,visible:!e.panels.left.visible}}}))},toggleRightPanel:()=>{e(e=>({panels:{...e.panels,right:{...e.panels.right,visible:!e.panels.right.visible}}}))},setLeftPanelCollapsed:t=>{e(e=>({panels:{...e.panels,left:{...e.panels.left,collapsed:t}}}))},setLeftPanelExpanded:t=>{e({leftPanelExpanded:t})},setRightPanelVisible:t=>{e(e=>({panels:{...e.panels,right:{...e.panels.right,visible:t}}}))},setShowSelectedRouteSegments:t=>{e({showSelectedRouteSegments:t})},setCurrentFolder:t=>{e({currentFolder:t})},scrollToRoute:t=>{e({routeToScrollTo:t})},setRouteSearchQuery:t=>{e({routeSearchQuery:t})},setActivePanel:t=>{e({activePanel:t})},setSelectedRoutePanelVisible:t=>{e({selectedRoutePanelVisible:t})},setRoadPriorityPanelOpen:t=>{e({roadPriorityPanelOpen:t})},setPriorityFilterPanelExpanded:t=>{e({priorityFilterPanelExpanded:t})},setRouteNamingDialogOpen:t=>{e({routeNamingDialogOpen:t})},setPendingFile:t=>{e({pendingFile:t})},setPendingFeatureCount:t=>{e({pendingFeatureCount:t})},setPendingProperties:t=>{e({pendingProperties:t})},setShowIndividualMarkers:t=>{e({showIndividualMarkers:t})},setDynamicIslandHeight:t=>{e({dynamicIslandHeight:t})},setRightPanelType:t=>{e({rightPanelType:t})},saveViewport:t=>{e({viewport:t})},restoreViewport:()=>{},reset:()=>{e({projectId:null,projectData:null,routes:[],selectedRoute:null,mapMode:"view",panels:{left:{visible:!0,collapsed:!1},right:{visible:!1}},viewport:null,showSelectedRouteSegments:!1,showIndividualMarkers:!0,dynamicIslandHeight:0})}}),{name:"project-workspace-store",partialize:e=>({panels:e.panels,viewport:e.viewport})})),ZN=Object.freeze(Object.defineProperty({__proto__:null,useProjectWorkspaceStore:JN},Symbol.toStringTag,{value:"Module"})),ej=Wv((e,t)=>({geoJsonState:{mode:"file",text:"",dragActive:!1,error:null,uploadedGeoJson:null,validationResult:null},formState:{isLoading:!1,error:null,success:!1},currentProject:null,setGeoJson:t=>{e(e=>{const n={...e,geoJsonState:{...e.geoJsonState,uploadedGeoJson:t,error:null}};return n})},updateGeoJsonState:t=>{e(e=>{const n={...e,geoJsonState:{...e.geoJsonState,...t}};return n})},clearGeoJsonState:()=>{e(e=>{const t={...e,geoJsonState:{mode:"file",text:"",dragActive:!1,error:null,uploadedGeoJson:null,validationResult:null}};return t})},validateAndSetGeoJson:t=>{let n=!1,r=null;t&&"object"==typeof t?"FeatureCollection"===t.type&&Array.isArray(t.features)?(n=t.features.length>0,n||(r="FeatureCollection must contain at least one feature")):"Polygon"===t.type||"MultiPolygon"===t.type?n=!0:"Feature"===t.type&&t.geometry?(n="Polygon"===t.geometry.type||"MultiPolygon"===t.geometry.type,n||(r="Feature must contain a Polygon or MultiPolygon geometry")):r="Invalid GeoJSON structure. Expected FeatureCollection, Feature, Polygon, or MultiPolygon":r="GeoJSON must be a valid object",e(e=>{const o={...e,geoJsonState:{...e.geoJsonState,uploadedGeoJson:n?t:null,validationResult:{isValid:n,error:r||void 0},error:r}};return o})},updateFormState:t=>{e(e=>{const n={...e,formState:{...e.formState,...t}};return n})},clearFormState:()=>{e(e=>{const t={...e,formState:{isLoading:!1,error:null,success:!1}};return t})},setCurrentProject:t=>{e(e=>{const n={...e,currentProject:t};return n})},clearCurrentProject:()=>{e(e=>{const t={...e,currentProject:null};return t})},clearProjectCreationState:()=>{e(e=>{const t={...e,geoJsonState:{mode:"file",text:"",dragActive:!1,error:null,uploadedGeoJson:null,validationResult:null},formState:{isLoading:!1,error:null,success:!1}};return t})},resetAll:()=>{e(()=>{const e={geoJsonState:{mode:"file",text:"",dragActive:!1,error:null,uploadedGeoJson:null,validationResult:null},formState:{isLoading:!1,error:null,success:!1},currentProject:null};return e})}})),tj=()=>{const e=$N.getState(),t=JN.getState();e.uploadedRoutes.routes.forEach(t=>{e.discardRouteChanges(t.id)}),e.clearUploadedRoutes(),$N.setState({snappedRoads:{roads:[],isVisible:e.snappedRoads.isVisible,isLoading:!1,routeMarkers:[],isDraggingMarker:!1,hoveredRouteId:null,previewRoads:[],editingStates:{}}}),e.clearAllOptimizedRouteMarkers(),e.clearAllDrawing(),e.clearRoadImport(),e.setSelectedUploadedRouteId(null),e.setEditingSavedRouteId(null),e.setAddingWaypointMode(null),e.setRouteUUID(null),e.clearPoints(),t.setLeftPanelExpanded(!1),t.setActivePanel(null),t.setRouteNamingDialogOpen(!1),t.setRoadPriorityPanelOpen(!1),t.setSelectedRoute(null),t.setMapMode("view"),t.setCurrentFolder(null),t.clearProject(),e.refreshRoutesTilesTimestamp(),e.refreshRoadsTilesTimestamp()},nj=()=>{const e=$N.getState(),t=JN.getState(),n=e.uploadedRoutes.routes;if(n.length>0){n.some(t=>e.hasUnsavedChanges(t.id));return!0}if(e.individualRoute.points.length>0)return!0;if(e.polygonDrawing.points.length>0)return!0;if(e.lassoDrawing.points.length>0)return!0;if(e.snappedRoads.previewRoads.length>0)return!0;const r=e.snappedRoads.editingStates;if(Object.keys(r).length>0)for(const i of Object.keys(r))if(e.hasUnsavedChanges(i))return!0;if("upload_routes"===t.mapMode)return!0;const o=e.roadImport;if(o){if(o.panelRoutes&&o.panelRoutes.length>0)return!0;if(o.lassoFilteredRoadIds&&o.lassoFilteredRoadIds.length>0)return!0}return!1},rj=pe.createContext(void 0),oj=({children:e})=>{const t=_c(),[n,r]=pe.useState(!1),[o,i]=pe.useState(null),[a,l]=pe.useState(null);fe.useEffect(()=>{const e=e=>{if(nj())return e.preventDefault(),e.returnValue="",""};return window.addEventListener("beforeunload",e),()=>{window.removeEventListener("beforeunload",e)}},[]);const c=pe.useCallback(e=>"/dashboard"===e?nj()?(i(e),void r(!0)):(tj(),void t(e)):nj()?(i(e),void r(!0)):void t(e),[t]),u=pe.useCallback(e=>{if(nj())return l(()=>e),void r(!0);e()},[]),d=pe.useCallback(()=>{r(!1),i(null),l(null)},[]),A=pe.useCallback(()=>{r(!1),tj(),o&&(t(o),i(null)),a&&(a(),l(null))},[t,o,a]);return s.jsxs(rj.Provider,{value:{navigateWithCheck:c,executeActionWithCheck:u},children:[e,s.jsx(Qv,{open:n,onClose:d,onStay:d,onLeave:A})]})},ij=({children:e})=>s.jsx(oj,{children:e}),sj=()=>{const e=pe.useContext(rj);if(void 0===e)throw new Error("useUnsavedChangesNavigation must be used within UnsavedChangesProvider");return e};function aj(){return s.jsx(ij,{children:s.jsx(Gc,{})})}function lj(e){const t=e instanceof Error?e.message:e;return t.includes("Permission denied")||t.includes("permission")?"You don't have access to this project. Please check your Google Cloud Project permissions.":t.includes("not found")||t.includes("404")?"Project not found. Please verify the project ID.":t.includes("API")&&(t.includes("not enabled")||t.includes("disabled"))?"Cloud Resource Manager API is not enabled. Please enable it in GCP Console.":t.includes("cloudresourcemanager")||t.includes("resourcemanager")?"Cloud Resource Manager API is not enabled or you don't have access. You can still manually enter your project ID.":t.includes("auth")||t.includes("credential")?"Authentication failed. Please run 'gcloud auth login' in your terminal.":t.includes("Failed to fetch")||t.includes("Network")?"Unable to connect to GCP. Please check your internet connection.":"Unable to verify project. Please try again or check your GCP configuration."}class cj{baseUrl;constructor(e){this.baseUrl=e}async request(e,t={}){const n=`${this.baseUrl}${e}`,r=await fetch(n,{headers:{"Content-Type":"application/json",...t.headers},...t});if(!r.ok){let t={};const n=r.headers.get("content-type");if(n&&n.includes("application/json"))try{t=await r.json()}catch{}else try{const n=await r.text();(n.includes("<!doctype")||n.includes("<html"))&&(t={detail:`Endpoint not found: ${e}`})}catch{}const o=t.detail||t.error||`HTTP ${r.status}: ${r.statusText}`;throw new Error(o)}const o=r.headers.get("content-type");if(o&&!o.includes("application/json"))throw new Error(`Expected JSON response but got ${o}`);return r.json()}async get(e){return this.request(e,{method:"GET"})}async post(e,t){return this.request(e,{method:"POST",body:t?JSON.stringify(t):void 0})}async put(e,t){return this.request(e,{method:"PUT",body:t?JSON.stringify(t):void 0})}async delete(e){return this.request(e,{method:"DELETE"})}async uploadFile(e,t,n){const r=`${this.baseUrl}${e}`,o=new FormData;o.append("file",t),n&&Object.entries(n).forEach(([e,t])=>{o.append(e,t)});const i=await fetch(r,{method:"POST",body:o});if(!i.ok){const e=await i.json().catch(()=>({})),t=e.detail||e.error||`HTTP ${i.status}: ${i.statusText}`;throw new Error(t)}return i.json()}async downloadFile(e){const t=`${this.baseUrl}${e}`,n=await fetch(t,{method:"GET"});if(!n.ok){let e={};const t=n.headers.get("content-type");if(t&&t.includes("application/json"))try{e=await n.json()}catch{}const r=e.detail||e.error||`HTTP ${n.status}: ${n.statusText}`;throw new Error(r)}return n.blob()}}const uj=new cj(""),dj=Object.freeze(Object.defineProperty({__proto__:null,API_BASE_URL:"",ApiClient:cj,apiClient:uj},Symbol.toStringTag,{value:"Module"})),Aj=e=>{try{let t,n,r;try{const n=e.jurisdiction_boundary_geojson??e.geojson;t="string"==typeof n?JSON.parse(n):n}catch(hee){t={type:"Polygon",coordinates:[[[0,0],[1,0],[1,1],[0,1],[0,0]]]}}try{n={googleCloudProjectId:e.google_cloud_project_id||"",googleCloudProjectNumber:e.google_cloud_project_number||"",subscriptionId:e.subscription_id||void 0}}catch(hee){n={googleCloudProjectId:"",googleCloudProjectNumber:"",subscriptionId:void 0}}if(e.viewstate)try{r="string"==typeof e.viewstate?JSON.parse(e.viewstate):e.viewstate}catch(hee){}return{id:(e.id??e.project_id)?.toString(),name:e.project_name||e.name||"Unknown Project",boundaryGeoJson:t,bigQueryColumn:n,viewstate:r,mapSnapshot:e.map_snapshot||void 0,createdAt:e.created_at||(new Date).toISOString(),updatedAt:e.updated_at||e.created_at||(new Date).toISOString()}}catch(t){return{id:e?.id?.toString()||"unknown",name:e?.project_name||e?.name||"Unknown Project",boundaryGeoJson:{type:"Polygon",coordinates:[[[0,0],[1,0],[1,1],[0,1],[0,0]]]},bigQueryColumn:{googleCloudProjectId:"",googleCloudProjectNumber:"",subscriptionId:void 0},createdAt:e.created_at||(new Date).toISOString(),updatedAt:e.updated_at||e.created_at||(new Date).toISOString()}}},hj=e=>{try{let t,n,r;try{t=e.origin?"string"==typeof e.origin?JSON.parse(e.origin):e.origin:e.origin_coordinates?"string"==typeof e.origin_coordinates?JSON.parse(e.origin_coordinates):e.origin_coordinates:{lat:0,lng:0},n=e.destination?"string"==typeof e.destination?JSON.parse(e.destination):e.destination:e.destination_coordinates?"string"==typeof e.destination_coordinates?JSON.parse(e.destination_coordinates):e.destination_coordinates:{lat:1,lng:1},r="string"==typeof e.waypoints?JSON.parse(e.waypoints||"[]"):e.waypoints||[]}catch(hee){t={lat:0,lng:0},n={lat:1,lng:1},r=[]}const o=e=>e&&"object"==typeof e&&"lat"in e&&"lng"in e?{lat:e.lat,lng:e.lng}:Array.isArray(e)&&e.length>=2?{lat:e[1],lng:e[0]}:{lat:0,lng:0},i=e=>{switch(e){case"disabled":return"#FF5252";case"unsynced":return"#FF9800";case"synced":return"#4CAF50";default:return"#2196F3"}};return{id:e.uuid||"unknown",name:e.route_name||"Unnamed Route",projectId:e.project_id?.toString()||"unknown",type:e.route_type,source:"uploaded"===e.route_type||e.original_route_geo_json||"individual"!==e.route_type&&e.route_type?"polygon_selection":"individual_drawing",origin:o(t),destination:o(n),waypoints:r.map(o),encodedPolyline:e.encoded_polyline||"",distance:e.length||e.distance||0,duration:Math.floor(2*(e.length||e.distance||0)),sync_status:e.sync_status&&["unsynced","validating","synced","invalid"].includes(e.sync_status)?e.sync_status:"unsynced",route_status:e.routes_status&&["STATUS_RUNNING","STATUS_VALIDATING","STATUS_INVALID"].includes(e.routes_status)?e.routes_status:void 0,createdAt:e.created_at||(new Date).toISOString(),updatedAt:e.updated_at||e.created_at||(new Date).toISOString(),lastSyncedAt:void 0,roads:e.roads?e.roads.map(t=>({id:t?.id?.toString(),routeId:t.segment_route_id||e.uuid,name:t.name||`Road ${t.id}`,linestringGeoJson:t.polyline,segmentOrder:t.segment_order||0,distanceKm:t.length||0,is_enabled:"boolean"==typeof t.is_enabled?t.is_enabled:void 0!==t.is_enabled?Boolean(t.is_enabled):void 0,is_selected:"boolean"==typeof t.is_selected?t.is_selected:void 0!==t.is_selected?Boolean(t.is_selected):void 0,createdAt:t.created_at||(new Date).toISOString()})):[],isSegmented:e.is_segmented||!1,segmentCount:e.segments?e.segments.length:e.roads?e.roads.length:1,segmentationType:e.segmentation_type,segments:e.segments?e.segments.map(e=>({uuid:e.uuid,project_id:e.project_id,route_name:e.route_name,origin:e.origin,destination:e.destination,waypoints:e.waypoints,center:e.center,route_type:e.route_type,length:e.length,parent_route_id:e.parent_route_id,has_children:e.has_children||!1,is_segmented:e.is_segmented||!1,segmentation_type:e.segmentation_type,segmentation_points:e.segmentation_points,segmentation_config:e.segmentation_config,sync_status:e.sync_status||"pending",is_enabled:void 0===e.is_enabled||e.is_enabled,tag:e.tag,encoded_polyline:e.encoded_polyline||null,segment_order:e.segment_order||null,created_at:e.created_at,updated_at:e.updated_at,deleted_at:e.deleted_at})):void 0,color:i(e.sync_status),opacity:.8,strokeWidth:3,tag:e.tag??null,originalRouteGeoJson:(()=>{const t=e.original_route_geo_json;if(t)try{return"string"==typeof t?JSON.parse(t):t}catch(n){return}})(),matchPercentage:e.match_percentage??void 0}}catch(t){return{id:e.uuid||"unknown",name:e.route_name||"Unnamed Route",projectId:e.project_id?.toString()||"unknown",type:"individual",source:"individual_drawing",origin:{lat:0,lng:0},destination:{lat:1,lng:1},waypoints:[],encodedPolyline:"",distance:0,duration:0,sync_status:"unsynced",route_status:"UNSYNCED",createdAt:e.created_at||(new Date).toISOString(),updatedAt:e.updated_at||e.created_at||(new Date).toISOString(),roads:[],isSegmented:!1,segmentCount:1,color:"#2196F3",opacity:.8,strokeWidth:3}}},pj={getAll:async()=>{try{const e=await uj.get("/projects/list");return{success:!0,data:e.map(Aj),message:"Projects fetched successfully"}}catch(e){return{success:!1,data:[],message:e instanceof Error?e.message:"Failed to fetch projects"}}},getById:async e=>{try{const t=await uj.get(`/projects/${e}`);return{success:!0,data:Aj(t),message:"Project fetched successfully"}}catch(t){return t instanceof Error&&t.message.includes("404")?{success:!0,data:null,message:"Project not found"}:{success:!1,data:null,message:t instanceof Error?t.message:"Failed to fetch project"}}},create:async e=>{try{const t={project_name:e.name,jurisdiction_boundary_geojson:JSON.stringify(e.boundaryGeoJson),google_cloud_project_id:e.bigQueryColumn.googleCloudProjectId,google_cloud_project_number:e.bigQueryColumn.googleCloudProjectNumber,subscription_id:e.bigQueryColumn.subscriptionId||`rmi-sub-${e.bigQueryColumn.googleCloudProjectNumber}`},n=await uj.post("/projects/",t);if(n&&n.id)return{success:!0,data:Aj(n),message:"Project created successfully"};throw new Error("Failed to create project: invalid response")}catch(t){return{success:!1,data:{},message:t instanceof Error?t.message:"Failed to create project"}}},update:async(e,t)=>{try{const n={};t.name&&(n.project_name=t.name),t.boundaryGeoJson&&(n.jurisdiction_boundary_geojson=JSON.stringify(t.boundaryGeoJson)),t.bigQueryColumn&&(n.google_cloud_project_id=t.bigQueryColumn.googleCloudProjectId,n.google_cloud_project_number=t.bigQueryColumn.googleCloudProjectNumber,n.subscription_id=t.bigQueryColumn.subscriptionId||`rmi-sub-${t.bigQueryColumn.googleCloudProjectNumber}`),await uj.put(`/projects/${e}`,n);return{success:!0,data:(await pj.getById(e)).data,message:"Project updated successfully"}}catch(n){return{success:!1,data:null,message:n instanceof Error?n.message:"Failed to update project"}}},updateSnapshot:async(e,t)=>{try{const n={map_snapshot:t};return await uj.put(`/projects/${e}`,n),{success:!0,data:null,message:"Map snapshot updated successfully"}}catch(n){return{success:!1,data:null,message:n instanceof Error?n.message:"Failed to update map snapshot"}}},delete:async e=>{try{return await uj.delete(`/projects/${e}`),{success:!0,data:!0,message:"Project deleted successfully"}}catch(t){return{success:!1,data:!1,message:t instanceof Error?t.message:"Failed to delete project"}}},getGcpProjects:async()=>{try{return{success:!0,data:(await uj.get("/gcp-projects-list")).projects||[],message:"GCP projects fetched successfully"}}catch(e){return{success:!1,data:[],message:lj(e)}}},verifyProjectDetails:async e=>{try{const t=await uj.post("/verify-project-details",{project_id:e});if(t.error){return{success:!1,data:{project_number:"",project_id:""},message:lj(t.error)}}return{success:!0,data:{project_number:t.project_number||"",project_id:t.project_id||e},message:"Project verified successfully"}}catch(t){return{success:!1,data:{project_number:"",project_id:""},message:lj(t)}}},exportProject:async e=>{try{return await uj.downloadFile(`/export_project/${e}`)}catch(t){throw t}},importProject:async e=>{try{const t=await uj.uploadFile("/import_project",e);return{success:!0,data:{new_project_id:t.new_project_id,routes_inserted:t.routes_inserted,routes_skipped_uuid_exists:t.routes_skipped_uuid_exists},message:`Project imported successfully. ${t.routes_inserted} routes inserted.`}}catch(t){let e="Failed to import project";return t instanceof Error?e=t.message:"object"==typeof t&&null!==t&&"detail"in t&&(e=t.detail),{success:!1,data:{new_project_id:0,routes_inserted:0,routes_skipped_uuid_exists:0},message:e}}}},fj=[];for(let pee=0;pee<256;++pee)fj.push((pee+256).toString(16).slice(1));let gj;const mj=new Uint8Array(16);const yj={randomUUID:"undefined"!=typeof crypto&&crypto.randomUUID&&crypto.randomUUID.bind(crypto)};function vj(e,t,n){const r=(e=e||{}).random??e.rng?.()??function(){if(!gj){if("undefined"==typeof crypto||!crypto.getRandomValues)throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");gj=crypto.getRandomValues.bind(crypto)}return gj(mj)}();if(r.length<16)throw new Error("Random bytes length must be >= 16");return r[6]=15&r[6]|64,r[8]=63&r[8]|128,function(e,t=0){return(fj[e[t+0]]+fj[e[t+1]]+fj[e[t+2]]+fj[e[t+3]]+"-"+fj[e[t+4]]+fj[e[t+5]]+"-"+fj[e[t+6]]+fj[e[t+7]]+"-"+fj[e[t+8]]+fj[e[t+9]]+"-"+fj[e[t+10]]+fj[e[t+11]]+fj[e[t+12]]+fj[e[t+13]]+fj[e[t+14]]+fj[e[t+15]]).toLowerCase()}(r)}function bj(e,t,n){return yj.randomUUID&&!e?yj.randomUUID():vj(e)}const wj={getByProject:async e=>{try{const t=await uj.get(`/routes/project/${e}`);return{success:!0,data:t.map(hj),message:"Routes fetched successfully"}}catch(t){return{success:!1,data:[],message:t instanceof Error?t.message:"Failed to fetch routes"}}},getById:async e=>{try{const t=await uj.get(`/routes/uuid/${e}`),n=hj(t);return t.roads&&Array.isArray(t.roads)&&(n.roads=t.roads.map(e=>({id:e?.id?.toString(),routeId:e.segment_route_id||n.id,name:e.name||`Road ${e.id}`,linestringGeoJson:e.polyline,segmentOrder:e.segment_order||0,distanceKm:e.length||0,is_enabled:"boolean"==typeof e.is_enabled?e.is_enabled:void 0!==e.is_enabled?Boolean(e.is_enabled):void 0,is_selected:"boolean"==typeof e.is_selected?e.is_selected:void 0!==e.is_selected?Boolean(e.is_selected):void 0,createdAt:e.created_at||(new Date).toISOString()}))),{success:!0,data:n,message:"Route fetched successfully"}}catch(t){return t instanceof Error&&t.message.includes("404")?{success:!0,data:null,message:"Route not found"}:{success:!1,data:null,message:t instanceof Error?t.message:"Failed to fetch route"}}},create:async e=>{try{const t=e=>[e.lng,e.lat],n={uuid:bj(),route_name:e.name,coordinates:{origin:t(e.origin),destination:t(e.destination),waypoints:e.waypoints.map(t)},encoded_polyline:e.encodedPolyline,project_id:parseInt(e.projectId),polygon_id:null},r=await uj.post("/routes/save",n);if(r.success){return{success:!0,data:hj(r.data),message:"Route created successfully"}}throw new Error("Failed to create route")}catch(t){return{success:!1,data:{},message:t instanceof Error?t.message:"Failed to create route"}}},update:async(e,t)=>{try{const n={};void 0!==t.name&&(n.route_name=t.name),void 0!==t.sync_status&&(n.sync_status=t.sync_status),void 0!==t.type&&(n.route_type=t.type);const r=await fetch(`/routes/uuid/${e}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(n)});if(!r.ok){const e=await r.json().catch(()=>({}));throw new Error(e.detail||`HTTP ${r.status}: ${r.statusText}`)}const o=await r.json();return{success:!0,data:hj(o),message:"Route updated successfully"}}catch(n){return{success:!1,data:null,message:n instanceof Error?n.message:"Failed to update route"}}},delete:async e=>{try{return await uj.put(`/routes/uuid/${e}/soft-delete`,{deleted_at:(new Date).toISOString()}),{success:!0,data:!0,message:"Route deleted successfully"}}catch(t){return{success:!1,data:!1,message:t instanceof Error?t.message:"Failed to delete route"}}},sync:async e=>{try{return{success:!1,data:null,message:"Route sync not implemented yet"}}catch(t){return{success:!1,data:null,message:t instanceof Error?t.message:"Failed to sync route"}}},unsync:async e=>{try{return{success:!1,data:null,message:"Route unsync not implemented yet"}}catch(t){return{success:!1,data:null,message:t instanceof Error?t.message:"Failed to unsync route"}}},applySegmentation:async(e,t)=>{try{await uj.post(`/routes/${e}/segment`,t);return{success:!0,data:{segmentsCreated:t.segments.length,message:"Segmentation applied successfully"},message:"Segmentation applied successfully"}}catch(n){return{success:!1,data:{segmentsCreated:0,message:"Failed to apply segmentation"},message:n instanceof Error?n.message:"Failed to apply segmentation"}}},clearSegmentation:async e=>{try{return{success:!0,data:{message:(await uj.post(`/routes/${e}/clear-segmentation`)).message||"Segmentation cleared successfully"},message:"Segmentation cleared successfully"}}catch(t){return{success:!1,data:{message:"Failed to clear segmentation"},message:t instanceof Error?t.message:"Failed to clear segmentation"}}},save:async e=>await uj.post("/routes/save",e),batchSave:async e=>{try{const t=new Map,n=e.roads.map(n=>{if(!n.origin||!n.destination)return null;let r=null;if(n.encodedPolyline&&n.encodedPolyline.trim())r=n.encodedPolyline.trim();else{if(!n.linestringGeoJson||"LineString"!==n.linestringGeoJson.type)return null;{const e=n.linestringGeoJson.coordinates;if(!e||e.length<2)return null;r=JSON.stringify(e)}}const o=bj();let i;return t.set(o,n.id),n.originalRouteGeoJson&&(i=n.originalRouteGeoJson),{uuid:o,route_name:n.name||`Route ${n.id}`,coordinates:{origin:n.origin,destination:n.destination,waypoints:n.waypoints||[]},encoded_polyline:r,region_id:parseInt(e.project_id,10),polygon_id:void 0,tag:e.tag||null,length:n.length||void 0,route_type:n.route_type||"uploaded",original_route_geo_json:i,match_percentage:n.matchPercentage}}).filter(e=>null!==e);if(0===n.length)throw new Error("No valid roads to save");const r=await uj.post("/routes/batch-save",{routes:n});if(!r.success&&void 0!==r.success)throw new Error(r.message||"Batch save failed");const o=r.data?.length||0,i=[];return Array.isArray(r.data)&&r.data.forEach(e=>{if(!e.success){const n=e.data?.uuid,r=n?t.get(n):void 0;i.push({roadId:r||"unknown",message:e.message||"Failed to save route"})}}),{success:!0,data:{savedCount:o-i.length,errors:i},message:r.message||"Batch save completed"}}catch(t){return{success:!1,data:{savedCount:0,errors:[]},message:t instanceof Error?t.message:"Batch save failed"}}},getProjectTags:async e=>{try{return{success:!0,data:(await uj.get(`/routes/project/${e}/tags`)).data||{tags:[],counts:{}},message:"Tags fetched successfully"}}catch(t){return{success:!1,data:{tags:[],counts:{}},message:t instanceof Error?t.message:"Failed to fetch tags"}}},getProjectRouteCount:async e=>{try{return{success:!0,data:(await uj.get(`/routes/project/${e}/count`)).data||{count:0},message:"Route count fetched successfully"}}catch(t){return{success:!1,data:{count:0},message:t instanceof Error?t.message:"Failed to fetch route count"}}},getByProjectPaginated:async(e,t,n,r,o,i,s)=>{try{const a=new URLSearchParams({page:t.toString(),limit:n.toString()});r&&a.append("search",r),o&&a.append("tag",o),i&&a.append("sort_by",i),s&&s.length>0&&a.append("route_types",s.join(","));const l=await uj.get(`/routes/project/${e}/paginated?${a.toString()}`);return{success:!0,data:{routes:l.routes.map(hj),pagination:l.pagination},message:"Paginated routes fetched successfully"}}catch(a){return{success:!1,data:{routes:[],pagination:{total:0,page:1,limit:20,hasMore:!1}},message:a instanceof Error?a.message:"Failed to fetch paginated routes"}}},toggleRouteEnabled:async(e,t)=>{try{const n=await uj.put(`/routes/${e}/toggle-enabled`,{is_enabled:t});return{success:!0,data:{success:n.success,message:n.message||"Route enabled status updated successfully"},message:n.message||"Route enabled status updated successfully"}}catch(n){return{success:!1,data:{success:!1,message:"Failed to toggle route"},message:n instanceof Error?n.message:"Failed to toggle route enabled status"}}},getIntersections:async e=>{try{return{success:!0,data:await uj.get(`/intersections?encoded_polyline_str=${encodeURIComponent(e)}`),message:"Intersections fetched successfully"}}catch(t){return{success:!1,data:{type:"FeatureCollection",features:[]},message:t instanceof Error?t.message:"Failed to fetch intersections"}}},batchSoftDelete:async e=>{try{const t=await uj.post("/routes/batch/soft-delete",{route_ids:e});return{success:!0,data:{deleted_count:t.deleted_count||e.length},message:t.message||"Routes deleted successfully"}}catch(t){return{success:!1,data:{deleted_count:0},message:t instanceof Error?t.message:"Failed to batch delete routes"}}},batchMove:async(e,t)=>{try{const n=await uj.post("/routes/batch/move",{route_ids:e,tag:t||null});return{success:!0,data:{updated_count:n.updated_count||e.length},message:n.message||"Routes moved successfully"}}catch(n){return{success:!1,data:{updated_count:0},message:n instanceof Error?n.message:"Failed to batch move routes"}}},renameTag:async(e,t,n)=>{try{const r=await uj.post("/rename-tag",{db_project_id:e,tag:t,new_tag:n});return{success:!0,data:r,message:r.detail||"Tag renamed successfully"}}catch(r){return{success:!1,data:{detail:""},message:r instanceof Error?r.message:"Failed to rename tag"}}},moveTag:async(e,t,n)=>{try{const r=await uj.post("/move-tag",{db_project_id:e,tag:t,new_tag:n});return{success:!0,data:r,message:r.detail||"Tag moved successfully"}}catch(r){return{success:!1,data:{detail:""},message:r instanceof Error?r.message:"Failed to move tag"}}},deleteTag:async(e,t)=>{try{const n=await uj.post("/delete-tag",{db_project_id:e,tag:t});return{success:!0,data:n,message:n.detail||"Tag deleted successfully"}}catch(n){return{success:!1,data:{detail:""},message:n instanceof Error?n.message:"Failed to delete tag"}}},segmentTag:async(e,t,n)=>{try{const r=await uj.post("/segment-tag",{db_project_id:e,tag:t,distance_km:n});return{success:!0,data:r,message:r.detail||"Routes segmented successfully"}}catch(r){return{success:!1,data:{detail:""},message:r instanceof Error?r.message:"Failed to segment routes"}}},stretchTag:async(e,t)=>{try{const n=await uj.post("/stretch-tag",{db_project_id:e,tag:t});return{success:!0,data:n,message:`Stretched ${n.stretched_routes} routes successfully`}}catch(n){return{success:!1,data:{stretched_routes:0,non_stretched_routes:0},message:n instanceof Error?n.message:"Failed to stretch routes"}}}},xj=Object.freeze(Object.defineProperty({__proto__:null,routesApi:wj},Symbol.toStringTag,{value:"Module"})),_j={getByProject:async e=>{try{const t=await uj.get(`/roads/project/${e}`);return{success:!0,data:t.map(e=>({id:e?.id?.toString(),routeId:"",name:e.name||`Road ${e.id}`,linestringGeoJson:e.polyline,is_enabled:void 0===e.is_enabled||e.is_enabled,segmentOrder:0,distanceKm:e.length||0,createdAt:e.created_at||(new Date).toISOString()})),message:"Roads fetched successfully"}}catch(t){return{success:!1,data:[],message:t instanceof Error?t.message:"Failed to fetch roads"}}},selectByPolygon:async({project_id:e,polygon:t,priorities:n})=>{try{const r={project_id:e,polygon:t};n&&n.length>0&&(r.priorities=n);const o=await uj.post("/roads/selection",r),i=o.roads||o||[];return{success:!0,data:i.map(e=>({id:e?.id?.toString()||`${Math.random()}`,routeId:"",name:e.name||`Road ${e.id}`,linestringGeoJson:e.polyline||e.linestring_geojson,is_enabled:void 0===e.is_enabled||e.is_enabled,segmentOrder:0,distanceKm:e.length||e.distance||0,createdAt:e.created_at||(new Date).toISOString()})),message:"Roads selected successfully"}}catch(r){return{success:!1,data:[],message:r instanceof Error?r.message:"Failed to select roads"}}},getByRoute:async e=>{try{return{success:!0,data:[],message:"Roads API not implemented yet"}}catch(t){return{success:!1,data:[],message:t instanceof Error?t.message:"Failed to fetch roads"}}},create:async e=>{try{return{success:!1,data:{},message:"Road creation not implemented yet"}}catch(t){return{success:!1,data:{},message:t instanceof Error?t.message:"Failed to create road"}}},update:async(e,t)=>{try{const n={};void 0!==t.name&&(n.name=t.name),"is_enabled"in t&&(n.is_enabled=t.is_enabled),"is_selected"in t&&(n.is_selected=t.is_selected);const r=await uj.put(`/roads/${e}`,n);return{success:!0,data:{id:r?.id?.toString(),routeId:"",name:r.name||`Road ${r.id}`,linestringGeoJson:r.polyline,segmentOrder:0,distanceKm:r.length||0,createdAt:r.created_at||(new Date).toISOString()},message:"Road updated successfully"}}catch(n){return{success:!1,data:null,message:n instanceof Error?n.message:"Failed to update road"}}},delete:async e=>{try{return await uj.put(`/roads/${e}/delete`,{}),{success:!0,data:!0,message:"Road deleted successfully"}}catch(t){return{success:!1,data:!1,message:t instanceof Error?t.message:"Failed to delete road"}}},stretch:async(e,t,n)=>{try{const r=await uj.post("/roads/stretch",{road_id:e,db_project_id:t,priority_list:n});if(r.success){return{success:!0,data:{stretched_roads:r.data.stretched_roads.map(e=>({id:e?.id?.toString(),routeId:"",name:e.name||`Road ${e.id}`,linestringGeoJson:"string"==typeof e.polyline?JSON.parse(e.polyline):e.polyline,segmentOrder:e.order||0,distanceKm:e.length||0,createdAt:e.created_at||(new Date).toISOString()})),total_length:r.data.total_length,total_count:r.data.total_count,endpoints:r.data.endpoints,initial_road_id:r.data.initial_road_id},message:"Road stretched successfully"}}throw new Error("Failed to stretch road")}catch(r){return{success:!1,data:{stretched_roads:[],total_length:0,total_count:0,endpoints:{start:{lat:0,lng:0,type:"unknown"},end:{lat:0,lng:0,type:"unknown"}},initial_road_id:e},message:r instanceof Error?r.message:"Failed to stretch road"}}},validateContinuity:async(e,t,n)=>{try{const r={road_ids:e,project_id:parseInt(t)};n&&(r.gap_tolerance_meters=n);const o=await uj.post("/roads/validate-continuity",r);if(o.success)return{success:!0,data:o.data,message:"Validation completed successfully"};throw new Error("Failed to validate continuity")}catch(r){return{success:!1,data:{is_continuous:!1,gaps:[],suggested_order:e,total_length:0,connected_count:0,total_count:e.length,tolerance_meters:5.55},message:r instanceof Error?r.message:"Failed to validate continuity"}}},batchFetch:async(e,t)=>{try{const n=await uj.post("/roads/batch",{road_ids:e,project_id:parseInt(t)});if(n.success){return{success:!0,data:{roads:n.data.roads.map(e=>({id:e?.id?.toString(),routeId:"",name:e.name||`Road ${e.id}`,linestringGeoJson:"string"==typeof e.polyline?JSON.parse(e.polyline):e.polyline,segmentOrder:0,distanceKm:e.length||0,createdAt:e.created_at||(new Date).toISOString()})),requested_count:n.data.requested_count,found_count:n.data.found_count},message:"Roads fetched successfully"}}throw new Error("Failed to fetch roads")}catch(n){return{success:!1,data:{roads:[],requested_count:e.length,found_count:0},message:n instanceof Error?n.message:"Failed to fetch roads"}}}},Cj={getByProject:async e=>{try{return{success:!0,data:await uj.post("/polygons/filter",{project_id:parseInt(e)}),message:"Polygons fetched successfully"}}catch(t){return{success:!1,data:[],message:t instanceof Error?t.message:"Failed to fetch polygons"}}},getAll:async()=>{try{return{success:!0,data:await uj.get("/polygons"),message:"Polygons fetched successfully"}}catch(e){return{success:!1,data:[],message:e instanceof Error?e.message:"Failed to fetch polygons"}}},create:async e=>{try{const t=await uj.post("/polygons/format-and-create",e);if(t.inserted_ids&&t.inserted_ids.length>0)return{success:!0,data:{id:t.inserted_ids[0]},message:"Polygon created successfully"};throw new Error("Failed to create polygon")}catch(t){return{success:!1,data:null,message:t instanceof Error?t.message:"Failed to create polygon"}}},update:async(e,t)=>{try{return await uj.put("/polygons",{filter:{id:e},update:t}),{success:!0,data:{id:e},message:"Polygon updated successfully"}}catch(n){return{success:!1,data:null,message:n instanceof Error?n.message:"Failed to update polygon"}}},delete:async e=>{try{return await uj.put(`/polygons/${e}/soft-delete`,{}),{success:!0,data:!0,message:"Polygon deleted successfully"}}catch(t){return{success:!1,data:!1,message:t instanceof Error?t.message:"Failed to delete polygon"}}}},Sj={getPreferences:async()=>{try{const e=await uj.get("/users/preferences");return{success:!0,data:{id:e.id,distanceUnit:"miles"===e.distance_unit?"miles":"km",googleCloudAccount:e.google_cloud_account||null,show_tooltip:e.show_tooltip??!0,show_instructions:e.show_instructions??!0,route_color_mode:e.route_color_mode||"sync_status",createdAt:e.created_at,updatedAt:e.updated_at},message:"User preferences fetched successfully"}}catch(e){return{success:!1,data:{id:1,distanceUnit:"km",googleCloudAccount:null,show_tooltip:!0,show_instructions:!0,route_color_mode:"sync_status"},message:e instanceof Error?e.message:"Failed to fetch user preferences"}}},updatePreferences:async e=>{try{const t={};void 0!==e.distanceUnit&&(t.distance_unit=e.distanceUnit),void 0!==e.googleCloudAccount&&(t.google_cloud_account=e.googleCloudAccount||null),void 0!==e.show_tooltip&&(t.show_tooltip=e.show_tooltip),void 0!==e.show_instructions&&(t.show_instructions=e.show_instructions),void 0!==e.route_color_mode&&(t.route_color_mode=e.route_color_mode);const n=await uj.put("/users/preferences",t);return{success:!0,data:{id:n.id,distanceUnit:"miles"===n.distance_unit?"miles":"km",googleCloudAccount:n.google_cloud_account||null,show_tooltip:n.show_tooltip??!0,show_instructions:n.show_instructions??!0,route_color_mode:n.route_color_mode||"sync_status",createdAt:n.created_at,updatedAt:n.updated_at},message:"User preferences updated successfully"}}catch(t){return{success:!1,data:{id:1,distanceUnit:"km",googleCloudAccount:null,show_tooltip:!0,show_instructions:!0,route_color_mode:"sync_status"},message:t instanceof Error?t.message:"Failed to update user preferences"}}}},Ej=Object.freeze(Object.defineProperty({__proto__:null,googleRoutesApi:Vw,polygonsApi:Cj,projectsApi:pj,roadsApi:_j,routesApi:wj,usersApi:Sj},Symbol.toStringTag,{value:"Module"})),Bj=async(e,t,n)=>await uj.post("/sync-to-bigquery",{db_project_id:e,project_number:t,gcp_project_id:n}),Ij=async(e,t,n,r)=>await uj.post("/sync-to-bigquery",{db_project_id:e,project_number:t,gcp_project_id:n,tag:r}),Rj=async(e,t,n,r)=>await uj.post("/sync-to-bigquery",{db_project_id:e,project_number:t,gcp_project_id:n,uuid:r}),kj="km",Tj=null,Pj=!0,Fj=!0,Mj="sync_status",Lj=Wv()(Xv(e=>({distanceUnit:"km",googleCloudAccount:null,show_tooltip:!0,show_instructions:!0,routeColorMode:"sync_status",isLoading:!1,setDistanceUnit:t=>{e({distanceUnit:t})},setGoogleCloudAccount:t=>{e({googleCloudAccount:t})},setShowTooltip:t=>{e({show_tooltip:t})},setShowInstructions:t=>{e({show_instructions:t})},setRouteColorMode:t=>{e({routeColorMode:t})},loadPreferences:t=>{e({distanceUnit:t.distanceUnit,googleCloudAccount:t.googleCloudAccount,show_tooltip:t.show_tooltip??!0,show_instructions:t.show_instructions??!0,routeColorMode:t.route_color_mode||"sync_status"})},reset:()=>{e({distanceUnit:kj,googleCloudAccount:Tj,show_tooltip:Pj,show_instructions:Fj,routeColorMode:Mj})}}),{name:"user-preferences-store",partialize:e=>({distanceUnit:e.distanceUnit,googleCloudAccount:e.googleCloudAccount,show_tooltip:e.show_tooltip,show_instructions:e.show_instructions,routeColorMode:e.routeColorMode})}));
/*!
 * html2canvas-pro 1.5.13 <https://yorickshan.github.io/html2canvas-pro/>
 * Copyright (c) 2024-present yorickshan and html2canvas-pro contributors
 * Released under MIT License
 */
var Uj=function(e,t){return(Uj=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)};function Oj(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}Uj(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}var Dj=function(){return Dj=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},Dj.apply(this,arguments)};function Nj(e,t,n,r){return new(n||(n=Promise))(function(t,o){function i(e){try{a(r.next(e))}catch(SE){o(SE)}}function s(e){try{a(r.throw(e))}catch(SE){o(SE)}}function a(e){var r;e.done?t(e.value):(r=e.value,r instanceof n?r:new n(function(e){e(r)})).then(i,s)}a((r=r.apply(e,[])).next())})}function jj(e,t){var n,r,o,i,s={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function a(a){return function(l){return function(a){if(n)throw new TypeError("Generator is already executing.");for(;i&&(i=0,a[0]&&(s=0)),s;)try{if(n=1,r&&(o=2&a[0]?r.return:a[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,a[1])).done)return o;switch(r=0,o&&(a=[2&a[0],o.value]),a[0]){case 0:case 1:o=a;break;case 4:return s.label++,{value:a[1],done:!1};case 5:s.label++,r=a[1],a=[0];continue;case 7:a=s.ops.pop(),s.trys.pop();continue;default:if(!(o=s.trys,(o=o.length>0&&o[o.length-1])||6!==a[0]&&2!==a[0])){s=0;continue}if(3===a[0]&&(!o||a[1]>o[0]&&a[1]<o[3])){s.label=a[1];break}if(6===a[0]&&s.label<o[1]){s.label=o[1],o=a;break}if(o&&s.label<o[2]){s.label=o[2],s.ops.push(a);break}o[2]&&s.ops.pop(),s.trys.pop();continue}a=t.call(e,s)}catch(SE){a=[6,SE],r=0}finally{n=o=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,l])}}}"function"==typeof SuppressedError&&SuppressedError;for(var Qj=function(){function e(e,t,n,r){this.left=e,this.top=t,this.width=n,this.height=r}return e.prototype.add=function(t,n,r,o){return new e(this.left+t,this.top+n,this.width+r,this.height+o)},e.fromClientRect=function(t,n){return new e(n.left+t.windowBounds.left,n.top+t.windowBounds.top,n.width,n.height)},e.fromDOMRectList=function(t,n){var r=Array.from(n).find(function(e){return 0!==e.width});return r?new e(r.left+t.windowBounds.left,r.top+t.windowBounds.top,r.width,r.height):e.EMPTY},e.EMPTY=new e(0,0,0,0),e}(),zj=function(e,t){return Qj.fromClientRect(e,t.getBoundingClientRect())},Hj=function(e){for(var t=[],n=0,r=e.length;n<r;){var o=e.charCodeAt(n++);if(o>=55296&&o<=56319&&n<r){var i=e.charCodeAt(n++);56320==(64512&i)?t.push(((1023&o)<<10)+(1023&i)+65536):(t.push(o),n--)}else t.push(o)}return t},Gj=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];if(String.fromCodePoint)return String.fromCodePoint.apply(String,e);var n=e.length;if(!n)return"";for(var r=[],o=-1,i="";++o<n;){var s=e[o];s<=65535?r.push(s):(s-=65536,r.push(55296+(s>>10),s%1024+56320)),(o+1===n||r.length>16384)&&(i+=String.fromCharCode.apply(String,r),r.length=0)}return i},Vj="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",Wj="undefined"==typeof Uint8Array?[]:new Uint8Array(256),$j=0;$j<64;$j++)Wj[Vj.charCodeAt($j)]=$j;for(var Kj="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",Xj="undefined"==typeof Uint8Array?[]:new Uint8Array(256),Yj=0;Yj<64;Yj++)Xj[Kj.charCodeAt(Yj)]=Yj;for(var qj=function(e,t,n){return e.slice?e.slice(t,n):new Uint16Array(Array.prototype.slice.call(e,t,n))},Jj=function(){function e(e,t,n,r,o,i){this.initialValue=e,this.errorValue=t,this.highStart=n,this.highValueIndex=r,this.index=o,this.data=i}return e.prototype.get=function(e){var t;if(e>=0){if(e<55296||e>56319&&e<=65535)return t=((t=this.index[e>>5])<<2)+(31&e),this.data[t];if(e<=65535)return t=((t=this.index[2048+(e-55296>>5)])<<2)+(31&e),this.data[t];if(e<this.highStart)return t=2080+(e>>11),t=this.index[t],t+=e>>5&63,t=((t=this.index[t])<<2)+(31&e),this.data[t];if(e<=1114111)return this.data[this.highValueIndex]}return this.errorValue},e}(),Zj="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",eQ="undefined"==typeof Uint8Array?[]:new Uint8Array(256),tQ=0;tQ<64;tQ++)eQ[Zj.charCodeAt(tQ)]=tQ;var nQ,rQ,oQ,iQ,sQ,aQ,lQ,cQ,uQ,dQ=10,AQ=13,hQ=15,pQ=17,fQ=18,gQ=19,mQ=20,yQ=21,vQ=22,bQ=24,wQ=25,xQ=26,_Q=27,CQ=28,SQ=30,EQ=32,BQ=33,IQ=34,RQ=35,kQ=37,TQ=38,PQ=39,FQ=40,MQ=42,LQ=[9001,65288],UQ="",OQ="",DQ=(nQ="KwAAAAAAAAAACA4AUD0AADAgAAACAAAAAAAIABAAGABAAEgAUABYAGAAaABgAGgAYgBqAF8AZwBgAGgAcQB5AHUAfQCFAI0AlQCdAKIAqgCyALoAYABoAGAAaABgAGgAwgDKAGAAaADGAM4A0wDbAOEA6QDxAPkAAQEJAQ8BFwF1AH0AHAEkASwBNAE6AUIBQQFJAVEBWQFhAWgBcAF4ATAAgAGGAY4BlQGXAZ8BpwGvAbUBvQHFAc0B0wHbAeMB6wHxAfkBAQIJAvEBEQIZAiECKQIxAjgCQAJGAk4CVgJeAmQCbAJ0AnwCgQKJApECmQKgAqgCsAK4ArwCxAIwAMwC0wLbAjAA4wLrAvMC+AIAAwcDDwMwABcDHQMlAy0DNQN1AD0DQQNJA0kDSQNRA1EDVwNZA1kDdQB1AGEDdQBpA20DdQN1AHsDdQCBA4kDkQN1AHUAmQOhA3UAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AKYDrgN1AHUAtgO+A8YDzgPWAxcD3gPjA+sD8wN1AHUA+wMDBAkEdQANBBUEHQQlBCoEFwMyBDgEYABABBcDSARQBFgEYARoBDAAcAQzAXgEgASIBJAEdQCXBHUAnwSnBK4EtgS6BMIEyAR1AHUAdQB1AHUAdQCVANAEYABgAGAAYABgAGAAYABgANgEYADcBOQEYADsBPQE/AQEBQwFFAUcBSQFLAU0BWQEPAVEBUsFUwVbBWAAYgVgAGoFcgV6BYIFigWRBWAAmQWfBaYFYABgAGAAYABgAKoFYACxBbAFuQW6BcEFwQXHBcEFwQXPBdMF2wXjBeoF8gX6BQIGCgYSBhoGIgYqBjIGOgZgAD4GRgZMBmAAUwZaBmAAYABgAGAAYABgAGAAYABgAGAAYABgAGIGYABpBnAGYABgAGAAYABgAGAAYABgAGAAYAB4Bn8GhQZgAGAAYAB1AHcDFQSLBmAAYABgAJMGdQA9A3UAmwajBqsGqwaVALMGuwbDBjAAywbSBtIG1QbSBtIG0gbSBtIG0gbdBuMG6wbzBvsGAwcLBxMHAwcbByMHJwcsBywHMQcsB9IGOAdAB0gHTgfSBkgHVgfSBtIG0gbSBtIG0gbSBtIG0gbSBiwHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAdgAGAALAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAdbB2MHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsB2kH0gZwB64EdQB1AHUAdQB1AHUAdQB1AHUHfQdgAIUHjQd1AHUAlQedB2AAYAClB6sHYACzB7YHvgfGB3UAzgfWBzMB3gfmB1EB7gf1B/0HlQENAQUIDQh1ABUIHQglCBcDLQg1CD0IRQhNCEEDUwh1AHUAdQBbCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIcAh3CHoIMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwAIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIgggwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAALAcsBywHLAcsBywHLAcsBywHLAcsB4oILAcsB44I0gaWCJ4Ipgh1AHUAqgiyCHUAdQB1AHUAdQB1AHUAdQB1AHUAtwh8AXUAvwh1AMUIyQjRCNkI4AjoCHUAdQB1AO4I9gj+CAYJDgkTCS0HGwkjCYIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiAAIAAAAFAAYABgAGIAXwBgAHEAdQBFAJUAogCyAKAAYABgAEIA4ABGANMA4QDxAMEBDwE1AFwBLAE6AQEBUQF4QkhCmEKoQrhCgAHIQsAB0MLAAcABwAHAAeDC6ABoAHDCwMMAAcABwAHAAdDDGMMAAcAB6MM4wwjDWMNow3jDaABoAGgAaABoAGgAaABoAGgAaABoAGgAaABoAGgAaABoAGgAaABoAEjDqABWw6bDqABpg6gAaABoAHcDvwOPA+gAaABfA/8DvwO/A78DvwO/A78DvwO/A78DvwO/A78DvwO/A78DvwO/A78DvwO/A78DvwO/A78DvwO/A78DpcPAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcAB9cPKwkyCToJMAB1AHUAdQBCCUoJTQl1AFUJXAljCWcJawkwADAAMAAwAHMJdQB2CX4JdQCECYoJjgmWCXUAngkwAGAAYABxAHUApgn3A64JtAl1ALkJdQDACTAAMAAwADAAdQB1AHUAdQB1AHUAdQB1AHUAowYNBMUIMAAwADAAMADICcsJ0wnZCRUE4QkwAOkJ8An4CTAAMAB1AAAKvwh1AAgKDwoXCh8KdQAwACcKLgp1ADYKqAmICT4KRgowADAAdQB1AE4KMAB1AFYKdQBeCnUAZQowADAAMAAwADAAMAAwADAAMAAVBHUAbQowADAAdQC5CXUKMAAwAHwBxAijBogEMgF9CoQKiASMCpQKmgqIBKIKqgquCogEDQG2Cr4KxgrLCjAAMADTCtsKCgHjCusK8Qr5CgELMAAwADAAMAB1AIsECQsRC3UANAEZCzAAMAAwADAAMAB1ACELKQswAHUANAExCzkLdQBBC0kLMABRC1kLMAAwADAAMAAwADAAdQBhCzAAMAAwAGAAYABpC3ELdwt/CzAAMACHC4sLkwubC58Lpwt1AK4Ltgt1APsDMAAwADAAMAAwADAAMAAwAL4LwwvLC9IL1wvdCzAAMADlC+kL8Qv5C/8LSQswADAAMAAwADAAMAAwADAAMAAHDDAAMAAwADAAMAAODBYMHgx1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1ACYMMAAwADAAdQB1AHUALgx1AHUAdQB1AHUAdQA2DDAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwAHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AD4MdQBGDHUAdQB1AHUAdQB1AEkMdQB1AHUAdQB1AFAMMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwAHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQBYDHUAdQB1AF8MMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUA+wMVBGcMMAAwAHwBbwx1AHcMfwyHDI8MMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAYABgAJcMMAAwADAAdQB1AJ8MlQClDDAAMACtDCwHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsB7UMLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AA0EMAC9DDAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAsBywHLAcsBywHLAcsBywHLQcwAMEMyAwsBywHLAcsBywHLAcsBywHLAcsBywHzAwwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwAHUAdQB1ANQM2QzhDDAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMABgAGAAYABgAGAAYABgAOkMYADxDGAA+AwADQYNYABhCWAAYAAODTAAMAAwADAAFg1gAGAAHg37AzAAMAAwADAAYABgACYNYAAsDTQNPA1gAEMNPg1LDWAAYABgAGAAYABgAGAAYABgAGAAUg1aDYsGVglhDV0NcQBnDW0NdQ15DWAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAlQCBDZUAiA2PDZcNMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAnw2nDTAAMAAwADAAMAAwAHUArw23DTAAMAAwADAAMAAwADAAMAAwADAAMAB1AL8NMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAB1AHUAdQB1AHUAdQDHDTAAYABgAM8NMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAA1w11ANwNMAAwAD0B5A0wADAAMAAwADAAMADsDfQN/A0EDgwOFA4wABsOMAAwADAAMAAwADAAMAAwANIG0gbSBtIG0gbSBtIG0gYjDigOwQUuDsEFMw7SBjoO0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIGQg5KDlIOVg7SBtIGXg5lDm0OdQ7SBtIGfQ6EDooOjQ6UDtIGmg6hDtIG0gaoDqwO0ga0DrwO0gZgAGAAYADEDmAAYAAkBtIGzA5gANIOYADaDokO0gbSBt8O5w7SBu8O0gb1DvwO0gZgAGAAxA7SBtIG0gbSBtIGYABgAGAAYAAED2AAsAUMD9IG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIGFA8sBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAccD9IGLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHJA8sBywHLAcsBywHLAccDywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywPLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAc0D9IG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIGLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAccD9IG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIGFA8sBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHPA/SBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gYUD0QPlQCVAJUAMAAwADAAMACVAJUAlQCVAJUAlQCVAEwPMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAA//8EAAQABAAEAAQABAAEAAQABAANAAMAAQABAAIABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQACgATABcAHgAbABoAHgAXABYAEgAeABsAGAAPABgAHABLAEsASwBLAEsASwBLAEsASwBLABgAGAAeAB4AHgATAB4AUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQABYAGwASAB4AHgAeAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAWAA0AEQAeAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAAQABAAEAAQABAAFAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAJABYAGgAbABsAGwAeAB0AHQAeAE8AFwAeAA0AHgAeABoAGwBPAE8ADgBQAB0AHQAdAE8ATwAXAE8ATwBPABYAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAdAFAAUABQAFAAUABQAFAAUAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAFAAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAeAB4AHgAeAFAATwBAAE8ATwBPAEAATwBQAFAATwBQAB4AHgAeAB4AHgAeAB0AHQAdAB0AHgAdAB4ADgBQAFAAUABQAFAAHgAeAB4AHgAeAB4AHgBQAB4AUAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4ABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAJAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAkACQAJAAkACQAJAAkABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAeAB4AHgAeAFAAHgAeAB4AKwArAFAAUABQAFAAGABQACsAKwArACsAHgAeAFAAHgBQAFAAUAArAFAAKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4ABAAEAAQABAAEAAQABAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAUAAeAB4AHgAeAB4AHgBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAYAA0AKwArAB4AHgAbACsABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQADQAEAB4ABAAEAB4ABAAEABMABAArACsAKwArACsAKwArACsAVgBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAKwArACsAKwBWAFYAVgBWAB4AHgArACsAKwArACsAKwArACsAKwArACsAHgAeAB4AHgAeAB4AHgAeAB4AGgAaABoAGAAYAB4AHgAEAAQABAAEAAQABAAEAAQABAAEAAQAEwAEACsAEwATAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABABLAEsASwBLAEsASwBLAEsASwBLABoAGQAZAB4AUABQAAQAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQABMAUAAEAAQABAAEAAQABAAEAB4AHgAEAAQABAAEAAQABABQAFAABAAEAB4ABAAEAAQABABQAFAASwBLAEsASwBLAEsASwBLAEsASwBQAFAAUAAeAB4AUAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwAeAFAABABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEAAQABAAEAFAAKwArACsAKwArACsAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEAAQAUABQAB4AHgAYABMAUAArACsABAAbABsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAFAABAAEAAQABAAEAFAABAAEAAQAUAAEAAQABAAEAAQAKwArAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAArACsAHgArAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwArACsAKwArACsAKwArAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAB4ABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAFAABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQAUAAEAAQABAAEAAQABAAEAFAAUABQAFAAUABQAFAAUABQAFAABAAEAA0ADQBLAEsASwBLAEsASwBLAEsASwBLAB4AUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAArAFAAUABQAFAAUABQAFAAUAArACsAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAUAArACsAKwBQAFAAUABQACsAKwAEAFAABAAEAAQABAAEAAQABAArACsABAAEACsAKwAEAAQABABQACsAKwArACsAKwArACsAKwAEACsAKwArACsAUABQACsAUABQAFAABAAEACsAKwBLAEsASwBLAEsASwBLAEsASwBLAFAAUAAaABoAUABQAFAAUABQAEwAHgAbAFAAHgAEACsAKwAEAAQABAArAFAAUABQAFAAUABQACsAKwArACsAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAUABQACsAUABQACsAUABQACsAKwAEACsABAAEAAQABAAEACsAKwArACsABAAEACsAKwAEAAQABAArACsAKwAEACsAKwArACsAKwArACsAUABQAFAAUAArAFAAKwArACsAKwArACsAKwBLAEsASwBLAEsASwBLAEsASwBLAAQABABQAFAAUAAEAB4AKwArACsAKwArACsAKwArACsAKwAEAAQABAArAFAAUABQAFAAUABQAFAAUABQACsAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAUABQACsAUABQAFAAUABQACsAKwAEAFAABAAEAAQABAAEAAQABAAEACsABAAEAAQAKwAEAAQABAArACsAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAABAAEACsAKwBLAEsASwBLAEsASwBLAEsASwBLAB4AGwArACsAKwArACsAKwArAFAABAAEAAQABAAEAAQAKwAEAAQABAArAFAAUABQAFAAUABQAFAAUAArACsAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAAQABAArACsABAAEACsAKwAEAAQABAArACsAKwArACsAKwArAAQABAAEACsAKwArACsAUABQACsAUABQAFAABAAEACsAKwBLAEsASwBLAEsASwBLAEsASwBLAB4AUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArAAQAUAArAFAAUABQAFAAUABQACsAKwArAFAAUABQACsAUABQAFAAUAArACsAKwBQAFAAKwBQACsAUABQACsAKwArAFAAUAArACsAKwBQAFAAUAArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArAAQABAAEAAQABAArACsAKwAEAAQABAArAAQABAAEAAQAKwArAFAAKwArACsAKwArACsABAArACsAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAUABQAFAAHgAeAB4AHgAeAB4AGwAeACsAKwArACsAKwAEAAQABAAEAAQAUABQAFAAUABQAFAAUABQACsAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAUAAEAAQABAAEAAQABAAEACsABAAEAAQAKwAEAAQABAAEACsAKwArACsAKwArACsABAAEACsAUABQAFAAKwArACsAKwArAFAAUAAEAAQAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAKwAOAFAAUABQAFAAUABQAFAAHgBQAAQABAAEAA4AUABQAFAAUABQAFAAUABQACsAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAKwArAAQAUAAEAAQABAAEAAQABAAEACsABAAEAAQAKwAEAAQABAAEACsAKwArACsAKwArACsABAAEACsAKwArACsAKwArACsAUAArAFAAUAAEAAQAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwBQAFAAKwArACsAKwArACsAKwArACsAKwArACsAKwAEAAQABAAEAFAAUABQAFAAUABQAFAAUABQACsAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAFAABAAEAAQABAAEAAQABAArAAQABAAEACsABAAEAAQABABQAB4AKwArACsAKwBQAFAAUAAEAFAAUABQAFAAUABQAFAAUABQAFAABAAEACsAKwBLAEsASwBLAEsASwBLAEsASwBLAFAAUABQAFAAUABQAFAAUABQABoAUABQAFAAUABQAFAAKwAEAAQABAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQACsAUAArACsAUABQAFAAUABQAFAAUAArACsAKwAEACsAKwArACsABAAEAAQABAAEAAQAKwAEACsABAAEAAQABAAEAAQABAAEACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArAAQABAAeACsAKwArACsAKwArACsAKwArACsAKwArAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXAAqAFwAXAAqACoAKgAqACoAKgAqACsAKwArACsAGwBcAFwAXABcAFwAXABcACoAKgAqACoAKgAqACoAKgAeAEsASwBLAEsASwBLAEsASwBLAEsADQANACsAKwArACsAKwBcAFwAKwBcACsAXABcAFwAXABcACsAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcACsAXAArAFwAXABcAFwAXABcAFwAXABcAFwAKgBcAFwAKgAqACoAKgAqACoAKgAqACoAXAArACsAXABcAFwAXABcACsAXAArACoAKgAqACoAKgAqACsAKwBLAEsASwBLAEsASwBLAEsASwBLACsAKwBcAFwAXABcAFAADgAOAA4ADgAeAA4ADgAJAA4ADgANAAkAEwATABMAEwATAAkAHgATAB4AHgAeAAQABAAeAB4AHgAeAB4AHgBLAEsASwBLAEsASwBLAEsASwBLAFAAUABQAFAAUABQAFAAUABQAFAADQAEAB4ABAAeAAQAFgARABYAEQAEAAQAUABQAFAAUABQAFAAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQADQAEAAQABAAEAAQADQAEAAQAUABQAFAAUABQAAQABAAEAAQABAAEAAQABAAEAAQABAArAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAArAA0ADQAeAB4AHgAeAB4AHgAEAB4AHgAeAB4AHgAeACsAHgAeAA4ADgANAA4AHgAeAB4AHgAeAAkACQArACsAKwArACsAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgBcAEsASwBLAEsASwBLAEsASwBLAEsADQANAB4AHgAeAB4AXABcAFwAXABcAFwAKgAqACoAKgBcAFwAXABcACoAKgAqAFwAKgAqACoAXABcACoAKgAqACoAKgAqACoAXABcAFwAKgAqACoAKgBcAFwAXABcAFwAXABcAFwAXABcAFwAXABcACoAKgAqACoAKgAqACoAKgAqACoAKgAqAFwAKgBLAEsASwBLAEsASwBLAEsASwBLACoAKgAqACoAKgAqAFAAUABQAFAAUABQACsAUAArACsAKwArACsAUAArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAHgBQAFAAUABQAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFAAUABQAFAAUABQAFAAUABQACsAUABQAFAAUAArACsAUABQAFAAUABQAFAAUAArAFAAKwBQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAKwArAFAAUABQAFAAUABQAFAAKwBQACsAUABQAFAAUAArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsABAAEAAQAHgANAB4AHgAeAB4AHgAeAB4AUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwBQAFAAUABQAFAAUAArACsADQBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAHgAeAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAANAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAWABEAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAA0ADQANAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAAQABAAEACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAANAA0AKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEACsAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUAArAAQABAArACsAKwArACsAKwArACsAKwArACsAKwBcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqAA0ADQAVAFwADQAeAA0AGwBcACoAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwAeAB4AEwATAA0ADQAOAB4AEwATAB4ABAAEAAQACQArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArAFAAUABQAFAAUAAEAAQAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQAUAArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwAEAAQABAAEAAQABAAEAAQABAAEAAQABAArACsAKwArAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsAKwArACsAHgArACsAKwATABMASwBLAEsASwBLAEsASwBLAEsASwBcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXAArACsAXABcAFwAXABcACsAKwArACsAKwArACsAKwArACsAKwBcAFwAXABcAFwAXABcAFwAXABcAFwAXAArACsAKwArAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAXAArACsAKwAqACoAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAAQABAArACsAHgAeAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcACoAKgAqACoAKgAqACoAKgAqACoAKwAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKwArAAQASwBLAEsASwBLAEsASwBLAEsASwArACsAKwArACsAKwBLAEsASwBLAEsASwBLAEsASwBLACsAKwArACsAKwArACoAKgAqACoAKgAqACoAXAAqACoAKgAqACoAKgArACsABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsABAAEAAQABAAEAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAAQABABQAFAAUABQAFAAUABQACsAKwArACsASwBLAEsASwBLAEsASwBLAEsASwANAA0AHgANAA0ADQANAB4AHgAeAB4AHgAeAB4AHgAeAB4ABAAEAAQABAAEAAQABAAEAAQAHgAeAB4AHgAeAB4AHgAeAB4AKwArACsABAAEAAQAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEAAQABAAEAAQABABQAFAASwBLAEsASwBLAEsASwBLAEsASwBQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsAKwArACsAKwArACsAKwAeAB4AHgAeAFAAUABQAFAABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsAKwArAA0ADQANAA0ADQBLAEsASwBLAEsASwBLAEsASwBLACsAKwArAFAAUABQAEsASwBLAEsASwBLAEsASwBLAEsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAA0ADQBQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwBQAFAAUAAeAB4AHgAeAB4AHgAeAB4AKwArACsAKwArACsAKwArAAQABAAEAB4ABAAEAAQABAAEAAQABAAEAAQABAAEAAQABABQAFAAUABQAAQAUABQAFAAUABQAFAABABQAFAABAAEAAQAUAArACsAKwArACsABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsABAAEAAQABAAEAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwArAFAAUABQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAKwBQACsAUAArAFAAKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeACsAKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArAB4AHgAeAB4AHgAeAB4AHgBQAB4AHgAeAFAAUABQACsAHgAeAB4AHgAeAB4AHgAeAB4AHgBQAFAAUABQACsAKwAeAB4AHgAeAB4AHgArAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwArAFAAUABQACsAHgAeAB4AHgAeAB4AHgAOAB4AKwANAA0ADQANAA0ADQANAAkADQANAA0ACAAEAAsABAAEAA0ACQANAA0ADAAdAB0AHgAXABcAFgAXABcAFwAWABcAHQAdAB4AHgAUABQAFAANAAEAAQAEAAQABAAEAAQACQAaABoAGgAaABoAGgAaABoAHgAXABcAHQAVABUAHgAeAB4AHgAeAB4AGAAWABEAFQAVABUAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4ADQAeAA0ADQANAA0AHgANAA0ADQAHAB4AHgAeAB4AKwAEAAQABAAEAAQABAAEAAQABAAEAFAAUAArACsATwBQAFAAUABQAFAAHgAeAB4AFgARAE8AUABPAE8ATwBPAFAAUABQAFAAUAAeAB4AHgAWABEAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArABsAGwAbABsAGwAbABsAGgAbABsAGwAbABsAGwAbABsAGwAbABsAGwAbABsAGgAbABsAGwAbABoAGwAbABoAGwAbABsAGwAbABsAGwAbABsAGwAbABsAGwAbABsAGwAbAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQAHgAeAFAAGgAeAB0AHgBQAB4AGgAeAB4AHgAeAB4AHgAeAB4AHgBPAB4AUAAbAB4AHgBQAFAAUABQAFAAHgAeAB4AHQAdAB4AUAAeAFAAHgBQAB4AUABPAFAAUAAeAB4AHgAeAB4AHgAeAFAAUABQAFAAUAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAFAAHgBQAFAAUABQAE8ATwBQAFAAUABQAFAATwBQAFAATwBQAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAFAAUABQAFAATwBPAE8ATwBPAE8ATwBPAE8ATwBQAFAAUABQAFAAUABQAFAAUAAeAB4AUABQAFAAUABPAB4AHgArACsAKwArAB0AHQAdAB0AHQAdAB0AHQAdAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB0AHgAdAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAdAB4AHQAdAB4AHgAeAB0AHQAeAB4AHQAeAB4AHgAdAB4AHQAbABsAHgAdAB4AHgAeAB4AHQAeAB4AHQAdAB0AHQAeAB4AHQAeAB0AHgAdAB0AHQAdAB0AHQAeAB0AHgAeAB4AHgAeAB0AHQAdAB0AHgAeAB4AHgAdAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAdAB4AHgAeAB0AHgAeAB4AHgAeAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAdAB0AHgAeAB0AHQAdAB0AHgAeAB0AHQAeAB4AHQAdAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB0AHQAeAB4AHQAdAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHQAeAB4AHgAdAB4AHgAeAB4AHgAeAB4AHQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AFAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeABYAEQAWABEAHgAeAB4AHgAeAB4AHQAeAB4AHgAeAB4AHgAeACUAJQAeAB4AHgAeAB4AHgAeAB4AHgAWABEAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AJQAlACUAJQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAFAAHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHgAeAB4AHgAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAeAB4AHQAdAB0AHQAeAB4AHgAeAB4AHgAeAB4AHgAeAB0AHQAeAB0AHQAdAB0AHQAdAB0AHgAeAB4AHgAeAB4AHgAeAB0AHQAeAB4AHQAdAB4AHgAeAB4AHQAdAB4AHgAeAB4AHQAdAB0AHgAeAB0AHgAeAB0AHQAdAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAdAB0AHQAdAB4AHgAeAB4AHgAeAB4AHgAeAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAlACUAJQAlAB4AHQAdAB4AHgAdAB4AHgAeAB4AHQAdAB4AHgAeAB4AJQAlAB0AHQAlAB4AJQAlACUAIAAlACUAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAlACUAJQAeAB4AHgAeAB0AHgAdAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAdAB0AHgAdAB0AHQAeAB0AJQAdAB0AHgAdAB0AHgAdAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeACUAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHQAdAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAlACUAJQAlACUAJQAlACUAJQAlACUAJQAdAB0AHQAdACUAHgAlACUAJQAdACUAJQAdAB0AHQAlACUAHQAdACUAHQAdACUAJQAlAB4AHQAeAB4AHgAeAB0AHQAlAB0AHQAdAB0AHQAdACUAJQAlACUAJQAdACUAJQAgACUAHQAdACUAJQAlACUAJQAlACUAJQAeAB4AHgAlACUAIAAgACAAIAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB0AHgAeAB4AFwAXABcAFwAXABcAHgATABMAJQAeAB4AHgAWABEAFgARABYAEQAWABEAFgARABYAEQAWABEATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeABYAEQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAWABEAFgARABYAEQAWABEAFgARAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AFgARABYAEQAWABEAFgARABYAEQAWABEAFgARABYAEQAWABEAFgARABYAEQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAWABEAFgARAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AFgARAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAdAB0AHQAdAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AUABQAFAAUAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAEAAQABAAeAB4AKwArACsAKwArABMADQANAA0AUAATAA0AUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAUAANACsAKwArACsAKwArACsAKwArACsAKwArACsAKwAEAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQACsAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXAA0ADQANAA0ADQANAA0ADQAeAA0AFgANAB4AHgAXABcAHgAeABcAFwAWABEAFgARABYAEQAWABEADQANAA0ADQATAFAADQANAB4ADQANAB4AHgAeAB4AHgAMAAwADQANAA0AHgANAA0AFgANAA0ADQANAA0ADQANAA0AHgANAB4ADQANAB4AHgAeACsAKwArACsAKwArACsAKwArACsAKwArACsAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACsAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAKwArACsAKwArACsAKwArACsAKwArACsAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwAlACUAJQAlACUAJQAlACUAJQAlACUAJQArACsAKwArAA0AEQARACUAJQBHAFcAVwAWABEAFgARABYAEQAWABEAFgARACUAJQAWABEAFgARABYAEQAWABEAFQAWABEAEQAlAFcAVwBXAFcAVwBXAFcAVwBXAAQABAAEAAQABAAEACUAVwBXAFcAVwA2ACUAJQBXAFcAVwBHAEcAJQAlACUAKwBRAFcAUQBXAFEAVwBRAFcAUQBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFEAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBRAFcAUQBXAFEAVwBXAFcAVwBXAFcAUQBXAFcAVwBXAFcAVwBRAFEAKwArAAQABAAVABUARwBHAFcAFQBRAFcAUQBXAFEAVwBRAFcAUQBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFEAVwBRAFcAUQBXAFcAVwBXAFcAVwBRAFcAVwBXAFcAVwBXAFEAUQBXAFcAVwBXABUAUQBHAEcAVwArACsAKwArACsAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAKwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAKwAlACUAVwBXAFcAVwAlACUAJQAlACUAJQAlACUAJQAlACsAKwArACsAKwArACsAKwArACsAKwArAFEAUQBRAFEAUQBRAFEAUQBRAFEAUQBRAFEAUQBRAFEAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQArAFcAVwBXAFcAVwBXAFcAVwBXAFcAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQBPAE8ATwBPAE8ATwBPAE8AJQBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXACUAJQAlAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAEcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAKwArACsAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAADQATAA0AUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABLAEsASwBLAEsASwBLAEsASwBLAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAFAABAAEAAQABAAeAAQABAAEAAQABAAEAAQABAAEAAQAHgBQAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AUABQAAQABABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAeAA0ADQANAA0ADQArACsAKwArACsAKwArACsAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAFAAUABQAFAAUABQAFAAUABQAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AUAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgBQAB4AHgAeAB4AHgAeAFAAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAHgAeAB4AHgAeAB4AHgAeAB4AKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwAeAB4AUABQAFAAUABQAFAAUABQAFAAUABQAAQAUABQAFAABABQAFAAUABQAAQAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAAQABAAeAB4AHgAeAAQAKwArACsAUABQAFAAUABQAFAAHgAeABoAHgArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAADgAOABMAEwArACsAKwArACsAKwArACsABAAEAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAAQABAAEACsAKwArACsAKwArACsAKwANAA0ASwBLAEsASwBLAEsASwBLAEsASwArACsAKwArACsAKwAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABABQAFAAUABQAFAAUAAeAB4AHgBQAA4AUABQAAQAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEAA0ADQBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQAKwArACsAKwArACsAKwArACsAKwArAB4AWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYACsAKwArAAQAHgAeAB4AHgAeAB4ADQANAA0AHgAeAB4AHgArAFAASwBLAEsASwBLAEsASwBLAEsASwArACsAKwArAB4AHgBcAFwAXABcAFwAKgBcAFwAXABcAFwAXABcAFwAXABcAEsASwBLAEsASwBLAEsASwBLAEsAXABcAFwAXABcACsAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsAKwArACsAKwArACsAKwArAFAAUABQAAQAUABQAFAAUABQAFAAUABQAAQABAArACsASwBLAEsASwBLAEsASwBLAEsASwArACsAHgANAA0ADQBcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAKgAqACoAXAAqACoAKgBcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXAAqAFwAKgAqACoAXABcACoAKgBcAFwAXABcAFwAKgAqAFwAKgBcACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFwAXABcACoAKgBQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAA0ADQBQAFAAUAAEAAQAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUAArACsAUABQAFAAUABQAFAAKwArAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAHgAeACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQADQAEAAQAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAVABVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBUAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVACsAKwArACsAKwArACsAKwArACsAKwArAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAKwArACsAKwBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAKwArACsAKwAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXACUAJQBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAJQAlACUAJQAlACUAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAKwArACsAKwArAFYABABWAFYAVgBWAFYAVgBWAFYAVgBWAB4AVgBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAVgArAFYAVgBWAFYAVgArAFYAKwBWAFYAKwBWAFYAKwBWAFYAVgBWAFYAVgBWAFYAVgBWAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAEQAWAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUAAaAB4AKwArAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQAGAARABEAGAAYABMAEwAWABEAFAArACsAKwArACsAKwAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACUAJQAlACUAJQAWABEAFgARABYAEQAWABEAFgARABYAEQAlACUAFgARACUAJQAlACUAJQAlACUAEQAlABEAKwAVABUAEwATACUAFgARABYAEQAWABEAJQAlACUAJQAlACUAJQAlACsAJQAbABoAJQArACsAKwArAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArAAcAKwATACUAJQAbABoAJQAlABYAEQAlACUAEQAlABEAJQBXAFcAVwBXAFcAVwBXAFcAVwBXABUAFQAlACUAJQATACUAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXABYAJQARACUAJQAlAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwAWACUAEQAlABYAEQARABYAEQARABUAVwBRAFEAUQBRAFEAUQBRAFEAUQBRAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAEcARwArACsAVwBXAFcAVwBXAFcAKwArAFcAVwBXAFcAVwBXACsAKwBXAFcAVwBXAFcAVwArACsAVwBXAFcAKwArACsAGgAbACUAJQAlABsAGwArAB4AHgAeAB4AHgAeAB4AKwArACsAKwArACsAKwArACsAKwAEAAQABAAQAB0AKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsADQANAA0AKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArAB4AHgAeAB4AHgAeAB4AHgAeAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgBQAFAAHgAeAB4AKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAAQAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwAEAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAA0AUABQAFAAUAArACsAKwArAFAAUABQAFAAUABQAFAAUAANAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwArACsAKwAeACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAKwArAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUAArACsAKwBQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwANAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAeAB4AUABQAFAAUABQAFAAUAArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUAArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArAA0AUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwAeAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAUABQAFAAUABQAAQABAAEACsABAAEACsAKwArACsAKwAEAAQABAAEAFAAUABQAFAAKwBQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArAAQABAAEACsAKwArACsABABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArAA0ADQANAA0ADQANAA0ADQAeACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAeAFAAUABQAFAAUABQAFAAUAAeAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAArACsAKwArAFAAUABQAFAAUAANAA0ADQANAA0ADQAUACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsADQANAA0ADQANAA0ADQBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArAB4AHgAeAB4AKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArAFAAUABQAFAAUABQAAQABAAEAAQAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUAArAAQABAANACsAKwBQAFAAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAAQABAAEAAQABAAEAAQABAAEAAQABABQAFAAUABQAB4AHgAeAB4AHgArACsAKwArACsAKwAEAAQABAAEAAQABAAEAA0ADQAeAB4AHgAeAB4AKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsABABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAAQABAAEAAQABAAEAAQABAAeAB4AHgANAA0ADQANACsAKwArACsAKwArACsAKwArACsAKwAeACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwArACsAKwBLAEsASwBLAEsASwBLAEsASwBLACsAKwArACsAKwArAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsASwBLAEsASwBLAEsASwBLAEsASwANAA0ADQANAFAABAAEAFAAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAeAA4AUAArACsAKwArACsAKwArACsAKwAEAFAAUABQAFAADQANAB4ADQAEAAQABAAEAB4ABAAEAEsASwBLAEsASwBLAEsASwBLAEsAUAAOAFAADQANAA0AKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQABAAEAAQABAANAA0AHgANAA0AHgAEACsAUABQAFAAUABQAFAAUAArAFAAKwBQAFAAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAA0AKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQABAAEAAQAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsABAAEAAQABAArAFAAUABQAFAAUABQAFAAUAArACsAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAUABQACsAUABQAFAAUABQACsABAAEAFAABAAEAAQABAAEAAQABAArACsABAAEACsAKwAEAAQABAArACsAUAArACsAKwArACsAKwAEACsAKwArACsAKwBQAFAAUABQAFAABAAEACsAKwAEAAQABAAEAAQABAAEACsAKwArAAQABAAEAAQABAArACsAKwArACsAKwArACsAKwArACsABAAEAAQABAAEAAQABABQAFAAUABQAA0ADQANAA0AHgBLAEsASwBLAEsASwBLAEsASwBLAA0ADQArAB4ABABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwAEAAQABAAEAFAAUAAeAFAAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAArACsABAAEAAQABAAEAAQABAAEAAQADgANAA0AEwATAB4AHgAeAA0ADQANAA0ADQANAA0ADQANAA0ADQANAA0ADQANAFAAUABQAFAABAAEACsAKwAEAA0ADQAeAFAAKwArACsAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAFAAKwArACsAKwArACsAKwBLAEsASwBLAEsASwBLAEsASwBLACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAKwArACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACsAKwArACsASwBLAEsASwBLAEsASwBLAEsASwBcAFwADQANAA0AKgBQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAeACsAKwArACsASwBLAEsASwBLAEsASwBLAEsASwBQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAKwArAFAAKwArAFAAUABQAFAAUABQAFAAUAArAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQAKwAEAAQAKwArAAQABAAEAAQAUAAEAFAABAAEAA0ADQANACsAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAArACsABAAEAAQABAAEAAQABABQAA4AUAAEACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFAABAAEAAQABAAEAAQABAAEAAQABABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAFAABAAEAAQABAAOAB4ADQANAA0ADQAOAB4ABAArACsAKwArACsAKwArACsAUAAEAAQABAAEAAQABAAEAAQABAAEAAQAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAA0ADQANAFAADgAOAA4ADQANACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEACsABAAEAAQABAAEAAQABAAEAFAADQANAA0ADQANACsAKwArACsAKwArACsAKwArACsASwBLAEsASwBLAEsASwBLAEsASwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwAOABMAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAArAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQACsAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAArACsAKwAEACsABAAEACsABAAEAAQABAAEAAQABABQAAQAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAUABQAFAAUABQAFAAKwBQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQAKwAEAAQAKwAEAAQABAAEAAQAUAArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAeAB4AKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAB4AHgAeAB4AHgAeAB4AHgAaABoAGgAaAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAKwArACsAKwArACsAKwArACsAKwArAA0AUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsADQANAA0ADQANACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAASABIAEgAQwBDAEMAUABQAFAAUABDAFAAUABQAEgAQwBIAEMAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAASABDAEMAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwAJAAkACQAJAAkACQAJABYAEQArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABIAEMAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwANAA0AKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArAAQABAAEAAQABAANACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAA0ADQANAB4AHgAeAB4AHgAeAFAAUABQAFAADQAeACsAKwArACsAKwArACsAKwArACsASwBLAEsASwBLAEsASwBLAEsASwArAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAANAA0AHgAeACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwAEAFAABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQAKwArACsAKwArACsAKwAEAAQABAAEAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAARwBHABUARwAJACsAKwArACsAKwArACsAKwArACsAKwAEAAQAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXACsAKwArACsAKwArACsAKwBXAFcAVwBXAFcAVwBXAFcAVwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAUQBRAFEAKwArACsAKwArACsAKwArACsAKwArACsAKwBRAFEAUQBRACsAKwArACsAKwArACsAKwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUAArACsAHgAEAAQADQAEAAQABAAEACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAKwArACsAKwArACsAKwArAB4AHgAeAB4AHgAeAB4AKwArAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAAQABAAEAAQABAAeAB4AHgAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAB4AHgAEAAQABAAEAAQABAAEAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4ABAAEAAQABAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4ABAAEAAQAHgArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwArACsAKwArAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAKwArACsAKwArACsAKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwBQAFAAKwArAFAAKwArAFAAUAArACsAUABQAFAAUAArAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeACsAUAArAFAAUABQAFAAUABQAFAAKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwBQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAHgAeAFAAUABQAFAAUAArAFAAKwArACsAUABQAFAAUABQAFAAUAArAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAHgBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgBQAFAAUABQAFAAUABQAFAAUABQAFAAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAB4AHgAeAB4AHgAeAB4AHgAeACsAKwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAeAB4AHgAeAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAeAB4AHgAeAB4AHgAeAB4ABAAeAB4AHgAeAB4AHgAeAB4AHgAeAAQAHgAeAA0ADQANAA0AHgArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwAEAAQABAAEAAQAKwAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAAQABAAEAAQABAAEAAQAKwAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQAKwArAAQABAAEAAQABAAEAAQAKwAEAAQAKwAEAAQABAAEAAQAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwAEAAQABAAEAAQABAAEAFAAUABQAFAAUABQAFAAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwBQAB4AKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArABsAUABQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEACsAKwArACsAKwArACsAKwArAB4AHgAeAB4ABAAEAAQABAAEAAQABABQACsAKwArACsASwBLAEsASwBLAEsASwBLAEsASwArACsAKwArABYAFgArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAGgBQAFAAUAAaAFAAUABQAFAAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAeAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwBQAFAAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAKwBQACsAKwBQACsAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAKwBQACsAUAArACsAKwArACsAKwBQACsAKwArACsAUAArAFAAKwBQACsAUABQAFAAKwBQAFAAKwBQACsAKwBQACsAUAArAFAAKwBQACsAUAArAFAAUAArAFAAKwArAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAUABQAFAAUAArAFAAUABQAFAAKwBQACsAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAUABQAFAAKwBQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwAeAB4AKwArACsAKwArACsAKwArACsAKwArACsAKwArAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8AJQAlACUAHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHgAeAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB4AHgAeACUAJQAlAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQApACkAKQApACkAKQApACkAKQApACkAKQApACkAKQApACkAKQApACkAKQApACkAKQApACkAJQAlACUAJQAlACAAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAeAB4AJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlAB4AHgAlACUAJQAlACUAHgAlACUAJQAlACUAIAAgACAAJQAlACAAJQAlACAAIAAgACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACEAIQAhACEAIQAlACUAIAAgACUAJQAgACAAIAAgACAAIAAgACAAIAAgACAAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAJQAlACUAIAAlACUAJQAlACAAIAAgACUAIAAgACAAJQAlACUAJQAlACUAJQAgACUAIAAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAHgAlAB4AJQAeACUAJQAlACUAJQAgACUAJQAlACUAHgAlAB4AHgAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlAB4AHgAeAB4AHgAeAB4AJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAeAB4AHgAeAB4AHgAeAB4AHgAeACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACAAIAAlACUAJQAlACAAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACAAJQAlACUAJQAgACAAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAHgAeAB4AHgAeAB4AHgAeACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAeAB4AHgAeAB4AHgAlACUAJQAlACUAJQAlACAAIAAgACUAJQAlACAAIAAgACAAIAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeABcAFwAXABUAFQAVAB4AHgAeAB4AJQAlACUAIAAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACAAIAAgACUAJQAlACUAJQAlACUAJQAlACAAJQAlACUAJQAlACUAJQAlACUAJQAlACAAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AJQAlACUAJQAlACUAJQAlACUAJQAlACUAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AJQAlACUAJQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeACUAJQAlACUAJQAlACUAJQAeAB4AHgAeAB4AHgAeAB4AHgAeACUAJQAlACUAJQAlAB4AHgAeAB4AHgAeAB4AHgAlACUAJQAlACUAJQAlACUAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAgACUAJQAgACUAJQAlACUAJQAlACUAJQAgACAAIAAgACAAIAAgACAAJQAlACUAJQAlACUAIAAlACUAJQAlACUAJQAlACUAJQAgACAAIAAgACAAIAAgACAAIAAgACUAJQAgACAAIAAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAgACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACAAIAAlACAAIAAlACAAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAgACAAIAAlACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAJQAlAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAKwArAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXACUAJQBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwAlACUAJQAlACUAJQAlACUAJQAlACUAVwBXACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAKwAEACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAA==",sQ=function(e){var t,n,r,o,i,s=.75*e.length,a=e.length,l=0;"="===e[e.length-1]&&(s--,"="===e[e.length-2]&&s--);var c="undefined"!=typeof ArrayBuffer&&"undefined"!=typeof Uint8Array&&void 0!==Uint8Array.prototype.slice?new ArrayBuffer(s):new Array(s),u=Array.isArray(c)?c:new Uint8Array(c);for(t=0;t<a;t+=4)n=Xj[e.charCodeAt(t)],r=Xj[e.charCodeAt(t+1)],o=Xj[e.charCodeAt(t+2)],i=Xj[e.charCodeAt(t+3)],u[l++]=n<<2|r>>4,u[l++]=(15&r)<<4|o>>2,u[l++]=(3&o)<<6|63&i;return c}(nQ),aQ=Array.isArray(sQ)?function(e){for(var t=e.length,n=[],r=0;r<t;r+=4)n.push(e[r+3]<<24|e[r+2]<<16|e[r+1]<<8|e[r]);return n}(sQ):new Uint32Array(sQ),lQ=Array.isArray(sQ)?function(e){for(var t=e.length,n=[],r=0;r<t;r+=2)n.push(e[r+1]<<8|e[r]);return n}(sQ):new Uint16Array(sQ),cQ=qj(lQ,12,aQ[4]/2),uQ=2===aQ[5]?qj(lQ,(24+aQ[4])/2):(rQ=aQ,oQ=Math.ceil((24+aQ[4])/4),rQ.slice?rQ.slice(oQ,iQ):new Uint32Array(Array.prototype.slice.call(rQ,oQ,iQ))),new Jj(aQ[0],aQ[1],aQ[2],aQ[3],cQ,uQ)),NQ=[SQ,36],jQ=[1,2,3,5],QQ=[dQ,8],zQ=[_Q,xQ],HQ=jQ.concat(QQ),GQ=[TQ,PQ,FQ,IQ,RQ],VQ=[hQ,AQ],WQ=function(e,t,n,r){var o=r[n];if(Array.isArray(e)?-1!==e.indexOf(o):e===o)for(var i=n;i<=r.length;){if((l=r[++i])===t)return!0;if(l!==dQ)break}if(o===dQ)for(i=n;i>0;){var s=r[--i];if(Array.isArray(e)?-1!==e.indexOf(s):e===s)for(var a=n;a<=r.length;){var l;if((l=r[++a])===t)return!0;if(l!==dQ)break}if(s!==dQ)break}return!1},$Q=function(e,t){for(var n=e;n>=0;){var r=t[n];if(r!==dQ)return r;n--}return 0},KQ=function(e,t,n,r,o){if(0===n[r])return UQ;var i=r-1;if(Array.isArray(o)&&!0===o[i])return UQ;var s=i-1,a=i+1,l=t[i],c=s>=0?t[s]:0,u=t[a];if(2===l&&3===u)return UQ;if(-1!==jQ.indexOf(l))return"!";if(-1!==jQ.indexOf(u))return UQ;if(-1!==QQ.indexOf(u))return UQ;if(8===$Q(i,t))return OQ;if(11===DQ.get(e[i]))return UQ;if((l===EQ||l===BQ)&&11===DQ.get(e[a]))return UQ;if(7===l||7===u)return UQ;if(9===l)return UQ;if(-1===[dQ,AQ,hQ].indexOf(l)&&9===u)return UQ;if(-1!==[pQ,fQ,gQ,bQ,CQ].indexOf(u))return UQ;if($Q(i,t)===vQ)return UQ;if(WQ(23,vQ,i,t))return UQ;if(WQ([pQ,fQ],yQ,i,t))return UQ;if(WQ(12,12,i,t))return UQ;if(l===dQ)return OQ;if(23===l||23===u)return UQ;if(16===u||16===l)return OQ;if(-1!==[AQ,hQ,yQ].indexOf(u)||14===l)return UQ;if(36===c&&-1!==VQ.indexOf(l))return UQ;if(l===CQ&&36===u)return UQ;if(u===mQ)return UQ;if(-1!==NQ.indexOf(u)&&l===wQ||-1!==NQ.indexOf(l)&&u===wQ)return UQ;if(l===_Q&&-1!==[kQ,EQ,BQ].indexOf(u)||-1!==[kQ,EQ,BQ].indexOf(l)&&u===xQ)return UQ;if(-1!==NQ.indexOf(l)&&-1!==zQ.indexOf(u)||-1!==zQ.indexOf(l)&&-1!==NQ.indexOf(u))return UQ;if(-1!==[_Q,xQ].indexOf(l)&&(u===wQ||-1!==[vQ,hQ].indexOf(u)&&t[a+1]===wQ)||-1!==[vQ,hQ].indexOf(l)&&u===wQ||l===wQ&&-1!==[wQ,CQ,bQ].indexOf(u))return UQ;if(-1!==[wQ,CQ,bQ,pQ,fQ].indexOf(u))for(var d=i;d>=0;){if((A=t[d])===wQ)return UQ;if(-1===[CQ,bQ].indexOf(A))break;d--}if(-1!==[_Q,xQ].indexOf(u))for(d=-1!==[pQ,fQ].indexOf(l)?s:i;d>=0;){var A;if((A=t[d])===wQ)return UQ;if(-1===[CQ,bQ].indexOf(A))break;d--}if(TQ===l&&-1!==[TQ,PQ,IQ,RQ].indexOf(u)||-1!==[PQ,IQ].indexOf(l)&&-1!==[PQ,FQ].indexOf(u)||-1!==[FQ,RQ].indexOf(l)&&u===FQ)return UQ;if(-1!==GQ.indexOf(l)&&-1!==[mQ,xQ].indexOf(u)||-1!==GQ.indexOf(u)&&l===_Q)return UQ;if(-1!==NQ.indexOf(l)&&-1!==NQ.indexOf(u))return UQ;if(l===bQ&&-1!==NQ.indexOf(u))return UQ;if(-1!==NQ.concat(wQ).indexOf(l)&&u===vQ&&-1===LQ.indexOf(e[a])||-1!==NQ.concat(wQ).indexOf(u)&&l===fQ)return UQ;if(41===l&&41===u){for(var h=n[i],p=1;h>0&&41===t[--h];)p++;if(p%2!=0)return UQ}return l===EQ&&u===BQ?UQ:OQ},XQ=function(e,t){t||(t={lineBreak:"normal",wordBreak:"normal"});var n=function(e,t){void 0===t&&(t="strict");var n=[],r=[],o=[];return e.forEach(function(e,i){var s=DQ.get(e);if(s>50?(o.push(!0),s-=50):o.push(!1),-1!==["normal","auto","loose"].indexOf(t)&&-1!==[8208,8211,12316,12448].indexOf(e))return r.push(i),n.push(16);if(4===s||11===s){if(0===i)return r.push(i),n.push(SQ);var a=n[i-1];return-1===HQ.indexOf(a)?(r.push(r[i-1]),n.push(a)):(r.push(i),n.push(SQ))}return r.push(i),31===s?n.push("strict"===t?yQ:kQ):s===MQ||29===s?n.push(SQ):43===s?e>=131072&&e<=196605||e>=196608&&e<=262141?n.push(kQ):n.push(SQ):void n.push(s)}),[r,n,o]}(e,t.lineBreak),r=n[0],o=n[1],i=n[2];"break-all"!==t.wordBreak&&"break-word"!==t.wordBreak||(o=o.map(function(e){return-1!==[wQ,SQ,MQ].indexOf(e)?kQ:e}));var s="keep-all"===t.wordBreak?i.map(function(t,n){return t&&e[n]>=19968&&e[n]<=40959}):void 0;return[r,o,s]},YQ=function(){function e(e,t,n,r){this.codePoints=e,this.required="!"===t,this.start=n,this.end=r}return e.prototype.slice=function(){return Gj.apply(void 0,this.codePoints.slice(this.start,this.end))},e}(),qQ=45,JQ=43,ZQ=-1,ez=function(e){return e>=48&&e<=57},tz=function(e){return ez(e)||e>=65&&e<=70||e>=97&&e<=102},nz=function(e){return 10===e||9===e||32===e},rz=function(e){return function(e){return function(e){return e>=97&&e<=122}(e)||function(e){return e>=65&&e<=90}(e)}(e)||function(e){return e>=128}(e)||95===e},oz=function(e){return rz(e)||ez(e)||e===qQ},iz=function(e){return e>=0&&e<=8||11===e||e>=14&&e<=31||127===e},sz=function(e,t){return 92===e&&10!==t},az=function(e,t,n){return e===qQ?rz(t)||sz(t,n):!!rz(e)||!(92!==e||!sz(e,t))},lz=function(e,t,n){return e===JQ||e===qQ?!!ez(t)||46===t&&ez(n):ez(46===e?t:e)},cz=function(e){var t=0,n=1;e[t]!==JQ&&e[t]!==qQ||(e[t]===qQ&&(n=-1),t++);for(var r=[];ez(e[t]);)r.push(e[t++]);var o=r.length?parseInt(Gj.apply(void 0,r),10):0;46===e[t]&&t++;for(var i=[];ez(e[t]);)i.push(e[t++]);var s=i.length,a=s?parseInt(Gj.apply(void 0,i),10):0;69!==e[t]&&101!==e[t]||t++;var l=1;e[t]!==JQ&&e[t]!==qQ||(e[t]===qQ&&(l=-1),t++);for(var c=[];ez(e[t]);)c.push(e[t++]);var u=c.length?parseInt(Gj.apply(void 0,c),10):0;return n*(o+a*Math.pow(10,-s))*Math.pow(10,l*u)},uz={type:2},dz={type:3},Az={type:4},hz={type:13},pz={type:8},fz={type:21},gz={type:9},mz={type:10},yz={type:11},vz={type:12},bz={type:14},wz={type:23},xz={type:1},_z={type:25},Cz={type:24},Sz={type:26},Ez={type:27},Bz={type:28},Iz={type:29},Rz={type:31},kz={type:32},Tz=function(){function e(){this._value=[]}return e.prototype.write=function(e){this._value=this._value.concat(Hj(e))},e.prototype.read=function(){for(var e=[],t=this.consumeToken();t!==kz;)e.push(t),t=this.consumeToken();return e},e.prototype.consumeToken=function(){var e=this.consumeCodePoint();switch(e){case 34:return this.consumeStringToken(34);case 35:var t=this.peekCodePoint(0),n=this.peekCodePoint(1),r=this.peekCodePoint(2);if(oz(t)||sz(n,r)){var o=az(t,n,r)?2:1;return{type:5,value:this.consumeName(),flags:o}}break;case 36:if(61===this.peekCodePoint(0))return this.consumeCodePoint(),hz;break;case 39:return this.consumeStringToken(39);case 40:return uz;case 41:return dz;case 42:if(61===this.peekCodePoint(0))return this.consumeCodePoint(),bz;break;case JQ:if(lz(e,this.peekCodePoint(0),this.peekCodePoint(1)))return this.reconsumeCodePoint(e),this.consumeNumericToken();break;case 44:return Az;case qQ:var i=e,s=this.peekCodePoint(0),a=this.peekCodePoint(1);if(lz(i,s,a))return this.reconsumeCodePoint(e),this.consumeNumericToken();if(az(i,s,a))return this.reconsumeCodePoint(e),this.consumeIdentLikeToken();if(s===qQ&&62===a)return this.consumeCodePoint(),this.consumeCodePoint(),Cz;break;case 46:if(lz(e,this.peekCodePoint(0),this.peekCodePoint(1)))return this.reconsumeCodePoint(e),this.consumeNumericToken();break;case 47:if(42===this.peekCodePoint(0))for(this.consumeCodePoint();;){var l=this.consumeCodePoint();if(42===l&&47===(l=this.consumeCodePoint()))return this.consumeToken();if(l===ZQ)return this.consumeToken()}break;case 58:return Sz;case 59:return Ez;case 60:if(33===this.peekCodePoint(0)&&this.peekCodePoint(1)===qQ&&this.peekCodePoint(2)===qQ)return this.consumeCodePoint(),this.consumeCodePoint(),_z;break;case 64:var c=this.peekCodePoint(0),u=this.peekCodePoint(1),d=this.peekCodePoint(2);if(az(c,u,d))return{type:7,value:this.consumeName()};break;case 91:return Bz;case 92:if(sz(e,this.peekCodePoint(0)))return this.reconsumeCodePoint(e),this.consumeIdentLikeToken();break;case 93:return Iz;case 61:if(61===this.peekCodePoint(0))return this.consumeCodePoint(),pz;break;case 123:return yz;case 125:return vz;case 117:case 85:var A=this.peekCodePoint(0),h=this.peekCodePoint(1);return A!==JQ||!tz(h)&&63!==h||(this.consumeCodePoint(),this.consumeUnicodeRangeToken()),this.reconsumeCodePoint(e),this.consumeIdentLikeToken();case 124:if(61===this.peekCodePoint(0))return this.consumeCodePoint(),gz;if(124===this.peekCodePoint(0))return this.consumeCodePoint(),fz;break;case 126:if(61===this.peekCodePoint(0))return this.consumeCodePoint(),mz;break;case ZQ:return kz}return nz(e)?(this.consumeWhiteSpace(),Rz):ez(e)?(this.reconsumeCodePoint(e),this.consumeNumericToken()):rz(e)?(this.reconsumeCodePoint(e),this.consumeIdentLikeToken()):{type:6,value:Gj(e)}},e.prototype.consumeCodePoint=function(){var e=this._value.shift();return void 0===e?-1:e},e.prototype.reconsumeCodePoint=function(e){this._value.unshift(e)},e.prototype.peekCodePoint=function(e){return e>=this._value.length?-1:this._value[e]},e.prototype.consumeUnicodeRangeToken=function(){for(var e=[],t=this.consumeCodePoint();tz(t)&&e.length<6;)e.push(t),t=this.consumeCodePoint();for(var n=!1;63===t&&e.length<6;)e.push(t),t=this.consumeCodePoint(),n=!0;if(n)return{type:30,start:parseInt(Gj.apply(void 0,e.map(function(e){return 63===e?48:e})),16),end:parseInt(Gj.apply(void 0,e.map(function(e){return 63===e?70:e})),16)};var r=parseInt(Gj.apply(void 0,e),16);if(this.peekCodePoint(0)===qQ&&tz(this.peekCodePoint(1))){this.consumeCodePoint(),t=this.consumeCodePoint();for(var o=[];tz(t)&&o.length<6;)o.push(t),t=this.consumeCodePoint();return{type:30,start:r,end:parseInt(Gj.apply(void 0,o),16)}}return{type:30,start:r,end:r}},e.prototype.consumeIdentLikeToken=function(){var e=this.consumeName();return"url"===e.toLowerCase()&&40===this.peekCodePoint(0)?(this.consumeCodePoint(),this.consumeUrlToken()):40===this.peekCodePoint(0)?(this.consumeCodePoint(),{type:19,value:e}):{type:20,value:e}},e.prototype.consumeUrlToken=function(){var e=[];if(this.consumeWhiteSpace(),this.peekCodePoint(0)===ZQ)return{type:22,value:""};var t=this.peekCodePoint(0);if(39===t||34===t){var n=this.consumeStringToken(this.consumeCodePoint());return 0===n.type&&(this.consumeWhiteSpace(),this.peekCodePoint(0)===ZQ||41===this.peekCodePoint(0))?(this.consumeCodePoint(),{type:22,value:n.value}):(this.consumeBadUrlRemnants(),wz)}for(;;){var r=this.consumeCodePoint();if(r===ZQ||41===r)return{type:22,value:Gj.apply(void 0,e)};if(nz(r))return this.consumeWhiteSpace(),this.peekCodePoint(0)===ZQ||41===this.peekCodePoint(0)?(this.consumeCodePoint(),{type:22,value:Gj.apply(void 0,e)}):(this.consumeBadUrlRemnants(),wz);if(34===r||39===r||40===r||iz(r))return this.consumeBadUrlRemnants(),wz;if(92===r){if(!sz(r,this.peekCodePoint(0)))return this.consumeBadUrlRemnants(),wz;e.push(this.consumeEscapedCodePoint())}else e.push(r)}},e.prototype.consumeWhiteSpace=function(){for(;nz(this.peekCodePoint(0));)this.consumeCodePoint()},e.prototype.consumeBadUrlRemnants=function(){for(;;){var e=this.consumeCodePoint();if(41===e||e===ZQ)return;sz(e,this.peekCodePoint(0))&&this.consumeEscapedCodePoint()}},e.prototype.consumeStringSlice=function(e){for(var t="";e>0;){var n=Math.min(5e4,e);t+=Gj.apply(void 0,this._value.splice(0,n)),e-=n}return this._value.shift(),t},e.prototype.consumeStringToken=function(e){for(var t="",n=0;;){var r=this._value[n];if(r===ZQ||void 0===r||r===e)return{type:0,value:t+=this.consumeStringSlice(n)};if(10===r)return this._value.splice(0,n),xz;if(92===r){var o=this._value[n+1];o!==ZQ&&void 0!==o&&(10===o?(t+=this.consumeStringSlice(n),n=-1,this._value.shift()):sz(r,o)&&(t+=this.consumeStringSlice(n),t+=Gj(this.consumeEscapedCodePoint()),n=-1))}n++}},e.prototype.consumeNumber=function(){var e=[],t=4,n=this.peekCodePoint(0);for(n!==JQ&&n!==qQ||e.push(this.consumeCodePoint());ez(this.peekCodePoint(0));)e.push(this.consumeCodePoint());n=this.peekCodePoint(0);var r=this.peekCodePoint(1);if(46===n&&ez(r))for(e.push(this.consumeCodePoint(),this.consumeCodePoint()),t=8;ez(this.peekCodePoint(0));)e.push(this.consumeCodePoint());n=this.peekCodePoint(0),r=this.peekCodePoint(1);var o=this.peekCodePoint(2);if((69===n||101===n)&&((r===JQ||r===qQ)&&ez(o)||ez(r)))for(e.push(this.consumeCodePoint(),this.consumeCodePoint()),t=8;ez(this.peekCodePoint(0));)e.push(this.consumeCodePoint());return[cz(e),t]},e.prototype.consumeNumericToken=function(){var e=this.consumeNumber(),t=e[0],n=e[1],r=this.peekCodePoint(0),o=this.peekCodePoint(1),i=this.peekCodePoint(2);return az(r,o,i)?{type:15,number:t,flags:n,unit:this.consumeName()}:37===r?(this.consumeCodePoint(),{type:16,number:t,flags:n}):{type:17,number:t,flags:n}},e.prototype.consumeEscapedCodePoint=function(){var e=this.consumeCodePoint();if(tz(e)){for(var t=Gj(e);tz(this.peekCodePoint(0))&&t.length<6;)t+=Gj(this.consumeCodePoint());nz(this.peekCodePoint(0))&&this.consumeCodePoint();var n=parseInt(t,16);return 0===n||function(e){return e>=55296&&e<=57343}(n)||n>1114111?65533:n}return e===ZQ?65533:e},e.prototype.consumeName=function(){for(var e="";;){var t=this.consumeCodePoint();if(oz(t))e+=Gj(t);else{if(!sz(t,this.peekCodePoint(0)))return this.reconsumeCodePoint(t),e;e+=Gj(this.consumeEscapedCodePoint())}}},e}(),Pz=function(){function e(e){this._tokens=e}return e.create=function(t){var n=new Tz;return n.write(t),new e(n.read())},e.parseValue=function(t){return e.create(t).parseComponentValue()},e.parseValues=function(t){return e.create(t).parseComponentValues()},e.prototype.parseComponentValue=function(){for(var e=this.consumeToken();31===e.type;)e=this.consumeToken();if(32===e.type)throw new SyntaxError("Error parsing CSS component value, unexpected EOF");this.reconsumeToken(e);var t=this.consumeComponentValue();do{e=this.consumeToken()}while(31===e.type);if(32===e.type)return t;throw new SyntaxError("Error parsing CSS component value, multiple values found when expecting only one")},e.prototype.parseComponentValues=function(){for(var e=[];;){var t=this.consumeComponentValue();if(32===t.type)return e;e.push(t),e.push()}},e.prototype.consumeComponentValue=function(){var e=this.consumeToken();switch(e.type){case 11:case 28:case 2:return this.consumeSimpleBlock(e.type);case 19:return this.consumeFunction(e)}return e},e.prototype.consumeSimpleBlock=function(e){for(var t={type:e,values:[]},n=this.consumeToken();;){if(32===n.type||Qz(n,e))return t;this.reconsumeToken(n),t.values.push(this.consumeComponentValue()),n=this.consumeToken()}},e.prototype.consumeFunction=function(e){for(var t={name:e.value,values:[],type:18};;){var n=this.consumeToken();if(32===n.type||3===n.type)return t;this.reconsumeToken(n),t.values.push(this.consumeComponentValue())}},e.prototype.consumeToken=function(){var e=this._tokens.shift();return void 0===e?kz:e},e.prototype.reconsumeToken=function(e){this._tokens.unshift(e)},e}(),Fz=function(e){return 15===e.type},Mz=function(e){return 17===e.type},Lz=function(e){return 20===e.type},Uz=function(e){return 0===e.type},Oz=function(e,t){return Lz(e)&&e.value===t},Dz=function(e){return 31!==e.type},Nz=function(e){return 31!==e.type&&4!==e.type},jz=function(e){var t=[],n=[];return e.forEach(function(e){if(4===e.type){if(0===n.length)throw new Error("Error parsing function args, zero tokens for arg");return t.push(n),void(n=[])}31!==e.type&&n.push(e)}),n.length&&t.push(n),t},Qz=function(e,t){return 11===t&&12===e.type||(28===t&&29===e.type||2===t&&3===e.type)},zz=function(e){return 17===e.type||15===e.type},Hz=function(e){return 16===e.type||zz(e)},Gz=function(e){return e.length>1?[e[0],e[1]]:[e[0]]},Vz={type:17,number:0,flags:4},Wz={type:16,number:50,flags:4},$z={type:16,number:100,flags:4},Kz=function(e,t,n){var r=e[0],o=e[1];return[Xz(r,t),Xz(void 0!==o?o:r,n)]},Xz=function(e,t){if(16===e.type)return e.number/100*t;if(Fz(e))switch(e.unit){case"rem":case"em":return 16*e.number;default:return e.number}return e.number},Yz="grad",qz="turn",Jz=function(e,t){if(15===t.type)switch(t.unit){case"deg":return Math.PI*t.number/180;case Yz:return Math.PI/200*t.number;case"rad":return t.number;case qz:return 2*Math.PI*t.number}throw new Error("Unsupported angle type")},Zz=function(e){return 15===e.type&&("deg"===e.unit||e.unit===Yz||"rad"===e.unit||e.unit===qz)},eH=function(e){switch(e.filter(Lz).map(function(e){return e.value}).join(" ")){case"to bottom right":case"to right bottom":case"left top":case"top left":return[Vz,Vz];case"to top":case"bottom":return tH(0);case"to bottom left":case"to left bottom":case"right top":case"top right":return[Vz,$z];case"to right":case"left":return tH(90);case"to top left":case"to left top":case"right bottom":case"bottom right":return[$z,$z];case"to bottom":case"top":return tH(180);case"to top right":case"to right top":case"left bottom":case"bottom left":return[$z,Vz];case"to left":case"right":return tH(270)}return 0},tH=function(e){return Math.PI*e/180},nH=function(e){return!(255&e)},rH=function(e){var t=255&e,n=255&e>>8,r=255&e>>16,o=255&e>>24;return t<255?"rgba(".concat(o,",").concat(r,",").concat(n,",").concat(t/255,")"):"rgb(".concat(o,",").concat(r,",").concat(n,")")},oH=function(e,t,n,r){return(e<<24|t<<16|n<<8|Math.round(255*r))>>>0},iH=function(e,t){if(17===e.type)return e.number;if(16===e.type){var n=3===t?1:255;return 3===t?e.number/100*n:Math.round(e.number/100*n)}return 0},sH=function(e){return"from"===(20===e[0].type?e[0].value:"unknown")},aH=function(e,t,n){return Math.min(Math.max(e,t),n)},lH=function(e,t){return[e[0]*t[0]+e[1]*t[1]+e[2]*t[2],e[3]*t[0]+e[4]*t[1]+e[5]*t[2],e[6]*t[0]+e[7]*t[1]+e[8]*t[2]]},cH=function(e){var t=e[0],n=e[1],r=e[2],o=e[3],i=BH([t,n,r]);return oH(aH(Math.round(255*i[0]),0,255),aH(Math.round(255*i[1]),0,255),aH(Math.round(255*i[2]),0,255),o)},uH=function(e){var t=SH([e[0],e[1],e[2]]);return cH([t[0],t[1],t[2],e[3]])},dH=function(e,t){var n=t.filter(Nz),r=n[0],o=n[1],i=n[2],s=n[3];return[(17===r.type?tH(r.number):Jz(e,r))/(2*Math.PI),Hz(o)?o.number/100:0,Hz(i)?i.number/100:0,void 0!==s&&Hz(s)?Xz(s,1):1]},AH=function(e,t){if(sH(t))throw new Error("Relative color not supported for hsl()");var n=dH(e,t),r=n[0],o=n[1],i=n[2],s=n[3],a=vH([r,o,i]);return oH(255*a[0],255*a[1],255*a[2],0===o?1:s)},hH=function(e){var t=e.filter(Nz);return[Hz(t[0])?t[0].number:0,Hz(t[1])?t[1].number:0,Mz(t[2])||Fz(t[2])?t[2].number:0,void 0!==t[4]&&Hz(t[4])?Xz(t[4],1):1]},pH=function(e){var t=e.filter(Nz);return[16===t[0].type?t[0].number/100:Mz(t[0])?t[0].number:0,16===t[1].type?t[1].number/100:Mz(t[1])?t[1].number:0,Mz(t[2])||Fz(t[2])?t[2].number:0,void 0!==t[4]&&Hz(t[4])?Xz(t[4],1):1]},fH=function(e){var t=e.filter(Nz);return[16===t[0].type?t[0].number/100:Mz(t[0])?t[0].number:0,16===t[1].type?t[1].number/100:Mz(t[1])?t[1].number:0,Mz(t[2])||Fz(t[2])?t[2].number:0,void 0!==t[4]&&Hz(t[4])?Xz(t[4],1):1]},gH=function(e){return lH([1.0479297925449969,.022946870601609652,-.05019226628920524,.02962780877005599,.9904344267538799,-.017073799063418826,-.009243040646204504,.015055191490298152,.7518742814281371],e)},mH=function(e){return lH([.955473421488075,-.02309845494876471,.06325924320057072,-.0283697093338637,1.0099953980813041,.021041441191917323,.012314014864481998,-.020507649298898964,1.330365926242124],e)},yH=function(e,t,n){return n<0&&(n+=1),n>=1&&(n-=1),n<1/6?(t-e)*n*6+e:n<.5?t:n<2/3?6*(t-e)*(2/3-n)+e:e},vH=function(e){var t=e[0],n=e[1],r=e[2];if(0===n)return[255*r,255*r,255*r];var o=r<=.5?r*(n+1):r+n-r*n,i=2*r-o;return[yH(i,o,t+1/3),yH(i,o,t),yH(i,o,t-1/3)]},bH=function(e){var t=e[0],n=e[1],r=e[2];return n<0&&(n=0),isNaN(r)&&(r=0),[t,n*Math.cos(r*Math.PI/180),n*Math.sin(r*Math.PI/180)]},wH=function(e){var t=lH([1,.3963377773761749,.2158037573099136,1,-.1055613458156586,-.0638541728258133,1,-.0894841775298119,-1.2914855480194092],e).map(function(e){return Math.pow(e,3)});return lH([1.2268798758459243,-.5578149944602171,.2813910456659647,-.0405757452148008,1.112286803280317,-.0717110580655164,-.0763729366746601,-.4214933324022432,1.5869240198367816],t)},xH=function(e){var t=(e[0]+16)/116,n=e[1]/500+t,r=t-e[2]/200,o=24389/27,i=24/116,s=[.3457*(n>i?Math.pow(n,3):(116*n-16)/o)/.3585,e[0]>8?Math.pow(t,3):e[0]/o,.2958*(r>i?Math.pow(r,3):(116*r-16)/o)/.3585];return mH([s[0],s[1],s[2]])},_H=function(e){return e},CH=function(e){return uH([e[0],e[1],e[2],e[3]])},SH=function(e){return lH([3.2409699419045226,-1.537383177570094,-.4986107602930034,-.9692436362808796,1.8759675015077202,.04155505740717559,.05563007969699366,-.20397695888897652,1.0569715142428786],e)},EH=function(e){return lH([.41239079926595934,.357584339383878,.1804807884018343,.21263900587151027,.715168678767756,.07219231536073371,.01933081871559182,.11919477979462598,.9505321522496607],e)},BH=function(e){return e.map(function(e){var t=e<0?-1:1,n=Math.abs(e);return n>.0031308?t*(1.055*Math.pow(n,1/2.4)-.055):12.92*e})},IH=function(e){return e.map(function(e){var t=e<0?-1:1,n=Math.abs(e);return n<=.04045?e/12.92:t*Math.pow((n+.055)/1.055,2.4)})},RH=function(e){var t,n=[e[0],e[1],e[2]].map(function(e){var t=e<0?-1:1;return e*t<=.04045?e/12.92:t*Math.pow((e+.055)/1.055,2.4)||0});return t=[n[0],n[1],n[2]],lH([.4865709486482162,.26566769316909306,.1982172852343625,.2289745640697488,.6917385218365064,.079286914093745,0,.04511338185890264,1.043944368900976],t)},kH=function(e){var t=[e[0],e[1],e[2]].map(function(e){return e<16/512?e/16:Math.pow(e,1.8)});return mH(function(e){return lH([.7977666449006423,.13518129740053308,.0313477341283922,.2880748288194013,.711835234241873,8993693872564e-17,0,0,.8251046025104602],e)}([t[0],t[1],t[2]]))},TH=1.09929682680944,PH=.018053968510807,FH=function(e){var t,n=[e[0],e[1],e[2]].map(function(e){return e<4.5*PH?e/4.5:Math.pow((e+TH-1)/TH,1/.45)});return t=[n[0],n[1],n[2]],lH([.6369580483012914,.14461690358620832,.1688809751641721,.2627002120112671,.6779980715188708,.05930171646986196,0,.028072693049087428,1.060985057710791],t)},MH=function(e,t){if(18===t.type){var n=jH[t.name];if(void 0===n)throw new Error('Attempting to parse an unsupported color function "'.concat(t.name,'"'));return n(e,t.values)}if(5===t.type){var r=LH(t),o=r[0],i=r[1],s=r[2],a=r[3];return oH(o,i,s,a)}if(20===t.type){var l=zH[t.value.toUpperCase()];if(void 0!==l)return l}return zH.TRANSPARENT},LH=function(e){if(3===e.value.length){var t=e.value.substring(0,1),n=e.value.substring(1,2),r=e.value.substring(2,3);return[parseInt(t+t,16),parseInt(n+n,16),parseInt(r+r,16),1]}if(4===e.value.length){t=e.value.substring(0,1),n=e.value.substring(1,2),r=e.value.substring(2,3);var o=e.value.substring(3,4);return[parseInt(t+t,16),parseInt(n+n,16),parseInt(r+r,16),parseInt(o+o,16)/255]}if(6===e.value.length){t=e.value.substring(0,2),n=e.value.substring(2,4),r=e.value.substring(4,6);return[parseInt(t,16),parseInt(n,16),parseInt(r,16),1]}if(8===e.value.length){t=e.value.substring(0,2),n=e.value.substring(2,4),r=e.value.substring(4,6),o=e.value.substring(6,8);return[parseInt(t,16),parseInt(n,16),parseInt(r,16),parseInt(o,16)/255]}return[0,0,0,1]},UH=function(e,t){var n=t.filter(Nz);if(sH(n))throw new Error("Relative color not supported for rgb()");if(3===n.length){var r=n.map(iH),o=r[0],i=r[1],s=r[2];return oH(o,i,s,1)}if(4===n.length){var a=n.map(iH),l=(o=a[0],i=a[1],s=a[2],a[3]);return oH(o,i,s,l)}return 0},OH={srgb:function(e){return oH(aH(Math.round(255*e[0]),0,255),aH(Math.round(255*e[1]),0,255),aH(Math.round(255*e[2]),0,255),aH(e[3],0,1))},"srgb-linear":cH,"display-p3":function(e){var t=RH([e[0],e[1],e[2]]);return uH([t[0],t[1],t[2],e[3]])},"a98-rgb":function(e){var t,n,r,o=SH((n=[e[0],e[1],e[2]],r=n.map(function(e){var t=e<0?-1:1,n=Math.abs(e);return t*Math.pow(n,563/256)}),t=[r[0],r[1],r[2]],lH([.5766690429101305,.1855582379065463,.1882286462349947,.29734497525053605,.6273635662554661,.0752914584939978,.02703136138641234,.07068885253582723,.9913375368376388],t)));return cH([o[0],o[1],o[2],e[3]])},"prophoto-rgb":function(e){var t=kH([e[0],e[1],e[2]]);return uH([t[0],t[1],t[2],e[3]])},xyz:CH,"xyz-d50":function(e){var t=function(e){return mH([e[0],e[1],e[2]])}([e[0],e[1],e[2]]);return uH([t[0],t[1],t[2],e[3]])},"xyz-d65":CH,rec2020:function(e){var t=FH([e[0],e[1],e[2]]);return uH([t[0],t[1],t[2],e[3]])}},DH={rgb:function(e,t){var n=t.filter(Nz);if(3===n.length){var r=n.map(iH),o=r[0],i=r[1],s=r[2],a=IH([o/255,i/255,s/255]),l=EH([a[0],a[1],a[2]]);return[l[0],l[1],l[2],1]}if(4===n.length){var c=n.map(iH),u=(o=c[0],i=c[1],s=c[2],c[3]),d=(a=IH([o/255,i/255,s/255]),EH([a[0],a[1],a[2]]));return[d[0],d[1],d[2],u]}return[0,0,0,1]},hsl:function(e,t){var n=dH(e,t),r=n[0],o=n[1],i=n[2],s=n[3],a=IH(vH([r,o,i])),l=EH([a[0],a[1],a[2]]);return[l[0],l[1],l[2],s]},lab:function(e,t){var n=pH(t),r=n[0],o=n[1],i=n[2],s=n[3],a=xH([r,o,i]);return[a[0],a[1],a[2],s]},lch:function(e,t){var n=hH(t),r=n[0],o=n[1],i=n[2],s=n[3],a=xH(bH([r,o,i]));return[a[0],a[1],a[2],s]},oklab:function(e,t){var n=pH(t),r=n[0],o=n[1],i=n[2],s=n[3],a=wH([r,o,i]);return[a[0],a[1],a[2],s]},oklch:function(e,t){var n=fH(t),r=n[0],o=n[1],i=n[2],s=n[3],a=wH(bH([r,o,i]));return[a[0],a[1],a[2],s]}},NH={srgb:function(e){var t=BH(SH([e[0],e[1],e[2]]));return[t[0],t[1],t[2],e[3]]},"srgb-linear":function(e){var t=SH([e[0],e[1],e[2]]),n=t[0],r=t[1],o=t[2];return[aH(Math.round(255*n),0,255),aH(Math.round(255*r),0,255),aH(Math.round(255*o),0,255),e[3]]},"display-p3":function(e){var t,n,r=(n=[e[0],e[1],e[2]],t=lH([2.493496911941425,-.9313836179191239,-.40271078445071684,-.8294889695615747,1.7626640603183463,.023624685841943577,.03584583024378447,-.07617238926804182,.9568845240076872],n),BH(t));return[r[0],r[1],r[2],e[3]]},"a98-rgb":function(e){var t,n,r,o=(r=[e[0],e[1],e[2]],t=lH([2.0415879038107465,-.5650069742788596,-.34473135077832956,-.9692436362808795,1.8759675015077202,.04155505740717557,.013444280632031142,-.11836239223101838,1.0151749943912054],r),[(n=t.map(function(e){var t=e<0?-1:1,n=Math.abs(e);return t*Math.pow(n,256/563)}))[0],n[1],n[2]]);return[o[0],o[1],o[2],e[3]]},"prophoto-rgb":function(e){var t,n=(t=gH([e[0],e[1],e[2]]),lH([1.3457868816471583,-.25557208737979464,-.05110186497554526,-.5446307051249019,1.5082477428451468,.02052744743642139,0,0,1.2119675456389452],t).map(function(e){return e>1/512?Math.pow(e,1/1.8):16*e}));return[n[0],n[1],n[2],e[3]]},xyz:_H,"xyz-d50":function(e){var t=gH([e[0],e[2],e[3]]);return[t[0],t[1],t[2],e[3]]},"xyz-d65":_H,rec2020:function(e){var t,n=(t=[e[0],e[1],e[2]],lH([1.716651187971268,-.355670783776392,-.25336628137366,-.666684351832489,1.616481236634939,.0157685458139111,.017639857445311,-.042770613257809,.942103121235474],t).map(function(e){return e>=PH?TH*Math.pow(e,.45)-(TH-1):4.5*e}));return[n[0],n[1],n[2],e[3]]}},jH={hsl:AH,hsla:AH,rgb:UH,rgba:UH,lch:function(e,t){if(sH(t.filter(Nz)))throw new Error("Relative color not supported for lch()");var n=hH(t),r=n[0],o=n[1],i=n[2],s=n[3],a=BH(SH(xH(bH([r,o,i]))));return oH(aH(Math.round(255*a[0]),0,255),aH(Math.round(255*a[1]),0,255),aH(Math.round(255*a[2]),0,255),s)},oklch:function(e,t){if(sH(t.filter(Nz)))throw new Error("Relative color not supported for oklch()");var n=fH(t),r=n[0],o=n[1],i=n[2],s=n[3],a=BH(SH(wH(bH([r,o,i]))));return oH(aH(Math.round(255*a[0]),0,255),aH(Math.round(255*a[1]),0,255),aH(Math.round(255*a[2]),0,255),s)},oklab:function(e,t){if(sH(t.filter(Nz)))throw new Error("Relative color not supported for oklab()");var n=pH(t),r=n[0],o=n[1],i=n[2],s=n[3],a=BH(SH(wH([r,o,i])));return oH(aH(Math.round(255*a[0]),0,255),aH(Math.round(255*a[1]),0,255),aH(Math.round(255*a[2]),0,255),s)},lab:function(e,t){if(sH(t.filter(Nz)))throw new Error("Relative color not supported for lab()");var n=pH(t),r=n[0],o=n[1],i=n[2],s=n[3],a=BH(SH(xH([r,o,i])));return oH(aH(Math.round(255*a[0]),0,255),aH(Math.round(255*a[1]),0,255),aH(Math.round(255*a[2]),0,255),s)},color:function(e,t){var n=t.filter(Nz),r=20===n[0].type?n[0].value:"unknown";if(!sH(n)){var o=r,i=OH[o];if(void 0===i)throw new Error('Attempting to parse an unsupported color space "'.concat(o,'" for color() function'));return i([m=Mz(n[1])?n[1].number:0,y=Mz(n[2])?n[2].number:0,v=Mz(n[3])?n[3].number:0,b=n.length>4&&6===n[4].type&&"/"===n[4].value&&Mz(n[5])?n[5].number:1])}var s=function(e,t){if(Mz(t))return t.number;var n;if(Lz(t))return e["r"===(n=t.value)||"x"===n?0:"g"===n||"y"===n?1:2];var r=function(e){for(var t="(",n=0,o=e.filter(Nz);n<o.length;n++){var i=o[n];t+=18===i.type&&"calc"===i.name?r(i.values):Mz(i)?i.number:6===i.type||Lz(i)?i.value:""}return t+=")"};if(18===t.type){var o=t.values.filter(Nz);if("calc"===t.name){var i=r(o).replace(/r|x/,e[0].toString()).replace(/g|y/,e[1].toString()).replace(/b|z/,e[2].toString());return new Function("return "+i)()}}return null},a=18===n[1].type?n[1].name:Lz(n[1])||5===n[1].type?"rgb":"unknown",l=Lz(n[2])?n[2].value:"unknown",c=18===n[1].type?n[1].values:Lz(n[1])?[n[1]]:[];if(Lz(n[1])){if(void 0===zH[n[1].value.toUpperCase()])throw new Error("Attempting to use unknown color in relative color 'from'");var u=QH(e,n[1].value);c=[{type:17,number:255&u>>24,flags:1},{type:17,number:255&u>>16,flags:1},{type:17,number:255&u>>8,flags:1},{type:17,number:(d=255&u)>1?d/255:d,flags:1}]}else if(5===n[1].type){var d,A=LH(n[1]);c=[{type:17,number:A[0],flags:1},{type:17,number:A[1],flags:1},{type:17,number:A[2],flags:1},{type:17,number:(d=A[3])>1?d/255:d,flags:1}]}if(0===c.length)throw new Error("Attempting to use unknown color in relative color 'from'");if("unknown"===l)throw new Error("Attempting to use unknown colorspace in relative color 'to'");var h=DH[a],p=NH[l],f=OH[l];if(void 0===h)throw new Error('Attempting to parse an unsupported color space "'.concat(a,'" for color() function'));if(void 0===p)throw new Error('Attempting to parse an unsupported color space "'.concat(l,'" for color() function'));var g=p(h(e,c)),m=s(g,n[3]),y=s(g,n[4]),v=s(g,n[5]),b=n.length>6&&6===n[6].type&&"/"===n[6].value&&Mz(n[7])?n[7].number:1;if(null===m||null===y||null===v)throw new Error("Invalid relative color in color() function");return f([m,y,v,b])}},QH=function(e,t){return MH(e,Pz.create(t).parseComponentValue())},zH={ALICEBLUE:4042850303,ANTIQUEWHITE:4209760255,AQUA:16777215,AQUAMARINE:2147472639,AZURE:4043309055,BEIGE:4126530815,BISQUE:4293182719,BLACK:255,BLANCHEDALMOND:4293643775,BLUE:65535,BLUEVIOLET:2318131967,BROWN:2771004159,BURLYWOOD:3736635391,CADETBLUE:1604231423,CHARTREUSE:2147418367,CHOCOLATE:3530104575,CORAL:4286533887,CORNFLOWERBLUE:1687547391,CORNSILK:4294499583,CRIMSON:3692313855,CYAN:16777215,DARKBLUE:35839,DARKCYAN:9145343,DARKGOLDENROD:3095837695,DARKGRAY:2846468607,DARKGREEN:6553855,DARKGREY:2846468607,DARKKHAKI:3182914559,DARKMAGENTA:2332068863,DARKOLIVEGREEN:1433087999,DARKORANGE:4287365375,DARKORCHID:2570243327,DARKRED:2332033279,DARKSALMON:3918953215,DARKSEAGREEN:2411499519,DARKSLATEBLUE:1211993087,DARKSLATEGRAY:793726975,DARKSLATEGREY:793726975,DARKTURQUOISE:13554175,DARKVIOLET:2483082239,DEEPPINK:4279538687,DEEPSKYBLUE:12582911,DIMGRAY:1768516095,DIMGREY:1768516095,DODGERBLUE:512819199,FIREBRICK:2988581631,FLORALWHITE:4294635775,FORESTGREEN:579543807,FUCHSIA:4278255615,GAINSBORO:3705462015,GHOSTWHITE:4177068031,GOLD:4292280575,GOLDENROD:3668254975,GRAY:2155905279,GREEN:8388863,GREENYELLOW:2919182335,GREY:2155905279,HONEYDEW:4043305215,HOTPINK:4285117695,INDIANRED:3445382399,INDIGO:1258324735,IVORY:4294963455,KHAKI:4041641215,LAVENDER:3873897215,LAVENDERBLUSH:4293981695,LAWNGREEN:2096890111,LEMONCHIFFON:4294626815,LIGHTBLUE:2916673279,LIGHTCORAL:4034953471,LIGHTCYAN:3774873599,LIGHTGOLDENRODYELLOW:4210742015,LIGHTGRAY:3553874943,LIGHTGREEN:2431553791,LIGHTGREY:3553874943,LIGHTPINK:4290167295,LIGHTSALMON:4288707327,LIGHTSEAGREEN:548580095,LIGHTSKYBLUE:2278488831,LIGHTSLATEGRAY:2005441023,LIGHTSLATEGREY:2005441023,LIGHTSTEELBLUE:2965692159,LIGHTYELLOW:4294959359,LIME:16711935,LIMEGREEN:852308735,LINEN:4210091775,MAGENTA:4278255615,MAROON:2147483903,MEDIUMAQUAMARINE:1724754687,MEDIUMBLUE:52735,MEDIUMORCHID:3126187007,MEDIUMPURPLE:2473647103,MEDIUMSEAGREEN:1018393087,MEDIUMSLATEBLUE:2070474495,MEDIUMSPRINGGREEN:16423679,MEDIUMTURQUOISE:1221709055,MEDIUMVIOLETRED:3340076543,MIDNIGHTBLUE:421097727,MINTCREAM:4127193855,MISTYROSE:4293190143,MOCCASIN:4293178879,NAVAJOWHITE:4292783615,NAVY:33023,OLDLACE:4260751103,OLIVE:2155872511,OLIVEDRAB:1804477439,ORANGE:4289003775,ORANGERED:4282712319,ORCHID:3664828159,PALEGOLDENROD:4008225535,PALEGREEN:2566625535,PALETURQUOISE:2951671551,PALEVIOLETRED:3681588223,PAPAYAWHIP:4293907967,PEACHPUFF:4292524543,PERU:3448061951,PINK:4290825215,PLUM:3718307327,POWDERBLUE:2967529215,PURPLE:2147516671,REBECCAPURPLE:1714657791,RED:4278190335,ROSYBROWN:3163525119,ROYALBLUE:1097458175,SADDLEBROWN:2336560127,SALMON:4202722047,SANDYBROWN:4104413439,SEAGREEN:780883967,SEASHELL:4294307583,SIENNA:2689740287,SILVER:3233857791,SKYBLUE:2278484991,SLATEBLUE:1784335871,SLATEGRAY:1887473919,SLATEGREY:1887473919,SNOW:4294638335,SPRINGGREEN:16744447,STEELBLUE:1182971135,TAN:3535047935,TEAL:8421631,THISTLE:3636451583,TOMATO:4284696575,TRANSPARENT:0,TURQUOISE:1088475391,VIOLET:4001558271,WHEAT:4125012991,WHITE:4294967295,WHITESMOKE:4126537215,YELLOW:4294902015,YELLOWGREEN:2597139199},HH={name:"background-clip",initialValue:"border-box",prefix:!1,type:1,parse:function(e,t){return t.map(function(e){if(Lz(e))switch(e.value){case"padding-box":return 1;case"content-box":return 2}return 0})}},GH={name:"background-color",initialValue:"transparent",prefix:!1,type:3,format:"color"},VH=function(e,t){var n=MH(e,t[0]),r=t[1];return r&&Hz(r)?{color:n,stop:r}:{color:n,stop:null}},WH=function(e,t){var n=e[0],r=e[e.length-1];null===n.stop&&(n.stop=Vz),null===r.stop&&(r.stop=$z);for(var o=[],i=0,s=0;s<e.length;s++){var a=e[s].stop;if(null!==a){var l=Xz(a,t);l>i?o.push(l):o.push(i),i=l}else o.push(null)}var c=null;for(s=0;s<o.length;s++){var u=o[s];if(null===u)null===c&&(c=s);else if(null!==c){for(var d=s-c,A=(u-o[c-1])/(d+1),h=1;h<=d;h++)o[c+h-1]=A*h;c=null}}return e.map(function(e,n){return{color:e.color,stop:Math.max(Math.min(1,o[n]/t),0)}})},$H=function(e,t,n){var r="number"==typeof e?e:function(e,t,n){var r=t/2,o=n/2,i=Xz(e[0],t)-r,s=o-Xz(e[1],n);return(Math.atan2(s,i)+2*Math.PI)%(2*Math.PI)}(e,t,n),o=Math.abs(t*Math.sin(r))+Math.abs(n*Math.cos(r)),i=t/2,s=n/2,a=o/2,l=Math.sin(r-Math.PI/2)*a,c=Math.cos(r-Math.PI/2)*a;return[o,i-c,i+c,s-l,s+l]},KH=function(e,t){return Math.sqrt(e*e+t*t)},XH=function(e,t,n,r,o){return[[0,0],[0,t],[e,0],[e,t]].reduce(function(e,t){var i=t[0],s=t[1],a=KH(n-i,r-s);return(o?a<e.optimumDistance:a>e.optimumDistance)?{optimumCorner:t,optimumDistance:a}:e},{optimumDistance:o?1/0:-1/0,optimumCorner:null}).optimumCorner},YH=function(e,t){var n=tH(180),r=[];return jz(t).forEach(function(t,o){if(0===o){var i=t[0];if(20===i.type&&-1!==["top","left","right","bottom"].indexOf(i.value))return void(n=eH(t));if(Zz(i))return void(n=(Jz(e,i)+tH(270))%tH(360))}var s=VH(e,t);r.push(s)}),{angle:n,stops:r,type:1}},qH="closest-side",JH="farthest-side",ZH="closest-corner",eG="farthest-corner",tG="circle",nG="ellipse",rG="cover",oG="contain",iG=function(e,t){var n=0,r=3,o=[],i=[];return jz(t).forEach(function(t,s){var a=!0;if(0===s?a=t.reduce(function(e,t){if(Lz(t))switch(t.value){case"center":return i.push(Wz),!1;case"top":case"left":return i.push(Vz),!1;case"right":case"bottom":return i.push($z),!1}else if(Hz(t)||zz(t))return i.push(t),!1;return e},a):1===s&&(a=t.reduce(function(e,t){if(Lz(t))switch(t.value){case tG:return n=0,!1;case nG:return n=1,!1;case oG:case qH:return r=0,!1;case JH:return r=1,!1;case ZH:return r=2,!1;case rG:case eG:return r=3,!1}else if(zz(t)||Hz(t))return Array.isArray(r)||(r=[]),r.push(t),!1;return e},a)),a){var l=VH(e,t);o.push(l)}}),{size:r,shape:n,stops:o,position:i,type:2}},sG=function(e,t){if(22===t.type){var n={url:t.value,type:0};return e.cache.addImage(t.value),n}if(18===t.type){var r=cG[t.name];if(void 0===r)throw new Error('Attempting to parse an unsupported image function "'.concat(t.name,'"'));return r(e,t.values)}throw new Error("Unsupported image type ".concat(t.type))};var aG,lG,cG={"linear-gradient":function(e,t){var n=tH(180),r=[];return jz(t).forEach(function(t,o){if(0===o){var i=t[0];if(20===i.type&&"to"===i.value)return void(n=eH(t));if(Zz(i))return void(n=Jz(e,i))}var s=VH(e,t);r.push(s)}),{angle:n,stops:r,type:1}},"-moz-linear-gradient":YH,"-ms-linear-gradient":YH,"-o-linear-gradient":YH,"-webkit-linear-gradient":YH,"radial-gradient":function(e,t){var n=0,r=3,o=[],i=[];return jz(t).forEach(function(t,s){var a=!0;if(0===s){var l=!1;a=t.reduce(function(e,t){if(l)if(Lz(t))switch(t.value){case"center":return i.push(Wz),e;case"top":case"left":return i.push(Vz),e;case"right":case"bottom":return i.push($z),e}else(Hz(t)||zz(t))&&i.push(t);else if(Lz(t))switch(t.value){case tG:return n=0,!1;case nG:return n=1,!1;case"at":return l=!0,!1;case qH:return r=0,!1;case rG:case JH:return r=1,!1;case oG:case ZH:return r=2,!1;case eG:return r=3,!1}else if(zz(t)||Hz(t))return Array.isArray(r)||(r=[]),r.push(t),!1;return e},a)}if(a){var c=VH(e,t);o.push(c)}}),{size:r,shape:n,stops:o,position:i,type:2}},"-moz-radial-gradient":iG,"-ms-radial-gradient":iG,"-o-radial-gradient":iG,"-webkit-radial-gradient":iG,"-webkit-gradient":function(e,t){var n=tH(180),r=[],o=1;return jz(t).forEach(function(t,n){var i=t[0];if(0===n){if(Lz(i)&&"linear"===i.value)return void(o=1);if(Lz(i)&&"radial"===i.value)return void(o=2)}if(18===i.type)if("from"===i.name){var s=MH(e,i.values[0]);r.push({stop:Vz,color:s})}else if("to"===i.name){s=MH(e,i.values[0]);r.push({stop:$z,color:s})}else if("color-stop"===i.name){var a=i.values.filter(Nz);if(2===a.length){s=MH(e,a[1]);var l=a[0];Mz(l)&&r.push({stop:{type:16,number:100*l.number,flags:l.flags},color:s})}}}),1===o?{angle:(n+tH(180))%tH(360),stops:r,type:o}:{size:3,shape:0,stops:r,position:[],type:o}}},uG={name:"background-image",initialValue:"none",type:1,prefix:!1,parse:function(e,t){if(0===t.length)return[];var n=t[0];return 20===n.type&&"none"===n.value?[]:t.filter(function(e){return Nz(e)&&function(e){return!(20===e.type&&"none"===e.value||18===e.type&&!cG[e.name])}(e)}).map(function(t){return sG(e,t)})}},dG={name:"background-origin",initialValue:"border-box",prefix:!1,type:1,parse:function(e,t){return t.map(function(e){if(Lz(e))switch(e.value){case"padding-box":return 1;case"content-box":return 2}return 0})}},AG={name:"background-position",initialValue:"0% 0%",type:1,prefix:!1,parse:function(e,t){return jz(t).map(function(e){return e.filter(Hz)}).map(Gz)}},hG={name:"background-repeat",initialValue:"repeat",prefix:!1,type:1,parse:function(e,t){return jz(t).map(function(e){return e.filter(Lz).map(function(e){return e.value}).join(" ")}).map(pG)}},pG=function(e){switch(e){case"no-repeat":return 1;case"repeat-x":case"repeat no-repeat":return 2;case"repeat-y":case"no-repeat repeat":return 3;default:return 0}};(lG=aG||(aG={})).AUTO="auto",lG.CONTAIN="contain",lG.COVER="cover";var fG,gG,mG={name:"background-size",initialValue:"0",prefix:!1,type:1,parse:function(e,t){return jz(t).map(function(e){return e.filter(yG)})}},yG=function(e){return Lz(e)||Hz(e)},vG=function(e){return{name:"border-".concat(e,"-color"),initialValue:"transparent",prefix:!1,type:3,format:"color"}},bG=vG("top"),wG=vG("right"),xG=vG("bottom"),_G=vG("left"),CG=function(e){return{name:"border-radius-".concat(e),initialValue:"0 0",prefix:!1,type:1,parse:function(e,t){return Gz(t.filter(Hz))}}},SG=CG("top-left"),EG=CG("top-right"),BG=CG("bottom-right"),IG=CG("bottom-left"),RG=function(e){return{name:"border-".concat(e,"-style"),initialValue:"solid",prefix:!1,type:2,parse:function(e,t){switch(t){case"none":return 0;case"dashed":return 2;case"dotted":return 3;case"double":return 4}return 1}}},kG=RG("top"),TG=RG("right"),PG=RG("bottom"),FG=RG("left"),MG=function(e){return{name:"border-".concat(e,"-width"),initialValue:"0",type:0,prefix:!1,parse:function(e,t){return Fz(t)?t.number:0}}},LG=MG("top"),UG=MG("right"),OG=MG("bottom"),DG=MG("left"),NG={name:"color",initialValue:"transparent",prefix:!1,type:3,format:"color"},jG={name:"direction",initialValue:"ltr",prefix:!1,type:2,parse:function(e,t){return"rtl"===t?1:0}},QG={name:"display",initialValue:"inline-block",prefix:!1,type:1,parse:function(e,t){return t.filter(Lz).reduce(function(e,t){return e|zG(t.value)},0)}},zG=function(e){switch(e){case"block":case"-webkit-box":return 2;case"inline":return 4;case"run-in":return 8;case"flow":return 16;case"flow-root":return 32;case"table":return 64;case"flex":case"-webkit-flex":return 128;case"grid":case"-ms-grid":return 256;case"ruby":return 512;case"subgrid":return 1024;case"list-item":return 2048;case"table-row-group":return 4096;case"table-header-group":return 8192;case"table-footer-group":return 16384;case"table-row":return 32768;case"table-cell":return 65536;case"table-column-group":return 131072;case"table-column":return 262144;case"table-caption":return 524288;case"ruby-base":return 1048576;case"ruby-text":return 2097152;case"ruby-base-container":return 4194304;case"ruby-text-container":return 8388608;case"contents":return 16777216;case"inline-block":return 33554432;case"inline-list-item":return 67108864;case"inline-table":return 134217728;case"inline-flex":return 268435456;case"inline-grid":return 536870912}return 0},HG={name:"float",initialValue:"none",prefix:!1,type:2,parse:function(e,t){switch(t){case"left":return 1;case"right":return 2;case"inline-start":return 3;case"inline-end":return 4}return 0}},GG={name:"letter-spacing",initialValue:"0",prefix:!1,type:0,parse:function(e,t){return 20===t.type&&"normal"===t.value?0:17===t.type||15===t.type?t.number:0}};(gG=fG||(fG={})).NORMAL="normal",gG.STRICT="strict";var VG,WG,$G={name:"line-break",initialValue:"normal",prefix:!1,type:2,parse:function(e,t){return"strict"===t?fG.STRICT:fG.NORMAL}},KG={name:"line-height",initialValue:"normal",prefix:!1,type:4},XG=function(e,t){return Lz(e)&&"normal"===e.value?1.2*t:17===e.type?t*e.number:Hz(e)?Xz(e,t):t},YG={name:"list-style-image",initialValue:"none",type:0,prefix:!1,parse:function(e,t){return 20===t.type&&"none"===t.value?null:sG(e,t)}},qG={name:"list-style-position",initialValue:"outside",prefix:!1,type:2,parse:function(e,t){return"inside"===t?0:1}},JG={name:"list-style-type",initialValue:"none",prefix:!1,type:2,parse:function(e,t){switch(t){case"disc":return 0;case"circle":return 1;case"square":return 2;case"decimal":return 3;case"cjk-decimal":return 4;case"decimal-leading-zero":return 5;case"lower-roman":return 6;case"upper-roman":return 7;case"lower-greek":return 8;case"lower-alpha":return 9;case"upper-alpha":return 10;case"arabic-indic":return 11;case"armenian":return 12;case"bengali":return 13;case"cambodian":return 14;case"cjk-earthly-branch":return 15;case"cjk-heavenly-stem":return 16;case"cjk-ideographic":return 17;case"devanagari":return 18;case"ethiopic-numeric":return 19;case"georgian":return 20;case"gujarati":return 21;case"gurmukhi":return 22;case"hebrew":return 52;case"hiragana":return 23;case"hiragana-iroha":return 24;case"japanese-formal":return 25;case"japanese-informal":return 26;case"kannada":return 27;case"katakana":return 28;case"katakana-iroha":return 29;case"khmer":return 30;case"korean-hangul-formal":return 31;case"korean-hanja-formal":return 32;case"korean-hanja-informal":return 33;case"lao":return 34;case"lower-armenian":return 35;case"malayalam":return 36;case"mongolian":return 37;case"myanmar":return 38;case"oriya":return 39;case"persian":return 40;case"simp-chinese-formal":return 41;case"simp-chinese-informal":return 42;case"tamil":return 43;case"telugu":return 44;case"thai":return 45;case"tibetan":return 46;case"trad-chinese-formal":return 47;case"trad-chinese-informal":return 48;case"upper-armenian":return 49;case"disclosure-open":return 50;case"disclosure-closed":return 51;default:return-1}}},ZG=function(e){return{name:"margin-".concat(e),initialValue:"0",prefix:!1,type:4}},eV=ZG("top"),tV=ZG("right"),nV=ZG("bottom"),rV=ZG("left"),oV={name:"overflow",initialValue:"visible",prefix:!1,type:1,parse:function(e,t){return t.filter(Lz).map(function(e){switch(e.value){case"hidden":return 1;case"scroll":return 2;case"clip":return 3;case"auto":return 4;default:return 0}})}},iV={name:"overflow-wrap",initialValue:"normal",prefix:!1,type:2,parse:function(e,t){return"break-word"===t?"break-word":"normal"}},sV=function(e){return{name:"padding-".concat(e),initialValue:"0",prefix:!1,type:3,format:"length-percentage"}},aV=sV("top"),lV=sV("right"),cV=sV("bottom"),uV=sV("left"),dV={name:"text-align",initialValue:"left",prefix:!1,type:2,parse:function(e,t){switch(t){case"right":return 2;case"center":case"justify":return 1;default:return 0}}},AV={name:"position",initialValue:"static",prefix:!1,type:2,parse:function(e,t){switch(t){case"relative":return 1;case"absolute":return 2;case"fixed":return 3;case"sticky":return 4}return 0}},hV={name:"text-shadow",initialValue:"none",type:1,prefix:!1,parse:function(e,t){return 1===t.length&&Oz(t[0],"none")?[]:jz(t).map(function(t){for(var n={color:zH.TRANSPARENT,offsetX:Vz,offsetY:Vz,blur:Vz},r=0,o=0;o<t.length;o++){var i=t[o];zz(i)?(0===r?n.offsetX=i:1===r?n.offsetY=i:n.blur=i,r++):n.color=MH(e,i)}return n})}},pV={name:"text-transform",initialValue:"none",prefix:!1,type:2,parse:function(e,t){switch(t){case"uppercase":return 2;case"lowercase":return 1;case"capitalize":return 3}return 0}},fV={name:"transform",initialValue:"none",prefix:!0,type:0,parse:function(e,t){if(20===t.type&&"none"===t.value)return null;if(18===t.type){var n=gV[t.name];if(void 0===n)throw new Error('Attempting to parse an unsupported transform function "'.concat(t.name,'"'));return n(e,t.values)}return null}},gV={matrix:function(e,t){var n=t.filter(function(e){return 17===e.type}).map(function(e){return e.number});return 6===n.length?n:null},matrix3d:function(e,t){var n=t.filter(function(e){return 17===e.type}).map(function(e){return e.number}),r=n[0],o=n[1];n[2],n[3];var i=n[4],s=n[5];n[6],n[7],n[8],n[9],n[10],n[11];var a=n[12],l=n[13];return n[14],n[15],16===n.length?[r,o,i,s,a,l]:null},rotate:function(e,t){if(1!==t.length)return null;var n=t[0],r=0;if(17===n.type&&0===n.number)r=0;else{if(15!==n.type)return null;r=Jz(e,n)}var o=Math.cos(r),i=Math.sin(r);return[o,i,-i,o,0,0]}},mV={type:16,number:50,flags:4},yV=[mV,mV],vV={name:"transform-origin",initialValue:"50% 50%",prefix:!0,type:1,parse:function(e,t){var n=t.filter(Hz);return 2!==n.length?yV:[n[0],n[1]]}},bV={name:"rotate",initialValue:"none",prefix:!1,type:0,parse:function(e,t){return 20===t.type&&"none"===t.value?null:17===t.type&&0===t.number?0:15===t.type?180*Jz(e,t)/Math.PI:null}},wV={name:"visible",initialValue:"none",prefix:!1,type:2,parse:function(e,t){switch(t){case"hidden":return 1;case"collapse":return 2;default:return 0}}};(WG=VG||(VG={})).NORMAL="normal",WG.BREAK_ALL="break-all",WG.KEEP_ALL="keep-all";for(var xV={name:"word-break",initialValue:"normal",prefix:!1,type:2,parse:function(e,t){switch(t){case"break-all":return VG.BREAK_ALL;case"keep-all":return VG.KEEP_ALL;default:return VG.NORMAL}}},_V={name:"z-index",initialValue:"auto",prefix:!1,type:0,parse:function(e,t){if(20===t.type)return{auto:!0,order:0};if(Mz(t))return{auto:!1,order:t.number};throw new Error("Invalid z-index number parsed")}},CV=function(e,t){if(15===t.type)switch(t.unit.toLowerCase()){case"s":return 1e3*t.number;case"ms":return t.number}throw new Error("Unsupported time type")},SV={name:"opacity",initialValue:"1",type:0,prefix:!1,parse:function(e,t){return Mz(t)?t.number:1}},EV={name:"text-decoration-color",initialValue:"transparent",prefix:!1,type:3,format:"color"},BV={name:"text-decoration-line",initialValue:"none",prefix:!1,type:1,parse:function(e,t){return t.filter(Lz).map(function(e){switch(e.value){case"underline":return 1;case"overline":return 2;case"line-through":return 3;case"none":return 4}return 0}).filter(function(e){return 0!==e})}},IV={name:"font-family",initialValue:"",prefix:!1,type:1,parse:function(e,t){var n=[],r=[];return t.forEach(function(e){switch(e.type){case 20:case 0:n.push(e.value);break;case 17:n.push(e.number.toString());break;case 4:r.push(n.join(" ")),n.length=0}}),n.length&&r.push(n.join(" ")),r.map(function(e){return-1===e.indexOf(" ")?e:"'".concat(e,"'")})}},RV={name:"font-size",initialValue:"0",prefix:!1,type:3,format:"length"},kV={name:"font-weight",initialValue:"normal",type:0,prefix:!1,parse:function(e,t){return Mz(t)?t.number:Lz(t)&&"bold"===t.value?700:400}},TV={name:"font-variant",initialValue:"none",type:1,prefix:!1,parse:function(e,t){return t.filter(Lz).map(function(e){return e.value})}},PV={name:"font-style",initialValue:"normal",prefix:!1,type:2,parse:function(e,t){switch(t){case"oblique":return"oblique";case"italic":return"italic";default:return"normal"}}},FV=function(e,t){return 0!==(e&t)},MV={name:"content",initialValue:"none",type:1,prefix:!1,parse:function(e,t){if(0===t.length)return[];var n=t[0];return 20===n.type&&"none"===n.value?[]:t}},LV={name:"counter-increment",initialValue:"none",prefix:!0,type:1,parse:function(e,t){if(0===t.length)return null;var n=t[0];if(20===n.type&&"none"===n.value)return null;for(var r=[],o=t.filter(Dz),i=0;i<o.length;i++){var s=o[i],a=o[i+1];if(20===s.type){var l=a&&Mz(a)?a.number:1;r.push({counter:s.value,increment:l})}}return r}},UV={name:"counter-reset",initialValue:"none",prefix:!0,type:1,parse:function(e,t){if(0===t.length)return[];for(var n=[],r=t.filter(Dz),o=0;o<r.length;o++){var i=r[o],s=r[o+1];if(Lz(i)&&"none"!==i.value){var a=s&&Mz(s)?s.number:0;n.push({counter:i.value,reset:a})}}return n}},OV={name:"duration",initialValue:"0s",prefix:!1,type:1,parse:function(e,t){return t.filter(Fz).map(function(t){return CV(e,t)})}},DV={name:"quotes",initialValue:"none",prefix:!0,type:1,parse:function(e,t){if(0===t.length)return null;var n=t[0];if(20===n.type&&"none"===n.value)return null;var r=[],o=t.filter(Uz);if(o.length%2!=0)return null;for(var i=0;i<o.length;i+=2){var s=o[i].value,a=o[i+1].value;r.push({open:s,close:a})}return r}},NV=function(e,t,n){if(!e)return"";var r=e[Math.min(t,e.length-1)];return r?n?r.open:r.close:""},jV={name:"box-shadow",initialValue:"none",type:1,prefix:!1,parse:function(e,t){return 1===t.length&&Oz(t[0],"none")?[]:jz(t).map(function(t){for(var n={color:255,offsetX:Vz,offsetY:Vz,blur:Vz,spread:Vz,inset:!1},r=0,o=0;o<t.length;o++){var i=t[o];Oz(i,"inset")?n.inset=!0:zz(i)?(0===r?n.offsetX=i:1===r?n.offsetY=i:2===r?n.blur=i:n.spread=i,r++):n.color=MH(e,i)}return n})}},QV={name:"paint-order",initialValue:"normal",prefix:!1,type:1,parse:function(e,t){var n=[];return t.filter(Lz).forEach(function(e){switch(e.value){case"stroke":n.push(1);break;case"fill":n.push(0);break;case"markers":n.push(2)}}),[0,1,2].forEach(function(e){-1===n.indexOf(e)&&n.push(e)}),n}},zV={name:"-webkit-text-stroke-color",initialValue:"currentcolor",prefix:!1,type:3,format:"color"},HV={name:"-webkit-text-stroke-width",initialValue:"0",type:0,prefix:!1,parse:function(e,t){return Fz(t)?t.number:0}},GV={name:"objectFit",initialValue:"fill",prefix:!1,type:1,parse:function(e,t){return t.filter(Lz).reduce(function(e,t){return e|VV(t.value)},0)}},VV=function(e){switch(e){case"contain":return 2;case"cover":return 4;case"none":return 8;case"scale-down":return 16}return 0},WV=function(){function e(e,t){var n,r;this.animationDuration=XV(e,OV,t.animationDuration),this.backgroundClip=XV(e,HH,t.backgroundClip),this.backgroundColor=XV(e,GH,t.backgroundColor),this.backgroundImage=XV(e,uG,t.backgroundImage),this.backgroundOrigin=XV(e,dG,t.backgroundOrigin),this.backgroundPosition=XV(e,AG,t.backgroundPosition),this.backgroundRepeat=XV(e,hG,t.backgroundRepeat),this.backgroundSize=XV(e,mG,t.backgroundSize),this.borderTopColor=XV(e,bG,t.borderTopColor),this.borderRightColor=XV(e,wG,t.borderRightColor),this.borderBottomColor=XV(e,xG,t.borderBottomColor),this.borderLeftColor=XV(e,_G,t.borderLeftColor),this.borderTopLeftRadius=XV(e,SG,t.borderTopLeftRadius),this.borderTopRightRadius=XV(e,EG,t.borderTopRightRadius),this.borderBottomRightRadius=XV(e,BG,t.borderBottomRightRadius),this.borderBottomLeftRadius=XV(e,IG,t.borderBottomLeftRadius),this.borderTopStyle=XV(e,kG,t.borderTopStyle),this.borderRightStyle=XV(e,TG,t.borderRightStyle),this.borderBottomStyle=XV(e,PG,t.borderBottomStyle),this.borderLeftStyle=XV(e,FG,t.borderLeftStyle),this.borderTopWidth=XV(e,LG,t.borderTopWidth),this.borderRightWidth=XV(e,UG,t.borderRightWidth),this.borderBottomWidth=XV(e,OG,t.borderBottomWidth),this.borderLeftWidth=XV(e,DG,t.borderLeftWidth),this.boxShadow=XV(e,jV,t.boxShadow),this.color=XV(e,NG,t.color),this.direction=XV(e,jG,t.direction),this.display=XV(e,QG,t.display),this.float=XV(e,HG,t.cssFloat),this.fontFamily=XV(e,IV,t.fontFamily),this.fontSize=XV(e,RV,t.fontSize),this.fontStyle=XV(e,PV,t.fontStyle),this.fontVariant=XV(e,TV,t.fontVariant),this.fontWeight=XV(e,kV,t.fontWeight),this.letterSpacing=XV(e,GG,t.letterSpacing),this.lineBreak=XV(e,$G,t.lineBreak),this.lineHeight=XV(e,KG,t.lineHeight),this.listStyleImage=XV(e,YG,t.listStyleImage),this.listStylePosition=XV(e,qG,t.listStylePosition),this.listStyleType=XV(e,JG,t.listStyleType),this.marginTop=XV(e,eV,t.marginTop),this.marginRight=XV(e,tV,t.marginRight),this.marginBottom=XV(e,nV,t.marginBottom),this.marginLeft=XV(e,rV,t.marginLeft),this.opacity=XV(e,SV,t.opacity);var o=XV(e,oV,t.overflow);this.overflowX=o[0],this.overflowY=o[o.length>1?1:0],this.overflowWrap=XV(e,iV,t.overflowWrap),this.paddingTop=XV(e,aV,t.paddingTop),this.paddingRight=XV(e,lV,t.paddingRight),this.paddingBottom=XV(e,cV,t.paddingBottom),this.paddingLeft=XV(e,uV,t.paddingLeft),this.paintOrder=XV(e,QV,t.paintOrder),this.position=XV(e,AV,t.position),this.textAlign=XV(e,dV,t.textAlign),this.textDecorationColor=XV(e,EV,null!==(n=t.textDecorationColor)&&void 0!==n?n:t.color),this.textDecorationLine=XV(e,BV,null!==(r=t.textDecorationLine)&&void 0!==r?r:t.textDecoration),this.textShadow=XV(e,hV,t.textShadow),this.textTransform=XV(e,pV,t.textTransform),this.transform=XV(e,fV,t.transform),this.transformOrigin=XV(e,vV,t.transformOrigin),this.rotate=XV(e,bV,t.rotate),this.visibility=XV(e,wV,t.visibility),this.webkitTextStrokeColor=XV(e,zV,t.webkitTextStrokeColor),this.webkitTextStrokeWidth=XV(e,HV,t.webkitTextStrokeWidth),this.wordBreak=XV(e,xV,t.wordBreak),this.zIndex=XV(e,_V,t.zIndex),this.objectFit=XV(e,GV,t.objectFit)}return e.prototype.isVisible=function(){return this.display>0&&this.opacity>0&&0===this.visibility},e.prototype.isTransparent=function(){return nH(this.backgroundColor)},e.prototype.isTransformed=function(){return null!==this.transform||null!==this.rotate},e.prototype.isPositioned=function(){return 0!==this.position},e.prototype.isPositionedWithZIndex=function(){return this.isPositioned()&&!this.zIndex.auto},e.prototype.isFloating=function(){return 0!==this.float},e.prototype.isInlineLevel=function(){return FV(this.display,4)||FV(this.display,33554432)||FV(this.display,268435456)||FV(this.display,536870912)||FV(this.display,67108864)||FV(this.display,134217728)},e}(),$V=function(){return function(e,t){this.content=XV(e,MV,t.content),this.quotes=XV(e,DV,t.quotes)}}(),KV=function(){return function(e,t){this.counterIncrement=XV(e,LV,t.counterIncrement),this.counterReset=XV(e,UV,t.counterReset)}}(),XV=function(e,t,n){var r=new Tz,o=null!=n?n.toString():t.initialValue;r.write(o);var i=new Pz(r.read());switch(t.type){case 2:var s=i.parseComponentValue();return t.parse(e,Lz(s)?s.value:t.initialValue);case 0:return t.parse(e,i.parseComponentValue());case 1:return t.parse(e,i.parseComponentValues());case 4:return i.parseComponentValue();case 3:switch(t.format){case"angle":return Jz(e,i.parseComponentValue());case"color":return MH(e,i.parseComponentValue());case"image":return sG(e,i.parseComponentValue());case"length":var a=i.parseComponentValue();return zz(a)?a:Vz;case"length-percentage":var l=i.parseComponentValue();return Hz(l)?l:Vz;case"time":return CV(e,i.parseComponentValue())}}},YV=function(e,t){var n=function(e){switch(e.getAttribute("data-html2canvas-debug")){case"all":return 1;case"clone":return 2;case"parse":return 3;case"render":return 4;default:return 0}}(e);return 1===n||t===n},qV=function(){return function(e,t){this.context=e,this.textNodes=[],this.elements=[],this.flags=0,YV(t,3),this.styles=new WV(e,window.getComputedStyle(t,null)),n$(t)&&(this.styles.animationDuration.some(function(e){return e>0})&&(t.style.animationDuration="0s"),null!==this.styles.transform&&(t.style.transform="none"),null!==this.styles.rotate&&(t.style.rotate="none")),this.bounds=zj(this.context,t),YV(t,4)&&(this.flags|=16)}}(),JV="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",ZV="undefined"==typeof Uint8Array?[]:new Uint8Array(256),eW=0;eW<64;eW++)ZV[JV.charCodeAt(eW)]=eW;for(var tW=function(e,t,n){return e.slice?e.slice(t,n):new Uint16Array(Array.prototype.slice.call(e,t,n))},nW=function(){function e(e,t,n,r,o,i){this.initialValue=e,this.errorValue=t,this.highStart=n,this.highValueIndex=r,this.index=o,this.data=i}return e.prototype.get=function(e){var t;if(e>=0){if(e<55296||e>56319&&e<=65535)return t=((t=this.index[e>>5])<<2)+(31&e),this.data[t];if(e<=65535)return t=((t=this.index[2048+(e-55296>>5)])<<2)+(31&e),this.data[t];if(e<this.highStart)return t=2080+(e>>11),t=this.index[t],t+=e>>5&63,t=((t=this.index[t])<<2)+(31&e),this.data[t];if(e<=1114111)return this.data[this.highValueIndex]}return this.errorValue},e}(),rW="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",oW="undefined"==typeof Uint8Array?[]:new Uint8Array(256),iW=0;iW<64;iW++)oW[rW.charCodeAt(iW)]=iW;var sW,aW,lW=8,cW=9,uW=11,dW=12,AW=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];if(String.fromCodePoint)return String.fromCodePoint.apply(String,e);var n=e.length;if(!n)return"";for(var r=[],o=-1,i="";++o<n;){var s=e[o];s<=65535?r.push(s):(s-=65536,r.push(55296+(s>>10),s%1024+56320)),(o+1===n||r.length>16384)&&(i+=String.fromCharCode.apply(String,r),r.length=0)}return i},hW=function(e){var t=function(e){var t,n,r,o,i,s=.75*e.length,a=e.length,l=0;"="===e[e.length-1]&&(s--,"="===e[e.length-2]&&s--);var c="undefined"!=typeof ArrayBuffer&&"undefined"!=typeof Uint8Array&&void 0!==Uint8Array.prototype.slice?new ArrayBuffer(s):new Array(s),u=Array.isArray(c)?c:new Uint8Array(c);for(t=0;t<a;t+=4)n=ZV[e.charCodeAt(t)],r=ZV[e.charCodeAt(t+1)],o=ZV[e.charCodeAt(t+2)],i=ZV[e.charCodeAt(t+3)],u[l++]=n<<2|r>>4,u[l++]=(15&r)<<4|o>>2,u[l++]=(3&o)<<6|63&i;return c}(e),n=Array.isArray(t)?function(e){for(var t=e.length,n=[],r=0;r<t;r+=4)n.push(e[r+3]<<24|e[r+2]<<16|e[r+1]<<8|e[r]);return n}(t):new Uint32Array(t),r=Array.isArray(t)?function(e){for(var t=e.length,n=[],r=0;r<t;r+=2)n.push(e[r+1]<<8|e[r]);return n}(t):new Uint16Array(t),o=tW(r,12,n[4]/2),i=2===n[5]?tW(r,(24+n[4])/2):function(e,t,n){return e.slice?e.slice(t,n):new Uint32Array(Array.prototype.slice.call(e,t,n))}(n,Math.ceil((24+n[4])/4));return new nW(n[0],n[1],n[2],n[3],o,i)}("AAAAAAAAAAAAEA4AGBkAAFAaAAACAAAAAAAIABAAGAAwADgACAAQAAgAEAAIABAACAAQAAgAEAAIABAACAAQAAgAEAAIABAAQABIAEQATAAIABAACAAQAAgAEAAIABAAVABcAAgAEAAIABAACAAQAGAAaABwAHgAgACIAI4AlgAIABAAmwCjAKgAsAC2AL4AvQDFAMoA0gBPAVYBWgEIAAgACACMANoAYgFkAWwBdAF8AX0BhQGNAZUBlgGeAaMBlQGWAasBswF8AbsBwwF0AcsBYwHTAQgA2wG/AOMBdAF8AekB8QF0AfkB+wHiAHQBfAEIAAMC5gQIAAsCEgIIAAgAFgIeAggAIgIpAggAMQI5AkACygEIAAgASAJQAlgCYAIIAAgACAAKBQoFCgUTBRMFGQUrBSsFCAAIAAgACAAIAAgACAAIAAgACABdAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACABoAmgCrwGvAQgAbgJ2AggAHgEIAAgACADnAXsCCAAIAAgAgwIIAAgACAAIAAgACACKAggAkQKZAggAPADJAAgAoQKkAqwCsgK6AsICCADJAggA0AIIAAgACAAIANYC3gIIAAgACAAIAAgACABAAOYCCAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAkASoB+QIEAAgACAA8AEMCCABCBQgACABJBVAFCAAIAAgACAAIAAgACAAIAAgACABTBVoFCAAIAFoFCABfBWUFCAAIAAgACAAIAAgAbQUIAAgACAAIAAgACABzBXsFfQWFBYoFigWKBZEFigWKBYoFmAWfBaYFrgWxBbkFCAAIAAgACAAIAAgACAAIAAgACAAIAMEFCAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAMgFCADQBQgACAAIAAgACAAIAAgACAAIAAgACAAIAO4CCAAIAAgAiQAIAAgACABAAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAD0AggACAD8AggACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIANYFCAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAMDvwAIAAgAJAIIAAgACAAIAAgACAAIAAgACwMTAwgACAB9BOsEGwMjAwgAKwMyAwsFYgE3A/MEPwMIAEUDTQNRAwgAWQOsAGEDCAAIAAgACAAIAAgACABpAzQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFIQUoBSwFCAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACABtAwgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACABMAEwACAAIAAgACAAIABgACAAIAAgACAC/AAgACAAyAQgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACACAAIAAwAAgACAAIAAgACAAIAAgACAAIAAAARABIAAgACAAIABQASAAIAAgAIABwAEAAjgCIABsAqAC2AL0AigDQAtwC+IJIQqVAZUBWQqVAZUBlQGVAZUBlQGrC5UBlQGVAZUBlQGVAZUBlQGVAXsKlQGVAbAK6wsrDGUMpQzlDJUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAfAKAAuZA64AtwCJALoC6ADwAAgAuACgA/oEpgO6AqsD+AAIAAgAswMIAAgACAAIAIkAuwP5AfsBwwPLAwgACAAIAAgACADRA9kDCAAIAOED6QMIAAgACAAIAAgACADuA/YDCAAIAP4DyQAIAAgABgQIAAgAXQAOBAgACAAIAAgACAAIABMECAAIAAgACAAIAAgACAD8AAQBCAAIAAgAGgQiBCoECAExBAgAEAEIAAgACAAIAAgACAAIAAgACAAIAAgACAA4BAgACABABEYECAAIAAgATAQYAQgAVAQIAAgACAAIAAgACAAIAAgACAAIAFoECAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgAOQEIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAB+BAcACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAEABhgSMBAgACAAIAAgAlAQIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAwAEAAQABAADAAMAAwADAAQABAAEAAQABAAEAAQABHATAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgAdQMIAAgACAAIAAgACAAIAMkACAAIAAgAfQMIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACACFA4kDCAAIAAgACAAIAOcBCAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAIcDCAAIAAgACAAIAAgACAAIAAgACAAIAJEDCAAIAAgACADFAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACABgBAgAZgQIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgAbAQCBXIECAAIAHkECAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACABAAJwEQACjBKoEsgQIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAC6BMIECAAIAAgACAAIAAgACABmBAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgAxwQIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAGYECAAIAAgAzgQIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgAigWKBYoFigWKBYoFigWKBd0FXwUIAOIF6gXxBYoF3gT5BQAGCAaKBYoFigWKBYoFigWKBYoFigWKBYoFigXWBIoFigWKBYoFigWKBYoFigWKBYsFEAaKBYoFigWKBYoFigWKBRQGCACKBYoFigWKBQgACAAIANEECAAIABgGigUgBggAJgYIAC4GMwaKBYoF0wQ3Bj4GigWKBYoFigWKBYoFigWKBYoFigWKBYoFigUIAAgACAAIAAgACAAIAAgAigWKBYoFigWKBYoFigWKBYoFigWKBYoFigWKBYoFigWKBYoFigWKBYoFigWKBYoFigWKBYoFigWKBYoFigWLBf///////wQABAAEAAQABAAEAAQABAAEAAQAAwAEAAQAAgAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAQADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAUAAAAFAAUAAAAFAAUAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAEAAQABAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUAAQAAAAUABQAFAAUABQAFAAAAAAAFAAUAAAAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAFAAUAAQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABwAFAAUABQAFAAAABwAHAAcAAAAHAAcABwAFAAEAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAcABwAFAAUABQAFAAcABwAFAAUAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAAAAQABAAAAAAAAAAAAAAAFAAUABQAFAAAABwAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAHAAcABwAHAAcAAAAHAAcAAAAAAAUABQAHAAUAAQAHAAEABwAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABwABAAUABQAFAAUAAAAAAAAAAAAAAAEAAQABAAEAAQABAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABwAFAAUAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUAAQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQABQANAAQABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQABAAEAAQABAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAEAAQABAAEAAQABAAEAAQABAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAQABAAEAAQABAAEAAQABAAAAAAAAAAAAAAAAAAAAAAABQAHAAUABQAFAAAAAAAAAAcABQAFAAUABQAFAAQABAAEAAQABAAEAAQABAAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUAAAAFAAUABQAFAAUAAAAFAAUABQAAAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAAAAAAAAAAAAUABQAFAAcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAHAAUAAAAHAAcABwAFAAUABQAFAAUABQAFAAUABwAHAAcABwAFAAcABwAAAAUABQAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABwAHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAUABwAHAAUABQAFAAUAAAAAAAcABwAAAAAABwAHAAUAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAABQAFAAcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAABwAHAAcABQAFAAAAAAAAAAAABQAFAAAAAAAFAAUABQAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAFAAUABQAFAAUAAAAFAAUABwAAAAcABwAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAFAAUABwAFAAUABQAFAAAAAAAHAAcAAAAAAAcABwAFAAAAAAAAAAAAAAAAAAAABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAcABwAAAAAAAAAHAAcABwAAAAcABwAHAAUAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAABQAHAAcABwAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABwAHAAcABwAAAAUABQAFAAAABQAFAAUABQAAAAAAAAAAAAAAAAAAAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAcABQAHAAcABQAHAAcAAAAFAAcABwAAAAcABwAFAAUAAAAAAAAAAAAAAAAAAAAFAAUAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAcABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAAAAUABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAFAAcABwAFAAUABQAAAAUAAAAHAAcABwAHAAcABwAHAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAHAAUABQAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAABwAFAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAUAAAAFAAAAAAAAAAAABwAHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABwAFAAUABQAFAAUAAAAFAAUAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABwAFAAUABQAFAAUABQAAAAUABQAHAAcABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAcABQAFAAAAAAAAAAAABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAcABQAFAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAHAAUABQAFAAUABQAFAAUABwAHAAcABwAHAAcABwAHAAUABwAHAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABwAHAAcABwAFAAUABwAHAAcAAAAAAAAAAAAHAAcABQAHAAcABwAHAAcABwAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAcABwAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABQAHAAUABQAFAAUABQAFAAUAAAAFAAAABQAAAAAABQAFAAUABQAFAAUABQAFAAcABwAHAAcABwAHAAUABQAFAAUABQAFAAUABQAFAAUAAAAAAAUABQAFAAUABQAHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUABwAFAAcABwAHAAcABwAFAAcABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAUABQAFAAUABwAHAAUABQAHAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAcABQAFAAcABwAHAAUABwAFAAUABQAHAAcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAHAAcABwAHAAcABwAHAAUABQAFAAUABQAFAAUABQAHAAcABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUAAAAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAcABQAFAAUABQAFAAUABQAAAAAAAAAAAAUAAAAAAAAAAAAAAAAABQAAAAAABwAFAAUAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAAABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUAAAAFAAUABQAFAAUABQAFAAUABQAFAAAAAAAAAAAABQAAAAAAAAAFAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAHAAUABQAHAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABwAHAAcABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUABQAFAAUABQAHAAcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAcABwAFAAUABQAFAAcABwAFAAUABwAHAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAcABwAFAAUABwAHAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAFAAcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAFAAUABQAAAAAABQAFAAAAAAAAAAAAAAAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABQAFAAcABwAAAAAAAAAAAAAABwAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABwAFAAcABwAFAAcABwAAAAcABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAAAAAAAAAAAAAAAAAFAAUABQAAAAUABQAAAAAAAAAAAAAABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAAAAAAAAAAAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABQAHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABwAFAAUABQAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAHAAcABQAFAAUABQAFAAUABQAFAAUABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAcABwAFAAUABQAHAAcABQAHAAUABQAAAAAAAAAAAAAAAAAFAAAABwAHAAcABQAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABwAHAAcABwAAAAAABwAHAAAAAAAHAAcABwAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAHAAAAAAAFAAUABQAFAAUABQAFAAAAAAAAAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAcABwAFAAUABQAFAAUABQAFAAUABwAHAAUABQAFAAcABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAHAAcABQAFAAUABQAFAAUABwAFAAcABwAFAAcABQAFAAcABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAHAAcABQAFAAUABQAAAAAABwAHAAcABwAFAAUABwAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABwAHAAUABQAFAAUABQAFAAUABQAHAAcABQAHAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABwAFAAcABwAFAAUABQAFAAUABQAHAAUAAAAAAAAAAAAAAAAAAAAAAAcABwAFAAUABQAFAAcABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAcABwAFAAUABQAFAAUABQAFAAUABQAHAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAcABwAFAAUABQAFAAAAAAAFAAUABwAHAAcABwAFAAAAAAAAAAcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABwAHAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABQAFAAUABQAFAAUABQAAAAUABQAFAAUABQAFAAcABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAAAHAAUABQAFAAUABQAFAAUABwAFAAUABwAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUAAAAAAAAABQAAAAUABQAAAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAcABwAHAAcAAAAFAAUAAAAHAAcABQAHAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABwAHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAAAAAAAAAAAAAAAAAAABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAAAAUABQAFAAAAAAAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAAAAAAAAAAABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAAAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABQAAAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAAABQAFAAUABQAFAAUABQAAAAUABQAAAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAFAAUABQAFAAUADgAOAA4ADgAOAA4ADwAPAA8ADwAPAA8ADwAPAA8ADwAPAA8ADwAPAA8ADwAPAA8ADwAPAA8ADwAPAA8ADwAPAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAAAAAAAAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAMAAwADAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkAAAAAAAAAAAAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAAAAAAAAAAAAsADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwACwAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAAAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA4AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAOAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA4ADgAAAAAAAAAAAAAAAAAAAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAA4ADgAOAA4ADgAOAA4ADgAOAAAAAAAAAAAADgAOAA4AAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAA4ADgAAAA4ADgAOAA4ADgAOAAAADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4AAAAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4AAAAAAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAAAA4AAAAOAAAAAAAAAAAAAAAAAA4AAAAAAAAAAAAAAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAAAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAAAAAADgAAAAAAAAAAAA4AAAAOAAAAAAAAAAAADgAOAA4AAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAOAA4AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA4ADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAAAAAAAAAAAA4AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA4ADgAOAA4ADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAAAAAADgAOAA4ADgAOAA4ADgAOAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAAAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA4AAAAAAA4ADgAOAA4ADgAOAA4ADgAOAAAADgAOAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4AAAAAAAAAAAAAAAAADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAA4ADgAOAA4ADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAA4ADgAOAA4AAAAAAAAAAAAAAAAAAAAAAA4ADgAOAA4ADgAOAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4AAAAOAA4ADgAOAA4ADgAAAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4AAAAAAAAAAAA="),pW="",fW=function(e){return hW.get(e)},gW=function(e,t,n){var r=n-2,o=t[r],i=t[n-1],s=t[n];if(2===i&&3===s)return pW;if(2===i||3===i||4===i)return"";if(2===s||3===s||4===s)return"";if(i===lW&&-1!==[lW,cW,uW,dW].indexOf(s))return pW;if(!(i!==uW&&i!==cW||s!==cW&&10!==s))return pW;if((i===dW||10===i)&&10===s)return pW;if(13===s||5===s)return pW;if(7===s)return pW;if(1===i)return pW;if(13===i&&14===s){for(;5===o;)o=t[--r];if(14===o)return pW}if(15===i&&15===s){for(var a=0;15===o;)a++,o=t[--r];if(a%2==0)return pW}return""},mW=function(e){var t=function(e){for(var t=[],n=0,r=e.length;n<r;){var o=e.charCodeAt(n++);if(o>=55296&&o<=56319&&n<r){var i=e.charCodeAt(n++);56320==(64512&i)?t.push(((1023&o)<<10)+(1023&i)+65536):(t.push(o),n--)}else t.push(o)}return t}(e),n=t.length,r=0,o=0,i=t.map(fW);return{next:function(){if(r>=n)return{done:!0,value:null};for(var e=pW;r<n&&(e=gW(0,i,++r))===pW;);if(e!==pW||r===n){var s=AW.apply(null,t.slice(o,r));return o=r,{value:s,done:!1}}return{done:!0,value:null}}}},yW=function(e){return 0===e[0]&&255===e[1]&&0===e[2]&&255===e[3]},vW=function(e,t,n,r,o){var i="http://www.w3.org/2000/svg",s=document.createElementNS(i,"svg"),a=document.createElementNS(i,"foreignObject");return s.setAttributeNS(null,"width",e.toString()),s.setAttributeNS(null,"height",t.toString()),a.setAttributeNS(null,"width","100%"),a.setAttributeNS(null,"height","100%"),a.setAttributeNS(null,"x",n.toString()),a.setAttributeNS(null,"y",r.toString()),a.setAttributeNS(null,"externalResourcesRequired","true"),s.appendChild(a),a.appendChild(o),s},bW=function(e){return new Promise(function(t,n){var r=new Image;r.onload=function(){return t(r)},r.onerror=n,r.src="data:image/svg+xml;charset=utf-8,".concat(encodeURIComponent((new XMLSerializer).serializeToString(e)))})},wW={get SUPPORT_RANGE_BOUNDS(){var e=function(e){if(e.createRange){var t=e.createRange();if(t.getBoundingClientRect){var n=e.createElement("boundtest");n.style.height="".concat(123,"px"),n.style.display="block",e.body.appendChild(n),t.selectNode(n);var r=t.getBoundingClientRect(),o=Math.round(r.height);if(e.body.removeChild(n),123===o)return!0}}return!1}(document);return Object.defineProperty(wW,"SUPPORT_RANGE_BOUNDS",{value:e}),e},get SUPPORT_WORD_BREAKING(){var e=wW.SUPPORT_RANGE_BOUNDS&&function(e){var t=e.createElement("boundtest");t.style.width="50px",t.style.display="block",t.style.fontSize="12px",t.style.letterSpacing="0px",t.style.wordSpacing="0px",e.body.appendChild(t);var n=e.createRange();t.innerHTML="function"==typeof"".repeat?"&#128104;".repeat(10):"";var r=t.firstChild,o=Hj(r.data).map(function(e){return Gj(e)}),i=0,s={},a=o.every(function(e,t){n.setStart(r,i),n.setEnd(r,i+e.length);var o=n.getBoundingClientRect();i+=e.length;var a=o.x>s.x||o.y>s.y;return s=o,0===t||a});return e.body.removeChild(t),a}(document);return Object.defineProperty(wW,"SUPPORT_WORD_BREAKING",{value:e}),e},get SUPPORT_SVG_DRAWING(){var e=function(e){var t=new Image,n=e.createElement("canvas"),r=n.getContext("2d");if(!r)return!1;t.src="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg'></svg>";try{r.drawImage(t,0,0),n.toDataURL()}catch(SE){return!1}return!0}(document);return Object.defineProperty(wW,"SUPPORT_SVG_DRAWING",{value:e}),e},get SUPPORT_FOREIGNOBJECT_DRAWING(){var e="function"==typeof Array.from&&"function"==typeof window.fetch?function(e){var t=e.createElement("canvas"),n=100;t.width=n,t.height=n;var r=t.getContext("2d");if(!r)return Promise.reject(!1);r.fillStyle="rgb(0, 255, 0)",r.fillRect(0,0,n,n);var o=new Image,i=t.toDataURL();o.src=i;var s=vW(n,n,0,0,o);return r.fillStyle="red",r.fillRect(0,0,n,n),bW(s).then(function(t){r.drawImage(t,0,0);var o=r.getImageData(0,0,n,n).data;r.fillStyle="red",r.fillRect(0,0,n,n);var s=e.createElement("div");return s.style.backgroundImage="url(".concat(i,")"),s.style.height="".concat(n,"px"),yW(o)?bW(vW(n,n,0,0,s)):Promise.reject(!1)}).then(function(e){return r.drawImage(e,0,0),yW(r.getImageData(0,0,n,n).data)}).catch(function(){return!1})}(document):Promise.resolve(!1);return Object.defineProperty(wW,"SUPPORT_FOREIGNOBJECT_DRAWING",{value:e}),e},get SUPPORT_CORS_IMAGES(){var e=void 0!==(new Image).crossOrigin;return Object.defineProperty(wW,"SUPPORT_CORS_IMAGES",{value:e}),e},get SUPPORT_RESPONSE_TYPE(){var e="string"==typeof(new XMLHttpRequest).responseType;return Object.defineProperty(wW,"SUPPORT_RESPONSE_TYPE",{value:e}),e},get SUPPORT_CORS_XHR(){var e="withCredentials"in new XMLHttpRequest;return Object.defineProperty(wW,"SUPPORT_CORS_XHR",{value:e}),e},get SUPPORT_NATIVE_TEXT_SEGMENTATION(){var e=!("undefined"==typeof Intl||!Intl.Segmenter);return Object.defineProperty(wW,"SUPPORT_NATIVE_TEXT_SEGMENTATION",{value:e}),e}},xW=function(){return function(e,t){this.text=e,this.bounds=t}}(),_W=function(e,t){var n=t.ownerDocument;if(n){var r=n.createElement("html2canvaswrapper");r.appendChild(t.cloneNode(!0));var o=t.parentNode;if(o){o.replaceChild(r,t);var i=zj(e,r);return r.firstChild&&o.replaceChild(r.firstChild,r),i}}return Qj.EMPTY},CW=function(e,t,n){var r=e.ownerDocument;if(!r)throw new Error("Node has no owner document");var o=r.createRange();return o.setStart(e,t),o.setEnd(e,t+n),o},SW=function(e){if(wW.SUPPORT_NATIVE_TEXT_SEGMENTATION){var t=new Intl.Segmenter(void 0,{granularity:"grapheme"});return Array.from(t.segment(e)).map(function(e){return e.segment})}return function(e){for(var t,n=mW(e),r=[];!(t=n.next()).done;)t.value&&r.push(t.value.slice());return r}(e)},EW=function(e,t){return 0!==t.letterSpacing?SW(e):function(e,t){if(wW.SUPPORT_NATIVE_TEXT_SEGMENTATION){var n=new Intl.Segmenter(void 0,{granularity:"word"});return Array.from(n.segment(e)).map(function(e){return e.segment})}return IW(e,t)}(e,t)},BW=[32,160,4961,65792,65793,4153,4241],IW=function(e,t){for(var n,r=function(e,t){var n=Hj(e),r=XQ(n,t),o=r[0],i=r[1],s=r[2],a=n.length,l=0,c=0;return{next:function(){if(c>=a)return{done:!0,value:null};for(var e=UQ;c<a&&(e=KQ(n,i,o,++c,s))===UQ;);if(e!==UQ||c===a){var t=new YQ(n,e,l,c);return l=c,{value:t,done:!1}}return{done:!0,value:null}}}}(e,{lineBreak:t.lineBreak,wordBreak:"break-word"===t.overflowWrap?"break-word":t.wordBreak}),o=[],i=function(){if(n.value){var e=n.value.slice(),t=Hj(e),r="";t.forEach(function(e){-1===BW.indexOf(e)?r+=Gj(e):(r.length&&o.push(r),o.push(Gj(e)),r="")}),r.length&&o.push(r)}};!(n=r.next()).done;)i();return o},RW=function(){return function(e,t,n){this.text=kW(t.data,n.textTransform),this.textBounds=function(e,t,n,r){var o=EW(t,n),i=[],s=0;return o.forEach(function(t){if(n.textDecorationLine.length||t.trim().length>0)if(wW.SUPPORT_RANGE_BOUNDS){var o=CW(r,s,t.length).getClientRects();if(o.length>1){var a=SW(t),l=0;a.forEach(function(t){i.push(new xW(t,Qj.fromDOMRectList(e,CW(r,l+s,t.length).getClientRects()))),l+=t.length})}else i.push(new xW(t,Qj.fromDOMRectList(e,o)))}else{var c=r.splitText(t.length);i.push(new xW(t,_W(e,r))),r=c}else wW.SUPPORT_RANGE_BOUNDS||(r=r.splitText(t.length));s+=t.length}),i}(e,this.text,n,t)}}(),kW=function(e,t){switch(t){case 1:return e.toLowerCase();case 3:return e.replace(TW,PW);case 2:return e.toUpperCase();default:return e}},TW=/(^|\s|:|-|\(|\))([a-z])/g,PW=function(e,t,n){return e.length>0?t+n.toUpperCase():e},FW=function(e){function t(t,n){var r=e.call(this,t,n)||this;return r.src=n.currentSrc||n.src,r.intrinsicWidth=n.naturalWidth,r.intrinsicHeight=n.naturalHeight,r.context.cache.addImage(r.src),r}return Oj(t,e),t}(qV),MW=function(e){function t(t,n){var r=e.call(this,t,n)||this;return r.canvas=n,r.intrinsicWidth=n.width,r.intrinsicHeight=n.height,r}return Oj(t,e),t}(qV),LW=function(e){function t(t,n){var r=e.call(this,t,n)||this,o=new XMLSerializer,i=zj(t,n);return n.setAttribute("width","".concat(i.width,"px")),n.setAttribute("height","".concat(i.height,"px")),r.svg="data:image/svg+xml,".concat(encodeURIComponent(o.serializeToString(n))),r.intrinsicWidth=n.width.baseVal.value,r.intrinsicHeight=n.height.baseVal.value,r.context.cache.addImage(r.svg),r}return Oj(t,e),t}(qV),UW=function(e){function t(t,n){var r=e.call(this,t,n)||this;return r.value=n.value,r}return Oj(t,e),t}(qV),OW=function(e){function t(t,n){var r=e.call(this,t,n)||this;return r.start=n.start,r.reversed="boolean"==typeof n.reversed&&!0===n.reversed,r}return Oj(t,e),t}(qV),DW=[{type:15,flags:0,unit:"px",number:3}],NW=[{type:16,flags:0,number:50}],jW="checkbox",QW="radio",zW="password",HW=707406591,GW=function(e){function t(t,n){var r,o,i,s=e.call(this,t,n)||this;switch(s.type=n.type.toLowerCase(),s.checked=n.checked,s.value=0===(o=(r=n).type===zW?new Array(r.value.length+1).join(""):r.value).length?r.placeholder||"":o,s.type!==jW&&s.type!==QW||(s.styles.backgroundColor=3739148031,s.styles.borderTopColor=s.styles.borderRightColor=s.styles.borderBottomColor=s.styles.borderLeftColor=2779096575,s.styles.borderTopWidth=s.styles.borderRightWidth=s.styles.borderBottomWidth=s.styles.borderLeftWidth=1,s.styles.borderTopStyle=s.styles.borderRightStyle=s.styles.borderBottomStyle=s.styles.borderLeftStyle=1,s.styles.backgroundClip=[0],s.styles.backgroundOrigin=[0],s.bounds=(i=s.bounds).width>i.height?new Qj(i.left+(i.width-i.height)/2,i.top,i.height,i.height):i.width<i.height?new Qj(i.left,i.top+(i.height-i.width)/2,i.width,i.width):i),s.type){case jW:s.styles.borderTopRightRadius=s.styles.borderTopLeftRadius=s.styles.borderBottomRightRadius=s.styles.borderBottomLeftRadius=DW;break;case QW:s.styles.borderTopRightRadius=s.styles.borderTopLeftRadius=s.styles.borderBottomRightRadius=s.styles.borderBottomLeftRadius=NW}return s}return Oj(t,e),t}(qV),VW=function(e){function t(t,n){var r=e.call(this,t,n)||this,o=n.options[n.selectedIndex||0];return r.value=o&&o.text||"",r}return Oj(t,e),t}(qV),WW=function(e){function t(t,n){var r=e.call(this,t,n)||this;return r.value=n.value,r}return Oj(t,e),t}(qV),$W=function(e){function t(t,n){var r=e.call(this,t,n)||this;r.src=n.src,r.width=parseInt(n.width,10)||0,r.height=parseInt(n.height,10)||0,r.backgroundColor=r.styles.backgroundColor;try{if(n.contentWindow&&n.contentWindow.document&&n.contentWindow.document.documentElement){r.tree=qW(t,n.contentWindow.document.documentElement);var o=n.contentWindow.document.documentElement?QH(t,getComputedStyle(n.contentWindow.document.documentElement).backgroundColor):zH.TRANSPARENT,i=n.contentWindow.document.body?QH(t,getComputedStyle(n.contentWindow.document.body).backgroundColor):zH.TRANSPARENT;r.backgroundColor=nH(o)?nH(i)?r.styles.backgroundColor:i:o}}catch(SE){}return r}return Oj(t,e),t}(qV),KW=["OL","UL","MENU"],XW=function(e,t,n,r){for(var o=t.firstChild,i=void 0;o;o=i)if(i=o.nextSibling,e$(o)&&o.data.length>0)n.textNodes.push(new RW(e,o,n.styles));else if(t$(o))if(g$(o)&&o.assignedNodes)o.assignedNodes().forEach(function(t){return XW(e,t,n,r)});else{var s=YW(e,o);s.styles.isVisible()&&(JW(o,s,r)?s.flags|=4:ZW(s.styles)&&(s.flags|=2),-1!==KW.indexOf(o.tagName)&&(s.flags|=8),n.elements.push(s),o.slot,o.shadowRoot?XW(e,o.shadowRoot,s,r):p$(o)||a$(o)||f$(o)||XW(e,o,s,r))}},YW=function(e,t){return d$(t)?new FW(e,t):c$(t)?new MW(e,t):a$(t)?new LW(e,t):o$(t)?new UW(e,t):i$(t)?new OW(e,t):s$(t)?new GW(e,t):f$(t)?new VW(e,t):p$(t)?new WW(e,t):A$(t)?new $W(e,t):new qV(e,t)},qW=function(e,t){var n=YW(e,t);return n.flags|=4,XW(e,t,n,n),n},JW=function(e,t,n){return t.styles.isPositionedWithZIndex()||t.styles.opacity<1||t.styles.isTransformed()||l$(e)&&n.styles.isTransparent()},ZW=function(e){return e.isPositioned()||e.isFloating()},e$=function(e){return e.nodeType===Node.TEXT_NODE},t$=function(e){return e.nodeType===Node.ELEMENT_NODE},n$=function(e){return t$(e)&&void 0!==e.style&&!r$(e)},r$=function(e){return"object"==typeof e.className},o$=function(e){return"LI"===e.tagName},i$=function(e){return"OL"===e.tagName},s$=function(e){return"INPUT"===e.tagName},a$=function(e){return"svg"===e.tagName},l$=function(e){return"BODY"===e.tagName},c$=function(e){return"CANVAS"===e.tagName},u$=function(e){return"VIDEO"===e.tagName},d$=function(e){return"IMG"===e.tagName},A$=function(e){return"IFRAME"===e.tagName},h$=function(e){return"STYLE"===e.tagName},p$=function(e){return"TEXTAREA"===e.tagName},f$=function(e){return"SELECT"===e.tagName},g$=function(e){return"SLOT"===e.tagName},m$=function(e){return e.tagName.indexOf("-")>0},y$=function(){function e(){this.counters={}}return e.prototype.getCounterValue=function(e){var t=this.counters[e];return t&&t.length?t[t.length-1]:1},e.prototype.getCounterValues=function(e){var t=this.counters[e];return t||[]},e.prototype.pop=function(e){var t=this;e.forEach(function(e){return t.counters[e].pop()})},e.prototype.parse=function(e){var t=this,n=e.counterIncrement,r=e.counterReset,o=!0;null!==n&&n.forEach(function(e){var n=t.counters[e.counter];n&&0!==e.increment&&(o=!1,n.length||n.push(1),n[Math.max(0,n.length-1)]+=e.increment)});var i=[];return o&&r.forEach(function(e){var n=t.counters[e.counter];i.push(e.counter),n||(n=t.counters[e.counter]=[]),n.push(e.reset)}),i},e}(),v$={integers:[1e3,900,500,400,100,90,50,40,10,9,5,4,1],values:["M","CM","D","CD","C","XC","L","XL","X","IX","V","IV","I"]},b$={integers:[9e3,8e3,7e3,6e3,5e3,4e3,3e3,2e3,1e3,900,800,700,600,500,400,300,200,100,90,80,70,60,50,40,30,20,10,9,8,7,6,5,4,3,2,1],values:["","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""]},w$={integers:[1e4,9e3,8e3,7e3,6e3,5e3,4e3,3e3,2e3,1e3,400,300,200,100,90,80,70,60,50,40,30,20,19,18,17,16,15,10,9,8,7,6,5,4,3,2,1],values:["","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""]},x$={integers:[1e4,9e3,8e3,7e3,6e3,5e3,4e3,3e3,2e3,1e3,900,800,700,600,500,400,300,200,100,90,80,70,60,50,40,30,20,10,9,8,7,6,5,4,3,2,1],values:["","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""]},_$=function(e,t,n,r,o,i){return e<t||e>n?P$(e,o,i.length>0):r.integers.reduce(function(t,n,o){for(;e>=n;)e-=n,t+=r.values[o];return t},"")+i},C$=function(e,t,n,r){var o="";do{n||e--,o=r(e)+o,e/=t}while(e*t>=t);return o},S$=function(e,t,n,r,o){var i=n-t+1;return(e<0?"-":"")+(C$(Math.abs(e),i,r,function(e){return Gj(Math.floor(e%i)+t)})+o)},E$=function(e,t,n){void 0===n&&(n=". ");var r=t.length;return C$(Math.abs(e),r,!1,function(e){return t[Math.floor(e%r)]})+n},B$=function(e,t,n,r,o,i){if(e<-9999||e>9999)return P$(e,4,o.length>0);var s=Math.abs(e),a=o;if(0===s)return t[0]+a;for(var l=0;s>0&&l<=4;l++){var c=s%10;0===c&&FV(i,1)&&""!==a?a=t[c]+a:c>1||1===c&&0===l||1===c&&1===l&&FV(i,2)||1===c&&1===l&&FV(i,4)&&e>100||1===c&&l>1&&FV(i,8)?a=t[c]+(l>0?n[l-1]:"")+a:1===c&&l>0&&(a=n[l-1]+a),s=Math.floor(s/10)}return(e<0?r:"")+a},I$="",R$="",k$="",T$="",P$=function(e,t,n){var r=n?". ":"",o=n?"":"",i=n?", ":"",s=n?" ":"";switch(t){case 0:return""+s;case 1:return""+s;case 2:return""+s;case 5:var a=S$(e,48,57,!0,r);return a.length<4?"0".concat(a):a;case 4:return E$(e,"",o);case 6:return _$(e,1,3999,v$,3,r).toLowerCase();case 7:return _$(e,1,3999,v$,3,r);case 8:return S$(e,945,969,!1,r);case 9:return S$(e,97,122,!1,r);case 10:return S$(e,65,90,!1,r);case 11:return S$(e,1632,1641,!0,r);case 12:case 49:return _$(e,1,9999,b$,3,r);case 35:return _$(e,1,9999,b$,3,r).toLowerCase();case 13:return S$(e,2534,2543,!0,r);case 14:case 30:return S$(e,6112,6121,!0,r);case 15:return E$(e,"",o);case 16:return E$(e,"",o);case 17:case 48:return B$(e,"",I$,"",o,14);case 47:return B$(e,"",R$,"",o,15);case 42:return B$(e,"",I$,"",o,14);case 41:return B$(e,"",R$,"",o,15);case 26:return B$(e,"","",k$,o,0);case 25:return B$(e,"","",k$,o,7);case 31:return B$(e,"","",T$,i,7);case 33:return B$(e,"","",T$,i,0);case 32:return B$(e,"","",T$,i,7);case 18:return S$(e,2406,2415,!0,r);case 20:return _$(e,1,19999,x$,3,r);case 21:return S$(e,2790,2799,!0,r);case 22:return S$(e,2662,2671,!0,r);case 52:return _$(e,1,10999,w$,3,r);case 23:return E$(e,"");case 24:return E$(e,"");case 27:return S$(e,3302,3311,!0,r);case 28:return E$(e,"",o);case 29:return E$(e,"",o);case 34:return S$(e,3792,3801,!0,r);case 37:return S$(e,6160,6169,!0,r);case 38:return S$(e,4160,4169,!0,r);case 39:return S$(e,2918,2927,!0,r);case 40:return S$(e,1776,1785,!0,r);case 43:return S$(e,3046,3055,!0,r);case 44:return S$(e,3174,3183,!0,r);case 45:return S$(e,3664,3673,!0,r);case 46:return S$(e,3872,3881,!0,r);default:return S$(e,48,57,!0,r)}},F$="data-html2canvas-ignore",M$=function(){function e(e,t,n){if(this.context=e,this.options=n,this.scrolledElements=[],this.referenceElement=t,this.counters=new y$,this.quoteDepth=0,!t.ownerDocument)throw new Error("Cloned element does not have an owner document");this.documentElement=this.cloneNode(t.ownerDocument.documentElement,!1)}return e.prototype.toIFrame=function(e,t){var n=this,r=O$(e,t);if(!r.contentWindow)return Promise.reject("Unable to find iframe window");var o=e.defaultView.pageXOffset,i=e.defaultView.pageYOffset,s=r.contentWindow,a=s.document,l=j$(r).then(function(){return Nj(n,0,void 0,function(){var e,n;return jj(this,function(o){switch(o.label){case 0:return this.scrolledElements.forEach(V$),s&&(s.scrollTo(t.left,t.top),!/(iPad|iPhone|iPod)/g.test(navigator.userAgent)||s.scrollY===t.top&&s.scrollX===t.left||(this.context.logger.warn("Unable to restore scroll position for cloned document"),this.context.windowBounds=this.context.windowBounds.add(s.scrollX-t.left,s.scrollY-t.top,0,0))),e=this.options.onclone,void 0===(n=this.clonedReferenceElement)?[2,Promise.reject("Error finding the ".concat(this.referenceElement.nodeName," in the cloned document"))]:a.fonts&&a.fonts.ready?[4,a.fonts.ready]:[3,2];case 1:o.sent(),o.label=2;case 2:return/(AppleWebKit)/g.test(navigator.userAgent)?[4,N$(a)]:[3,4];case 3:o.sent(),o.label=4;case 4:return"function"==typeof e?[2,Promise.resolve().then(function(){return e(a,n)}).then(function(){return r})]:[2,r]}})})}),c=a.baseURI;a.open(),a.write("".concat(H$(document.doctype),"<html></html>")),G$(this.referenceElement.ownerDocument,o,i);var u=a.adoptNode(this.documentElement);return q$(u,c),a.replaceChild(u,a.documentElement),a.close(),l},e.prototype.createElementClone=function(e){if(YV(e,2),c$(e))return this.createCanvasClone(e);if(u$(e))return this.createVideoClone(e);if(h$(e))return this.createStyleClone(e);var t=e.cloneNode(!1);return d$(t)&&(d$(e)&&e.currentSrc&&e.currentSrc!==e.src&&(t.src=e.currentSrc,t.srcset=""),"lazy"===t.loading&&(t.loading="eager")),m$(t)?this.createCustomElementClone(t):t},e.prototype.createCustomElementClone=function(e){var t=document.createElement("html2canvascustomelement");return z$(e.style,t),t},e.prototype.createStyleClone=function(e){try{var t=e.sheet;if(t&&t.cssRules){var n=[].slice.call(t.cssRules,0).reduce(function(e,t){return t&&"string"==typeof t.cssText?e+t.cssText:e},""),r=e.cloneNode(!1);return r.textContent=n,r}}catch(SE){if(this.context.logger.error("Unable to access cssRules property",SE),"SecurityError"!==SE.name)throw SE}return e.cloneNode(!1)},e.prototype.createCanvasClone=function(e){var t;if(this.options.inlineImages&&e.ownerDocument){var n=e.ownerDocument.createElement("img");try{return n.src=e.toDataURL(),n}catch(SE){this.context.logger.info("Unable to inline canvas contents, canvas is tainted",e)}}var r=e.cloneNode(!1);try{r.width=e.width,r.height=e.height;var o=e.getContext("2d"),i=r.getContext("2d",{willReadFrequently:!0});if(i)if(!this.options.allowTaint&&o)i.putImageData(o.getImageData(0,0,e.width,e.height),0,0);else{var s=null!==(t=e.getContext("webgl2"))&&void 0!==t?t:e.getContext("webgl");if(s){var a=s.getContextAttributes();!1===(null==a?void 0:a.preserveDrawingBuffer)&&this.context.logger.warn("Unable to clone WebGL context as it has preserveDrawingBuffer=false",e)}i.drawImage(e,0,0)}return r}catch(SE){this.context.logger.info("Unable to clone canvas as it is tainted",e)}return r},e.prototype.createVideoClone=function(e){var t=e.ownerDocument.createElement("canvas");t.width=e.offsetWidth,t.height=e.offsetHeight;var n=t.getContext("2d");try{return n&&(n.drawImage(e,0,0,t.width,t.height),this.options.allowTaint||n.getImageData(0,0,t.width,t.height)),t}catch(SE){this.context.logger.info("Unable to clone video as it is tainted",e)}var r=e.ownerDocument.createElement("canvas");return r.width=e.offsetWidth,r.height=e.offsetHeight,r},e.prototype.appendChildNode=function(e,t,n){t$(t)&&("SCRIPT"===t.tagName||t.hasAttribute(F$)||"function"==typeof this.options.ignoreElements&&this.options.ignoreElements(t))||this.options.copyStyles&&t$(t)&&h$(t)||e.appendChild(this.cloneNode(t,n))},e.prototype.cloneChildNodes=function(e,t,n){for(var r=this,o=e.shadowRoot?e.shadowRoot.firstChild:e.firstChild;o;o=o.nextSibling)if(t$(o)&&g$(o)&&"function"==typeof o.assignedNodes){var i=o.assignedNodes();i.length&&i.forEach(function(e){return r.appendChildNode(t,e,n)})}else this.appendChildNode(t,o,n)},e.prototype.cloneNode=function(e,t){if(e$(e))return document.createTextNode(e.data);if(!e.ownerDocument)return e.cloneNode(!1);var n=e.ownerDocument.defaultView;if(n&&t$(e)&&(n$(e)||r$(e))){var r=this.createElementClone(e);r.style.transitionProperty="none";var o=n.getComputedStyle(e),i=n.getComputedStyle(e,":before"),s=n.getComputedStyle(e,":after");this.referenceElement===e&&n$(r)&&(this.clonedReferenceElement=r),l$(r)&&X$(r);var a=this.counters.parse(new KV(this.context,o)),l=this.resolvePseudoContent(e,r,i,sW.BEFORE);m$(e)&&(t=!0),u$(e)||this.cloneChildNodes(e,r,t),l&&r.insertBefore(l,r.firstChild);var c=this.resolvePseudoContent(e,r,s,sW.AFTER);return c&&r.appendChild(c),this.counters.pop(a),(o&&(this.options.copyStyles||r$(e))&&!A$(e)||t)&&z$(o,r),0===e.scrollTop&&0===e.scrollLeft||this.scrolledElements.push([r,e.scrollLeft,e.scrollTop]),(p$(e)||f$(e))&&(p$(r)||f$(r))&&(r.value=e.value),r}return e.cloneNode(!1)},e.prototype.resolvePseudoContent=function(e,t,n,r){var o=this;if(n){var i=n.content,s=t.ownerDocument;if(s&&i&&"none"!==i&&"-moz-alt-content"!==i&&"none"!==n.display){this.counters.parse(new KV(this.context,n));var a=new $V(this.context,n),l=s.createElement("html2canvaspseudoelement");z$(n,l),a.content.forEach(function(t){if(0===t.type)l.appendChild(s.createTextNode(t.value));else if(22===t.type){var n=s.createElement("img");n.src=t.value,n.style.opacity="1",l.appendChild(n)}else if(18===t.type){if("attr"===t.name){var r=t.values.filter(Lz);r.length&&l.appendChild(s.createTextNode(e.getAttribute(r[0].value)||""))}else if("counter"===t.name){var i=t.values.filter(Nz),c=i[0],u=i[1];if(c&&Lz(c)){var d=o.counters.getCounterValue(c.value),A=u&&Lz(u)?JG.parse(o.context,u.value):3;l.appendChild(s.createTextNode(P$(d,A,!1)))}}else if("counters"===t.name){var h=t.values.filter(Nz),p=(c=h[0],h[1]);u=h[2];if(c&&Lz(c)){var f=o.counters.getCounterValues(c.value),g=u&&Lz(u)?JG.parse(o.context,u.value):3,m=p&&0===p.type?p.value:"",y=f.map(function(e){return P$(e,g,!1)}).join(m);l.appendChild(s.createTextNode(y))}}}else if(20===t.type)switch(t.value){case"open-quote":l.appendChild(s.createTextNode(NV(a.quotes,o.quoteDepth++,!0)));break;case"close-quote":l.appendChild(s.createTextNode(NV(a.quotes,--o.quoteDepth,!1)));break;default:l.appendChild(s.createTextNode(t.value))}}),l.className="".concat(W$," ").concat($$);var c=r===sW.BEFORE?" ".concat(W$):" ".concat($$);return r$(t)?t.className.baseValue+=c:t.className+=c,l}}},e.destroy=function(e){return!!e.parentNode&&(e.parentNode.removeChild(e),!0)},e}();(aW=sW||(sW={}))[aW.BEFORE=0]="BEFORE",aW[aW.AFTER=1]="AFTER";var L$,U$,O$=function(e,t){var n=e.createElement("iframe");return n.className="html2canvas-container",n.style.visibility="hidden",n.style.position="fixed",n.style.left="-10000px",n.style.top="0px",n.style.border="0",n.width=t.width.toString(),n.height=t.height.toString(),n.scrolling="no",n.setAttribute(F$,"true"),e.body.appendChild(n),n},D$=function(e){return new Promise(function(t){e.complete?t():e.src?(e.onload=t,e.onerror=t):t()})},N$=function(e){return Promise.all([].slice.call(e.images,0).map(D$))},j$=function(e){return new Promise(function(t,n){var r=e.contentWindow;if(!r)return n("No window assigned for iframe");var o=r.document;r.onload=e.onload=function(){r.onload=e.onload=null;var n=setInterval(function(){o.body.childNodes.length>0&&"complete"===o.readyState&&(clearInterval(n),t(e))},50)}})},Q$=["all","d","content"],z$=function(e,t){for(var n=e.length-1;n>=0;n--){var r=e.item(n);-1!==Q$.indexOf(r)||r.startsWith("--")||t.style.setProperty(r,e.getPropertyValue(r))}return t},H$=function(e){var t="";return e&&(t+="<!DOCTYPE ",e.name&&(t+=e.name),e.internalSubset&&(t+=e.internalSubset),e.publicId&&(t+='"'.concat(e.publicId,'"')),e.systemId&&(t+='"'.concat(e.systemId,'"')),t+=">"),t},G$=function(e,t,n){e&&e.defaultView&&(t!==e.defaultView.pageXOffset||n!==e.defaultView.pageYOffset)&&e.defaultView.scrollTo(t,n)},V$=function(e){var t=e[0],n=e[1],r=e[2];t.scrollLeft=n,t.scrollTop=r},W$="___html2canvas___pseudoelement_before",$$="___html2canvas___pseudoelement_after",K$='{\n    content: "" !important;\n    display: none !important;\n}',X$=function(e){Y$(e,".".concat(W$).concat(":before").concat(K$,"\n         .").concat($$).concat(":after").concat(K$))},Y$=function(e,t){var n=e.ownerDocument;if(n){var r=n.createElement("style");r.textContent=t,e.appendChild(r)}},q$=function(e,t){var n,r=e.ownerDocument.createElement("base");r.href=t;var o=e.getElementsByTagName("head").item(0);null==o||o.insertBefore(r,null!==(n=null==o?void 0:o.firstChild)&&void 0!==n?n:null)},J$=function(){function e(){}return e.getOrigin=function(t){var n=e._link;return n?(n.href=t,n.href=n.href,n.protocol+n.hostname+n.port):"about:blank"},e.isSameOrigin=function(t){return e.getOrigin(t)===e._origin},e.setContext=function(t){e._link=t.document.createElement("a"),e._origin=e.getOrigin(t.location.href)},e._origin="about:blank",e}(),Z$=function(){function e(e,t){this.context=e,this._options=t,this._cache={}}return e.prototype.addImage=function(e){var t=Promise.resolve();return this.has(e)?t:sK(e)||rK(e)?((this._cache[e]=this.loadImage(e)).catch(function(){}),t):t},e.prototype.match=function(e){return this._cache[e]},e.prototype.loadImage=function(e){return Nj(this,0,void 0,function(){var t,n,r,o,i,s=this;return jj(this,function(a){switch(a.label){case 0:return"function"!=typeof this._options.customIsSameOrigin?[3,2]:[4,this._options.customIsSameOrigin(e,J$.isSameOrigin)];case 1:return n=a.sent(),[3,3];case 2:n=J$.isSameOrigin(e),a.label=3;case 3:return t=n,r=!oK(e)&&!0===this._options.useCORS&&wW.SUPPORT_CORS_IMAGES&&!t,o=!oK(e)&&!t&&!sK(e)&&"string"==typeof this._options.proxy&&wW.SUPPORT_CORS_XHR&&!r,t||!1!==this._options.allowTaint||oK(e)||sK(e)||o||r?(i=e,o?[4,this.proxy(i)]:[3,5]):[2];case 4:i=a.sent(),a.label=5;case 5:return this.context.logger.debug("Added image ".concat(e.substring(0,256))),[4,new Promise(function(e,t){var n=new Image;n.onload=function(){return e(n)},n.onerror=t,(iK(i)||r)&&(n.crossOrigin="anonymous"),n.src=i,!0===n.complete&&setTimeout(function(){return e(n)},500),s._options.imageTimeout>0&&setTimeout(function(){return t("Timed out (".concat(s._options.imageTimeout,"ms) loading image"))},s._options.imageTimeout)})];case 6:return[2,a.sent()]}})})},e.prototype.has=function(e){return void 0!==this._cache[e]},e.prototype.keys=function(){return Promise.resolve(Object.keys(this._cache))},e.prototype.proxy=function(e){var t=this,n=this._options.proxy;if(!n)throw new Error("No proxy defined");var r=e.substring(0,256);return new Promise(function(o,i){var s=wW.SUPPORT_RESPONSE_TYPE?"blob":"text",a=new XMLHttpRequest;a.onload=function(){if(200===a.status)if("text"===s)o(a.response);else{var e=new FileReader;e.addEventListener("load",function(){return o(e.result)},!1),e.addEventListener("error",function(e){return i(e)},!1),e.readAsDataURL(a.response)}else i("Failed to proxy resource ".concat(r," with status code ").concat(a.status))},a.onerror=i;var l=n.indexOf("?")>-1?"&":"?";if(a.open("GET","".concat(n).concat(l,"url=").concat(encodeURIComponent(e),"&responseType=").concat(s)),"text"!==s&&a instanceof XMLHttpRequest&&(a.responseType=s),t._options.imageTimeout){var c=t._options.imageTimeout;a.timeout=c,a.ontimeout=function(){return i("Timed out (".concat(c,"ms) proxying ").concat(r))}}a.send()})},e}(),eK=/^data:image\/svg\+xml/i,tK=/^data:image\/.*;base64,/i,nK=/^data:image\/.*/i,rK=function(e){return wW.SUPPORT_SVG_DRAWING||!aK(e)},oK=function(e){return nK.test(e)},iK=function(e){return tK.test(e)},sK=function(e){return"blob"===e.substr(0,4)},aK=function(e){return"svg"===e.substr(-3).toLowerCase()||eK.test(e)},lK=function(){function e(e,t){this.type=0,this.x=e,this.y=t}return e.prototype.add=function(t,n){return new e(this.x+t,this.y+n)},e}(),cK=function(e,t,n){return new lK(e.x+(t.x-e.x)*n,e.y+(t.y-e.y)*n)},uK=function(){function e(e,t,n,r){this.type=1,this.start=e,this.startControl=t,this.endControl=n,this.end=r}return e.prototype.subdivide=function(t,n){var r=cK(this.start,this.startControl,t),o=cK(this.startControl,this.endControl,t),i=cK(this.endControl,this.end,t),s=cK(r,o,t),a=cK(o,i,t),l=cK(s,a,t);return n?new e(this.start,r,s,l):new e(l,a,i,this.end)},e.prototype.add=function(t,n){return new e(this.start.add(t,n),this.startControl.add(t,n),this.endControl.add(t,n),this.end.add(t,n))},e.prototype.reverse=function(){return new e(this.end,this.endControl,this.startControl,this.start)},e}(),dK=function(e){return 1===e.type},AK=function(){return function(e){var t=e.styles,n=e.bounds,r=Kz(t.borderTopLeftRadius,n.width,n.height),o=r[0],i=r[1],s=Kz(t.borderTopRightRadius,n.width,n.height),a=s[0],l=s[1],c=Kz(t.borderBottomRightRadius,n.width,n.height),u=c[0],d=c[1],A=Kz(t.borderBottomLeftRadius,n.width,n.height),h=A[0],p=A[1],f=[];f.push((o+a)/n.width),f.push((h+u)/n.width),f.push((i+p)/n.height),f.push((l+d)/n.height);var g=Math.max.apply(Math,f);g>1&&(o/=g,i/=g,a/=g,l/=g,u/=g,d/=g,h/=g,p/=g);var m=n.width-a,y=n.height-d,v=n.width-u,b=n.height-p,w=t.borderTopWidth,x=t.borderRightWidth,_=t.borderBottomWidth,C=t.borderLeftWidth,S=Xz(t.paddingTop,e.bounds.width),E=Xz(t.paddingRight,e.bounds.width),B=Xz(t.paddingBottom,e.bounds.width),I=Xz(t.paddingLeft,e.bounds.width);this.topLeftBorderDoubleOuterBox=o>0||i>0?hK(n.left+C/3,n.top+w/3,o-C/3,i-w/3,L$.TOP_LEFT):new lK(n.left+C/3,n.top+w/3),this.topRightBorderDoubleOuterBox=o>0||i>0?hK(n.left+m,n.top+w/3,a-x/3,l-w/3,L$.TOP_RIGHT):new lK(n.left+n.width-x/3,n.top+w/3),this.bottomRightBorderDoubleOuterBox=u>0||d>0?hK(n.left+v,n.top+y,u-x/3,d-_/3,L$.BOTTOM_RIGHT):new lK(n.left+n.width-x/3,n.top+n.height-_/3),this.bottomLeftBorderDoubleOuterBox=h>0||p>0?hK(n.left+C/3,n.top+b,h-C/3,p-_/3,L$.BOTTOM_LEFT):new lK(n.left+C/3,n.top+n.height-_/3),this.topLeftBorderDoubleInnerBox=o>0||i>0?hK(n.left+2*C/3,n.top+2*w/3,o-2*C/3,i-2*w/3,L$.TOP_LEFT):new lK(n.left+2*C/3,n.top+2*w/3),this.topRightBorderDoubleInnerBox=o>0||i>0?hK(n.left+m,n.top+2*w/3,a-2*x/3,l-2*w/3,L$.TOP_RIGHT):new lK(n.left+n.width-2*x/3,n.top+2*w/3),this.bottomRightBorderDoubleInnerBox=u>0||d>0?hK(n.left+v,n.top+y,u-2*x/3,d-2*_/3,L$.BOTTOM_RIGHT):new lK(n.left+n.width-2*x/3,n.top+n.height-2*_/3),this.bottomLeftBorderDoubleInnerBox=h>0||p>0?hK(n.left+2*C/3,n.top+b,h-2*C/3,p-2*_/3,L$.BOTTOM_LEFT):new lK(n.left+2*C/3,n.top+n.height-2*_/3),this.topLeftBorderStroke=o>0||i>0?hK(n.left+C/2,n.top+w/2,o-C/2,i-w/2,L$.TOP_LEFT):new lK(n.left+C/2,n.top+w/2),this.topRightBorderStroke=o>0||i>0?hK(n.left+m,n.top+w/2,a-x/2,l-w/2,L$.TOP_RIGHT):new lK(n.left+n.width-x/2,n.top+w/2),this.bottomRightBorderStroke=u>0||d>0?hK(n.left+v,n.top+y,u-x/2,d-_/2,L$.BOTTOM_RIGHT):new lK(n.left+n.width-x/2,n.top+n.height-_/2),this.bottomLeftBorderStroke=h>0||p>0?hK(n.left+C/2,n.top+b,h-C/2,p-_/2,L$.BOTTOM_LEFT):new lK(n.left+C/2,n.top+n.height-_/2),this.topLeftBorderBox=o>0||i>0?hK(n.left,n.top,o,i,L$.TOP_LEFT):new lK(n.left,n.top),this.topRightBorderBox=a>0||l>0?hK(n.left+m,n.top,a,l,L$.TOP_RIGHT):new lK(n.left+n.width,n.top),this.bottomRightBorderBox=u>0||d>0?hK(n.left+v,n.top+y,u,d,L$.BOTTOM_RIGHT):new lK(n.left+n.width,n.top+n.height),this.bottomLeftBorderBox=h>0||p>0?hK(n.left,n.top+b,h,p,L$.BOTTOM_LEFT):new lK(n.left,n.top+n.height),this.topLeftPaddingBox=o>0||i>0?hK(n.left+C,n.top+w,Math.max(0,o-C),Math.max(0,i-w),L$.TOP_LEFT):new lK(n.left+C,n.top+w),this.topRightPaddingBox=a>0||l>0?hK(n.left+Math.min(m,n.width-x),n.top+w,m>n.width+x?0:Math.max(0,a-x),Math.max(0,l-w),L$.TOP_RIGHT):new lK(n.left+n.width-x,n.top+w),this.bottomRightPaddingBox=u>0||d>0?hK(n.left+Math.min(v,n.width-C),n.top+Math.min(y,n.height-_),Math.max(0,u-x),Math.max(0,d-_),L$.BOTTOM_RIGHT):new lK(n.left+n.width-x,n.top+n.height-_),this.bottomLeftPaddingBox=h>0||p>0?hK(n.left+C,n.top+Math.min(b,n.height-_),Math.max(0,h-C),Math.max(0,p-_),L$.BOTTOM_LEFT):new lK(n.left+C,n.top+n.height-_),this.topLeftContentBox=o>0||i>0?hK(n.left+C+I,n.top+w+S,Math.max(0,o-(C+I)),Math.max(0,i-(w+S)),L$.TOP_LEFT):new lK(n.left+C+I,n.top+w+S),this.topRightContentBox=a>0||l>0?hK(n.left+Math.min(m,n.width+C+I),n.top+w+S,m>n.width+C+I?0:a-C+I,l-(w+S),L$.TOP_RIGHT):new lK(n.left+n.width-(x+E),n.top+w+S),this.bottomRightContentBox=u>0||d>0?hK(n.left+Math.min(v,n.width-(C+I)),n.top+Math.min(y,n.height+w+S),Math.max(0,u-(x+E)),d-(_+B),L$.BOTTOM_RIGHT):new lK(n.left+n.width-(x+E),n.top+n.height-(_+B)),this.bottomLeftContentBox=h>0||p>0?hK(n.left+C+I,n.top+b,Math.max(0,h-(C+I)),p-(_+B),L$.BOTTOM_LEFT):new lK(n.left+C+I,n.top+n.height-(_+B))}}();(U$=L$||(L$={}))[U$.TOP_LEFT=0]="TOP_LEFT",U$[U$.TOP_RIGHT=1]="TOP_RIGHT",U$[U$.BOTTOM_RIGHT=2]="BOTTOM_RIGHT",U$[U$.BOTTOM_LEFT=3]="BOTTOM_LEFT";var hK=function(e,t,n,r,o){var i=(Math.sqrt(2)-1)/3*4,s=n*i,a=r*i,l=e+n,c=t+r;switch(o){case L$.TOP_LEFT:return new uK(new lK(e,c),new lK(e,c-a),new lK(l-s,t),new lK(l,t));case L$.TOP_RIGHT:return new uK(new lK(e,t),new lK(e+s,t),new lK(l,c-a),new lK(l,c));case L$.BOTTOM_RIGHT:return new uK(new lK(l,t),new lK(l,t+a),new lK(e+s,c),new lK(e,c));case L$.BOTTOM_LEFT:default:return new uK(new lK(l,c),new lK(l-s,c),new lK(e,t+a),new lK(e,t))}},pK=function(e){return[e.topLeftBorderBox,e.topRightBorderBox,e.bottomRightBorderBox,e.bottomLeftBorderBox]},fK=function(e){return[e.topLeftPaddingBox,e.topRightPaddingBox,e.bottomRightPaddingBox,e.bottomLeftPaddingBox]},gK=function(){return function(e,t,n){this.offsetX=e,this.offsetY=t,this.matrix=n,this.type=0,this.target=6}}(),mK=function(){return function(e,t){this.path=e,this.target=t,this.type=1}}(),yK=function(){return function(e){this.opacity=e,this.type=2,this.target=6}}(),vK=function(e){return 1===e.type},bK=function(e,t){return e.length===t.length&&e.some(function(e,n){return e===t[n]})},wK=function(){return function(e){this.element=e,this.inlineLevel=[],this.nonInlineLevel=[],this.negativeZIndex=[],this.zeroOrAutoZIndexOrTransformedOrOpacity=[],this.positiveZIndex=[],this.nonPositionedFloats=[],this.nonPositionedInlineLevel=[]}}(),xK=function(){function e(e,t){if(this.container=e,this.parent=t,this.effects=[],this.curves=new AK(this.container),this.container.styles.opacity<1&&this.effects.push(new yK(this.container.styles.opacity)),null!==this.container.styles.rotate){var n=this.container.bounds.left+this.container.styles.transformOrigin[0].number,r=this.container.bounds.top+this.container.styles.transformOrigin[1].number,o=this.container.styles.rotate*Math.PI/180,i=Math.cos(o),s=Math.sin(o),a=[i,s,-s,i,0,0];this.effects.push(new gK(n,r,a))}if(null!==this.container.styles.transform){n=this.container.bounds.left+this.container.styles.transformOrigin[0].number,r=this.container.bounds.top+this.container.styles.transformOrigin[1].number;var l=this.container.styles.transform;this.effects.push(new gK(n,r,l))}if(0!==this.container.styles.overflowX){var c=pK(this.curves),u=fK(this.curves);bK(c,u)?this.effects.push(new mK(c,6)):(this.effects.push(new mK(c,2)),this.effects.push(new mK(u,4)))}}return e.prototype.getEffects=function(e){for(var t=-1===[2,3].indexOf(this.container.styles.position),n=this.parent,r=this.effects.slice(0);n;){var o=n.effects.filter(function(e){return!vK(e)});if(t||0!==n.container.styles.position||!n.parent){if(t=-1===[2,3].indexOf(n.container.styles.position),0!==n.container.styles.overflowX){var i=pK(n.curves),s=fK(n.curves);bK(i,s)||r.unshift(new mK(s,6))}r.unshift.apply(r,o)}else r.unshift.apply(r,o);n=n.parent}return r.filter(function(t){return FV(t.target,e)})},e}(),_K=function(e,t,n,r){e.container.elements.forEach(function(o){var i=FV(o.flags,4),s=FV(o.flags,2),a=new xK(o,e);FV(o.styles.display,2048)&&r.push(a);var l=FV(o.flags,8)?[]:r;if(i||s){var c=i||o.styles.isPositioned()?n:t,u=new wK(a);if(o.styles.isPositioned()||o.styles.opacity<1||o.styles.isTransformed()){var d=o.styles.zIndex.order;if(d<0){var A=0;c.negativeZIndex.some(function(e,t){return d>e.element.container.styles.zIndex.order?(A=t,!1):A>0}),c.negativeZIndex.splice(A,0,u)}else if(d>0){var h=0;c.positiveZIndex.some(function(e,t){return d>=e.element.container.styles.zIndex.order?(h=t+1,!1):h>0}),c.positiveZIndex.splice(h,0,u)}else c.zeroOrAutoZIndexOrTransformedOrOpacity.push(u)}else o.styles.isFloating()?c.nonPositionedFloats.push(u):c.nonPositionedInlineLevel.push(u);_K(a,u,i?u:n,l)}else o.styles.isInlineLevel()?t.inlineLevel.push(a):t.nonInlineLevel.push(a),_K(a,t,n,l);FV(o.flags,8)&&CK(o,l)})},CK=function(e,t){for(var n=e instanceof OW?e.start:1,r=e instanceof OW&&e.reversed,o=0;o<t.length;o++){var i=t[o];i.container instanceof UW&&"number"==typeof i.container.value&&0!==i.container.value&&(n=i.container.value),i.listValue=P$(n,i.container.styles.listStyleType,!0),n+=r?-1:1}},SK=function(e,t){switch(t){case 0:return BK(e.topLeftBorderBox,e.topLeftPaddingBox,e.topRightBorderBox,e.topRightPaddingBox);case 1:return BK(e.topRightBorderBox,e.topRightPaddingBox,e.bottomRightBorderBox,e.bottomRightPaddingBox);case 2:return BK(e.bottomRightBorderBox,e.bottomRightPaddingBox,e.bottomLeftBorderBox,e.bottomLeftPaddingBox);default:return BK(e.bottomLeftBorderBox,e.bottomLeftPaddingBox,e.topLeftBorderBox,e.topLeftPaddingBox)}},EK=function(e,t){var n=[];return dK(e)?n.push(e.subdivide(.5,!1)):n.push(e),dK(t)?n.push(t.subdivide(.5,!0)):n.push(t),n},BK=function(e,t,n,r){var o=[];return dK(e)?o.push(e.subdivide(.5,!1)):o.push(e),dK(n)?o.push(n.subdivide(.5,!0)):o.push(n),dK(r)?o.push(r.subdivide(.5,!0).reverse()):o.push(r),dK(t)?o.push(t.subdivide(.5,!1).reverse()):o.push(t),o},IK=function(e){var t=e.bounds,n=e.styles;return t.add(n.borderLeftWidth,n.borderTopWidth,-(n.borderRightWidth+n.borderLeftWidth),-(n.borderTopWidth+n.borderBottomWidth))},RK=function(e){var t=e.styles,n=e.bounds,r=Xz(t.paddingLeft,n.width),o=Xz(t.paddingRight,n.width),i=Xz(t.paddingTop,n.width),s=Xz(t.paddingBottom,n.width);return n.add(r+t.borderLeftWidth,i+t.borderTopWidth,-(t.borderRightWidth+t.borderLeftWidth+r+o),-(t.borderTopWidth+t.borderBottomWidth+i+s))},kK=function(e,t,n){var r,o,i=(r=MK(e.styles.backgroundOrigin,t),o=e,0===r?o.bounds:2===r?RK(o):IK(o)),s=function(e,t){return 0===e?t.bounds:2===e?RK(t):IK(t)}(MK(e.styles.backgroundClip,t),e),a=FK(MK(e.styles.backgroundSize,t),n,i),l=a[0],c=a[1],u=Kz(MK(e.styles.backgroundPosition,t),i.width-l,i.height-c);return[LK(MK(e.styles.backgroundRepeat,t),u,a,i,s),Math.round(i.left+u[0]),Math.round(i.top+u[1]),l=Math.max(1,l),c=Math.max(1,c)]},TK=function(e){return Lz(e)&&e.value===aG.AUTO},PK=function(e){return"number"==typeof e},FK=function(e,t,n){var r=t[0],o=t[1],i=t[2],s=e[0],a=e[1];if(!s)return[0,0];if(Hz(s)&&a&&Hz(a))return[Xz(s,n.width),Xz(a,n.height)];var l=PK(i);if(Lz(s)&&(s.value===aG.CONTAIN||s.value===aG.COVER))return PK(i)?n.width/n.height<i!=(s.value===aG.COVER)?[n.width,n.width/i]:[n.height*i,n.height]:[n.width,n.height];var c=PK(r),u=PK(o),d=c||u;if(TK(s)&&(!a||TK(a)))return c&&u?[r,o]:l||d?d&&l?[c?r:o*i,u?o:r/i]:[c?r:n.width,u?o:n.height]:[n.width,n.height];if(l){var A=0,h=0;return Hz(s)?A=Xz(s,n.width):Hz(a)&&(h=Xz(a,n.height)),TK(s)?A=h*i:a&&!TK(a)||(h=A/i),[A,h]}var p=null,f=null;if(Hz(s)?p=Xz(s,n.width):a&&Hz(a)&&(f=Xz(a,n.height)),null===p||a&&!TK(a)||(f=c&&u?p/r*o:n.height),null!==f&&TK(s)&&(p=c&&u?f/o*r:n.width),null!==p&&null!==f)return[p,f];throw new Error("Unable to calculate background-size for element")},MK=function(e,t){var n=e[t];return void 0===n?e[0]:n},LK=function(e,t,n,r,o){var i=t[0],s=t[1],a=n[0],l=n[1];switch(e){case 2:return[new lK(Math.round(r.left),Math.round(r.top+s)),new lK(Math.round(r.left+r.width),Math.round(r.top+s)),new lK(Math.round(r.left+r.width),Math.round(l+r.top+s)),new lK(Math.round(r.left),Math.round(l+r.top+s))];case 3:return[new lK(Math.round(r.left+i),Math.round(r.top)),new lK(Math.round(r.left+i+a),Math.round(r.top)),new lK(Math.round(r.left+i+a),Math.round(r.height+r.top)),new lK(Math.round(r.left+i),Math.round(r.height+r.top))];case 1:return[new lK(Math.round(r.left+i),Math.round(r.top+s)),new lK(Math.round(r.left+i+a),Math.round(r.top+s)),new lK(Math.round(r.left+i+a),Math.round(r.top+s+l)),new lK(Math.round(r.left+i),Math.round(r.top+s+l))];default:return[new lK(Math.round(o.left),Math.round(o.top)),new lK(Math.round(o.left+o.width),Math.round(o.top)),new lK(Math.round(o.left+o.width),Math.round(o.height+o.top)),new lK(Math.round(o.left),Math.round(o.height+o.top))]}},UK="Hidden Text",OK=function(){function e(e){this._data={},this._document=e}return e.prototype.parseMetrics=function(e,t){var n=this._document.createElement("div"),r=this._document.createElement("img"),o=this._document.createElement("span"),i=this._document.body;n.style.visibility="hidden",n.style.fontFamily=e,n.style.fontSize=t,n.style.margin="0",n.style.padding="0",n.style.whiteSpace="nowrap",i.appendChild(n),r.src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",r.width=1,r.height=1,r.style.margin="0",r.style.padding="0",r.style.verticalAlign="baseline",o.style.fontFamily=e,o.style.fontSize=t,o.style.margin="0",o.style.padding="0",o.appendChild(this._document.createTextNode(UK)),n.appendChild(o),n.appendChild(r);var s=r.offsetTop-o.offsetTop+2;n.removeChild(o),n.appendChild(this._document.createTextNode(UK)),n.style.lineHeight="normal",r.style.verticalAlign="super";var a=r.offsetTop-n.offsetTop+2;return i.removeChild(n),{baseline:s,middle:a}},e.prototype.getMetrics=function(e,t){var n="".concat(e," ").concat(t);return void 0===this._data[n]&&(this._data[n]=this.parseMetrics(e,t)),this._data[n]},e}(),DK=function(){return function(e,t){this.context=e,this.options=t}}(),NK=function(e){function t(t,n){var r=e.call(this,t,n)||this;return r._activeEffects=[],r.canvas=n.canvas?n.canvas:document.createElement("canvas"),r.ctx=r.canvas.getContext("2d"),n.canvas||(r.canvas.width=Math.floor(n.width*n.scale),r.canvas.height=Math.floor(n.height*n.scale),r.canvas.style.width="".concat(n.width,"px"),r.canvas.style.height="".concat(n.height,"px")),r.fontMetrics=new OK(document),r.ctx.scale(r.options.scale,r.options.scale),r.ctx.translate(-n.x,-n.y),r.ctx.textBaseline="bottom",r._activeEffects=[],r.context.logger.debug("Canvas renderer initialized (".concat(n.width,"x").concat(n.height,") with scale ").concat(n.scale)),r}return Oj(t,e),t.prototype.applyEffects=function(e){for(var t=this;this._activeEffects.length;)this.popEffect();e.forEach(function(e){return t.applyEffect(e)})},t.prototype.applyEffect=function(e){this.ctx.save(),function(e){return 2===e.type}(e)&&(this.ctx.globalAlpha=e.opacity),function(e){return 0===e.type}(e)&&(this.ctx.translate(e.offsetX,e.offsetY),this.ctx.transform(e.matrix[0],e.matrix[1],e.matrix[2],e.matrix[3],e.matrix[4],e.matrix[5]),this.ctx.translate(-e.offsetX,-e.offsetY)),vK(e)&&(this.path(e.path),this.ctx.clip()),this._activeEffects.push(e)},t.prototype.popEffect=function(){this._activeEffects.pop(),this.ctx.restore()},t.prototype.renderStack=function(e){return Nj(this,0,void 0,function(){return jj(this,function(t){switch(t.label){case 0:return e.element.container.styles.isVisible()?[4,this.renderStackContent(e)]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})},t.prototype.renderNode=function(e){return Nj(this,0,void 0,function(){return jj(this,function(t){switch(t.label){case 0:return FV(e.container.flags,16),e.container.styles.isVisible()?[4,this.renderNodeBackgroundAndBorders(e)]:[3,3];case 1:return t.sent(),[4,this.renderNodeContent(e)];case 2:t.sent(),t.label=3;case 3:return[2]}})})},t.prototype.renderTextWithLetterSpacing=function(e,t,n){var r=this;0===t?-1===navigator.userAgent.indexOf("Firefox")?(this.ctx.textBaseline="ideographic",this.ctx.fillText(e.text,e.bounds.left,e.bounds.top+e.bounds.height)):this.ctx.fillText(e.text,e.bounds.left,e.bounds.top+n):SW(e.text).reduce(function(t,o){return r.ctx.fillText(o,t,e.bounds.top+n),t+r.ctx.measureText(o).width},e.bounds.left)},t.prototype.createFontStyle=function(e){var t=e.fontVariant.filter(function(e){return"normal"===e||"small-caps"===e}).join(""),n=GK(e.fontFamily).join(", "),r=Fz(e.fontSize)?"".concat(e.fontSize.number).concat(e.fontSize.unit):"".concat(e.fontSize.number,"px");return[[e.fontStyle,t,e.fontWeight,r,n].join(" "),n,r]},t.prototype.renderTextNode=function(e,t){return Nj(this,0,void 0,function(){var n,r,o=this;return jj(this,function(i){return n=this.createFontStyle(t)[0],this.ctx.font=n,this.ctx.direction=1===t.direction?"rtl":"ltr",this.ctx.textAlign="left",this.ctx.textBaseline="alphabetic",r=t.paintOrder,e.textBounds.forEach(function(e){r.forEach(function(n){switch(n){case 0:o.ctx.fillStyle=rH(t.color),o.renderTextWithLetterSpacing(e,t.letterSpacing,t.fontSize.number);var r=t.textShadow;if(r.length&&e.text.trim().length&&(r.slice(0).reverse().forEach(function(n){o.ctx.shadowColor=rH(n.color),o.ctx.shadowOffsetX=n.offsetX.number*o.options.scale,o.ctx.shadowOffsetY=n.offsetY.number*o.options.scale,o.ctx.shadowBlur=n.blur.number,o.renderTextWithLetterSpacing(e,t.letterSpacing,t.fontSize.number)}),o.ctx.shadowColor="",o.ctx.shadowOffsetX=0,o.ctx.shadowOffsetY=0,o.ctx.shadowBlur=0),t.textDecorationLine.length){o.ctx.fillStyle=rH(t.textDecorationColor||t.color);t.textDecorationLine.forEach(function(t){switch(t){case 1:o.ctx.fillRect(e.bounds.left,e.bounds.top+e.bounds.height-1,e.bounds.width,1);break;case 2:o.ctx.fillRect(e.bounds.left,e.bounds.top,e.bounds.width,1);break;case 3:o.ctx.fillRect(e.bounds.left,e.bounds.top+(e.bounds.height/2-.5),e.bounds.width,1)}})}break;case 1:t.webkitTextStrokeWidth&&e.text.trim().length&&(o.ctx.strokeStyle=rH(t.webkitTextStrokeColor),o.ctx.lineWidth=t.webkitTextStrokeWidth,o.ctx.lineJoin=window.chrome?"miter":"round",o.ctx.strokeText(e.text,e.bounds.left,e.bounds.top+e.bounds.height)),o.ctx.strokeStyle="",o.ctx.lineWidth=0,o.ctx.lineJoin="miter"}})}),[2]})})},t.prototype.renderReplacedElement=function(e,t,n){var r=n.naturalWidth||e.intrinsicWidth,o=n.naturalHeight||e.intrinsicHeight;if(n&&r>0&&o>0){var i=RK(e),s=fK(t);this.path(s),this.ctx.save(),this.ctx.clip();var a=0,l=0,c=r,u=o,d=i.left,A=i.top,h=i.width,p=i.height,f=e.styles.objectFit,g=h/p,m=c/u;if(2===f)m>g?(p=h/m,A+=(i.height-p)/2):(h=p*m,d+=(i.width-h)/2);else if(4===f)m>g?a+=(r-(c=u*g))/2:l+=(o-(u=c/g))/2;else if(8===f)c>h?(a+=(c-h)/2,c=h):(d+=(h-c)/2,h=c),u>p?(l+=(u-p)/2,u=p):(A+=(p-u)/2,p=u);else if(16===f){(m>g?h:p*m)<(c>h?c:h)?m>g?(p=h/m,A+=(i.height-p)/2):(h=p*m,d+=(i.width-h)/2):(c>h?(a+=(c-h)/2,c=h):(d+=(h-c)/2,h=c),u>p?(l+=(u-p)/2,u=p):(A+=(p-u)/2,p=u))}this.ctx.drawImage(n,a,l,c,u,d,A,h,p),this.ctx.restore()}},t.prototype.renderNodeContent=function(e){return Nj(this,0,void 0,function(){var n,r,o,i,s,a,l,c,u,d,A,h,p,f,g,m,y,v,b;return jj(this,function(w){switch(w.label){case 0:this.applyEffects(e.getEffects(4)),n=e.container,r=e.curves,o=n.styles,i=0,s=n.textNodes,w.label=1;case 1:return i<s.length?(a=s[i],[4,this.renderTextNode(a,o)]):[3,4];case 2:w.sent(),w.label=3;case 3:return i++,[3,1];case 4:if(!(n instanceof FW))return[3,8];w.label=5;case 5:return w.trys.push([5,7,,8]),[4,this.context.cache.match(n.src)];case 6:return m=w.sent(),this.renderReplacedElement(n,r,m),[3,8];case 7:return w.sent(),this.context.logger.error("Error loading image ".concat(n.src)),[3,8];case 8:if(n instanceof MW&&this.renderReplacedElement(n,r,n.canvas),!(n instanceof LW))return[3,12];w.label=9;case 9:return w.trys.push([9,11,,12]),[4,this.context.cache.match(n.svg)];case 10:return m=w.sent(),this.renderReplacedElement(n,r,m),[3,12];case 11:return w.sent(),this.context.logger.error("Error loading svg ".concat(n.svg.substring(0,255))),[3,12];case 12:return n instanceof $W&&n.tree?[4,new t(this.context,{scale:this.options.scale,backgroundColor:n.backgroundColor,x:0,y:0,width:n.width,height:n.height}).render(n.tree)]:[3,14];case 13:l=w.sent(),n.width&&n.height&&this.ctx.drawImage(l,0,0,n.width,n.height,n.bounds.left,n.bounds.top,n.bounds.width,n.bounds.height),w.label=14;case 14:if(n instanceof GW&&(c=Math.min(n.bounds.width,n.bounds.height),n.type===jW?n.checked&&(this.ctx.save(),this.path([new lK(n.bounds.left+.39363*c,n.bounds.top+.79*c),new lK(n.bounds.left+.16*c,n.bounds.top+.5549*c),new lK(n.bounds.left+.27347*c,n.bounds.top+.44071*c),new lK(n.bounds.left+.39694*c,n.bounds.top+.5649*c),new lK(n.bounds.left+.72983*c,n.bounds.top+.23*c),new lK(n.bounds.left+.84*c,n.bounds.top+.34085*c),new lK(n.bounds.left+.39363*c,n.bounds.top+.79*c)]),this.ctx.fillStyle=rH(HW),this.ctx.fill(),this.ctx.restore()):n.type===QW&&n.checked&&(this.ctx.save(),this.ctx.beginPath(),this.ctx.arc(n.bounds.left+c/2,n.bounds.top+c/2,c/4,0,2*Math.PI,!0),this.ctx.fillStyle=rH(HW),this.ctx.fill(),this.ctx.restore())),jK(n)&&n.value.length){switch(u=this.createFontStyle(o),v=u[0],d=u[1],A=u[2],h=this.fontMetrics.getMetrics(d,A).baseline,this.ctx.font=v,this.ctx.fillStyle=rH(o.color),this.ctx.textBaseline="alphabetic",this.ctx.textAlign=zK(n.styles.textAlign),b=RK(n),p=0,n.styles.textAlign){case 1:p+=b.width/2;break;case 2:p+=b.width}f=b.add(p,0,0,-b.height/2+1),this.ctx.save(),this.path([new lK(b.left,b.top),new lK(b.left+b.width,b.top),new lK(b.left+b.width,b.top+b.height),new lK(b.left,b.top+b.height)]),this.ctx.clip(),this.renderTextWithLetterSpacing(new xW(n.value,f),o.letterSpacing,h),this.ctx.restore(),this.ctx.textBaseline="alphabetic",this.ctx.textAlign="left"}if(!FV(n.styles.display,2048))return[3,20];if(null===n.styles.listStyleImage)return[3,19];if(0!==(g=n.styles.listStyleImage).type)return[3,18];m=void 0,y=g.url,w.label=15;case 15:return w.trys.push([15,17,,18]),[4,this.context.cache.match(y)];case 16:return m=w.sent(),this.ctx.drawImage(m,n.bounds.left-(m.width+10),n.bounds.top),[3,18];case 17:return w.sent(),this.context.logger.error("Error loading list-style-image ".concat(y)),[3,18];case 18:return[3,20];case 19:e.listValue&&-1!==n.styles.listStyleType&&(v=this.createFontStyle(o)[0],this.ctx.font=v,this.ctx.fillStyle=rH(o.color),this.ctx.textBaseline="middle",this.ctx.textAlign="right",b=new Qj(n.bounds.left,n.bounds.top+Xz(n.styles.paddingTop,n.bounds.width),n.bounds.width,XG(o.lineHeight,o.fontSize.number)/2+1),this.renderTextWithLetterSpacing(new xW(e.listValue,b),o.letterSpacing,XG(o.lineHeight,o.fontSize.number)/2+2),this.ctx.textBaseline="bottom",this.ctx.textAlign="left"),w.label=20;case 20:return[2]}})})},t.prototype.renderStackContent=function(e){return Nj(this,0,void 0,function(){var t,n,r,o,i,s,a,l,c,u,d,A,h,p,f;return jj(this,function(g){switch(g.label){case 0:return FV(e.element.container.flags,16),[4,this.renderNodeBackgroundAndBorders(e.element)];case 1:g.sent(),t=0,n=e.negativeZIndex,g.label=2;case 2:return t<n.length?(f=n[t],[4,this.renderStack(f)]):[3,5];case 3:g.sent(),g.label=4;case 4:return t++,[3,2];case 5:return[4,this.renderNodeContent(e.element)];case 6:g.sent(),r=0,o=e.nonInlineLevel,g.label=7;case 7:return r<o.length?(f=o[r],[4,this.renderNode(f)]):[3,10];case 8:g.sent(),g.label=9;case 9:return r++,[3,7];case 10:i=0,s=e.nonPositionedFloats,g.label=11;case 11:return i<s.length?(f=s[i],[4,this.renderStack(f)]):[3,14];case 12:g.sent(),g.label=13;case 13:return i++,[3,11];case 14:a=0,l=e.nonPositionedInlineLevel,g.label=15;case 15:return a<l.length?(f=l[a],[4,this.renderStack(f)]):[3,18];case 16:g.sent(),g.label=17;case 17:return a++,[3,15];case 18:c=0,u=e.inlineLevel,g.label=19;case 19:return c<u.length?(f=u[c],[4,this.renderNode(f)]):[3,22];case 20:g.sent(),g.label=21;case 21:return c++,[3,19];case 22:d=0,A=e.zeroOrAutoZIndexOrTransformedOrOpacity,g.label=23;case 23:return d<A.length?(f=A[d],[4,this.renderStack(f)]):[3,26];case 24:g.sent(),g.label=25;case 25:return d++,[3,23];case 26:h=0,p=e.positiveZIndex,g.label=27;case 27:return h<p.length?(f=p[h],[4,this.renderStack(f)]):[3,30];case 28:g.sent(),g.label=29;case 29:return h++,[3,27];case 30:return[2]}})})},t.prototype.mask=function(e){this.ctx.beginPath(),this.ctx.moveTo(0,0),this.ctx.lineTo(this.canvas.width,0),this.ctx.lineTo(this.canvas.width,this.canvas.height),this.ctx.lineTo(0,this.canvas.height),this.ctx.lineTo(0,0),this.formatPath(e.slice(0).reverse()),this.ctx.closePath()},t.prototype.path=function(e){this.ctx.beginPath(),this.formatPath(e),this.ctx.closePath()},t.prototype.formatPath=function(e){var t=this;e.forEach(function(e,n){var r=dK(e)?e.start:e;0===n?t.ctx.moveTo(r.x,r.y):t.ctx.lineTo(r.x,r.y),dK(e)&&t.ctx.bezierCurveTo(e.startControl.x,e.startControl.y,e.endControl.x,e.endControl.y,e.end.x,e.end.y)})},t.prototype.renderRepeat=function(e,t,n,r){this.path(e),this.ctx.fillStyle=t,this.ctx.translate(n,r),this.ctx.fill(),this.ctx.translate(-n,-r)},t.prototype.resizeImage=function(e,t,n){var r,o=(null!==(r=this.canvas.ownerDocument)&&void 0!==r?r:document).createElement("canvas");return o.width=Math.max(1,t),o.height=Math.max(1,n),o.getContext("2d").drawImage(e,0,0,e.width,e.height,0,0,t,n),o},t.prototype.renderBackgroundImage=function(e){return Nj(this,0,void 0,function(){var t,n,r,o,i,s;return jj(this,function(a){switch(a.label){case 0:t=e.styles.backgroundImage.length-1,n=function(n){var o,i,s,a,l,c,u,d,A,h,p,f,g,m,y,v,b,w,x,_,C,S,E,B,I,R,k,T,P,F,M,L,U;return jj(this,function(O){switch(O.label){case 0:if(0!==n.type)return[3,5];o=void 0,i=n.url,O.label=1;case 1:return O.trys.push([1,3,,4]),[4,r.context.cache.match(i)];case 2:return o=O.sent(),[3,4];case 3:return O.sent(),r.context.logger.error("Error loading background-image ".concat(i)),[3,4];case 4:return o&&(s=isNaN(o.width)||0===o.width?1:o.width,a=isNaN(o.height)||0===o.height?1:o.height,l=kK(e,t,[s,a,s/a]),w=l[0],B=l[1],I=l[2],C=l[3],S=l[4],v=r.ctx.createPattern(r.resizeImage(o,C,S),"repeat"),r.renderRepeat(w,v,B,I)),[3,6];case 5:1===n.type?(c=kK(e,t,[null,null,null]),w=c[0],B=c[1],I=c[2],C=c[3],S=c[4],u=$H(n.angle,C,S),d=u[0],A=u[1],h=u[2],p=u[3],f=u[4],(g=document.createElement("canvas")).width=C,g.height=S,m=g.getContext("2d"),y=m.createLinearGradient(A,p,h,f),WH(n.stops,d||1).forEach(function(e){return y.addColorStop(e.stop,rH(e.color))}),m.fillStyle=y,m.fillRect(0,0,C,S),C>0&&S>0&&(v=r.ctx.createPattern(g,"repeat"),r.renderRepeat(w,v,B,I))):function(e){return 2===e.type}(n)&&(b=kK(e,t,[null,null,null]),w=b[0],x=b[1],_=b[2],C=b[3],S=b[4],E=0===n.position.length?[Wz]:n.position,B=Xz(E[0],C),I=Xz(E[E.length-1],S),R=function(e,t,n,r,o){var i=0,s=0;switch(e.size){case 0:0===e.shape?i=s=Math.min(Math.abs(t),Math.abs(t-r),Math.abs(n),Math.abs(n-o)):1===e.shape&&(i=Math.min(Math.abs(t),Math.abs(t-r)),s=Math.min(Math.abs(n),Math.abs(n-o)));break;case 2:if(0===e.shape)i=s=Math.min(KH(t,n),KH(t,n-o),KH(t-r,n),KH(t-r,n-o));else if(1===e.shape){var a=Math.min(Math.abs(n),Math.abs(n-o))/Math.min(Math.abs(t),Math.abs(t-r)),l=XH(r,o,t,n,!0),c=l[0],u=l[1];s=a*(i=KH(c-t,(u-n)/a))}break;case 1:0===e.shape?i=s=Math.max(Math.abs(t),Math.abs(t-r),Math.abs(n),Math.abs(n-o)):1===e.shape&&(i=Math.max(Math.abs(t),Math.abs(t-r)),s=Math.max(Math.abs(n),Math.abs(n-o)));break;case 3:if(0===e.shape)i=s=Math.max(KH(t,n),KH(t,n-o),KH(t-r,n),KH(t-r,n-o));else if(1===e.shape){a=Math.max(Math.abs(n),Math.abs(n-o))/Math.max(Math.abs(t),Math.abs(t-r));var d=XH(r,o,t,n,!1);c=d[0],u=d[1],s=a*(i=KH(c-t,(u-n)/a))}}return Array.isArray(e.size)&&(i=Xz(e.size[0],r),s=2===e.size.length?Xz(e.size[1],o):i),[i,s]}(n,B,I,C,S),k=R[0],T=R[1],k>0&&T>0&&(P=r.ctx.createRadialGradient(x+B,_+I,0,x+B,_+I,k),WH(n.stops,2*k).forEach(function(e){return P.addColorStop(e.stop,rH(e.color))}),r.path(w),r.ctx.fillStyle=P,k!==T?(F=e.bounds.left+.5*e.bounds.width,M=e.bounds.top+.5*e.bounds.height,U=1/(L=T/k),r.ctx.save(),r.ctx.translate(F,M),r.ctx.transform(1,0,0,L,0,0),r.ctx.translate(-F,-M),r.ctx.fillRect(x,U*(_-M)+M,C,S*U),r.ctx.restore()):r.ctx.fill())),O.label=6;case 6:return t--,[2]}})},r=this,o=0,i=e.styles.backgroundImage.slice(0).reverse(),a.label=1;case 1:return o<i.length?(s=i[o],[5,n(s)]):[3,4];case 2:a.sent(),a.label=3;case 3:return o++,[3,1];case 4:return[2]}})})},t.prototype.renderSolidBorder=function(e,t,n){return Nj(this,0,void 0,function(){return jj(this,function(r){return this.path(SK(n,t)),this.ctx.fillStyle=rH(e),this.ctx.fill(),[2]})})},t.prototype.renderDoubleBorder=function(e,t,n,r){return Nj(this,0,void 0,function(){var o,i;return jj(this,function(s){switch(s.label){case 0:return t<3?[4,this.renderSolidBorder(e,n,r)]:[3,2];case 1:return s.sent(),[2];case 2:return o=function(e,t){switch(t){case 0:return BK(e.topLeftBorderBox,e.topLeftBorderDoubleOuterBox,e.topRightBorderBox,e.topRightBorderDoubleOuterBox);case 1:return BK(e.topRightBorderBox,e.topRightBorderDoubleOuterBox,e.bottomRightBorderBox,e.bottomRightBorderDoubleOuterBox);case 2:return BK(e.bottomRightBorderBox,e.bottomRightBorderDoubleOuterBox,e.bottomLeftBorderBox,e.bottomLeftBorderDoubleOuterBox);default:return BK(e.bottomLeftBorderBox,e.bottomLeftBorderDoubleOuterBox,e.topLeftBorderBox,e.topLeftBorderDoubleOuterBox)}}(r,n),this.path(o),this.ctx.fillStyle=rH(e),this.ctx.fill(),i=function(e,t){switch(t){case 0:return BK(e.topLeftBorderDoubleInnerBox,e.topLeftPaddingBox,e.topRightBorderDoubleInnerBox,e.topRightPaddingBox);case 1:return BK(e.topRightBorderDoubleInnerBox,e.topRightPaddingBox,e.bottomRightBorderDoubleInnerBox,e.bottomRightPaddingBox);case 2:return BK(e.bottomRightBorderDoubleInnerBox,e.bottomRightPaddingBox,e.bottomLeftBorderDoubleInnerBox,e.bottomLeftPaddingBox);default:return BK(e.bottomLeftBorderDoubleInnerBox,e.bottomLeftPaddingBox,e.topLeftBorderDoubleInnerBox,e.topLeftPaddingBox)}}(r,n),this.path(i),this.ctx.fill(),[2]}})})},t.prototype.renderNodeBackgroundAndBorders=function(e){return Nj(this,0,void 0,function(){var t,n,r,o,i,s,a,l,c=this;return jj(this,function(u){switch(u.label){case 0:return this.applyEffects(e.getEffects(2)),t=e.container.styles,n=!nH(t.backgroundColor)||t.backgroundImage.length,r=[{style:t.borderTopStyle,color:t.borderTopColor,width:t.borderTopWidth},{style:t.borderRightStyle,color:t.borderRightColor,width:t.borderRightWidth},{style:t.borderBottomStyle,color:t.borderBottomColor,width:t.borderBottomWidth},{style:t.borderLeftStyle,color:t.borderLeftColor,width:t.borderLeftWidth}],o=QK(MK(t.backgroundClip,0),e.curves),n||t.boxShadow.length?(this.ctx.save(),this.path(o),this.ctx.clip(),nH(t.backgroundColor)||(this.ctx.fillStyle=rH(t.backgroundColor),this.ctx.fill()),[4,this.renderBackgroundImage(e.container)]):[3,2];case 1:u.sent(),this.ctx.restore(),t.boxShadow.slice(0).reverse().forEach(function(t){c.ctx.save();var n,r,o,i,s,a=pK(e.curves),l=t.inset?0:1e4,u=(n=a,r=-l+(t.inset?1:-1)*t.spread.number,o=(t.inset?1:-1)*t.spread.number,i=t.spread.number*(t.inset?-2:2),s=t.spread.number*(t.inset?-2:2),n.map(function(e,t){switch(t){case 0:return e.add(r,o);case 1:return e.add(r+i,o);case 2:return e.add(r+i,o+s);case 3:return e.add(r,o+s)}return e}));t.inset?(c.path(a),c.ctx.clip(),c.mask(u)):(c.mask(a),c.ctx.clip(),c.path(u)),c.ctx.shadowOffsetX=t.offsetX.number+l,c.ctx.shadowOffsetY=t.offsetY.number,c.ctx.shadowColor=rH(t.color),c.ctx.shadowBlur=t.blur.number,c.ctx.fillStyle=t.inset?rH(t.color):"rgba(0,0,0,1)",c.ctx.fill(),c.ctx.restore()}),u.label=2;case 2:i=0,s=0,a=r,u.label=3;case 3:return s<a.length?0!==(l=a[s]).style&&!nH(l.color)&&l.width>0?2!==l.style?[3,5]:[4,this.renderDashedDottedBorder(l.color,l.width,i,e.curves,2)]:[3,11]:[3,13];case 4:return u.sent(),[3,11];case 5:return 3!==l.style?[3,7]:[4,this.renderDashedDottedBorder(l.color,l.width,i,e.curves,3)];case 6:return u.sent(),[3,11];case 7:return 4!==l.style?[3,9]:[4,this.renderDoubleBorder(l.color,l.width,i,e.curves)];case 8:return u.sent(),[3,11];case 9:return[4,this.renderSolidBorder(l.color,i,e.curves)];case 10:u.sent(),u.label=11;case 11:i++,u.label=12;case 12:return s++,[3,3];case 13:return[2]}})})},t.prototype.renderDashedDottedBorder=function(e,t,n,r,o){return Nj(this,0,void 0,function(){var i,s,a,l,c,u,d,A,h,p,f,g,m,y,v,b;return jj(this,function(w){return this.ctx.save(),i=function(e,t){switch(t){case 0:return EK(e.topLeftBorderStroke,e.topRightBorderStroke);case 1:return EK(e.topRightBorderStroke,e.bottomRightBorderStroke);case 2:return EK(e.bottomRightBorderStroke,e.bottomLeftBorderStroke);default:return EK(e.bottomLeftBorderStroke,e.topLeftBorderStroke)}}(r,n),s=SK(r,n),2===o&&(this.path(s),this.ctx.clip()),dK(s[0])?(a=s[0].start.x,l=s[0].start.y):(a=s[0].x,l=s[0].y),dK(s[1])?(c=s[1].end.x,u=s[1].end.y):(c=s[1].x,u=s[1].y),d=0===n||2===n?Math.abs(a-c):Math.abs(l-u),this.ctx.beginPath(),3===o?this.formatPath(i):this.formatPath(s.slice(0,2)),A=t<3?3*t:2*t,h=t<3?2*t:t,3===o&&(A=t,h=t),p=!0,d<=2*A?p=!1:d<=2*A+h?(A*=f=d/(2*A+h),h*=f):(g=Math.floor((d+h)/(A+h)),m=(d-g*A)/(g-1),h=(y=(d-(g+1)*A)/g)<=0||Math.abs(h-m)<Math.abs(h-y)?m:y),p&&(3===o?this.ctx.setLineDash([0,A+h]):this.ctx.setLineDash([A,h])),3===o?(this.ctx.lineCap="round",this.ctx.lineWidth=t):this.ctx.lineWidth=2*t+1.1,this.ctx.strokeStyle=rH(e),this.ctx.stroke(),this.ctx.setLineDash([]),2===o&&(dK(s[0])&&(v=s[3],b=s[0],this.ctx.beginPath(),this.formatPath([new lK(v.end.x,v.end.y),new lK(b.start.x,b.start.y)]),this.ctx.stroke()),dK(s[1])&&(v=s[1],b=s[2],this.ctx.beginPath(),this.formatPath([new lK(v.end.x,v.end.y),new lK(b.start.x,b.start.y)]),this.ctx.stroke())),this.ctx.restore(),[2]})})},t.prototype.render=function(e){return Nj(this,0,void 0,function(){var t;return jj(this,function(n){switch(n.label){case 0:return this.options.backgroundColor&&(this.ctx.fillStyle=rH(this.options.backgroundColor),this.ctx.fillRect(this.options.x,this.options.y,this.options.width,this.options.height)),r=new xK(e,null),o=new wK(r),_K(r,o,o,i=[]),CK(r.container,i),t=o,[4,this.renderStack(t)];case 1:return n.sent(),this.applyEffects([]),[2,this.canvas]}var r,o,i})})},t}(DK),jK=function(e){return e instanceof WW||(e instanceof VW||e instanceof GW&&e.type!==QW&&e.type!==jW)},QK=function(e,t){switch(e){case 0:return pK(t);case 2:return function(e){return[e.topLeftContentBox,e.topRightContentBox,e.bottomRightContentBox,e.bottomLeftContentBox]}(t);default:return fK(t)}},zK=function(e){switch(e){case 1:return"center";case 2:return"right";default:return"left"}},HK=["-apple-system","system-ui"],GK=function(e){return/iPhone OS 15_(0|1)/.test(window.navigator.userAgent)?e.filter(function(e){return-1===HK.indexOf(e)}):e},VK=function(e){function t(t,n){var r=e.call(this,t,n)||this;return r.canvas=n.canvas?n.canvas:document.createElement("canvas"),r.ctx=r.canvas.getContext("2d"),r.options=n,r.canvas.width=Math.floor(n.width*n.scale),r.canvas.height=Math.floor(n.height*n.scale),r.canvas.style.width="".concat(n.width,"px"),r.canvas.style.height="".concat(n.height,"px"),r.ctx.scale(r.options.scale,r.options.scale),r.ctx.translate(-n.x,-n.y),r.context.logger.debug("EXPERIMENTAL ForeignObject renderer initialized (".concat(n.width,"x").concat(n.height," at ").concat(n.x,",").concat(n.y,") with scale ").concat(n.scale)),r}return Oj(t,e),t.prototype.render=function(e){return Nj(this,0,void 0,function(){var t,n;return jj(this,function(r){switch(r.label){case 0:return t=vW(this.options.width*this.options.scale,this.options.height*this.options.scale,this.options.scale,this.options.scale,e),[4,WK(t)];case 1:return n=r.sent(),this.options.backgroundColor&&(this.ctx.fillStyle=rH(this.options.backgroundColor),this.ctx.fillRect(0,0,this.options.width*this.options.scale,this.options.height*this.options.scale)),this.ctx.drawImage(n,-this.options.x*this.options.scale,-this.options.y*this.options.scale),[2,this.canvas]}})})},t}(DK),WK=function(e){return new Promise(function(t,n){var r=new Image;r.onload=function(){t(r)},r.onerror=n,r.src="data:image/svg+xml;charset=utf-8,".concat(encodeURIComponent((new XMLSerializer).serializeToString(e)))})},$K=function(){function e(e){var t=e.id,n=e.enabled;this.id=t,this.enabled=n,this.start=Date.now()}return e.prototype.debug=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this.enabled&&("undefined"!=typeof window&&window.console&&"function"==typeof console.debug||this.info.apply(this,e))},e.prototype.getTime=function(){return Date.now()-this.start},e.prototype.info=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this.enabled&&"undefined"!=typeof window&&window.console&&console.info},e.prototype.warn=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this.enabled&&("undefined"!=typeof window&&window.console&&"function"==typeof console.warn||this.info.apply(this,e))},e.prototype.error=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this.enabled&&("undefined"!=typeof window&&window.console&&"function"==typeof console.error||this.info.apply(this,e))},e.instances={},e}(),KK=function(){function e(t,n){var r;this.windowBounds=n,this.instanceName="#".concat(e.instanceCount++),this.logger=new $K({id:this.instanceName,enabled:t.logging}),this.cache=null!==(r=t.cache)&&void 0!==r?r:new Z$(this,t)}return e.instanceCount=1,e}(),XK=function(e,t){return void 0===t&&(t={}),YK(e,t)};"undefined"!=typeof window&&J$.setContext(window);var YK=function(e,t){return Nj(void 0,0,void 0,function(){var n,r,o,i,s,a,l,c,u,d,A,h,p,f,g,m,y,v,b,w,x,_,C,S,E,B,I,R,k,T,P,F,M,L,U,O,D,N;return jj(this,function(j){switch(j.label){case 0:if(!e||"object"!=typeof e)return[2,Promise.reject("Invalid element provided as first argument")];if(!(n=e.ownerDocument))throw new Error("Element is not attached to a Document");if(!(r=n.defaultView))throw new Error("Document is not attached to a Window");return o={allowTaint:null!==(_=t.allowTaint)&&void 0!==_&&_,imageTimeout:null!==(C=t.imageTimeout)&&void 0!==C?C:15e3,proxy:t.proxy,useCORS:null!==(S=t.useCORS)&&void 0!==S&&S,customIsSameOrigin:t.customIsSameOrigin},i=Dj({logging:null===(E=t.logging)||void 0===E||E,cache:t.cache},o),s={windowWidth:null!==(B=t.windowWidth)&&void 0!==B?B:r.innerWidth,windowHeight:null!==(I=t.windowHeight)&&void 0!==I?I:r.innerHeight,scrollX:null!==(R=t.scrollX)&&void 0!==R?R:r.pageXOffset,scrollY:null!==(k=t.scrollY)&&void 0!==k?k:r.pageYOffset},a=new Qj(s.scrollX,s.scrollY,s.windowWidth,s.windowHeight),l=new KK(i,a),c=null!==(T=t.foreignObjectRendering)&&void 0!==T&&T,u={allowTaint:null!==(P=t.allowTaint)&&void 0!==P&&P,onclone:t.onclone,ignoreElements:t.ignoreElements,inlineImages:c,copyStyles:c},l.logger.debug("Starting document clone with size ".concat(a.width,"x").concat(a.height," scrolled to ").concat(-a.left,",").concat(-a.top)),d=new M$(l,e,u),(A=d.clonedReferenceElement)?[4,d.toIFrame(n,a)]:[2,Promise.reject("Unable to find element in cloned iframe")];case 1:return h=j.sent(),p=l$(A)||"HTML"===A.tagName?function(e){var t=e.body,n=e.documentElement;if(!t||!n)throw new Error("Unable to get document size");var r=Math.max(Math.max(t.scrollWidth,n.scrollWidth),Math.max(t.offsetWidth,n.offsetWidth),Math.max(t.clientWidth,n.clientWidth)),o=Math.max(Math.max(t.scrollHeight,n.scrollHeight),Math.max(t.offsetHeight,n.offsetHeight),Math.max(t.clientHeight,n.clientHeight));return new Qj(0,0,r,o)}(A.ownerDocument):zj(l,A),f=p.width,g=p.height,m=p.left,y=p.top,v=qK(l,A,t.backgroundColor),b={canvas:t.canvas,backgroundColor:v,scale:null!==(M=null!==(F=t.scale)&&void 0!==F?F:r.devicePixelRatio)&&void 0!==M?M:1,x:(null!==(L=t.x)&&void 0!==L?L:0)+m,y:(null!==(U=t.y)&&void 0!==U?U:0)+y,width:null!==(O=t.width)&&void 0!==O?O:Math.ceil(f),height:null!==(D=t.height)&&void 0!==D?D:Math.ceil(g)},c?(l.logger.debug("Document cloned, using foreign object rendering"),[4,new VK(l,b).render(A)]):[3,3];case 2:return w=j.sent(),[3,5];case 3:return l.logger.debug("Document cloned, element located at ".concat(m,",").concat(y," with size ").concat(f,"x").concat(g," using computed rendering")),l.logger.debug("Starting DOM parsing"),x=qW(l,A),v===x.styles.backgroundColor&&(x.styles.backgroundColor=zH.TRANSPARENT),l.logger.debug("Starting renderer for element at ".concat(b.x,",").concat(b.y," with size ").concat(b.width,"x").concat(b.height)),[4,new NK(l,b).render(x)];case 4:w=j.sent(),j.label=5;case 5:return(null===(N=t.removeContainer)||void 0===N||N)&&(M$.destroy(h)||l.logger.error("Cannot detach cloned iframe as it is not in the DOM anymore")),l.logger.debug("Finished rendering"),[2,w]}})})},qK=function(e,t,n){var r=t.ownerDocument,o=r.documentElement?QH(e,getComputedStyle(r.documentElement).backgroundColor):zH.TRANSPARENT,i=r.body?QH(e,getComputedStyle(r.body).backgroundColor):zH.TRANSPARENT,s="string"==typeof n?QH(e,n):null===n?zH.TRANSPARENT:4294967295;return t===r.documentElement?nH(o)?nH(i)?s:i:o:s};async function JK(e="main-map",t=1920,n=1080){return new Promise((r,o)=>{const i=document.getElementById(e);if(!i)return void o(new Error(`Map element with ID "${e}" not found`));let s=null;const a=window;if(a.googleMap&&(s=a.googleMap),!s){const e=i.querySelector('[role="application"]');if(e){const t=e;s=t.__map||t.map||t._map||t.parentElement?.__map||null}}if(!s){const e=i;s=e.__map||e.map||e._map||null}if(!s){const e=i.querySelectorAll('div[style*="position"][style*="overflow"]');for(const t of Array.from(e)){const e=t;if(e.__map instanceof google.maps.Map){s=e.__map;break}}}if(!s)return void setTimeout(()=>{(async function(e,t,n){const r=e.offsetWidth,o=e.offsetHeight,i=Math.max(t/r,n/o),s=await XK(e,{scale:i,useCORS:!0,allowTaint:!0,backgroundColor:"#ffffff",logging:!1,width:r,height:o});return s.toDataURL("image/png",1)})(i,t,n).then(r).catch(o)},2e3);const l=s.getZoom()||13;s.setZoom(l+.001);const c=s.addListener("idle",()=>{const e=i.offsetWidth,s=i.offsetHeight;if(0===e||0===s)return void o(new Error("Map element has zero dimensions"));const a=Math.max(t/e,n/s);XK(i,{scale:a,useCORS:!0,allowTaint:!0,backgroundColor:"#ffffff",logging:!1,width:e,height:s}).then(e=>{const t=e.toDataURL("image/png",1);r(t)}).catch(e=>{o(e)}),google.maps.event.removeListener(c)})})}async function ZK(e="main-map"){return await JK(e,1920,1080)}const eX={projects:["projects"],project:e=>["projects",e],gcpProjects:["gcpProjects"],routes:e=>["routes",e],route:e=>["route",e],routeTags:e=>["routeTags",e],routeCount:e=>["routeCount",e],roads:e=>["roads",e],roadsNetwork:e=>["roadsNetwork",e],cutPoints:e=>["cutPoints",e],polygons:e=>["polygons",e],userPreferences:["userPreferences"]},tX=()=>Se({queryKey:eX.projects,queryFn:async()=>{const e=await pj.getAll();if(!e.success)throw new Error(e.message);return e.data},staleTime:3e5}),nX=(e,t,n,r,o)=>function(e){return Ce(e,ne)}({queryKey:["routes-infinite",e,t,n,r,o],queryFn:async({pageParam:i=1})=>{const s=await wj.getByProjectPaginated(e,i,20,t||void 0,n||void 0,r,o);if(!s.success)throw new Error(s.message);return s.data},getNextPageParam:e=>e.pagination.hasMore?e.pagination.page+1:void 0,enabled:!!e&&!!n,staleTime:12e4,initialPageParam:1}),rX=()=>{const{routes:e,addRoute:t,selectRoute:n}=JN(),r=ye();return async o=>{try{if(e.find(e=>e.id===o))return void n(o);const i=r.getQueryData(eX.route(o));if(i)return t(i),void n(o);r.invalidateQueries({queryKey:eX.route(o)});const s=await wj.getById(o);if(!s.success||!s.data)throw new Error(s.message||"Failed to fetch route");const a=s.data;r.setQueryData(eX.route(o),a),t(a),n(o)}catch(i){throw i}}},oX=e=>Se({queryKey:eX.routeCount(e),queryFn:async()=>{const t=await wj.getProjectRouteCount(e);if(!t.success)throw new Error(t.message);return t.data.count},enabled:!!e,staleTime:6e4}),iX=()=>{const e=ye();return Ee({mutationFn:async({routeId:e,updates:t})=>{const n=t.name?{...t,sync_status:"unsynced"}:t,r=await wj.update(e,n);if(!r.success)throw new Error(r.message);return r.data},onSuccess:(t,n)=>{if(t){e.invalidateQueries({queryKey:eX.routes(t.projectId)}),e.invalidateQueries({queryKey:["routes-infinite",t.projectId]}),e.invalidateQueries({queryKey:eX.route(n.routeId)}),e.setQueryData(eX.route(n.routeId),t);(0,$N.getState().refreshRoutesTilesTimestamp)(),e.setQueryData(eX.routes(t.projectId),e=>e?e.map(e=>e.id===n.routeId?{...e,...t}:e):e),e.setQueriesData({queryKey:["routes-infinite",t.projectId]},e=>e&&e.pages?{...e,pages:e.pages.map(e=>({...e,routes:e.routes.map(e=>e.id===n.routeId?{...e,...t}:e)}))}:e),n.updates.name?Tw("Route name updated successfully",{duration:2e3}):Tw("Route updated successfully",{duration:2e3})}}})},sX=()=>{const e=ye();return Ee({mutationFn:async e=>{const t=await wj.delete(e);if(!t.success)throw new Error(t.message);return t.data},onSuccess:()=>{e.invalidateQueries({queryKey:["routes"]}),e.invalidateQueries({queryKey:["routes-infinite"]}),e.invalidateQueries({queryKey:["routeTags"]}),e.invalidateQueries({queryKey:["project-tags"]});(0,$N.getState().refreshRoutesTilesTimestamp)(),Tw("Route deleted successfully",{duration:2e3})}})},aX=()=>{const e=ye();return Ee({mutationFn:wj.save,onSuccess:async(t,n)=>{const r=n.uuid,o=n.region_id.toString();e.invalidateQueries({queryKey:["routes"]}),e.invalidateQueries({queryKey:["routes-infinite"]}),e.invalidateQueries({queryKey:["route"]}),e.invalidateQueries({queryKey:eX.route(r)}),e.invalidateQueries({queryKey:["routeTags"]}),e.invalidateQueries({queryKey:["project-tags"]});(0,$N.getState().refreshRoutesTilesTimestamp)(),Tw("Route saved successfully",{duration:2e3}),setTimeout(async()=>{try{const t=await ZK("main-map");await pj.updateSnapshot(o,t),await e.invalidateQueries({queryKey:eX.projects})}catch(t){}},2e3)},onError:e=>{Pw(`Failed to save route: ${e instanceof Error?e.message:"Unknown error"}`)}})},lX=()=>{const e=ye();return Ee({mutationFn:async({projectId:e,tag:t,roads:n})=>{if(!e)throw new Error("Project ID is required for batch saving routes.");const r=await wj.batchSave({project_id:e,tag:t,roads:n});if(!r.success)throw new Error(r.message||"Failed to batch save routes.");return{savedCount:r.data?.savedCount??0,errors:r.data?.errors??[],message:r.message}},onSuccess:async(t,n)=>{e.invalidateQueries({queryKey:["routes"]}),e.invalidateQueries({queryKey:["roadsNetwork"]}),e.invalidateQueries({queryKey:["roads"]}),e.invalidateQueries({queryKey:["routes-infinite"]}),e.invalidateQueries({queryKey:["routeTags"]}),e.invalidateQueries({queryKey:["project-tags"]});(0,$N.getState().refreshRoutesTilesTimestamp)();const r=t.savedCount,o=t.errors?.length||0;r>0&&Tw(o>0?`Batch save completed: ${r} route${r>1?"s":""} saved, ${o} error${o>1?"s":""}`:`${r} route${r>1?"s":""} saved successfully`,{duration:2e3});const i=n.projectId;i&&setTimeout(async()=>{try{const t=await ZK("main-map");await pj.updateSnapshot(i,t),await e.invalidateQueries({queryKey:eX.projects})}catch(t){}},2e3)}})},cX=e=>Se({queryKey:["project-tags",e],queryFn:async()=>{const t=await wj.getProjectTags(e);if(!t.success)throw new Error(t.message);return t.data.tags},enabled:!!e,staleTime:3e5}),uX=({projectId:e,polygon:t,priorities:n,confirmed:r=!1})=>{const o=pe.useMemo(()=>t?JSON.stringify(t.coordinates):"",[t?.coordinates]),i=pe.useMemo(()=>n&&n.length>0?[...n].sort().join(","):"all",[n]);return Se({queryKey:["lasso-road-selection",e,o,i],queryFn:async()=>{if(!e||!t)return[];const r=await _j.selectByPolygon({project_id:e,polygon:t,priorities:n.length?n:void 0});if(!r.success)throw new Error(r.message);return r.data},enabled:!!e&&!!t&&t.coordinates.length>0&&r,staleTime:12e4,refetchOnMount:!1,refetchOnWindowFocus:!1,refetchOnReconnect:!1})},dX=()=>Ee({mutationFn:async({roadId:e,projectId:t,priorityList:n})=>{const r=parseInt(t,10);if(isNaN(r))throw new Error(`Invalid project ID: ${t}`);const o=await _j.stretch(e,r,n);if(!o.success)throw new Error(o.message);return o.data}}),AX=()=>Ee({mutationFn:async({roadIds:e,projectId:t,gapToleranceMeters:n})=>{const r=await _j.validateContinuity(e,t,n);if(!r.success)throw new Error(r.message);return r.data}}),hX=()=>{const{loadPreferences:e}=Lj();return Se({queryKey:eX.userPreferences,queryFn:async()=>{const t=await Sj.getPreferences();if(!t.success)throw new Error(t.message);return e(t.data),t.data},staleTime:3e5})};function pX(){const{data:e,isLoading:t,error:n}=hX();return pe.useEffect(()=>{},[e,n]),null}const fX=ku(s.jsx("path",{d:"M19 13h-6v6h-2v-6H5v-2h6V5h2v6h6z"})),gX=ku(s.jsx("path",{d:"M20 11H7.83l5.59-5.59L12 4l-8 8 8 8 1.41-1.41L7.83 13H20z"})),mX=ku(s.jsx("path",{d:"m20 12-1.41-1.41L13 16.17V4h-2v12.17l-5.58-5.59L4 12l8 8z"})),yX=ku(s.jsx("path",{d:"m7 10 5 5 5-5z"})),vX=ku(s.jsx("path",{d:"m4 12 1.41 1.41L11 7.83V20h2V7.83l5.58 5.59L20 12l-8-8z"})),bX=ku(s.jsx("path",{d:"M12 2C6.47 2 2 6.47 2 12s4.47 10 10 10 10-4.47 10-10S17.53 2 12 2m5 13.59L15.59 17 12 13.41 8.41 17 7 15.59 10.59 12 7 8.41 8.41 7 12 10.59 15.59 7 17 8.41 13.41 12z"})),wX=ku(s.jsx("path",{d:"M12 8c-2.21 0-4 1.79-4 4s1.79 4 4 4 4-1.79 4-4-1.79-4-4-4m-7 7H3v4c0 1.1.9 2 2 2h4v-2H5zM5 5h4V3H5c-1.1 0-2 .9-2 2v4h2zm14-2h-4v2h4v4h2V5c0-1.1-.9-2-2-2m0 16h-4v2h4c1.1 0 2-.9 2-2v-4h-2z"})),xX=ku(s.jsx("path",{d:"M9 16.17 4.83 12l-1.42 1.41L9 19 21 7l-1.41-1.41z"})),_X=ku(s.jsx("path",{d:"M19 3H5c-1.11 0-2 .9-2 2v14c0 1.1.89 2 2 2h14c1.11 0 2-.9 2-2V5c0-1.1-.89-2-2-2m-9 14-5-5 1.41-1.41L10 14.17l7.59-7.59L19 8z"})),CX=ku(s.jsx("path",{d:"M19 5v14H5V5zm0-2H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2"})),SX=ku(s.jsx("path",{d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2m-2 15-5-5 1.41-1.41L10 14.17l7.59-7.59L19 8z"})),EX=ku(s.jsx("path",{d:"M15.41 7.41 14 6l-6 6 6 6 1.41-1.41L10.83 12z"})),BX=ku(s.jsx("path",{d:"M10 6 8.59 7.41 13.17 12l-4.58 4.59L10 18l6-6z"})),IX=ku(s.jsx("path",{d:"M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"})),RX=ku(s.jsx("path",{d:"M18.3 5.71a.996.996 0 0 0-1.41 0L12 10.59 7.11 5.7a.996.996 0 0 0-1.41 0c-.39.39-.39 1.02 0 1.41L10.59 12 5.7 16.89c-.39.39-.39 1.02 0 1.41s1.02.39 1.41 0L12 13.41l4.89 4.89c.39.39 1.02.39 1.41 0s.39-1.02 0-1.41L13.41 12l4.89-4.89c.38-.38.38-1.02 0-1.4"})),kX=ku(s.jsx("path",{d:"M19.35 10.04C18.67 6.59 15.64 4 12 4 9.11 4 6.6 5.64 5.35 8.04 2.34 8.36 0 10.91 0 14c0 3.31 2.69 6 6 6h13c2.76 0 5-2.24 5-5 0-2.64-2.05-4.78-4.65-4.96M14 13v4h-4v-4H7l5-5 5 5z"})),TX=ku(s.jsx("path",{d:"M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2m0 16H8V7h11z"})),PX=ku(s.jsx("path",{d:"M9.64 7.64c.23-.5.36-1.05.36-1.64 0-2.21-1.79-4-4-4S2 3.79 2 6s1.79 4 4 4c.59 0 1.14-.13 1.64-.36L10 12l-2.36 2.36C7.14 14.13 6.59 14 6 14c-2.21 0-4 1.79-4 4s1.79 4 4 4 4-1.79 4-4c0-.59-.13-1.14-.36-1.64L12 14l7 7h3v-1zM6 8c-1.1 0-2-.89-2-2s.9-2 2-2 2 .89 2 2-.9 2-2 2m0 12c-1.1 0-2-.89-2-2s.9-2 2-2 2 .89 2 2-.9 2-2 2m6-7.5c-.28 0-.5-.22-.5-.5s.22-.5.5-.5.5.22.5.5-.22.5-.5.5M19 3l-6 6 2 2 7-7V3z"})),FX=ku(s.jsx("path",{d:"M3 5v4h2V5h4V3H5c-1.1 0-2 .9-2 2m2 10H3v4c0 1.1.9 2 2 2h4v-2H5zm14 4h-4v2h4c1.1 0 2-.9 2-2v-4h-2zm0-16h-4v2h4v4h2V5c0-1.1-.9-2-2-2"})),MX=ku(s.jsx("path",{d:"M6 19c0 1.1.9 2 2 2h8c1.1 0 2-.9 2-2V7H6zM19 4h-3.5l-1-1h-5l-1 1H5v2h14z"})),LX=ku(s.jsx("path",{d:"M5 20h14v-2H5zM19 9h-4V3H9v6H5l7 7z"})),UX=ku(s.jsx("path",{d:"M11 18c0 1.1-.9 2-2 2s-2-.9-2-2 .9-2 2-2 2 .9 2 2m-2-8c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2m0-6c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2m6 4c1.1 0 2-.9 2-2s-.9-2-2-2-2 .9-2 2 .9 2 2 2m0 2c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2m0 6c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2"})),OX=ku(s.jsx("path",{d:"M20 6h-8l-2-2H4c-1.1 0-2 .9-2 2v12c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V8c0-1.1-.9-2-2-2m-6 12v-3h-4v-4h4V8l5 5z"})),DX=ku(s.jsx("path",{d:"M18.41 5.8 17.2 4.59c-.78-.78-2.05-.78-2.83 0l-2.68 2.68L3 15.96V20h4.04l8.74-8.74 2.63-2.63c.79-.78.79-2.05 0-2.83M6.21 18H5v-1.21l8.66-8.66 1.21 1.21zM11 20l4-4h6v4z"})),NX=ku(s.jsx("path",{d:"m15 16-4 4h10v-4zm-2.94-8.81L3 16.25V20h3.75l9.06-9.06zm1.072-1.0673 2.5385-2.5386 3.7477 3.7477-2.5385 2.5385z"})),jX=ku(s.jsx("path",{d:"M3 17.25V21h3.75L17.81 9.94l-3.75-3.75zM20.71 7.04c.39-.39.39-1.02 0-1.41l-2.34-2.34a.996.996 0 0 0-1.41 0l-1.83 1.83 3.75 3.75z"})),QX=ku([s.jsx("path",{d:"M13.95 13H9V8.05l5.61-5.61C13.78 2.16 12.9 2 12 2c-4.2 0-8 3.22-8 8.2 0 3.32 2.67 7.25 8 11.8 5.33-4.55 8-8.48 8-11.8 0-1.01-.16-1.94-.45-2.8z"},"0"),s.jsx("path",{d:"M11 11h2.12l6.16-6.16-2.12-2.12L11 8.88zm9.71-9L20 1.29c-.2-.19-.45-.29-.71-.29-.13 0-.48.07-.71.29l-.72.72 2.12 2.12.72-.72c.4-.39.4-1.02.01-1.41"},"1")]),zX=ku(s.jsx("path",{d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2m1 15h-2v-2h2zm0-4h-2V7h2z"})),HX=ku(s.jsx("path",{d:"m12 8-6 6 1.41 1.41L12 10.83l4.59 4.58L18 14z"})),GX=ku(s.jsx("path",{d:"M16.59 8.59 12 13.17 7.41 8.59 6 10l6 6 6-6z"})),VX=ku(s.jsx("path",{d:"M10 18h4v-2h-4zM3 6v2h18V6zm3 7h12v-2H6z"})),WX=ku(s.jsx("path",{d:"M10 4H4c-1.1 0-1.99.9-1.99 2L2 18c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V8c0-1.1-.9-2-2-2h-8z"})),$X=ku(s.jsx("path",{d:"M13 6.99h3L12 3 8 6.99h3v10.02H8L12 21l4-3.99h-3z"})),KX=ku(s.jsx("path",{d:"M17 5h-2V3h2zm-2 16h2v-2.59L19.59 21 21 19.59 18.41 17H21v-2h-6zm4-12h2V7h-2zm0 4h2v-2h-2zm-8 8h2v-2h-2zM7 5h2V3H7zM3 17h2v-2H3zm2 4v-2H3c0 1.1.9 2 2 2M19 3v2h2c0-1.1-.9-2-2-2m-8 2h2V3h-2zM3 9h2V7H3zm4 12h2v-2H7zm-4-8h2v-2H3zm0-8h2V3c-1.1 0-2 .9-2 2"})),XX=ku(s.jsx("path",{d:"M10 20v-6h4v6h5v-8h3L12 3 2 12h3v8z"})),YX=ku(s.jsx("path",{d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2m1 15h-2v-6h2zm0-8h-2V7h2z"})),qX=ku(s.jsx("path",{d:"m11.99 18.54-7.37-5.73L3 14.07l9 7 9-7-1.63-1.27zM12 16l7.36-5.73L21 9l-9-7-9 7 1.63 1.27z"})),JX=ku(s.jsx("path",{d:"M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76 0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71 0-3.1-1.39-3.1-3.1M8 13h8v-2H8zm9-6h-4v1.9h4c1.71 0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76 0 5-2.24 5-5s-2.24-5-5-5"})),ZX=ku(s.jsx("path",{d:"M12 8c1.1 0 2-.9 2-2s-.9-2-2-2-2 .9-2 2 .9 2 2 2m0 2c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2m0 6c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2"})),eY=ku(s.jsx("path",{d:"M10 9h4V6h3l-5-5-5 5h3zm-1 1H6V7l-5 5 5 5v-3h3zm14 2-5-5v3h-3v4h3v3zm-9 3h-4v3H7l5 5 5-5h-3z"})),tY=ku(s.jsx("path",{d:"M12 2C8.13 2 5 5.13 5 9c0 5.25 7 13 7 13s7-7.75 7-13c0-3.87-3.13-7-7-7m0 9.5c-1.38 0-2.5-1.12-2.5-2.5s1.12-2.5 2.5-2.5 2.5 1.12 2.5 2.5-1.12 2.5-2.5 2.5"})),nY=ku(s.jsx("path",{d:"M12 7c-2.76 0-5 2.24-5 5s2.24 5 5 5 5-2.24 5-5-2.24-5-5-5m0-5C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2m0 18c-4.42 0-8-3.58-8-8s3.58-8 8-8 8 3.58 8 8-3.58 8-8 8"})),rY=ku(s.jsx("path",{d:"M18.4 10.6C16.55 8.99 14.15 8 11.5 8c-4.65 0-8.58 3.03-9.96 7.22L3.9 16c1.05-3.19 4.05-5.5 7.6-5.5 1.95 0 3.73.72 5.12 1.88L13 16h9V7z"})),oY=ku(s.jsx("path",{d:"M17.65 6.35C16.2 4.9 14.21 4 12 4c-4.42 0-7.99 3.58-7.99 8s3.57 8 7.99 8c3.73 0 6.84-2.55 7.73-6h-2.08c-.82 2.33-3.04 4-5.65 4-3.31 0-6-2.69-6-6s2.69-6 6-6c1.66 0 3.14.69 4.22 1.78L13 11h7V4z"})),iY=ku(s.jsx("path",{d:"M19 13H5v-2h14z"})),sY=ku(s.jsx("path",{d:"M19 15.18V7c0-2.21-1.79-4-4-4s-4 1.79-4 4v10c0 1.1-.9 2-2 2s-2-.9-2-2V8.82C8.16 8.4 9 7.3 9 6c0-1.66-1.34-3-3-3S3 4.34 3 6c0 1.3.84 2.4 2 2.82V17c0 2.21 1.79 4 4 4s4-1.79 4-4V7c0-1.1.9-2 2-2s2 .9 2 2v8.18c-1.16.41-2 1.51-2 2.82 0 1.66 1.34 3 3 3s3-1.34 3-3c0-1.3-.84-2.4-2-2.82"})),aY=ku(s.jsx("path",{d:"M17 3H5c-1.11 0-2 .9-2 2v14c0 1.1.89 2 2 2h14c1.1 0 2-.9 2-2V7zm-5 16c-1.66 0-3-1.34-3-3s1.34-3 3-3 3 1.34 3 3-1.34 3-3 3m3-10H5V5h10z"})),lY=ku([s.jsx("circle",{cx:"7",cy:"14",r:"3"},"0"),s.jsx("circle",{cx:"11",cy:"6",r:"3"},"1"),s.jsx("circle",{cx:"16.6",cy:"17.6",r:"3"},"2")]),cY=ku(s.jsx("path",{d:"M15.5 14h-.79l-.28-.27C15.41 12.59 16 11.11 16 9.5 16 5.91 13.09 3 9.5 3S3 5.91 3 9.5 5.91 16 9.5 16c1.61 0 3.09-.59 4.23-1.57l.27.28v.79l5 4.99L20.49 19zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14"})),uY=ku(s.jsx("path",{d:"M19.14 12.94c.04-.3.06-.61.06-.94 0-.32-.02-.64-.07-.94l2.03-1.58c.18-.14.23-.41.12-.61l-1.92-3.32c-.12-.22-.37-.29-.59-.22l-2.39.96c-.5-.38-1.03-.7-1.62-.94l-.36-2.54c-.04-.24-.24-.41-.48-.41h-3.84c-.24 0-.43.17-.47.41l-.36 2.54c-.59.24-1.13.57-1.62.94l-2.39-.96c-.22-.08-.47 0-.59.22L2.74 8.87c-.12.21-.08.47.12.61l2.03 1.58c-.05.3-.09.63-.09.94s.02.64.07.94l-2.03 1.58c-.18.14-.23.41-.12.61l1.92 3.32c.12.22.37.29.59.22l2.39-.96c.5.38 1.03.7 1.62.94l.36 2.54c.05.24.24.41.48.41h3.84c.24 0 .44-.17.47-.41l.36-2.54c.59-.24 1.13-.56 1.62-.94l2.39.96c.22.08.47 0 .59-.22l1.92-3.32c.12-.22.07-.47-.12-.61zM12 15.6c-1.98 0-3.6-1.62-3.6-3.6s1.62-3.6 3.6-3.6 3.6 1.62 3.6 3.6-1.62 3.6-3.6 3.6"})),dY=ku(s.jsx("path",{d:"M3 18h6v-2H3zM3 6v2h18V6zm0 7h12v-2H3z"})),AY=ku(s.jsx("path",{d:"M16 17.01V10h-2v7.01h-3L15 21l4-3.99zM9 3 5 6.99h3V14h2V6.99h3z"})),hY=ku(s.jsx("path",{d:"M12 4V1L8 5l4 4V6c3.31 0 6 2.69 6 6 0 1.01-.25 1.97-.7 2.8l1.46 1.46C19.54 15.03 20 13.57 20 12c0-4.42-3.58-8-8-8m0 14c-3.31 0-6-2.69-6-6 0-1.01.25-1.97.7-2.8L5.24 7.74C4.46 8.97 4 10.43 4 12c0 4.42 3.58 8 8 8v3l4-4-4-4z"})),pY=ku(s.jsx("path",{d:"M12.5 8c-2.65 0-5.05.99-6.9 2.6L2 7v9h9l-3.62-3.62c1.39-1.16 3.16-1.88 5.12-1.88 3.54 0 6.55 2.31 7.6 5.5l2.37-.78C21.08 11.03 17.15 8 12.5 8"})),fY=ku(s.jsx("path",{d:"M5 20h14v-2H5zm0-10h4v6h6v-6h4l-7-7z"})),gY=ku(s.jsx("path",{d:"M14 2H6c-1.1 0-1.99.9-1.99 2L4 20c0 1.1.89 2 1.99 2H18c1.1 0 2-.9 2-2V8zm4 18H6V4h7v5h5zM8 15.01l1.41 1.41L11 14.84V19h2v-4.16l1.59 1.59L16 15.01 12.01 11z"})),mY=ku(s.jsx("path",{d:"M12 4.5C7 4.5 2.73 7.61 1 12c1.73 4.39 6 7.5 11 7.5s9.27-3.11 11-7.5c-1.73-4.39-6-7.5-11-7.5M12 17c-2.76 0-5-2.24-5-5s2.24-5 5-5 5 2.24 5 5-2.24 5-5 5m0-8c-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3-1.34-3-3-3"})),yY=ku(s.jsx("path",{d:"M12 7c2.76 0 5 2.24 5 5 0 .65-.13 1.26-.36 1.83l2.92 2.92c1.51-1.26 2.7-2.89 3.43-4.75-1.73-4.39-6-7.5-11-7.5-1.4 0-2.74.25-3.98.7l2.16 2.16C10.74 7.13 11.35 7 12 7M2 4.27l2.28 2.28.46.46C3.08 8.3 1.78 10.02 1 12c1.73 4.39 6 7.5 11 7.5 1.55 0 3.03-.3 4.38-.84l.42.42L19.73 22 21 20.73 3.27 3zM7.53 9.8l1.55 1.55c-.05.21-.08.43-.08.65 0 1.66 1.34 3 3 3 .22 0 .44-.03.65-.08l1.55 1.55c-.67.33-1.41.53-2.2.53-2.76 0-5-2.24-5-5 0-.79.2-1.53.53-2.2m4.31-.78 3.15 3.15.02-.16c0-1.66-1.34-3-3-3z"})),vY=ku(s.jsx("path",{d:"M1 21h22L12 2zm12-3h-2v-2h2zm0-4h-2v-4h2z"})),bY=ku([s.jsx("path",{d:"M15.5 14h-.79l-.28-.27C15.41 12.59 16 11.11 16 9.5 16 5.91 13.09 3 9.5 3S3 5.91 3 9.5 5.91 16 9.5 16c1.61 0 3.09-.59 4.23-1.57l.27.28v.79l5 4.99L20.49 19zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14"},"0"),s.jsx("path",{d:"M12 10h-2v2H9v-2H7V9h2V7h1v2h2z"},"1")]);function wY(){const e={type:"FeatureCollection",features:[{type:"Feature",properties:{},geometry:{coordinates:[[[1.6907442136105715,49.28780499905099],[1.6612205986124309,49.16991009961717],[1.6209858191267017,49.1292272985076],[1.537605455151521,49.10651602745628],[1.438357564220894,49.06210076497226],[1.4914841490810034,48.960001897615655],[1.5263324345023648,48.840894117564886],[1.558831885197833,48.72641066931615],[1.592496398595415,48.64857854952592],[1.700351420112952,48.569535864714226],[1.7393032272417202,48.50688927030936],[1.818058695765501,48.444381092798295],[1.9303156116553453,48.380741644365884],[1.9268624213131034,48.30947430220533],[2.0045020410304346,48.27391346337771],[2.190678193229843,48.27128575148848],[2.3172653786228636,48.2949272097668],[2.4098153317112576,48.25424046088531],[2.4330211737642458,48.19401675274608],[2.410871497517661,48.11956302477387],[2.4913023446169404,48.11573395145501],[2.6632636462509254,48.08468858803869],[2.8178827186759463,48.10176989137821],[2.972949892576395,48.144827008308226],[3.0857547875696696,48.20868401985865],[3.0642273996304823,48.28175314287503],[3.1106712320249414,48.33537211367701],[3.2903576381413018,48.32745506478744],[3.468726198980818,48.349600195662816],[3.4822166846025766,48.44779263004085],[3.503013466068694,48.530539540143394],[3.649367178174316,48.61061765373742],[3.5138370487785267,48.69838492227862],[3.4930335676459663,48.772895328056364],[3.5573077557801014,48.848639088148616],[3.396182783443521,48.94163797506701],[3.2770865138660383,49.01340373511073],[3.1928949221551477,49.13798924148617],[3.028187593213147,49.13353330328994],[2.8022767505671595,49.10232096456903],[2.4964120704534025,49.18012595964933],[2.2408336767189496,49.20622455759781],[2.037207162111372,49.207493185801695],[1.8209446908212215,49.19243001982139],[1.6907442136105715,49.28780499905099]]],type:"Polygon"}}]},t=JSON.stringify(e,null,2),n=new Blob([t],{type:"application/json"}),r=URL.createObjectURL(n),o=document.createElement("a");o.href=r,o.download="sample-region.geojson",document.body.appendChild(o),o.click(),document.body.removeChild(o),URL.revokeObjectURL(r)}const xY="/assets/project-info-iVw3bqbU.gif";function _Y({step:e,minimized:t,onToggleMinimize:n}){const[r,o]=pe.useState(!1);return s.jsxs(rf,{className:"absolute right-0 top-16 h-full flex transition-all duration-300 z-[1000]",sx:{width:t?0:{xs:"100%",sm:400},fontFamily:"'Google Sans', 'Roboto', sans-serif",transform:t?"translateX(100%)":"translateX(0)",position:"relative"},children:[s.jsxs(rf,{className:"h-full flex flex-col border-l border-gray-200 bg-white",sx:{width:t?0:{xs:"100%",sm:400},position:"relative",zIndex:1e3,overflow:t?"hidden":"visible"},children:[s.jsx(rf,{className:"flex items-center justify-between p-4 border-b border-gray-200",children:s.jsx(vA,{variant:"h6",className:"font-semibold text-base",children:"Help & Guidelines"})}),s.jsx(rf,{className:"flex-1 overflow-y-auto p-4",children:s.jsxs(rf,{className:"space-y-4",children:[0===e&&s.jsxs(s.Fragment,{children:[s.jsx(rf,{className:"flex justify-center bg-gray-50 rounded-lg p-4",children:s.jsx("img",{src:xY,alt:"Setup Instructions",className:"max-w-full h-auto rounded cursor-pointer transition-opacity duration-200 hover:opacity-80",style:{maxHeight:"250px"},onClick:()=>o(!0)})}),s.jsxs(rf,{children:[s.jsx(vA,{variant:"body2",className:"font-semibold text-sm mb-2",children:"Google Cloud Project Setup"}),s.jsxs(vA,{variant:"body2",className:"text-sm text-gray-700 mb-2",children:["Your Google Cloud Project will be used for BigQuery data storage and traffic subscription."," ",s.jsx("span",{children:s.jsx(vm,{href:"https://console.cloud.google.com/home/dashboard",target:"_blank",rel:"noopener noreferrer",className:"text-xs text-blue-600 hover:text-blue-800 underline ml-0.5",children:s.jsx(JX,{className:"w-4 h-4"})})})]}),s.jsx(vA,{variant:"body2",className:"text-sm text-gray-700",children:"If you don't see your project in the list, make sure:"}),s.jsxs(rf,{className:"space-y-1 mt-2",children:[s.jsxs(rf,{className:"flex gap-2",children:[s.jsx(vA,{variant:"body2",className:"text-sm flex-shrink-0",children:"1."}),s.jsx(vA,{variant:"body2",className:"text-sm text-gray-700",children:"You're logged in via 'gcloud auth application-default login' in your terminal"})]}),s.jsxs(rf,{className:"flex gap-2",children:[s.jsx(vA,{variant:"body2",className:"text-sm flex-shrink-0",children:"2."}),s.jsx(vA,{variant:"body2",className:"text-sm text-gray-700",children:"Cloud Resource Manager API is enabled"}),s.jsx(vm,{href:"https://console.cloud.google.com/apis/api/cloudresourcemanager.googleapis.com/metrics",target:"_blank",rel:"noopener noreferrer",className:"text-xs text-blue-600 hover:text-blue-800 underline ml-0.5",children:s.jsx(JX,{className:"w-4 h-4"})})]}),s.jsxs(rf,{className:"flex gap-2",children:[s.jsx(vA,{variant:"body2",className:"text-sm flex-shrink-0",children:"3."}),s.jsx(vA,{variant:"body2",className:"text-sm text-gray-700",children:"You have the necessary permissions"})]})]})]})]}),1===e&&s.jsx(s.Fragment,{children:s.jsxs(rf,{children:[s.jsx(vA,{variant:"body2",className:"font-semibold text-sm mb-2",children:"Project Name"}),s.jsx(vA,{variant:"body2",className:"text-sm text-gray-700",children:"Choose a unique name for your project. This name will be used to identify your project in the dashboard and must be unique."})]})}),2===e&&s.jsxs(s.Fragment,{children:[s.jsxs(rf,{children:[s.jsx(vA,{variant:"body2",className:"font-semibold text-sm mb-2",children:"Jurisdiction Boundary"}),s.jsxs(rf,{className:"space-y-2",children:[s.jsxs(rf,{className:"flex gap-2",children:[s.jsx(vA,{variant:"body2",className:"text-sm flex-shrink-0",children:""}),s.jsx(vA,{variant:"body2",className:"text-sm text-gray-700",children:"A jurisdiction boundary is the geographic area (polygon) that defines the region where you want to monitor traffic. This could be a city, county, state, or any custom geographic area."})]}),s.jsxs(rf,{className:"flex gap-2",children:[s.jsx(vA,{variant:"body2",className:"text-sm flex-shrink-0",children:""}),s.jsx(vA,{variant:"body2",className:"text-sm text-gray-700",children:"This boundary will be used to filter and monitor traffic within the specified area."})]}),s.jsxs(rf,{className:"flex gap-2",children:[s.jsx(vA,{variant:"body2",className:"text-sm flex-shrink-0",children:""}),s.jsx(vA,{variant:"body2",className:"text-sm text-gray-700",children:"This should be the same file you subscribed to in the Google Cloud Project."})]})]})]}),s.jsxs(rf,{children:[s.jsx(vA,{variant:"body2",className:"font-semibold text-sm mb-2",children:"File Format Requirements"}),s.jsxs(rf,{className:"space-y-2",children:[s.jsxs(rf,{className:"flex gap-2",children:[s.jsx(vA,{variant:"body2",className:"text-sm flex-shrink-0",children:""}),s.jsx(vA,{variant:"body2",className:"text-sm text-gray-700",children:"Must be a valid GeoJSON FeatureCollection or Feature"})]}),s.jsxs(rf,{className:"flex gap-2",children:[s.jsx(vA,{variant:"body2",className:"text-sm flex-shrink-0",children:""}),s.jsx(vA,{variant:"body2",className:"text-sm text-gray-700",children:"Should contain a single Polygon feature"})]}),s.jsxs(rf,{className:"flex gap-2",children:[s.jsx(vA,{variant:"body2",className:"text-sm flex-shrink-0",children:""}),s.jsx(vA,{variant:"body2",className:"text-sm text-gray-700",children:"Coordinates must be in [longitude, latitude] format (WGS84)"})]}),s.jsxs(rf,{className:"flex gap-2",children:[s.jsx(vA,{variant:"body2",className:"text-sm flex-shrink-0",children:""}),s.jsx(vA,{variant:"body2",className:"text-sm text-gray-700",children:"File extension: .geojson or .json"})]}),s.jsx(Nv,{variant:"text",size:"small",startIcon:s.jsx(LX,{className:"w-4 h-4"}),onClick:wY,className:"text-xs !p-0 !px-3",children:"Download Sample File"})]})]})]})]})})]}),s.jsx(rf,{className:"absolute top-1/2 -translate-y-1/2 left-0 -translate-x-1/2 bg-white border border-l-0 border-b-0 border-t-0 border-gray-300 rounded-l-lg flex items-center justify-center cursor-pointer transition-all duration-200 z-[999] pr-4",onClick:n,sx:{width:40,height:64,boxShadow:t?"0 4px 16px rgba(0, 0, 0, 0.2), 0 2px 8px rgba(0, 0, 0, 0.15), 0 0 0 2px rgba(66, 133, 244, 0.1)":"0 2px 8px rgba(0, 0, 0, 0.12), 0 1px 4px rgba(0, 0, 0, 0.08)",backgroundColor:t?"#f8f9fa":"#ffffff","&:hover":{backgroundColor:t?"#ffffff":"#f8f9fa",boxShadow:t?"0 6px 20px rgba(0, 0, 0, 0.25), 0 3px 10px rgba(0, 0, 0, 0.2), 0 0 0 3px rgba(66, 133, 244, 0.15)":"0 4px 12px rgba(0, 0, 0, 0.15), 0 2px 6px rgba(0, 0, 0, 0.1)"}},children:t?s.jsx(EX,{className:"text-gray-700",sx:{fontSize:22,fontWeight:600}}):s.jsx(BX,{className:"text-gray-700 pr-1",sx:{fontSize:22}})}),r&&"undefined"!=typeof document&&wu.createPortal(s.jsx(qp,{in:r,timeout:300,children:s.jsx(rf,{className:"fixed inset-0 flex items-center justify-center z-[2000]",sx:{backgroundColor:"rgba(0, 0, 0, 0.7)",backdropFilter:"blur(4px)"},onClick:()=>o(!1),children:s.jsx(rf,{className:"max-w-[90vw] max-h-[90vh] flex items-center justify-center p-8",onClick:e=>e.stopPropagation(),children:s.jsx("img",{src:xY,alt:"Help illustration - enlarged",className:"max-w-full max-h-full rounded-lg shadow-2xl",style:{objectFit:"contain"}})})})}),document.body)]})}var CY=e=>"checkbox"===e.type,SY=e=>e instanceof Date,EY=e=>null==e;const BY=e=>"object"==typeof e;var IY=e=>!EY(e)&&!Array.isArray(e)&&BY(e)&&!SY(e),RY=e=>IY(e)&&e.target?CY(e.target)?e.target.checked:e.target.value:e,kY=(e,t)=>e.has((e=>e.substring(0,e.search(/\.\d+(\.|$)/))||e)(t)),TY="undefined"!=typeof window&&void 0!==window.HTMLElement&&"undefined"!=typeof document;function PY(e){let t;const n=Array.isArray(e),r="undefined"!=typeof FileList&&e instanceof FileList;if(e instanceof Date)t=new Date(e);else{if(TY&&(e instanceof Blob||r)||!n&&!IY(e))return e;if(t=n?[]:Object.create(Object.getPrototypeOf(e)),n||(e=>{const t=e.constructor&&e.constructor.prototype;return IY(t)&&t.hasOwnProperty("isPrototypeOf")})(e))for(const n in e)e.hasOwnProperty(n)&&(t[n]=PY(e[n]));else t=e}return t}var FY=e=>/^\w*$/.test(e),MY=e=>void 0===e,LY=e=>Array.isArray(e)?e.filter(Boolean):[],UY=e=>LY(e.replace(/["|']|\]/g,"").split(/\.|\[/)),OY=(e,t,n)=>{if(!t||!IY(e))return n;const r=(FY(t)?[t]:UY(t)).reduce((e,t)=>EY(e)?e:e[t],e);return MY(r)||r===e?MY(e[t])?n:e[t]:r},DY=e=>"boolean"==typeof e,NY=(e,t,n)=>{let r=-1;const o=FY(t)?[t]:UY(t),i=o.length,s=i-1;for(;++r<i;){const t=o[r];let i=n;if(r!==s){const n=e[t];i=IY(n)||Array.isArray(n)?n:isNaN(+o[r+1])?{}:[]}if("__proto__"===t||"constructor"===t||"prototype"===t)return;e[t]=i,e=e[t]}};const jY="blur",QY="focusout",zY="change",HY="onBlur",GY="onChange",VY="onSubmit",WY="onTouched",$Y="all",KY="max",XY="min",YY="maxLength",qY="minLength",JY="pattern",ZY="required",eq="validate",tq=fe.createContext(null);tq.displayName="HookFormContext";const nq=()=>fe.useContext(tq),rq=e=>{const{children:t,...n}=e;return fe.createElement(tq.Provider,{value:n},t)};var oq=(e,t,n,r=!0)=>{const o={defaultValues:t._defaultValues};for(const i in e)Object.defineProperty(o,i,{get:()=>{const o=i;return t._proxyFormState[o]!==$Y&&(t._proxyFormState[o]=!r||$Y),n&&(n[o]=!0),e[o]}});return o};const iq="undefined"!=typeof window?fe.useLayoutEffect:fe.useEffect;var sq=e=>"string"==typeof e,aq=(e,t,n,r,o)=>sq(e)?(r&&t.watch.add(e),OY(n,e,o)):Array.isArray(e)?e.map(e=>(r&&t.watch.add(e),OY(n,e))):(r&&(t.watchAll=!0),n),lq=e=>EY(e)||!BY(e);function cq(e,t,n=new WeakSet){if(lq(e)||lq(t))return e===t;if(SY(e)&&SY(t))return e.getTime()===t.getTime();const r=Object.keys(e),o=Object.keys(t);if(r.length!==o.length)return!1;if(n.has(e)||n.has(t))return!0;n.add(e),n.add(t);for(const i of r){const r=e[i];if(!o.includes(i))return!1;if("ref"!==i){const e=t[i];if(SY(r)&&SY(e)||IY(r)&&IY(e)||Array.isArray(r)&&Array.isArray(e)?!cq(r,e,n):r!==e)return!1}}return!0}function uq(e){const t=nq(),{name:n,disabled:r,control:o=t.control,shouldUnregister:i,defaultValue:s}=e,a=kY(o._names.array,n),l=fe.useMemo(()=>OY(o._formValues,n,OY(o._defaultValues,n,s)),[o,n,s]),c=function(e){const t=nq(),{control:n=t.control,name:r,defaultValue:o,disabled:i,exact:s,compute:a}=e||{},l=fe.useRef(o),c=fe.useRef(a),u=fe.useRef(void 0);c.current=a;const d=fe.useMemo(()=>n._getWatch(r,l.current),[n,r]),[A,h]=fe.useState(c.current?c.current(d):d);return iq(()=>n._subscribe({name:r,formState:{values:!0},exact:s,callback:e=>{if(!i){const t=aq(r,n._names,e.values||n._formValues,!1,l.current);if(c.current){const e=c.current(t);cq(e,u.current)||(h(e),u.current=e)}else h(t)}}}),[n,i,r,s]),fe.useEffect(()=>n._removeUnmounted()),A}({control:o,name:n,defaultValue:l,exact:!0}),u=function(e){const t=nq(),{control:n=t.control,disabled:r,name:o,exact:i}=e||{},[s,a]=fe.useState(n._formState),l=fe.useRef({isDirty:!1,isLoading:!1,dirtyFields:!1,touchedFields:!1,validatingFields:!1,isValidating:!1,isValid:!1,errors:!1});return iq(()=>n._subscribe({name:o,formState:l.current,exact:i,callback:e=>{!r&&a({...n._formState,...e})}}),[o,r,i]),fe.useEffect(()=>{l.current.isValid&&n._setValid(!0)},[n]),fe.useMemo(()=>oq(s,n,l.current,!1),[s,n])}({control:o,name:n,exact:!0}),d=fe.useRef(e),A=fe.useRef(void 0),h=fe.useRef(o.register(n,{...e.rules,value:c,...DY(e.disabled)?{disabled:e.disabled}:{}}));d.current=e;const p=fe.useMemo(()=>Object.defineProperties({},{invalid:{enumerable:!0,get:()=>!!OY(u.errors,n)},isDirty:{enumerable:!0,get:()=>!!OY(u.dirtyFields,n)},isTouched:{enumerable:!0,get:()=>!!OY(u.touchedFields,n)},isValidating:{enumerable:!0,get:()=>!!OY(u.validatingFields,n)},error:{enumerable:!0,get:()=>OY(u.errors,n)}}),[u,n]),f=fe.useCallback(e=>h.current.onChange({target:{value:RY(e),name:n},type:zY}),[n]),g=fe.useCallback(()=>h.current.onBlur({target:{value:OY(o._formValues,n),name:n},type:jY}),[n,o._formValues]),m=fe.useCallback(e=>{const t=OY(o._fields,n);t&&e&&(t._f.ref={focus:()=>e.focus&&e.focus(),select:()=>e.select&&e.select(),setCustomValidity:t=>e.setCustomValidity(t),reportValidity:()=>e.reportValidity()})},[o._fields,n]),y=fe.useMemo(()=>({name:n,value:c,...DY(r)||u.disabled?{disabled:u.disabled||r}:{},onChange:f,onBlur:g,ref:m}),[n,r,u.disabled,f,g,m,c]);return fe.useEffect(()=>{const e=o._options.shouldUnregister||i,t=A.current;t&&t!==n&&!a&&o.unregister(t),o.register(n,{...d.current.rules,...DY(d.current.disabled)?{disabled:d.current.disabled}:{}});const r=(e,t)=>{const n=OY(o._fields,e);n&&n._f&&(n._f.mount=t)};if(r(n,!0),e){const e=PY(OY(o._options.defaultValues,n));NY(o._defaultValues,n,e),MY(OY(o._formValues,n))&&NY(o._formValues,n,e)}return!a&&o.register(n),A.current=n,()=>{(a?e&&!o._state.action:e)?o.unregister(n):r(n,!1)}},[n,o,a,i]),fe.useEffect(()=>{o._setDisabledField({disabled:r,name:n})},[r,n,o]),fe.useMemo(()=>({field:y,formState:u,fieldState:p}),[y,u,p])}const dq=e=>e.render(uq(e));var Aq=(e,t,n,r,o)=>t?{...n[e],types:{...n[e]&&n[e].types?n[e].types:{},[r]:o||!0}}:{},hq=e=>Array.isArray(e)?e:[e],pq=()=>{let e=[];return{get observers(){return e},next:t=>{for(const n of e)n.next&&n.next(t)},subscribe:t=>(e.push(t),{unsubscribe:()=>{e=e.filter(e=>e!==t)}}),unsubscribe:()=>{e=[]}}};function fq(e,t){const n={};for(const r in e)if(e.hasOwnProperty(r)){const o=e[r],i=t[r];if(o&&IY(o)&&i){const e=fq(o,i);IY(e)&&(n[r]=e)}else e[r]&&(n[r]=i)}return n}var gq=e=>IY(e)&&!Object.keys(e).length,mq=e=>"file"===e.type,yq=e=>"function"==typeof e,vq=e=>{if(!TY)return!1;const t=e?e.ownerDocument:0;return e instanceof(t&&t.defaultView?t.defaultView.HTMLElement:HTMLElement)},bq=e=>"select-multiple"===e.type,wq=e=>"radio"===e.type,xq=e=>vq(e)&&e.isConnected;function _q(e,t){const n=Array.isArray(t)?t:FY(t)?[t]:UY(t),r=1===n.length?e:function(e,t){const n=t.slice(0,-1).length;let r=0;for(;r<n;)e=MY(e)?r++:e[t[r++]];return e}(e,n),o=n.length-1,i=n[o];return r&&delete r[i],0!==o&&(IY(r)&&gq(r)||Array.isArray(r)&&function(e){for(const t in e)if(e.hasOwnProperty(t)&&!MY(e[t]))return!1;return!0}(r))&&_q(e,n.slice(0,-1)),e}function Cq(e){return Array.isArray(e)||IY(e)&&!(e=>{for(const t in e)if(yq(e[t]))return!0;return!1})(e)}function Sq(e,t={}){for(const n in e)Cq(e[n])?(t[n]=Array.isArray(e[n])?[]:{},Sq(e[n],t[n])):EY(e[n])||(t[n]=!0);return t}function Eq(e,t,n){n||(n=Sq(t));for(const r in e)Cq(e[r])?MY(t)||lq(n[r])?n[r]=Sq(e[r],Array.isArray(e[r])?[]:{}):Eq(e[r],EY(t)?{}:t[r],n[r]):n[r]=!cq(e[r],t[r]);return n}const Bq={value:!1,isValid:!1},Iq={value:!0,isValid:!0};var Rq=e=>{if(Array.isArray(e)){if(e.length>1){const t=e.filter(e=>e&&e.checked&&!e.disabled).map(e=>e.value);return{value:t,isValid:!!t.length}}return e[0].checked&&!e[0].disabled?e[0].attributes&&!MY(e[0].attributes.value)?MY(e[0].value)||""===e[0].value?Iq:{value:e[0].value,isValid:!0}:Iq:Bq}return Bq},kq=(e,{valueAsNumber:t,valueAsDate:n,setValueAs:r})=>MY(e)?e:t?""===e?NaN:e?+e:e:n&&sq(e)?new Date(e):r?r(e):e;const Tq={isValid:!1,value:null};var Pq=e=>Array.isArray(e)?e.reduce((e,t)=>t&&t.checked&&!t.disabled?{isValid:!0,value:t.value}:e,Tq):Tq;function Fq(e){const t=e.ref;return mq(t)?t.files:wq(t)?Pq(e.refs).value:bq(t)?[...t.selectedOptions].map(({value:e})=>e):CY(t)?Rq(e.refs).value:kq(MY(t.value)?e.ref.value:t.value,e)}var Mq=e=>e instanceof RegExp,Lq=e=>MY(e)?e:Mq(e)?e.source:IY(e)?Mq(e.value)?e.value.source:e.value:e,Uq=e=>({isOnSubmit:!e||e===VY,isOnBlur:e===HY,isOnChange:e===GY,isOnAll:e===$Y,isOnTouch:e===WY});const Oq="AsyncFunction";var Dq=e=>!!e&&!!e.validate&&!!(yq(e.validate)&&e.validate.constructor.name===Oq||IY(e.validate)&&Object.values(e.validate).find(e=>e.constructor.name===Oq)),Nq=(e,t,n)=>!n&&(t.watchAll||t.watch.has(e)||[...t.watch].some(t=>e.startsWith(t)&&/^\.\w+/.test(e.slice(t.length))));const jq=(e,t,n,r)=>{for(const o of n||Object.keys(e)){const n=OY(e,o);if(n){const{_f:e,...i}=n;if(e){if(e.refs&&e.refs[0]&&t(e.refs[0],o)&&!r)return!0;if(e.ref&&t(e.ref,e.name)&&!r)return!0;if(jq(i,t))break}else if(IY(i)&&jq(i,t))break}}};function Qq(e,t,n){const r=OY(e,n);if(r||FY(n))return{error:r,name:n};const o=n.split(".");for(;o.length;){const r=o.join("."),i=OY(t,r),s=OY(e,r);if(i&&!Array.isArray(i)&&n!==r)return{name:n};if(s&&s.type)return{name:r,error:s};if(s&&s.root&&s.root.type)return{name:`${r}.root`,error:s.root};o.pop()}return{name:n}}var zq=(e,t,n)=>{const r=hq(OY(e,n));return NY(r,"root",t[n]),NY(e,n,r),e};function Hq(e,t,n="validate"){if(sq(e)||Array.isArray(e)&&e.every(sq)||DY(e)&&!e)return{type:n,message:sq(e)?e:"",ref:t}}var Gq=e=>IY(e)&&!Mq(e)?e:{value:e,message:""},Vq=async(e,t,n,r,o,i)=>{const{ref:s,refs:a,required:l,maxLength:c,minLength:u,min:d,max:A,pattern:h,validate:p,name:f,valueAsNumber:g,mount:m}=e._f,y=OY(n,f);if(!m||t.has(f))return{};const v=a?a[0]:s,b=e=>{o&&v.reportValidity&&(v.setCustomValidity(DY(e)?"":e||""),v.reportValidity())},w={},x=wq(s),_=CY(s),C=x||_,S=(g||mq(s))&&MY(s.value)&&MY(y)||vq(s)&&""===s.value||""===y||Array.isArray(y)&&!y.length,E=Aq.bind(null,f,r,w),B=(e,t,n,r=YY,o=qY)=>{const i=e?t:n;w[f]={type:e?r:o,message:i,ref:s,...E(e?r:o,i)}};if(i?!Array.isArray(y)||!y.length:l&&(!C&&(S||EY(y))||DY(y)&&!y||_&&!Rq(a).isValid||x&&!Pq(a).isValid)){const{value:e,message:t}=sq(l)?{value:!!l,message:l}:Gq(l);if(e&&(w[f]={type:ZY,message:t,ref:v,...E(ZY,t)},!r))return b(t),w}if(!(S||EY(d)&&EY(A))){let e,t;const n=Gq(A),o=Gq(d);if(EY(y)||isNaN(y)){const r=s.valueAsDate||new Date(y),i=e=>new Date((new Date).toDateString()+" "+e),a="time"==s.type,l="week"==s.type;sq(n.value)&&y&&(e=a?i(y)>i(n.value):l?y>n.value:r>new Date(n.value)),sq(o.value)&&y&&(t=a?i(y)<i(o.value):l?y<o.value:r<new Date(o.value))}else{const r=s.valueAsNumber||(y?+y:y);EY(n.value)||(e=r>n.value),EY(o.value)||(t=r<o.value)}if((e||t)&&(B(!!e,n.message,o.message,KY,XY),!r))return b(w[f].message),w}if((c||u)&&!S&&(sq(y)||i&&Array.isArray(y))){const e=Gq(c),t=Gq(u),n=!EY(e.value)&&y.length>+e.value,o=!EY(t.value)&&y.length<+t.value;if((n||o)&&(B(n,e.message,t.message),!r))return b(w[f].message),w}if(h&&!S&&sq(y)){const{value:e,message:t}=Gq(h);if(Mq(e)&&!y.match(e)&&(w[f]={type:JY,message:t,ref:s,...E(JY,t)},!r))return b(t),w}if(p)if(yq(p)){const e=Hq(await p(y,n),v);if(e&&(w[f]={...e,...E(eq,e.message)},!r))return b(e.message),w}else if(IY(p)){let e={};for(const t in p){if(!gq(e)&&!r)break;const o=Hq(await p[t](y,n),v,t);o&&(e={...o,...E(t,o.message)},b(o.message),r&&(w[f]=e))}if(!gq(e)&&(w[f]={ref:v,...e},!r))return w}return b(!0),w};const Wq={mode:VY,reValidateMode:GY,shouldFocusError:!0};function $q(e={}){let t,n={...Wq,...e},r={submitCount:0,isDirty:!1,isReady:!1,isLoading:yq(n.defaultValues),isValidating:!1,isSubmitted:!1,isSubmitting:!1,isSubmitSuccessful:!1,isValid:!1,touchedFields:{},dirtyFields:{},validatingFields:{},errors:n.errors||{},disabled:n.disabled||!1},o={},i=(IY(n.defaultValues)||IY(n.values))&&PY(n.defaultValues||n.values)||{},s=n.shouldUnregister?{}:PY(i),a={action:!1,mount:!1,watch:!1},l={mount:new Set,disabled:new Set,unMount:new Set,array:new Set,watch:new Set},c=0;const u={isDirty:!1,dirtyFields:!1,validatingFields:!1,touchedFields:!1,isValidating:!1,isValid:!1,errors:!1};let d={...u};const A={array:pq(),state:pq()},h=n.criteriaMode===$Y,p=async e=>{if(!n.disabled&&(u.isValid||d.isValid||e)){const e=n.resolver?gq((await v()).errors):await b(o,!0);e!==r.isValid&&A.state.next({isValid:e})}},f=(e,t)=>{!n.disabled&&(u.isValidating||u.validatingFields||d.isValidating||d.validatingFields)&&((e||Array.from(l.mount)).forEach(e=>{e&&(t?NY(r.validatingFields,e,t):_q(r.validatingFields,e))}),A.state.next({validatingFields:r.validatingFields,isValidating:!gq(r.validatingFields)}))},g=(e,t,n,r)=>{const l=OY(o,e);if(l){const o=OY(s,e,MY(n)?OY(i,e):n);MY(o)||r&&r.defaultChecked||t?NY(s,e,t?o:Fq(l._f)):_(e,o),a.mount&&p()}},m=(e,t,o,s,a)=>{let l=!1,c=!1;const h={name:e};if(!n.disabled){if(!o||s){(u.isDirty||d.isDirty)&&(c=r.isDirty,r.isDirty=h.isDirty=w(),l=c!==h.isDirty);const n=cq(OY(i,e),t);c=!!OY(r.dirtyFields,e),n?_q(r.dirtyFields,e):NY(r.dirtyFields,e,!0),h.dirtyFields=r.dirtyFields,l=l||(u.dirtyFields||d.dirtyFields)&&c!==!n}if(o){const t=OY(r.touchedFields,e);t||(NY(r.touchedFields,e,o),h.touchedFields=r.touchedFields,l=l||(u.touchedFields||d.touchedFields)&&t!==o)}l&&a&&A.state.next(h)}return l?h:{}},y=(e,o,i,s)=>{const a=OY(r.errors,e),l=(u.isValid||d.isValid)&&DY(o)&&r.isValid!==o;var h;if(n.delayError&&i?(h=()=>((e,t)=>{NY(r.errors,e,t),A.state.next({errors:r.errors})})(e,i),t=e=>{clearTimeout(c),c=setTimeout(h,e)},t(n.delayError)):(clearTimeout(c),t=null,i?NY(r.errors,e,i):_q(r.errors,e)),(i?!cq(a,i):a)||!gq(s)||l){const t={...s,...l&&DY(o)?{isValid:o}:{},errors:r.errors,name:e};r={...r,...t},A.state.next(t)}},v=async e=>{f(e,!0);const t=await n.resolver(s,n.context,((e,t,n,r)=>{const o={};for(const i of e){const e=OY(t,i);e&&NY(o,i,e._f)}return{criteriaMode:n,names:[...e],fields:o,shouldUseNativeValidation:r}})(e||l.mount,o,n.criteriaMode,n.shouldUseNativeValidation));return f(e),t},b=async(e,t,o={valid:!0})=>{for(const i in e){const a=e[i];if(a){const{_f:e,...i}=a;if(e){const i=l.array.has(e.name),c=a._f&&Dq(a._f);c&&u.validatingFields&&f([e.name],!0);const d=await Vq(a,l.disabled,s,h,n.shouldUseNativeValidation&&!t,i);if(c&&u.validatingFields&&f([e.name]),d[e.name]&&(o.valid=!1,t))break;!t&&(OY(d,e.name)?i?zq(r.errors,d,e.name):NY(r.errors,e.name,d[e.name]):_q(r.errors,e.name))}!gq(i)&&await b(i,t,o)}}return o.valid},w=(e,t)=>!n.disabled&&(e&&t&&NY(s,e,t),!cq(R(),i)),x=(e,t,n)=>aq(e,l,{...a.mount?s:MY(t)?i:sq(e)?{[e]:t}:t},n,t),_=(e,t,n={})=>{const r=OY(o,e);let i=t;if(r){const n=r._f;n&&(!n.disabled&&NY(s,e,kq(t,n)),i=vq(n.ref)&&EY(t)?"":t,bq(n.ref)?[...n.ref.options].forEach(e=>e.selected=i.includes(e.value)):n.refs?CY(n.ref)?n.refs.forEach(e=>{e.defaultChecked&&e.disabled||(Array.isArray(i)?e.checked=!!i.find(t=>t===e.value):e.checked=i===e.value||!!i)}):n.refs.forEach(e=>e.checked=e.value===i):mq(n.ref)?n.ref.value="":(n.ref.value=i,n.ref.type||A.state.next({name:e,values:PY(s)})))}(n.shouldDirty||n.shouldTouch)&&m(e,i,n.shouldTouch,n.shouldDirty,!0),n.shouldValidate&&I(e)},C=(e,t,n)=>{for(const r in t){if(!t.hasOwnProperty(r))return;const i=t[r],s=e+"."+r,a=OY(o,s);(l.array.has(e)||IY(i)||a&&!a._f)&&!SY(i)?C(s,i,n):_(s,i,n)}},S=(e,t,n={})=>{const c=OY(o,e),h=l.array.has(e),p=PY(t);NY(s,e,p),h?(A.array.next({name:e,values:PY(s)}),(u.isDirty||u.dirtyFields||d.isDirty||d.dirtyFields)&&n.shouldDirty&&A.state.next({name:e,dirtyFields:Eq(i,s),isDirty:w(e,p)})):!c||c._f||EY(p)?_(e,p,n):C(e,p,n),Nq(e,l)&&A.state.next({...r,name:e}),A.state.next({name:a.mount?e:void 0,values:PY(s)})},E=async e=>{a.mount=!0;const i=e.target;let c=i.name,g=!0;const w=OY(o,c),x=e=>{g=Number.isNaN(e)||SY(e)&&isNaN(e.getTime())||cq(e,OY(s,c,e))},_=Uq(n.mode),C=Uq(n.reValidateMode);if(w){let a,S;const E=i.type?Fq(w._f):RY(e),B=e.type===jY||e.type===QY,R=!(e=>e.mount&&(e.required||e.min||e.max||e.maxLength||e.minLength||e.pattern||e.validate))(w._f)&&!n.resolver&&!OY(r.errors,c)&&!w._f.deps||((e,t,n,r,o)=>!o.isOnAll&&(!n&&o.isOnTouch?!(t||e):(n?r.isOnBlur:o.isOnBlur)?!e:!(n?r.isOnChange:o.isOnChange)||e))(B,OY(r.touchedFields,c),r.isSubmitted,C,_),k=Nq(c,l,B);NY(s,c,E),B?i&&i.readOnly||(w._f.onBlur&&w._f.onBlur(e),t&&t(0)):w._f.onChange&&w._f.onChange(e);const T=m(c,E,B),P=!gq(T)||k;if(!B&&A.state.next({name:c,type:e.type,values:PY(s)}),R)return(u.isValid||d.isValid)&&("onBlur"===n.mode?B&&p():B||p()),P&&A.state.next({name:c,...k?{}:T});if(!B&&k&&A.state.next({...r}),n.resolver){const{errors:e}=await v([c]);if(x(E),g){const t=Qq(r.errors,o,c),n=Qq(e,o,t.name||c);a=n.error,c=n.name,S=gq(e)}}else f([c],!0),a=(await Vq(w,l.disabled,s,h,n.shouldUseNativeValidation))[c],f([c]),x(E),g&&(a?S=!1:(u.isValid||d.isValid)&&(S=await b(o,!0)));g&&(w._f.deps&&(!Array.isArray(w._f.deps)||w._f.deps.length>0)&&I(w._f.deps),y(c,S,a,T))}},B=(e,t)=>{if(OY(r.errors,t)&&e.focus)return e.focus(),1},I=async(e,t={})=>{let i,s;const a=hq(e);if(n.resolver){const t=await(async e=>{const{errors:t}=await v(e);if(e)for(const n of e){const e=OY(t,n);e?NY(r.errors,n,e):_q(r.errors,n)}else r.errors=t;return t})(MY(e)?e:a);i=gq(t),s=e?!a.some(e=>OY(t,e)):i}else e?(s=(await Promise.all(a.map(async e=>{const t=OY(o,e);return await b(t&&t._f?{[e]:t}:t)}))).every(Boolean),(s||r.isValid)&&p()):s=i=await b(o);return A.state.next({...!sq(e)||(u.isValid||d.isValid)&&i!==r.isValid?{}:{name:e},...n.resolver||!e?{isValid:i}:{},errors:r.errors}),t.shouldFocus&&!s&&jq(o,B,e?a:l.mount),s},R=(e,t)=>{let n={...a.mount?s:i};return t&&(n=fq(t.dirtyFields?r.dirtyFields:r.touchedFields,n)),MY(e)?n:sq(e)?OY(n,e):e.map(e=>OY(n,e))},k=(e,t)=>({invalid:!!OY((t||r).errors,e),isDirty:!!OY((t||r).dirtyFields,e),error:OY((t||r).errors,e),isValidating:!!OY(r.validatingFields,e),isTouched:!!OY((t||r).touchedFields,e)}),T=(e,t,n)=>{const i=(OY(o,e,{_f:{}})._f||{}).ref,s=OY(r.errors,e)||{},{ref:a,message:l,type:c,...u}=s;NY(r.errors,e,{...u,...t,ref:i}),A.state.next({name:e,errors:r.errors,isValid:!1}),n&&n.shouldFocus&&i&&i.focus&&i.focus()},P=e=>A.state.subscribe({next:t=>{var n,o,a;n=e.name,o=t.name,a=e.exact,n&&o&&n!==o&&!hq(n).some(e=>e&&(a?e===o:e.startsWith(o)||o.startsWith(e)))||!((e,t,n,r)=>{n(e);const{name:o,...i}=e;return gq(i)||Object.keys(i).length>=Object.keys(t).length||Object.keys(i).find(e=>t[e]===(!r||$Y))})(t,e.formState||u,j,e.reRenderRoot)||e.callback({values:{...s},...r,...t,defaultValues:i})}}).unsubscribe,F=(e,t={})=>{for(const a of e?hq(e):l.mount)l.mount.delete(a),l.array.delete(a),t.keepValue||(_q(o,a),_q(s,a)),!t.keepError&&_q(r.errors,a),!t.keepDirty&&_q(r.dirtyFields,a),!t.keepTouched&&_q(r.touchedFields,a),!t.keepIsValidating&&_q(r.validatingFields,a),!n.shouldUnregister&&!t.keepDefaultValue&&_q(i,a);A.state.next({values:PY(s)}),A.state.next({...r,...t.keepDirty?{isDirty:w()}:{}}),!t.keepIsValid&&p()},M=({disabled:e,name:t})=>{(DY(e)&&a.mount||e||l.disabled.has(t))&&(e?l.disabled.add(t):l.disabled.delete(t))},L=(e,t={})=>{let r=OY(o,e);const s=DY(t.disabled)||DY(n.disabled);return NY(o,e,{...r||{},_f:{...r&&r._f?r._f:{ref:{name:e}},name:e,mount:!0,...t}}),l.mount.add(e),r?M({disabled:DY(t.disabled)?t.disabled:n.disabled,name:e}):g(e,!0,t.value),{...s?{disabled:t.disabled||n.disabled}:{},...n.progressive?{required:!!t.required,min:Lq(t.min),max:Lq(t.max),minLength:Lq(t.minLength),maxLength:Lq(t.maxLength),pattern:Lq(t.pattern)}:{},name:e,onChange:E,onBlur:E,ref:s=>{if(s){L(e,t),r=OY(o,e);const n=MY(s.value)&&s.querySelectorAll&&s.querySelectorAll("input,select,textarea")[0]||s,a=(e=>wq(e)||CY(e))(n),l=r._f.refs||[];if(a?l.find(e=>e===n):n===r._f.ref)return;NY(o,e,{_f:{...r._f,...a?{refs:[...l.filter(xq),n,...Array.isArray(OY(i,e))?[{}]:[]],ref:{type:n.type,name:e}}:{ref:n}}}),g(e,!1,void 0,n)}else r=OY(o,e,{}),r._f&&(r._f.mount=!1),(n.shouldUnregister||t.shouldUnregister)&&(!kY(l.array,e)||!a.action)&&l.unMount.add(e)}}},U=()=>n.shouldFocusError&&jq(o,B,l.mount),O=(e,t)=>async i=>{let a;i&&(i.preventDefault&&i.preventDefault(),i.persist&&i.persist());let c=PY(s);if(A.state.next({isSubmitting:!0}),n.resolver){const{errors:e,values:t}=await v();r.errors=e,c=PY(t)}else await b(o);if(l.disabled.size)for(const e of l.disabled)_q(c,e);if(_q(r.errors,"root"),gq(r.errors)){A.state.next({errors:{}});try{await e(c,i)}catch(u){a=u}}else t&&await t({...r.errors},i),U(),setTimeout(U);if(A.state.next({isSubmitted:!0,isSubmitting:!1,isSubmitSuccessful:gq(r.errors)&&!a,submitCount:r.submitCount+1,errors:r.errors}),a)throw a},D=(e,t={})=>{const c=e?PY(e):i,d=PY(c),h=gq(e),p=h?i:d;if(t.keepDefaultValues||(i=c),!t.keepValues){if(t.keepDirtyValues){const e=new Set([...l.mount,...Object.keys(Eq(i,s))]);for(const t of Array.from(e))OY(r.dirtyFields,t)?NY(p,t,OY(s,t)):S(t,OY(p,t))}else{if(TY&&MY(e))for(const e of l.mount){const t=OY(o,e);if(t&&t._f){const e=Array.isArray(t._f.refs)?t._f.refs[0]:t._f.ref;if(vq(e)){const t=e.closest("form");if(t){t.reset();break}}}}if(t.keepFieldsRef)for(const e of l.mount)S(e,OY(p,e));else o={}}s=n.shouldUnregister?t.keepDefaultValues?PY(i):{}:PY(p),A.array.next({values:{...p}}),A.state.next({values:{...p}})}l={mount:t.keepDirtyValues?l.mount:new Set,unMount:new Set,array:new Set,disabled:new Set,watch:new Set,watchAll:!1,focus:""},a.mount=!u.isValid||!!t.keepIsValid||!!t.keepDirtyValues,a.watch=!!n.shouldUnregister,A.state.next({submitCount:t.keepSubmitCount?r.submitCount:0,isDirty:!h&&(t.keepDirty?r.isDirty:!(!t.keepDefaultValues||cq(e,i))),isSubmitted:!!t.keepIsSubmitted&&r.isSubmitted,dirtyFields:h?{}:t.keepDirtyValues?t.keepDefaultValues&&s?Eq(i,s):r.dirtyFields:t.keepDefaultValues&&e?Eq(i,e):t.keepDirty?r.dirtyFields:{},touchedFields:t.keepTouched?r.touchedFields:{},errors:t.keepErrors?r.errors:{},isSubmitSuccessful:!!t.keepIsSubmitSuccessful&&r.isSubmitSuccessful,isSubmitting:!1,defaultValues:i})},N=(e,t)=>D(yq(e)?e(s):e,t),j=e=>{r={...r,...e}},Q={control:{register:L,unregister:F,getFieldState:k,handleSubmit:O,setError:T,_subscribe:P,_runSchema:v,_focusError:U,_getWatch:x,_getDirty:w,_setValid:p,_setFieldArray:(e,t=[],l,c,h=!0,p=!0)=>{if(c&&l&&!n.disabled){if(a.action=!0,p&&Array.isArray(OY(o,e))){const t=l(OY(o,e),c.argA,c.argB);h&&NY(o,e,t)}if(p&&Array.isArray(OY(r.errors,e))){const t=l(OY(r.errors,e),c.argA,c.argB);h&&NY(r.errors,e,t),((e,t)=>{!LY(OY(e,t)).length&&_q(e,t)})(r.errors,e)}if((u.touchedFields||d.touchedFields)&&p&&Array.isArray(OY(r.touchedFields,e))){const t=l(OY(r.touchedFields,e),c.argA,c.argB);h&&NY(r.touchedFields,e,t)}(u.dirtyFields||d.dirtyFields)&&(r.dirtyFields=Eq(i,s)),A.state.next({name:e,isDirty:w(e,t),dirtyFields:r.dirtyFields,errors:r.errors,isValid:r.isValid})}else NY(s,e,t)},_setDisabledField:M,_setErrors:e=>{r.errors=e,A.state.next({errors:r.errors,isValid:!1})},_getFieldArray:e=>LY(OY(a.mount?s:i,e,n.shouldUnregister?OY(i,e,[]):[])),_reset:D,_resetDefaultValues:()=>yq(n.defaultValues)&&n.defaultValues().then(e=>{N(e,n.resetOptions),A.state.next({isLoading:!1})}),_removeUnmounted:()=>{for(const e of l.unMount){const t=OY(o,e);t&&(t._f.refs?t._f.refs.every(e=>!xq(e)):!xq(t._f.ref))&&F(e)}l.unMount=new Set},_disableForm:e=>{DY(e)&&(A.state.next({disabled:e}),jq(o,(t,n)=>{const r=OY(o,n);r&&(t.disabled=r._f.disabled||e,Array.isArray(r._f.refs)&&r._f.refs.forEach(t=>{t.disabled=r._f.disabled||e}))},0,!1))},_subjects:A,_proxyFormState:u,get _fields(){return o},get _formValues(){return s},get _state(){return a},set _state(e){a=e},get _defaultValues(){return i},get _names(){return l},set _names(e){l=e},get _formState(){return r},get _options(){return n},set _options(e){n={...n,...e}}},subscribe:e=>(a.mount=!0,d={...d,...e.formState},P({...e,formState:d})),trigger:I,register:L,handleSubmit:O,watch:(e,t)=>yq(e)?A.state.subscribe({next:n=>"values"in n&&e(x(void 0,t),n)}):x(e,t,!0),setValue:S,getValues:R,reset:N,resetField:(e,t={})=>{OY(o,e)&&(MY(t.defaultValue)?S(e,PY(OY(i,e))):(S(e,t.defaultValue),NY(i,e,PY(t.defaultValue))),t.keepTouched||_q(r.touchedFields,e),t.keepDirty||(_q(r.dirtyFields,e),r.isDirty=t.defaultValue?w(e,PY(OY(i,e))):w()),t.keepError||(_q(r.errors,e),u.isValid&&p()),A.state.next({...r}))},clearErrors:e=>{e&&hq(e).forEach(e=>_q(r.errors,e)),A.state.next({errors:e?r.errors:{}})},unregister:F,setError:T,setFocus:(e,t={})=>{const n=OY(o,e),r=n&&n._f;if(r){const e=r.refs?r.refs[0]:r.ref;e.focus&&(e.focus(),t.shouldSelect&&yq(e.select)&&e.select())}},getFieldState:k};return{...Q,formControl:Q}}function Kq(e={}){const t=fe.useRef(void 0),n=fe.useRef(void 0),[r,o]=fe.useState({isDirty:!1,isValidating:!1,isLoading:yq(e.defaultValues),isSubmitted:!1,isSubmitting:!1,isSubmitSuccessful:!1,isValid:!1,submitCount:0,dirtyFields:{},touchedFields:{},validatingFields:{},errors:e.errors||{},disabled:e.disabled||!1,isReady:!1,defaultValues:yq(e.defaultValues)?void 0:e.defaultValues});if(!t.current)if(e.formControl)t.current={...e.formControl,formState:r},e.defaultValues&&!yq(e.defaultValues)&&e.formControl.reset(e.defaultValues,e.resetOptions);else{const{formControl:n,...o}=$q(e);t.current={...o,formState:r}}const i=t.current.control;return i._options=e,iq(()=>{const e=i._subscribe({formState:i._proxyFormState,callback:()=>o({...i._formState}),reRenderRoot:!0});return o(e=>({...e,isReady:!0})),i._formState.isReady=!0,e},[i]),fe.useEffect(()=>i._disableForm(e.disabled),[i,e.disabled]),fe.useEffect(()=>{e.mode&&(i._options.mode=e.mode),e.reValidateMode&&(i._options.reValidateMode=e.reValidateMode)},[i,e.mode,e.reValidateMode]),fe.useEffect(()=>{e.errors&&(i._setErrors(e.errors),i._focusError())},[i,e.errors]),fe.useEffect(()=>{e.shouldUnregister&&i._subjects.state.next({values:i._getWatch()})},[i,e.shouldUnregister]),fe.useEffect(()=>{if(i._proxyFormState.isDirty){const e=i._getDirty();e!==r.isDirty&&i._subjects.state.next({isDirty:e})}},[i,r.isDirty]),fe.useEffect(()=>{e.values&&!cq(e.values,n.current)?(i._reset(e.values,{keepFieldsRef:!0,...i._options.resetOptions}),n.current=e.values,o(e=>({...e}))):i._resetDefaultValues()},[i,e.values]),fe.useEffect(()=>{i._state.mount||(i._setValid(),i._state.mount=!0),i._state.watch&&(i._state.watch=!1,i._subjects.state.next({...i._formState})),i._removeUnmounted()}),t.current.formState=oq(r,i),t.current}function Xq({validateGcpProjectId:e}){const{setValue:t,watch:n,trigger:r,control:o,formState:{errors:i}}=nq(),[a,l]=pe.useState({status:"idle"}),[c,u]=pe.useState(""),{data:d,isLoading:A,error:h}=Se({queryKey:eX.gcpProjects,queryFn:async()=>await pj.getGcpProjects(),staleTime:12e4,retry:!1}),p=n("googleCloudProjectId"),f=n("googleCloudProjectNumber"),g=Ee({mutationFn:async e=>{const t=await pj.verifyProjectDetails(e);if(!t.success)throw new Error(t.message);return t.data}}),m=d?.data||[],y=d?!d.success:!!h;pe.useEffect(()=>{if(y&&h){const e=lj(h);Fw("Manual Entry Available",{description:e})}},[y,h]);const v=m.find(e=>e.project_id===p),b=v&&f&&f===v.project_number||!v&&f&&"success"===a.status&&a.verifiedProjectId===p;pe.useEffect(()=>{v&&(l({status:"idle"}),t("googleCloudProjectNumber",v.project_number))},[v,t]),pe.useEffect(()=>{p&&""!==p.trim()&&(v?f!==v.project_number&&(t("googleCloudProjectNumber",v.project_number),l({status:"idle"})):f&&"success"!==a.status&&a.verifiedProjectId!==p&&(t("googleCloudProjectNumber",""),l({status:"idle"})))},[p,v,f,a,t]),pe.useEffect(()=>{"success"===a.status&&a.verifiedProjectId&&p!==a.verifiedProjectId&&!v&&(l({status:"idle"}),t("googleCloudProjectNumber",""))},[p,a.status,a.verifiedProjectId,v,t,f]);const w=()=>{if(!c.trim())return m;const e=m.filter(e=>e.project_id.toLowerCase().includes(c.toLowerCase()));return!m.some(e=>e.project_id.toLowerCase()===c.toLowerCase())&&c.trim()?[...e,{inputValue:c,project_id:`Add "${c}"`,project_number:void 0}]:e};return s.jsxs("div",{className:"space-y-2",children:[s.jsxs("div",{className:"space-y-1",children:[s.jsx(vA,{variant:"body2",className:"font-semibold text-sm",children:"Google Cloud Project"}),s.jsx(vA,{variant:"caption",className:"text-mui-secondary text-xs",children:"Select or enter your Google Cloud Project for BigQuery data storage."}),p&&""!==p.trim()&&(v||"success"===a.status)&&s.jsxs(vm,{href:`https://console.cloud.google.com/home/dashboard?project=${p}`,target:"_blank",rel:"noopener noreferrer",className:"text-xs text-blue-600 hover:text-blue-800 underline ml-1.5",children:["Project console"," ",s.jsx("span",{className:"text-xs text-blue-600 hover:text-blue-800 underline",children:s.jsx(JX,{className:"w-4 h-4"})})]})]}),s.jsxs("div",{className:"space-y-2",children:[A&&s.jsxs(rf,{className:"flex items-center justify-center p-4",children:[s.jsx(Yd,{size:20}),s.jsx(vA,{variant:"body2",className:"ml-2 text-mui-secondary text-sm",children:"Fetching GCP projects..."})]}),!A&&s.jsxs(rf,{className:"flex gap-2 items-start",children:[s.jsx(rf,{className:"flex-1",children:s.jsx(dq,{name:"googleCloudProjectId",control:o,rules:{required:"Google Cloud Project ID is required",validate:e,pattern:{value:/^[a-z]([a-z0-9-]*[a-z0-9])?$/,message:"Project ID must start with a lowercase letter, contain only lowercase letters, digits, or hyphens, and end with a letter or number"}},render:({field:e})=>s.jsx(Xp,{freeSolo:!0,selectOnFocus:!0,clearOnBlur:!0,handleHomeEndKeys:!0,disableClearable:!!b,options:w(),getOptionLabel:e=>"string"==typeof e?e:"inputValue"in e&&e.inputValue?e.inputValue:e.project_id||"",isOptionEqualToValue:(e,t)=>"string"==typeof t?e.project_id===t:e.project_id===t.project_id,filterOptions:e=>e,renderOption:(e,t)=>{const n="inputValue"in t&&t.inputValue;return pe.createElement("li",{...e,key:n?`create-${t.inputValue}`:t.project_id},s.jsxs(rf,{className:"flex flex-col",children:[s.jsx(vA,{variant:"body2",className:"font-medium text-xs",children:n?`Check for "${t.inputValue}"`:t.project_id}),!n&&s.jsxs(vA,{variant:"caption",className:"text-mui-secondary text-xs",children:["Project Number: ",t.project_number]})]}))},onChange:(n,r)=>{if(!r)return e.onChange(""),void t("googleCloudProjectNumber","");"string"==typeof r?(e.onChange(r),t("googleCloudProjectNumber","")):"inputValue"in r&&r.inputValue?(e.onChange(r.inputValue),t("googleCloudProjectNumber",""),l({status:"idle"})):(e.onChange(r.project_id),t("googleCloudProjectNumber",r.project_number||""))},onInputChange:(n,r,o)=>{u(r),"reset"!==o&&(e.onChange(r),"success"===a.status&&a.verifiedProjectId&&r!==a.verifiedProjectId&&(l({status:"idle"}),t("googleCloudProjectNumber","")))},value:m.find(t=>t.project_id===e.value)||e.value||null,inputValue:c,renderInput:e=>s.jsx(Dv,{...e,variant:"standard",label:"Google Cloud Project ID",placeholder:"Type or select project ID",error:!!i.googleCloudProjectId,helperText:i.googleCloudProjectId?.message||(0!==m.length||y?"":"No available projects found"),slotProps:{input:{...e.InputProps,endAdornment:s.jsxs(rf,{sx:{display:"flex",alignItems:"center",gap:b?1.5:0},children:[b&&s.jsx(SX,{className:"w-5 h-5 text-green-600",sx:{flexShrink:0,marginRight:"4px"}}),e.InputProps.endAdornment]}),className:"text-sm"},inputLabel:{className:"text-sm"}}})})})}),p&&!v&&"success"!==a.status&&s.jsx(Nv,{variant:"text",onClick:()=>{p&&""!==p.trim()?(l({status:"verifying"}),g.mutate(p,{onSuccess:e=>{e.project_number?(t("googleCloudProjectNumber",e.project_number),l({status:"success",message:"Project verified successfully",verifiedProjectId:p}),Tw("Project Verified",{description:`Project ${p} verified successfully`}),r("googleCloudProjectId"),r("googleCloudProjectNumber")):(l({status:"error",message:"Project number not found"}),Pw("Verification Failed",{description:"Project number not found"}))},onError:e=>{const t=lj(e);l({status:"error",message:t}),Pw("Verification Failed",{description:t})}})):Pw("Project ID Required",{description:"Please enter a Project ID first"})},disabled:!p||""===p.trim()||g.isPending,className:"mt-4 text-xs",children:g.isPending?s.jsx(Yd,{size:16}):"Verify"})]})]})]})}function Yq({state:e,onFileUpload:t,onDownloadSample:n,onDragEnter:r,onDragLeave:o,onDragOver:i,onDrop:a}){const l=pe.useRef(null);return s.jsxs("div",{className:"space-y-2",children:[s.jsxs("div",{className:"space-y-1",children:[s.jsx(vA,{variant:"body2",className:"font-semibold text-sm",children:"Jurisdiction Boundary"}),s.jsxs(rf,{className:"flex flex-col gap-1",children:[s.jsx(vA,{variant:"caption",className:"text-mui-secondary text-xs",children:"Upload a GeoJSON file that defines the geographic boundary of your jurisdiction."}),s.jsx(vA,{variant:"caption",className:"text-mui-secondary text-xs",children:"This boundary will be used to filter and monitor traffic within the specified area."})]}),s.jsx(rf,{className:"flex items-center gap-2"})]}),s.jsx("div",{className:"space-y-2 p-2 bg-gray-50/30 rounded",children:s.jsxs("div",{onDragEnter:r,onDragLeave:o,onDragOver:i,onDrop:a,onClick:()=>{l.current?.click()},className:"border-2 border-dashed rounded p-4 text-center cursor-pointer transition-all "+(e.dragActive?"border-mui-primary bg-blue-50":e.uploadedGeoJson?"border-green-400 bg-green-50":"border-gray-300 hover:border-gray-400 bg-white"),children:[s.jsx("input",{ref:l,type:"file",accept:".json,.geojson",onChange:e=>{e.target.files&&e.target.files[0]&&t(e.target.files[0])},className:"hidden"}),s.jsxs("div",{className:"space-y-2",children:[e.uploadedGeoJson?s.jsx(SX,{className:"w-5 h-5 text-green-600 mx-auto"}):s.jsx(kX,{className:"w-5 h-5 text-gray-400 mx-auto"}),s.jsxs("div",{children:[s.jsx("p",{className:"text-xs font-medium text-mui-primary",children:e.uploadedGeoJson?"Uploaded Successfully":e.dragActive?"Drop here":"Upload Jurisdiction Boundary"}),s.jsx("p",{className:"text-xs text-mui-secondary",children:e.uploadedGeoJson?"Upload or drop a new file to replace":".geojson and .json files supported"})]})]})]})})]})}function qq({validateProjectName:e}){const{register:t,formState:{errors:n}}=nq();return s.jsxs("div",{className:"space-y-2",children:[s.jsxs("div",{className:"space-y-1",children:[s.jsx(vA,{variant:"body2",className:"font-semibold text-sm",children:"Project Name"}),s.jsx(vA,{variant:"caption",className:"text-mui-secondary text-xs",children:"Choose a unique name for your project"})]}),s.jsx(Dv,{...t("name",{required:"Project name is required",maxLength:{value:100,message:"Project name must not exceed 100 characters"},validate:t=>{if(e){const n=e(t);if(!0!==n)return n}return!(t.trim().length>100)||"Project name must not exceed 100 characters"}}),variant:"standard",label:"Project Name",placeholder:"Enter project name",fullWidth:!0,size:"small",error:!!n.name,helperText:n.name?.message||"",inputProps:{maxLength:100},slotProps:{input:{className:"text-sm"},inputLabel:{className:"text-sm"}}})]})}const Jq=["Google Cloud Project","Project Name","Jurisdiction Boundary"];function Zq({onStepChange:e}){const t=_c(),[n,r]=pe.useState(0);fe.useEffect(()=>{e?.(n)},[n,e]);const{geoJsonState:o,formState:i,updateGeoJsonState:a,updateFormState:l,clearProjectCreationState:c}=ej(),u=(()=>{const e=ye();return Ee({mutationFn:async e=>{const t=await pj.create(e);if(!t.success)throw new Error(t.message);return t.data},onSuccess:()=>{e.invalidateQueries({queryKey:eX.projects}),e.invalidateQueries({queryKey:eX.gcpProjects})}})})(),{data:d}=tX(),A=Kq({defaultValues:{name:"",googleCloudProjectId:"",googleCloudProjectNumber:"",subscriptionId:""},mode:"onChange"}),h=e=>{if(!e||""===e.trim())return"Project name is required";if(d){if(d.find(t=>t.name.toLowerCase().trim()===e.toLowerCase().trim()))return`A project with the name "${e}" already exists. Please choose a different name.`}return!0},p=e=>{if(!e||""===e.trim())return"Google Cloud Project ID is required";if(d){const t=d.find(t=>t.bigQueryColumn?.googleCloudProjectId?.toLowerCase().trim()===e.toLowerCase().trim());if(t)return`A project with Google Cloud Project ID "${e}" already exists (Project: "${t.name}"). Each GCP project can only be used once.`}return!0},{handleSubmit:f,watch:g,trigger:m,formState:y}=A,v=g(),{errors:b}=y,w=e=>{const t=e.name.toLowerCase();if(!t.endsWith(".json")&&!t.endsWith(".geojson"))return a({uploadedGeoJson:null,error:null,text:""}),void Pw("Invalid File Type",{description:"Only .json and .geojson files are supported"});const n=new FileReader;n.onload=e=>{const t=e.target?.result;a({text:t});try{const e=JSON.parse(t);let n=[];if("FeatureCollection"===e.type)n=e.features||[];else if("Feature"===e.type)n=[e];else{if("Polygon"!==e.type)return a({uploadedGeoJson:null,error:null,text:""}),void Pw("Invalid File",{description:"Invalid GeoJSON structure"});n=[{type:"Feature",geometry:e,properties:{}}]}if(0===n.length)return a({uploadedGeoJson:null,error:null,text:""}),void Pw("Invalid File",{description:"GeoJSON must contain at least one feature"});if(n.length>1)return a({uploadedGeoJson:null,error:null,text:""}),void Pw("Too Many Features",{description:"Upload a file with only 1 polygon feature"});const r=n[0];if(!r.geometry||"Polygon"!==r.geometry.type)return a({uploadedGeoJson:null,error:null,text:""}),void Pw("Invalid Geometry Type",{description:`File does not contain a polygon geometry type. Found: ${r.geometry?.type||"none"}`});a({uploadedGeoJson:e,error:null}),Tw("File Uploaded",{description:"GeoJSON file validated successfully"})}catch(n){a({uploadedGeoJson:null,error:null,text:""}),Pw("Invalid File",{description:"Invalid JSON format. Please check your file syntax."})}},n.readAsText(e)},x=()=>{const e=new Blob([JSON.stringify({type:"FeatureCollection",features:[{type:"Feature",properties:{},geometry:{type:"Polygon",coordinates:[[[78.9629,20.5937],[78.9629,20.6037],[78.9729,20.6037],[78.9729,20.5937],[78.9629,20.5937]]]}}]},null,2)],{type:"application/json"}),t=URL.createObjectURL(e),n=document.createElement("a");n.href=t,n.download="sample-boundary.geojson",n.click(),URL.revokeObjectURL(t)},_=e=>{e.preventDefault(),a({dragActive:!0})},C=e=>{e.preventDefault(),a({dragActive:!1})},S=e=>{e.preventDefault()},E=e=>{e.preventDefault(),a({dragActive:!1});const t=Array.from(e.dataTransfer.files);t.length>0&&w(t[0])},B=async e=>{l({isLoading:!0,error:null});try{if(!o.uploadedGeoJson){const e="Please upload a valid GeoJSON boundary";throw Pw("Missing Boundary",{description:e}),new Error(e)}if(!e.googleCloudProjectId||!e.googleCloudProjectNumber){const e="Please select a GCP project or enter project details manually";throw Pw("Missing GCP Project",{description:e}),new Error(e)}const n={name:e.name,boundaryGeoJson:o.uploadedGeoJson,bigQueryColumn:{googleCloudProjectId:e.googleCloudProjectId,googleCloudProjectNumber:e.googleCloudProjectNumber,subscriptionId:e.subscriptionId||void 0}},r=await u.mutateAsync(n);if(!r||!r.id)throw new Error("Failed to create project");l({isLoading:!1,success:!0}),Tw("Project Created",{description:`Project "${e.name}" created successfully`}),tj(),t(`/project/${r.id}`)}catch(n){const e=n instanceof Error?n.message:"Failed to create project";l({isLoading:!1,error:e}),Pw("Project Creation Failed",{description:e})}},I=e=>{switch(e){case 0:const e=""!==v.googleCloudProjectId.trim(),t=""!==v.googleCloudProjectNumber.trim(),n=!!b.googleCloudProjectId||!!b.googleCloudProjectNumber;return e&&t&&!n;case 1:const r=""!==v.name.trim(),i=!!b.name;return r&&!i;case 2:return null!==o.uploadedGeoJson&&!o.error;default:return!1}},R=i.isLoading||u.isPending;return s.jsxs(gd,{elevation:8,className:"fixed top-24 left-4 w-80 max-h-[calc(100vh-2rem)] bg-white/95 backdrop-blur-[10px] rounded-2xl z-[1000] transition-all duration-300 flex flex-col",children:[s.jsxs(rf,{className:"p-4 border-b border-gray-200",children:[s.jsx(vA,{variant:"h6",className:"font-semibold text-base",children:"Create New Project"}),s.jsxs(vA,{variant:"caption",className:"text-mui-secondary text-xs",children:["Step ",n+1," of ",Jq.length,": ",Jq[n]]})]}),s.jsx(rf,{className:"flex-1 overflow-auto px-4",children:s.jsx(rq,{...A,children:s.jsx("form",{onSubmit:f(B),children:(e=>{switch(e){case 0:return s.jsx(rf,{className:"py-3",children:s.jsx(Xq,{validateGcpProjectId:p})});case 1:return s.jsx(rf,{className:"py-3",children:s.jsx(qq,{validateProjectName:h})});case 2:return s.jsx(rf,{className:"py-3",children:s.jsx(Yq,{state:o,onFileUpload:w,onDownloadSample:x,onDragEnter:_,onDragLeave:C,onDragOver:S,onDrop:E})});default:return null}})(n)})})}),s.jsx(rf,{className:"p-4 border-t border-gray-200",children:s.jsxs(rf,{className:"flex gap-2",children:[s.jsx(Nv,{onClick:()=>{c(),t("/dashboard")},disabled:R,variant:"outlined",className:"flex-1 ",children:"Cancel"}),n>0&&s.jsx(Nv,{onClick:()=>{r(e=>e-1)},disabled:R,variant:"outlined",className:"flex-1 ",children:"Back"}),n<Jq.length-1?s.jsx(Nv,{onClick:async()=>{let e=!1;switch(n){case 0:e=await m(["googleCloudProjectId","googleCloudProjectNumber"])&&I(n);break;case 1:e=await m("name")&&I(n);break;case 2:e=I(n);break;default:e=!1}e&&r(e=>e+1)},disabled:!I(n)||R,variant:"contained",className:"flex-1 ",children:"Next"}):s.jsx(Nv,{onClick:f(B),disabled:!I(n)||R,variant:"contained",size:"small",className:"flex-1 text-xs",children:R?s.jsxs(s.Fragment,{children:[s.jsx(Yd,{size:14,className:"mr-1.5 text-white"}),"Creating..."]}):"Create"})]})})]})}const eJ={success:s.jsx(SX,{className:"w-5 h-5"}),error:s.jsx(zX,{className:"w-5 h-5"}),info:s.jsx(YX,{className:"w-5 h-5"}),warning:s.jsx(vY,{className:"w-5 h-5"}),loading:s.jsx(Yd,{size:20})};function tJ(){const e=kw(e=>e.messages),t=kw(e=>e.dismissMessage);return pe.useEffect(()=>{const e=setInterval(()=>{kw.getState().clearExpiredMessages()},500);return()=>clearInterval(e)},[]),s.jsx(rf,{className:"fixed bottom-4 left-4 z-[9999] flex flex-col gap-2",style:{maxWidth:"400px"},children:e.map(e=>s.jsx(Fg,{direction:"right",in:!0,mountOnEnter:!0,unmountOnExit:!0,children:s.jsx(AA,{severity:"loading"===e.type?"info":e.type,icon:eJ[e.type],onClose:()=>t(e.id),action:s.jsx(tA,{size:"small",onClick:()=>t(e.id),className:"text-current",children:s.jsx(IX,{className:"w-4 h-4"})}),className:"shadow-lg min-w-[300px]",sx:{borderRadius:"24px","& .MuiAlert-message":{flex:1}},children:s.jsxs(rf,{children:[s.jsx(rf,{className:"font-semibold text-sm",children:e.message}),e.description&&s.jsx(rf,{className:"text-xs mt-1 opacity-90",children:e.description})]})})},e.id))})}function nJ({children:e}){return s.jsx("main",{className:"flex-1 flex relative overflow-hidden",children:e})}const rJ=pe.createContext(null),oJ={didCatch:!1,error:null};class iJ extends pe.Component{constructor(e){super(e),this.resetErrorBoundary=this.resetErrorBoundary.bind(this),this.state=oJ}static getDerivedStateFromError(e){return{didCatch:!0,error:e}}resetErrorBoundary(){const{error:e}=this.state;if(null!==e){for(var t,n,r=arguments.length,o=new Array(r),i=0;i<r;i++)o[i]=arguments[i];null===(t=(n=this.props).onReset)||void 0===t||t.call(n,{args:o,reason:"imperative-api"}),this.setState(oJ)}}componentDidCatch(e,t){var n,r;null===(n=(r=this.props).onError)||void 0===n||n.call(r,e,t)}componentDidUpdate(e,t){const{didCatch:n}=this.state,{resetKeys:r}=this.props;var o,i;n&&null!==t.error&&function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];return e.length!==t.length||e.some((e,n)=>!Object.is(e,t[n]))}(e.resetKeys,r)&&(null===(o=(i=this.props).onReset)||void 0===o||o.call(i,{next:r,prev:e.resetKeys,reason:"keys"}),this.setState(oJ))}render(){const{children:e,fallbackRender:t,FallbackComponent:n,fallback:r}=this.props,{didCatch:o,error:i}=this.state;let s=e;if(o){const e={error:i,resetErrorBoundary:this.resetErrorBoundary};if("function"==typeof t)s=t(e);else if(n)s=pe.createElement(n,e);else{if(void 0===r)throw i;s=r}}return pe.createElement(rJ.Provider,{value:{didCatch:o,error:i,resetErrorBoundary:this.resetErrorBoundary}},s)}}const sJ="#0957d0",aJ="#0842a0",lJ=la("div")(({theme:e})=>({position:"relative",borderRadius:e.shape.borderRadius,backgroundColor:Ko(e.palette.common.white,.15),"&:hover":{backgroundColor:Ko(e.palette.common.white,.25)},marginLeft:0,width:"100%",[e.breakpoints.up("sm")]:{width:"auto"}})),cJ=la("div")(({theme:e})=>({padding:e.spacing(0,1),height:"100%",position:"absolute",left:0,top:0,pointerEvents:"none",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1})),uJ=la("div")(({theme:e})=>({position:"absolute",right:0,top:0,height:"100%",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1,paddingRight:e.spacing(.5)})),dJ=la(Ep)(({theme:e})=>({color:"inherit",width:"100%","& .MuiInputBase-input":{padding:e.spacing(1,1,1,0),paddingLeft:`calc(1em + ${e.spacing(4)})`,width:"100%"}})),AJ={backgroundColor:"#ffffff",borderRadius:"24px",border:"1px solid #e5e7eb",boxShadow:"0 1px 2px rgba(0, 0, 0, 0.05)",transition:"border-color 0.2s cubic-bezier(0.4, 0, 0.2, 1), box-shadow 0.2s cubic-bezier(0.4, 0, 0.2, 1)",width:"100%",maxWidth:"320px",minWidth:"200px","&:hover":{backgroundColor:"#ffffff",borderColor:"#d1d5db",boxShadow:"0 2px 4px rgba(0, 0, 0, 0.08)"},"&:focus-within":{borderColor:sJ,boxShadow:"0 0 0 3px rgba(9, 87, 208, 0.1), 0 2px 4px rgba(0, 0, 0, 0.08)"}},hJ={color:"#1f2937",width:"100%",fontSize:"14px","& .MuiInputBase-input":{padding:"8px 12px",paddingLeft:"calc(1em + 20px)",width:"100%","&::placeholder":{color:"#9ca3af",opacity:1}}},pJ={color:"#6b7280",fontSize:"18px"},fJ=({placeholder:e="Search",value:t,onChange:n,searchSx:r,inputSx:o,iconSx:i,disabled:a=!1})=>{const l=t.trim().length>0&&!a,c=o||(l?{...hJ,"& .MuiInputBase-input":{...hJ["& .MuiInputBase-input"],paddingRight:"calc(1em + 20px)"}}:hJ);return s.jsxs(lJ,{sx:r||AJ,children:[s.jsx(cJ,{children:s.jsx(cY,{sx:i||pJ})}),s.jsx(dJ,{placeholder:e,value:t,onChange:e=>n(e.target.value),inputProps:{"aria-label":"search"},sx:c,disabled:a}),l&&s.jsx(uJ,{children:s.jsx(tA,{size:"small",onClick:e=>{e.stopPropagation(),n("")},sx:{padding:"4px",color:"#6b7280","&:hover":{color:"#374151",backgroundColor:"rgba(0, 0, 0, 0.04)"}},"aria-label":"clear search",children:s.jsx(IX,{sx:{fontSize:"18px"}})})})]})};function gJ({open:e,onClose:t}){const{data:n,isLoading:r}=hX(),o=(()=>{const e=ye(),{loadPreferences:t}=Lj();return Ee({mutationFn:async e=>{const n=await Sj.updatePreferences(e);if(!n.success)throw new Error(n.message);return t(n.data),n.data},onSuccess:()=>{e.invalidateQueries({queryKey:eX.userPreferences})}})})(),[i,a]=pe.useState("km"),[l,c]=pe.useState(""),[u,d]=pe.useState(!0),[A,h]=pe.useState(!0),[p,f]=pe.useState("sync_status");pe.useEffect(()=>{e&&n&&(a(n.distanceUnit),c(n.googleCloudAccount||""),d(n.show_tooltip??!0),h(n.show_instructions??!0),f(n.route_color_mode||"sync_status"))},[e,n]);const g=e=>{a(e)};return s.jsx(jv,{open:e,onClose:t,maxWidth:"xs",fullWidth:!0,title:"Preferences",actions:s.jsxs(s.Fragment,{children:[s.jsx(Nv,{onClick:t,disabled:o.isPending,children:"Cancel"}),s.jsx(Nv,{onClick:async()=>{try{await o.mutateAsync({distanceUnit:i,googleCloudAccount:l||null,show_tooltip:u,show_instructions:A,route_color_mode:p}),t()}catch(e){}},variant:"contained",disabled:o.isPending||r,children:o.isPending?"Saving...":"Save"})]}),children:s.jsxs("div",{className:"space-y-6 pt-2",children:[s.jsxs("div",{className:"space-y-2",children:[s.jsx("label",{className:"text-sm font-medium text-gray-900",children:"Distance units"}),s.jsxs("div",{className:"flex gap-2",children:[s.jsxs("button",{type:"button",onClick:()=>g("km"),disabled:r,className:"flex-1 flex items-center justify-between px-4 py-2.5 rounded-lg border transition-colors "+("km"===i?"bg-blue-50 border-blue-200 text-gray-900":"bg-white border-gray-300 text-gray-700 hover:bg-gray-50"),children:[s.jsx("span",{className:"text-sm font-medium",children:"Kilometers"}),"km"===i&&s.jsx(xX,{className:"text-blue-600",fontSize:"small"})]}),s.jsxs("button",{type:"button",onClick:()=>g("miles"),disabled:r,className:"flex-1 flex items-center justify-between px-4 py-2.5 rounded-lg border transition-colors "+("miles"===i?"bg-blue-50 border-blue-200 text-gray-900":"bg-white border-gray-300 text-gray-700 hover:bg-gray-50"),children:[s.jsx("span",{className:"text-sm font-medium",children:"Miles"}),"miles"===i&&s.jsx(xX,{className:"text-blue-600",fontSize:"small"})]})]})]}),s.jsx("div",{className:"space-y-2",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("label",{className:"text-sm font-medium text-gray-900 block",children:"Show tooltips"}),s.jsx("p",{className:"text-sm text-gray-600 mt-0.5",children:"Hover hints on roads"})]}),s.jsx(Mv,{checked:u,onChange:e=>{d(e.target.checked)},disabled:r,sx:{"& .MuiSwitch-switchBase.Mui-checked":{color:sJ},"& .MuiSwitch-switchBase.Mui-checked + .MuiSwitch-track":{backgroundColor:sJ}}})]})}),s.jsx("div",{className:"space-y-2",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("label",{className:"text-sm font-medium text-gray-900 block",children:"Context instructions"}),s.jsx("p",{className:"text-sm text-gray-600 mt-0.5",children:"Display guide panels"})]}),s.jsx(Mv,{checked:A,onChange:e=>{h(e.target.checked)},disabled:r,sx:{"& .MuiSwitch-switchBase.Mui-checked":{color:sJ},"& .MuiSwitch-switchBase.Mui-checked + .MuiSwitch-track":{backgroundColor:sJ}}})]})})]})})}function mJ(){const{navigateWithCheck:e}=sj(),t=bc(),{projectId:n}=Sc(),r=JN(e=>e.projectData),o=pe.useRef(null),i=pe.useRef(null),[a,l]=pe.useState(!1),[c,u]=pe.useState(""),[d,A]=pe.useState(!1),[h,p]=pe.useState(""),[f,g]=pe.useState(!1),[m,y]=pe.useState(!1),v=t.pathname.startsWith("/project/"),b=pe.useCallback(()=>{if(n&&!m){y(!0);try{const e=`${""}/export_project/${n}`,t=document.createElement("a");t.href=e,t.download="",document.body.appendChild(t),t.click(),document.body.removeChild(t),Tw("Project download started")}catch(e){Pw(e instanceof Error?e.message:"Failed to download project")}finally{y(!1)}}},[n,m]),w=e=>{if(!e.trim())return{isValid:!0};const t=e.trim().split(/[,\s]+/).filter(e=>e.length>0);if(0===t.length)return{isValid:!1,error:"Enter coordinates"};if(1===t.length)return{isValid:!1,error:"Enter both lat and lng"};if(t.length>2)return{isValid:!1,error:"Too many values. Use: lat, lng"};const n=parseFloat(t[0]),r=parseFloat(t[1]);return isNaN(n)||isNaN(r)?{isValid:!1,error:"Invalid numbers"}:Math.abs(n)>90?{isValid:!1,error:"Latitude must be between -90 and 90"}:Math.abs(r)>180?{isValid:!1,error:"Longitude must be between -180 and 180"}:{isValid:!0,coordinates:{lat:n,lng:r}}},x=pe.useCallback(()=>{if(!c.trim())return;const e=window.googleMap;if(!e)return void A(!0);const t=w(c);if(!t.isValid||!t.coordinates)return A(!0),void p(t.error||"Invalid coordinates");A(!1),p("");try{const{lat:n,lng:r}=t.coordinates;e.setCenter(new google.maps.LatLng(n,r));const o=e.getZoom();(!o||o<10)&&e.setZoom(15),window.dispatchEvent(new CustomEvent("showSearchMarker",{detail:{lat:n,lng:r}}))}catch(n){A(!0)}},[c]);return pe.useEffect(()=>{if(f&&o.current){const e=o.current.querySelector("input");if(e){e.focus();const t=e=>{"Enter"===e.key?(e.preventDefault(),x()):"Escape"===e.key&&(g(!1),u(""),A(!1),p(""))};return e.addEventListener("keydown",t),()=>{e.removeEventListener("keydown",t)}}}},[f,c,x]),pe.useEffect(()=>{const e=e=>{f&&i.current&&!i.current.contains(e.target)&&(c.trim()||(g(!1),A(!1)))};if(f)return document.addEventListener("mousedown",e),()=>{document.removeEventListener("mousedown",e)}},[f,c]),s.jsxs("nav",{className:"fixed top-0 left-0 right-0 z-50 bg-white border-b border-gray-200",children:[s.jsxs("div",{className:"flex items-center justify-between h-16 px-6 relative",children:[s.jsxs("div",{className:"flex items-center gap-3 cursor-pointer select-none",onClick:()=>{e("/dashboard")},children:[s.jsx("img",{src:"/assets/google-maps-platform-CGhZNOV-.svg",alt:"Google Maps Platform",className:"h-6 w-auto"}),s.jsx(Tg,{orientation:"vertical",flexItem:!0,className:"h-6"}),s.jsx("span",{className:"text-base font-medium text-[#202124] tracking-tight",children:"Roads Selection Tool"})]}),v&&r?.name&&s.jsx("div",{className:"absolute left-1/2 -translate-x-1/2",children:s.jsx("span",{className:"text-base font-extrabold text-[#5f6368] max-w-[200px] truncate",children:r.name})}),s.jsxs("div",{className:"flex items-center gap-2",children:[v&&s.jsx("div",{ref:i,className:"flex items-center gap-1 relative",children:f?s.jsx("div",{ref:o,onBlur:e=>{const t=e.currentTarget,n=e.relatedTarget;c.trim()||!n||t.contains(n)||(g(!1),A(!1),p(""))},children:s.jsxs("div",{className:"relative",children:[s.jsx(fJ,{placeholder:"Search lat,lng",value:c,onChange:e=>{u(e);const t=w(e);A(!t.isValid&&e.trim().length>0),p(t.error||""),e.trim()||window.dispatchEvent(new CustomEvent("clearSearchMarker"))},searchSx:{width:"240px",minWidth:"240px",maxWidth:"240px",borderRadius:"20px",border:"1px solid #e5e7eb",transition:"width 0.3s ease, border-color 0.2s ease","&:hover":{borderColor:"#d1d5db"},"&:focus-within":{borderColor:sJ,boxShadow:"0 0 0 3px rgba(9, 87, 208, 0.1)"},...d&&{borderColor:"#ef4444","&:hover":{borderColor:"#ef4444"},"&:focus-within":{borderColor:"#ef4444",boxShadow:"0 0 0 3px rgba(239, 68, 68, 0.1)"}}},inputSx:{fontSize:"0.75rem","& .MuiInputBase-input":{padding:"6px 10px",paddingLeft:"calc(1em + 20px)"}}}),d&&h&&s.jsx("div",{className:"absolute top-full left-0 mt-1 px-2 py-1 text-xs text-red-600 bg-white border border-red-200 rounded shadow-sm z-50 whitespace-nowrap",children:h})]})}):s.jsx(Ev,{title:"Search coordinates",arrow:!0,children:s.jsx(tA,{size:"small",onClick:()=>{g(!0)},className:"text-[#5f6368] hover:bg-gray-100","aria-label":"Search coordinates",sx:{padding:"4px"},children:s.jsx(cY,{fontSize:"small"})})})}),s.jsxs("div",{className:"flex items-center gap-1",children:[v&&n&&s.jsx(Ev,{title:"Download project",arrow:!0,children:s.jsx("span",{children:s.jsx(tA,{size:"small",onClick:b,disabled:m,className:"text-[#5f6368] hover:bg-gray-100","aria-label":"Download project",children:s.jsx(LX,{fontSize:"small"})})})}),s.jsx(Ev,{title:"Settings",arrow:!0,children:s.jsx(tA,{onClick:()=>l(!0),size:"small",className:"ml-1","aria-label":"User preferences",children:s.jsx(uY,{fontSize:"small"})})})]})]})]}),s.jsx(gJ,{open:a,onClose:()=>l(!1)})]})}function yJ({error:e,resetErrorBoundary:t}){return s.jsxs("div",{className:"flex flex-col items-center justify-center h-screen p-3 text-center",children:[s.jsx("h2",{className:"text-xl font-semibold text-mui-primary mb-2",children:"Something went wrong"}),s.jsx("p",{className:"text-mui-secondary mb-4",children:e.message}),s.jsx(Nv,{onClick:t,className:"px-4 py-2 bg-mui-primary text-white rounded-lg hover:opacity-90 transition-opacity",children:"Try again"})]})}function vJ({children:e}){return s.jsx(iJ,{FallbackComponent:yJ,onReset:()=>window.location.reload(),children:s.jsxs("div",{className:"h-screen w-screen overflow-hidden flex flex-col",children:[s.jsx(mJ,{variant:"workspace"}),s.jsx("div",{className:"flex-1 w-full relative flex flex-col",children:e})]})})}function bJ(){return bJ=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)({}).hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},bJ.apply(null,arguments)}function wJ(e,t){if(null==e)return{};var n={};for(var r in e)if({}.hasOwnProperty.call(e,r)){if(-1!==t.indexOf(r))continue;n[r]=e[r]}return n}function xJ(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t);if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e,"string");return"symbol"==typeof t?t:t+""}const _J="NOT_LOADED",CJ="LOADING",SJ="LOADED",EJ="FAILED",BJ="AUTH_FAILURE";class IJ{static async load(e,t){var n;const r=e.libraries?e.libraries.split(","):[],o=this.serializeParams(e);this.listeners.push(t),null!=(n=window.google)&&null!=(n=n.maps)&&n.importLibrary?(this.serializedApiParams||(this.loadingStatus=SJ),this.notifyLoadingStatusListeners()):(this.serializedApiParams=o,this.initImportLibrary(e)),this.serializedApiParams&&this.serializedApiParams;const i=["maps",...r];await Promise.all(i.map(e=>google.maps.importLibrary(e)))}static serializeParams(e){return[e.v,e.key,e.language,e.region,e.authReferrerPolicy,e.solutionChannel].join("/")}static initImportLibrary(e){if(window.google||(window.google={}),window.google.maps||(window.google.maps={}),window.google.maps.importLibrary)return;let t=null;const n=()=>t||(t=new Promise((t,n)=>{var r;const o=document.createElement("script"),i=new URLSearchParams;for(const[s,a]of Object.entries(e)){const e=s.replace(/[A-Z]/g,e=>"_"+e[0].toLowerCase());i.set(e,String(a))}i.set("loading","async"),i.set("callback","__googleMapsCallback__"),o.async=!0,o.src="https://maps.googleapis.com/maps/api/js?"+i.toString(),o.nonce=(null==(r=document.querySelector("script[nonce]"))?void 0:r.nonce)||"",o.onerror=()=>{this.loadingStatus=EJ,this.notifyLoadingStatusListeners(),n(new Error("The Google Maps JavaScript API could not load."))},window.__googleMapsCallback__=()=>{this.loadingStatus=SJ,this.notifyLoadingStatusListeners(),t()},window.gm_authFailure=()=>{this.loadingStatus=BJ,this.notifyLoadingStatusListeners()},this.loadingStatus=CJ,this.notifyLoadingStatusListeners(),document.head.append(o)}),t);google.maps.importLibrary=e=>n().then(()=>google.maps.importLibrary(e))}static notifyLoadingStatusListeners(){for(const e of this.listeners)e(this.loadingStatus)}}IJ.loadingStatus=_J,IJ.serializedApiParams=void 0,IJ.listeners=[];const RJ=["onLoad","onError","apiKey","version","libraries"],kJ=["children"],TJ=fe.createContext(null);const PJ=e=>{const{children:t}=e,n=wJ(e,kJ),{mapInstances:r,addMapInstance:o,removeMapInstance:i,clearMapInstances:s}=function(){const[e,t]=pe.useState({});return{mapInstances:e,addMapInstance:(e,n="default")=>{t(t=>bJ({},t,{[n]:e}))},removeMapInstance:(e="default")=>{t(t=>wJ(t,[e].map(xJ)))},clearMapInstances:()=>{t({})}}}(),{status:a,loadedLibraries:l,importLibrary:c}=function(e){const{onLoad:t,onError:n,apiKey:r,version:o,libraries:i=[]}=e,s=wJ(e,RJ),[a,l]=pe.useState(IJ.loadingStatus),[c,u]=pe.useReducer((e,t)=>e[t.name]?e:bJ({},e,{[t.name]:t.value}),{}),d=pe.useMemo(()=>null==i?void 0:i.join(","),[i]),A=pe.useMemo(()=>JSON.stringify(bJ({apiKey:r,version:o},s)),[r,o,s]),h=pe.useCallback(async e=>{var t;if(c[e])return c[e];if(null==(t=google)||null==(t=t.maps)||!t.importLibrary)throw new Error("[api-provider-internal] importLibrary was called before google.maps.importLibrary was defined.");const n=await window.google.maps.importLibrary(e);return u({name:e,value:n}),n},[c]);return pe.useEffect(()=>{(async()=>{try{const e=bJ({key:r},s);o&&(e.v=o),(null==d?void 0:d.length)>0&&(e.libraries=d),(void 0===e.channel||e.channel<0||e.channel>999)&&delete e.channel,void 0===e.solutionChannel?e.solutionChannel="GMP_visgl_rgmlibrary_v1_default":""===e.solutionChannel&&delete e.solutionChannel,await IJ.load(e,e=>l(e));for(const t of["core","maps",...i])await h(t);t&&t()}catch(e){n&&n(e)}})()},[r,d,A]),{status:a,loadedLibraries:c,importLibrary:h}}(n),u=pe.useMemo(()=>({mapInstances:r,addMapInstance:o,removeMapInstance:i,clearMapInstances:s,status:a,loadedLibraries:l,importLibrary:c}),[r,o,i,s,a,l,c]);return fe.createElement(TJ.Provider,{value:u},t)};function FJ(e,t,n){const r={type:e,map:t,detail:{},stoppable:!1,stop:()=>{}};if(LJ.includes(e)){const e=r,n=t.getCenter(),o=t.getZoom(),i=t.getHeading()||0,s=t.getTilt()||0,a=t.getBounds();return!n||!a||Number.isFinite(o),e.detail={center:(null==n?void 0:n.toJSON())||{lat:0,lng:0},zoom:o||0,heading:i,tilt:s,bounds:(null==a?void 0:a.toJSON())||{north:90,east:180,south:-90,west:-180}},e}if(UJ.includes(e)){var o;if(!n)throw new Error("[createEvent] mouse events must provide a srcEvent");const e=r;return e.domEvent=n.domEvent,e.stoppable=!0,e.stop=()=>n.stop(),e.detail={latLng:(null==(o=n.latLng)?void 0:o.toJSON())||null,placeId:n.placeId},e}return r}const MJ={onBoundsChanged:"bounds_changed",onCenterChanged:"center_changed",onClick:"click",onContextmenu:"contextmenu",onDblclick:"dblclick",onDrag:"drag",onDragend:"dragend",onDragstart:"dragstart",onHeadingChanged:"heading_changed",onIdle:"idle",onIsFractionalZoomEnabledChanged:"isfractionalzoomenabled_changed",onMapCapabilitiesChanged:"mapcapabilities_changed",onMapTypeIdChanged:"maptypeid_changed",onMousemove:"mousemove",onMouseout:"mouseout",onMouseover:"mouseover",onProjectionChanged:"projection_changed",onRenderingTypeChanged:"renderingtype_changed",onTilesLoaded:"tilesloaded",onTiltChanged:"tilt_changed",onZoomChanged:"zoom_changed",onCameraChanged:"bounds_changed"},LJ=["bounds_changed","center_changed","heading_changed","tilt_changed","zoom_changed"],UJ=["click","contextmenu","dblclick","mousemove","mouseout","mouseover"],OJ=Object.keys(MJ);function DJ(e,t){const n=pe.useRef(e);return t(e,n.current)||(n.current=e),n.current}function NJ(e,t){!function(e,t,n){pe.useEffect(e,[DJ(t,n)])}(e,t,vw)}const jJ=new Set(["backgroundColor","clickableIcons","controlSize","disableDefaultUI","disableDoubleClickZoom","draggable","draggableCursor","draggingCursor","fullscreenControl","fullscreenControlOptions","gestureHandling","headingInteractionEnabled","isFractionalZoomEnabled","keyboardShortcuts","mapTypeControl","mapTypeControlOptions","mapTypeId","maxZoom","minZoom","noClear","panControl","panControlOptions","restriction","rotateControl","rotateControlOptions","scaleControl","scaleControlOptions","scrollwheel","streetView","streetViewControl","streetViewControlOptions","styles","tiltInteractionEnabled","zoomControl","zoomControlOptions"]);function QJ(){var e;return(null==(e=pe.useContext(TJ))?void 0:e.status)||_J}function zJ(e){return function(e){return!(!e||"object"!=typeof e)&&"lat"in e&&"lng"in e&&Number.isFinite(e.lat)&&Number.isFinite(e.lng)}(e)?e:e.toJSON()}const HJ=()=>fe.createElement("div",{style:{position:"absolute",top:0,left:0,bottom:0,right:0,zIndex:999,display:"flex",flexFlow:"column nowrap",textAlign:"center",justifyContent:"center",fontSize:".8rem",color:"rgba(0,0,0,0.6)",background:"#dddddd",padding:"1rem 1.5rem"}},fe.createElement("h2",null,"Error: AuthFailure"),fe.createElement("p",null,"A problem with your API key prevents the map from rendering correctly. Please make sure the value of the ",fe.createElement("code",null,"APIProvider.apiKey")," prop is correct. Check the error-message in the console for further details."));function GJ(){return QJ()===SJ}function VJ(e){const t=function(){const[,e]=pe.useReducer(e=>e+1,0);return e}(),n=pe.useRef({center:{lat:0,lng:0},heading:0,tilt:0,zoom:0});return pe.useEffect(()=>{if(!e)return;const r=google.maps.event.addListener(e,"bounds_changed",()=>{!function(e,t){const n=e.getCenter(),r=e.getZoom(),o=e.getHeading()||0,i=e.getTilt()||0,s=e.getBounds();!n||!s||Number.isFinite(r),Object.assign(t.current,{center:(null==n?void 0:n.toJSON())||{lat:0,lng:0},zoom:r||0,heading:o,tilt:i})}(e,n),t()});return()=>r.remove()},[e,t]),n}const WJ=["id","defaultBounds","defaultCenter","defaultZoom","defaultHeading","defaultTilt","reuseMaps","renderingType","colorScheme"],$J=["padding"];class KJ{static has(e){return this.entries[e]&&this.entries[e].length>0}static pop(e){return this.entries[e]&&this.entries[e].pop()||null}static push(e,t){this.entries[e]||(this.entries[e]=[]),this.entries[e].push(t)}}function XJ(e,t){const n=GJ(),[r,o]=pe.useState(null),[i,s]=function(){const[e,t]=pe.useState(null);return[e,pe.useCallback(e=>t(e),[t])]}(),a=VJ(r),{id:l,defaultBounds:c,defaultCenter:u,defaultZoom:d,defaultHeading:A,defaultTilt:h,reuseMaps:p,renderingType:f,colorScheme:g}=e,m=wJ(e,WJ),y=void 0!==e.zoom||void 0!==e.defaultZoom,v=void 0!==e.center||void 0!==e.defaultCenter;!m.center&&u&&(m.center=u),!m.zoom&&Number.isFinite(d)&&(m.zoom=d),!m.heading&&Number.isFinite(A)&&(m.heading=A),!m.tilt&&Number.isFinite(h)&&(m.tilt=h);for(const w of Object.keys(m))void 0===m[w]&&delete m[w];const b=pe.useRef(void 0);return pe.useEffect(()=>{if(!i||!n)return;const{addMapInstance:r,removeMapInstance:s}=t,{mapId:u}=e,d=`${u||"default"}:${f||"default"}:${g||"LIGHT"}`;let A,h;if(p&&KJ.has(d)?(h=KJ.pop(d),A=h.getDiv(),i.appendChild(A),h.setOptions(m),setTimeout(()=>h.setCenter(h.getCenter()),0)):(A=document.createElement("div"),A.style.height="100%",i.appendChild(A),h=new google.maps.Map(A,bJ({},m,f?{renderingType:f}:{},g?{colorScheme:g}:{}))),o(h),r(h,l),c){const{padding:e}=c,t=wJ(c,$J);h.fitBounds(t,e)}else y&&v||h.fitBounds({east:180,west:-180,south:-90,north:90});if(b.current){const{mapId:e,cameraState:t}=b.current;e!==u&&h.setOptions(t)}return()=>{b.current={mapId:u,cameraState:a.current},A.remove(),p?KJ.push(d,h):google.maps.event.clearInstanceListeners(h),o(null),s(l)}},[i,n,l,e.mapId,e.renderingType,e.colorScheme]),[r,s,a]}KJ.entries={};const YJ=fe.createContext(null),qJ=e=>{const{children:t,id:n,className:r,style:o}=e,i=pe.useContext(TJ),s=QJ();if(!i)throw new Error("<Map> can only be used inside an <ApiProvider> component.");const[a,l,c]=XJ(e,i);!function(e,t,n){const r=n.center?zJ(n.center):null;let o=null,i=null;r&&Number.isFinite(r.lat)&&Number.isFinite(r.lng)&&(o=r.lat,i=r.lng);const s=Number.isFinite(n.zoom)?n.zoom:null,a=Number.isFinite(n.heading)?n.heading:null,l=Number.isFinite(n.tilt)?n.tilt:null;pe.useLayoutEffect(()=>{if(!e)return;const n={};let r=!1;null===o||null===i||t.current.center.lat===o&&t.current.center.lng===i||(n.center={lat:o,lng:i},r=!0),null!==s&&t.current.zoom!==s&&(n.zoom=s,r=!0),null!==a&&t.current.heading!==a&&(n.heading=a,r=!0),null!==l&&t.current.tilt!==l&&(n.tilt=l,r=!0),r&&e.moveCamera(n)})}(a,c,e),function(e,t){for(const n of OJ){const r=t[n],o=MJ[n];pe.useEffect(()=>{if(!e)return;if(!r)return;const t=google.maps.event.addListener(e,o,t=>{r(FJ(o,e,t))});return()=>t.remove()},[e,o,r])}}(a,e),function(e,t){const n={},r=Object.keys(t);for(const o of r)jJ.has(o)&&(n[o]=t[o]);NJ(()=>{e&&e.setOptions(n)},[n])}(a,e);const u=function(e,t){const{viewport:n,viewState:r}=t,o=!!n;return pe.useLayoutEffect(()=>{if(!e||!r)return;const{latitude:t,longitude:n,bearing:o,pitch:i,zoom:s}=r;e.moveCamera({center:{lat:t,lng:n},heading:o,tilt:i,zoom:s+1})},[e,r]),o}(a,e),d=!!e.controlled;pe.useEffect(()=>{if(a)return u&&a.setOptions({disableDefaultUI:!0}),(u||d)&&a.setOptions({gestureHandling:"none",keyboardShortcuts:!1}),()=>{a.setOptions({gestureHandling:e.gestureHandling,keyboardShortcuts:e.keyboardShortcuts})}},[a,u,d,e.gestureHandling,e.keyboardShortcuts]);const A=e.center?zJ(e.center):null;let h=null,p=null;A&&Number.isFinite(A.lat)&&Number.isFinite(A.lng)&&(h=A.lat,p=A.lng);const f=pe.useMemo(()=>{var t,n,r,o,i;return{center:{lat:null!=(t=h)?t:0,lng:null!=(n=p)?n:0},zoom:null!=(r=e.zoom)?r:0,heading:null!=(o=e.heading)?o:0,tilt:null!=(i=e.tilt)?i:0}},[h,p,e.zoom,e.heading,e.tilt]);pe.useLayoutEffect(()=>{if(!a||!d)return;a.moveCamera(f);const e=a.addListener("bounds_changed",()=>{a.moveCamera(f)});return()=>e.remove()},[a,d,f]);const g=pe.useMemo(()=>bJ({width:"100%",height:"100%",position:"relative",zIndex:u?-1:0},o),[o,u]),m=pe.useMemo(()=>({map:a}),[a]);return s===BJ?fe.createElement("div",{style:bJ({position:"relative"},r?{}:g),className:r},fe.createElement(HJ,null)):fe.createElement("div",bJ({ref:l,"data-testid":"map",style:r?void 0:g,className:r},n?{id:n}:{}),a?fe.createElement(YJ.Provider,{value:m},t):null)};qJ.deckGLViewProps=!0;const JJ=new Set;const ZJ=(e=null)=>{const t=pe.useContext(TJ),{map:n}=pe.useContext(YJ)||{};if(null===t)return function(...e){const t=JSON.stringify(e);JJ.has(t)||JJ.add(t)}("useMap(): failed to retrieve APIProviderContext. Make sure that the <APIProvider> component exists and that the component you are calling `useMap()` from is a sibling of the <APIProvider>."),null;const{mapInstances:r}=t;return null!==e?r[e]||null:n||(r.default||null)};function eZ(e,t,n){pe.useEffect(()=>{if(!e||!t||!n)return;const r=google.maps.event.addListener(e,t,n);return()=>r.remove()},[e,t,n])}function tZ(e,t,n){pe.useEffect(()=>{e&&(e[t]=n)},[e,t,n])}function nZ(e,t,n){pe.useEffect(()=>{if(e&&t&&n)return e.addEventListener(t,n),()=>e.removeEventListener(t,n)},[e,t,n])}function rZ(e){return e.nodeType===Node.ELEMENT_NODE}const oZ=fe.createContext(null),iZ={BOTTOM_CENTER:["50%","100%"],BOTTOM:["50%","100%"],CENTER:["50%","50%"]},sZ=({children:e,styles:t,className:n,anchorPoint:r})=>{const[o,i]=null!=r?r:iZ.BOTTOM;let s=`-${o}`,a=`-${i}`;o.trimStart().startsWith("-")&&(s=o.substring(1)),i.trimStart().startsWith("-")&&(a=i.substring(1));const l=`translate(50%, 100%) translate(${s}, ${a})`;return fe.createElement("div",{style:{transform:l}},fe.createElement("div",{className:n,style:t},e))};function aZ(e){const[t,n]=pe.useState(null),[r,o]=pe.useState(null),i=ZJ(),s=function(e){const t=GJ(),n=pe.useContext(TJ);return pe.useEffect(()=>{t&&n&&n.importLibrary(e)},[t,n,e]),(null==n?void 0:n.loadedLibraries[e])||null}("marker"),{children:a,onClick:l,className:c,onMouseEnter:u,onMouseLeave:d,onDrag:A,onDragStart:h,onDragEnd:p,collisionBehavior:f,clickable:g,draggable:m,position:y,title:v,zIndex:b}=e,w=pe.Children.count(a);return pe.useEffect(()=>{if(!i||!s)return;const e=new s.AdvancedMarkerElement;e.map=i,n(e);let t=null;return w>0&&(t=document.createElement("div"),t.isCustomMarker=!0,e.content=t,o(t)),()=>{var r;e.map=null,null==(r=t)||r.remove(),n(null),o(null)}},[i,s,w]),pe.useEffect(()=>{null==t||!t.content||!rZ(t.content)||w>0||(t.content.className=null!=c?c:"")},[t,c,w]),tZ(t,"position",y),tZ(t,"title",null!=v?v:""),tZ(t,"zIndex",b),tZ(t,"collisionBehavior",f),pe.useEffect(()=>{t&&(t.gmpDraggable=void 0!==m?m:!!(A||h||p))},[t,m,A,p,h]),pe.useEffect(()=>{if(!t)return;const e=void 0!==g||Boolean(l)||Boolean(u)||Boolean(d);t.gmpClickable=e,e&&null!=t&&t.content&&rZ(t.content)&&(t.content.style.pointerEvents="none",t.content.firstElementChild&&(t.content.firstElementChild.style.pointerEvents="all"))},[t,g,l,u,d]),eZ(t,"click",l),eZ(t,"drag",A),eZ(t,"dragstart",h),eZ(t,"dragend",p),nZ(null==t?void 0:t.element,"mouseenter",u),nZ(null==t?void 0:t.element,"mouseleave",d),[t,r]}const lZ=pe.forwardRef((e,t)=>{const{children:n,style:r,className:o,anchorPoint:i}=e,[s,a]=aZ(e),l=pe.useMemo(()=>s?{marker:s}:null,[s]);return pe.useImperativeHandle(t,()=>s,[s]),a?fe.createElement(oZ.Provider,{value:l},wu.createPortal(fe.createElement(sZ,{anchorPoint:i,styles:r,className:o},n),a)):null}),cZ=["onClick","onDrag","onDragStart","onDragEnd","onMouseOver","onMouseOut"];pe.forwardRef((e,t)=>{const n=function(e){const[t,n]=pe.useState(null),r=ZJ(),{onClick:o,onDrag:i,onDragStart:s,onDragEnd:a,onMouseOver:l,onMouseOut:c}=e,u=wJ(e,cZ),{position:d,draggable:A}=u;return pe.useEffect(()=>{if(!r)return;const e=new google.maps.Marker(u);return e.setMap(r),n(e),()=>{e.setMap(null),n(null)}},[r]),pe.useEffect(()=>{if(!t)return;const e=t,n=google.maps.event;return o&&n.addListener(e,"click",o),i&&n.addListener(e,"drag",i),s&&n.addListener(e,"dragstart",s),a&&n.addListener(e,"dragend",a),l&&n.addListener(e,"mouseover",l),c&&n.addListener(e,"mouseout",c),t.setDraggable(Boolean(A)),()=>{n.clearInstanceListeners(e)}},[t,A,o,i,s,a,l,c]),pe.useEffect(()=>{t&&u&&t.setOptions(u)},[t,u]),pe.useEffect(()=>{!A&&d&&t&&t.setPosition(d)},[A,d,t]),t}(e);return pe.useImperativeHandle(t,()=>n,[n]),fe.createElement(fe.Fragment,null)});const uZ=({center:e={lat:20.5937,lng:78.9629},zoom:t=5,apiKey:n,mapId:r="73a66895f21ab8d1af4c7933",className:o,style:i,children:a})=>s.jsx(PJ,{apiKey:n,children:s.jsxs("div",{className:o,style:i,children:[s.jsx(qJ,{defaultCenter:e,defaultZoom:t,mapId:r,gestureHandling:"greedy",disableDefaultUI:!0,restriction:{latLngBounds:{north:85,south:-85,west:-180,east:180},strictBounds:!0}}),a]})});function dZ({boundaryGeoJson:e}){const t=ZJ(),n=pe.useRef(null);return pe.useEffect(()=>{if(!t)return;const e=new google.maps.Data;return n.current=e,e.setMap(t),()=>{n.current&&n.current.setMap(null)}},[t]),pe.useEffect(()=>{if(!e||!n.current||!t)return;const r=n.current;r.forEach(e=>{r.remove(e)});try{r.addGeoJson(e),r.setStyle({fillColor:"#1976d2",fillOpacity:.2,strokeColor:"#1976d2",strokeWeight:3,strokeOpacity:1});const n=new google.maps.LatLngBounds,o=e=>{"Polygon"===e.type?e.coordinates[0].forEach(e=>{n.extend(new google.maps.LatLng(e[1],e[0]))}):"MultiPolygon"===e.type&&e.coordinates.forEach(e=>{e[0].forEach(e=>{n.extend(new google.maps.LatLng(e[1],e[0]))})})};"FeatureCollection"===e.type?e.features.forEach(e=>{o(e.geometry)}):"Feature"===e.type&&o(e.geometry),t.fitBounds(n,{top:50,right:50,bottom:50,left:50})}catch(o){}},[e,t]),null}function AZ({apiKey:e,boundaryGeoJson:t,className:n,style:r}){return s.jsx(uZ,{apiKey:e,className:n,style:r,children:s.jsx(dZ,{boundaryGeoJson:t})})}function hZ(){const[e,t]=pe.useState(!1),[n,r]=pe.useState(0),o=ej(e=>e.geoJsonState),i=ej(e=>e.clearProjectCreationState);pe.useEffect(()=>{o.uploadedGeoJson},[o]),pe.useEffect(()=>()=>{i()},[i]);const a=Hw();return s.jsx(vJ,{children:s.jsx(nJ,{children:s.jsxs("div",{className:"flex-1 relative h-full w-full",children:[s.jsx(AZ,{apiKey:a,boundaryGeoJson:o.uploadedGeoJson,style:{width:"100%",height:"100%"}}),s.jsx(Zq,{onStepChange:r}),s.jsx(_Y,{step:n,minimized:e,onToggleMinimize:()=>t(!e)}),s.jsx(tJ,{})]})})})}const pZ=43200,fZ=Symbol.for("constructDateFrom");function gZ(e,t){return"function"==typeof e?e(t):e&&"object"==typeof e&&fZ in e?e[fZ](t):e instanceof Date?new e.constructor(t):new Date(t)}function mZ(e,t){return gZ(e,e)}let yZ={};function vZ(e){const t=mZ(e),n=new Date(Date.UTC(t.getFullYear(),t.getMonth(),t.getDate(),t.getHours(),t.getMinutes(),t.getSeconds(),t.getMilliseconds()));return n.setUTCFullYear(t.getFullYear()),+e-+n}function bZ(e,...t){const n=gZ.bind(null,e||t.find(e=>"object"==typeof e));return t.map(n)}function wZ(e,t){const n=+mZ(e)-+mZ(t);return n<0?-1:n>0?1:n}function xZ(e,t){const n=mZ(e);return+function(e){const t=mZ(e);return t.setHours(23,59,59,999),t}(n)===+function(e){const t=mZ(e),n=t.getMonth();return t.setFullYear(t.getFullYear(),n+1,0),t.setHours(23,59,59,999),t}(n)}function _Z(e,t,n){const[r,o,i]=bZ(n?.in,e,e,t),s=wZ(o,i),a=Math.abs(function(e,t,n){const[r,o]=bZ(n?.in,e,t);return 12*(r.getFullYear()-o.getFullYear())+(r.getMonth()-o.getMonth())}(o,i));if(a<1)return 0;1===o.getMonth()&&o.getDate()>27&&o.setDate(30),o.setMonth(o.getMonth()-s*a);let l=wZ(o,i)===-s;xZ(r)&&1===a&&1===wZ(r,i)&&(l=!1);const c=s*(a-+l);return 0===c?0:c}function CZ(e,t,n){const r=function(e,t){return+mZ(e)-+mZ(t)}(e,t)/1e3;return(o=n?.roundingMethod,e=>{const t=(o?Math[o]:Math.trunc)(e);return 0===t?0:t})(r);var o}const SZ={lessThanXSeconds:{one:"less than a second",other:"less than {{count}} seconds"},xSeconds:{one:"1 second",other:"{{count}} seconds"},halfAMinute:"half a minute",lessThanXMinutes:{one:"less than a minute",other:"less than {{count}} minutes"},xMinutes:{one:"1 minute",other:"{{count}} minutes"},aboutXHours:{one:"about 1 hour",other:"about {{count}} hours"},xHours:{one:"1 hour",other:"{{count}} hours"},xDays:{one:"1 day",other:"{{count}} days"},aboutXWeeks:{one:"about 1 week",other:"about {{count}} weeks"},xWeeks:{one:"1 week",other:"{{count}} weeks"},aboutXMonths:{one:"about 1 month",other:"about {{count}} months"},xMonths:{one:"1 month",other:"{{count}} months"},aboutXYears:{one:"about 1 year",other:"about {{count}} years"},xYears:{one:"1 year",other:"{{count}} years"},overXYears:{one:"over 1 year",other:"over {{count}} years"},almostXYears:{one:"almost 1 year",other:"almost {{count}} years"}};function EZ(e){return(t={})=>{const n=t.width?String(t.width):e.defaultWidth;return e.formats[n]||e.formats[e.defaultWidth]}}const BZ={date:EZ({formats:{full:"EEEE, MMMM do, y",long:"MMMM do, y",medium:"MMM d, y",short:"MM/dd/yyyy"},defaultWidth:"full"}),time:EZ({formats:{full:"h:mm:ss a zzzz",long:"h:mm:ss a z",medium:"h:mm:ss a",short:"h:mm a"},defaultWidth:"full"}),dateTime:EZ({formats:{full:"{{date}} 'at' {{time}}",long:"{{date}} 'at' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},defaultWidth:"full"})},IZ={lastWeek:"'last' eeee 'at' p",yesterday:"'yesterday at' p",today:"'today at' p",tomorrow:"'tomorrow at' p",nextWeek:"eeee 'at' p",other:"P"};function RZ(e){return(t,n)=>{let r;if("formatting"===(n?.context?String(n.context):"standalone")&&e.formattingValues){const t=e.defaultFormattingWidth||e.defaultWidth,o=n?.width?String(n.width):t;r=e.formattingValues[o]||e.formattingValues[t]}else{const t=e.defaultWidth,o=n?.width?String(n.width):e.defaultWidth;r=e.values[o]||e.values[t]}return r[e.argumentCallback?e.argumentCallback(t):t]}}const kZ={ordinalNumber:(e,t)=>{const n=Number(e),r=n%100;if(r>20||r<10)switch(r%10){case 1:return n+"st";case 2:return n+"nd";case 3:return n+"rd"}return n+"th"},era:RZ({values:{narrow:["B","A"],abbreviated:["BC","AD"],wide:["Before Christ","Anno Domini"]},defaultWidth:"wide"}),quarter:RZ({values:{narrow:["1","2","3","4"],abbreviated:["Q1","Q2","Q3","Q4"],wide:["1st quarter","2nd quarter","3rd quarter","4th quarter"]},defaultWidth:"wide",argumentCallback:e=>e-1}),month:RZ({values:{narrow:["J","F","M","A","M","J","J","A","S","O","N","D"],abbreviated:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],wide:["January","February","March","April","May","June","July","August","September","October","November","December"]},defaultWidth:"wide"}),day:RZ({values:{narrow:["S","M","T","W","T","F","S"],short:["Su","Mo","Tu","We","Th","Fr","Sa"],abbreviated:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],wide:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]},defaultWidth:"wide"}),dayPeriod:RZ({values:{narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"}},defaultWidth:"wide",formattingValues:{narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"}},defaultFormattingWidth:"wide"})};function TZ(e){return(t,n={})=>{const r=n.width,o=r&&e.matchPatterns[r]||e.matchPatterns[e.defaultMatchWidth],i=t.match(o);if(!i)return null;const s=i[0],a=r&&e.parsePatterns[r]||e.parsePatterns[e.defaultParseWidth],l=Array.isArray(a)?function(e,t){for(let n=0;n<e.length;n++)if(t(e[n]))return n;return}(a,e=>e.test(s)):function(e,t){for(const n in e)if(Object.prototype.hasOwnProperty.call(e,n)&&t(e[n]))return n;return}(a,e=>e.test(s));let c;c=e.valueCallback?e.valueCallback(l):l,c=n.valueCallback?n.valueCallback(c):c;return{value:c,rest:t.slice(s.length)}}}const PZ={ordinalNumber:(FZ={matchPattern:/^(\d+)(th|st|nd|rd)?/i,parsePattern:/\d+/i,valueCallback:e=>parseInt(e,10)},(e,t={})=>{const n=e.match(FZ.matchPattern);if(!n)return null;const r=n[0],o=e.match(FZ.parsePattern);if(!o)return null;let i=FZ.valueCallback?FZ.valueCallback(o[0]):o[0];return i=t.valueCallback?t.valueCallback(i):i,{value:i,rest:e.slice(r.length)}}),era:TZ({matchPatterns:{narrow:/^(b|a)/i,abbreviated:/^(b\.?\s?c\.?|b\.?\s?c\.?\s?e\.?|a\.?\s?d\.?|c\.?\s?e\.?)/i,wide:/^(before christ|before common era|anno domini|common era)/i},defaultMatchWidth:"wide",parsePatterns:{any:[/^b/i,/^(a|c)/i]},defaultParseWidth:"any"}),quarter:TZ({matchPatterns:{narrow:/^[1234]/i,abbreviated:/^q[1234]/i,wide:/^[1234](th|st|nd|rd)? quarter/i},defaultMatchWidth:"wide",parsePatterns:{any:[/1/i,/2/i,/3/i,/4/i]},defaultParseWidth:"any",valueCallback:e=>e+1}),month:TZ({matchPatterns:{narrow:/^[jfmasond]/i,abbreviated:/^(jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec)/i,wide:/^(january|february|march|april|may|june|july|august|september|october|november|december)/i},defaultMatchWidth:"wide",parsePatterns:{narrow:[/^j/i,/^f/i,/^m/i,/^a/i,/^m/i,/^j/i,/^j/i,/^a/i,/^s/i,/^o/i,/^n/i,/^d/i],any:[/^ja/i,/^f/i,/^mar/i,/^ap/i,/^may/i,/^jun/i,/^jul/i,/^au/i,/^s/i,/^o/i,/^n/i,/^d/i]},defaultParseWidth:"any"}),day:TZ({matchPatterns:{narrow:/^[smtwf]/i,short:/^(su|mo|tu|we|th|fr|sa)/i,abbreviated:/^(sun|mon|tue|wed|thu|fri|sat)/i,wide:/^(sunday|monday|tuesday|wednesday|thursday|friday|saturday)/i},defaultMatchWidth:"wide",parsePatterns:{narrow:[/^s/i,/^m/i,/^t/i,/^w/i,/^t/i,/^f/i,/^s/i],any:[/^su/i,/^m/i,/^tu/i,/^w/i,/^th/i,/^f/i,/^sa/i]},defaultParseWidth:"any"}),dayPeriod:TZ({matchPatterns:{narrow:/^(a|p|mi|n|(in the|at) (morning|afternoon|evening|night))/i,any:/^([ap]\.?\s?m\.?|midnight|noon|(in the|at) (morning|afternoon|evening|night))/i},defaultMatchWidth:"any",parsePatterns:{any:{am:/^a/i,pm:/^p/i,midnight:/^mi/i,noon:/^no/i,morning:/morning/i,afternoon:/afternoon/i,evening:/evening/i,night:/night/i}},defaultParseWidth:"any"})};var FZ;const MZ={code:"en-US",formatDistance:(e,t,n)=>{let r;const o=SZ[e];return r="string"==typeof o?o:1===t?o.one:o.other.replace("{{count}}",t.toString()),n?.addSuffix?n.comparison&&n.comparison>0?"in "+r:r+" ago":r},formatLong:BZ,formatRelative:(e,t,n,r)=>IZ[e],localize:kZ,match:PZ,options:{weekStartsOn:0,firstWeekContainsDate:1}};function LZ(e,t,n){const r=yZ,o=n?.locale??r.locale??MZ,i=wZ(e,t);if(isNaN(i))throw new RangeError("Invalid time value");const s=Object.assign({},n,{addSuffix:n?.addSuffix,comparison:i}),[a,l]=bZ(n?.in,...i>0?[t,e]:[e,t]),c=CZ(l,a),u=(vZ(l)-vZ(a))/1e3,d=Math.round((c-u)/60);let A;if(d<2)return n?.includeSeconds?c<5?o.formatDistance("lessThanXSeconds",5,s):c<10?o.formatDistance("lessThanXSeconds",10,s):c<20?o.formatDistance("lessThanXSeconds",20,s):c<40?o.formatDistance("halfAMinute",0,s):c<60?o.formatDistance("lessThanXMinutes",1,s):o.formatDistance("xMinutes",1,s):0===d?o.formatDistance("lessThanXMinutes",1,s):o.formatDistance("xMinutes",d,s);if(d<45)return o.formatDistance("xMinutes",d,s);if(d<90)return o.formatDistance("aboutXHours",1,s);if(d<1440){const e=Math.round(d/60);return o.formatDistance("aboutXHours",e,s)}if(d<2520)return o.formatDistance("xDays",1,s);if(d<pZ){const e=Math.round(d/1440);return o.formatDistance("xDays",e,s)}if(d<86400)return A=Math.round(d/pZ),o.formatDistance("aboutXMonths",A,s);if(A=_Z(l,a),A<12){const e=Math.round(d/pZ);return o.formatDistance("xMonths",e,s)}{const e=A%12,t=Math.trunc(A/12);return e<3?o.formatDistance("aboutXYears",t,s):e<9?o.formatDistance("overXYears",t,s):o.formatDistance("almostXYears",t+1,s)}}function UZ(e,t){return LZ(e,function(e){return gZ(e,Date.now())}(e),t)}const OZ=({sx:e})=>s.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24px",height:"24px",viewBox:"0 0 24 24",fill:"none",style:e,children:s.jsx("g",{id:"Edit / Add_Row",children:s.jsx("path",{id:"Vector",d:"M3 14V15C3 16.1046 3.89543 17 5 17L19 17C20.1046 17 21 16.1046 21 15L21 13C21 11.8954 20.1046 11 19 11H13M10 8H7M7 8H4M7 8V5M7 8V11",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})})}),DZ=({sx:e})=>s.jsxs("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",style:e,children:[s.jsx("path",{d:"M 21 12 A 9 9 0 1 1 12 3",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",fill:"none"}),s.jsx("path",{d:"M 12 3 A 9 9 0 0 1 21 12",stroke:"currentColor",strokeWidth:"2",strokeDasharray:"0.1 3.4",strokeLinecap:"round",fill:"none"}),s.jsx("path",{d:"M12 7v5l3 2",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})]}),NZ=()=>s.jsxs(yf,{elevation:0,className:"border border-gray-200 overflow-hidden self-start",sx:{display:"flex",flexDirection:"column",minHeight:"240px",height:"auto",position:"relative",zIndex:5,backgroundColor:"white",width:"100%",borderRadius:"24px",boxShadow:"0 1px 3px rgba(0, 0, 0, 0.1), 0 1px 2px rgba(0, 0, 0, 0.06)"},children:[s.jsx("div",{className:"relative w-full h-40 bg-gray-100 overflow-hidden flex-shrink-0",style:{minHeight:"160px",borderTopLeftRadius:"24px",borderTopRightRadius:"24px"},children:s.jsx(lv,{variant:"rectangular",width:"100%",height:"100%",className:"bg-gray-200",sx:{borderTopLeftRadius:"24px",borderTopRightRadius:"24px"}})}),s.jsxs(Ef,{className:"p-4 flex flex-col bg-white relative z-10 w-full flex-shrink-0",sx:{"&:last-child":{paddingBottom:"16px"},position:"relative",zIndex:10,backgroundColor:"white",minHeight:"80px",flexShrink:0,borderBottomLeftRadius:"24px",borderBottomRightRadius:"24px"},children:[s.jsx(lv,{variant:"text",width:"70%",height:24,className:"mb-2"}),s.jsxs("div",{className:"flex items-center justify-between mt-2",children:[s.jsx(lv,{variant:"text",width:"40%",height:16}),s.jsx(lv,{variant:"text",width:"30%",height:16})]})]})]}),jZ=({project:e,routeCount:t,onClick:n,onDelete:r,onRename:o})=>s.jsxs(yf,{elevation:0,className:"border border-gray-200 overflow-hidden hover:shadow-lg transition-all duration-200 hover:-translate-y-1 cursor-pointer relative group self-start",sx:{display:"flex",flexDirection:"column",minHeight:"240px",height:"auto",position:"relative",zIndex:5,backgroundColor:"white",width:"100%",borderRadius:"24px",boxShadow:"0 1px 3px rgba(0, 0, 0, 0.1), 0 1px 2px rgba(0, 0, 0, 0.06)","&:hover":{borderColor:"#1967d2",zIndex:15,boxShadow:"0 4px 6px rgba(0, 0, 0, 0.1), 0 2px 4px rgba(0, 0, 0, 0.06)"}},children:[s.jsxs("div",{className:"absolute top-2 right-2 z-20 flex gap-1 opacity-0 group-hover:opacity-100 transition-opacity",children:[s.jsx(tA,{onClick:o,size:"small",sx:{backgroundColor:"rgba(255, 255, 255, 0.9)",backdropFilter:"blur(8px)",boxShadow:"0 1px 3px rgba(0, 0, 0, 0.12), 0 1px 2px rgba(0, 0, 0, 0.24)",borderRadius:"50%",width:"32px",height:"32px","&:hover":{backgroundColor:"rgba(9, 87, 208, 0.08)",boxShadow:"0 2px 4px rgba(0, 0, 0, 0.16), 0 2px 4px rgba(0, 0, 0, 0.23)","& .MuiSvgIcon-root":{color:sJ}},"& .MuiSvgIcon-root":{color:"#5f6368",fontSize:"18px"},transition:"all 0.2s cubic-bezier(0.4, 0, 0.2, 1)"},children:s.jsx(jX,{})}),s.jsx(tA,{onClick:r,size:"small",sx:{backgroundColor:"rgba(255, 255, 255, 0.9)",backdropFilter:"blur(8px)",boxShadow:"0 1px 3px rgba(0, 0, 0, 0.12), 0 1px 2px rgba(0, 0, 0, 0.24)",borderRadius:"50%",width:"32px",height:"32px","&:hover":{backgroundColor:"rgba(234, 67, 53, 0.08)",boxShadow:"0 2px 4px rgba(0, 0, 0, 0.16), 0 2px 4px rgba(0, 0, 0, 0.23)","& .MuiSvgIcon-root":{color:"#EA4335"}},"& .MuiSvgIcon-root":{color:"#5f6368",fontSize:"18px"},transition:"all 0.2s cubic-bezier(0.4, 0, 0.2, 1)"},children:s.jsx(MX,{})})]}),s.jsxs(_f,{onClick:n,className:"flex flex-col flex-1",sx:{"& .MuiCardActionArea-focusHighlight":{opacity:0},position:"relative",zIndex:1,display:"flex",flexDirection:"column",flex:1,minHeight:0,backgroundColor:"white","&:hover":{backgroundColor:"white"}},children:[s.jsx("div",{className:"relative w-full h-40 bg-gray-100 overflow-hidden flex-shrink-0",style:{minHeight:"160px",borderTopLeftRadius:"24px",borderTopRightRadius:"24px"},children:e.mapSnapshot?s.jsx("img",{src:e.mapSnapshot,alt:e.name,className:"w-full h-full object-cover transition-transform duration-300 ease-in-out group-hover:scale-110",onError:e=>{const t=e.target;t.style.display="none",t.parentElement&&(t.parentElement.className+=" bg-gradient-to-br from-blue-50 to-indigo-100")}}):s.jsx("img",{src:"/assets/no-snapshot-fallback-UeIny52P.png",alt:"No snapshot",className:"w-full h-full object-cover transition-transform duration-300 ease-in-out group-hover:scale-110 grayscale opacity-60"})}),s.jsxs(Ef,{className:"p-4 flex flex-col bg-white relative z-10 w-full flex-shrink-0",sx:{"&:last-child":{paddingBottom:"16px"},position:"relative",zIndex:10,backgroundColor:"white",minHeight:"80px",flexShrink:0,borderBottomLeftRadius:"24px",borderBottomRightRadius:"24px",minWidth:0},children:[s.jsx(vA,{variant:"subtitle1",className:"font-semibold text-gray-900 mb-1",title:e.name,sx:{overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",position:"relative",zIndex:10},children:e.name}),s.jsxs("div",{className:"flex items-center justify-between mt-2",children:[s.jsx(vA,{variant:"caption",className:"text-gray-500",children:void 0!==t?`${t} ${1===t?"route":"routes"}`:"No routes"}),s.jsx(vA,{variant:"caption",className:"text-gray-400",children:(e=>{try{if(!e)return"Recently";let t;const n=e.endsWith("Z")||e.match(/[+-]\d{2}:?\d{2}$/);return t=e.includes("T")&&!n?new Date(`${e}Z`):new Date(e),isNaN(t.getTime())?"Recently":UZ(t,{addSuffix:!0})}catch{return"Recently"}})(e.updatedAt||e.createdAt)})]})]})]})]}),QZ=({projects:e,isLoading:t=!1})=>{const n=_c(),r=ye(),o=(()=>{const e=ye();return Ee({mutationFn:async e=>{const t=await pj.delete(e);if(!t.success)throw new Error(t.message);return t.data},onSuccess:()=>{e.invalidateQueries({queryKey:eX.projects}),e.invalidateQueries({queryKey:eX.gcpProjects})}})})(),i=(()=>{const e=ye();return Ee({mutationFn:async({projectId:e,updates:t})=>{const n=await pj.update(e,t);if(!n.success)throw new Error(n.message);return n.data},onSuccess:(t,n)=>{e.invalidateQueries({queryKey:eX.projects}),e.invalidateQueries({queryKey:eX.project(n.projectId)})}})})(),[a,l]=pe.useState(!1),[c,u]=pe.useState(null),[d,A]=pe.useState(!1),[h,p]=pe.useState(null),{register:f,handleSubmit:g,reset:m,formState:{errors:y,isSubmitting:v}}=Kq({defaultValues:{name:""}}),[b,w]=pe.useState(""),[x,_]=pe.useState(!1),[C,S]=pe.useState(!1),E=pe.useRef(null),B=pe.useMemo(()=>{if(!b.trim())return e;const t=b.toLowerCase().trim();return e.filter(e=>e.name.toLowerCase().includes(t))},[e,b]),I=()=>{n("/add-project")},R=()=>{_(!1),E.current&&(E.current.value="")},k=()=>{l(!1),u(null)},T=async e=>{if(!h)return;const t=e.name.trim();if(t===h.name)return A(!1),p(null),void m();try{await i.mutateAsync({projectId:h.id,updates:{name:t}}),Tw(`Project renamed to "${t}" successfully`),A(!1),p(null),m()}catch(n){Pw(n instanceof Error?n.message:"Failed to rename project")}},P=()=>{A(!1),p(null),m()};return s.jsxs("div",{className:"absolute left-1/2 -translate-x-1/2 w-full max-w-[95vw] sm:max-w-[90vw] md:max-w-[85vw] lg:max-w-[95vw] xl:max-w-[90rem] px-2 sm:px-4 z-10",style:{top:"calc(64px + 32px)",bottom:"32px",maxHeight:"calc(100vh - 64px - 64px)"},children:[s.jsx(qp,{in:!0,timeout:600,children:s.jsx(yf,{elevation:10,sx:{padding:0,maxHeight:"100%",display:"flex",flexDirection:"column","& .MuiCardContent-root":{padding:0,display:"flex",flexDirection:"column",flex:1,minHeight:0,maxHeight:"100%"}},className:"bg-[#f8f9fa] backdrop-blur-[16px] rounded-[24px] overflow-hidden",children:s.jsx(Ef,{className:"pb-0 flex-1 min-h-0 "+(0!==e.length||t?"overflow-hidden":"overflow-y-auto"),children:s.jsxs("div",{className:"flex flex-col h-full min-h-0",children:[s.jsx("div",{className:"flex-shrink-0",children:s.jsx(yf,{elevation:0,sx:{borderTopLeftRadius:"24px",borderTopRightRadius:"24px",borderBottomLeftRadius:"0px",borderBottomRightRadius:"0px",backgroundColor:"white",border:"1px solid #e5e7eb"},className:"overflow-hidden",children:s.jsx("div",{className:"p-6 sm:p-4 md:p-6",children:s.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-end sm:justify-between gap-3 sm:gap-4",children:[s.jsxs("div",{className:"flex-1 min-w-0",children:[s.jsx(vA,{variant:"h4",className:"font-bold text-gray-900 mb-2 text-xl sm:text-2xl md:text-3xl lg:text-4xl",children:"Projects"}),s.jsx(vA,{variant:"body2",className:"text-gray-700 text-xs sm:text-sm md:text-base mb-2 sm:mb-3",children:"Manage your road jurisdictions and insights."})]}),s.jsxs("div",{className:"flex flex-col sm:flex-row gap-2 flex-shrink-0 w-full sm:w-auto",children:[s.jsx(Nv,{onClick:()=>{_(!0)},variant:"outlined",startIcon:s.jsx(gY,{}),sx:{borderColor:"#dadce0",color:"#5f6368",textTransform:"none",fontSize:"11px",fontWeight:500,padding:"6px 12px",borderRadius:"24px",flexShrink:0,width:"100%","@media (min-width: 640px)":{fontSize:"12px",padding:"8px 16px",width:"auto"},"&:hover":{borderColor:"#bdc1c6",backgroundColor:"#f8f9fa"},transition:"all 0.2s cubic-bezier(0.4, 0, 0.2, 1)"},children:"Import Project"}),s.jsx(Nv,{onClick:I,variant:"contained",startIcon:s.jsx(fX,{}),sx:{backgroundColor:"#0b57d0",color:"#ffffff",textTransform:"none",fontSize:"11px",fontWeight:500,padding:"6px 12px",borderRadius:"24px",boxShadow:"0 1px 3px rgba(11, 87, 208, 0.4), 0 1px 2px rgba(11, 87, 208, 0.3)",flexShrink:0,width:"100%","@media (min-width: 640px)":{fontSize:"12px",padding:"8px 16px",width:"auto"},"&:hover":{backgroundColor:"#0942a0",boxShadow:"0 2px 6px rgba(11, 87, 208, 0.4), 0 2px 4px rgba(11, 87, 208, 0.3)"},"&:active":{boxShadow:"0 1px 3px rgba(11, 87, 208, 0.4)",transform:"translateY(1px)"},transition:"all 0.2s cubic-bezier(0.4, 0, 0.2, 1)"},children:"New Project"})]})]})})})}),s.jsxs("div",{className:"min-w-0 p-2 sm:p-4 md:p-4 pt-0 flex flex-col",style:{height:"calc(100vh - 300px)",minHeight:"400px",maxHeight:"calc(100vh - 300px)"},children:[(t||e.length>0)&&s.jsx("div",{className:"mb-4 sm:mb-6 flex-shrink-0",children:s.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-3 sm:gap-4 pb-4 border-b border-gray-200",children:[s.jsxs(vA,{variant:"h6",className:"font-semibold text-gray-900 text-base sm:text-lg",children:["All projects"," ",!t&&s.jsxs("span",{className:"text-gray-500 font-normal",children:["(",e.length,")"]})]}),s.jsx("div",{className:"flex items-center gap-3 flex-1 sm:flex-initial sm:justify-end",children:s.jsx(fJ,{placeholder:"Search projects...",value:b,onChange:w,disabled:t})})]})}),t?s.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 2xl:grid-cols-5 gap-x-3 sm:gap-x-4 gap-y-6 sm:gap-y-8 px-3  overflow-y-auto items-start flex-1 min-h-0",children:[...Array(6)].map((e,t)=>s.jsx(NZ,{},`skeleton-${t}`))}):0===e.length?s.jsx("div",{className:"flex items-center justify-center py-6 sm:py-8 md:py-12 lg:py-16 h-full",children:s.jsxs("div",{className:"text-center max-w-md px-2 sm:px-4 w-full",children:[s.jsx("div",{className:"mb-4 sm:mb-6 flex justify-center",children:s.jsx("div",{className:"w-16 h-16 sm:w-20 sm:h-20 md:w-24 md:h-24 rounded-full bg-gradient-to-br from-blue-50 to-indigo-100 flex items-center justify-center",children:s.jsx(fX,{sx:{fontSize:"36px","@media (min-width: 640px)":{fontSize:"42px"},"@media (min-width: 768px)":{fontSize:"48px"},color:sJ,opacity:.8}})})}),s.jsx(vA,{variant:"h6",className:"font-semibold text-gray-900 mb-2 text-base sm:text-lg md:text-xl",children:"No projects yet"}),s.jsx(vA,{variant:"body2",className:"text-gray-500 mb-6 sm:mb-8 text-xs sm:text-sm md:text-base px-2",children:"Get started by creating your first project to select and manage roads for your jurisdiction."}),s.jsx(Nv,{onClick:I,variant:"contained",startIcon:s.jsx(fX,{}),sx:{backgroundColor:"#1967D2",color:"#ffffff",textTransform:"none",fontSize:"14px",fontWeight:500,padding:"10px 24px",boxShadow:"0 1px 3px rgba(25, 103, 210, 0.4), 0 1px 2px rgba(25, 103, 210, 0.3)","&:hover":{backgroundColor:"#1557B0",boxShadow:"0 2px 6px rgba(25, 103, 210, 0.4), 0 2px 4px rgba(25, 103, 210, 0.3)"},transition:"all 0.2s cubic-bezier(0.4, 0, 0.2, 1)"},children:"Create your first project"})]})}):0===B.length&&b.trim()?s.jsx("div",{className:"flex items-center justify-center py-6 sm:py-8 md:py-12 lg:py-16 h-full",children:s.jsxs("div",{className:"text-center max-w-md px-2 sm:px-4 w-full",children:[s.jsx("div",{className:"mb-4 sm:mb-6 flex justify-center",children:s.jsx("div",{className:"w-16 h-16 sm:w-20 sm:h-20 md:w-24 md:h-24 rounded-full bg-gradient-to-br from-gray-50 to-gray-100 flex items-center justify-center",children:s.jsx(cY,{sx:{fontSize:"36px","@media (min-width: 640px)":{fontSize:"42px"},"@media (min-width: 768px)":{fontSize:"48px"},color:"#5f6368",opacity:.6}})})}),s.jsx(vA,{variant:"h6",className:"font-semibold text-gray-900 mb-2 text-base sm:text-lg md:text-xl",children:"No projects found"}),s.jsxs(vA,{variant:"body2",className:"text-gray-500 mb-6 sm:mb-8 text-xs sm:text-sm md:text-base px-2",children:['No projects match your search query "',b,'". Try a different search term.']})]})}):s.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 2xl:grid-cols-5 gap-x-3 sm:gap-x-4 gap-y-6 sm:gap-y-8 px-3 overflow-y-auto items-start flex-1 min-h-0",children:B.map(e=>s.jsx(zZ,{project:e,onClick:()=>{return t=e.id,tj(),void n(`/project/${t}`);var t},onDelete:t=>((e,t)=>{e.stopPropagation(),u(t),l(!0)})(t,e),onRename:t=>((e,t)=>{e.stopPropagation(),p(t),m({name:t.name}),A(!0)})(t,e)},e.id))})]})]})})})}),s.jsx(jv,{open:d,onClose:P,maxWidth:"sm",title:"Rename Project",actions:s.jsxs(s.Fragment,{children:[s.jsx(Nv,{onClick:P,variant:"text",disabled:v||i.isPending,sx:{color:"#5f6368","&:hover":{backgroundColor:"rgba(95, 99, 104, 0.08)"}},children:"Cancel"}),s.jsx(Nv,{type:"submit",form:"rename-project-form",variant:"contained",disabled:v||i.isPending,sx:{backgroundColor:sJ,color:"#ffffff",boxShadow:"0 1px 3px rgba(9, 87, 208, 0.4)","&:hover":{backgroundColor:aJ,boxShadow:"0 2px 4px rgba(9, 87, 208, 0.4)"},"&:disabled":{backgroundColor:"rgba(0, 0, 0, 0.12)",color:"rgba(0, 0, 0, 0.26)"},transition:"all 0.2s cubic-bezier(0.4, 0, 0.2, 1)"},children:v||i.isPending?"Renaming...":"Rename"})]}),children:s.jsx("form",{onSubmit:g(T),id:"rename-project-form",children:s.jsx(Dv,{autoFocus:!0,margin:"dense",label:"Project Name",type:"text",fullWidth:!0,variant:"outlined",...f("name",{required:"Project name cannot be empty",maxLength:{value:100,message:"Project name must not exceed 100 characters"},validate:e=>{const t=e.trim();return t?!(t.length>100)||"Project name must not exceed 100 characters":"Project name cannot be empty"}}),error:!!y.name,helperText:y.name?.message,inputProps:{maxLength:100},onKeyDown:e=>{"Enter"===e.key&&(e.preventDefault(),g(T)())},sx:{mt:2}})})}),s.jsx(jv,{open:a,onClose:k,maxWidth:"sm",title:"Delete Project",actions:s.jsxs(s.Fragment,{children:[s.jsx(Nv,{onClick:k,variant:"text",sx:{color:"#5f6368","&:hover":{backgroundColor:"rgba(95, 99, 104, 0.08)"}},children:"Cancel"}),s.jsx(Nv,{onClick:async()=>{if(c)try{await o.mutateAsync(c.id),Tw(`Project "${c.name}" deleted successfully`),l(!1),u(null)}catch(e){Pw(e instanceof Error?e.message:"Failed to delete project")}},variant:"contained",disabled:o.isPending,children:o.isPending?"Deleting...":"Delete"})]}),children:s.jsxs(vA,{variant:"body2",className:"text-gray-700",children:["Are you sure you want to delete the project"," ",s.jsxs("span",{className:"font-semibold text-gray-900",children:['"',c?.name,'"']}),"? This action cannot be undone and will permanently delete all associated routes and data."]})}),s.jsx(jv,{open:x,onClose:R,maxWidth:"sm",title:"Import Project from ZIP",actions:s.jsxs(s.Fragment,{children:[s.jsx(Nv,{onClick:R,variant:"text",disabled:C,sx:{color:"#5f6368","&:hover":{backgroundColor:"rgba(95, 99, 104, 0.08)"}},children:"Cancel"}),s.jsx(Nv,{onClick:()=>{E.current?.click()},variant:"contained",disabled:C,sx:{backgroundColor:sJ,color:"#ffffff",boxShadow:"0 1px 3px rgba(9, 87, 208, 0.4)","&:hover":{backgroundColor:aJ,boxShadow:"0 2px 4px rgba(9, 87, 208, 0.4)"},"&:disabled":{backgroundColor:"rgba(0, 0, 0, 0.12)",color:"rgba(0, 0, 0, 0.26)"}},children:C?"Importing...":"Select ZIP File"}),s.jsx("input",{ref:E,type:"file",accept:".zip",onChange:async e=>{const t=e.target.files?.[0];if(t)if(t.name.endsWith(".zip")){S(!0);try{const e=await pj.importProject(t);if(e.success&&e.data){const{new_project_id:t,routes_inserted:o}=e.data;Tw(`Project imported successfully! ${o} routes inserted.`),r.invalidateQueries({queryKey:eX.projects}),tj(),n(`/project/${t}`),R()}else{const t=e.message||"Failed to import project";Pw("Import Failed",{description:t}),E.current&&(E.current.value="")}}catch(o){const e=o instanceof Error?o.message:"Failed to import project";Pw("Import Failed",{description:e}),E.current&&(E.current.value="")}finally{S(!1)}}else Pw("Invalid File Type",{description:"Please select a .zip file"})},className:"hidden"})]}),children:s.jsx(rf,{sx:{display:"flex",flexDirection:"column",gap:2,pt:1},children:s.jsx(vA,{variant:"body2",sx:{color:"#5f6368",mb:1},children:"Select a project ZIP file to import. All project information will be extracted from the ZIP file."})})})]})},zZ=({project:e,onClick:t,onDelete:n,onRename:r})=>{const{data:o}=oX(e.id);return s.jsx(jZ,{project:e,routeCount:o,onClick:t,onDelete:n,onRename:r})};function HZ(){const{data:e=[],isLoading:t,error:n}=tX();return pe.useEffect(()=>{tj()},[]),n?s.jsx(vJ,{children:s.jsx(nJ,{children:s.jsx("div",{className:"flex items-center justify-center h-full",children:s.jsxs("div",{className:"text-center",children:[s.jsx("p",{className:"text-red-600 mb-4",children:"Failed to load projects"}),s.jsx("p",{className:"text-gray-600",children:"Please try refreshing the page"})]})})})}):s.jsx(vJ,{children:s.jsxs(nJ,{children:[s.jsx(uZ,{apiKey:Hw(),style:{width:"100%",height:"100%"}}),s.jsx("div",{className:"absolute inset-0 bg-white/30 backdrop-blur-sm z-0"}),s.jsx(QZ,{projects:e,isLoading:t}),s.jsx(tJ,{})]})})}const GZ=(e="main-map")=>{const t=ZJ(e),n=pe.useCallback((e,n)=>{if(!t)return;if(!e)return;let r;if("string"==typeof e)r=Sw(e);else if(e&&"object"==typeof e&&"encodedPolyline"in e)r=Sw(e.encodedPolyline);else{if(!e||"object"!=typeof e||!("linestring"in e))return;r=e.linestring}if(!r||"LineString"!==r.type||!Array.isArray(r.coordinates)||0===r.coordinates.length)return;const o=function(e,t=.1){const[n,r,o,i]=e,s=o-n,a=i-r;return[n-s*t,r-a*t,o+s*t,i+a*t]}(Eb(r),.15),[i,s,a,l]=o,c=(i+a)/2,u=(s+l)/2,d=t.getDiv(),A=d?.offsetWidth||window.innerWidth,h=d?.offsetHeight||window.innerHeight,p=void 0===n?.padding?100:(n.padding,n.padding),f=function(e,t,n,r){const[o,i,s,a]=e,l=6378137,c=2*Math.PI*l,u=t-2*r,d=n-2*r;if(u<=0||d<=0)return 12;const A=(i+a)/2,h=Math.PI*l/180,p=(s-o)*(h*Math.cos(A*Math.PI/180)),f=(a-i)*h,g=Math.log2(u*c/(256*p)),m=Math.log2(d*c/(256*f));let y=Math.min(g,m);return y=Math.max(3,Math.min(18,y)),Math.floor(y)}(o,A,h,p);t.setCenter({lat:u,lng:c}),t.setZoom(f);const g=new google.maps.LatLngBounds(new google.maps.LatLng(s,i),new google.maps.LatLng(l,a)),m=t.getZoom();if(m&&m>18){t.fitBounds(g,p);const e=t.getZoom();e&&e>18&&t.setZoom(18)}},[t]);return n},VZ=pe.createContext({navigateToGeometry:null,setNavigateToGeometry:()=>{}}),WZ=({children:e})=>{const[t,n]=pe.useState(null),r=pe.useCallback(e=>{n(t=>e)},[]),o=pe.useMemo(()=>({navigateToGeometry:t,setNavigateToGeometry:r}),[t,r]);return s.jsx(VZ.Provider,{value:o,children:e})},$Z=({mapId:e="main-map"})=>{const{setNavigateToGeometry:t}=KZ(),n=GZ(e),r=pe.useRef(!1),o=pe.useRef(n),i=pe.useRef(e);return fe.useEffect(()=>{const s=o.current!==n,a=i.current!==e;s&&(o.current=n,r.current=!1),a&&(i.current=e,r.current=!1),t&&n&&(!r.current||s||a)&&(t(n),r.current=!0)},[n,t,e]),null},KZ=()=>{const e=pe.useContext(VZ);return e||{navigateToGeometry:null,setNavigateToGeometry:()=>{}}};let XZ=!1;const YZ=new Map;let qZ=null,JZ=null,ZZ=0,e0="";const t0=[],n0=async(e,t,n)=>{if(!e)return;const r=e.name.split(".").pop()?.toLowerCase(),o=["geojson","json","kml","kmz","gpx","zip"];if(!r||!o.includes(r)){const e=`Unsupported file format. Please upload one of: ${o.join(", ")}`;return Pw(e),void t.setErrorMessage?.(e)}await async function(e,t,n){XZ=!1,YZ.clear(),JZ=null,ZZ=0,e0="";const r=Lw(`Processing ${e.name}...`,{description:"Uploading and processing file"});qZ=r;try{const o={};n&&(o.naming_type=n.type,o.naming_value=n.value);const i=await uj.uploadFile("/file-upload/process-file",e,o);if(XZ)return;if(!i.success)throw new Error(i.message||"Failed to process GeoJSON file");const s={type:"FeatureCollection",features:i.features.map(e=>({type:"Feature",geometry:e.geometry,properties:e.properties}))},{useProjectWorkspaceStore:a}=await Ie(async()=>{const{useProjectWorkspaceStore:e}=await Promise.resolve().then(()=>ZN);return{useProjectWorkspaceStore:e}},void 0),l=a.getState().projectData,c=l?.boundaryGeoJson;!function(e,t,n,r,o,i,s){const a=function(e){if(0===e.features.length)return{isValid:!1,errorMessage:"The uploaded file has no features."};const t=[];if(e.features.forEach((e,n)=>{const r=e.geometry.type;"LineString"!==r&&"MultiLineString"!==r&&t.push({index:n,geometryType:r})}),t.length>0){return{isValid:!1,errorMessage:`The uploaded file contains features with non-LineString geometry types (${[...new Set(t.map(e=>e.geometryType))].join(", ")}). Only LineString and MultiLineString geometries are supported.`}}return{isValid:!0}}(e);if(!a.isValid){const e=a.errorMessage||"The uploaded file has no LineString geometries.";return Uw(o,e,"error",{duration:5e3}),void r.setErrorMessage?.(e)}const l=500;if(e.features.length>l){const t=`GeoJSON file contains ${e.features.length} features. Maximum allowed is ${l} features.`;return Uw(o,t,"error",{duration:5e3}),void r.setErrorMessage?.(t)}const c=Date.now(),u=[];let d=0;const A="outside jurisdiction boundary";t0.length=0;for(let h=0;h<e.features.length;h++){if(XZ)return Uw(o,"Uploading cancelled","info",{duration:5e3}),r.setErrorMessage?.("Processing cancelled"),u.forEach(e=>{const t=YZ.get(e);t&&t.abort()}),YZ.clear(),void(qZ=null);const a=e.features[h];if(!r0(a,s)){d++;continue}const l=`${n}-${c}-${h}`;u.push(l);const A=e=>"string"==typeof e&&e.trim().length>0&&"null"!==e&&"undefined"!==e,p=()=>`${t} - Feature ${h+1}`;let f;if(i)if("property"===i.type){const e=a.properties?.[i.value];f=A(e)?String(e).trim():p()}else f=`${i.value} ${h+1}`;else{const e=a.properties?.name;f=A(e)?String(e).trim():p()}const g={type:"FeatureCollection",features:[a]};if(r.addUploadedRoute({id:l,name:f,type:"geojson",data:g,color:[255,235,59,255],uploadedAt:new Date}),XZ)continue;const m=new AbortController;YZ.set(l,m),r.registerAbortController&&r.registerAbortController(l,m),XZ?(m.abort(),YZ.delete(l)):o0(l,f,g,r,m.signal).catch(()=>{YZ.delete(l)})}XZ||(qZ=null);if(!XZ){if(u.length>0&&r.focusOnUploadedRoutes(u),0===u.length){const e=`**0** routes uploaded  **${d}** discarded (${A})`;return Uw(o,e,"warning",{description:d>0?"All routes were outside the jurisdiction boundary and could not be uploaded.":"No routes were uploaded.",duration:5e3}),void r.setErrorMessage?.(e)}const e=1===u.length?"route":"routes";let t=`**${u.length}** ${e} uploaded`;d>0&&(t+=`  **${d}** discarded (${A})`),t0.length>0&&(t+=`  **${t0.length}** failed to generate`);const n=t0.length>0?`${t0.length} route${1===t0.length?"":"s"} could not be generated`:"Generating Google routes...";JZ=o,ZZ=u.length,e0=t,Uw(o,t,"loading",{description:n,duration:1/0}),r.setSuccessMessage?.(t),t0.length}}(s,e.name,"geojson",t,r,n,c)}catch(o){if(XZ)return;const e=o instanceof Error?o.message:"Failed to process GeoJSON file";Uw(r,e,"error",{duration:5e3}),t.setErrorMessage?.(e)}finally{XZ||(qZ=null)}}(e,t,n)};function r0(e,t){if(!t)return!0;const n=function(e){const t=[],n=e.geometry;return"LineString"===n.type?t.push(...n.coordinates):"MultiLineString"===n.type&&n.coordinates.forEach(e=>{t.push(...e)}),t}(e);return 0!==n.length&&n.every(([e,n])=>Ew(n,e,t))}const o0=async(e,t,n,r,o)=>{if(XZ)return;let i,s;o?s=o:(i=new AbortController,s=i.signal,YZ.set(e,i));try{if(XZ||s.aborted)return;r.setSnappedRoadsLoading(!0);const o=[];if(n.features.forEach(e=>{if("LineString"===e.geometry.type||"MultiLineString"===e.geometry.type){("LineString"===e.geometry.type?e.geometry.coordinates:e.geometry.coordinates.flat()).forEach(e=>{o.push([e[0],e[1]])})}}),o.length<2)return;if(XZ||s.aborted)return;const i=o[0],a=o[o.length-1];if(XZ||s.aborted)return;const l=await Vw.generateRoute({lat:i[1],lng:i[0]},{lat:a[1],lng:a[0]},[],s);if(XZ||s.aborted)return;if(!l.success||!l.data){const n=l.message||"No routes found";return void t0.push({routeId:e,routeName:t,error:n})}const{encodedPolyline:c,distance:u,duration:d}=l.data,A=u.toFixed(2),h=d.toFixed(0);if(XZ||s.aborted)return;const p=Sw(c);if(XZ||s.aborted)return;const f={type:"Feature",geometry:p,properties:{id:`${e}-optimized`,name:"Optimized Route",source:"google_routes_api",distance:A,duration:h,traffic_aware:!0,encodedPolyline:c}};if(XZ||s.aborted)return;r.addSnappedRoads(e,[f]),r.setOptimizedRouteMarkers(e,{lat:i[1],lng:i[0]},{lat:a[1],lng:a[0]});const g=`Generated Google route: ${A}km, ~${h}min`;r.setSuccessMessage?.(g)}catch(a){if(a instanceof Error&&"AbortError"===a.name||XZ||s&&s.aborted)return;const e=a instanceof Error?a.message:"Failed to generate optimized route";Pw(e,{duration:5e3}),r.setErrorMessage?.(e)}finally{YZ.delete(e);const t=YZ.size;if(!XZ&&0===t&&(r.setSnappedRoadsLoading(!1),null!==JZ&&ZZ>0)){Uw(JZ,e0||`**${ZZ}** route${1===ZZ?"":"s"} uploaded`,"success",{description:"All Google routes generated",duration:5e3}),JZ=null,ZZ=0,e0=""}}},i0=()=>{const e=JN(e=>e.setMapMode),t=JN(e=>e.mapMode),n=JN(e=>e.setRouteNamingDialogOpen),r=JN(e=>e.routeNamingDialogOpen),o=JN(e=>e.pendingFile),i=JN(e=>e.setPendingFile),s=JN(e=>e.pendingFeatureCount),a=JN(e=>e.setPendingFeatureCount),l=JN(e=>e.pendingProperties),c=JN(e=>e.setPendingProperties),u=$N(e=>e.clearAllDrawing),d=$N(e=>e.addUploadedRoute),A=$N(e=>e.addSnappedRoads),h=$N(e=>e.setSnappedRoadsLoading),p=$N(e=>e.setOptimizedRouteMarkers),f=$N(e=>e.focusOnUploadedRoutes),g=pe.useRef(null),m=pe.useRef(!1),y=pe.useRef(null);return{fileInputRef:g,pendingFile:o,pendingFeatureCount:s,pendingProperties:l,routeNamingDialogOpen:r,handleUploadRoute:n=>{const{uploadedRoutes:r}=$N.getState(),o=r.routes.length>0;if("upload_routes"===t){if(o)return JN.getState().setPendingUploadClear(!0),void n?.();e("view"),u(),m.current=!1,y.current&&(window.removeEventListener("focus",y.current),y.current=null)}else{if(o)return JN.getState().setPendingUploadClear(!0),void n?.();const t=JN.getState().pendingModeSwitch,r=$N.getState().roadImport.pendingModeSwitch;e("upload_routes");const i=JN.getState().pendingModeSwitch,s=$N.getState().roadImport.pendingModeSwitch;if(!(null!==i&&i!==t||null!==s&&s!==r)){u(),m.current=!0,g.current?.click();const t=()=>{setTimeout(()=>{m.current&&g.current&&!g.current.files?.length&&(e("view"),m.current=!1),y.current&&(window.removeEventListener("focus",y.current),y.current=null)},100)};y.current&&window.removeEventListener("focus",y.current),y.current=t,window.addEventListener("focus",t,{once:!0})}}n?.()},handleFileUploadChange:t=>{const r=t.target.files?.[0];if(y.current&&(window.removeEventListener("focus",y.current),y.current=null),m.current=!1,!r){return void("upload_routes"===JN.getState().mapMode&&e("view"))}const o=JN.getState().projectData,s=o?.boundaryGeoJson,l=Lw(`Analyzing ${r.name}...`,{description:"Reading GeoJSON file and extracting metadata"});(async()=>{try{if(r.name.toLowerCase().endsWith(".geojson")||r.name.toLowerCase().endsWith(".json")){const e=await r.text();let t,n;try{t=JSON.parse(e)}catch{throw new Error("Invalid JSON format")}if("FeatureCollection"===t.type)n=t;else if("Feature"===t.type)n={type:"FeatureCollection",features:[t]};else{if("LineString"!==t.type&&"MultiLineString"!==t.type)throw new Error("Invalid file format. The file must contain routes (LineString or MultiLineString geometries).");n={type:"FeatureCollection",features:[{type:"Feature",geometry:t,properties:{}}]}}const o=n.features.filter(e=>"LineString"===e.geometry.type||"MultiLineString"===e.geometry.type);if(0===o.length)throw new Error("No routes found in the file. The file must contain LineString or MultiLineString geometries to be uploaded as routes.");if(s){if(0===o.filter(e=>{const t=[],n=e.geometry;return"LineString"===n.type?t.push(...n.coordinates):"MultiLineString"===n.type&&n.coordinates.forEach(e=>{t.push(...e)}),t.some(([e,t])=>Ew(t,e,s))}).length)throw new Error("No routes found within the jurisdiction boundary. Please ensure your file contains routes (LineString features) that are located within the project's jurisdiction area.")}}const{apiClient:e}=await Ie(async()=>{const{apiClient:e}=await Promise.resolve().then(()=>dj);return{apiClient:e}},void 0),t=await e.uploadFile("/file-upload/preview-file",r);if(!t.success)throw new Error(t.message||"Failed to preview file");i(r),a(t.feature_count),c(t.available_properties),n(!0),Ow(l)}catch(e){const t=e instanceof Error?e.message:"Failed to analyze file. Please ensure it's a valid GeoJSON file.";Uw(l,t,"error")}})(),g.current&&(g.current.value="")},handleRouteNamingConfirm:e=>{if(!o)return;const t=window,n={addUploadedRoute:d,addSnappedRoads:A,setSnappedRoadsLoading:h,setOptimizedRouteMarkers:p,focusOnUploadedRoutes:f,registerAbortController:t.__registerRouteAbortController,getAbortController:t.__getRouteAbortController};n0(o,n,e).catch(e=>{Pw(e instanceof Error?e.message:"Failed to upload file")}),i(null),a(0),c([])},handleRouteNamingCancel:()=>{i(null),a(0),c([]),n(!1)},handleClearUploadedRoutesAndUpload:()=>{const{clearUploadedRoutes:t,clearSnappedRoads:n,clearAllOptimizedRouteMarkers:r,setSelectedUploadedRouteId:o}=$N.getState();t(),n(),r(),o(null),JN.getState().setPendingUploadClear(!1),e("upload_routes"),setTimeout(()=>{u(),m.current=!0;const t=document.querySelector('input[type="file"][accept*="geojson"]');if(t){const n=()=>{setTimeout(()=>{t&&!t.files?.length&&(e("view"),m.current=!1),window.removeEventListener("focus",n)},100)};window.addEventListener("focus",n,{once:!0}),g.current?g.current.click():t.click()}else setTimeout(()=>{const t=document.querySelector('input[type="file"][accept*="geojson"]');if(t){const n=()=>{setTimeout(()=>{t&&!t.files?.length&&(e("view"),m.current=!1),window.removeEventListener("focus",n)},100)};window.addEventListener("focus",n,{once:!0}),t.click()}},200)},150)}}};function s0(e){const t="hybrid"===e;return{routeStatusColors:t?lN:KD,selectedRouteColor:t?cN:XD,individualPreviewColor:t?uN:YD,segmentHoverColor:t?dN:qD,segmentBaseColor:t?AN:JD,roadSelectionColor:t?hN:ZD,polygonRouteColor:t?pN:eN,uploadedRouteColor:t?fN:tN,jurisdictionBoundaryColor:t?gN:nN,pathBorderColor:t?mN:rN,pathBorderColorIndividualPreview:t?yN:oN,roadsNetworkColor:t?vN:$D,importedRoadsDefaultColor:t?EN:bN,importedRoadsHoveredColor:t?BN:wN,importedRoadsSelectedColor:t?IN:xN,importedRoadsValidColor:t?RN:_N,importedRoadsLassoColor:t?kN:CN,importedRoadsGrayscaleColor:t?TN:SN}}const a0="uniform iconUniforms {\n  float sizeScale;\n  vec2 iconsTextureDim;\n  float sizeMinPixels;\n  float sizeMaxPixels;\n  bool billboard;\n  highp int sizeUnits;\n  float alphaCutoff;\n} icon;\n",l0={name:"icon",vs:a0,fs:a0,uniformTypes:{sizeScale:"f32",iconsTextureDim:"vec2<f32>",sizeMinPixels:"f32",sizeMaxPixels:"f32",billboard:"f32",sizeUnits:"i32",alphaCutoff:"f32"}},c0=()=>{},u0={minFilter:"linear",mipmapFilter:"linear",magFilter:"linear",addressModeU:"clamp-to-edge",addressModeV:"clamp-to-edge"},d0={x:0,y:0,width:0,height:0};function A0(e,t,n,r){const o=Math.min(n/t.width,r/t.height),i=Math.floor(t.width*o),s=Math.floor(t.height*o);return 1===o?{image:t,width:i,height:s}:(e.canvas.height=s,e.canvas.width=i,e.clearRect(0,0,i,s),e.drawImage(t,0,0,t.width,t.height,0,0,i,s),{image:e.canvas,width:i,height:s})}function h0(e){return e&&(e.id||e.url)}function p0(e,t,n){for(let r=0;r<t.length;r++){const{icon:o,xOffset:i}=t[r];e[h0(o)]={...o,x:i,y:n}}}class f0{constructor(e,{onUpdate:t=c0,onError:n=c0}){this._loadOptions=null,this._texture=null,this._externalTexture=null,this._mapping={},this._samplerParameters=null,this._pendingCount=0,this._autoPacking=!1,this._xOffset=0,this._yOffset=0,this._rowHeight=0,this._buffer=4,this._canvasWidth=1024,this._canvasHeight=0,this._canvas=null,this.device=e,this.onUpdate=t,this.onError=n}finalize(){this._texture?.delete()}getTexture(){return this._texture||this._externalTexture}getIconMapping(e){const t=this._autoPacking?h0(e):e;return this._mapping[t]||d0}setProps({loadOptions:e,autoPacking:t,iconAtlas:n,iconMapping:r,textureParameters:o}){e&&(this._loadOptions=e),void 0!==t&&(this._autoPacking=t),r&&(this._mapping=r),n&&(this._texture?.delete(),this._texture=null,this._externalTexture=n),o&&(this._samplerParameters=o)}get isLoaded(){return 0===this._pendingCount}packIcons(e,t){if(!this._autoPacking||"undefined"==typeof document)return;const n=Object.values(function(e,t,n){if(!e||!t)return null;n=n||{};const r={},{iterable:o,objectInfo:i}=uO(e);for(const s of o){i.index++;const e=t(s,i),o=h0(e);if(!e)throw new Error("Icon is missing.");if(!e.url)throw new Error("Icon url is missing.");r[o]||n[o]&&e.url===n[o].url||(r[o]={...e,source:s,sourceIndex:i.index})}return r}(e,t,this._mapping)||{});if(n.length>0){const{mapping:e,xOffset:t,yOffset:r,rowHeight:o,canvasHeight:i}=function({icons:e,buffer:t,mapping:n={},xOffset:r=0,yOffset:o=0,rowHeight:i=0,canvasWidth:s}){let a=[];for(let c=0;c<e.length;c++){const l=e[c];if(!n[h0(l)]){const{height:e,width:c}=l;r+c+t>s&&(p0(n,a,o),r=0,o=i+o+t,i=0,a=[]),a.push({icon:l,xOffset:r}),r=r+c+t,i=Math.max(i,e)}}return a.length>0&&p0(n,a,o),{mapping:n,rowHeight:i,xOffset:r,yOffset:o,canvasWidth:s,canvasHeight:(l=i+o+t,Math.pow(2,Math.ceil(Math.log2(l))))};var l}({icons:n,buffer:this._buffer,canvasWidth:this._canvasWidth,mapping:this._mapping,rowHeight:this._rowHeight,xOffset:this._xOffset,yOffset:this._yOffset});this._rowHeight=o,this._mapping=e,this._xOffset=t,this._yOffset=r,this._canvasHeight=i,this._texture||(this._texture=this.device.createTexture({format:"rgba8unorm",width:this._canvasWidth,height:this._canvasHeight,sampler:this._samplerParameters||u0,mipmaps:!0})),this._texture.height!==this._canvasHeight&&(this._texture=function(e,t,n,r){const{width:o,height:i,device:s}=e,a=s.createTexture({format:"rgba8unorm",width:t,height:n,sampler:r,mipmaps:!0}),l=s.createCommandEncoder();return l.copyTextureToTexture({sourceTexture:e,destinationTexture:a,width:o,height:i}),l.finish(),e.destroy(),a}(this._texture,this._canvasWidth,this._canvasHeight,this._samplerParameters||u0)),this.onUpdate(),this._canvas=this._canvas||document.createElement("canvas"),this._loadIcons(n)}}_loadIcons(e){const t=this._canvas.getContext("2d",{willReadFrequently:!0});for(const n of e)this._pendingCount++,V_(n.url,this._loadOptions).then(e=>{const r=h0(n),o=this._mapping[r],{x:i,y:s,width:a,height:l}=o,{image:c,width:u,height:d}=A0(t,e,a,l);this._texture?.copyExternalImage({image:c,x:i+(a-u)/2,y:s+(l-d)/2,width:u,height:d}),o.width=u,o.height=d,this._texture.generateMipmap(),this.onUpdate()}).catch(e=>{this.onError({url:n.url,source:n.source,sourceIndex:n.sourceIndex,loadOptions:this._loadOptions,error:e})}).finally(()=>{this._pendingCount--})}}const g0=[0,0,0,255],m0={iconAtlas:{type:"image",value:null,async:!0},iconMapping:{type:"object",value:{},async:!0},sizeScale:{type:"number",value:1,min:0},billboard:!0,sizeUnits:"pixels",sizeMinPixels:{type:"number",min:0,value:0},sizeMaxPixels:{type:"number",min:0,value:Number.MAX_SAFE_INTEGER},alphaCutoff:{type:"number",value:.05,min:0,max:1},getPosition:{type:"accessor",value:e=>e.position},getIcon:{type:"accessor",value:e=>e.icon},getColor:{type:"accessor",value:g0},getSize:{type:"accessor",value:1},getAngle:{type:"accessor",value:0},getPixelOffset:{type:"accessor",value:[0,0]},onIconError:{type:"function",value:null,optional:!0},textureParameters:{type:"object",ignore:!0,value:null}};class y0 extends mD{getShaders(){return super.getShaders({vs:"#version 300 es\n#define SHADER_NAME icon-layer-vertex-shader\nin vec2 positions;\nin vec3 instancePositions;\nin vec3 instancePositions64Low;\nin float instanceSizes;\nin float instanceAngles;\nin vec4 instanceColors;\nin vec3 instancePickingColors;\nin vec4 instanceIconFrames;\nin float instanceColorModes;\nin vec2 instanceOffsets;\nin vec2 instancePixelOffset;\nout float vColorMode;\nout vec4 vColor;\nout vec2 vTextureCoords;\nout vec2 uv;\nvec2 rotate_by_angle(vec2 vertex, float angle) {\nfloat angle_radian = angle * PI / 180.0;\nfloat cos_angle = cos(angle_radian);\nfloat sin_angle = sin(angle_radian);\nmat2 rotationMatrix = mat2(cos_angle, -sin_angle, sin_angle, cos_angle);\nreturn rotationMatrix * vertex;\n}\nvoid main(void) {\ngeometry.worldPosition = instancePositions;\ngeometry.uv = positions;\ngeometry.pickingColor = instancePickingColors;\nuv = positions;\nvec2 iconSize = instanceIconFrames.zw;\nfloat sizePixels = clamp(\nproject_size_to_pixel(instanceSizes * icon.sizeScale, icon.sizeUnits),\nicon.sizeMinPixels, icon.sizeMaxPixels\n);\nfloat instanceScale = iconSize.y == 0.0 ? 0.0 : sizePixels / iconSize.y;\nvec2 pixelOffset = positions / 2.0 * iconSize + instanceOffsets;\npixelOffset = rotate_by_angle(pixelOffset, instanceAngles) * instanceScale;\npixelOffset += instancePixelOffset;\npixelOffset.y *= -1.0;\nif (icon.billboard)  {\ngl_Position = project_position_to_clipspace(instancePositions, instancePositions64Low, vec3(0.0), geometry.position);\nDECKGL_FILTER_GL_POSITION(gl_Position, geometry);\nvec3 offset = vec3(pixelOffset, 0.0);\nDECKGL_FILTER_SIZE(offset, geometry);\ngl_Position.xy += project_pixel_size_to_clipspace(offset.xy);\n} else {\nvec3 offset_common = vec3(project_pixel_size(pixelOffset), 0.0);\nDECKGL_FILTER_SIZE(offset_common, geometry);\ngl_Position = project_position_to_clipspace(instancePositions, instancePositions64Low, offset_common, geometry.position);\nDECKGL_FILTER_GL_POSITION(gl_Position, geometry);\n}\nvTextureCoords = mix(\ninstanceIconFrames.xy,\ninstanceIconFrames.xy + iconSize,\n(positions.xy + 1.0) / 2.0\n) / icon.iconsTextureDim;\nvColor = instanceColors;\nDECKGL_FILTER_COLOR(vColor, geometry);\nvColorMode = instanceColorModes;\n}\n",fs:"#version 300 es\n#define SHADER_NAME icon-layer-fragment-shader\nprecision highp float;\nuniform sampler2D iconsTexture;\nin float vColorMode;\nin vec4 vColor;\nin vec2 vTextureCoords;\nin vec2 uv;\nout vec4 fragColor;\nvoid main(void) {\ngeometry.uv = uv;\nvec4 texColor = texture(iconsTexture, vTextureCoords);\nvec3 color = mix(texColor.rgb, vColor.rgb, vColorMode);\nfloat a = texColor.a * layer.opacity * vColor.a;\nif (a < icon.alphaCutoff) {\ndiscard;\n}\nfragColor = vec4(color, a);\nDECKGL_FILTER_COLOR(fragColor, geometry);\n}\n",modules:[$T,IP,l0]})}initializeState(){this.state={iconManager:new f0(this.context.device,{onUpdate:this._onUpdate.bind(this),onError:this._onError.bind(this)})};this.getAttributeManager().addInstanced({instancePositions:{size:3,type:"float64",fp64:this.use64bitPositions(),transition:!0,accessor:"getPosition"},instanceSizes:{size:1,transition:!0,accessor:"getSize",defaultValue:1},instanceOffsets:{size:2,accessor:"getIcon",transform:this.getInstanceOffset},instanceIconFrames:{size:4,accessor:"getIcon",transform:this.getInstanceIconFrame},instanceColorModes:{size:1,type:"uint8",accessor:"getIcon",transform:this.getInstanceColorMode},instanceColors:{size:this.props.colorFormat.length,type:"unorm8",transition:!0,accessor:"getColor",defaultValue:g0},instanceAngles:{size:1,transition:!0,accessor:"getAngle"},instancePixelOffset:{size:2,transition:!0,accessor:"getPixelOffset"}})}updateState(e){super.updateState(e);const{props:t,oldProps:n,changeFlags:r}=e,o=this.getAttributeManager(),{iconAtlas:i,iconMapping:s,data:a,getIcon:l,textureParameters:c}=t,{iconManager:u}=this.state;if("string"==typeof i)return;const d=i||this.internalState.isAsyncPropLoading("iconAtlas");u.setProps({loadOptions:t.loadOptions,autoPacking:!d,iconAtlas:i,iconMapping:d?s:null,textureParameters:c}),d?n.iconMapping!==t.iconMapping&&o.invalidate("getIcon"):(r.dataChanged||r.updateTriggersChanged&&(r.updateTriggersChanged.all||r.updateTriggersChanged.getIcon))&&u.packIcons(a,l),r.extensionsChanged&&(this.state.model?.destroy(),this.state.model=this._getModel(),o.invalidateAll())}get isLoaded(){return super.isLoaded&&this.state.iconManager.isLoaded}finalizeState(e){super.finalizeState(e),this.state.iconManager.finalize()}draw({uniforms:e}){const{sizeScale:t,sizeMinPixels:n,sizeMaxPixels:r,sizeUnits:o,billboard:i,alphaCutoff:s}=this.props,{iconManager:a}=this.state,l=a.getTexture();if(l){const e=this.state.model,a={iconsTexture:l,iconsTextureDim:[l.width,l.height],sizeUnits:RT[o],sizeScale:t,sizeMinPixels:n,sizeMaxPixels:r,billboard:i,alphaCutoff:s};e.shaderInputs.setProps({icon:a}),e.draw(this.context.renderPass)}}_getModel(){return new LF(this.context.device,{...this.getShaders(),id:this.props.id,bufferLayout:this.getAttributeManager().getBufferLayouts(),geometry:new NF({topology:"triangle-strip",attributes:{positions:{size:2,value:new Float32Array([-1,-1,1,-1,-1,1,1,1])}}}),isInstanced:!0})}_onUpdate(){this.setNeedsRedraw()}_onError(e){const t=this.getCurrentLayer()?.props.onIconError;t?t(e):AC.error(e.error.message)()}getInstanceOffset(e){const{width:t,height:n,anchorX:r=t/2,anchorY:o=n/2}=this.state.iconManager.getIconMapping(e);return[t/2-r,n/2-o]}getInstanceColorMode(e){return this.state.iconManager.getIconMapping(e).mask?1:0}getInstanceIconFrame(e){const{x:t,y:n,width:r,height:o}=this.state.iconManager.getIconMapping(e);return[t,n,r,o]}}y0.defaultProps=m0,y0.layerName="IconLayer";const v0="uniform scatterplotUniforms {\n  float radiusScale;\n  float radiusMinPixels;\n  float radiusMaxPixels;\n  float lineWidthScale;\n  float lineWidthMinPixels;\n  float lineWidthMaxPixels;\n  float stroked;\n  float filled;\n  bool antialiasing;\n  bool billboard;\n  highp int radiusUnits;\n  highp int lineWidthUnits;\n} scatterplot;\n",b0={name:"scatterplot",vs:v0,fs:v0,source:"",uniformTypes:{radiusScale:"f32",radiusMinPixels:"f32",radiusMaxPixels:"f32",lineWidthScale:"f32",lineWidthMinPixels:"f32",lineWidthMaxPixels:"f32",stroked:"f32",filled:"f32",antialiasing:"f32",billboard:"f32",radiusUnits:"i32",lineWidthUnits:"i32"}},w0=[0,0,0,255],x0={radiusUnits:"meters",radiusScale:{type:"number",min:0,value:1},radiusMinPixels:{type:"number",min:0,value:0},radiusMaxPixels:{type:"number",min:0,value:Number.MAX_SAFE_INTEGER},lineWidthUnits:"meters",lineWidthScale:{type:"number",min:0,value:1},lineWidthMinPixels:{type:"number",min:0,value:0},lineWidthMaxPixels:{type:"number",min:0,value:Number.MAX_SAFE_INTEGER},stroked:!1,filled:!0,billboard:!1,antialiasing:!0,getPosition:{type:"accessor",value:e=>e.position},getRadius:{type:"accessor",value:1},getFillColor:{type:"accessor",value:w0},getLineColor:{type:"accessor",value:w0},getLineWidth:{type:"accessor",value:1},strokeWidth:{deprecatedFor:"getLineWidth"},outline:{deprecatedFor:"stroked"},getColor:{deprecatedFor:["getFillColor","getLineColor"]}};class _0 extends mD{getShaders(){return super.getShaders({vs:"#version 300 es\n#define SHADER_NAME scatterplot-layer-vertex-shader\nin vec3 positions;\nin vec3 instancePositions;\nin vec3 instancePositions64Low;\nin float instanceRadius;\nin float instanceLineWidths;\nin vec4 instanceFillColors;\nin vec4 instanceLineColors;\nin vec3 instancePickingColors;\nout vec4 vFillColor;\nout vec4 vLineColor;\nout vec2 unitPosition;\nout float innerUnitRadius;\nout float outerRadiusPixels;\nvoid main(void) {\ngeometry.worldPosition = instancePositions;\nouterRadiusPixels = clamp(\nproject_size_to_pixel(scatterplot.radiusScale * instanceRadius, scatterplot.radiusUnits),\nscatterplot.radiusMinPixels, scatterplot.radiusMaxPixels\n);\nfloat lineWidthPixels = clamp(\nproject_size_to_pixel(scatterplot.lineWidthScale * instanceLineWidths, scatterplot.lineWidthUnits),\nscatterplot.lineWidthMinPixels, scatterplot.lineWidthMaxPixels\n);\nouterRadiusPixels += scatterplot.stroked * lineWidthPixels / 2.0;\nfloat edgePadding = scatterplot.antialiasing ? (outerRadiusPixels + SMOOTH_EDGE_RADIUS) / outerRadiusPixels : 1.0;\nunitPosition = edgePadding * positions.xy;\ngeometry.uv = unitPosition;\ngeometry.pickingColor = instancePickingColors;\ninnerUnitRadius = 1.0 - scatterplot.stroked * lineWidthPixels / outerRadiusPixels;\nif (scatterplot.billboard) {\ngl_Position = project_position_to_clipspace(instancePositions, instancePositions64Low, vec3(0.0), geometry.position);\nDECKGL_FILTER_GL_POSITION(gl_Position, geometry);\nvec3 offset = edgePadding * positions * outerRadiusPixels;\nDECKGL_FILTER_SIZE(offset, geometry);\ngl_Position.xy += project_pixel_size_to_clipspace(offset.xy);\n} else {\nvec3 offset = edgePadding * positions * project_pixel_size(outerRadiusPixels);\nDECKGL_FILTER_SIZE(offset, geometry);\ngl_Position = project_position_to_clipspace(instancePositions, instancePositions64Low, offset, geometry.position);\nDECKGL_FILTER_GL_POSITION(gl_Position, geometry);\n}\nvFillColor = vec4(instanceFillColors.rgb, instanceFillColors.a * layer.opacity);\nDECKGL_FILTER_COLOR(vFillColor, geometry);\nvLineColor = vec4(instanceLineColors.rgb, instanceLineColors.a * layer.opacity);\nDECKGL_FILTER_COLOR(vLineColor, geometry);\n}\n",fs:"#version 300 es\n#define SHADER_NAME scatterplot-layer-fragment-shader\nprecision highp float;\nin vec4 vFillColor;\nin vec4 vLineColor;\nin vec2 unitPosition;\nin float innerUnitRadius;\nin float outerRadiusPixels;\nout vec4 fragColor;\nvoid main(void) {\ngeometry.uv = unitPosition;\nfloat distToCenter = length(unitPosition) * outerRadiusPixels;\nfloat inCircle = scatterplot.antialiasing ?\nsmoothedge(distToCenter, outerRadiusPixels) :\nstep(distToCenter, outerRadiusPixels);\nif (inCircle == 0.0) {\ndiscard;\n}\nif (scatterplot.stroked > 0.5) {\nfloat isLine = scatterplot.antialiasing ?\nsmoothedge(innerUnitRadius * outerRadiusPixels, distToCenter) :\nstep(innerUnitRadius * outerRadiusPixels, distToCenter);\nif (scatterplot.filled > 0.5) {\nfragColor = mix(vFillColor, vLineColor, isLine);\n} else {\nif (isLine == 0.0) {\ndiscard;\n}\nfragColor = vec4(vLineColor.rgb, vLineColor.a * isLine);\n}\n} else if (scatterplot.filled < 0.5) {\ndiscard;\n} else {\nfragColor = vFillColor;\n}\nfragColor.a *= inCircle;\nDECKGL_FILTER_COLOR(fragColor, geometry);\n}\n",source:'// TODO(ibgreen): Hack for Layer uniforms (move to new "color" module?)\n\nstruct LayerUniforms {\n  opacity: f32,\n};\n\nvar<private> layer: LayerUniforms = LayerUniforms(1.0);\n// @group(0) @binding(1) var<uniform> layer: LayerUniforms;\n\n// Main shaders\n\nstruct ScatterplotUniforms {\n  radiusScale: f32,\n  radiusMinPixels: f32,\n  radiusMaxPixels: f32,\n  lineWidthScale: f32,\n  lineWidthMinPixels: f32,\n  lineWidthMaxPixels: f32,\n  stroked: f32,\n  filled: i32,\n  antialiasing: i32,\n  billboard: i32,\n  radiusUnits: i32,\n  lineWidthUnits: i32,\n};\n\nstruct ConstantAttributeUniforms {\n instancePositions: vec3<f32>,\n instancePositions64Low: vec3<f32>,\n instanceRadius: f32,\n instanceLineWidths: f32,\n instanceFillColors: vec4<f32>,\n instanceLineColors: vec4<f32>,\n instancePickingColors: vec3<f32>,\n\n instancePositionsConstant: i32,\n instancePositions64LowConstant: i32,\n instanceRadiusConstant: i32,\n instanceLineWidthsConstant: i32,\n instanceFillColorsConstant: i32,\n instanceLineColorsConstant: i32,\n instancePickingColorsConstant: i32\n};\n\n@group(0) @binding(2) var<uniform> scatterplot: ScatterplotUniforms;\n\nstruct ConstantAttributes {\n  instancePositions: vec3<f32>,\n  instancePositions64Low: vec3<f32>,\n  instanceRadius: f32,\n  instanceLineWidths: f32,\n  instanceFillColors: vec4<f32>,\n  instanceLineColors: vec4<f32>,\n  instancePickingColors: vec3<f32>\n};\n\nconst constants = ConstantAttributes(\n  vec3<f32>(0.0),\n  vec3<f32>(0.0),\n  0.0,\n  0.0,\n  vec4<f32>(0.0, 0.0, 0.0, 1.0),\n  vec4<f32>(0.0, 0.0, 0.0, 1.0),\n  vec3<f32>(0.0)\n);\n\nstruct Attributes {\n  @builtin(instance_index) instanceIndex : u32,\n  @builtin(vertex_index) vertexIndex : u32,\n  @location(0) positions: vec3<f32>,\n  @location(1) instancePositions: vec3<f32>,\n  @location(2) instancePositions64Low: vec3<f32>,\n  @location(3) instanceRadius: f32,\n  @location(4) instanceLineWidths: f32,\n  @location(5) instanceFillColors: vec4<f32>,\n  @location(6) instanceLineColors: vec4<f32>,\n  @location(7) instancePickingColors: vec3<f32>\n};\n\nstruct Varyings {\n  @builtin(position) position: vec4<f32>,\n  @location(0) vFillColor: vec4<f32>,\n  @location(1) vLineColor: vec4<f32>,\n  @location(2) unitPosition: vec2<f32>,\n  @location(3) innerUnitRadius: f32,\n  @location(4) outerRadiusPixels: f32,\n};\n\n@vertex\nfn vertexMain(attributes: Attributes) -> Varyings {\n  var varyings: Varyings;\n\n  // Draw an inline geometry constant array clip space triangle to verify that rendering works.\n  // var positions = array<vec2<f32>, 3>(vec2(0.0, 0.5), vec2(-0.5, -0.5), vec2(0.5, -0.5));\n  // if (attributes.instanceIndex == 0) {\n  //   varyings.position = vec4<f32>(positions[attributes.vertexIndex], 0.0, 1.0);\n  //   return varyings;\n  // }\n\n  // var geometry: Geometry;\n  // geometry.worldPosition = instancePositions;\n\n  // Multiply out radius and clamp to limits\n  varyings.outerRadiusPixels = clamp(\n    project_unit_size_to_pixel(scatterplot.radiusScale * attributes.instanceRadius, scatterplot.radiusUnits),\n    scatterplot.radiusMinPixels, scatterplot.radiusMaxPixels\n  );\n\n  // Multiply out line width and clamp to limits\n  let lineWidthPixels = clamp(\n    project_unit_size_to_pixel(scatterplot.lineWidthScale * attributes.instanceLineWidths, scatterplot.lineWidthUnits),\n    scatterplot.lineWidthMinPixels, scatterplot.lineWidthMaxPixels\n  );\n\n  // outer radius needs to offset by half stroke width\n  varyings.outerRadiusPixels += scatterplot.stroked * lineWidthPixels / 2.0;\n  // Expand geometry to accommodate edge smoothing\n  let edgePadding = select(\n    (varyings.outerRadiusPixels + SMOOTH_EDGE_RADIUS) / varyings.outerRadiusPixels,\n    1.0,\n    scatterplot.antialiasing != 0\n  );\n\n  // position on the containing square in [-1, 1] space\n  varyings.unitPosition = edgePadding * attributes.positions.xy;\n  geometry.uv = varyings.unitPosition;\n  geometry.pickingColor = attributes.instancePickingColors;\n\n  varyings.innerUnitRadius = 1.0 - scatterplot.stroked * lineWidthPixels / varyings.outerRadiusPixels;\n\n  if (scatterplot.billboard != 0) {\n    varyings.position = project_position_to_clipspace(attributes.instancePositions, attributes.instancePositions64Low, vec3<f32>(0.0)); // TODO , geometry.position);\n    // DECKGL_FILTER_GL_POSITION(varyings.position, geometry);\n    let offset = attributes.positions; // * edgePadding * varyings.outerRadiusPixels;\n    // DECKGL_FILTER_SIZE(offset, geometry);\n    let clipPixels = project_pixel_size_to_clipspace(offset.xy);\n    varyings.position.x = clipPixels.x;\n    varyings.position.y = clipPixels.y;\n  } else {\n    let offset = edgePadding * attributes.positions * project_pixel_size_float(varyings.outerRadiusPixels);\n    // DECKGL_FILTER_SIZE(offset, geometry);\n    varyings.position = project_position_to_clipspace(attributes.instancePositions, attributes.instancePositions64Low, offset); // TODO , geometry.position);\n    // DECKGL_FILTER_GL_POSITION(varyings.position, geometry);\n  }\n\n  // Apply opacity to instance color, or return instance picking color\n  varyings.vFillColor = vec4<f32>(attributes.instanceFillColors.rgb, attributes.instanceFillColors.a * layer.opacity);\n  // DECKGL_FILTER_COLOR(varyings.vFillColor, geometry);\n  varyings.vLineColor = vec4<f32>(attributes.instanceLineColors.rgb, attributes.instanceLineColors.a * layer.opacity);\n  // DECKGL_FILTER_COLOR(varyings.vLineColor, geometry);\n\n  return varyings;\n}\n\n@fragment\nfn fragmentMain(varyings: Varyings) -> @location(0) vec4<f32> {\n  // var geometry: Geometry;\n  // geometry.uv = unitPosition;\n\n  let distToCenter = length(varyings.unitPosition) * varyings.outerRadiusPixels;\n  let inCircle = select(\n    smoothedge(distToCenter, varyings.outerRadiusPixels),\n    step(distToCenter, varyings.outerRadiusPixels),\n    scatterplot.antialiasing != 0\n  );\n\n  if (inCircle == 0.0) {\n    // discard;\n  }\n\n  var fragColor: vec4<f32>;\n\n  if (scatterplot.stroked != 0) {\n    let isLine = select(\n      smoothedge(varyings.innerUnitRadius * varyings.outerRadiusPixels, distToCenter),\n      step(varyings.innerUnitRadius * varyings.outerRadiusPixels, distToCenter),\n      scatterplot.antialiasing != 0\n    );\n\n    if (scatterplot.filled != 0) {\n      fragColor = mix(varyings.vFillColor, varyings.vLineColor, isLine);\n    } else {\n      if (isLine == 0.0) {\n        // discard;\n      }\n      fragColor = vec4<f32>(varyings.vLineColor.rgb, varyings.vLineColor.a * isLine);\n    }\n  } else if (scatterplot.filled == 0) {\n    // discard;\n  } else {\n    fragColor = varyings.vFillColor;\n  }\n\n  fragColor.a *= inCircle;\n  // DECKGL_FILTER_COLOR(fragColor, geometry);\n\n  return fragColor;\n  // return vec4<f32>(0, 0, 1, 1);\n}\n',modules:[$T,IP,b0]})}initializeState(){this.getAttributeManager().addInstanced({instancePositions:{size:3,type:"float64",fp64:this.use64bitPositions(),transition:!0,accessor:"getPosition"},instanceRadius:{size:1,transition:!0,accessor:"getRadius",defaultValue:1},instanceFillColors:{size:this.props.colorFormat.length,transition:!0,type:"unorm8",accessor:"getFillColor",defaultValue:[0,0,0,255]},instanceLineColors:{size:this.props.colorFormat.length,transition:!0,type:"unorm8",accessor:"getLineColor",defaultValue:[0,0,0,255]},instanceLineWidths:{size:1,transition:!0,accessor:"getLineWidth",defaultValue:1}})}updateState(e){super.updateState(e),e.changeFlags.extensionsChanged&&(this.state.model?.destroy(),this.state.model=this._getModel(),this.getAttributeManager().invalidateAll())}draw({uniforms:e}){const{radiusUnits:t,radiusScale:n,radiusMinPixels:r,radiusMaxPixels:o,stroked:i,filled:s,billboard:a,antialiasing:l,lineWidthUnits:c,lineWidthScale:u,lineWidthMinPixels:d,lineWidthMaxPixels:A}=this.props,h={stroked:i,filled:s,billboard:a,antialiasing:l,radiusUnits:RT[t],radiusScale:n,radiusMinPixels:r,radiusMaxPixels:o,lineWidthUnits:RT[c],lineWidthScale:u,lineWidthMinPixels:d,lineWidthMaxPixels:A},p=this.state.model;p.shaderInputs.setProps({scatterplot:h}),p.draw(this.context.renderPass)}_getModel(){return new LF(this.context.device,{...this.getShaders(),id:this.props.id,bufferLayout:this.getAttributeManager().getBufferLayouts(),geometry:new NF({topology:"triangle-strip",attributes:{positions:{size:3,value:new Float32Array([-1,-1,0,1,-1,0,-1,1,0,1,1,0])}}}),isInstanced:!0})}}_0.defaultProps=x0,_0.layerName="ScatterplotLayer";const C0=1,S0=-1;function E0(e,t,n={}){const r=function(e,t={}){return Math.sign(function(e,t={}){const{start:n=0,end:r=e.length,plane:o="xy"}=t,i=t.size||2;let s=0;const a=B0[o[0]],l=B0[o[1]];for(let c=n,u=r-i;c<r;c+=i)s+=(e[c+a]-e[u+a])*(e[c+l]+e[u+l]),u=c;return s/2}(e,t))}(e,n);return r!==t&&(function(e,t){const{start:n=0,end:r=e.length,size:o=2}=t,i=(r-n)/o,s=Math.floor(i/2);for(let a=0;a<s;++a){const t=n+a*o,r=n+(i-1-a)*o;for(let n=0;n<o;++n){const o=e[t+n];e[t+n]=e[r+n],e[r+n]=o}}}(e,n),!0)}const B0={x:0,y:1,z:2};function I0(e,t){const n=t.length,r=e.length;if(r>0){let o=!0;for(let i=0;i<n;i++)if(e[r-n+i]!==t[i]){o=!1;break}if(o)return!1}for(let o=0;o<n;o++)e[r+o]=t[o];return!0}function R0(e,t){const n=t.length;for(let r=0;r<n;r++)e[r]=t[r]}function k0(e,t,n,r,o=[]){const i=r+t*n;for(let s=0;s<n;s++)o[s]=e[i+s];return o}function T0(e,t,n,r,o=[]){let i,s;if(8&n)i=(r[3]-e[1])/(t[1]-e[1]),s=3;else if(4&n)i=(r[1]-e[1])/(t[1]-e[1]),s=1;else if(2&n)i=(r[2]-e[0])/(t[0]-e[0]),s=2;else{if(!(1&n))return null;i=(r[0]-e[0])/(t[0]-e[0]),s=0}for(let a=0;a<e.length;a++)o[a]=(1&s)===a?r[s]:i*(t[a]-e[a])+e[a];return o}function P0(e,t){let n=0;return e[0]<t[0]?n|=1:e[0]>t[2]&&(n|=2),e[1]<t[1]?n|=4:e[1]>t[3]&&(n|=8),n}function F0(e,t){const{size:n=2,broken:r=!1,gridResolution:o=10,gridOffset:i=[0,0],startIndex:s=0,endIndex:a=e.length}=t||{},l=(a-s)/n;let c=[];const u=[c],d=k0(e,0,n,s);let A,h;const p=U0(d,o,i,[]),f=[];I0(c,d);for(let g=1;g<l;g++){for(A=k0(e,g,n,s,A),h=P0(A,p);h;){T0(d,A,h,p,f);const e=P0(f,p);e&&(T0(d,f,e,p,f),h=e),I0(c,f),R0(d,f),O0(p,o,h),r&&c.length>n&&(c=[],u.push(c),I0(c,d)),h=P0(A,p)}I0(c,A),R0(d,A)}return r?u:u[0]}function M0(e,t=null,n){if(!e.length)return[];const{size:r=2,gridResolution:o=10,gridOffset:i=[0,0],edgeTypes:s=!1}=n||{},a=[],l=[{pos:e,types:s?new Array(e.length/r).fill(1):null,holes:t||[]}],c=[[],[]];let u=[];for(;l.length;){const{pos:e,types:t,holes:n}=l.shift();D0(e,r,n[0]||e.length,c),u=U0(c[0],o,i,u);const d=P0(c[1],u);if(d){let o=L0(e,t,r,0,n[0]||e.length,u,d);const i={pos:o[0].pos,types:o[0].types,holes:[]},a={pos:o[1].pos,types:o[1].types,holes:[]};l.push(i,a);for(let l=0;l<n.length;l++)o=L0(e,t,r,n[l],n[l+1]||e.length,u,d),o[0]&&(i.holes.push(i.pos.length),i.pos=N0(i.pos,o[0].pos),s&&(i.types=N0(i.types,o[0].types))),o[1]&&(a.holes.push(a.pos.length),a.pos=N0(a.pos,o[1].pos),s&&(a.types=N0(a.types,o[1].types)))}else{const r={positions:e};s&&(r.edgeTypes=t),n.length&&(r.holeIndices=n),a.push(r)}}return a}function L0(e,t,n,r,o,i,s){const a=(o-r)/n,l=[],c=[],u=[],d=[],A=[];let h,p,f;const g=k0(e,a-1,n,r);let m=Math.sign(8&s?g[1]-i[3]:g[0]-i[2]),y=t&&t[a-1],v=0,b=0;for(let w=0;w<a;w++)h=k0(e,w,n,r,h),p=Math.sign(8&s?h[1]-i[3]:h[0]-i[2]),f=t&&t[r/n+w],p&&m&&m!==p&&(T0(g,h,s,i,A),I0(l,A)&&u.push(y),I0(c,A)&&d.push(y)),p<=0?(I0(l,h)&&u.push(f),v-=p):u.length&&(u[u.length-1]=0),p>=0?(I0(c,h)&&d.push(f),b+=p):d.length&&(d[d.length-1]=0),R0(g,h),m=p,y=f;return[v?{pos:l,types:t&&u}:null,b?{pos:c,types:t&&d}:null]}function U0(e,t,n,r){const o=Math.floor((e[0]-n[0])/t)*t+n[0],i=Math.floor((e[1]-n[1])/t)*t+n[1];return r[0]=o,r[1]=i,r[2]=o+t,r[3]=i+t,r}function O0(e,t,n){8&n?(e[1]+=t,e[3]+=t):4&n?(e[1]-=t,e[3]-=t):2&n?(e[0]+=t,e[2]+=t):1&n&&(e[0]-=t,e[2]-=t)}function D0(e,t,n,r){let o=1/0,i=-1/0,s=1/0,a=-1/0;for(let l=0;l<n;l+=t){const t=e[l],n=e[l+1];o=t<o?t:o,i=t>i?t:i,s=n<s?n:s,a=n>a?n:a}return r[0][0]=o,r[0][1]=s,r[1][0]=i,r[1][1]=a,r}function N0(e,t){for(let n=0;n<t.length;n++)e.push(t[n]);return e}function j0(e,t,n,r){let o=-1,i=-1;for(let s=n+1;s<r;s+=t){const t=Math.abs(e[s]);t>o&&(o=t,i=s-1)}return i}function Q0(e,t,n,r,o=85.051129){const i=e[n],s=e[r-t];if(Math.abs(i-s)>180){const r=k0(e,0,t,n);r[0]+=360*Math.round((s-i)/360),I0(e,r),r[1]=Math.sign(r[1])*o,I0(e,r),r[0]=i,I0(e,r)}}function z0(e,t,n,r){let o,i=e[0];for(let s=n;s<r;s+=t){o=e[s];const t=o-i;(t>180||t<-180)&&(o-=360*Math.round(t/360)),e[s]=i=o}}function H0(e,t){let n;const r=e.length/t;for(let i=0;i<r&&(n=e[i*t],(n+180)%360==0);i++);const o=360*-Math.round(n/360);if(0!==o)for(let i=0;i<r;i++)e[i*t]+=o}function G0(e,t,n,r){let o;if(Array.isArray(e[0])){const n=e.length*t;o=new Array(n);for(let r=0;r<e.length;r++)for(let n=0;n<t;n++)o[r*t+n]=e[r][n]||0}else o=e;return n?F0(o,{size:t,gridResolution:n}):r?function(e,t){const{size:n=2,startIndex:r=0,endIndex:o=e.length,normalize:i=!0}=t||{},s=e.slice(r,o);z0(s,n,0,o-r);const a=F0(s,{size:n,broken:!0,gridResolution:360,gridOffset:[-180,-180]});if(i)for(const l of a)H0(l,n);return a}(o,{size:t}):o}class V0 extends BD{constructor(e){super({...e,attributes:{positions:{size:3,padding:18,initialize:!0,type:e.fp64?Float64Array:Float32Array},segmentTypes:{size:1,type:Uint8ClampedArray}}})}get(e){return this.attributes[e]}getGeometryFromBuffer(e){return this.normalize?super.getGeometryFromBuffer(e):null}normalizeGeometry(e){return this.normalize?G0(e,this.positionSize,this.opts.resolution,this.opts.wrapLongitude):e}getGeometrySize(e){if(W0(e)){let t=0;for(const n of e)t+=this.getGeometrySize(n);return t}const t=this.getPathLength(e);return t<2?0:this.isClosed(e)?t<3?0:t+2:t}updateGeometryAttributes(e,t){if(0!==t.geometrySize)if(e&&W0(e))for(const n of e){const e=this.getGeometrySize(n);t.geometrySize=e,this.updateGeometryAttributes(n,t),t.vertexStart+=e}else this._updateSegmentTypes(e,t),this._updatePositions(e,t)}_updateSegmentTypes(e,t){const n=this.attributes.segmentTypes,r=!!e&&this.isClosed(e),{vertexStart:o,geometrySize:i}=t;n.fill(0,o,o+i),r?(n[o]=4,n[o+i-2]=4):(n[o]+=1,n[o+i-2]+=2),n[o+i-1]=4}_updatePositions(e,t){const{positions:n}=this.attributes;if(!n||!e)return;const{vertexStart:r,geometrySize:o}=t,i=new Array(3);for(let s=r,a=0;a<o;s++,a++)this.getPointOnPath(e,a,i),n[3*s]=i[0],n[3*s+1]=i[1],n[3*s+2]=i[2]}getPathLength(e){return e.length/this.positionSize}getPointOnPath(e,t,n=[]){const{positionSize:r}=this;t*r>=e.length&&(t+=1-e.length/r);const o=t*r;return n[0]=e[o],n[1]=e[o+1],n[2]=3===r&&e[o+2]||0,n}isClosed(e){if(!this.normalize)return Boolean(this.opts.loop);const{positionSize:t}=this,n=e.length-t;return e[0]===e[n]&&e[1]===e[n+1]&&(2===t||e[2]===e[n+2])}}function W0(e){return Array.isArray(e[0])}const $0="uniform pathUniforms {\n  float widthScale;\n  float widthMinPixels;\n  float widthMaxPixels;\n  float jointType;\n  float capType;\n  float miterLimit;\n  bool billboard;\n  highp int widthUnits;\n} path;\n",K0={name:"path",vs:$0,fs:$0,uniformTypes:{widthScale:"f32",widthMinPixels:"f32",widthMaxPixels:"f32",jointType:"f32",capType:"f32",miterLimit:"f32",billboard:"f32",widthUnits:"i32"}},X0=[0,0,0,255],Y0={widthUnits:"meters",widthScale:{type:"number",min:0,value:1},widthMinPixels:{type:"number",min:0,value:0},widthMaxPixels:{type:"number",min:0,value:Number.MAX_SAFE_INTEGER},jointRounded:!1,capRounded:!1,miterLimit:{type:"number",min:0,value:4},billboard:!1,_pathType:null,getPath:{type:"accessor",value:e=>e.path},getColor:{type:"accessor",value:X0},getWidth:{type:"accessor",value:1},rounded:{deprecatedFor:["jointRounded","capRounded"]}},q0={enter:(e,t)=>t.length?t.subarray(t.length-e.length):e};class J0 extends mD{getShaders(){return super.getShaders({vs:"#version 300 es\n#define SHADER_NAME path-layer-vertex-shader\nin vec2 positions;\nin float instanceTypes;\nin vec3 instanceStartPositions;\nin vec3 instanceEndPositions;\nin vec3 instanceLeftPositions;\nin vec3 instanceRightPositions;\nin vec3 instanceLeftPositions64Low;\nin vec3 instanceStartPositions64Low;\nin vec3 instanceEndPositions64Low;\nin vec3 instanceRightPositions64Low;\nin float instanceStrokeWidths;\nin vec4 instanceColors;\nin vec3 instancePickingColors;\nuniform float opacity;\nout vec4 vColor;\nout vec2 vCornerOffset;\nout float vMiterLength;\nout vec2 vPathPosition;\nout float vPathLength;\nout float vJointType;\nconst float EPSILON = 0.001;\nconst vec3 ZERO_OFFSET = vec3(0.0);\nfloat flipIfTrue(bool flag) {\nreturn -(float(flag) * 2. - 1.);\n}\nvec3 getLineJoinOffset(\nvec3 prevPoint, vec3 currPoint, vec3 nextPoint,\nvec2 width\n) {\nbool isEnd = positions.x > 0.0;\nfloat sideOfPath = positions.y;\nfloat isJoint = float(sideOfPath == 0.0);\nvec3 deltaA3 = (currPoint - prevPoint);\nvec3 deltaB3 = (nextPoint - currPoint);\nmat3 rotationMatrix;\nbool needsRotation = !path.billboard && project_needs_rotation(currPoint, rotationMatrix);\nif (needsRotation) {\ndeltaA3 = deltaA3 * rotationMatrix;\ndeltaB3 = deltaB3 * rotationMatrix;\n}\nvec2 deltaA = deltaA3.xy / width;\nvec2 deltaB = deltaB3.xy / width;\nfloat lenA = length(deltaA);\nfloat lenB = length(deltaB);\nvec2 dirA = lenA > 0. ? normalize(deltaA) : vec2(0.0, 0.0);\nvec2 dirB = lenB > 0. ? normalize(deltaB) : vec2(0.0, 0.0);\nvec2 perpA = vec2(-dirA.y, dirA.x);\nvec2 perpB = vec2(-dirB.y, dirB.x);\nvec2 tangent = dirA + dirB;\ntangent = length(tangent) > 0. ? normalize(tangent) : perpA;\nvec2 miterVec = vec2(-tangent.y, tangent.x);\nvec2 dir = isEnd ? dirA : dirB;\nvec2 perp = isEnd ? perpA : perpB;\nfloat L = isEnd ? lenA : lenB;\nfloat sinHalfA = abs(dot(miterVec, perp));\nfloat cosHalfA = abs(dot(dirA, miterVec));\nfloat turnDirection = flipIfTrue(dirA.x * dirB.y >= dirA.y * dirB.x);\nfloat cornerPosition = sideOfPath * turnDirection;\nfloat miterSize = 1.0 / max(sinHalfA, EPSILON);\nmiterSize = mix(\nmin(miterSize, max(lenA, lenB) / max(cosHalfA, EPSILON)),\nmiterSize,\nstep(0.0, cornerPosition)\n);\nvec2 offsetVec = mix(miterVec * miterSize, perp, step(0.5, cornerPosition))\n* (sideOfPath + isJoint * turnDirection);\nbool isStartCap = lenA == 0.0 || (!isEnd && (instanceTypes == 1.0 || instanceTypes == 3.0));\nbool isEndCap = lenB == 0.0 || (isEnd && (instanceTypes == 2.0 || instanceTypes == 3.0));\nbool isCap = isStartCap || isEndCap;\nif (isCap) {\noffsetVec = mix(perp * sideOfPath, dir * path.capType * 4.0 * flipIfTrue(isStartCap), isJoint);\nvJointType = path.capType;\n} else {\nvJointType = path.jointType;\n}\nvPathLength = L;\nvCornerOffset = offsetVec;\nvMiterLength = dot(vCornerOffset, miterVec * turnDirection);\nvMiterLength = isCap ? isJoint : vMiterLength;\nvec2 offsetFromStartOfPath = vCornerOffset + deltaA * float(isEnd);\nvPathPosition = vec2(\ndot(offsetFromStartOfPath, perp),\ndot(offsetFromStartOfPath, dir)\n);\ngeometry.uv = vPathPosition;\nfloat isValid = step(instanceTypes, 3.5);\nvec3 offset = vec3(offsetVec * width * isValid, 0.0);\nif (needsRotation) {\noffset = rotationMatrix * offset;\n}\nreturn offset;\n}\nvoid clipLine(inout vec4 position, vec4 refPosition) {\nif (position.w < EPSILON) {\nfloat r = (EPSILON - refPosition.w) / (position.w - refPosition.w);\nposition = refPosition + (position - refPosition) * r;\n}\n}\nvoid main() {\ngeometry.pickingColor = instancePickingColors;\nvColor = vec4(instanceColors.rgb, instanceColors.a * layer.opacity);\nfloat isEnd = positions.x;\nvec3 prevPosition = mix(instanceLeftPositions, instanceStartPositions, isEnd);\nvec3 prevPosition64Low = mix(instanceLeftPositions64Low, instanceStartPositions64Low, isEnd);\nvec3 currPosition = mix(instanceStartPositions, instanceEndPositions, isEnd);\nvec3 currPosition64Low = mix(instanceStartPositions64Low, instanceEndPositions64Low, isEnd);\nvec3 nextPosition = mix(instanceEndPositions, instanceRightPositions, isEnd);\nvec3 nextPosition64Low = mix(instanceEndPositions64Low, instanceRightPositions64Low, isEnd);\ngeometry.worldPosition = currPosition;\nvec2 widthPixels = vec2(clamp(\nproject_size_to_pixel(instanceStrokeWidths * path.widthScale, path.widthUnits),\npath.widthMinPixels, path.widthMaxPixels) / 2.0);\nvec3 width;\nif (path.billboard) {\nvec4 prevPositionScreen = project_position_to_clipspace(prevPosition, prevPosition64Low, ZERO_OFFSET);\nvec4 currPositionScreen = project_position_to_clipspace(currPosition, currPosition64Low, ZERO_OFFSET, geometry.position);\nvec4 nextPositionScreen = project_position_to_clipspace(nextPosition, nextPosition64Low, ZERO_OFFSET);\nclipLine(prevPositionScreen, currPositionScreen);\nclipLine(nextPositionScreen, currPositionScreen);\nclipLine(currPositionScreen, mix(nextPositionScreen, prevPositionScreen, isEnd));\nwidth = vec3(widthPixels, 0.0);\nDECKGL_FILTER_SIZE(width, geometry);\nvec3 offset = getLineJoinOffset(\nprevPositionScreen.xyz / prevPositionScreen.w,\ncurrPositionScreen.xyz / currPositionScreen.w,\nnextPositionScreen.xyz / nextPositionScreen.w,\nproject_pixel_size_to_clipspace(width.xy)\n);\nDECKGL_FILTER_GL_POSITION(currPositionScreen, geometry);\ngl_Position = vec4(currPositionScreen.xyz + offset * currPositionScreen.w, currPositionScreen.w);\n} else {\nprevPosition = project_position(prevPosition, prevPosition64Low);\ncurrPosition = project_position(currPosition, currPosition64Low);\nnextPosition = project_position(nextPosition, nextPosition64Low);\nwidth = vec3(project_pixel_size(widthPixels), 0.0);\nDECKGL_FILTER_SIZE(width, geometry);\nvec3 offset = getLineJoinOffset(prevPosition, currPosition, nextPosition, width.xy);\ngeometry.position = vec4(currPosition + offset, 1.0);\ngl_Position = project_common_position_to_clipspace(geometry.position);\nDECKGL_FILTER_GL_POSITION(gl_Position, geometry);\n}\nDECKGL_FILTER_COLOR(vColor, geometry);\n}\n",fs:"#version 300 es\n#define SHADER_NAME path-layer-fragment-shader\nprecision highp float;\nin vec4 vColor;\nin vec2 vCornerOffset;\nin float vMiterLength;\nin vec2 vPathPosition;\nin float vPathLength;\nin float vJointType;\nout vec4 fragColor;\nvoid main(void) {\ngeometry.uv = vPathPosition;\nif (vPathPosition.y < 0.0 || vPathPosition.y > vPathLength) {\nif (vJointType > 0.5 && length(vCornerOffset) > 1.0) {\ndiscard;\n}\nif (vJointType < 0.5 && vMiterLength > path.miterLimit + 1.0) {\ndiscard;\n}\n}\nfragColor = vColor;\nDECKGL_FILTER_COLOR(fragColor, geometry);\n}\n",modules:[$T,IP,K0]})}get wrapLongitude(){return!1}getBounds(){return this.getAttributeManager()?.getBounds(["vertexPositions"])}initializeState(){const e=!0;this.getAttributeManager().addInstanced({vertexPositions:{size:3,vertexOffset:1,type:"float64",fp64:this.use64bitPositions(),transition:q0,accessor:"getPath",update:this.calculatePositions,noAlloc:e,shaderAttributes:{instanceLeftPositions:{vertexOffset:0},instanceStartPositions:{vertexOffset:1},instanceEndPositions:{vertexOffset:2},instanceRightPositions:{vertexOffset:3}}},instanceTypes:{size:1,type:"uint8",update:this.calculateSegmentTypes,noAlloc:e},instanceStrokeWidths:{size:1,accessor:"getWidth",transition:q0,defaultValue:1},instanceColors:{size:this.props.colorFormat.length,type:"unorm8",accessor:"getColor",transition:q0,defaultValue:X0},instancePickingColors:{size:4,type:"uint8",accessor:(e,{index:t,target:n})=>this.encodePickingColor(e&&e.__source?e.__source.index:t,n)}}),this.setState({pathTesselator:new V0({fp64:this.use64bitPositions()})})}updateState(e){super.updateState(e);const{props:t,changeFlags:n}=e,r=this.getAttributeManager();if(n.dataChanged||n.updateTriggersChanged&&(n.updateTriggersChanged.all||n.updateTriggersChanged.getPath)){const{pathTesselator:e}=this.state,o=t.data.attributes||{};e.updateGeometry({data:t.data,geometryBuffer:o.getPath,buffers:o,normalize:!t._pathType,loop:"loop"===t._pathType,getGeometry:t.getPath,positionFormat:t.positionFormat,wrapLongitude:t.wrapLongitude,resolution:this.context.viewport.resolution,dataChanged:n.dataChanged}),this.setState({numInstances:e.instanceCount,startIndices:e.vertexStarts}),n.dataChanged||r.invalidateAll()}n.extensionsChanged&&(this.state.model?.destroy(),this.state.model=this._getModel(),r.invalidateAll())}getPickingInfo(e){const t=super.getPickingInfo(e),{index:n}=t,r=this.props.data;return r[0]&&r[0].__source&&(t.object=r.find(e=>e.__source.index===n)),t}disablePickingIndex(e){const t=this.props.data;if(t[0]&&t[0].__source)for(let n=0;n<t.length;n++)t[n].__source.index===e&&this._disablePickingIndex(n);else super.disablePickingIndex(e)}draw({uniforms:e}){const{jointRounded:t,capRounded:n,billboard:r,miterLimit:o,widthUnits:i,widthScale:s,widthMinPixels:a,widthMaxPixels:l}=this.props,c=this.state.model,u={jointType:Number(t),capType:Number(n),billboard:r,widthUnits:RT[i],widthScale:s,miterLimit:o,widthMinPixels:a,widthMaxPixels:l};c.shaderInputs.setProps({path:u}),c.draw(this.context.renderPass)}_getModel(){return new LF(this.context.device,{...this.getShaders(),id:this.props.id,bufferLayout:this.getAttributeManager().getBufferLayouts(),geometry:new NF({topology:"triangle-list",attributes:{indices:new Uint16Array([0,1,2,1,4,2,1,3,4,3,5,4]),positions:{value:new Float32Array([0,0,0,-1,0,1,1,-1,1,1,1,0]),size:2}}}),isInstanced:!0})}calculatePositions(e){const{pathTesselator:t}=this.state;e.startIndices=t.vertexStarts,e.value=t.get("positions")}calculateSegmentTypes(e){const{pathTesselator:t}=this.state;e.startIndices=t.vertexStarts,e.value=t.get("segmentTypes")}}J0.defaultProps=Y0,J0.layerName="PathLayer";const Z0=C0,e1=S0,t1={};function n1(e){return"positions"in e?e.positions:e}function r1(e){return"holeIndices"in e?e.holeIndices:null}function o1(e,t,n,r,o){let i=t;const s=n.length;for(let a=0;a<s;a++)for(let t=0;t<r;t++)e[i++]=n[a][t]||0;if(!function(e){const t=e[0],n=e[e.length-1];return t[0]===n[0]&&t[1]===n[1]&&t[2]===n[2]}(n))for(let a=0;a<r;a++)e[i++]=n[0][a]||0;return t1.start=t,t1.end=i,t1.size=r,E0(e,o,t1),i}function i1(e,t,n,r,o=0,i,s){const a=(i=i||n.length)-o;if(a<=0)return t;let l=t;for(let c=0;c<a;c++)e[l++]=n[o+c];if(!function(e,t,n,r){for(let o=0;o<t;o++)if(e[n+o]!==e[r-t+o])return!1;return!0}(n,r,o,i))for(let c=0;c<r;c++)e[l++]=n[o+c];return t1.start=t,t1.end=l,t1.size=r,E0(e,s,t1),l}function s1(e,t){!function(e){if(e=e&&e.positions||e,!Array.isArray(e)&&!ArrayBuffer.isView(e))throw new Error("invalid polygon")}(e);const n=[],r=[];if("positions"in e){const{positions:o,holeIndices:i}=e;if(i){let e=0;for(let s=0;s<=i.length;s++)e=i1(n,e,o,t,i[s-1],i[s],0===s?Z0:e1),r.push(e);return r.pop(),{positions:n,holeIndices:r}}e=o}if(!function(e){return Array.isArray(e[0])}(e))return i1(n,0,e,t,0,n.length,Z0),n;if(!function(e){return e.length>=1&&e[0].length>=2&&Number.isFinite(e[0][0])}(e)){let o=0;for(const[i,s]of e.entries())o=o1(n,o,s,t,0===i?Z0:e1),r.push(o);return r.pop(),{positions:n,holeIndices:r}}return o1(n,0,e,t,Z0),n}function a1(e,t,n){const r=e.length/3;let o=0;for(let i=0;i<r;i++){const s=(i+1)%r;o+=e[3*i+t]*e[3*s+n],o-=e[3*s+t]*e[3*i+n]}return Math.abs(o/2)}function l1(e,t,n,r){const o=e.length/3;for(let i=0;i<o;i++){const o=3*i,s=e[o+0],a=e[o+1],l=e[o+2];e[o+t]=s,e[o+n]=a,e[o+r]=l}}class c1 extends BD{constructor(e){const{fp64:t,IndexType:n=Uint32Array}=e;super({...e,attributes:{positions:{size:3,type:t?Float64Array:Float32Array},vertexValid:{type:Uint16Array,size:1},indices:{type:n,size:1}}})}get(e){const{attributes:t}=this;return"indices"===e?t.indices&&t.indices.subarray(0,this.vertexCount):t[e]}updateGeometry(e){super.updateGeometry(e);const t=this.buffers.indices;if(t)this.vertexCount=(t.value||t).length;else if(this.data&&!this.getGeometry)throw new Error("missing indices buffer")}normalizeGeometry(e){if(this.normalize){const t=s1(e,this.positionSize);return this.opts.resolution?M0(n1(t),r1(t),{size:this.positionSize,gridResolution:this.opts.resolution,edgeTypes:!0}):this.opts.wrapLongitude?function(e,t=null,n){const{size:r=2,normalize:o=!0,edgeTypes:i=!1}=n||{};t=t||[];const s=[],a=[];let l=0,c=0;for(let d=0;d<=t.length;d++){const o=t[d]||e.length,i=c,u=j0(e,r,l,o);for(let t=u;t<o;t++)s[c++]=e[t];for(let t=l;t<u;t++)s[c++]=e[t];z0(s,r,i,c),Q0(s,r,i,c,n?.maxLatitude),l=o,a[d]=c}a.pop();const u=M0(s,a,{size:r,gridResolution:360,gridOffset:[-180,-180],edgeTypes:i});if(o)for(const d of u)H0(d.positions,r);return u}(n1(t),r1(t),{size:this.positionSize,maxLatitude:86,edgeTypes:!0}):t}return e}getGeometrySize(e){if(u1(e)){let t=0;for(const n of e)t+=this.getGeometrySize(n);return t}return n1(e).length/this.positionSize}getGeometryFromBuffer(e){return this.normalize||!this.buffers.indices?super.getGeometryFromBuffer(e):null}updateGeometryAttributes(e,t){if(e&&u1(e))for(const n of e){const e=this.getGeometrySize(n);t.geometrySize=e,this.updateGeometryAttributes(n,t),t.vertexStart+=e,t.indexStart=this.indexStarts[t.geometryIndex+1]}else{const n=e;this._updateIndices(n,t),this._updatePositions(n,t),this._updateVertexValid(n,t)}}_updateIndices(e,{geometryIndex:t,vertexStart:n,indexStart:r}){const{attributes:o,indexStarts:i,typedArrayManager:s}=this;let a=o.indices;if(!a||!e)return;let l=r;const c=function(e,t,n,r){let o=r1(e);o&&(o=o.map(e=>e/t));let i=n1(e);const s=r&&3===t;if(n){const e=i.length;i=i.slice();const r=[];for(let o=0;o<e;o+=t){r[0]=i[o],r[1]=i[o+1],s&&(r[2]=i[o+2]);const e=n(r);i[o]=e[0],i[o+1]=e[1],s&&(i[o+2]=e[2])}}if(s){const e=a1(i,0,1),t=a1(i,0,2),r=a1(i,1,2);if(!e&&!t&&!r)return[];e>t&&e>r||(t>r?(n||(i=i.slice()),l1(i,0,2,1)):(n||(i=i.slice()),l1(i,2,0,1)))}return _w(i,o,t)}(e,this.positionSize,this.opts.preproject,this.opts.full3d);a=s.allocate(a,r+c.length,{copy:!0});for(let u=0;u<c.length;u++)a[l++]=c[u]+n;i[t+1]=r+c.length,o.indices=a}_updatePositions(e,{vertexStart:t,geometrySize:n}){const{attributes:{positions:r},positionSize:o}=this;if(!r||!e)return;const i=n1(e);for(let s=t,a=0;a<n;s++,a++){const e=i[a*o],t=i[a*o+1],n=o>2?i[a*o+2]:0;r[3*s]=e,r[3*s+1]=t,r[3*s+2]=n}}_updateVertexValid(e,{vertexStart:t,geometrySize:n}){const{positionSize:r}=this,o=this.attributes.vertexValid,i=e&&r1(e);if(e&&e.edgeTypes?o.set(e.edgeTypes,t):o.fill(1,t,t+n),i)for(let s=0;s<i.length;s++)o[t+i[s]/r-1]=0;o[t+n-1]=0}}function u1(e){return Array.isArray(e)&&e.length>0&&!Number.isFinite(e[0])}const d1="uniform solidPolygonUniforms {\n  bool extruded;\n  bool isWireframe;\n  float elevationScale;\n} solidPolygon;\n",A1={name:"solidPolygon",vs:d1,fs:d1,uniformTypes:{extruded:"f32",isWireframe:"f32",elevationScale:"f32"}},h1="in vec4 fillColors;\nin vec4 lineColors;\nin vec3 pickingColors;\nout vec4 vColor;\nstruct PolygonProps {\nvec3 positions;\nvec3 positions64Low;\nvec3 normal;\nfloat elevations;\n};\nvec3 project_offset_normal(vec3 vector) {\nif (project.coordinateSystem == COORDINATE_SYSTEM_LNGLAT ||\nproject.coordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSETS) {\nreturn normalize(vector * project.commonUnitsPerWorldUnit);\n}\nreturn project_normal(vector);\n}\nvoid calculatePosition(PolygonProps props) {\nvec3 pos = props.positions;\nvec3 pos64Low = props.positions64Low;\nvec3 normal = props.normal;\nvec4 colors = solidPolygon.isWireframe ? lineColors : fillColors;\ngeometry.worldPosition = props.positions;\ngeometry.pickingColor = pickingColors;\nif (solidPolygon.extruded) {\npos.z += props.elevations * solidPolygon.elevationScale;\n}\ngl_Position = project_position_to_clipspace(pos, pos64Low, vec3(0.), geometry.position);\nDECKGL_FILTER_GL_POSITION(gl_Position, geometry);\nif (solidPolygon.extruded) {\n#ifdef IS_SIDE_VERTEX\nnormal = project_offset_normal(normal);\n#else\nnormal = project_normal(normal);\n#endif\ngeometry.normal = normal;\nvec3 lightColor = lighting_getLightColor(colors.rgb, project.cameraPosition, geometry.position.xyz, geometry.normal);\nvColor = vec4(lightColor, colors.a * layer.opacity);\n} else {\nvColor = vec4(colors.rgb, colors.a * layer.opacity);\n}\nDECKGL_FILTER_COLOR(vColor, geometry);\n}\n",p1=`#version 300 es\n#define SHADER_NAME solid-polygon-layer-vertex-shader\nin vec3 vertexPositions;\nin vec3 vertexPositions64Low;\nin float elevations;\n${h1}\nvoid main(void) {\nPolygonProps props;\nprops.positions = vertexPositions;\nprops.positions64Low = vertexPositions64Low;\nprops.elevations = elevations;\nprops.normal = vec3(0.0, 0.0, 1.0);\ncalculatePosition(props);\n}\n`,f1=`#version 300 es\n#define SHADER_NAME solid-polygon-layer-vertex-shader-side\n#define IS_SIDE_VERTEX\nin vec2 positions;\nin vec3 vertexPositions;\nin vec3 nextVertexPositions;\nin vec3 vertexPositions64Low;\nin vec3 nextVertexPositions64Low;\nin float elevations;\nin float instanceVertexValid;\n${h1}\nvoid main(void) {\nif(instanceVertexValid < 0.5){\ngl_Position = vec4(0.);\nreturn;\n}\nPolygonProps props;\nvec3 pos;\nvec3 pos64Low;\nvec3 nextPos;\nvec3 nextPos64Low;\n#if RING_WINDING_ORDER_CW == 1\npos = vertexPositions;\npos64Low = vertexPositions64Low;\nnextPos = nextVertexPositions;\nnextPos64Low = nextVertexPositions64Low;\n#else\npos = nextVertexPositions;\npos64Low = nextVertexPositions64Low;\nnextPos = vertexPositions;\nnextPos64Low = vertexPositions64Low;\n#endif\nprops.positions = mix(pos, nextPos, positions.x);\nprops.positions64Low = mix(pos64Low, nextPos64Low, positions.x);\nprops.normal = vec3(\npos.y - nextPos.y + (pos64Low.y - nextPos64Low.y),\nnextPos.x - pos.x + (nextPos64Low.x - pos64Low.x),\n0.0);\nprops.elevations = elevations * positions.y;\ncalculatePosition(props);\n}\n`,g1=[0,0,0,255],m1={filled:!0,extruded:!1,wireframe:!1,_normalize:!0,_windingOrder:"CW",_full3d:!1,elevationScale:{type:"number",min:0,value:1},getPolygon:{type:"accessor",value:e=>e.polygon},getElevation:{type:"accessor",value:1e3},getFillColor:{type:"accessor",value:g1},getLineColor:{type:"accessor",value:g1},material:!0},y1={enter:(e,t)=>t.length?t.subarray(t.length-e.length):e};class v1 extends mD{getShaders(e){return super.getShaders({vs:"top"===e?p1:f1,fs:"#version 300 es\n#define SHADER_NAME solid-polygon-layer-fragment-shader\nprecision highp float;\nin vec4 vColor;\nout vec4 fragColor;\nvoid main(void) {\nfragColor = vColor;\ngeometry.uv = vec2(0.);\nDECKGL_FILTER_COLOR(fragColor, geometry);\n}\n",defines:{RING_WINDING_ORDER_CW:this.props._normalize||"CCW"!==this.props._windingOrder?1:0},modules:[$T,xk,IP,A1]})}get wrapLongitude(){return!1}getBounds(){return this.getAttributeManager()?.getBounds(["vertexPositions"])}initializeState(){const{viewport:e}=this.context;let{coordinateSystem:t}=this.props;const{_full3d:n}=this.props;let r;e.isGeospatial&&t===BT.DEFAULT&&(t=BT.LNGLAT),t===BT.LNGLAT&&(r=n?e.projectPosition.bind(e):e.projectFlat.bind(e)),this.setState({numInstances:0,polygonTesselator:new c1({preproject:r,fp64:this.use64bitPositions(),IndexType:Uint32Array})});const o=this.getAttributeManager(),i=!0;o.remove(["instancePickingColors"]),o.add({indices:{size:1,isIndexed:!0,update:this.calculateIndices,noAlloc:i},vertexPositions:{size:3,type:"float64",stepMode:"dynamic",fp64:this.use64bitPositions(),transition:y1,accessor:"getPolygon",update:this.calculatePositions,noAlloc:i,shaderAttributes:{nextVertexPositions:{vertexOffset:1}}},instanceVertexValid:{size:1,type:"uint16",stepMode:"instance",update:this.calculateVertexValid,noAlloc:i},elevations:{size:1,stepMode:"dynamic",transition:y1,accessor:"getElevation"},fillColors:{size:this.props.colorFormat.length,type:"unorm8",stepMode:"dynamic",transition:y1,accessor:"getFillColor",defaultValue:g1},lineColors:{size:this.props.colorFormat.length,type:"unorm8",stepMode:"dynamic",transition:y1,accessor:"getLineColor",defaultValue:g1},pickingColors:{size:4,type:"uint8",stepMode:"dynamic",accessor:(e,{index:t,target:n})=>this.encodePickingColor(e&&e.__source?e.__source.index:t,n)}})}getPickingInfo(e){const t=super.getPickingInfo(e),{index:n}=t,r=this.props.data;return r[0]&&r[0].__source&&(t.object=r.find(e=>e.__source.index===n)),t}disablePickingIndex(e){const t=this.props.data;if(t[0]&&t[0].__source)for(let n=0;n<t.length;n++)t[n].__source.index===e&&this._disablePickingIndex(n);else super.disablePickingIndex(e)}draw({uniforms:e}){const{extruded:t,filled:n,wireframe:r,elevationScale:o}=this.props,{topModel:i,sideModel:s,wireframeModel:a,polygonTesselator:l}=this.state,c={extruded:Boolean(t),elevationScale:o,isWireframe:!1};a&&r&&(a.setInstanceCount(l.instanceCount-1),a.shaderInputs.setProps({solidPolygon:{...c,isWireframe:!0}}),a.draw(this.context.renderPass)),s&&n&&(s.setInstanceCount(l.instanceCount-1),s.shaderInputs.setProps({solidPolygon:c}),s.draw(this.context.renderPass)),i&&n&&(i.setVertexCount(l.vertexCount),i.shaderInputs.setProps({solidPolygon:c}),i.draw(this.context.renderPass))}updateState(e){super.updateState(e),this.updateGeometry(e);const{props:t,oldProps:n,changeFlags:r}=e,o=this.getAttributeManager();(r.extensionsChanged||t.filled!==n.filled||t.extruded!==n.extruded)&&(this.state.models?.forEach(e=>e.destroy()),this.setState(this._getModels()),o.invalidateAll())}updateGeometry({props:e,oldProps:t,changeFlags:n}){if(n.dataChanged||n.updateTriggersChanged&&(n.updateTriggersChanged.all||n.updateTriggersChanged.getPolygon)){const{polygonTesselator:t}=this.state,r=e.data.attributes||{};t.updateGeometry({data:e.data,normalize:e._normalize,geometryBuffer:r.getPolygon,buffers:r,getGeometry:e.getPolygon,positionFormat:e.positionFormat,wrapLongitude:e.wrapLongitude,resolution:this.context.viewport.resolution,fp64:this.use64bitPositions(),dataChanged:n.dataChanged,full3d:e._full3d}),this.setState({numInstances:t.instanceCount,startIndices:t.vertexStarts}),n.dataChanged||this.getAttributeManager().invalidateAll()}}_getModels(){const{id:e,filled:t,extruded:n}=this.props;let r,o,i;if(t){const t=this.getShaders("top");t.defines.NON_INSTANCED_MODEL=1;const n=this.getAttributeManager().getBufferLayouts({isInstanced:!1});r=new LF(this.context.device,{...t,id:`${e}-top`,topology:"triangle-list",bufferLayout:n,isIndexed:!0,userData:{excludeAttributes:{instanceVertexValid:!0}}})}if(n){const t=this.getAttributeManager().getBufferLayouts({isInstanced:!0});o=new LF(this.context.device,{...this.getShaders("side"),id:`${e}-side`,bufferLayout:t,geometry:new NF({topology:"triangle-strip",attributes:{positions:{size:2,value:new Float32Array([1,0,0,0,1,1,0,1])}}}),isInstanced:!0,userData:{excludeAttributes:{indices:!0}}}),i=new LF(this.context.device,{...this.getShaders("side"),id:`${e}-wireframe`,bufferLayout:t,geometry:new NF({topology:"line-strip",attributes:{positions:{size:2,value:new Float32Array([1,0,0,0,0,1,1,1])}}}),isInstanced:!0,userData:{excludeAttributes:{indices:!0}}})}return{models:[o,i,r].filter(Boolean),topModel:r,sideModel:o,wireframeModel:i}}calculateIndices(e){const{polygonTesselator:t}=this.state;e.startIndices=t.indexStarts,e.value=t.get("indices")}calculatePositions(e){const{polygonTesselator:t}=this.state;e.startIndices=t.vertexStarts,e.value=t.get("positions")}calculateVertexValid(e){e.value=this.state.polygonTesselator.get("vertexValid")}}function b1({data:e,getIndex:t,dataRange:n,replace:r}){const{startRow:o=0,endRow:i=1/0}=n,s=e.length;let a=s,l=s;for(let d=0;d<s;d++){const n=t(e[d]);if(a>d&&n>=o&&(a=d),n>=i){l=d;break}}let c=a;const u=l-a!==r.length?e.slice(l):void 0;for(let d=0;d<r.length;d++)e[c++]=r[d];if(u){for(let t=0;t<u.length;t++)e[c++]=u[t];e.length=c}return{startRow:a,endRow:a+r.length}}v1.defaultProps=m1,v1.layerName="SolidPolygonLayer";const w1="uniform sdfUniforms {\n  float gamma;\n  bool enabled;\n  float buffer;\n  float outlineBuffer;\n  vec4 outlineColor;\n} sdf;\n",x1={name:"sdf",vs:w1,fs:w1,uniformTypes:{gamma:"f32",enabled:"f32",buffer:"f32",outlineBuffer:"f32",outlineColor:"vec4<f32>"}},_1=.75,C1=[];class S1 extends y0{getShaders(){const e=super.getShaders();return{...e,modules:[...e.modules,x1],fs:"#version 300 es\n#define SHADER_NAME multi-icon-layer-fragment-shader\nprecision highp float;\nuniform sampler2D iconsTexture;\nin vec4 vColor;\nin vec2 vTextureCoords;\nin vec2 uv;\nout vec4 fragColor;\nvoid main(void) {\ngeometry.uv = uv;\nif (!bool(picking.isActive)) {\nfloat alpha = texture(iconsTexture, vTextureCoords).a;\nvec4 color = vColor;\nif (sdf.enabled) {\nfloat distance = alpha;\nalpha = smoothstep(sdf.buffer - sdf.gamma, sdf.buffer + sdf.gamma, distance);\nif (sdf.outlineBuffer > 0.0) {\nfloat inFill = alpha;\nfloat inBorder = smoothstep(sdf.outlineBuffer - sdf.gamma, sdf.outlineBuffer + sdf.gamma, distance);\ncolor = mix(sdf.outlineColor, vColor, inFill);\nalpha = inBorder;\n}\n}\nfloat a = alpha * color.a;\nif (a < icon.alphaCutoff) {\ndiscard;\n}\nfragColor = vec4(color.rgb, a * layer.opacity);\n}\nDECKGL_FILTER_COLOR(fragColor, geometry);\n}\n"}}initializeState(){super.initializeState();this.getAttributeManager().addInstanced({instanceOffsets:{size:2,accessor:"getIconOffsets"},instancePickingColors:{type:"uint8",size:3,accessor:(e,{index:t,target:n})=>this.encodePickingColor(t,n)}})}updateState(e){super.updateState(e);const{props:t,oldProps:n}=e;let{outlineColor:r}=t;r!==n.outlineColor&&(r=r.map(e=>e/255),r[3]=Number.isFinite(r[3])?r[3]:1,this.setState({outlineColor:r})),!t.sdf&&t.outlineWidth&&AC.warn(`${this.id}: fontSettings.sdf is required to render outline`)()}draw(e){const{sdf:t,smoothing:n,outlineWidth:r}=this.props,{outlineColor:o}=this.state,i=r?Math.max(n,_1*(1-r)):-1,s=this.state.model,a={buffer:_1,outlineBuffer:i,gamma:n,enabled:Boolean(t),outlineColor:o};if(s.shaderInputs.setProps({sdf:a}),super.draw(e),t&&r){const{iconManager:e}=this.state;e.getTexture()&&(s.shaderInputs.setProps({sdf:{...a,outlineBuffer:_1}}),s.draw(this.context.renderPass))}}getInstanceOffset(e){return e?Array.from(e).flatMap(e=>super.getInstanceOffset(e)):C1}getInstanceColorMode(e){return 1}getInstanceIconFrame(e){return e?Array.from(e).flatMap(e=>super.getInstanceIconFrame(e)):C1}}S1.defaultProps={getIconOffsets:{type:"accessor",value:e=>e.offsets},alphaCutoff:.001,smoothing:.1,outlineWidth:0,outlineColor:{type:"color",value:[0,0,0,255]}},S1.layerName="MultiIconLayer";const E1=1e20;class B1{constructor({fontSize:e=24,buffer:t=3,radius:n=8,cutoff:r=.25,fontFamily:o="sans-serif",fontWeight:i="normal",fontStyle:s="normal",lang:a=null}={}){this.buffer=t,this.cutoff=r,this.radius=n,this.lang=a;const l=this.size=e+4*t,c=this._createCanvas(l),u=this.ctx=c.getContext("2d",{willReadFrequently:!0});u.font=`${s} ${i} ${e}px ${o}`,u.textBaseline="alphabetic",u.textAlign="left",u.fillStyle="black",this.gridOuter=new Float64Array(l*l),this.gridInner=new Float64Array(l*l),this.f=new Float64Array(l),this.z=new Float64Array(l+1),this.v=new Uint16Array(l)}_createCanvas(e){const t=document.createElement("canvas");return t.width=t.height=e,t}draw(e){const{width:t,actualBoundingBoxAscent:n,actualBoundingBoxDescent:r,actualBoundingBoxLeft:o,actualBoundingBoxRight:i}=this.ctx.measureText(e),s=Math.ceil(n),a=Math.max(0,Math.min(this.size-this.buffer,Math.ceil(i-o))),l=Math.min(this.size-this.buffer,s+Math.ceil(r)),c=a+2*this.buffer,u=l+2*this.buffer,d=Math.max(c*u,0),A=new Uint8ClampedArray(d),h={data:A,width:c,height:u,glyphWidth:a,glyphHeight:l,glyphTop:s,glyphLeft:0,glyphAdvance:t};if(0===a||0===l)return h;const{ctx:p,buffer:f,gridInner:g,gridOuter:m}=this;this.lang&&(p.lang=this.lang),p.clearRect(f,f,a,l),p.fillText(e,f,f+s);const y=p.getImageData(f,f,a,l);m.fill(E1,0,d),g.fill(0,0,d);for(let v=0;v<l;v++)for(let e=0;e<a;e++){const t=y.data[4*(v*a+e)+3]/255;if(0===t)continue;const n=(v+f)*c+e+f;if(1===t)m[n]=0,g[n]=E1;else{const e=.5-t;m[n]=e>0?e*e:0,g[n]=e<0?e*e:0}}I1(m,0,0,c,u,c,this.f,this.v,this.z),I1(g,f,f,a,l,c,this.f,this.v,this.z);for(let v=0;v<d;v++){const e=Math.sqrt(m[v])-Math.sqrt(g[v]);A[v]=Math.round(255-255*(e/this.radius+this.cutoff))}return h}}function I1(e,t,n,r,o,i,s,a,l){for(let c=t;c<t+r;c++)R1(e,n*i+c,i,o,s,a,l);for(let c=n;c<n+o;c++)R1(e,c*i+t,1,r,s,a,l)}function R1(e,t,n,r,o,i,s){i[0]=0,s[0]=-E1,s[1]=E1,o[0]=e[t];for(let a=1,l=0,c=0;a<r;a++){o[a]=e[t+a*n];const r=a*a;do{const e=i[l];c=(o[a]-o[e]+r-e*e)/(a-e)/2}while(c<=s[l]&&--l>-1);l++,i[l]=a,s[l]=c,s[l+1]=E1}for(let a=0,l=0;a<r;a++){for(;s[l+1]<a;)l++;const r=i[l],c=a-r;e[t+a*n]=o[r]+c*c}}const k1=[];function T1(e,t,n,r){let o=0;for(let i=t;i<n;i++){const t=e[i];o+=r[t]?.layoutWidth||0}return o}function P1(e,t,n,r,o,i){let s=t,a=0;for(let l=t;l<n;l++){const t=T1(e,l,l+1,o);a+t>r&&(s<l&&i.push(l),s=l,a=0),a+=t}return a}function F1(e,t,n,r,o=0,i){void 0===i&&(i=e.length);const s=[];return"break-all"===t?P1(e,o,i,n,r,s):function(e,t,n,r,o,i){let s=t,a=t,l=t,c=0;for(let u=t;u<n;u++)if(" "===e[u]?l=u+1:" "!==e[u+1]&&u+1!==n||(l=u+1),l>a){let t=T1(e,a,l,o);c+t>r&&(s<a&&(i.push(a),s=a,c=0),t>r&&(t=P1(e,a,l,r,o,i),s=i[i.length-1])),a=l,c+=t}}(e,o,i,n,r,s),s}function M1(e,t,n,r,o,i){let s=0,a=0;for(let l=t;l<n;l++){const t=e[l],n=r[t];n?(a||(a=n.layoutHeight),o[l]=s+n.layoutWidth/2,s+=n.layoutWidth):(AC.warn(`Missing character: ${t} (${t.codePointAt(0)})`)(),o[l]=s,s+=32)}i[0]=s,i[1]=a}class L1{constructor(e=5){this._cache={},this._order=[],this.limit=e}get(e){const t=this._cache[e];return t&&(this._deleteOrder(e),this._appendOrder(e)),t}set(e,t){this._cache[e]?(this.delete(e),this._cache[e]=t,this._appendOrder(e)):(Object.keys(this._cache).length===this.limit&&this.delete(this._order[0]),this._cache[e]=t,this._appendOrder(e))}delete(e){this._cache[e]&&(delete this._cache[e],this._deleteOrder(e))}_deleteOrder(e){const t=this._order.indexOf(e);t>=0&&this._order.splice(t,1)}_appendOrder(e){this._order.push(e)}}const U1={fontFamily:"Monaco, monospace",fontWeight:"normal",characterSet:function(){const e=[];for(let t=32;t<128;t++)e.push(String.fromCharCode(t));return e}(),fontSize:64,buffer:4,sdf:!1,cutoff:.25,radius:12,smoothing:.1};let O1=new L1(3);function D1(e,t){for(let n=0;n<e.length;n++)t.data[4*n+3]=e[n]}function N1(e,t,n,r){e.font=`${r} ${n}px ${t}`,e.fillStyle="#000",e.textBaseline="alphabetic",e.textAlign="left"}class j1{constructor(){this.props={...U1}}get atlas(){return this._atlas}get mapping(){return this._atlas&&this._atlas.mapping}get scale(){const{fontSize:e,buffer:t}=this.props;return(1.2*e+2*t)/e}setProps(e={}){Object.assign(this.props,e),this._key=this._getKey();const t=function(e,t){let n;n="string"==typeof t?new Set(Array.from(t)):new Set(t);const r=O1.get(e);if(!r)return n;for(const o in r.mapping)n.has(o)&&n.delete(o);return n}(this._key,this.props.characterSet),n=O1.get(this._key);if(n&&0===t.size)return void(this._atlas!==n&&(this._atlas=n));const r=this._generateFontAtlas(t,n);this._atlas=r,O1.set(this._key,r)}_generateFontAtlas(e,t){const{fontFamily:n,fontWeight:r,fontSize:o,buffer:i,sdf:s,radius:a,cutoff:l}=this.props;let c=t&&t.data;c||(c=document.createElement("canvas"),c.width=1024);const u=c.getContext("2d",{willReadFrequently:!0});N1(u,n,o,r);const{mapping:d,canvasHeight:A,xOffset:h,yOffset:p}=function({characterSet:e,getFontWidth:t,fontHeight:n,buffer:r,maxCanvasWidth:o,mapping:i={},xOffset:s=0,yOffset:a=0}){let l=0,c=s;const u=n+2*r;for(const A of e)if(!i[A]){const e=t(A);c+e+2*r>o&&(c=0,l++),i[A]={x:c+r,y:a+l*u+r,width:e,height:u,layoutWidth:e,layoutHeight:n},c+=e+2*r}return{mapping:i,xOffset:c,yOffset:a+l*u,canvasHeight:(d=a+(l+1)*u,Math.pow(2,Math.ceil(Math.log2(d))))};var d}({getFontWidth:e=>u.measureText(e).width,fontHeight:1.2*o,buffer:i,characterSet:e,maxCanvasWidth:1024,...t&&{mapping:t.mapping,xOffset:t.xOffset,yOffset:t.yOffset}});if(c.height!==A){const e=u.getImageData(0,0,c.width,c.height);c.height=A,u.putImageData(e,0,0)}if(N1(u,n,o,r),s){const t=new B1({fontSize:o,buffer:i,radius:a,cutoff:l,fontFamily:n,fontWeight:`${r}`});for(const n of e){const{data:e,width:r,height:i,glyphTop:s}=t.draw(n);d[n].width=r,d[n].layoutOffsetY=.9*o-s;const a=u.createImageData(r,i);D1(e,a),u.putImageData(a,d[n].x,d[n].y)}}else for(const f of e)u.fillText(f,d[f].x,d[f].y+i+.9*o);return{xOffset:h,yOffset:p,mapping:d,data:c,width:c.width,height:c.height}}_getKey(){const{fontFamily:e,fontWeight:t,fontSize:n,buffer:r,sdf:o,radius:i,cutoff:s}=this.props;return o?`${e} ${t} ${n} ${r} ${i} ${s}`:`${e} ${t} ${n} ${r}`}}const Q1="uniform textBackgroundUniforms {\n  bool billboard;\n  float sizeScale;\n  float sizeMinPixels;\n  float sizeMaxPixels;\n  vec4 borderRadius;\n  vec4 padding;\n  highp int sizeUnits;\n  bool stroked;\n} textBackground;\n",z1={name:"textBackground",vs:Q1,fs:Q1,uniformTypes:{billboard:"f32",sizeScale:"f32",sizeMinPixels:"f32",sizeMaxPixels:"f32",borderRadius:"vec4<f32>",padding:"vec4<f32>",sizeUnits:"i32",stroked:"f32"}},H1={billboard:!0,sizeScale:1,sizeUnits:"pixels",sizeMinPixels:0,sizeMaxPixels:Number.MAX_SAFE_INTEGER,borderRadius:{type:"object",value:0},padding:{type:"array",value:[0,0,0,0]},getPosition:{type:"accessor",value:e=>e.position},getSize:{type:"accessor",value:1},getAngle:{type:"accessor",value:0},getPixelOffset:{type:"accessor",value:[0,0]},getBoundingRect:{type:"accessor",value:[0,0,0,0]},getFillColor:{type:"accessor",value:[0,0,0,255]},getLineColor:{type:"accessor",value:[0,0,0,255]},getLineWidth:{type:"accessor",value:1}};class G1 extends mD{getShaders(){return super.getShaders({vs:"#version 300 es\n#define SHADER_NAME text-background-layer-vertex-shader\nin vec2 positions;\nin vec3 instancePositions;\nin vec3 instancePositions64Low;\nin vec4 instanceRects;\nin float instanceSizes;\nin float instanceAngles;\nin vec2 instancePixelOffsets;\nin float instanceLineWidths;\nin vec4 instanceFillColors;\nin vec4 instanceLineColors;\nin vec3 instancePickingColors;\nout vec4 vFillColor;\nout vec4 vLineColor;\nout float vLineWidth;\nout vec2 uv;\nout vec2 dimensions;\nvec2 rotate_by_angle(vec2 vertex, float angle) {\nfloat angle_radian = radians(angle);\nfloat cos_angle = cos(angle_radian);\nfloat sin_angle = sin(angle_radian);\nmat2 rotationMatrix = mat2(cos_angle, -sin_angle, sin_angle, cos_angle);\nreturn rotationMatrix * vertex;\n}\nvoid main(void) {\ngeometry.worldPosition = instancePositions;\ngeometry.uv = positions;\ngeometry.pickingColor = instancePickingColors;\nuv = positions;\nvLineWidth = instanceLineWidths;\nfloat sizePixels = clamp(\nproject_size_to_pixel(instanceSizes * textBackground.sizeScale, textBackground.sizeUnits),\ntextBackground.sizeMinPixels, textBackground.sizeMaxPixels\n);\ndimensions = instanceRects.zw * sizePixels + textBackground.padding.xy + textBackground.padding.zw;\nvec2 pixelOffset = (positions * instanceRects.zw + instanceRects.xy) * sizePixels + mix(-textBackground.padding.xy, textBackground.padding.zw, positions);\npixelOffset = rotate_by_angle(pixelOffset, instanceAngles);\npixelOffset += instancePixelOffsets;\npixelOffset.y *= -1.0;\nif (textBackground.billboard)  {\ngl_Position = project_position_to_clipspace(instancePositions, instancePositions64Low, vec3(0.0), geometry.position);\nDECKGL_FILTER_GL_POSITION(gl_Position, geometry);\nvec3 offset = vec3(pixelOffset, 0.0);\nDECKGL_FILTER_SIZE(offset, geometry);\ngl_Position.xy += project_pixel_size_to_clipspace(offset.xy);\n} else {\nvec3 offset_common = vec3(project_pixel_size(pixelOffset), 0.0);\nDECKGL_FILTER_SIZE(offset_common, geometry);\ngl_Position = project_position_to_clipspace(instancePositions, instancePositions64Low, offset_common, geometry.position);\nDECKGL_FILTER_GL_POSITION(gl_Position, geometry);\n}\nvFillColor = vec4(instanceFillColors.rgb, instanceFillColors.a * layer.opacity);\nDECKGL_FILTER_COLOR(vFillColor, geometry);\nvLineColor = vec4(instanceLineColors.rgb, instanceLineColors.a * layer.opacity);\nDECKGL_FILTER_COLOR(vLineColor, geometry);\n}\n",fs:"#version 300 es\n#define SHADER_NAME text-background-layer-fragment-shader\nprecision highp float;\nin vec4 vFillColor;\nin vec4 vLineColor;\nin float vLineWidth;\nin vec2 uv;\nin vec2 dimensions;\nout vec4 fragColor;\nfloat round_rect(vec2 p, vec2 size, vec4 radii) {\nvec2 pixelPositionCB = (p - 0.5) * size;\nvec2 sizeCB = size * 0.5;\nfloat maxBorderRadius = min(size.x, size.y) * 0.5;\nvec4 borderRadius = vec4(min(radii, maxBorderRadius));\nborderRadius.xy =\n(pixelPositionCB.x > 0.0) ? borderRadius.xy : borderRadius.zw;\nborderRadius.x = (pixelPositionCB.y > 0.0) ? borderRadius.x : borderRadius.y;\nvec2 q = abs(pixelPositionCB) - sizeCB + borderRadius.x;\nreturn -(min(max(q.x, q.y), 0.0) + length(max(q, 0.0)) - borderRadius.x);\n}\nfloat rect(vec2 p, vec2 size) {\nvec2 pixelPosition = p * size;\nreturn min(min(pixelPosition.x, size.x - pixelPosition.x),\nmin(pixelPosition.y, size.y - pixelPosition.y));\n}\nvec4 get_stroked_fragColor(float dist) {\nfloat isBorder = smoothedge(dist, vLineWidth);\nreturn mix(vFillColor, vLineColor, isBorder);\n}\nvoid main(void) {\ngeometry.uv = uv;\nif (textBackground.borderRadius != vec4(0.0)) {\nfloat distToEdge = round_rect(uv, dimensions, textBackground.borderRadius);\nif (textBackground.stroked) {\nfragColor = get_stroked_fragColor(distToEdge);\n} else {\nfragColor = vFillColor;\n}\nfloat shapeAlpha = smoothedge(-distToEdge, 0.0);\nfragColor.a *= shapeAlpha;\n} else {\nif (textBackground.stroked) {\nfloat distToEdge = rect(uv, dimensions);\nfragColor = get_stroked_fragColor(distToEdge);\n} else {\nfragColor = vFillColor;\n}\n}\nDECKGL_FILTER_COLOR(fragColor, geometry);\n}\n",modules:[$T,IP,z1]})}initializeState(){this.getAttributeManager().addInstanced({instancePositions:{size:3,type:"float64",fp64:this.use64bitPositions(),transition:!0,accessor:"getPosition"},instanceSizes:{size:1,transition:!0,accessor:"getSize",defaultValue:1},instanceAngles:{size:1,transition:!0,accessor:"getAngle"},instanceRects:{size:4,accessor:"getBoundingRect"},instancePixelOffsets:{size:2,transition:!0,accessor:"getPixelOffset"},instanceFillColors:{size:4,transition:!0,type:"unorm8",accessor:"getFillColor",defaultValue:[0,0,0,255]},instanceLineColors:{size:4,transition:!0,type:"unorm8",accessor:"getLineColor",defaultValue:[0,0,0,255]},instanceLineWidths:{size:1,transition:!0,accessor:"getLineWidth",defaultValue:1}})}updateState(e){super.updateState(e);const{changeFlags:t}=e;t.extensionsChanged&&(this.state.model?.destroy(),this.state.model=this._getModel(),this.getAttributeManager().invalidateAll())}draw({uniforms:e}){const{billboard:t,sizeScale:n,sizeUnits:r,sizeMinPixels:o,sizeMaxPixels:i,getLineWidth:s}=this.props;let{padding:a,borderRadius:l}=this.props;a.length<4&&(a=[a[0],a[1],a[0],a[1]]),Array.isArray(l)||(l=[l,l,l,l]);const c=this.state.model,u={billboard:t,stroked:Boolean(s),borderRadius:l,padding:a,sizeUnits:RT[r],sizeScale:n,sizeMinPixels:o,sizeMaxPixels:i};c.shaderInputs.setProps({textBackground:u}),c.draw(this.context.renderPass)}_getModel(){return new LF(this.context.device,{...this.getShaders(),id:this.props.id,bufferLayout:this.getAttributeManager().getBufferLayouts(),geometry:new NF({topology:"triangle-strip",vertexCount:4,attributes:{positions:{size:2,value:new Float32Array([0,0,1,0,0,1,1,1])}}}),isInstanced:!0})}}G1.defaultProps=H1,G1.layerName="TextBackgroundLayer";const V1={start:1,middle:0,end:-1},W1={top:1,center:0,bottom:-1},$1=[0,0,0,255],K1={billboard:!0,sizeScale:1,sizeUnits:"pixels",sizeMinPixels:0,sizeMaxPixels:Number.MAX_SAFE_INTEGER,background:!1,getBackgroundColor:{type:"accessor",value:[255,255,255,255]},getBorderColor:{type:"accessor",value:$1},getBorderWidth:{type:"accessor",value:0},backgroundBorderRadius:{type:"object",value:0},backgroundPadding:{type:"array",value:[0,0,0,0]},characterSet:{type:"object",value:U1.characterSet},fontFamily:U1.fontFamily,fontWeight:U1.fontWeight,lineHeight:1,outlineWidth:{type:"number",value:0,min:0},outlineColor:{type:"color",value:$1},fontSettings:{type:"object",value:{},compare:1},wordBreak:"break-word",maxWidth:{type:"number",value:-1},getText:{type:"accessor",value:e=>e.text},getPosition:{type:"accessor",value:e=>e.position},getColor:{type:"accessor",value:$1},getSize:{type:"accessor",value:32},getAngle:{type:"accessor",value:0},getTextAnchor:{type:"accessor",value:"middle"},getAlignmentBaseline:{type:"accessor",value:"center"},getPixelOffset:{type:"accessor",value:[0,0]},backgroundColor:{deprecatedFor:["background","getBackgroundColor"]}};class X1 extends yD{constructor(){super(...arguments),this.getBoundingRect=(e,t)=>{let{size:[n,r]}=this.transformParagraph(e,t);const{fontSize:o}=this.state.fontAtlasManager.props;n/=o,r/=o;const{getTextAnchor:i,getAlignmentBaseline:s}=this.props;return[(V1["function"==typeof i?i(e,t):i]-1)*n/2,(W1["function"==typeof s?s(e,t):s]-1)*r/2,n,r]},this.getIconOffsets=(e,t)=>{const{getTextAnchor:n,getAlignmentBaseline:r}=this.props,{x:o,y:i,rowWidth:s,size:[a,l]}=this.transformParagraph(e,t),c=V1["function"==typeof n?n(e,t):n],u=W1["function"==typeof r?r(e,t):r],d=o.length,A=new Array(2*d);let h=0;for(let p=0;p<d;p++){const e=(1-c)*(a-s[p])/2;A[h++]=(c-1)*a/2+e+o[p],A[h++]=(u-1)*l/2+i[p]}return A}}initializeState(){this.state={styleVersion:0,fontAtlasManager:new j1},this.props.maxWidth>0&&AC.once(1,"v8.9 breaking change: TextLayer maxWidth is now relative to text size")()}updateState(e){const{props:t,oldProps:n,changeFlags:r}=e;(r.dataChanged||r.updateTriggersChanged&&(r.updateTriggersChanged.all||r.updateTriggersChanged.getText))&&this._updateText();(this._updateFontAtlas()||t.lineHeight!==n.lineHeight||t.wordBreak!==n.wordBreak||t.maxWidth!==n.maxWidth)&&this.setState({styleVersion:this.state.styleVersion+1})}getPickingInfo({info:e}){return e.object=e.index>=0?this.props.data[e.index]:null,e}_updateFontAtlas(){const{fontSettings:e,fontFamily:t,fontWeight:n}=this.props,{fontAtlasManager:r,characterSet:o}=this.state,i={...e,characterSet:o,fontFamily:t,fontWeight:n};if(!r.mapping)return r.setProps(i),!0;for(const s in i)if(i[s]!==r.props[s])return r.setProps(i),!0;return!1}_updateText(){const{data:e,characterSet:t}=this.props,n=e.attributes?.getText;let r,{getText:o}=this.props,i=e.startIndices;const s="auto"===t&&new Set;if(n&&i){const{texts:t,characterCount:a}=function({value:e,length:t,stride:n,offset:r,startIndices:o,characterSet:i}){const s=e.BYTES_PER_ELEMENT,a=n?n/s:1,l=r?r/s:0,c=o[t]||Math.ceil((e.length-l)/a),u=i&&new Set,d=new Array(t);let A=e;if(a>1||l>0){A=new(0,e.constructor)(c);for(let t=0;t<c;t++)A[t]=e[t*a+l]}for(let h=0;h<t;h++){const e=o[h],t=o[h+1]||c,n=A.subarray(e,t);d[h]=String.fromCodePoint.apply(null,n),u&&n.forEach(u.add,u)}if(u)for(const h of u)i.add(String.fromCodePoint(h));return{texts:d,characterCount:c}}({...ArrayBuffer.isView(n)?{value:n}:n,length:e.length,startIndices:i,characterSet:s});r=a,o=(e,{index:n})=>t[n]}else{const{iterable:t,objectInfo:n}=uO(e);i=[0],r=0;for(const e of t){n.index++;const t=Array.from(o(e,n)||"");s&&t.forEach(s.add,s),r+=t.length,i.push(r)}}this.setState({getText:o,startIndices:i,numInstances:r,characterSet:s||t})}transformParagraph(e,t){const{fontAtlasManager:n}=this.state,r=n.mapping,o=this.state.getText,{wordBreak:i,lineHeight:s,maxWidth:a}=this.props;return function(e,t,n,r,o){const i=Array.from(e),s=i.length,a=new Array(s),l=new Array(s),c=new Array(s),u=("break-word"===n||"break-all"===n)&&isFinite(r)&&r>0,d=[0,0],A=[0,0];let h=0,p=0,f=0;for(let g=0;g<=s;g++){const e=i[g];if("\n"!==e&&g!==s||(f=g),f>p){const e=u?F1(i,n,r,o,p,f):k1;for(let n=0;n<=e.length;n++){const r=0===n?p:e[n-1],s=n<e.length?e[n]:f;M1(i,r,s,o,a,A);for(let e=r;e<s;e++){a[e];const t=i[e],n=o[t]?.layoutOffsetY||0;l[e]=h+A[1]/2+n,c[e]=A[0]}h+=A[1]*t,d[0]=Math.max(d[0],A[0])}p=f}"\n"===e&&(a[p]=0,l[p]=0,c[p]=0,p++)}return d[1]=h,{x:a,y:l,rowWidth:c,size:d}}(o(e,t)||"",s,i,a*n.props.fontSize,r)}renderLayers(){const{startIndices:e,numInstances:t,getText:n,fontAtlasManager:{scale:r,atlas:o,mapping:i},styleVersion:s}=this.state,{data:a,_dataDiff:l,getPosition:c,getColor:u,getSize:d,getAngle:A,getPixelOffset:h,getBackgroundColor:p,getBorderColor:f,getBorderWidth:g,backgroundBorderRadius:m,backgroundPadding:y,background:v,billboard:b,fontSettings:w,outlineWidth:x,outlineColor:_,sizeScale:C,sizeUnits:S,sizeMinPixels:E,sizeMaxPixels:B,transitions:I,updateTriggers:R}=this.props,k=this.getSubLayerClass("characters",S1),T=this.getSubLayerClass("background",G1);return[v&&new T({getFillColor:p,getLineColor:f,getLineWidth:g,borderRadius:m,padding:y,getPosition:c,getSize:d,getAngle:A,getPixelOffset:h,billboard:b,sizeScale:C,sizeUnits:S,sizeMinPixels:E,sizeMaxPixels:B,transitions:I&&{getPosition:I.getPosition,getAngle:I.getAngle,getSize:I.getSize,getFillColor:I.getBackgroundColor,getLineColor:I.getBorderColor,getLineWidth:I.getBorderWidth,getPixelOffset:I.getPixelOffset}},this.getSubLayerProps({id:"background",updateTriggers:{getPosition:R.getPosition,getAngle:R.getAngle,getSize:R.getSize,getFillColor:R.getBackgroundColor,getLineColor:R.getBorderColor,getLineWidth:R.getBorderWidth,getPixelOffset:R.getPixelOffset,getBoundingRect:{getText:R.getText,getTextAnchor:R.getTextAnchor,getAlignmentBaseline:R.getAlignmentBaseline,styleVersion:s}}}),{data:a.attributes&&a.attributes.background?{length:a.length,attributes:a.attributes.background}:a,_dataDiff:l,autoHighlight:!1,getBoundingRect:this.getBoundingRect}),new k({sdf:w.sdf,smoothing:Number.isFinite(w.smoothing)?w.smoothing:U1.smoothing,outlineWidth:x/(w.radius||U1.radius),outlineColor:_,iconAtlas:o,iconMapping:i,getPosition:c,getColor:u,getSize:d,getAngle:A,getPixelOffset:h,billboard:b,sizeScale:C*r,sizeUnits:S,sizeMinPixels:E*r,sizeMaxPixels:B*r,transitions:I&&{getPosition:I.getPosition,getAngle:I.getAngle,getColor:I.getColor,getSize:I.getSize,getPixelOffset:I.getPixelOffset}},this.getSubLayerProps({id:"characters",updateTriggers:{all:R.getText,getPosition:R.getPosition,getAngle:R.getAngle,getColor:R.getColor,getSize:R.getSize,getPixelOffset:R.getPixelOffset,getIconOffsets:{getTextAnchor:R.getTextAnchor,getAlignmentBaseline:R.getAlignmentBaseline,styleVersion:s}}}),{data:a,_dataDiff:l,startIndices:e,numInstances:t,getIconOffsets:this.getIconOffsets,getIcon:n})]}static set fontAtlasCacheLimit(e){!function(e){AC.assert(Number.isFinite(e)&&e>=3,"Invalid cache limit"),O1=new L1(e)}(e)}}X1.defaultProps=K1,X1.layerName="TextLayer";const Y1={circle:{type:_0,props:{filled:"filled",stroked:"stroked",lineWidthMaxPixels:"lineWidthMaxPixels",lineWidthMinPixels:"lineWidthMinPixels",lineWidthScale:"lineWidthScale",lineWidthUnits:"lineWidthUnits",pointRadiusMaxPixels:"radiusMaxPixels",pointRadiusMinPixels:"radiusMinPixels",pointRadiusScale:"radiusScale",pointRadiusUnits:"radiusUnits",pointAntialiasing:"antialiasing",pointBillboard:"billboard",getFillColor:"getFillColor",getLineColor:"getLineColor",getLineWidth:"getLineWidth",getPointRadius:"getRadius"}},icon:{type:y0,props:{iconAtlas:"iconAtlas",iconMapping:"iconMapping",iconSizeMaxPixels:"sizeMaxPixels",iconSizeMinPixels:"sizeMinPixels",iconSizeScale:"sizeScale",iconSizeUnits:"sizeUnits",iconAlphaCutoff:"alphaCutoff",iconBillboard:"billboard",getIcon:"getIcon",getIconAngle:"getAngle",getIconColor:"getColor",getIconPixelOffset:"getPixelOffset",getIconSize:"getSize"}},text:{type:X1,props:{textSizeMaxPixels:"sizeMaxPixels",textSizeMinPixels:"sizeMinPixels",textSizeScale:"sizeScale",textSizeUnits:"sizeUnits",textBackground:"background",textBackgroundPadding:"backgroundPadding",textFontFamily:"fontFamily",textFontWeight:"fontWeight",textLineHeight:"lineHeight",textMaxWidth:"maxWidth",textOutlineColor:"outlineColor",textOutlineWidth:"outlineWidth",textWordBreak:"wordBreak",textCharacterSet:"characterSet",textBillboard:"billboard",textFontSettings:"fontSettings",getText:"getText",getTextAngle:"getAngle",getTextColor:"getColor",getTextPixelOffset:"getPixelOffset",getTextSize:"getSize",getTextAnchor:"getTextAnchor",getTextAlignmentBaseline:"getAlignmentBaseline",getTextBackgroundColor:"getBackgroundColor",getTextBorderColor:"getBorderColor",getTextBorderWidth:"getBorderWidth"}}},q1={type:J0,props:{lineWidthUnits:"widthUnits",lineWidthScale:"widthScale",lineWidthMinPixels:"widthMinPixels",lineWidthMaxPixels:"widthMaxPixels",lineJointRounded:"jointRounded",lineCapRounded:"capRounded",lineMiterLimit:"miterLimit",lineBillboard:"billboard",getLineColor:"getColor",getLineWidth:"getWidth"}},J1={type:v1,props:{extruded:"extruded",filled:"filled",wireframe:"wireframe",elevationScale:"elevationScale",material:"material",_full3d:"_full3d",getElevation:"getElevation",getFillColor:"getFillColor",getLineColor:"getLineColor"}};function Z1({type:e,props:t}){const n={};for(const r in t)n[r]=e.defaultProps[t[r]];return n}function e2(e,t){const{transitions:n,updateTriggers:r}=e.props,o={updateTriggers:{},transitions:n&&{getPosition:n.geometry}};for(const i in t){const s=t[i];let a=e.props[i];i.startsWith("get")&&(a=e.getSubLayerAccessor(a),o.updateTriggers[s]=r[i],n&&(o.transitions[s]=n[i])),o[s]=a}return o}function t2(e,t,n={}){const r={pointFeatures:[],lineFeatures:[],polygonFeatures:[],polygonOutlineFeatures:[]},{startRow:o=0,endRow:i=e.length}=n;for(let s=o;s<i;s++){const n=e[s],{geometry:o}=n;if(o)if("GeometryCollection"===o.type){AC.assert(Array.isArray(o.geometries),"GeoJSON does not have geometries array");const{geometries:e}=o;for(let o=0;o<e.length;o++){n2(e[o],r,t,n,s)}}else n2(o,r,t,n,s)}return r}function n2(e,t,n,r,o){const{type:i,coordinates:s}=e,{pointFeatures:a,lineFeatures:l,polygonFeatures:c,polygonOutlineFeatures:u}=t;if(function(e,t){let n=r2[e];AC.assert(n,`Unknown GeoJSON type ${e}`);for(;t&&--n>0;)t=t[0];return t&&Number.isFinite(t[0])}(i,s))switch(i){case"Point":a.push(n({geometry:e},r,o));break;case"MultiPoint":s.forEach(e=>{a.push(n({geometry:{type:"Point",coordinates:e}},r,o))});break;case"LineString":l.push(n({geometry:e},r,o));break;case"MultiLineString":s.forEach(e=>{l.push(n({geometry:{type:"LineString",coordinates:e}},r,o))});break;case"Polygon":c.push(n({geometry:e},r,o)),s.forEach(e=>{u.push(n({geometry:{type:"LineString",coordinates:e}},r,o))});break;case"MultiPolygon":s.forEach(e=>{c.push(n({geometry:{type:"Polygon",coordinates:e}},r,o)),e.forEach(e=>{u.push(n({geometry:{type:"LineString",coordinates:e}},r,o))})})}else AC.warn(`${i} coordinates are malformed`)()}const r2={Point:1,MultiPoint:2,LineString:2,MultiLineString:3,Polygon:3,MultiPolygon:4};function o2(e){return e.geometry.coordinates}function i2(e,t){const n={points:{},lines:{},polygons:{},polygonsOutline:{}},{points:r,lines:o,polygons:i}=e,s=function(e,t){const n={points:null,lines:null,polygons:null};for(const r in n){const o=e[r].globalFeatureIds.value;n[r]=new Uint8ClampedArray(4*o.length);const i=[];for(let e=0;e<o.length;e++)t(o[e],i),n[r][4*e+0]=i[0],n[r][4*e+1]=i[1],n[r][4*e+2]=i[2],n[r][4*e+3]=255}return n}(e,t);return n.points.data={length:r.positions.value.length/r.positions.size,attributes:{...r.attributes,getPosition:r.positions,instancePickingColors:{size:4,value:s.points}},properties:r.properties,numericProps:r.numericProps,featureIds:r.featureIds},n.lines.data={length:o.pathIndices.value.length-1,startIndices:o.pathIndices.value,attributes:{...o.attributes,getPath:o.positions,instancePickingColors:{size:4,value:s.lines}},properties:o.properties,numericProps:o.numericProps,featureIds:o.featureIds},n.lines._pathType="open",n.polygons.data={length:i.polygonIndices.value.length-1,startIndices:i.polygonIndices.value,attributes:{...i.attributes,getPolygon:i.positions,pickingColors:{size:4,value:s.polygons}},properties:i.properties,numericProps:i.numericProps,featureIds:i.featureIds},n.polygons._normalize=!1,i.triangles&&(n.polygons.data.attributes.indices=i.triangles.value),n.polygonsOutline.data={length:i.primitivePolygonIndices.value.length-1,startIndices:i.primitivePolygonIndices.value,attributes:{...i.attributes,getPath:i.positions,instancePickingColors:{size:4,value:s.polygons}},properties:i.properties,numericProps:i.numericProps,featureIds:i.featureIds},n.polygonsOutline._pathType="open",n}const s2=["points","linestrings","polygons"],a2={...Z1(Y1.circle),...Z1(Y1.icon),...Z1(Y1.text),...Z1(q1),...Z1(J1),stroked:!0,filled:!0,extruded:!1,wireframe:!1,_full3d:!1,iconAtlas:{type:"object",value:null},iconMapping:{type:"object",value:{}},getIcon:{type:"accessor",value:e=>e.properties.icon},getText:{type:"accessor",value:e=>e.properties.text},pointType:"circle",getRadius:{deprecatedFor:"getPointRadius"}};class l2 extends yD{initializeState(){this.state={layerProps:{},features:{},featuresDiff:{}}}updateState({props:e,changeFlags:t}){if(!t.dataChanged)return;const{data:n}=this.props,r=n&&"points"in n&&"polygons"in n&&"lines"in n;this.setState({binary:r}),r?this._updateStateBinary({props:e,changeFlags:t}):this._updateStateJSON({props:e,changeFlags:t})}_updateStateBinary({props:e,changeFlags:t}){const n=i2(e.data,this.encodePickingColor);this.setState({layerProps:n})}_updateStateJSON({props:e,changeFlags:t}){const n=function(e){if(Array.isArray(e))return e;switch(AC.assert(e.type,"GeoJSON does not have type"),e.type){case"Feature":return[e];case"FeatureCollection":return AC.assert(Array.isArray(e.features),"GeoJSON does not have features array"),e.features;default:return[{geometry:e}]}}(e.data),r=this.getSubLayerRow.bind(this);let o={};const i={};if(Array.isArray(t.dataChanged)){const e=this.state.features;for(const t in e)o[t]=e[t].slice(),i[t]=[];for(const s of t.dataChanged){const t=t2(n,r,s);for(const n in e)i[n].push(b1({data:o[n],getIndex:e=>e.__source.index,dataRange:s,replace:t[n]}))}}else o=t2(n,r);const s=function(e,t){const n={points:{},lines:{},polygons:{},polygonsOutline:{}},{pointFeatures:r,lineFeatures:o,polygonFeatures:i,polygonOutlineFeatures:s}=e;return n.points.data=r,n.points._dataDiff=t.pointFeatures&&(()=>t.pointFeatures),n.points.getPosition=o2,n.lines.data=o,n.lines._dataDiff=t.lineFeatures&&(()=>t.lineFeatures),n.lines.getPath=o2,n.polygons.data=i,n.polygons._dataDiff=t.polygonFeatures&&(()=>t.polygonFeatures),n.polygons.getPolygon=o2,n.polygonsOutline.data=s,n.polygonsOutline._dataDiff=t.polygonOutlineFeatures&&(()=>t.polygonOutlineFeatures),n.polygonsOutline.getPath=o2,n}(o,i);this.setState({features:o,featuresDiff:i,layerProps:s})}getPickingInfo(e){const t=super.getPickingInfo(e),{index:n,sourceLayer:r}=t;return t.featureType=s2.find(e=>r.id.startsWith(`${this.id}-${e}-`)),n>=0&&r.id.startsWith(`${this.id}-points-text`)&&this.state.binary&&(t.index=this.props.data.points.globalFeatureIds.value[n]),t}_updateAutoHighlight(e){const t=`${this.id}-points-`,n="points"===e.featureType;for(const r of this.getSubLayers())r.id.startsWith(t)===n&&r.updateAutoHighlight(e)}_renderPolygonLayer(){const{extruded:e,wireframe:t}=this.props,{layerProps:n}=this.state,r="polygons-fill",o=this.shouldRenderSubLayer(r,n.polygons?.data)&&this.getSubLayerClass(r,J1.type);if(o){const i=e2(this,J1.props),s=e&&t;return s||delete i.getLineColor,i.updateTriggers.lineColors=s,new o(i,this.getSubLayerProps({id:r,updateTriggers:i.updateTriggers}),n.polygons)}return null}_renderLineLayers(){const{extruded:e,stroked:t}=this.props,{layerProps:n}=this.state,r="polygons-stroke",o="linestrings",i=!e&&t&&this.shouldRenderSubLayer(r,n.polygonsOutline?.data)&&this.getSubLayerClass(r,q1.type),s=this.shouldRenderSubLayer(o,n.lines?.data)&&this.getSubLayerClass(o,q1.type);if(i||s){const e=e2(this,q1.props);return[i&&new i(e,this.getSubLayerProps({id:r,updateTriggers:e.updateTriggers}),n.polygonsOutline),s&&new s(e,this.getSubLayerProps({id:o,updateTriggers:e.updateTriggers}),n.lines)]}return null}_renderPointLayers(){const{pointType:e}=this.props,{layerProps:t,binary:n}=this.state;let{highlightedObjectIndex:r}=this.props;!n&&Number.isFinite(r)&&(r=t.points.data.findIndex(e=>e.__source.index===r));const o=new Set(e.split("+")),i=[];for(const s of o){const e=`points-${s}`,o=Y1[s],a=o&&this.shouldRenderSubLayer(e,t.points?.data)&&this.getSubLayerClass(e,o.type);if(a){const l=e2(this,o.props);let c=t.points;if("text"===s&&n){const{instancePickingColors:e,...t}=c.data.attributes;c={...c,data:{...c.data,attributes:t}}}i.push(new a(l,this.getSubLayerProps({id:e,updateTriggers:l.updateTriggers,highlightedObjectIndex:r}),c))}}return i}renderLayers(){const{extruded:e}=this.props,t=this._renderPolygonLayer();return[!e&&t,this._renderLineLayers(),this._renderPointLayers(),e&&t]}getSubLayerAccessor(e){const{binary:t}=this.state;return t&&"function"==typeof e?(t,n)=>{const{data:r,index:o}=n,i=function(e,t){if(!e)return null;const n="startIndices"in e?e.startIndices[t]:t,r=e.featureIds.value[n];return-1!==n?function(e,t,n){const r={properties:{...e.properties[t]}};for(const o in e.numericProps)r.properties[o]=e.numericProps[o].value[n];return r}(e,r,n):null}(r,o);return e(i,n)}:super.getSubLayerAccessor(e)}}function c2(e){if(e.length<2)return 0;let t=0;for(let n=0;n<e.length-1;n++){const[r,o]=e[n],[i,s]=e[n+1],a=(s-o)*Math.PI/180,l=(i-r)*Math.PI/180,c=o*Math.PI/180,u=s*Math.PI/180,d=Math.sin(a/2)*Math.sin(a/2)+Math.cos(c)*Math.cos(u)*Math.sin(l/2)*Math.sin(l/2);t+=6371e3*(2*Math.atan2(Math.sqrt(d),Math.sqrt(1-d)))}return t}function u2(e){const t=4*Math.log10(e+10);return n=sN,r=t,o=aN,Math.min(Math.max(r,n),o);var n,r,o}function d2(e,t,n,r){const o=n/6378137,i=r*Math.PI/180,s=e*Math.PI/180,a=t*Math.PI/180,l=Math.asin(Math.sin(s)*Math.cos(o)+Math.cos(s)*Math.sin(o)*Math.cos(i));return[180*(a+Math.atan2(Math.sin(i)*Math.sin(o)*Math.cos(s),Math.cos(o)-Math.sin(s)*Math.sin(l)))/Math.PI,180*l/Math.PI]}function A2(e,t,n=5){const[r,o]=t,i=function(e,t){const[n,r]=e,[o,i]=t,s=(o-n)*Math.PI/180,a=r*Math.PI/180,l=i*Math.PI/180,c=Math.sin(s)*Math.cos(l),u=Math.cos(a)*Math.sin(l)-Math.sin(a)*Math.cos(l)*Math.cos(s);return(180*Math.atan2(c,u)/Math.PI+360)%360}(e,t),s=(i+180)%360,a=(s+30)%360;return[[t,d2(o,r,n,(s-30+360)%360)],[t,d2(o,r,n,a)]]}function h2(e,t,n,r,o,i){if(e.length<2)return[];if("tile-layer"===n.mode)if(void 0!==i){if(!i)return[]}else if(void 0!==n.minZoom&&t<n.minZoom)return[];const s=r??c2(e);if(s<=0)return[];const a=u2(s);return A2(e[e.length-2],e[e.length-1],a).map(e=>({type:"Feature",geometry:{type:"LineString",coordinates:e},properties:{type:"direction_arrow",color:n.color,width:n.width,...o}}))}l2.layerName="GeoJsonLayer",l2.defaultProps=a2;const p2=e=>{if(!e)return null;if("string"==typeof e)try{const t=JSON.parse(e);return p2(t)}catch(t){return null}return"object"==typeof e&&"geometry"in e&&e.geometry&&("LineString"===e.geometry.type||"Polygon"===e.geometry.type)?p2(e.geometry):"object"==typeof e&&"LineString"===e.type&&Array.isArray(e.coordinates)?{type:"LineString",coordinates:e.coordinates}:null},f2=e=>p2(e.linestringGeoJson);function g2(e,t,n=[],r=[],o="roadmap"){const i=s0(o),s=t.hoveredRoadId&&t.panelRoutes.some(n=>n.roadIds.includes(t.hoveredRoadId)&&n.roadIds.includes(e));return t.hoveredRoadId===e||s?i.importedRoadsHoveredColor:t.routeInMaking&&t.routeInMakingRoadIds?.includes(e)?i.importedRoadsSelectedColor:n.includes(e)||r.includes(e)?i.importedRoadsValidColor:t.routeInMaking?i.importedRoadsDefaultColor:t.panelRoutes.some(t=>t.roadIds.includes(e))?i.importedRoadsSelectedColor:t.lassoFilteredRoadIds&&t.lassoFilteredRoadIds.includes(e)?i.importedRoadsLassoColor:i.importedRoadsDefaultColor}function m2(e,t,n=[],r=[],o="roadmap"){return g2(e,t,n,r,o)}function y2(e,t,n,r,o="roadmap"){if(!e||!e.features)return[];r&&0===r.length&&(r=["NO-PRIORITIES-SELECTED"]);const i=n??0;let s=[],a=[];if(t.routeInMaking&&t.importedRoads){const e=function(e,t){const n=e.properties.start_point,r=e.properties.end_point,o=[],i=[];for(const s of t.features){if(e.properties.road_id===s.properties.road_id)continue;const t=s.properties.start_point;jw(s.properties.end_point,n)&&o.push(s),jw(t,r)&&i.push(s)}return{roadsThatCanBeAddedToFront:o,roadsThatCanBeAddedToBack:i}}(t.routeInMaking,t.importedRoads);s=e.roadsThatCanBeAddedToFront.map(e=>e.properties.road_id),a=e.roadsThatCanBeAddedToBack.map(e=>e.properties.road_id)}const l=[],c=[],u=[],d=[],A=[],h=[];for(const x of e.features){if(r&&r.length>0&&x.properties?.priority){const e=x.properties.priority;if(!r.includes(e))continue}if(!x||"LineString"!==x.geometry.type||!x.geometry.coordinates||x.geometry.coordinates.length<2)continue;const e=x.properties?.road_id?.toString()||"";if(!e)continue;const n=g2(e,t,s,a,o),p=t.hoveredRoadId===e||t.hoveredRoadId&&t.panelRoutes.some(n=>n.roadIds.includes(t.hoveredRoadId)&&n.roadIds.includes(e)),f=t.panelRoutes.some(t=>t.roadIds.includes(e)),g={...x,properties:{...x.properties,road_id:e,featureType:"road",layerId:"imported-roads",color:n}};let m=1e3*(x.properties?.distance_km??0)||(x.properties?.distance??0)||0;0===m&&x.geometry.coordinates.length>=2&&(m=c2(x.geometry.coordinates));let y=[];if(x.geometry.coordinates.length>=2&&m>0){const n=m2(e,t,s,a,o);y=h2(x.geometry.coordinates,i,{color:n,width:4,mode:"regular-layer"},m,{type:"direction_arrow",parent_id:e,road_id:e,layerId:"imported-roads"}),y.length}const v=t.routeInMaking&&t.routeInMakingRoadIds?.includes(e),b=s.includes(e),w=a.includes(e);p?h.push(g,...y):v?A.push(g,...y):b?d.push(g,...y):w?u.push(g,...y):f?c.push(g,...y):l.push(g,...y)}const p=(e,n)=>{if(0===n.length)return null;try{return{id:e,layer:new l2({id:e,data:{type:"FeatureCollection",features:n},pickable:!0,autohighlight:!1,getLineColor:e=>{if(e.properties?.color&&Array.isArray(e.properties.color)&&4===e.properties.color.length)return e.properties.color;return s0(o).importedRoadsDefaultColor},getLineWidth:e=>{if("direction_arrow"===e.properties?.type&&e.properties?.width)return e.properties.width;const n=e.properties?.road_id?.toString();return t.hoveredRoadId===n||t.hoveredRoadId&&n&&t.panelRoutes.some(e=>e.roadIds.includes(t.hoveredRoadId)&&e.roadIds.includes(n))?12:6},lineWidthUnits:"pixels",lineWidthMinPixels:1.5,lineWidthMaxPixels:6,stroked:!1,parameters:{depthTest:!0,depthFunc:515},updateTriggers:{getLineColor:[t.hoveredRoadId,t.panelRoutes.length,t.lassoFilteredRoadIds?.length,t.multiSelectTempSelection.length,t.routeInMaking?.properties.road_id,t.routeInMakingRoadIds?.length||0,s.length,a.length,o]}}),visible:!0}}catch(r){return null}},f=[],g=p("imported-roads-normal",l);g&&f.push(g);const m=p("imported-roads-selected",c);m&&f.push(m);const y=p("imported-roads-back-add-route",u);y&&f.push(y);const v=p("imported-roads-front-add-route",d);v&&f.push(v);const b=p("imported-roads-route-in-making",A);b&&f.push(b);const w=p("imported-roads-highlighted",h);return w&&f.push(w),f}function v2(e,t,n,r,o,i="roadmap"){const s=[];if(t){const e=function(e){if(!e||"Polygon"!==e.type)return null;try{return{id:"imported-polygon",layer:new l2({id:"imported-polygon",data:{type:"Feature",geometry:e,properties:{}},pickable:!1,autohighlight:!1,getFillColor:[eN[0],eN[1],eN[2],30],getLineColor:[eN[0],eN[1],eN[2],200],getLineWidth:2,lineWidthMinPixels:2,stroked:!0,filled:!0,visible:!1}),visible:!0}}catch(t){return null}}(t);e&&s.push(e)}if(e){const t=y2(e,n,r,o,i);t&&t.length>0&&s.push(...t)}return s}class b2{constructor(e){this.index=e,this.isVisible=!1,this.isSelected=!1,this.parent=null,this.children=[],this.content=null,this._loader=void 0,this._abortController=null,this._loaderId=0,this._isLoaded=!1,this._isCancelled=!1,this._needsReload=!1}get bbox(){return this._bbox}set bbox(e){this._bbox||(this._bbox=e,this.boundingBox="west"in e?[[e.west,e.south],[e.east,e.north]]:[[e.left,e.top],[e.right,e.bottom]])}get data(){return this.isLoading&&this._loader?this._loader.then(()=>this.data):this.content}get isLoaded(){return this._isLoaded&&!this._needsReload}get isLoading(){return Boolean(this._loader)&&!this._isCancelled}get needsReload(){return this._needsReload||this._isCancelled}get byteLength(){const e=this.content?this.content.byteLength:0;return Number.isFinite(e),e}async _loadData({getData:e,requestScheduler:t,onLoad:n,onError:r}){const{index:o,id:i,bbox:s,userData:a,zoom:l}=this,c=this._loaderId;this._abortController=new AbortController;const{signal:u}=this._abortController,d=await t.scheduleRequest(this,e=>e.isSelected?1:-1);if(!d)return void(this._isCancelled=!0);if(this._isCancelled)return void d.done();let A,h=null;try{h=await e({index:o,id:i,bbox:s,userData:a,zoom:l,signal:u})}catch(p){A=p||!0}finally{d.done()}c===this._loaderId&&(this._loader=void 0,this.content=h,!this._isCancelled||h?(this._isLoaded=!0,this._isCancelled=!1,A?r(A,this):n(this)):this._isLoaded=!1)}loadData(e){return this._isLoaded=!1,this._isCancelled=!1,this._needsReload=!1,this._loaderId++,this._loader=this._loadData(e),this._loader}setNeedsReload(){this.isLoading&&(this.abort(),this._loader=void 0),this._needsReload=!0}abort(){this.isLoaded||(this._isCancelled=!0,this._abortController?.abort())}}const w2=-1,x2=0,_2=1,C2=new mR,S2=new mR;class E2{constructor(e=[0,0,0],t=[0,0,0],n){n=n||C2.copy(e).add(t).scale(.5),this.center=new mR(n),this.halfDiagonal=new mR(t).subtract(this.center),this.minimum=new mR(e),this.maximum=new mR(t)}clone(){return new E2(this.minimum,this.maximum,this.center)}equals(e){return this===e||Boolean(e)&&this.minimum.equals(e.minimum)&&this.maximum.equals(e.maximum)}transform(e){return this.center.transformAsPoint(e),this.halfDiagonal.transform(e),this.minimum.transform(e),this.maximum.transform(e),this}intersectPlane(e){const{halfDiagonal:t}=this,n=S2.from(e.normal),r=t.x*Math.abs(n.x)+t.y*Math.abs(n.y)+t.z*Math.abs(n.z),o=this.center.dot(n)+e.distance;return o-r>0?_2:o+r<0?w2:x2}distanceTo(e){return Math.sqrt(this.distanceSquaredTo(e))}distanceSquaredTo(e){const t=C2.from(e).subtract(this.center),{halfDiagonal:n}=this;let r,o=0;return r=Math.abs(t.x)-n.x,r>0&&(o+=r*r),r=Math.abs(t.y)-n.y,r>0&&(o+=r*r),r=Math.abs(t.z)-n.z,r>0&&(o+=r*r),o}}const B2=new mR,I2=new mR;class R2{constructor(e=[0,0,0],t=0){this.radius=-0,this.center=new mR,this.fromCenterRadius(e,t)}fromCenterRadius(e,t){return this.center.from(e),this.radius=t,this}fromCornerPoints(e,t){return t=B2.from(t),this.center=(new mR).from(e).add(t).scale(.5),this.radius=this.center.distance(t),this}equals(e){return this===e||Boolean(e)&&this.center.equals(e.center)&&this.radius===e.radius}clone(){return new R2(this.center,this.radius)}union(e){const t=this.center,n=this.radius,r=e.center,o=e.radius,i=B2.copy(r).subtract(t),s=i.magnitude();if(n>=s+o)return this.clone();if(o>=s+n)return e.clone();const a=.5*(n+s+o);return I2.copy(i).scale((-n+a)/s).add(t),this.center.copy(I2),this.radius=a,this}expand(e){const t=B2.from(e).subtract(this.center).magnitude();return t>this.radius&&(this.radius=t),this}transform(e){this.center.transform(e);const t=function(e,t){const n=t[0],r=t[1],o=t[2],i=t[4],s=t[5],a=t[6],l=t[8],c=t[9],u=t[10];return e[0]=Math.sqrt(n*n+r*r+o*o),e[1]=Math.sqrt(i*i+s*s+a*a),e[2]=Math.sqrt(l*l+c*c+u*u),e}(B2,e);return this.radius=Math.max(t[0],Math.max(t[1],t[2]))*this.radius,this}distanceSquaredTo(e){const t=this.distanceTo(e);return t*t}distanceTo(e){const t=B2.from(e).subtract(this.center);return Math.max(0,t.len()-this.radius)}intersectPlane(e){const t=this.center,n=this.radius,r=e.normal.dot(t)+e.distance;return r<-n?w2:r<n?x2:_2}}const k2=new mR,T2=new mR,P2=new mR,F2=new mR,M2=new mR,L2=new mR,U2=new mR,O2=0,D2=1,N2=2,j2=3,Q2=4,z2=5,H2=6,G2=7,V2=8;class W2{constructor(e=[0,0,0],t=[0,0,0,0,0,0,0,0,0]){this.center=(new mR).from(e),this.halfAxes=new SR(t)}get halfSize(){const e=this.halfAxes.getColumn(0),t=this.halfAxes.getColumn(1),n=this.halfAxes.getColumn(2);return[new mR(e).len(),new mR(t).len(),new mR(n).len()]}get quaternion(){const e=this.halfAxes.getColumn(0),t=this.halfAxes.getColumn(1),n=this.halfAxes.getColumn(2),r=new mR(e).normalize(),o=new mR(t).normalize(),i=new mR(n).normalize();return(new lk).fromMatrix3(new SR([...r,...o,...i]))}fromCenterHalfSizeQuaternion(e,t,n){const r=new lk(n),o=(new SR).fromQuaternion(r);return o[0]=o[0]*t[0],o[1]=o[1]*t[0],o[2]=o[2]*t[0],o[3]=o[3]*t[1],o[4]=o[4]*t[1],o[5]=o[5]*t[1],o[6]=o[6]*t[2],o[7]=o[7]*t[2],o[8]=o[8]*t[2],this.center=(new mR).from(e),this.halfAxes=o,this}clone(){return new W2(this.center,this.halfAxes)}equals(e){return this===e||Boolean(e)&&this.center.equals(e.center)&&this.halfAxes.equals(e.halfAxes)}getBoundingSphere(e=new R2){const t=this.halfAxes,n=t.getColumn(0,P2),r=t.getColumn(1,F2),o=t.getColumn(2,M2),i=k2.copy(n).add(r).add(o);return e.center.copy(this.center),e.radius=i.magnitude(),e}intersectPlane(e){const t=this.center,n=e.normal,r=this.halfAxes,o=n.x,i=n.y,s=n.z,a=Math.abs(o*r[O2]+i*r[D2]+s*r[N2])+Math.abs(o*r[j2]+i*r[Q2]+s*r[z2])+Math.abs(o*r[H2]+i*r[G2]+s*r[V2]),l=n.dot(t)+e.distance;return l<=-a?w2:l>=a?_2:x2}distanceTo(e){return Math.sqrt(this.distanceSquaredTo(e))}distanceSquaredTo(e){const t=T2.from(e).subtract(this.center),n=this.halfAxes,r=n.getColumn(0,P2),o=n.getColumn(1,F2),i=n.getColumn(2,M2),s=r.magnitude(),a=o.magnitude(),l=i.magnitude();r.normalize(),o.normalize(),i.normalize();let c,u=0;return c=Math.abs(t.dot(r))-s,c>0&&(u+=c*c),c=Math.abs(t.dot(o))-a,c>0&&(u+=c*c),c=Math.abs(t.dot(i))-l,c>0&&(u+=c*c),u}computePlaneDistances(e,t,n=[-0,-0]){let r=Number.POSITIVE_INFINITY,o=Number.NEGATIVE_INFINITY;const i=this.center,s=this.halfAxes,a=s.getColumn(0,P2),l=s.getColumn(1,F2),c=s.getColumn(2,M2),u=L2.copy(a).add(l).add(c).add(i),d=U2.copy(u).subtract(e);let A=t.dot(d);return r=Math.min(A,r),o=Math.max(A,o),u.copy(i).add(a).add(l).subtract(c),d.copy(u).subtract(e),A=t.dot(d),r=Math.min(A,r),o=Math.max(A,o),u.copy(i).add(a).subtract(l).add(c),d.copy(u).subtract(e),A=t.dot(d),r=Math.min(A,r),o=Math.max(A,o),u.copy(i).add(a).subtract(l).subtract(c),d.copy(u).subtract(e),A=t.dot(d),r=Math.min(A,r),o=Math.max(A,o),i.copy(u).subtract(a).add(l).add(c),d.copy(u).subtract(e),A=t.dot(d),r=Math.min(A,r),o=Math.max(A,o),i.copy(u).subtract(a).add(l).subtract(c),d.copy(u).subtract(e),A=t.dot(d),r=Math.min(A,r),o=Math.max(A,o),i.copy(u).subtract(a).subtract(l).add(c),d.copy(u).subtract(e),A=t.dot(d),r=Math.min(A,r),o=Math.max(A,o),i.copy(u).subtract(a).subtract(l).subtract(c),d.copy(u).subtract(e),A=t.dot(d),r=Math.min(A,r),o=Math.max(A,o),n[0]=r,n[1]=o,n}transform(e){this.center.transformAsPoint(e);const t=this.halfAxes.getColumn(0,P2);t.transformAsPoint(e);const n=this.halfAxes.getColumn(1,F2);n.transformAsPoint(e);const r=this.halfAxes.getColumn(2,M2);return r.transformAsPoint(e),this.halfAxes=new SR([...t,...n,...r]),this}getTransform(){throw new Error("not implemented")}}const $2=new mR,K2=new mR;class X2{constructor(e=[0,0,1],t=0){this.normal=new mR,this.distance=-0,this.fromNormalDistance(e,t)}fromNormalDistance(e,t){return WI(Number.isFinite(t)),this.normal.from(e).normalize(),this.distance=t,this}fromPointNormal(e,t){e=$2.from(e),this.normal.from(t).normalize();const n=-this.normal.dot(e);return this.distance=n,this}fromCoefficients(e,t,n,r){return this.normal.set(e,t,n),WI(zI(this.normal.len(),1)),this.distance=r,this}clone(){return new X2(this.normal,this.distance)}equals(e){return zI(this.distance,e.distance)&&zI(this.normal,e.normal)}getPointDistance(e){return this.normal.dot(e)+this.distance}transform(e){const t=K2.copy(this.normal).transformAsVector(e).normalize(),n=this.normal.scale(-this.distance).transform(e);return this.fromPointNormal(n,t)}projectPointOntoPlane(e,t=[0,0,0]){const n=$2.from(e),r=this.getPointDistance(n),o=K2.copy(this.normal).scale(r);return n.subtract(o).to(t)}}const Y2=[new mR([1,0,0]),new mR([0,1,0]),new mR([0,0,1])],q2=new mR,J2=new mR;class Z2{constructor(e=[]){this.planes=e}fromBoundingSphere(e){this.planes.length=2*Y2.length;const t=e.center,n=e.radius;let r=0;for(const o of Y2){let e=this.planes[r],i=this.planes[r+1];e||(e=this.planes[r]=new X2),i||(i=this.planes[r+1]=new X2);const s=q2.copy(o).scale(-n).add(t);e.fromPointNormal(s,o);const a=q2.copy(o).scale(n).add(t),l=J2.copy(o).negate();i.fromPointNormal(a,l),r+=2}return this}computeVisibility(e){let t=_2;for(const n of this.planes){switch(e.intersectPlane(n)){case w2:return w2;case x2:t=x2}}return t}computeVisibilityWithPlaneMask(e,t){if(WI(Number.isFinite(t),"parentPlaneMask is required."),t===Z2.MASK_OUTSIDE||t===Z2.MASK_INSIDE)return t;let n=Z2.MASK_INSIDE;const r=this.planes;for(let o=0;o<this.planes.length;++o){const i=o<31?1<<o:0;if(o<31&&0===(t&i))continue;const s=r[o],a=e.intersectPlane(s);if(a===w2)return Z2.MASK_OUTSIDE;a===x2&&(n|=i)}return n}}Z2.MASK_OUTSIDE=4294967295,Z2.MASK_INSIDE=0,Z2.MASK_INDETERMINATE=2147483647,new mR,new mR,new mR,new mR,new mR,new mR,new mR,new mR,new mR,new mR,new mR,new mR,new mR,new mR,new mR,new mR,new mR;const e3=new SR,t3=new SR,n3=new SR,r3=new SR,o3=new SR;function i3(e,t={}){let n=0,r=0;const o=t3,i=n3;o.identity(),i.copy(e);const s=1e-20*function(e){let t=0;for(let n=0;n<9;++n){const r=e[n];t+=r*r}return Math.sqrt(t)}(i);for(;r<10&&l3(i)>s;)c3(i,r3),o3.copy(r3).transpose(),i.multiplyRight(r3),i.multiplyLeft(o3),o.multiplyRight(r3),++n>2&&(++r,n=0);return t.unitary=o.toTarget(t.unitary),t.diagonal=i.toTarget(t.diagonal),t}const s3=[1,0,0],a3=[2,2,1];function l3(e){let t=0;for(let n=0;n<3;++n){const r=e[e3.getElementIndex(a3[n],s3[n])];t+=2*r*r}return Math.sqrt(t)}function c3(e,t){let n=0,r=1;for(let l=0;l<3;++l){const t=Math.abs(e[e3.getElementIndex(a3[l],s3[l])]);t>n&&(r=l,n=t)}const o=s3[r],i=a3[r];let s=1,a=0;if(Math.abs(e[e3.getElementIndex(i,o)])>1e-15){const t=(e[e3.getElementIndex(i,i)]-e[e3.getElementIndex(o,o)])/2/e[e3.getElementIndex(i,o)];let n;n=t<0?-1/(-t+Math.sqrt(1+t*t)):1/(t+Math.sqrt(1+t*t)),s=1/Math.sqrt(1+n*n),a=n*s}return SR.IDENTITY.to(t),t[e3.getElementIndex(o,o)]=t[e3.getElementIndex(i,i)]=s,t[e3.getElementIndex(i,o)]=a,t[e3.getElementIndex(o,i)]=-a,t}const u3=new mR,d3=new mR,A3=new mR,h3=new mR,p3=new mR,f3=new SR,g3={diagonal:new SR,unitary:new SR};const m3=512,y3=[[.5,.5],[0,0],[0,1],[1,0],[1,1]],v3=y3.concat([[0,.5],[.5,0],[1,.5],[.5,1]]),b3=v3.concat([[.25,.5],[.75,.5]]);class w3{constructor(e,t,n){this.x=e,this.y=t,this.z=n}get children(){if(!this._children){const e=2*this.x,t=2*this.y,n=this.z+1;this._children=[new w3(e,t,n),new w3(e,t+1,n),new w3(e+1,t,n),new w3(e+1,t+1,n)]}return this._children}update(e){const{viewport:t,cullingVolume:n,elevationBounds:r,minZ:o,maxZ:i,bounds:s,offset:a,project:l}=e,c=this.getBoundingVolume(r,a,l);if(s&&!this.insideBounds(s))return!1;if(n.computeVisibility(c)<0)return!1;if(!this.childVisible){let{z:e}=this;if(e<i&&e>=o){const n=c.distanceTo(t.cameraPosition)*t.scale/t.height;e+=Math.floor(Math.log2(n))}if(e>=i)return this.selected=!0,!0}this.selected=!1,this.childVisible=!0;for(const u of this.children)u.update(e);return!0}getSelected(e=[]){if(this.selected&&e.push(this),this._children)for(const t of this._children)t.getSelected(e);return e}insideBounds([e,t,n,r]){const o=Math.pow(2,this.z),i=m3/o;return this.x*i<n&&this.y*i<r&&(this.x+1)*i>e&&(this.y+1)*i>t}getBoundingVolume(e,t,n){if(n){const t=this.z<1?b3:this.z<2?v3:y3,r=[];for(const o of t){const t=k3(this.x+o[0],this.y+o[1],this.z);t[2]=e[0],r.push(n(t)),e[0]!==e[1]&&(t[2]=e[1],r.push(n(t)))}return function(e,t=new W2){if(!e||0===e.length)return t.halfAxes=new SR([0,0,0,0,0,0,0,0,0]),t.center=new mR,t;const n=e.length,r=new mR(0,0,0);for(const S of e)r.add(S);const o=1/n;r.multiplyByScalar(o);let i=0,s=0,a=0,l=0,c=0,u=0;for(const S of e){const e=u3.copy(S).subtract(r);i+=e.x*e.x,s+=e.x*e.y,a+=e.x*e.z,l+=e.y*e.y,c+=e.y*e.z,u+=e.z*e.z}i*=o,s*=o,a*=o,l*=o,c*=o,u*=o;const d=f3;d[0]=i,d[1]=s,d[2]=a,d[3]=s,d[4]=l,d[5]=c,d[6]=a,d[7]=c,d[8]=u;const{unitary:A}=i3(d,g3),h=t.halfAxes.copy(A);let p=h.getColumn(0,A3),f=h.getColumn(1,h3),g=h.getColumn(2,p3),m=-Number.MAX_VALUE,y=-Number.MAX_VALUE,v=-Number.MAX_VALUE,b=Number.MAX_VALUE,w=Number.MAX_VALUE,x=Number.MAX_VALUE;for(const S of e)u3.copy(S),m=Math.max(u3.dot(p),m),y=Math.max(u3.dot(f),y),v=Math.max(u3.dot(g),v),b=Math.min(u3.dot(p),b),w=Math.min(u3.dot(f),w),x=Math.min(u3.dot(g),x);p=p.multiplyByScalar(.5*(b+m)),f=f.multiplyByScalar(.5*(w+y)),g=g.multiplyByScalar(.5*(x+v)),t.center.copy(p).add(f).add(g);const _=d3.set(m-b,y-w,v-x).multiplyByScalar(.5),C=new SR([_[0],0,0,0,_[1],0,0,0,_[2]]);return t.halfAxes.multiplyRight(C),t}(r)}const r=Math.pow(2,this.z),o=m3/r,i=this.x*o+t*m3,s=m3-(this.y+1)*o;return new E2([i,s,e[0]],[i+o,s+o,e[1]])}}const x3=512,_3=[-1/0,-1/0,1/0,1/0],C3={equal:(e,t)=>{if(e===t)return!0;if(!Array.isArray(e)||!Array.isArray(t))return!1;const n=e.length;if(n!==t.length)return!1;for(let r=0;r<n;r++)if(e[r]!==t[r])return!1;return!0}};function S3(e,t){const n=[t.transformAsPoint([e[0],e[1]]),t.transformAsPoint([e[2],e[1]]),t.transformAsPoint([e[0],e[3]]),t.transformAsPoint([e[2],e[3]])],r=[Math.min(...n.map(e=>e[0])),Math.min(...n.map(e=>e[1])),Math.max(...n.map(e=>e[0])),Math.max(...n.map(e=>e[1]))];return r}function E3(e,t){if(!e||!e.length)return null;const{index:n,id:r}=t;if(Array.isArray(e)){e=e[(o=r,Math.abs(o.split("").reduce((e,t)=>(e<<5)-e+t.charCodeAt(0)|0,0))%e.length)]}var o;let i=e;for(const s of Object.keys(n)){const e=new RegExp(`{${s}}`,"g");i=i.replace(e,String(n[s]))}return Number.isInteger(n.y)&&Number.isInteger(n.z)&&(i=i.replace(/\{-y\}/g,String(Math.pow(2,n.z)-n.y-1))),i}function B3({viewport:e,z:t,cullRect:n}){return(e.subViewports||[e]).map(e=>I3(e,t||0,n))}function I3(e,t,n){if(!Array.isArray(t)){const r=n.x-e.x,o=n.y-e.y,{width:i,height:s}=n,a={targetZ:t},l=e.unproject([r,o],a),c=e.unproject([r+i,o],a),u=e.unproject([r,o+s],a),d=e.unproject([r+i,o+s],a);return[Math.min(l[0],c[0],u[0],d[0]),Math.min(l[1],c[1],u[1],d[1]),Math.max(l[0],c[0],u[0],d[0]),Math.max(l[1],c[1],u[1],d[1])]}const r=I3(e,t[0],n),o=I3(e,t[1],n);return[Math.min(r[0],o[0]),Math.min(r[1],o[1]),Math.max(r[2],o[2]),Math.max(r[3],o[3])]}function R3(e,t){return Math.pow(2,e)*x3/t}function k3(e,t,n){const r=R3(n,x3),o=e/r*360-180,i=Math.PI-2*Math.PI*t/r;return[o,180/Math.PI*Math.atan(.5*(Math.exp(i)-Math.exp(-i)))]}function T3(e,t,n,r){const o=R3(n,r);return[e/o*x3,t/o*x3]}function P3(e,t,n,r,o=x3){if(e.isGeospatial){const[e,o]=k3(t,n,r),[i,s]=k3(t+1,n+1,r);return{west:e,north:o,east:i,south:s}}const[i,s]=T3(t,n,r,o),[a,l]=T3(t+1,n+1,r,o);return{left:i,top:s,right:a,bottom:l}}function F3(e,t,n,r,o){const i=function(e,t,n){let r;return r=e.getBounds(),e.isGeospatial?[Math.max(r[0],n[0]),Math.max(r[1],n[1]),Math.min(r[2],n[2]),Math.min(r[3],n[3])]:[Math.max(Math.min(r[0],n[2]),n[0]),Math.max(Math.min(r[1],n[3]),n[1]),Math.min(Math.max(r[2],n[0]),n[2]),Math.min(Math.max(r[3],n[1]),n[3])]}(e,0,r),s=R3(t,n),[a,l,c,u]=function(e,t,n){if(n){const r=S3(e,n).map(e=>e*t/x3);return r}return e.map(e=>e*t/x3)}(i,s,o),d=[];for(let A=Math.floor(a);A<c;A++)for(let e=Math.floor(l);e<u;e++)d.push({x:A,y:e,z:t});return d}function M3({viewport:e,maxZoom:t,minZoom:n,zRange:r,extent:o,tileSize:i=x3,modelMatrix:s,modelMatrixInverse:a,zoomOffset:l=0}){let c=e.isGeospatial?Math.round(e.zoom+Math.log2(x3/i))+l:Math.ceil(e.zoom)+l;if("number"==typeof n&&Number.isFinite(n)&&c<n){if(!o)return[];c=n}"number"==typeof t&&Number.isFinite(t)&&c>t&&(c=t);let u=o;return s&&a&&o&&!e.isGeospatial&&(u=S3(o,s)),e.isGeospatial?function(e,t,n,r){const o=e instanceof CD&&e.resolution?e.projectPosition:null,i=Object.values(e.getFrustumPlanes()).map(({normal:e,distance:t})=>new X2(e.clone().negate(),t)),s=new Z2(i),a=e.distanceScales.unitsPerMeter[2],l=n&&n[0]*a||0,c=n&&n[1]*a||0,u=e instanceof cF&&e.pitch<=60?t:0;if(r){const[e,t,n,o]=r,i=aP([e,o]),s=aP([n,t]);r=[i[0],m3-i[1],s[0],m3-s[1]]}const d=new w3(0,0,0),A={viewport:e,project:o,cullingVolume:s,elevationBounds:[l,c],minZ:u,maxZ:t,bounds:r,offset:0};if(d.update(A),e instanceof cF&&e.subViewports&&e.subViewports.length>1){for(A.offset=-1;d.update(A)&&!(--A.offset<-3););for(A.offset=1;d.update(A)&&!(++A.offset>3););}return d.getSelected()}(e,c,r,o):F3(e,c,i,u||_3,a)}function L3(e,t){if(e===t)return!0;if(Array.isArray(e)){const n=e.length;if(!t||t.length!==n)return!1;for(let r=0;r<n;r++)if(e[r]!==t[r])return!1;return!0}return!1}const U3="never",O3="no-overlap",D3="best-available",N3={[D3]:function(e){for(const t of e)t.state=0;for(const t of e)t.isSelected&&!Q3(t)&&z3(t);for(const t of e)t.isVisible=Boolean(2&t.state)},[O3]:function(e){for(const n of e)n.state=0;for(const n of e)n.isSelected&&Q3(n);const t=Array.from(e).sort((e,t)=>e.zoom-t.zoom);for(const n of t)if(n.isVisible=Boolean(2&n.state),n.children&&(n.isVisible||1&n.state))for(const e of n.children)e.state=1;else n.isSelected&&z3(n)},[U3]:()=>{}},j3={extent:null,tileSize:512,maxZoom:null,minZoom:null,maxCacheSize:null,maxCacheByteSize:null,refinementStrategy:"best-available",zRange:null,maxRequests:6,debounceTime:0,zoomOffset:0,onTileLoad:()=>{},onTileUnload:()=>{},onTileError:()=>{}};function Q3(e){let t=e;for(;t;){if(t.isLoaded||t.content)return t.state|=2,!0;t=t.parent}return!1}function z3(e){for(const t of e.children)t.isLoaded||t.content?t.state|=2:z3(t)}const H3={TilesetClass:class{constructor(e){this._getCullBounds=function(e){let t,n={};return r=>{for(const o in r)if(!L3(r[o],n[o])){t=e(r),n=r;break}return t}}(B3),this.opts={...j3,...e},this.setOptions(this.opts),this.onTileLoad=e=>{this.opts.onTileLoad?.(e),null!==this.opts.maxCacheByteSize&&(this._cacheByteSize+=e.byteLength,this._resizeCache())},this._requestScheduler=new $x({throttleRequests:this.opts.maxRequests>0||this.opts.debounceTime>0,maxRequests:this.opts.maxRequests,debounceTime:this.opts.debounceTime}),this._cache=new Map,this._tiles=[],this._dirty=!1,this._cacheByteSize=0,this._viewport=null,this._zRange=null,this._selectedTiles=null,this._frameNumber=0,this._modelMatrix=new GR,this._modelMatrixInverse=new GR}get tiles(){return this._tiles}get selectedTiles(){return this._selectedTiles}get isLoaded(){return null!==this._selectedTiles&&this._selectedTiles.every(e=>e.isLoaded)}get needsReload(){return null!==this._selectedTiles&&this._selectedTiles.some(e=>e.needsReload)}setOptions(e){Object.assign(this.opts,e),Number.isFinite(e.maxZoom)&&(this._maxZoom=Math.floor(e.maxZoom)),Number.isFinite(e.minZoom)&&(this._minZoom=Math.ceil(e.minZoom))}finalize(){for(const e of this._cache.values())e.isLoading&&e.abort();this._cache.clear(),this._tiles=[],this._selectedTiles=null}reloadAll(){for(const e of this._cache.keys()){const t=this._cache.get(e);this._selectedTiles&&this._selectedTiles.includes(t)?t.setNeedsReload():this._cache.delete(e)}}update(e,{zRange:t,modelMatrix:n}={zRange:null,modelMatrix:null}){const r=n?new GR(n):new GR,o=!r.equals(this._modelMatrix);if(this._viewport&&e.equals(this._viewport)&&zI(this._zRange,t)&&!o)this.needsReload&&(this._selectedTiles=this._selectedTiles.map(e=>this._getTile(e.index,!0)));else{o&&(this._modelMatrixInverse=r.clone().invert(),this._modelMatrix=r),this._viewport=e,this._zRange=t;const n=this.getTileIndices({viewport:e,maxZoom:this._maxZoom,minZoom:this._minZoom,zRange:t,modelMatrix:this._modelMatrix,modelMatrixInverse:this._modelMatrixInverse});this._selectedTiles=n.map(e=>this._getTile(e,!0)),this._dirty&&this._rebuildTree()}const i=this.updateTileStates();return this._pruneRequests(),this._dirty&&this._resizeCache(),i&&this._frameNumber++,this._frameNumber}isTileVisible(e,t){if(!e.isVisible)return!1;if(t&&this._viewport){const n=this._getCullBounds({viewport:this._viewport,z:this._zRange,cullRect:t}),{bbox:r}=e;for(const[e,t,o,i]of n){let n;if("west"in r)n=r.west<o&&r.east>e&&r.south<i&&r.north>t;else{const s=Math.min(r.top,r.bottom),a=Math.max(r.top,r.bottom);n=r.left<o&&r.right>e&&s<i&&a>t}if(n)return!0}return!1}return!0}getTileIndices({viewport:e,maxZoom:t,minZoom:n,zRange:r,modelMatrix:o,modelMatrixInverse:i}){const{tileSize:s,extent:a,zoomOffset:l}=this.opts;return M3({viewport:e,maxZoom:t,minZoom:n,zRange:r,tileSize:s,extent:a,modelMatrix:o,modelMatrixInverse:i,zoomOffset:l})}getTileId(e){return`${e.x}-${e.y}-${e.z}`}getTileZoom(e){return e.z}getTileMetadata(e){const{tileSize:t}=this.opts;return{bbox:P3(this._viewport,e.x,e.y,e.z,t)}}getParentIndex(e){return{x:Math.floor(e.x/2),y:Math.floor(e.y/2),z:e.z-1}}updateTileStates(){const e=this.opts.refinementStrategy||D3,t=new Array(this._cache.size);let n=0;for(const r of this._cache.values())t[n++]=r.isVisible,r.isSelected=!1,r.isVisible=!1;for(const r of this._selectedTiles)r.isSelected=!0,r.isVisible=!0;("function"==typeof e?e:N3[e])(Array.from(this._cache.values())),n=0;for(const r of this._cache.values())if(t[n++]!==r.isVisible)return!0;return!1}_pruneRequests(){const{maxRequests:e=0}=this.opts,t=[];let n=0;for(const r of this._cache.values())r.isLoading&&(n++,r.isSelected||r.isVisible||t.push(r));for(;e>0&&n>e&&t.length>0;){t.shift().abort(),n--}}_rebuildTree(){const{_cache:e}=this;for(const t of e.values())t.parent=null,t.children&&(t.children.length=0);for(const t of e.values()){const e=this._getNearestAncestor(t);t.parent=e,e?.children&&e.children.push(t)}}_resizeCache(){const{_cache:e,opts:t}=this,n=t.maxCacheSize??(null!==t.maxCacheByteSize?1/0:5*this.selectedTiles.length),r=t.maxCacheByteSize??1/0;if(e.size>n||this._cacheByteSize>r){for(const[o,i]of e)if(i.isVisible||i.isSelected||(this._cacheByteSize-=null!==t.maxCacheByteSize?i.byteLength:0,e.delete(o),this.opts.onTileUnload?.(i)),e.size<=n&&this._cacheByteSize<=r)break;this._rebuildTree(),this._dirty=!0}this._dirty&&(this._tiles=Array.from(this._cache.values()).sort((e,t)=>e.zoom-t.zoom),this._dirty=!1)}_getTile(e,t){const n=this.getTileId(e);let r=this._cache.get(n),o=!1;return!r&&t?(r=new b2(e),Object.assign(r,this.getTileMetadata(r.index)),Object.assign(r,{id:n,zoom:this.getTileZoom(r.index)}),o=!0,this._cache.set(n,r),this._dirty=!0):r&&r.needsReload&&(o=!0),r&&o&&r.loadData({getData:this.opts.getTileData,requestScheduler:this._requestScheduler,onLoad:this.onTileLoad,onError:this.opts.onTileError}),r}_getNearestAncestor(e){const{_minZoom:t=0}=this;let n=e.index;for(;this.getTileZoom(n)>t;){n=this.getParentIndex(n);const e=this._getTile(n);if(e)return e}return null}},data:{type:"data",value:[]},dataComparator:C3.equal,renderSubLayers:{type:"function",value:e=>new l2(e)},getTileData:{type:"function",optional:!0,value:null},onViewportLoad:{type:"function",optional:!0,value:null},onTileLoad:{type:"function",value:e=>{}},onTileUnload:{type:"function",value:e=>{}},onTileError:{type:"function",value:e=>{}},extent:{type:"array",optional:!0,value:null,compare:!0},tileSize:512,maxZoom:null,minZoom:0,maxCacheSize:null,maxCacheByteSize:null,refinementStrategy:D3,zRange:null,maxRequests:6,debounceTime:0,zoomOffset:0};class G3 extends yD{initializeState(){this.state={tileset:null,isLoaded:!1}}finalizeState(){this.state?.tileset?.finalize()}get isLoaded(){return Boolean(this.state?.tileset?.selectedTiles?.every(e=>e.isLoaded&&e.layers&&e.layers.every(e=>e.isLoaded)))}shouldUpdateState({changeFlags:e}){return e.somethingChanged}updateState({changeFlags:e}){let{tileset:t}=this.state;const n=e.propsOrDataChanged||e.updateTriggersChanged,r=e.dataChanged||e.updateTriggersChanged&&(e.updateTriggersChanged.all||e.updateTriggersChanged.getTileData);t?n&&(t.setOptions(this._getTilesetOptions()),r?t.reloadAll():t.tiles.forEach(e=>{e.layers=null})):(t=new this.props.TilesetClass(this._getTilesetOptions()),this.setState({tileset:t})),this._updateTileset()}_getTilesetOptions(){const{tileSize:e,maxCacheSize:t,maxCacheByteSize:n,refinementStrategy:r,extent:o,maxZoom:i,minZoom:s,maxRequests:a,debounceTime:l,zoomOffset:c}=this.props;return{maxCacheSize:t,maxCacheByteSize:n,maxZoom:i,minZoom:s,tileSize:e,refinementStrategy:r,extent:o,maxRequests:a,debounceTime:l,zoomOffset:c,getTileData:this.getTileData.bind(this),onTileLoad:this._onTileLoad.bind(this),onTileError:this._onTileError.bind(this),onTileUnload:this._onTileUnload.bind(this)}}_updateTileset(){const e=this.state.tileset,{zRange:t,modelMatrix:n}=this.props,r=e.update(this.context.viewport,{zRange:t,modelMatrix:n}),{isLoaded:o}=e,i=this.state.isLoaded!==o,s=this.state.frameNumber!==r;o&&(i||s)&&this._onViewportLoad(),s&&this.setState({frameNumber:r}),this.state.isLoaded=o}_onViewportLoad(){const{tileset:e}=this.state,{onViewportLoad:t}=this.props;t&&t(e.selectedTiles)}_onTileLoad(e){this.props.onTileLoad(e),e.layers=null,this.setNeedsUpdate()}_onTileError(e,t){this.props.onTileError(e),t.layers=null,this.setNeedsUpdate()}_onTileUnload(e){this.props.onTileUnload(e)}getTileData(e){const{data:t,getTileData:n,fetch:r}=this.props,{signal:o}=e;return e.url="string"==typeof t||Array.isArray(t)?E3(t,e):null,n?n(e):r&&e.url?r(e.url,{propName:"data",layer:this,signal:o}):null}renderSubLayers(e){return this.props.renderSubLayers(e)}getSubLayerPropsByTile(e){return null}getPickingInfo(e){const t=e.sourceLayer,n=t.props.tile,r=e.info;return r.picked&&(r.tile=n),r.sourceTile=n,r.sourceTileSubLayer=t,r}_updateAutoHighlight(e){e.sourceTileSubLayer.updateAutoHighlight(e)}renderLayers(){return this.state.tileset.tiles.map(e=>{const t=this.getSubLayerPropsByTile(e);if(e.isLoaded||e.content)if(e.layers)t&&e.layers[0]&&Object.keys(t).some(n=>e.layers[0].props[n]!==t[n])&&(e.layers=e.layers.map(e=>e.clone(t)));else{const n=this.renderSubLayers({...this.props,...this.getSubLayerProps({id:e.id,updateTriggers:this.props.updateTriggers}),data:e.content,_offset:0,tile:e});e.layers=tM(n,Boolean).map(n=>n.clone({tile:e,...t}))}else;return e.layers})}filterSubLayer({layer:e,cullRect:t}){const{tile:n}=e.props;return this.state.tileset.isTileVisible(n,t)}}G3.defaultProps=H3,G3.layerName="TileLayer";const V3=new Map;function W3(e,t,n,r="roadmap",o){const i=e?.segments&&e.segments.length>0;if(!(e&&e.isSegmented&&i&&e.segments))return[];const s=e.segments.filter(e=>e.encoded_polyline).map(e=>{const n=e.encoded_polyline;let r=V3.get(n);if(!r)try{r=Sw(n).coordinates,V3.set(n,r)}catch{return null}return!r||r.length<2?null:{id:e.uuid,path:r,isHovered:t===e.uuid,isEnabled:!1!==e.is_enabled,order:e.segment_order||0}}).filter(Boolean);if(0===s.length)return[];s.sort((e,t)=>e.order-t.order);const a=e.segments,l=`${a.length}-${a.filter(e=>!1!==e.is_enabled).length}-${a[0]?.uuid||""}-${a[a.length-1]?.uuid||""}`,c=s0(r),u=e=>e.isHovered&&e.isEnabled?c.segmentHoverColor:e.isHovered&&!e.isEnabled?[120,120,120,255]:e.isEnabled?c.selectedRouteColor:[120,120,120,150],d=e=>e.isHovered&&e.isEnabled?9:e.isHovered&&!e.isEnabled?10:e.isEnabled?7:6,A=[],h=s.filter(e=>!e.isHovered),p=s.filter(e=>e.isHovered);if(h.length>0&&A.push({id:"selected-route-segments",layer:new J0({id:"selected-route-segments",data:h,getPath:e=>e.path,getColor:e=>u(e),getWidth:e=>d(e),widthUnits:"pixels",capRounded:!0,jointRounded:!0,pickable:!0,parameters:{depthTest:!1},widthMinPixels:4,updateTriggers:{getColor:[t,l],getWidth:[t,l]}}),visible:!0}),p.length>0&&A.push({id:"selected-route-segments-hovered",layer:new J0({id:"selected-route-segments-hovered",data:p,getPath:e=>e.path,getColor:e=>u(e),getWidth:e=>d(e),widthUnits:"pixels",capRounded:!0,jointRounded:!0,pickable:!0,parameters:{depthTest:!1},widthMinPixels:4,updateTriggers:{getColor:[t,l],getWidth:[t,l]}}),visible:!0}),void 0!==n&&s.length<=100){const o=[];if(h.forEach(t=>{if(t.path.length>=2){const r=e.segments?.find(e=>e.uuid===t.id),i=1e3*(r?.length??0),s=u(t),a=h2(t.path,n,{color:s,width:5,mode:"regular-layer"},i,{segment_id:t.id,is_enabled:t.isEnabled});o.push(...a)}}),o.length>0){const e=new l2({id:"selected-route-segments-arrows",data:{type:"FeatureCollection",features:o},getLineColor:e=>e.properties?.color||c.segmentHoverColor,getLineWidth:e=>e.properties?.width||5,lineWidthUnits:"pixels",lineWidthMinPixels:3,lineWidthMaxPixels:8,pickable:!1,updateTriggers:{data:[t,l,r]}});A.push({id:"selected-route-segments-arrows",layer:e,visible:!0})}const i=[];if(p.forEach(t=>{if(t.path.length>=2){const r=e.segments?.find(e=>e.uuid===t.id),o=1e3*(r?.length??0),s=u(t),a=h2(t.path,n,{color:s,width:5,mode:"regular-layer"},o,{segment_id:t.id,is_enabled:t.isEnabled});i.push(...a)}}),i.length>0){const e=new l2({id:"selected-route-segments-arrows-hovered",data:{type:"FeatureCollection",features:i},getLineColor:e=>e.properties?.color||c.segmentHoverColor,getLineWidth:e=>e.properties?.width||5,lineWidthUnits:"pixels",lineWidthMinPixels:3,lineWidthMaxPixels:8,pickable:!1,updateTriggers:{data:[t,l,r]}});A.push({id:"selected-route-segments-arrows-hovered",layer:e,visible:!0})}}const f=function(e,t="roadmap",n){if(!e?.segments||e.segments.length<2)return null;const r=[...e.segments].sort((e,t)=>(e.segment_order||0)-(t.segment_order||0)),o=[],i=e.distance||void 0;let s;const a=[];for(const _ of r)null!==_.length&&void 0!==_.length&&a.push(_.length);a.length>0&&(s=a.reduce((e,t)=>e+t,0)/a.length);let l=1/0,c=-1/0,u=1/0,d=-1/0;for(const _ of r){if(!_.encoded_polyline)continue;let e=V3.get(_.encoded_polyline);if(!e)try{e=Sw(_.encoded_polyline).coordinates,e&&V3.set(_.encoded_polyline,e)}catch{continue}if(e&&!(e.length<2))for(const t of e){const[e,n]=t;l=Math.min(l,e),c=Math.max(c,e),u=Math.min(u,n),d=Math.max(d,n)}}const A=n?Math.max(1,.5*(20-n)+1):5;let h=1;if(void 0!==i&&i>0)h=i<.5?.5:i<2?.5+(i-.5)/1.5*.25:i<10?.75+(i-2)/8*.25:i<50?1+(i-10)/40*.5:Math.min(2,1.5+(i-50)/50*.5);else{const e=c-l,t=d-u,n=Math.sqrt(e*e+t*t);h=Math.max(.5,Math.min(1.5,15*n))}let p=1;void 0!==s&&s>0&&(p=s<.05?.3:s<.1?.3+(s-.05)/.05*.2:s<.5?.5+(s-.1)/.4*.3:s<1?.8+(s-.5)/.5*.2:Math.min(1.2,1+(s-1)/1*.2));const f=A*h*p*Math.max(.8,Math.min(1.2,1))*3e-4;let g=1e-4;void 0!==n&&(g=360/(256*Math.pow(2,n))*9);const m=Math.max(g,f),y=r.filter(e=>!!e.encoded_polyline);if(y.length<2)return null;for(let _=0;_<y.length-1;_++){const e=y[_].encoded_polyline;let t=V3.get(e);if(!t)try{t=Sw(e).coordinates,V3.set(e,t)}catch(hee){continue}if(!t||t.length<2)continue;let n=null,r=null;const i=1e-5;for(let o=t.length-1;o>=1;o--){const e=t[o],s=t[o-1];if(!e||!Array.isArray(e)||e.length<2)continue;if(!s||!Array.isArray(s)||s.length<2)continue;if(!(Number.isFinite(e[0])&&Number.isFinite(e[1])&&Number.isFinite(s[0])&&Number.isFinite(s[1])))continue;const a=[e[0],e[1]],l=[s[0],s[1]],c=a[0]-l[0],u=a[1]-l[1];if(Math.sqrt(c*c+u*u)>=i){n=a,r=l;break}}if(!n||!r)continue;const s=n[0]-r[0],a=n[1]-r[1],l=Math.sqrt(s*s+a*a),c=-a/l,u=s/l,d=[n[0]-c*m*.5,n[1]-u*m*.5],A=[n[0]+c*m*.5,n[1]+u*m*.5];Number.isFinite(d[0])&&Number.isFinite(d[1])&&Number.isFinite(A[0])&&Number.isFinite(A[1])&&o.push({path:[d,A]})}if(0===o.length)return null;const v=void 0!==n?Math.max(1,Math.min(6,.5*(n-10)+1)):2;let b=1;void 0!==s&&s>0&&(b=s<.05?.7:s<.1?.7+(s-.05)/.05*.2:s<.5?.9+(s-.1)/.4*.2:s<1?1.1+(s-.5)/.5*.2:s<5?1.3+(s-1)/4*.2:Math.min(1.8,1.5+(s-5)/5*.3));let w=1;void 0!==i&&i>0&&(w=i<2?.9:i<50?1:i<100?1+(i-50)/50*.2:Math.min(1.4,1.2+(i-100)/100*.2));const x=Math.max(1,Math.min(6,v*b*w));return{id:"selected-route-segments-boundaries",layer:new J0({id:"selected-route-segments-boundaries",data:o,getPath:e=>e.path,getColor:[255,43,139,255],getWidth:x,widthUnits:"pixels",widthMinPixels:1,stroked:!1,pickable:!1,parameters:{depthTest:!1},updateTriggers:{getWidth:[n,i,s],getPath:[n,e?.segments?.length,i,s]}}),visible:!0}}(e,r,n);return f&&A.push(f),A}function $3(e,t,n,r,o,i="roadmap",s){if(!t||!e)return[];const a=[],l=function(e){if(!e)return null;const t=Sw(e.encodedPolyline);return{id:"original-route-dimmed",layer:new l2({id:"original-route-dimmed",data:{type:"FeatureCollection",features:[{type:"Feature",geometry:{type:"LineString",coordinates:t.coordinates},properties:{}}]},getLineColor:[0,0,0,0],getLineWidth:2,stroked:!1,pickable:!1}),visible:!0}}(e,i);l&&a.push(l);const{nonHovered:c,hovered:u}=function(e,t,n,r="roadmap"){if(0===e.length)return{nonHovered:null,hovered:null};const o=e.map(e=>{const r=e.linestringGeoJson;return!r?.coordinates||r.coordinates.length<2?null:{id:e.id,path:r.coordinates,isHovered:t===e.id,isSelected:n.has(e.id)}}).filter(Boolean);if(0===o.length)return{nonHovered:null,hovered:null};const i=s0(r),s=e=>e.isSelected&&e.isHovered?i.segmentHoverColor:e.isSelected&&!e.isHovered?[i.individualPreviewColor[0],i.individualPreviewColor[1],i.individualPreviewColor[2],220]:[150,150,150,120],a=e=>e.isHovered?9:7,l=[Array.from(n).sort().join(","),t].join("|"),c=o.filter(e=>!e.isHovered),u=o.filter(e=>e.isHovered),d=c.length>0?{id:"preview-segments",layer:new J0({id:"preview-segments",data:c,getPath:e=>e.path,getColor:e=>s(e),getWidth:e=>a(e),widthUnits:"pixels",capRounded:!0,jointRounded:!0,pickable:!0,parameters:{depthTest:!1},widthMinPixels:4,updateTriggers:{getColor:[l],getWidth:[l]}}),visible:!0}:null,A=u.length>0?{id:"preview-segments-hovered",layer:new J0({id:"preview-segments-hovered",data:u,getPath:e=>e.path,getColor:e=>s(e),getWidth:e=>a(e),widthUnits:"pixels",capRounded:!0,jointRounded:!0,pickable:!0,parameters:{depthTest:!1},widthMinPixels:4,updateTriggers:{getColor:[l],getWidth:[l]}}),visible:!0}:null;if(0===u.length&&o.length>0)return{nonHovered:{id:"preview-segments",layer:new J0({id:"preview-segments",data:o,getPath:e=>e.path,getColor:e=>s(e),getWidth:e=>a(e),widthUnits:"pixels",capRounded:!0,jointRounded:!0,pickable:!0,parameters:{depthTest:!1},widthMinPixels:4,updateTriggers:{getColor:[l],getWidth:[l]}}),visible:!0},hovered:null};return{nonHovered:d,hovered:A}}(n,r,o,i);c&&a.push(c),u&&a.push(u);const d=$N.getState().segmentation,A=function(e,t="roadmap",n,r,o){if(0===e.length)return null;const i=[],s=e=>[e[0],e[1]];let a=1/0,l=-1/0,c=1/0,u=-1/0;for(const B of e){const e=B.linestringGeoJson?.coordinates||[];if(!(e.length<2))for(const t of e){const[e,n]=s(t);a=Math.min(a,e),l=Math.max(l,e),c=Math.min(c,n),u=Math.max(u,n)}}const d=7,A=n?Math.max(1,.5*(20-n)+1):5;let h=1;if(void 0!==r&&r>0)h=r<.5?.5:r<2?.5+(r-.5)/1.5*.25:r<10?.75+(r-2)/8*.25:r<50?1+(r-10)/40*.5:Math.min(2,1.5+(r-50)/50*.5);else{const e=l-a,t=u-c,n=Math.sqrt(e*e+t*t);h=Math.max(.5,Math.min(1.5,15*n))}let p=1;void 0!==o&&o>0&&(p=o<.05?.3:o<.1?.3+(o-.05)/.05*.2:o<.5?.5+(o-.1)/.4*.3:o<1?.8+(o-.5)/.5*.2:Math.min(1.2,1+(o-1)/1*.2));const f=Math.max(.8,Math.min(1.2,d/7)),g=A*h*p*f*3e-4,m=4;let y=1e-4;if(void 0!==n){y=360/(256*Math.pow(2,n))*(m+5)}const v=Math.max(y,g);for(let B=0;B<e.length-1;B++){const t=e[B],n=e[B+1],r=t.linestringGeoJson?.coordinates||[],o=n.linestringGeoJson?.coordinates||[];if(r.length<2||o.length<2)continue;const a=s(r[r.length-1]),l=s(r[r.length-2]),c=a[0]-l[0],u=a[1]-l[1],d=Math.sqrt(c*c+u*u)||1,A=-u/d,h=c/d,p=[a[0]-A*v*.5,a[1]-h*v*.5],f=[a[0]+A*v*.5,a[1]+h*v*.5];i.push({path:[p,f]})}if(0===i.length)return null;const b=1,w=6,x=void 0!==n?Math.max(b,Math.min(w,.5*(n-10)+b)):2;let _=1;void 0!==o&&o>0&&(_=o<.05?.7:o<.1?.7+(o-.05)/.05*.2:o<.5?.9+(o-.1)/.4*.2:o<1?1.1+(o-.5)/.5*.2:o<5?1.3+(o-1)/4*.2:Math.min(1.8,1.5+(o-5)/5*.3));let C=1;void 0!==r&&r>0&&(C=r<2?.9:r<50?1:r<100?1+(r-50)/50*.2:Math.min(1.4,1.2+(r-100)/100*.2));const S=Math.max(1,Math.min(w,x*_*C)),E=new J0({id:"segmentation-boundaries",data:i,getPath:e=>e.path,getColor:[255,43,139,255],getWidth:S,widthUnits:"pixels",widthMinPixels:1,stroked:!1,pickable:!1,parameters:{depthTest:!1},updateTriggers:{getWidth:[n,r,o],getPath:[n,e.length,r,o]}});return{id:"segmentation-boundaries",layer:E,visible:!0}}(n,i,s,d.calculatedRouteLengthKm,d.distanceKm);return A&&a.push(A),a}function K3(e){const t=JN(e=>e.mapMode),n=JN(e=>e.mapType),r=JN(e=>e.selectedRoute),o=JN(e=>e.showSelectedRouteSegments),i=JN(e=>e.addRoute),s=JN(e=>e.setSelectedRoute),a=JN(e=>e.projectData),l=a?.boundaryGeoJson,c=a?.id,u=$N(e=>e.roadSelection),d=$N(e=>e.roadImport),A=$N(e=>e.individualRoute),h=$N(e=>e.lassoDrawing),p=$N(e=>e.segmentation),f=$N(e=>e.uploadedRoutes),g=$N(e=>e.snappedRoads),m=$N(e=>e.hoveredFeature),y=$N(e=>e.currentZoom),v=$N(e=>e.showTileLayerArrows),b=$N(e=>e.selectedRouteHoveredSegmentId),w=$N(e=>e.selectedUploadedRouteId),x=$N(e=>e.roadsTilesTimestamp),_=$N(e=>e.routesTilesTimestamp),C=$N(e=>e.refreshTrigger),S=$N(e=>e.routesTileCache),E=$N(e=>e.selectedRoadPriorities),B=Lj(e=>e.routeColorMode),I=$N(e=>e.layerVisibility??{}),R=pe.useCallback(async e=>{let t=JN.getState().routes.find(t=>t.id===e);if(!t)try{const n=await wj.getById(e);if(!n.success||!n.data)return;i(n.data),t=n.data}catch(n){return}t&&s(t.id)},[i,s]),k=JN(e=>{if(!e.selectedRoute?.segments||0===e.selectedRoute.segments.length)return null;const t=e.selectedRoute.segments;return`${t.length}-${t.filter(e=>!1!==e.is_enabled).length}-${t[0]?.uuid||""}-${t[t.length-1]?.uuid||""}`}),T=pe.useMemo(()=>{const i=[],s=[],a=[],c=function(e,t="roadmap"){if(!e)return null;let n=null;if("FeatureCollection"===e.type){const t=e;if(!(t.features&&t.features.length>0&&"Polygon"===t.features[0].geometry?.type))return null;n=t.features[0].geometry}else if("Feature"===e.type){const t=e;if("Polygon"!==t.geometry?.type)return null;n=t.geometry}else{if("Polygon"!==e.type)return null;n=e}if(!n||!n.coordinates||0===n.coordinates.length)return null;const r={type:"Feature",geometry:n,properties:{type:"jurisdiction_boundary"}},o=s0(t);return{id:"jurisdiction-boundary",layer:new l2({id:"jurisdiction-boundary",data:{type:"FeatureCollection",features:[r]},getLineColor:o.jurisdictionBoundaryColor,getFillColor:[0,0,0,0],getLineWidth:4,lineWidthMinPixels:4,pickable:!1,filled:!0,parameters:{depthTest:!1}}),visible:!0}}(l,n);if(c&&i.push(c),"road_selection"!==t){const t=function(e,t,n,r,o,i,s,a="sync_status",l="roadmap"){if(!e)return null;try{const c=new G3({id:`saved-routes-tile-t${t}`,getTileData:async n=>{const{index:o}=n;if(!o||"number"!=typeof o.x||"number"!=typeof o.y||"number"!=typeof o.z)return null;const{x:i,y:s,z:a}=o,l=`${a}/${i}/${s}`;if(r.has(l))return r.get(l);try{const n=`/tiles/routes/${a}/${i}/${s}.geojson?project_id=${e}&t=${t}`,o=await fetch(n);if(!o.ok)return null;const c=await o.json();return c&&c.features?(r.set(l,c),c):null}catch(c){return null}},minZoom:4,maxZoom:10,pickable:!0,autohighlight:!1,updateTriggers:{getLineColor:[n,i,a,l],getLineWidth:[n,i],getTooltip:n},renderSubLayers:e=>{const{data:t,tile:n}=e;if(!t?.features?.length)return null;const r=[],c=i??n?.index?.z??0,u=s0(l),d=e=>{switch(e){case"unsynced":default:return u.routeStatusColors.unsynced;case"validating":return u.routeStatusColors.validating;case"synced":return u.routeStatusColors.synced;case"invalid":return u.routeStatusColors.invalid;case"failed":return u.routeStatusColors.failed}},A=e=>{switch(e){case"NORMAL":return[0,255,0,255];case"SLOW":default:return[242,164,53,255];case"TRAFFIC_JAM":return[255,0,0,255]}};for(const o of t.features){const e={...o,properties:{...o.properties,featureType:"route",displayName:o.properties?.name||o.properties?.display_name||"Unknown Route",hasTrafficData:!(!o.properties?.current_duration_seconds&&!o.properties?.current_duration_in_seconds||!o.properties?.static_duration_seconds&&!o.properties?.static_duration_in_seconds||!o.properties?.traffic_status),static_duration_seconds:o.properties?.static_duration_seconds||o.properties?.static_duration_in_seconds,current_duration_seconds:o.properties?.current_duration_seconds||o.properties?.current_duration_in_seconds,traffic_status:o.properties?.traffic_status,synced_at:o.properties?.synced_at,sync_status:o.properties?.sync_status||o.properties?.status||"unsynced",latest_data_updated_time:o.properties?.latest_data_updated_time||o.properties?.retrieval_time||o.properties?.last_updated_at}};if(r.push(e),"LineString"===o.geometry?.type&&o.geometry.coordinates.length>=2){const e=o.properties?.sync_status||o.properties?.status||"unsynced",t=1e3*(o.properties?.length??0)||(o.properties?.distance??0)||0;if(t>0){const n=o.properties?.traffic_status,i="sync_status"===a?d(e):A(n),l=h2(o.geometry.coordinates,c,{color:i,width:4,mode:"tile-layer",minZoom:iN},t,{type:"direction_arrow",status:e,sync_status:e,traffic_status:n},s);r.push(...l)}}}const h={...t,features:r};return new l2({...e,id:`${e.id}-geojson`,data:h,stroked:!1,filled:!0,lineWidthMinPixels:3,pickable:!0,autohighlight:!1,highlightColor:[255,255,255,255],lineWidthUnits:"pixels",lineJointRounded:!0,lineCapRounded:!0,lineMiterLimit:2,getLineColor:e=>{if("direction_arrow"===e.properties?.type){const t=e.properties?.sync_status||"unsynced",n=e.properties?.traffic_status;return"sync_status"===a?d(t):A(n)}if("sync_status"===a){const t=e.properties?.sync_status||"unsynced";return d(t)}{const t=e.properties?.traffic_status;return A(t)}},getLineWidth:e=>(e.properties,4),onClick:o?async({object:e})=>{e?.properties?.id&&o(e.properties.id)}:void 0})}});return{id:`saved-routes-tile-t${t}`,layer:c,visible:!0}}catch(c){return null}}(e,_,C,S,R,y,v,B,n);t&&i.push(t)}if("road_selection"!==t)if(o){if(!p.isActive){const e=W3(r,b,y,n);if(e&&e.length>0){const t=e.find(e=>"selected-route-segments-boundaries"===e.id),n=e.filter(e=>"selected-route-segments-hovered"!==e.id&&"selected-route-segments-arrows-hovered"!==e.id&&"selected-route-segments-boundaries"!==e.id),r=e.filter(e=>"selected-route-segments-hovered"===e.id||"selected-route-segments-arrows-hovered"===e.id);i.push(...n),r.length>0&&s.push(...r),t&&a.push(t)}}}else{const e=function(e,t,n="roadmap"){if(!e)return null;let r=[];if(e.encodedPolyline)if("string"==typeof e.encodedPolyline)try{const t=JSON.parse(e.encodedPolyline);r=Array.isArray(t)&&t.length>1&&Array.isArray(t[0])&&"number"==typeof t[0][0]?t:Sw(e.encodedPolyline).coordinates}catch(a){r=Sw(e.encodedPolyline).coordinates}else Array.isArray(e.encodedPolyline)&&Array.isArray(e.encodedPolyline[0])&&"number"==typeof e.encodedPolyline[0][0]&&(r=e.encodedPolyline);if(r.length<2)return null;const o={data:[{id:e.id,path:r}],getPath:e=>e.path,widthUnits:"pixels",capRounded:!0,jointRounded:!0,pickable:!1,parameters:{depthTest:!1}},i=s0(n),s=[new J0({...o,id:"selected-route-border",getColor:i.pathBorderColor,getWidth:11.200000000000001,widthMinPixels:Math.max(11.200000000000001,2)}),new J0({...o,id:"selected-route-main",getColor:i.selectedRouteColor,getWidth:7,widthMinPixels:7})];if(void 0!==t){const n=1e3*(e.distance??0),o=h2(r,t,{color:i.selectedRouteColor,width:5,mode:"regular-layer"},n,{route_id:e.id});if(o.length>0){const e=new l2({id:"selected-route-arrows",data:{type:"FeatureCollection",features:o},getLineColor:e=>e.properties?.color||i.selectedRouteColor,getLineWidth:e=>e.properties?.width||5,lineWidthUnits:"pixels",lineWidthMinPixels:3,lineWidthMaxPixels:8,pickable:!1});s.push(e)}}return{id:"selected-route",layer:s,visible:!0}}(r,y,n);e&&i.push(e)}if(!p.isActive||0===p.previewSegments.length){const e=function(e,t="roadmap"){if(!e?.encodedPolyline)return null;let n=[];if("string"==typeof e.encodedPolyline)try{const t=JSON.parse(e.encodedPolyline);n=Array.isArray(t)&&t.length>1&&Array.isArray(t[0])&&"number"==typeof t[0][0]?t:Sw(e.encodedPolyline).coordinates}catch{n=Sw(e.encodedPolyline).coordinates}else Array.isArray(e.encodedPolyline)&&Array.isArray(e.encodedPolyline[0])&&"number"==typeof e.encodedPolyline[0][0]&&(n=e.encodedPolyline);if(n.length<2)return null;const r={data:[{id:e.id,path:n}],getPath:e=>e.path,widthUnits:"pixels",capRounded:!0,jointRounded:!0,pickable:!1,parameters:{depthTest:!1}},o=s0(t).individualPreviewColor;return{id:"individual-preview",layer:[new J0({...r,id:"individual-preview-main",getColor:o,getWidth:7,widthMinPixels:7})],visible:!0}}(A.generatedRoute,n);e&&i.push(e)}if("lasso_selection"===t&&h.selectedRoads.length>0){const e=function(e,t){if(!e||0===e.length)return null;const n=e.map(e=>{const t=f2(e),n=t?.coordinates;return!n||n.length<2?null:{id:e.id,path:n}}).filter(e=>Boolean(e));if(0===n.length)return null;const r=[new J0({id:"lasso-selected-roads",data:n,getPath:e=>e.path,getColor:[16,185,129,220],getWidth:5,stroked:!1,widthUnits:"pixels",pickable:!1,parameters:{depthTest:!1},capRounded:!0,jointRounded:!0})];if(void 0!==t){const e=[];if(n.forEach(n=>{if(n.path.length>=2){const r=h2(n.path,t,{color:[16,185,129,220],width:5,mode:"regular-layer"},void 0,{road_id:n.id});e.push(...r)}}),e.length>0){const t=new l2({id:"lasso-selected-roads-arrows",data:{type:"FeatureCollection",features:e},getLineColor:e=>e.properties?.color||[16,185,129,220],getLineWidth:e=>e.properties?.width||5,lineWidthMinPixels:3,pickable:!1});r.push(t)}}return{id:"lasso-selected-roads",layer:r,visible:!0}}(h.selectedRoads,y,n);e&&i.push(e)}if(u.highlightedRoads.length>0){const e=function(e,t,n="roadmap"){if(!e||0===e.length)return null;const r=e.map(e=>{const t=f2(e);return t&&"LineString"===t.type?{type:"Feature",geometry:t,properties:{id:e?.id?.toString()}}:null}).filter(e=>Boolean(e));if(0===r.length)return null;const o=r.map(e=>{const t=e.geometry;return!t?.coordinates||t.coordinates.length<2?null:{id:e.properties?.id,path:t.coordinates}}).filter(Boolean);if(0===o.length)return null;const i={data:o,getPath:e=>e.path,widthUnits:"pixels",capRounded:!0,jointRounded:!0,pickable:!1,parameters:{depthTest:!1}},s=s0(n),a=[{id:"road-selection-highlight",layer:[new J0({...i,id:"road-selection-highlight-border",getColor:s.pathBorderColor,getWidth:11.200000000000001,widthMinPixels:Math.max(11.200000000000001,2)}),new J0({...i,id:"road-selection-highlight-main",getColor:s.roadSelectionColor,getWidth:7,widthMinPixels:7})],visible:!0}];if(void 0!==t){const n=[];if(e.forEach(e=>{const r=e.linestringGeoJson?.coordinates||[];if(r.length>=2){const o=1e3*(e.distanceKm??0),i=h2(r,t,{color:s.roadSelectionColor,width:4,mode:"regular-layer"},o,{road_id:e.id});n.push(...i)}}),n.length>0){const e=new l2({id:"road-selection-arrows",data:{type:"FeatureCollection",features:n},getLineColor:e=>e.properties?.color||s.roadSelectionColor,getLineWidth:e=>e.properties?.width||4,lineWidthUnits:"pixels",lineWidthMinPixels:3,lineWidthMaxPixels:8,pickable:!1});a.push({id:"road-selection-arrows",layer:e,visible:!0})}}return a}(u.highlightedRoads,y,n);e&&(Array.isArray(e)?i.push(...e):i.push(e))}const x="editing_uploaded_route"===t,E=function(e,t,n,r="roadmap"){if(0===e.length)return null;const o=[],i=[];e.forEach(e=>{e.name.includes("(Original)")?o.push(e):i.push(e)});const s=t?i.filter(e=>e.id===t):o;if(0===s.length)return null;const a=[];s.forEach(e=>{if("FeatureCollection"===e.data.type)e.data.features.forEach(t=>{const n=t.properties||{},r="number"==typeof n["distance in meters"]?n["distance in meters"]:0;a.push({...t,properties:{...n,length:r/1e3,uploadedRouteId:e.id,uploadedRouteName:e.name,uploadedRouteType:e.type,uploadedRouteColor:e.color}})});else{const t=e.data.properties||{},n="number"==typeof t["distance in meters"]?t["distance in meters"]:0;a.push({...e.data,properties:{...t,length:n/1e3,uploadedRouteId:e.id,uploadedRouteName:e.name,uploadedRouteType:e.type,uploadedRouteColor:e.color}})}});const l=[];if(a.length>0){const e=new l2({id:"uploaded-routes-selected",data:{type:"FeatureCollection",features:a},getLineColor:e=>{const t=e.properties.uploadedRouteColor,n=s0(r);return t||n.uploadedRouteColor},getLineWidth:()=>10,lineWidthMinPixels:3,lineWidthMaxPixels:10,getFillColor:e=>{const t=e.properties.uploadedRouteColor;if(t)return[t[0],t[1],t[2],60];const n=s0(r);return[n.uploadedRouteColor[0],n.uploadedRouteColor[1],n.uploadedRouteColor[2],60]},filled:!0,stroked:!1,pickable:!0,autoHighlight:!1,highlightColor:s0(r).uploadedRouteColor});l.push({id:"uploaded-routes-selected",layer:e,visible:n})}return l.length>0?l:null}(x&&w?f.routes.filter(e=>e.id===w):f.routes,w,f.isVisible,n);if(E)if(Array.isArray(E)){const e=E.filter(e=>"uploaded-routes-selected"!==e.id),t=E.filter(e=>"uploaded-routes-selected"===e.id);i.push(...e),i.push(...t)}else i.push(E);const k=function(e,t,n,r,o="roadmap"){if(0===e.length)return null;const i=[],s=[];e.forEach(e=>{const n=e.uploadedRouteId===t,r={...e.feature,properties:{...e.feature.properties,snappedRoadId:e.id,uploadedRouteId:e.uploadedRouteId}};n?s.push(r):i.push(r)});const a=[];if(i.length>0){const e=new l2({id:"snapped-roads",data:{type:"FeatureCollection",features:i},getLineColor:e=>{const t=s0(o),r=e.properties?.uploadedRouteId;return r===n?t.segmentHoverColor:t.polygonRouteColor},getLineWidth:e=>{const t=e.properties?.uploadedRouteId;return t===n?8:4},updateTriggers:{getLineColor:[n,o],getLineWidth:[n,o]},stroked:!1,lineWidthMinPixels:2,lineWidthMaxPixels:12,pickable:!1,autohighlight:!1,highlightColor:(()=>{const e=s0(o);return[e.polygonRouteColor[0],e.polygonRouteColor[1],e.polygonRouteColor[2],200]})()});a.push({id:"snapped-roads",layer:e,visible:r})}if(s.length>0){const e=new l2({id:"snapped-roads-selected",data:{type:"FeatureCollection",features:s},getLineColor:()=>s0(o).polygonRouteColor,getLineWidth:()=>4,lineWidthMinPixels:3,lineWidthMaxPixels:12,pickable:!0,stroked:!1,autohighlight:!1,highlightColor:(()=>{const e=s0(o);return[e.polygonRouteColor[0],e.polygonRouteColor[1],e.polygonRouteColor[2],200]})()});a.push({id:"snapped-roads-selected",layer:e,visible:r})}return a.length>0?a:null}(x&&w?(()=>{const e=g.previewRoads.filter(e=>e.uploadedRouteId===w);return e.length>0?e:g.roads.filter(e=>e.uploadedRouteId===w)})():g.roads,w,g.hoveredRouteId,g.isVisible,n);if(k)if(Array.isArray(k)){const e=k.filter(e=>"snapped-roads-selected"!==e.id),t=k.filter(e=>"snapped-roads-selected"===e.id);x||i.push(...e),i.push(...t)}else i.push(k);const T=$3(p.targetRoute,p.isActive,p.previewSegments,p.hoveredSegmentId,p.selectedSegmentIds,n,y);if(T.length>0){const e=T.find(e=>"preview-segments-hovered"===e.id),t=T.filter(e=>"preview-segments-hovered"!==e.id);i.push(...t),e&&s.push(e)}if(d.importedRoads||d.importedPolygon){const e=$N.getState().selectedRoadPriorities,t=v2(d.importedRoads,d.importedPolygon,d,y,e,n);i.push(...t)}const P=e=>e.startsWith("saved-routes-tile-t")?"saved-routes-tile":e.startsWith("roads-network-tile-t")?"roads-network-tile":"uploaded-routes-selected"===e?"uploaded-routes":"snapped-roads-selected"===e?"snapped-roads":e.startsWith("imported-roads-")?"imported-roads":"selected-route-segments"===e?"selected-route-segments":"selected-route-segments-boundaries"===e?"selected-route-segments-boundaries":"selected-route-segments-hovered"===e?"selected-route-segments-hovered":"segmentation-boundaries"===e?"segmentation-boundaries":"preview-segments"===e?"preview-segments":e.startsWith("selected-route-")?"selected-route":e,F=i.filter(e=>null!=e).filter(e=>{if(!1===e.visible)return!1;if(I){const t=P(e.id),n=I[t];if(void 0!==n)return n}return!0}).flatMap(e=>Array.isArray(e.layer)?e.layer:[e.layer]);if("view"===t&&(y??0)>=14&&m){const e=function(e,t,n="roadmap"){if(!e||!e.polyline||e.polyline.length<2)return null;const r=e.layerId.includes("route")||e.layerId.includes("uploaded-routes")||e.layerId.includes("-geojson"),o=s0(n),i=r?o.segmentHoverColor:"hybrid"===n?[0,122,255,255]:[0,0,255,255],s=[new J0({id:"feature-hover-highlight",data:[{id:"hovered-feature",path:e.polyline}],getPath:e=>e.path,getColor:i,getWidth:8,widthUnits:"pixels",pickable:!1,parameters:{depthTest:!1},capRounded:!0,jointRounded:!0})];if(void 0!==t){const n=h2(e.polyline,t,{color:i,width:8,mode:"regular-layer"},void 0);if(n.length>0){const e=new l2({id:"feature-hover-highlight-arrows",data:{type:"FeatureCollection",features:n},getLineColor:e=>e.properties?.color||i,getLineWidth:e=>e.properties?.width||8,lineWidthMinPixels:3,lineWidthMaxPixels:8,pickable:!1});s.push(e)}}return{id:"feature-hover-highlight",layer:s,visible:!0}}(m,y,n);if(e){const t=Array.isArray(e.layer)?e.layer:[e.layer];F.push(...t)}}if(a.length>0){const e=a.filter(e=>null!=e).filter(e=>{if(!1===e.visible)return!1;if(I){const t=P(e.id),n=I[t];if(void 0!==n)return n}return!0}).flatMap(e=>Array.isArray(e.layer)?e.layer:[e.layer]);F.push(...e)}if(s.length>0){const e=s.filter(e=>null!=e).filter(e=>!1!==e.visible).flatMap(e=>Array.isArray(e.layer)?e.layer:[e.layer]);F.push(...e)}return F},[e,n,x,_,C,S,E,o,r,k,b,A.generatedRoute,h.selectedRoads,t,u.highlightedRoads,f.routes,f.isVisible,w,g.roads,g.previewRoads,g.isVisible,g.hoveredRouteId,p.targetRoute,p.isActive,p.previewSegments,p.hoveredSegmentId,p.selectedSegmentIds,m,v,R,c,I,B,d.importedRoads,d.importedPolygon,d.panelRoutes.length,d.hoveredRoadId,d.selectionMode,d.lassoFilteredRoadIds?.length,d.lassoSelectedPriorities,y]);return T}const X3=()=>{const e=JN(e=>e.setMapMode),t=JN(e=>e.setLeftPanelExpanded),n=JN(e=>e.setRoadPriorityPanelOpen),r=$N(e=>e.finishPolygonDrawing),o=$N(e=>e.isLassoComplete),i=$N(e=>e.lassoDrawing),s=$N(e=>e.finishLassoDrawing),a=$N(e=>e.clearLassoDrawing),l=$N(e=>e.clearAllDrawing),c=$N(e=>e.terraDrawFinish),u=$N(e=>e.setImportedRoads),d=$N(e=>e.roadImport),A=$N(e=>e.setLassoFilteredRoads),h=(()=>{const e=ye();return Ee({mutationFn:async e=>{const t=await fetch("/polygon/ingest",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});if(!t.ok){const e=await t.json().catch(()=>({}));throw new Error(e.detail||`HTTP ${t.status}: ${t.statusText}`)}return t.json()},onSuccess:(t,n)=>{e.invalidateQueries({queryKey:eX.roadsNetwork(n.project_id.toString())}),e.invalidateQueries({queryKey:eX.polygons(n.project_id.toString())}),(0,$N.getState().refreshRoadsTilesTimestamp)()}})})(),[p,f]=pe.useState(!1),[g,m]=pe.useState(null),y=()=>{const e=$N.getState().lassoDrawing,t=$N.getState().roadImport;if(!e.completedPolygon||!t.importedRoads)return;const n=$N.getState().selectedRoadPriorities;let r=t.importedRoads;if(n&&n.length>0&&n.length<WD.length){const e=t.importedRoads.features.filter(e=>{const t=e.properties?.priority;return t&&n.includes(t)});r={...t.importedRoads,features:e}}const o=function(e,t){if(!e||!e.features||!t)return[];const n=[];for(const r of e.features){if("LineString"!==r.geometry.type)continue;const e=r.properties?.road_id?.toString();if(!e)continue;const o=pb(r.geometry.coordinates),i=hb(t.coordinates);Zb(o,i)?n.push(e):r.geometry.coordinates.some(e=>xb(Ab(e),i))&&n.push(e)}return n}(r,e.completedPolygon);if(o.length>0)A(o),$N.getState().addLassoFilteredRoadsToPanel(),a();else{Fw("No roads found in the selected area"),a();const e=$N.getState().terraDrawInstance;if(e)try{e.clear()}catch(i){}}},v=async(t,r)=>{const o=r||g;if(o)try{const r=o.coordinates.map(([e,t])=>({latitude:t,longitude:e})),s=await h.mutateAsync({project_id:o.projectId,polygon_name:o.polygonName,priority_type:t,geometry:{coordinates:r}}),a=s.roads_skipped||0,c=s.total_roads||0,d=s.roads_of_required_priority||0;if(0===d&&0===c){const e=$N.getState().terraDrawInstance;if(e)try{e.clear()}catch(i){}return l(),m(null),f(!1),n(!1),Fw("No roads were found in the selected area. Please try a different location."),void $N.getState().hideDrawingCompletionMenu()}const A=`${d} road${1!==d?"s":""} ingested successfully`;let p;if(a>0?p=`${a} road${1!==a?"s":""} filtered out by priority from ${c} total`:c>d&&(p=`Out of ${c} total road${1!==c?"s":""}`),Tw(A,{description:p}),s.geojson_feature_collection){const t=s.geojson_feature_collection.features||[],r=t.find(e=>"Polygon"===e.geometry.type),o=t.filter(e=>"LineString"===e.geometry.type);if(r&&"Polygon"===r.geometry.type){if(0===o.length){const e=$N.getState().terraDrawInstance;if(e)try{e.clear()}catch(i){}return l(),m(null),f(!1),n(!1),Fw("No roads were found in the selected area. Please try a different location."),void $N.getState().hideDrawingCompletionMenu()}u({type:"FeatureCollection",features:o},r.geometry),l(),m(null),m(null),f(!1),n(!1),e("road_selection"),$N.getState().setSelectionMode("single"),$N.getState().hideDrawingCompletionMenu()}else Pw("Failed to extract polygon from response"),l(),m(null),e("view"),$N.getState().hideDrawingCompletionMenu()}else Pw("Invalid response format"),l(),m(null),e("view"),$N.getState().hideDrawingCompletionMenu()}catch(i){const e=i instanceof Error?i.message:"Failed to ingest polygon";if(e.toLowerCase().includes("no roads found")||e.toLowerCase().includes("no roads found within")){const e=$N.getState().terraDrawInstance;if(e)try{e.clear()}catch(s){}l(),m(null),f(!1),n(!1),Fw("No roads were found in the selected area. Please try a different location.")}else Pw(e);$N.getState().hideDrawingCompletionMenu()}};return{isPolygonComplete:()=>$N.getState().polygonDrawing.points.length>=3,isLassoComplete:o(),isIngesting:h.isPending,priorityDialogOpen:p,handlePolygonDone:async()=>{const e=$N.getState().polygonDrawing;if(!(e.points.length>=3))throw Pw("Polygon is not complete. Please ensure you have at least 3 points."),$N.getState().hideDrawingCompletionMenu(),new Error("Polygon not complete");try{const{projectData:t}=JN.getState();if(!t)throw Pw("No project data available"),$N.getState().hideDrawingCompletionMenu(),new Error("No project data available");const n=e.points,o=n.length>0&&n[0][0]===n[n.length-1][0]&&n[0][1]===n[n.length-1][1]?n:[...n,n[0]],i=t?.boundaryGeoJson;if(i){if(!n.every(e=>{const[t,n]=e;return Ew(n,t,i)}))throw Pw("All polygon points must be within the jurisdiction boundary. Please adjust the polygon."),$N.getState().hideDrawingCompletionMenu(),new Error("Polygon points outside boundary")}r();const s={projectId:parseInt(t.id),polygonName:`Polygon ${Date.now()}`,coordinates:o};m(s),await v([...WD],s)}catch(t){const e=t instanceof Error?t.message:"Failed to prepare polygon";throw Pw(e),$N.getState().hideDrawingCompletionMenu(),t}},handleLassoDone:()=>{if(o()){c&&c();"road_selection"===JN.getState().mapMode&&"lasso"===d.selectionMode?i.points.length>0&&(s(),setTimeout(()=>{y()},0)):(i.points.length>0&&(s(),setTimeout(()=>{t(!0)},100)),window.dispatchEvent(new KeyboardEvent("keyup",{key:"Enter"})))}},handlePriorityConfirm:v,handlePriorityCancel:()=>{f(!1),n(!1),m(null)}}};function Y3(e,t){if(!t)return!0;const n=function(e){const t=[],n=e.geometry;return"LineString"===n.type?n.coordinates.forEach(e=>{Array.isArray(e)&&e.length>=2&&t.push([e[0],e[1]])}):"MultiLineString"===n.type&&n.coordinates.forEach(e=>{Array.isArray(e)&&e.forEach(e=>{Array.isArray(e)&&e.length>=2&&t.push([e[0],e[1]])})}),t}(e);return 0!==n.length&&n.every(([e,n])=>Ew(n,e,t))}const q3=async e=>{const{routeId:t,markers:n,removeSnappedRoadsForRoute:r,addSnappedRoads:o}=e;try{const i=n.waypoints.length>0?n.waypoints.sort((e,t)=>e.order-t.order).map(e=>({lat:e.position.lat,lng:e.position.lng})):[],s=await Vw.generateRoute(n.startMarker,n.endMarker,i);if(!s.success||!s.data)throw new Error(s.message||"Failed to generate route");const{encodedPolyline:a,distance:l,duration:c}=s.data,u={type:"Feature",geometry:Sw(a),properties:{id:`${t}-optimized`,name:"Optimized Route",source:"google_routes_api",distance:l.toFixed(2),duration:c.toFixed(0),traffic_aware:!0,encodedPolyline:a}};if(void 0!==e.boundary&&!Y3(u,e.boundary))throw new Error("Route is outside the jurisdiction boundary");r(t),o(t,[u])}catch(i){throw i}};function J3(e,t){if(e.length!==t.length)return!1;for(let n=0;n<e.length;n++){const r=e[n],o=t[n];if(Math.abs(r.coordinates.lat-o.coordinates.lat)>1e-6||Math.abs(r.coordinates.lng-o.coordinates.lng)>1e-6)return!1}return!0}function Z3(e){const t=JN(e=>e.mapMode),n=$N(e=>e.individualRoute),r=$N(e=>e.generateRoute),o=$N(e=>e.setGenerating),i=$N(e=>e.setGeneratedRoute),s=$N(e=>e.setRouteUUID),a=Ee({mutationFn:async e=>{const t=await Vw.generateRoute(e.origin,e.destination,e.waypoints);if(!t.success)throw new Error(t.message);return t.data},onError:e=>{Pw(`Failed to generate route: ${e.message}`)}}),l=pe.useRef(null),c=pe.useRef(null),u=pe.useRef(!1),d=pe.useRef(!1);pe.useEffect(()=>{n.routeUUID!==c.current&&(c.current=n.routeUUID,u.current=!1,d.current=!1,n.routeUUID||(l.current=null))},[n.routeUUID,n.generatedRoute,n.points.length]),pe.useEffect(()=>{if(n.routeUUID&&n.generatedRoute&&n.points.length>=2)if(d.current||(d.current=!0),l.current){!J3(n.points,l.current)&&(l.current=n.points.map(e=>({coordinates:{...e.coordinates}})))}else l.current=n.points.map(e=>({coordinates:{...e.coordinates}})),u.current=!0},[n.generatedRoute?.encodedPolyline]),pe.useEffect(()=>{if("individual_drawing"!==t)return;const c=n.points,u=c.length;if(n.routeUUID&&n.generatedRoute&&l.current&&d.current){if(!!J3(c,l.current))return}u>=2?r({points:c,projectId:e,generateRouteMutation:a,saveRouteMutation:null,setGenerating:o,setGeneratedRoute:i,setRouteUUID:s}):u<2&&n.generatedRoute&&i(null)},[n.points,t,e])}function e4(){return e4=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)({}).hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},e4.apply(null,arguments)}var t4,n4;(n4=t4||(t4={})).Commit="commit",n4.Provisional="provisional",n4.Finish="finish";const r4={SELECTED:"selected",MID_POINT:"midPoint",SELECTION_POINT_FEATURE_ID:"selectionPointFeatureId",SELECTION_POINT:"selectionPoint"},o4={MODE:"mode",CURRENTLY_DRAWING:"currentlyDrawing",EDITED:"edited",CLOSING_POINT:"closingPoint",SNAPPING_POINT:"snappingPoint",COORDINATE_POINT:"coordinatePoint",COORDINATE_POINT_FEATURE_ID:"coordinatePointFeatureId",COORDINATE_POINT_IDS:"coordinatePointIds",PROVISIONAL_COORDINATE_COUNT:"provisionalCoordinateCount",COMMITTED_COORDINATE_COUNT:"committedCoordinateCount",MARKER:"marker"};function i4(e){return Boolean(e&&"object"==typeof e&&null!==e&&!Array.isArray(e))}function s4(e){return Boolean(e&&"object"==typeof e&&"properties"in e&&"object"==typeof e.properties&&null!==e.properties&&"mode"in e.properties)}function a4(e){return!("number"!=typeof(t=e)||isNaN(new Date(t).valueOf()));var t}var l4;!function(e){e.Drawing="drawing",e.Select="select",e.Static="static",e.Render="render"}(l4||(l4={}));const c4={rightClick:!0,contextMenu:!1,leftClick:!0,onDragStart:!0,onDrag:!0,onDragEnd:!0};class u4{get state(){return this._state}set state(e){throw new Error("Please use the modes lifecycle methods")}get styles(){return this._styles}set styles(e){if("object"!=typeof e)throw new Error("Styling must be an object");this.onStyleChange&&this.onStyleChange([],"styling"),this._styles=e}registerBehaviors(e){}constructor(e,t=!1){this._state="unregistered",this._styles={},this.pointerEvents=c4,this.behaviors=[],this.validate=void 0,this.pointerDistance=40,this.coordinatePrecision=void 0,this.onStyleChange=void 0,this.store=void 0,this.projection="web-mercator",this.setDoubleClickToZoom=void 0,this.unproject=void 0,this.project=void 0,this.setCursor=void 0,this.isInitialUpdate=!1,this.type=l4.Drawing,this.mode="base",t?this.isInitialUpdate=!0:this.updateOptions(e4({},e))}updateOptions(e){null!=e&&e.styles&&(this.styles=e4({},this._styles,e.styles)),null!=e&&e.pointerDistance&&(this.pointerDistance=e.pointerDistance),null!=e&&e.validation&&(this.validate=e&&e.validation),null!=e&&e.projection&&(this.projection=e.projection),void 0!==(null==e?void 0:e.pointerEvents)&&(this.pointerEvents=e.pointerEvents),null!=e&&e.modeName&&!0===this.isInitialUpdate&&(this.mode=e.modeName),this.isInitialUpdate=!1}allowPointerEvent(e,t){return"boolean"==typeof e?e:"function"!=typeof e||e(t)}setDrawing(){if("started"!==this._state)throw new Error("Mode must be unregistered or stopped to start");this._state="drawing"}setStarted(){if("stopped"!==this._state&&"registered"!==this._state&&"drawing"!==this._state&&"selecting"!==this._state)throw new Error("Mode must be unregistered or stopped to start");this._state="started",this.setDoubleClickToZoom(!1)}setStopped(){if("started"!==this._state)throw new Error("Mode must be started to be stopped");this._state="stopped",this.setDoubleClickToZoom(!0)}register(e){if("unregistered"!==this._state)throw new Error("Can not register unless mode is unregistered");this._state="registered",this.store=e.store,this.store.registerOnChange(e.onChange),this.setDoubleClickToZoom=e.setDoubleClickToZoom,this.project=e.project,this.unproject=e.unproject,this.onSelect=e.onSelect,this.onDeselect=e.onDeselect,this.setCursor=e.setCursor,this.onStyleChange=e.onChange,this.onFinish=e.onFinish,this.coordinatePrecision=e.coordinatePrecision,this.registerBehaviors({mode:e.mode,store:this.store,project:this.project,unproject:this.unproject,pointerDistance:this.pointerDistance,coordinatePrecision:e.coordinatePrecision,projection:this.projection})}validateFeature(e){return this.performFeatureValidation(e)}afterFeatureAdded(e){}afterFeatureUpdated(e){}performFeatureValidation(e){if("unregistered"===this._state)throw new Error("Mode must be registered");const t=function(e,t){let n;if(i4(e))if(null==e.id)n="Feature has no id";else if("string"!=typeof e.id&&"number"!=typeof e.id)n="Feature must be string or number as per GeoJSON spec";else if(t(e.id))if(i4(e.geometry))if(i4(e.properties))if("string"==typeof e.geometry.type&&["Polygon","LineString","Point"].includes(e.geometry.type))if(Array.isArray(e.geometry.coordinates)){if(!e.properties.mode||"string"!=typeof e.properties.mode)return{valid:!1,reason:"Feature does not have a valid mode property"}}else n="Feature coordinates is not an array";else n="Feature is not Point, LineString or Polygon";else n="Feature has no properties";else n="Feature has no geometry";else n="Feature must match the id strategy (default is UUID4)";else n="Feature is not object";return n?{valid:!1,reason:n}:{valid:!0}}(e,this.store.idStrategy.isValidId);if(this.validate){const n=this.validate(e,{project:this.project,unproject:this.unproject,coordinatePrecision:this.coordinatePrecision,updateType:t4.Provisional});return{valid:t.valid&&n.valid,reason:n.reason}}return{valid:t.valid,reason:t.reason}}validateModeFeature(e,t){const n=this.performFeatureValidation(e);return n.valid?e.properties.mode!==this.mode?{valid:!1,reason:"Feature mode property does not match the mode being added to"}:t(e):{valid:!1,reason:n.reason}}onFinish(e,t){}onDeselect(e){}onSelect(e){}onKeyDown(e){}onKeyUp(e){}onMouseMove(e){}onClick(e){}onDragStart(e,t){}onDrag(e,t){}onDragEnd(e,t){}getHexColorStylingValue(e,t,n){return this.getStylingValue(e,t,n)}getNumericStylingValue(e,t,n){return this.getStylingValue(e,t,n)}getUrlStylingValue(e,t,n){return this.getStylingValue(e,t,n)}getStylingValue(e,t,n){return void 0===e?t:"function"==typeof e?e(n):e}}function d4(e,t){const n=e=>e*Math.PI/180,r=n(e[1]),o=n(e[0]),i=n(t[1]),s=i-r,a=n(t[0])-o,l=Math.sin(s/2)*Math.sin(s/2)+Math.cos(r)*Math.cos(i)*Math.sin(a/2)*Math.sin(a/2);return 2*Math.atan2(Math.sqrt(l),Math.sqrt(1-l))*6371e3/1e3}function A4(e){return e%360*Math.PI/180}function h4(e){return e%(2*Math.PI)*180/Math.PI}function p4(e,t=9){const n=Math.pow(10,t);return Math.round(e*n)/n}const f4=57.29577951308232,g4=.017453292519943295,m4=6378137,y4=(e,t)=>({x:0===e?0:e*g4*m4,y:0===t?0:Math.log(Math.tan(Math.PI/4+t*g4/2))*m4}),v4=(e,t)=>({lng:0===e?0:f4*(e/m4),lat:0===t?0:(2*Math.atan(Math.exp(t/m4))-Math.PI/2)*f4});function b4(e,t){return x4(e[0])<=t&&x4(e[1])<=t}function w4(e){return 2===e.length&&"number"==typeof e[0]&&"number"==typeof e[1]&&1/0!==e[0]&&1/0!==e[1]&&(n=e[0])>=-180&&n<=180&&(t=e[1])>=-90&&t<=90;var t,n}function x4(e){let t=1,n=0;for(;Math.round(e*t)/t!==e;)t*=10,n++;return n}const _4=(e,t)=>{const{x:n,y:r}=e,{x:o,y:i}=t,s=o-n,a=i-r;return Math.sqrt(a*a+s*s)};class C4{constructor({store:e,mode:t,project:n,unproject:r,pointerDistance:o,coordinatePrecision:i,projection:s}){this.store=void 0,this.mode=void 0,this.project=void 0,this.unproject=void 0,this.pointerDistance=void 0,this.coordinatePrecision=void 0,this.projection=void 0,this.store=e,this.mode=t,this.project=n,this.unproject=r,this.pointerDistance=o,this.coordinatePrecision=i,this.projection=s}}function S4({unproject:e,point:t,pointerDistance:n}){const r=n/2,{x:o,y:i}=t;return{type:"Feature",properties:{},geometry:{type:"Polygon",coordinates:[[e(o-r,i-r),e(o+r,i-r),e(o+r,i+r),e(o-r,i+r),e(o-r,i-r)].map(e=>[e.lng,e.lat])]}}}class E4 extends C4{constructor(e){super(e)}create(e){const{containerX:t,containerY:n}=e;return S4({unproject:this.unproject,point:{x:t,y:n},pointerDistance:this.pointerDistance})}}class B4 extends C4{constructor(e){super(e)}measure(e,t){const{x:n,y:r}=this.project(t[0],t[1]);return _4({x:n,y:r},{x:e.containerX,y:e.containerY})}}class I4 extends C4{constructor(e,t,n){super(e),this.config=void 0,this.pixelDistance=void 0,this.clickBoundingBox=void 0,this.getSnappableCoordinateFirstClick=e=>this.getSnappable(e,e=>Boolean(e.properties&&e.properties.mode===this.mode)).coordinate,this.getSnappableCoordinate=(e,t)=>this.getSnappable(e,e=>Boolean(e.properties&&e.properties.mode===this.mode&&e.id!==t)).coordinate,this.config=e,this.pixelDistance=t,this.clickBoundingBox=n}getSnappable(e,t){const n=this.clickBoundingBox.create(e),r=this.store.search(n,t),o={featureId:void 0,featureCoordinateIndex:void 0,coordinate:void 0,minDist:1/0};return r.forEach(t=>{let n;if("Polygon"===t.geometry.type)n=t.geometry.coordinates[0];else{if("LineString"!==t.geometry.type)return;n=t.geometry.coordinates}n.forEach((n,r)=>{const i=this.pixelDistance.measure(e,n);i<o.minDist&&i<this.pointerDistance&&(o.coordinate=n,o.minDist=i,o.featureId=t.id,o.featureCoordinateIndex=r)})}),o}}function R4(e,t){return e[0]===t[0]&&e[1]===t[1]}function k4(e){return Math.sqrt(Math.pow(e[0],2)+Math.pow(e[1],2)+Math.pow(e[2],2))}function T4(e,t){const n=function(e,t){const[n,r,o]=e,[i,s,a]=t;return n*i+r*s+o*a}(e,t)/(k4(e)*k4(t));return Math.acos(Math.min(Math.max(n,-1),1))}function P4(e){const t=A4(e[1]),n=A4(e[0]);return[Math.cos(t)*Math.cos(n),Math.cos(t)*Math.sin(n),Math.sin(t)]}function F4(e){const[t,n,r]=e,o=h4(Math.asin(r));return[h4(Math.atan2(n,t)),o]}function M4(e,t,n){const r=P4(e),o=P4(t),i=P4(n),[s,a,l]=i,[c,u,d]=function(e,t){const[n,r,o]=e,[i,s,a]=t;return[r*a-o*s,o*i-n*a,n*s-r*i]}(r,o),A=u*l-d*a,h=d*s-c*l,p=c*a-u*s,f=p*u-h*d,g=A*d-p*c,m=h*c-A*u,y=1/Math.sqrt(Math.pow(f,2)+Math.pow(g,2)+Math.pow(m,2)),v=[f*y,g*y,m*y],b=[-1*f*y,-1*g*y,-1*m*y],w=T4(r,o),x=T4(r,v),_=T4(o,v),C=T4(r,b),S=T4(o,b);let E;return E=x<C&&x<S||_<C&&_<S?v:b,T4(r,E)>w||T4(o,E)>w?d4(F4(E),F4(r))<=d4(F4(E),F4(o))?[F4(r),!0,!1]:[F4(o),!1,!0]:[F4(E),!1,!1]}function L4(e,t,n){const r=t.x-e.x,o=t.y-e.y,i=Math.max(0,Math.min(1,((n.x-e.x)*r+(n.y-e.y)*o)/(r*r+o*o)));return{x:e.x+i*r,y:e.y+i*o}}class U4 extends C4{constructor(e,t,n){super(e),this.config=void 0,this.pixelDistance=void 0,this.clickBoundingBox=void 0,this.getSnappableCoordinateFirstClick=e=>{const t=this.getSnappable(e,e=>Boolean(e.properties&&e.properties.mode===this.mode));return t.coordinate?[p4(t.coordinate[0],this.config.coordinatePrecision),p4(t.coordinate[1],this.config.coordinatePrecision)]:void 0},this.getSnappableCoordinate=(e,t)=>{const n=this.getSnappable(e,e=>Boolean(e.properties&&e.properties.mode===this.mode&&e.id!==t));return n.coordinate?[p4(n.coordinate[0],this.config.coordinatePrecision),p4(n.coordinate[1],this.config.coordinatePrecision)]:void 0},this.config=e,this.pixelDistance=t,this.clickBoundingBox=n}getSnappable(e,t){const n=this.clickBoundingBox.create(e),r=this.store.search(n,t),o={featureId:void 0,featureCoordinateIndex:void 0,coordinate:void 0,minDistance:1/0};return r.forEach(t=>{let n;if("Polygon"===t.geometry.type)n=t.geometry.coordinates[0];else{if("LineString"!==t.geometry.type)return;n=t.geometry.coordinates}const r=[];for(let e=0;e<n.length-1;e++)r.push([n[e],n[e+1]]);let i;const s=[e.lng,e.lat];if("web-mercator"===this.config.projection?i=function(e,t){let n=[1/0,1/0],r=1/0,o=0;for(let i of t){const s=i[0],a=i[1];let l,c=1/0;const u=y4(s[0],s[1]),d=y4(a[0],a[1]),A=y4(e[0],e[1]);if(s[0]===e[0]&&s[1]===e[1])l=s;else if(a[0]===e[0]&&a[1]===e[1])l=a;else{const{x:e,y:t}=L4(u,d,A),{lng:n,lat:r}=v4(e,t);l=[n,r]}l&&(c=_4(A,y4(l[0],l[1])),c<r&&(n=l,r=c,o=t.indexOf(i)))}return 1/0===r?void 0:{coordinate:n,lineIndex:o,distance:r}}(s,r):"globe"===this.config.projection&&(i=function(e,t){let n=[1/0,1/0],r=1/0,o=0;for(let i of t){const s=i[0],a=i[1];let l,c=1/0;s[0]===e[0]&&s[1]===e[1]?l=s:a[0]===e[0]&&a[1]===e[1]?l=a:[l]=M4(s,a,e),l&&(c=d4(e,l),c<r&&(n=l,r=c,o=t.indexOf(i)))}return 1/0===r?void 0:{coordinate:n,distance:r,lineIndex:o}}(s,r)),!i)return;const a=this.pixelDistance.measure(e,i.coordinate);a<o.minDistance&&a<this.pointerDistance&&(o.featureId=t.id,o.coordinate=[p4(i.coordinate[0],this.config.coordinatePrecision),p4(i.coordinate[1],this.config.coordinatePrecision)],o.featureCoordinateIndex=i.lineIndex,o.minDistance=a)}),o}}class O4 extends C4{constructor(e,t){super(e),this.config=void 0,this.pixelDistance=void 0,this._startEndPoints=[],this.config=e,this.pixelDistance=t}get ids(){return this._startEndPoints.concat()}set ids(e){}create(e,t){if(this.ids.length)throw new Error("Opening and closing points already created");if(e.length<=3)throw new Error("Requires at least 4 coordinates");this._startEndPoints=this.store.create([{geometry:{type:"Point",coordinates:e[0]},properties:{mode:t,[o4.CLOSING_POINT]:!0}},{geometry:{type:"Point",coordinates:e[e.length-2]},properties:{mode:t,[o4.CLOSING_POINT]:!0}}])}delete(){this.ids.length&&(this.store.delete(this.ids),this._startEndPoints=[])}update(e){if(2!==this.ids.length)throw new Error("No closing points to update");this.store.updateGeometry([{id:this.ids[0],geometry:{type:"Point",coordinates:e[0]}},{id:this.ids[1],geometry:{type:"Point",coordinates:e[e.length-3]}}])}isClosingPoint(e){const t=this.store.getGeometryCopy(this.ids[0]),n=this.store.getGeometryCopy(this.ids[1]),r=this.pixelDistance.measure(e,t.coordinates),o=this.pixelDistance.measure(e,n.coordinates);return{isClosing:r<this.pointerDistance,isPreviousClosing:o<this.pointerDistance}}}class D4 extends C4{constructor(e){super(e)}createOrUpdate(e){const t=this.store.getGeometryCopy(e),n=this.store.getPropertiesCopy(e);let r;if("Polygon"===t.type)r=t.coordinates[0].slice(0,-1);else{if("LineString"!==t.type)return;r=t.coordinates}const o=this.store.getPropertiesCopy(e),i=o.coordinatePointIds;if(i)if(i&&i.every(e=>this.store.has(e))){const t=o.coordinatePointIds,i=t.map(e=>this.store.getGeometryCopy(e).coordinates);if(t.length!==r.length){this.deleteCoordinatePoints(t);const o=this.createPoints(r,n.mode,e);this.setFeatureCoordinatePoints(e,o)}else r.forEach((e,n)=>{e[0]===i[n][0]&&e[1]===i[n][1]||this.store.updateGeometry([{id:t[n],geometry:{type:"Point",coordinates:e}}])})}else{const t=i.filter(e=>this.store.has(e));t.length&&this.deleteCoordinatePoints(t);const o=this.createPoints(r,n.mode,e);this.setFeatureCoordinatePoints(e,o)}else{const t=this.createPoints(r,n.mode,e);this.setFeatureCoordinatePoints(e,t)}}deletePointsByFeatureIds(e){for(const t of e)this.deleteIfPresent(t)}getUpdated(e,t){const n=this.store.getPropertiesCopy(e);if(n.coordinatePointIds)return n.coordinatePointIds.map((e,n)=>({id:e,geometry:e4({},this.store.getGeometryCopy(e),{coordinates:t[n]})}))}createPoints(e,t,n){return this.store.create(e.map((e,r)=>({geometry:{type:"Point",coordinates:e},properties:{mode:t,[o4.COORDINATE_POINT]:!0,[o4.COORDINATE_POINT_FEATURE_ID]:n,index:r}})))}setFeatureCoordinatePoints(e,t){this.store.updateProperty([{id:e,property:o4.COORDINATE_POINT_IDS,value:t}])}deleteCoordinatePoints(e){const t=e.filter(e=>this.store.has(e));this.store.delete(t)}deleteIfPresent(e){const t=this.store.getPropertiesCopy(e).coordinatePointIds;t&&(this.deleteCoordinatePoints(t),this.setFeatureCoordinatePoints(e,null))}}const N4={cancel:"Escape",finish:"Enter"},j4={start:"crosshair",close:"pointer",dragStart:"grabbing",dragEnd:"crosshair"};class Q4 extends u4{constructor(e){super(e,!0),this.mode="polygon",this.currentCoordinate=0,this.currentId=void 0,this.keyEvents=N4,this.cursors=j4,this.mouseMove=!1,this.showCoordinatePoints=!1,this.lastMouseMoveEvent=void 0,this.snapping=void 0,this.snappedPointId=void 0,this.editable=!1,this.editedFeatureId=void 0,this.editedFeatureCoordinateIndex=void 0,this.editedSnapType=void 0,this.editedInsertIndex=void 0,this.editedPointId=void 0,this.coordinatePoints=void 0,this.lineSnapping=void 0,this.coordinateSnapping=void 0,this.pixelDistance=void 0,this.closingPoints=void 0,this.clickBoundingBox=void 0,this.updateOptions(e)}updateOptions(e){if(super.updateOptions(e),null!=e&&e.cursors&&(this.cursors=e4({},this.cursors,e.cursors)),null===(null==e?void 0:e.keyEvents)?this.keyEvents={cancel:null,finish:null}:null!=e&&e.keyEvents&&(this.keyEvents=e4({},this.keyEvents,e.keyEvents)),null!=e&&e.snapping&&(this.snapping=e.snapping),void 0!==(null==e?void 0:e.editable)&&(this.editable=e.editable),void 0!==(null==e?void 0:e.pointerEvents)&&(this.pointerEvents=e.pointerEvents),void 0!==(null==e?void 0:e.showCoordinatePoints))if(this.showCoordinatePoints=e.showCoordinatePoints,this.coordinatePoints&&!0===e.showCoordinatePoints)this.store.copyAllWhere(e=>e.mode===this.mode).map(e=>e.id).forEach(e=>{this.coordinatePoints.createOrUpdate(e)});else if(this.coordinatePoints&&!1===this.showCoordinatePoints){const e=this.store.copyAllWhere(e=>e.mode===this.mode&&Boolean(e[o4.COORDINATE_POINT_IDS]));this.coordinatePoints.deletePointsByFeatureIds(e.map(e=>e.id))}}close(){if(void 0===this.currentId)return;const e=this.store.getGeometryCopy(this.currentId).coordinates[0];if(e.length<5)return;if(!this.updatePolygonGeometry([...e.slice(0,-2),e[0]],t4.Finish))return;const t=this.currentId;if(this.currentId){const e=function(e){const t=function(e){const t=e.coordinates[0];let n=0;for(let r=0;r<t.length-1;r++){const[e,o]=t[r],[i,s]=t[r+1];n+=(i-e)*(s+o)}return n<0}(e);if(!t)return{type:"Polygon",coordinates:[e.coordinates[0].reverse()]}}(this.store.getGeometryCopy(this.currentId));e&&(this.store.updateGeometry([{id:this.currentId,geometry:e}]),this.showCoordinatePoints&&this.coordinatePoints.createOrUpdate(this.currentId)),this.store.updateProperty([{id:this.currentId,property:o4.CURRENTLY_DRAWING,value:void 0},{id:this.currentId,property:o4.COMMITTED_COORDINATE_COUNT,value:void 0},{id:this.currentId,property:o4.PROVISIONAL_COORDINATE_COUNT,value:void 0}])}this.snappedPointId&&this.store.delete([this.snappedPointId]),this.currentCoordinate=0,this.currentId=void 0,this.snappedPointId=void 0,this.closingPoints.delete(),"drawing"===this.state&&this.setStarted(),this.onFinish(t,{mode:this.mode,action:"draw"})}registerBehaviors(e){this.clickBoundingBox=new E4(e),this.pixelDistance=new B4(e),this.lineSnapping=new U4(e,this.pixelDistance,this.clickBoundingBox),this.coordinateSnapping=new I4(e,this.pixelDistance,this.clickBoundingBox),this.closingPoints=new O4(e,this.pixelDistance),this.coordinatePoints=new D4(e)}start(){this.setStarted(),this.setCursor(this.cursors.start)}stop(){this.cleanUp(),this.setStopped(),this.setCursor("unset")}updateSnappedCoordinate(e){const t=this.snapCoordinate(e);if(t){if(this.snappedPointId)this.store.updateGeometry([{id:this.snappedPointId,geometry:{type:"Point",coordinates:t}}]);else{const[e]=this.store.create([{geometry:{type:"Point",coordinates:t},properties:{mode:this.mode,[o4.SNAPPING_POINT]:!0}}]);this.snappedPointId=e}e.lng=t[0],e.lat=t[1]}else this.snappedPointId&&(this.store.delete([this.snappedPointId]),this.snappedPointId=void 0)}onMouseMove(e){if(this.mouseMove=!0,this.setCursor(this.cursors.start),this.lastMouseMoveEvent=e,this.updateSnappedCoordinate(e),void 0===this.currentId||0===this.currentCoordinate)return;const t=this.store.getGeometryCopy(this.currentId).coordinates[0];let n;if(1===this.currentCoordinate){const r=1/Math.pow(10,this.coordinatePrecision-1),o=Math.max(1e-6,r);n=[t[0],[e.lng,e.lat],[e.lng,e.lat-o],t[0]]}else if(2===this.currentCoordinate)n=[t[0],t[1],[e.lng,e.lat],t[0]];else{const{isClosing:r,isPreviousClosing:o}=this.closingPoints.isClosingPoint(e);o||r?(this.snappedPointId&&(this.store.delete([this.snappedPointId]),this.snappedPointId=void 0),this.setCursor(this.cursors.close),n=[...t.slice(0,-2),t[0],t[0]]):n=[...t.slice(0,-2),[e.lng,e.lat],t[0]]}this.store.updateProperty([{id:this.currentId,property:o4.PROVISIONAL_COORDINATE_COUNT,value:this.currentCoordinate+1}]),this.updatePolygonGeometry(n,t4.Provisional)}updatePolygonGeometry(e,t){if(!this.currentId)return!1;const n={type:"Polygon",coordinates:[e]};return!(this.validate&&!this.validate({type:"Feature",geometry:n},{project:this.project,unproject:this.unproject,coordinatePrecision:this.coordinatePrecision,updateType:t}).valid||(this.store.updateGeometry([{id:this.currentId,geometry:n}]),this.showCoordinatePoints&&this.coordinatePoints.createOrUpdate(this.currentId),0))}snapCoordinate(e){var t,n,r;let o;if(null!=(t=this.snapping)&&t.toLine){let t;t=this.currentId?this.lineSnapping.getSnappableCoordinate(e,this.currentId):this.lineSnapping.getSnappableCoordinateFirstClick(e),t&&(o=t)}if(null!=(n=this.snapping)&&n.toCoordinate){let t;t=this.currentId?this.coordinateSnapping.getSnappableCoordinate(e,this.currentId):this.coordinateSnapping.getSnappableCoordinateFirstClick(e),t&&(o=t)}return null!=(r=this.snapping)&&r.toCustom&&(o=this.snapping.toCustom(e,{currentCoordinate:this.currentCoordinate,currentId:this.currentId,getCurrentGeometrySnapshot:this.currentId?()=>this.store.getGeometryCopy(this.currentId):()=>null,project:this.project,unproject:this.unproject})),o}polygonFilter(e){return Boolean("Polygon"===e.geometry.type&&e.properties&&e.properties.mode===this.mode)}onRightClick(e){if(!this.editable||"started"!==this.state)return;const{featureId:t,featureCoordinateIndex:n}=this.coordinateSnapping.getSnappable(e,e=>this.polygonFilter(e));if(!t||void 0===n)return;const r=this.store.getGeometryCopy(t);let o;"Polygon"===r.type&&(o=r.coordinates[0],o.length<=4||("Polygon"!==r.type||0!==n&&n!==o.length-1?o.splice(n,1):(o.shift(),o.pop(),o.push([o[0][0],o[0][1]])),(!this.validate||this.validate({id:t,type:"Feature",geometry:r,properties:{}},{project:this.project,unproject:this.unproject,coordinatePrecision:this.coordinatePrecision,updateType:t4.Commit}).valid)&&(this.snappedPointId&&(this.store.delete([this.snappedPointId]),this.snappedPointId=void 0),this.store.updateGeometry([{id:t,geometry:r}]),this.showCoordinatePoints&&this.coordinatePoints.createOrUpdate(t),this.onFinish(t,{mode:this.mode,action:"edit"}))))}onLeftClick(e){if(this.snappedPointId&&(this.store.delete([this.snappedPointId]),this.snappedPointId=void 0),0===this.currentCoordinate){const t=this.snapCoordinate(e);t&&(e.lng=t[0],e.lat=t[1]);const[n]=this.store.create([{geometry:{type:"Polygon",coordinates:[[[e.lng,e.lat],[e.lng,e.lat],[e.lng,e.lat],[e.lng,e.lat]]]},properties:{mode:this.mode,[o4.CURRENTLY_DRAWING]:!0,[o4.COMMITTED_COORDINATE_COUNT]:this.currentCoordinate+1,[o4.PROVISIONAL_COORDINATE_COUNT]:this.currentCoordinate+1}}]);this.currentId=n,this.currentCoordinate++,this.showCoordinatePoints&&this.coordinatePoints.createOrUpdate(n),this.setDrawing()}else if(1===this.currentCoordinate&&this.currentId){const t=this.snapCoordinate(e);t&&(e.lng=t[0],e.lat=t[1]);const n=this.store.getGeometryCopy(this.currentId);if(R4([e.lng,e.lat],n.coordinates[0][0]))return;if(!this.updatePolygonGeometry([n.coordinates[0][0],[e.lng,e.lat],[e.lng,e.lat],n.coordinates[0][0]],t4.Commit))return;this.store.updateProperty([{id:this.currentId,property:o4.COMMITTED_COORDINATE_COUNT,value:this.currentCoordinate+1}]),this.currentCoordinate++}else if(2===this.currentCoordinate&&this.currentId){const t=this.snapCoordinate(e);t&&(e.lng=t[0],e.lat=t[1]);const n=this.store.getGeometryCopy(this.currentId).coordinates[0];if(R4([e.lng,e.lat],n[1]))return;if(!this.updatePolygonGeometry([n[0],n[1],[e.lng,e.lat],[e.lng,e.lat],n[0]],t4.Commit))return;2===this.currentCoordinate&&this.closingPoints.create(n,"polygon"),this.store.updateProperty([{id:this.currentId,property:o4.COMMITTED_COORDINATE_COUNT,value:this.currentCoordinate+1}]),this.currentCoordinate++}else if(this.currentId){const t=this.store.getGeometryCopy(this.currentId).coordinates[0],{isClosing:n,isPreviousClosing:r}=this.closingPoints.isClosingPoint(e);if(r||n)this.close();else{const n=this.snapCoordinate(e);if(n&&(e.lng=n[0],e.lat=n[1]),R4([e.lng,e.lat],t[this.currentCoordinate-1]))return;const r=function(e=[[[0,0],[0,1],[1,1],[1,0],[0,0]]]){return{type:"Feature",geometry:{type:"Polygon",coordinates:e},properties:{}}}([[...t.slice(0,-1),[e.lng,e.lat],t[0]]]);if(!this.updatePolygonGeometry(r.geometry.coordinates[0],t4.Commit))return;this.store.updateProperty([{id:this.currentId,property:o4.COMMITTED_COORDINATE_COUNT,value:this.currentCoordinate+1}]),this.currentCoordinate++,this.closingPoints.ids.length&&this.closingPoints.update(r.geometry.coordinates[0])}}}onClick(e){this.currentCoordinate>0&&!this.mouseMove&&this.onMouseMove(e),this.mouseMove=!1,"right"===e.button&&this.allowPointerEvent(this.pointerEvents.rightClick,e)||e.isContextMenu&&this.allowPointerEvent(this.pointerEvents.contextMenu,e)?this.onRightClick(e):"left"===e.button&&this.allowPointerEvent(this.pointerEvents.leftClick,e)&&this.onLeftClick(e)}onKeyUp(e){e.key===this.keyEvents.cancel?this.cleanUp():e.key===this.keyEvents.finish&&this.close()}onKeyDown(){}onDragStart(e,t){if(!this.allowPointerEvent(this.pointerEvents.onDragStart,e))return;if(!this.editable)return;let n;if("started"===this.state){const t=this.lineSnapping.getSnappable(e,e=>this.polygonFilter(e));t.coordinate&&(this.editedSnapType="line",this.editedFeatureCoordinateIndex=t.featureCoordinateIndex,this.editedFeatureId=t.featureId,n=t.coordinate);const r=this.coordinateSnapping.getSnappable(e,e=>this.polygonFilter(e));r.coordinate&&(this.editedSnapType="coordinate",this.editedFeatureCoordinateIndex=r.featureCoordinateIndex,this.editedFeatureId=r.featureId,n=r.coordinate)}if(this.editedFeatureId&&n){if(!this.editedPointId){const[e]=this.store.create([{geometry:{type:"Point",coordinates:n},properties:{mode:this.mode,[o4.EDITED]:!0}}]);this.editedPointId=e}this.setCursor(this.cursors.dragStart),t(!1)}}onDrag(e,t){if(!this.allowPointerEvent(this.pointerEvents.onDrag,e))return;if(void 0===this.editedFeatureId||void 0===this.editedFeatureCoordinateIndex)return;const n=this.store.getGeometryCopy(this.editedFeatureId),r=n.coordinates[0];"coordinate"===this.editedSnapType||"line"===this.editedSnapType&&void 0!==this.editedInsertIndex?0===this.editedFeatureCoordinateIndex||this.editedFeatureCoordinateIndex===n.coordinates[0].length-1?(r[0]=[e.lng,e.lat],r[r.length-1]=[e.lng,e.lat]):r[this.editedFeatureCoordinateIndex]=[e.lng,e.lat]:"line"===this.editedSnapType&&void 0===this.editedInsertIndex&&(this.editedInsertIndex=this.editedFeatureCoordinateIndex+1,n.coordinates[0].splice(this.editedInsertIndex,0,[e.lng,e.lat]),this.editedFeatureCoordinateIndex++);const o={type:"Polygon",coordinates:n.coordinates};this.validate&&!this.validate({type:"Feature",geometry:o,properties:this.store.getPropertiesCopy(this.editedFeatureId)},{project:this.project,unproject:this.unproject,coordinatePrecision:this.coordinatePrecision,updateType:t4.Provisional}).valid||(this.snapping&&this.snappedPointId&&(this.store.delete([this.snappedPointId]),this.snappedPointId=void 0),this.store.updateGeometry([{id:this.editedFeatureId,geometry:o}]),this.showCoordinatePoints&&this.coordinatePoints.createOrUpdate(this.editedFeatureId),this.editedPointId&&this.store.updateGeometry([{id:this.editedPointId,geometry:{type:"Point",coordinates:[e.lng,e.lat]}}]),this.store.updateProperty([{id:this.editedFeatureId,property:o4.EDITED,value:!0}]))}onDragEnd(e,t){this.allowPointerEvent(this.pointerEvents.onDragEnd,e)&&void 0!==this.editedFeatureId&&(this.setCursor(this.cursors.dragEnd),this.editedPointId&&(this.store.delete([this.editedPointId]),this.editedPointId=void 0),this.store.updateProperty([{id:this.editedFeatureId,property:o4.EDITED,value:!1}]),this.onFinish(this.editedFeatureId,{mode:this.mode,action:"edit"}),this.editedFeatureId=void 0,this.editedFeatureCoordinateIndex=void 0,this.editedInsertIndex=void 0,this.editedSnapType=void 0,t(!0))}cleanUp(){const e=this.currentId,t=this.snappedPointId,n=this.editedPointId;this.currentId=void 0,this.snappedPointId=void 0,this.editedPointId=void 0,this.editedFeatureId=void 0,this.editedFeatureCoordinateIndex=void 0,this.editedInsertIndex=void 0,this.editedSnapType=void 0,this.currentCoordinate=0,"drawing"===this.state&&this.setStarted();try{e&&this.coordinatePoints.deletePointsByFeatureIds([e]),void 0!==e&&this.store.delete([e]),void 0!==n&&this.store.delete([n]),void 0!==t&&this.store.delete([t]),this.closingPoints.ids.length&&this.closingPoints.delete()}catch(r){}}styleFeature(e){const t=e4({},{polygonFillColor:"#3f97e0",polygonOutlineColor:"#3f97e0",polygonOutlineWidth:4,polygonFillOpacity:.3,pointColor:"#3f97e0",pointOutlineColor:"#ffffff",pointOutlineWidth:0,pointWidth:6,lineStringColor:"#3f97e0",lineStringWidth:4,zIndex:0,markerUrl:void 0,markerHeight:void 0,markerWidth:void 0});if(e.properties.mode===this.mode){if("Polygon"===e.geometry.type)return t.polygonFillColor=this.getHexColorStylingValue(this.styles.fillColor,t.polygonFillColor,e),t.polygonOutlineColor=this.getHexColorStylingValue(this.styles.outlineColor,t.polygonOutlineColor,e),t.polygonOutlineWidth=this.getNumericStylingValue(this.styles.outlineWidth,t.polygonOutlineWidth,e),t.polygonFillOpacity=this.getNumericStylingValue(this.styles.fillOpacity,t.polygonFillOpacity,e),t.zIndex=10,t;if("Point"===e.geometry.type){const n=e.properties[o4.EDITED],r=e.properties[o4.COORDINATE_POINT],o=n?"editedPoint":e.properties[o4.CLOSING_POINT]?"closingPoint":e.properties[o4.SNAPPING_POINT]?"snappingPoint":r?"coordinatePoint":void 0;if(!o)return t;const i={editedPoint:{width:this.styles.editedPointOutlineWidth,color:this.styles.editedPointColor,outlineColor:this.styles.editedPointOutlineColor,outlineWidth:this.styles.editedPointOutlineWidth},closingPoint:{width:this.styles.closingPointWidth,color:this.styles.closingPointColor,outlineColor:this.styles.closingPointOutlineColor,outlineWidth:this.styles.closingPointOutlineWidth},snappingPoint:{width:this.styles.snappingPointWidth,color:this.styles.snappingPointColor,outlineColor:this.styles.snappingPointOutlineColor,outlineWidth:this.styles.snappingPointOutlineWidth},coordinatePoint:{width:this.styles.coordinatePointWidth,color:this.styles.coordinatePointColor,outlineColor:this.styles.coordinatePointOutlineColor,outlineWidth:this.styles.coordinatePointOutlineWidth}};return t.pointWidth=this.getNumericStylingValue(i[o].width,t.pointWidth,e),t.pointColor=this.getHexColorStylingValue(i[o].color,t.pointColor,e),t.pointOutlineColor=this.getHexColorStylingValue(i[o].outlineColor,t.pointOutlineColor,e),t.pointOutlineWidth=this.getNumericStylingValue(i[o].outlineWidth,2,e),t.zIndex=n?40:r?20:30,t}}return t}afterFeatureAdded(e){this.showCoordinatePoints&&this.coordinatePoints.createOrUpdate(e.id)}afterFeatureUpdated(e){this.showCoordinatePoints&&this.coordinatePoints.createOrUpdate(e.id),this.editedFeatureId===e.id&&this.editedPointId&&(this.store.delete([this.editedPointId]),this.editedPointId=void 0,this.editedFeatureId=void 0,this.editedFeatureCoordinateIndex=void 0,this.editedSnapType=void 0),this.snappedPointId&&this.lastMouseMoveEvent&&this.updateSnappedCoordinate(this.lastMouseMoveEvent),this.currentId===e.id&&(this.currentCoordinate=0,this.currentId=void 0,this.closingPoints.delete(),"drawing"===this.state&&this.setStarted())}validateFeature(e){return this.validateModeFeature(e,e=>function(e,t){if("Polygon"!==e.geometry.type)return{valid:!1,reason:"Feature is not a Polygon"};if(1!==e.geometry.coordinates.length)return{valid:!1,reason:"Feature has holes"};if(e.geometry.coordinates[0].length<4)return{valid:!1,reason:"Feature has less than 4 coordinates"};for(let o=0;o<e.geometry.coordinates[0].length;o++){if(!w4(e.geometry.coordinates[0][o]))return{valid:!1,reason:"Feature has invalid coordinates"};if(!b4(e.geometry.coordinates[0][o],t))return{valid:!1,reason:"Feature has coordinates with excessive precision"}}return(n=e.geometry.coordinates[0][0])[0]!==(r=e.geometry.coordinates[0][e.geometry.coordinates[0].length-1])[0]||n[1]!==r[1]?{valid:!1,reason:"Feature coordinates are not closed"}:{valid:!0};var n,r}(e,this.coordinatePrecision))}}const z4=(e,t,n)=>{const r=e=>e*e,o=(e,t)=>r(e.x-t.x)+r(e.y-t.y);return Math.sqrt(((e,t,n)=>{const r=o(t,n);if(0===r)return o(e,t);let i=((e.x-t.x)*(n.x-t.x)+(e.y-t.y)*(n.y-t.y))/r;return i=Math.max(0,Math.min(1,i)),o(e,{x:t.x+i*(n.x-t.x),y:t.y+i*(n.y-t.y)})})(e,t,n))};class H4 extends u4{constructor(...e){super(...e),this.type=l4.Static,this.mode="static"}start(){}stop(){}onKeyUp(){}onKeyDown(){}onClick(){}onDragStart(){}onDrag(){}onDragEnd(){}onMouseMove(){}cleanUp(){}styleFeature(){return e4({},{polygonFillColor:"#3f97e0",polygonOutlineColor:"#3f97e0",polygonOutlineWidth:4,polygonFillOpacity:.3,pointColor:"#3f97e0",pointOutlineColor:"#ffffff",pointOutlineWidth:0,pointWidth:6,lineStringColor:"#3f97e0",lineStringWidth:4,zIndex:0,markerUrl:void 0,markerHeight:void 0,markerWidth:void 0})}}function G4(e,t,n,r,o){for(;r>n;){if(r-n>600){const i=r-n+1,s=t-n+1,a=Math.log(i),l=.5*Math.exp(2*a/3),c=.5*Math.sqrt(a*l*(i-l)/i)*(s-i/2<0?-1:1);G4(e,t,Math.max(n,Math.floor(t-s*l/i+c)),Math.min(r,Math.floor(t+(i-s)*l/i+c)),o)}const i=e[t];let s=n,a=r;for(V4(e,n,t),o(e[r],i)>0&&V4(e,n,r);s<a;){for(V4(e,s,a),s++,a--;o(e[s],i)<0;)s++;for(;o(e[a],i)>0;)a--}0===o(e[n],i)?V4(e,n,a):(a++,V4(e,a,r)),a<=t&&(n=a+1),t<=a&&(r=a-1)}}function V4(e,t,n){const r=e[t];e[t]=e[n],e[n]=r}function W4(e,t){$4(e,0,e.children.length,t,e)}function $4(e,t,n,r,o){o||(o=n5([])),o.minX=1/0,o.minY=1/0,o.maxX=-1/0,o.maxY=-1/0;for(let i=t;i<n;i++){const t=e.children[i];K4(o,e.leaf?r(t):t)}return o}function K4(e,t){return e.minX=Math.min(e.minX,t.minX),e.minY=Math.min(e.minY,t.minY),e.maxX=Math.max(e.maxX,t.maxX),e.maxY=Math.max(e.maxY,t.maxY),e}function X4(e,t){return e.minX-t.minX}function Y4(e,t){return e.minY-t.minY}function q4(e){return(e.maxX-e.minX)*(e.maxY-e.minY)}function J4(e){return e.maxX-e.minX+(e.maxY-e.minY)}function Z4(e,t){const n=Math.max(e.minX,t.minX),r=Math.max(e.minY,t.minY),o=Math.min(e.maxX,t.maxX),i=Math.min(e.maxY,t.maxY);return Math.max(0,o-n)*Math.max(0,i-r)}function e5(e,t){return e.minX<=t.minX&&e.minY<=t.minY&&t.maxX<=e.maxX&&t.maxY<=e.maxY}function t5(e,t){return t.minX<=e.maxX&&t.minY<=e.maxY&&t.maxX>=e.minX&&t.maxY>=e.minY}function n5(e){return{children:e,height:1,leaf:!0,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0}}function r5(e,t,n,r,o){const i=[t,n];for(;i.length;){if((n=i.pop())-(t=i.pop())<=r)continue;const s=t+Math.ceil((n-t)/r/2)*r;G4(e,s,t,n,o),i.push(t,s,s,n)}}class o5{constructor(e){this._maxEntries=void 0,this._minEntries=void 0,this.data=void 0,this._maxEntries=Math.max(4,e),this._minEntries=Math.max(2,Math.ceil(.4*this._maxEntries)),this.clear()}search(e){let t=this.data;const n=[];if(!t5(e,t))return n;const r=this.toBBox,o=[];for(;t;){for(let i=0;i<t.children.length;i++){const s=t.children[i],a=t.leaf?r(s):s;t5(e,a)&&(t.leaf?n.push(s):e5(e,a)?this._all(s,n):o.push(s))}t=o.pop()}return n}collides(e){let t=this.data;if(t5(e,t)){const n=[];for(;t;){for(let r=0;r<t.children.length;r++){const o=t.children[r],i=t.leaf?this.toBBox(o):o;if(t5(e,i)){if(t.leaf||e5(e,i))return!0;n.push(o)}}t=n.pop()}}return!1}load(e){if(e.length<this._minEntries){for(let t=0;t<e.length;t++)this.insert(e[t]);return}let t=this._build(e.slice(),0,e.length-1,0);if(this.data.children.length)if(this.data.height===t.height)this._splitRoot(this.data,t);else{if(this.data.height<t.height){const e=this.data;this.data=t,t=e}this._insert(t,this.data.height-t.height-1,!0)}else this.data=t}insert(e){this._insert(e,this.data.height-1)}clear(){this.data=n5([])}remove(e){let t=this.data;const n=this.toBBox(e),r=[],o=[];let i,s,a=!1;for(;t||r.length;){if(t||(t=r.pop(),s=r[r.length-1],i=o.pop(),a=!0),t.leaf){const n=t.children.indexOf(e);-1!==n&&(t.children.splice(n,1),r.push(t),this._condense(r))}a||t.leaf||!e5(t,n)?s?(i++,t=s.children[i],a=!1):t=null:(r.push(t),o.push(i),i=0,s=t,t=t.children[0])}}toBBox(e){return e}compareMinX(e,t){return e.minX-t.minX}compareMinY(e,t){return e.minY-t.minY}_all(e,t){const n=[];for(;e;)e.leaf?t.push(...e.children):n.push(...e.children),e=n.pop();return t}_build(e,t,n,r){const o=n-t+1;let i,s=this._maxEntries;if(o<=s)return i=n5(e.slice(t,n+1)),W4(i,this.toBBox),i;r||(r=Math.ceil(Math.log(o)/Math.log(s)),s=Math.ceil(o/Math.pow(s,r-1))),i=n5([]),i.leaf=!1,i.height=r;const a=Math.ceil(o/s),l=a*Math.ceil(Math.sqrt(s));r5(e,t,n,l,this.compareMinX);for(let c=t;c<=n;c+=l){const t=Math.min(c+l-1,n);r5(e,c,t,a,this.compareMinY);for(let n=c;n<=t;n+=a){const o=Math.min(n+a-1,t);i.children.push(this._build(e,n,o,r-1))}}return W4(i,this.toBBox),i}_chooseSubtree(e,t,n,r){for(;r.push(t),!t.leaf&&r.length-1!==n;){let n,r=1/0,s=1/0;for(let a=0;a<t.children.length;a++){const l=t.children[a],c=q4(l),u=(o=e,i=l,(Math.max(i.maxX,o.maxX)-Math.min(i.minX,o.minX))*(Math.max(i.maxY,o.maxY)-Math.min(i.minY,o.minY))-c);u<s?(s=u,r=c<r?c:r,n=l):u===s&&c<r&&(r=c,n=l)}t=n||t.children[0]}var o,i;return t}_insert(e,t,n){const r=n?e:this.toBBox(e),o=[],i=this._chooseSubtree(r,this.data,t,o);for(i.children.push(e),K4(i,r);t>=0&&o[t].children.length>this._maxEntries;)this._split(o,t),t--;this._adjustParentBBoxes(r,o,t)}_split(e,t){const n=e[t],r=n.children.length,o=this._minEntries;this._chooseSplitAxis(n,o,r);const i=this._chooseSplitIndex(n,o,r),s=n5(n.children.splice(i,n.children.length-i));s.height=n.height,s.leaf=n.leaf,W4(n,this.toBBox),W4(s,this.toBBox),t?e[t-1].children.push(s):this._splitRoot(n,s)}_splitRoot(e,t){this.data=n5([e,t]),this.data.height=e.height+1,this.data.leaf=!1,W4(this.data,this.toBBox)}_chooseSplitIndex(e,t,n){let r,o=1/0,i=1/0;for(let s=t;s<=n-t;s++){const t=$4(e,0,s,this.toBBox),a=$4(e,s,n,this.toBBox),l=Z4(t,a),c=q4(t)+q4(a);l<o?(o=l,r=s,i=c<i?c:i):l===o&&c<i&&(i=c,r=s)}return r||n-t}_chooseSplitAxis(e,t,n){const r=e.leaf?this.compareMinX:X4,o=e.leaf?this.compareMinY:Y4;this._allDistMargin(e,t,n,r)<this._allDistMargin(e,t,n,o)&&e.children.sort(r)}_allDistMargin(e,t,n,r){e.children.sort(r);const o=this.toBBox,i=$4(e,0,t,o),s=$4(e,n-t,n,o);let a=J4(i)+J4(s);for(let l=t;l<n-t;l++){const t=e.children[l];K4(i,e.leaf?o(t):t),a+=J4(i)}for(let l=n-t-1;l>=t;l--){const t=e.children[l];K4(s,e.leaf?o(t):t),a+=J4(s)}return a}_adjustParentBBoxes(e,t,n){for(let r=n;r>=0;r--)K4(t[r],e)}_condense(e){for(let t,n=e.length-1;n>=0;n--)0===e[n].children.length?n>0?(t=e[n-1].children,t.splice(t.indexOf(e[n]),1)):this.clear():W4(e[n],this.toBBox)}}class i5{constructor(e){this.tree=void 0,this.idToNode=void 0,this.nodeToId=void 0,this.tree=new o5(e&&e.maxEntries?e.maxEntries:9),this.idToNode=new Map,this.nodeToId=new Map}setMaps(e,t){this.idToNode.set(e.id,t),this.nodeToId.set(t,e.id)}toBBox(e){const t=[],n=[];let r;if("Polygon"===e.geometry.type)r=e.geometry.coordinates[0];else if("LineString"===e.geometry.type)r=e.geometry.coordinates;else{if("Point"!==e.geometry.type)throw new Error("Not a valid feature to turn into a bounding box");r=[e.geometry.coordinates]}for(let s=0;s<r.length;s++)n.push(r[s][1]),t.push(r[s][0]);const o=Math.min(...n),i=Math.max(...n);return{minX:Math.min(...t),minY:o,maxX:Math.max(...t),maxY:i}}insert(e){if(this.idToNode.get(String(e.id)))throw new Error("Feature already exists");const t=this.toBBox(e);this.setMaps(e,t),this.tree.insert(t)}load(e){const t=[],n=new Set;e.forEach(e=>{const r=this.toBBox(e);if(this.setMaps(e,r),n.has(String(e.id)))throw new Error(`Duplicate feature ID found ${e.id}`);n.add(String(e.id)),t.push(r)}),this.tree.load(t)}update(e){this.remove(e.id);const t=this.toBBox(e);this.setMaps(e,t),this.tree.insert(t)}remove(e){const t=this.idToNode.get(e);if(!t)throw new Error(`${e} not inserted into the spatial index`);this.tree.remove(t)}clear(){this.tree.clear()}search(e){return this.tree.search(this.toBBox(e)).map(e=>this.nodeToId.get(e))}collides(e){return this.tree.collides(this.toBBox(e))}}const s5={getId:()=>"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){const t=16*Math.random()|0;return("x"==e?t:3&t|8).toString(16)}),isValidId:e=>"string"==typeof e&&36===e.length};class a5{constructor(e){this.idStrategy=void 0,this.tracked=void 0,this.spatialIndex=void 0,this.store=void 0,this._onChange=()=>{},this.store={},this.spatialIndex=new i5,this.tracked=!e||!1!==e.tracked,this.idStrategy=e&&e.idStrategy?e.idStrategy:s5}clone(e){return JSON.parse(JSON.stringify(e))}getId(){return this.idStrategy.getId()}has(e){return Boolean(this.store[e])}load(e,t,n,r){if(0===e.length)return[];let o=this.clone(e);const i=[],s=[];o=o.filter(e=>{null==e.id&&(e.id=this.idStrategy.getId());const n=e.id;if(t){const r=t(e);if(!r.valid)return i.push({id:n,valid:!1,reason:r.reason}),!1}if(this.tracked){if(e.properties.createdAt){if(!a4(e.properties.createdAt))return i.push({id:e.id,valid:!1,reason:"createdAt is not a valid numeric timestamp"}),!1}else e.properties.createdAt=+new Date;if(e.properties.updatedAt){if(!a4(e.properties.updatedAt))return i.push({id:e.id,valid:!1,reason:"updatedAt is not a valid numeric timestamp"}),!1}else e.properties.updatedAt=+new Date}return this.has(n)?(i.push({id:n,valid:!1,reason:`Feature already exists with this id: ${n}`}),!1):(this.store[n]=e,s.push(e),i.push({id:n,valid:!0}),!0)}),this.spatialIndex.load(o);const a=s.map(({id:e})=>e);return a.length>0&&(this._onChange(a,"create",r),n&&s.forEach(e=>{n(e)})),i}search(e,t){const n=this.spatialIndex.search(e).map(e=>this.store[e]);return this.clone(t?n.filter(t):n)}registerOnChange(e){this._onChange=(t,n,r)=>{e(t,n,r)}}getGeometryCopy(e){const t=this.store[e];if(!t)throw new Error(`No feature with this id (${e}), can not get geometry copy`);return this.clone(t.geometry)}getPropertiesCopy(e){const t=this.store[e];if(!t)throw new Error(`No feature with this id (${e}), can not get properties copy`);return this.clone(t.properties)}updateProperty(e,t){const n=[];e.forEach(({id:e,property:t,value:r})=>{const o=this.store[e];if(!o)throw new Error(`No feature with this (${e}), can not update geometry`);n.push(e),void 0===r?delete o.properties[t]:o.properties[t]=r,this.tracked&&(o.properties.updatedAt=+new Date)}),this._onChange&&this._onChange(n,"update",t)}updateGeometry(e,t){const n=[];e.forEach(({id:e,geometry:t})=>{n.push(e);const r=this.store[e];if(!r)throw new Error(`No feature with this (${e}), can not update geometry`);r.geometry=this.clone(t),this.spatialIndex.update(r),this.tracked&&(r.properties.updatedAt=+new Date)}),this._onChange&&this._onChange(n,"update",t)}create(e,t){const n=[];return e.forEach(({geometry:e,properties:t})=>{let r,o=e4({},t);this.tracked&&(r=+new Date,t?(o.createdAt="number"==typeof t.createdAt?t.createdAt:r,o.updatedAt="number"==typeof t.updatedAt?t.updatedAt:r):o={createdAt:r,updatedAt:r});const i=this.getId(),s={id:i,type:"Feature",geometry:e,properties:o};this.store[i]=s,this.spatialIndex.insert(s),n.push(i)}),this._onChange&&this._onChange([...n],"create",t),n}delete(e,t){e.forEach(e=>{if(!this.store[e])throw new Error(`No feature with id ${e}, can not delete`);delete this.store[e],this.spatialIndex.remove(e)}),this._onChange&&this._onChange([...e],"delete",t)}copy(e){return this.clone(this.store[e])}copyAll(){return this.clone(Object.keys(this.store).map(e=>this.store[e]))}copyAllWhere(e){return this.clone(Object.keys(this.store).map(e=>this.store[e]).filter(t=>t.properties&&e(t.properties)))}clear(){this.store={},this.spatialIndex.clear()}size(){return Object.keys(this.store).length}}class l5{constructor({name:e,callback:t,unregister:n,register:r}){this.name=void 0,this.callback=void 0,this.registered=!1,this.register=void 0,this.unregister=void 0,this.name=e,this.register=()=>{this.registered||(this.registered=!0,r(t))},this.unregister=()=>{this.register&&(this.registered=!1,n(t))},this.callback=t}}var c5=class{constructor(e){this._nextKeyUpIsContextMenu=!1,this._lastPointerDownEventTarget=void 0,this._ignoreMismatchedPointerEvents=!1,this._minPixelDragDistance=void 0,this._minPixelDragDistanceDrawing=void 0,this._minPixelDragDistanceSelecting=void 0,this._lastDrawEvent=void 0,this._coordinatePrecision=void 0,this._heldKeys=new Set,this._listeners=[],this._dragState="not-dragging",this._currentModeCallbacks=void 0,this._ignoreMismatchedPointerEvents="boolean"==typeof e.ignoreMismatchedPointerEvents&&e.ignoreMismatchedPointerEvents,this._minPixelDragDistance="number"==typeof e.minPixelDragDistance?e.minPixelDragDistance:1,this._minPixelDragDistanceSelecting="number"==typeof e.minPixelDragDistanceSelecting?e.minPixelDragDistanceSelecting:1,this._minPixelDragDistanceDrawing="number"==typeof e.minPixelDragDistanceDrawing?e.minPixelDragDistanceDrawing:8,this._coordinatePrecision="number"==typeof e.coordinatePrecision?e.coordinatePrecision:9}getButton(e){return-1===e.button?"neither":0===e.button?"left":1===e.button?"middle":2===e.button?"right":"neither"}getMapElementXYPosition(e){const t=this.getMapEventElement(),{left:n,top:r}=t.getBoundingClientRect();return{containerX:e.clientX-n,containerY:e.clientY-r}}getDrawEventFromEvent(e,t=!1){const n=this.getLngLatFromEvent(e);if(!n)return null;const{lng:r,lat:o}=n,{containerX:i,containerY:s}=this.getMapElementXYPosition(e),a=this.getButton(e),l=Array.from(this._heldKeys);return{lng:p4(r,this._coordinatePrecision),lat:p4(o,this._coordinatePrecision),containerX:i,containerY:s,button:a,heldKeys:l,isContextMenu:t}}register(e){this._currentModeCallbacks=e,this._listeners=this.getAdapterListeners(),this._listeners.forEach(e=>{e.register()})}getCoordinatePrecision(){return this._coordinatePrecision}getAdapterListeners(){return[new l5({name:"pointerdown",callback:e=>{if(!this._currentModeCallbacks)return;if(!e.isPrimary)return;const t=this.getDrawEventFromEvent(e);t&&(this._dragState="pre-dragging",this._lastDrawEvent=t,this._lastPointerDownEventTarget=e.target?e.target:void 0)},register:e=>{this.getMapEventElement().addEventListener("pointerdown",e)},unregister:e=>{this.getMapEventElement().removeEventListener("pointerdown",e)}}),new l5({name:"pointermove",callback:e=>{if(!this._currentModeCallbacks)return;if(!e.isPrimary)return;e.preventDefault();const t=this.getDrawEventFromEvent(e);if(t)if("not-dragging"===this._dragState)this._currentModeCallbacks.onMouseMove(t),this._lastDrawEvent=t;else if("pre-dragging"===this._dragState){if(!this._lastDrawEvent)return;const e={x:this._lastDrawEvent.containerX,y:this._lastDrawEvent.containerY},n={x:t.containerX,y:t.containerY},r=this._currentModeCallbacks.getState(),o=_4(e,n);let i=!1;if(i="drawing"===r?o<this._minPixelDragDistanceDrawing:"selecting"===r?o<this._minPixelDragDistanceSelecting:o<this._minPixelDragDistance,i)return;this._nextKeyUpIsContextMenu=!1,this._dragState="dragging",this._currentModeCallbacks.onDragStart(t,e=>{this.setDraggability.bind(this)(e)})}else"dragging"===this._dragState&&this._currentModeCallbacks.onDrag(t,e=>{this.setDraggability.bind(this)(e)})},register:e=>{this.getMapEventElement().addEventListener("pointermove",e)},unregister:e=>{this.getMapEventElement().removeEventListener("pointermove",e)}}),new l5({name:"contextmenu",callback:e=>{this._currentModeCallbacks&&(e.preventDefault(),this._nextKeyUpIsContextMenu=!0)},register:e=>{this.getMapEventElement().addEventListener("contextmenu",e)},unregister:e=>{this.getMapEventElement().removeEventListener("contextmenu",e)}}),new l5({name:"pointerup",callback:e=>{if(!this._currentModeCallbacks)return;if(e.target!==this.getMapEventElement())return;if(this._ignoreMismatchedPointerEvents&&this._lastPointerDownEventTarget!==e.target)return;if(this._lastPointerDownEventTarget=void 0,!e.isPrimary)return;const t=this.getDrawEventFromEvent(e);t&&("dragging"===this._dragState?this._currentModeCallbacks.onDragEnd(t,e=>{this.setDraggability.bind(this)(e)}):"not-dragging"!==this._dragState&&"pre-dragging"!==this._dragState||(this._nextKeyUpIsContextMenu&&(t.isContextMenu=!0,this._nextKeyUpIsContextMenu=!1),this._currentModeCallbacks.onClick(t)),this._dragState="not-dragging",this.setDraggability(!0))},register:e=>{this.getMapEventElement().addEventListener("pointerup",e)},unregister:e=>{this.getMapEventElement().removeEventListener("pointerup",e)}}),new l5({name:"keyup",callback:e=>{this._currentModeCallbacks&&(this._heldKeys.delete(e.key),this._currentModeCallbacks.onKeyUp({key:e.key,heldKeys:Array.from(this._heldKeys),preventDefault:()=>e.preventDefault()}))},register:e=>{this.getMapEventElement().addEventListener("keyup",e)},unregister:e=>{this.getMapEventElement().removeEventListener("keyup",e)}}),new l5({name:"keydown",callback:e=>{this._currentModeCallbacks&&(this._heldKeys.add(e.key),this._currentModeCallbacks.onKeyDown({key:e.key,heldKeys:Array.from(this._heldKeys),preventDefault:()=>e.preventDefault()}))},register:e=>{this.getMapEventElement().addEventListener("keydown",e)},unregister:e=>{this.getMapEventElement().removeEventListener("keydown",e)}})]}unregister(){this._listeners.forEach(e=>{e.unregister()}),this.clear(),this._currentModeCallbacks=void 0,this._lastDrawEvent=void 0,this._lastPointerDownEventTarget=void 0,this._nextKeyUpIsContextMenu=!1}};function u5(e){if(null===e)return!0;if("boolean"==typeof e)return!0;if("string"==typeof e)return!0;if(void 0===e)return!1;if("number"==typeof e)return Number.isFinite(e);if("bigint"==typeof e)return!1;if("symbol"==typeof e)return!1;if("function"==typeof e)return!1;if(e instanceof RegExp)return!1;if(e instanceof Map)return!1;if(e instanceof Set)return!1;if(e instanceof Date)return!1;if("object"==typeof e&&null!==e&&!Array.isArray(e)){const t=Object.getPrototypeOf(e);if(t!==Object.prototype&&null!==t)return!1}if(ArrayBuffer.isView(e)&&!(e instanceof DataView))return!1;if(Array.isArray(e))for(const t of e)if(!u5(t))return!1;return"object"==typeof e&&Object.keys(e).every(t=>"string"==typeof t&&u5(e[t]))}class d5{constructor(e){this._modes=void 0,this._mode=void 0,this._adapter=void 0,this._enabled=!1,this._store=void 0,this._eventListeners=void 0,this._instanceSelectMode=void 0,this._adapter=e.adapter,this._mode=new H4;const t=new Set,n=e.modes.reduce((e,n)=>{if(t.has(n.mode))throw new Error(`There is already a ${n.mode} mode provided`);return t.add(n.mode),e[n.mode]=n,e},{}),r=Object.keys(n);if(0===r.length)throw new Error("No modes provided");r.forEach(e=>{if(n[e].type===l4.Select){if(this._instanceSelectMode)throw new Error("only one type of select mode can be provided");this._instanceSelectMode=e}}),this._modes=e4({},n,{static:this._mode}),this._eventListeners={change:[],select:[],deselect:[],finish:[],ready:[]},this._store=new a5({tracked:!!e.tracked,idStrategy:e.idStrategy?e.idStrategy:void 0});const o=e=>{const t=[],n=this._store.copyAll().filter(n=>!e.includes(n.id)||(t.push(n),!1));return{changed:t,unchanged:n}},i=(e,t)=>{this._enabled&&this._eventListeners.finish.forEach(n=>{n(e,t)})},s=(e,t,n)=>{if(!this._enabled)return;this._eventListeners.change.forEach(r=>{r(e,t,n)});const{changed:r,unchanged:i}=o(e);"create"===t?this._adapter.render({created:r,deletedIds:[],unchanged:i,updated:[]},this.getModeStyles()):"update"===t?this._adapter.render({created:[],deletedIds:[],unchanged:i,updated:r},this.getModeStyles()):"delete"===t?this._adapter.render({created:[],deletedIds:e,unchanged:i,updated:[]},this.getModeStyles()):"styling"===t&&this._adapter.render({created:[],deletedIds:[],unchanged:i,updated:[]},this.getModeStyles())},a=e=>{if(!this._enabled)return;this._eventListeners.select.forEach(t=>{t(e)});const{changed:t,unchanged:n}=o([e]);this._adapter.render({created:[],deletedIds:[],unchanged:n,updated:t},this.getModeStyles())},l=e=>{if(!this._enabled)return;this._eventListeners.deselect.forEach(e=>{e()});const{changed:t,unchanged:n}=o([e]);t&&this._adapter.render({created:[],deletedIds:[],unchanged:n,updated:t},this.getModeStyles())};Object.keys(this._modes).forEach(e=>{this._modes[e].register({mode:e,store:this._store,setCursor:this._adapter.setCursor.bind(this._adapter),project:this._adapter.project.bind(this._adapter),unproject:this._adapter.unproject.bind(this._adapter),setDoubleClickToZoom:this._adapter.setDoubleClickToZoom.bind(this._adapter),onChange:s,onSelect:a,onDeselect:l,onFinish:i,coordinatePrecision:this._adapter.getCoordinatePrecision()})})}checkEnabled(){if(!this._enabled)throw new Error("Terra Draw is not enabled")}getModeStyles(){const e={};return Object.keys(this._modes).forEach(t=>{e[t]=e=>this._instanceSelectMode&&e.properties[r4.SELECTED]?this._modes[this._instanceSelectMode].styleFeature.bind(this._modes[this._instanceSelectMode])(e):this._modes[t].styleFeature.bind(this._modes[t])(e)}),e}featuresAtLocation({lng:e,lat:t},n){const r=n&&void 0!==n.pointerDistance?n.pointerDistance:30,o=!n||void 0===n.ignoreSelectFeatures||n.ignoreSelectFeatures,i=!(!n||void 0===n.ignoreCoordinatePoints)&&n.ignoreCoordinatePoints,s=!(!n||void 0===n.ignoreCurrentlyDrawing)&&n.ignoreCurrentlyDrawing,a=!(!n||void 0===n.ignoreClosingPoints)&&n.ignoreClosingPoints,l=!(!n||void 0===n.ignoreSnappingPoints)&&n.ignoreSnappingPoints,c=this._adapter.unproject.bind(this._adapter),u=this._adapter.project.bind(this._adapter),d=u(e,t),A=S4({unproject:c,point:d,pointerDistance:r});return this._store.search(A).filter(c=>{if(o&&(c.properties[r4.MID_POINT]||c.properties[r4.SELECTION_POINT]))return!1;if(i&&c.properties[o4.COORDINATE_POINT])return!1;if(a&&c.properties[o4.CLOSING_POINT])return!1;if(s&&c.properties[o4.CURRENTLY_DRAWING])return!1;if(l&&c.properties[o4.SNAPPING_POINT])return!1;if("Point"===c.geometry.type){const e=c.geometry.coordinates,t=u(e[0],e[1]);return _4(d,t)<r}if("LineString"===c.geometry.type){const e=c.geometry.coordinates;for(let t=0;t<e.length-1;t++){const n=e[t],o=e[t+1];if(z4(d,u(n[0],n[1]),u(o[0],o[1]))<r)return!0}return!1}if(function(e,t){let n=!1;for(let s=0,a=t.length;s<a;s++){const a=t[s];for(let t=0,s=a.length,l=s-1;t<s;l=t++)(o=a[t])[1]>(r=e)[1]!=(i=a[l])[1]>r[1]&&r[0]<(i[0]-o[0])*(r[1]-o[1])/(i[1]-o[1])+o[0]&&(n=!n)}var r,o,i;return n}([e,t],c.geometry.coordinates))return!0;if(null!=n&&n.includePolygonsWithinPointerDistance){const e=c.geometry.coordinates;for(const t of e)for(let e=0;e<t.length-1;e++){const n=t[e],o=t[e+1],i=u(n[0],n[1]),s=u(o[0],o[1]);if(z4(d,i,s)<r)return!0}}return!1}).map(r=>{if(null==n||!n.addClosestCoordinateInfoToProperties)return r;let o;if("Polygon"===r.geometry.type)o=r.geometry.coordinates[0].slice(0,-1);else{if("LineString"!==r.geometry.type)return r;o=r.geometry.coordinates}let i,s=-1,a=1/0;for(let e=0;e<o.length;e++){const t=o[e],n=_4(u(t[0],t[1]),d);n<a&&(s=e,a=n,i=t)}return r.properties.closestCoordinateIndexToEvent=s,r.properties.closestCoordinatePixelDistanceToEvent=a,r.properties.closestCoordinateDistanceKmToEvent=d4(i,[e,t]),r})}getSelectModeOrThrow(){const e=this.getSelectMode({switchToSelectMode:!0});if(!e)throw new Error("No select mode defined in instance");return e}getSelectMode({switchToSelectMode:e}){if(this.checkEnabled(),!this._instanceSelectMode)return null;const t=this.getMode();return e&&t!==this._instanceSelectMode&&this.setMode(this._instanceSelectMode),this._modes[this._instanceSelectMode]}isGuidanceFeature(e){return Boolean(e.properties[r4.MID_POINT]||e.properties[r4.SELECTION_POINT]||e.properties[o4.COORDINATE_POINT]||e.properties[o4.SNAPPING_POINT])}setModeStyles(e,t){if(this.checkEnabled(),!this._modes[e])throw new Error("No mode with this name present");this._modes[e].styles=t}updateModeOptions(e,t){if(this.checkEnabled(),!this._modes[e])throw new Error("No mode with this name present");this._modes[e].updateOptions(t)}getSnapshot(){return this._store.copyAll()}getSnapshotFeature(e){if(this._store.has(e))return this._store.copy(e)}clear(){this.checkEnabled(),this._adapter.clear()}get enabled(){return this._enabled}set enabled(e){throw new Error("Enabled is read only")}getMode(){return this._mode.mode}getModeState(){return this._mode.state}setMode(e){if(this.checkEnabled(),!this._modes[e])throw new Error("No mode with this name present");this._mode.stop(),this._mode=this._modes[e],this._mode.start()}removeFeatures(e){this.checkEnabled();const t=[];e.forEach(e=>{if(!this._store.has(e))throw new Error(`No feature with id ${e}, can not delete`);const n=this._store.copy(e);n.properties[r4.SELECTED]&&this.deselectFeature(e),n.properties[o4.COORDINATE_POINT_IDS]&&t.push(...n.properties[o4.COORDINATE_POINT_IDS])}),this._store.delete([...e,...t],{origin:"api"})}selectFeature(e){this.getSelectModeOrThrow().selectFeature(e)}deselectFeature(e){this.getSelectModeOrThrow().deselectFeature(e)}getFeatureId(){return this._store.getId()}hasFeature(e){return this._store.has(e)}checkIsReservedProperty(e){return![...Object.values(r4),...Object.values(o4)].includes(e)}updateFeatureProperties(e,t){if(!this._store.has(e))throw new Error(`No feature with id ${e} present in store`);const n=this._store.copy(e);if(this.isGuidanceFeature(n))throw new Error("Guidance features are not allowed to be updated directly.");const r=n.properties.mode;if(!this._modes[r])throw new Error(`No mode with name ${r} present in instance`);const o=Object.entries(t);o.forEach(([e,t])=>{if(!this.checkIsReservedProperty(e))throw new Error(`You are trying to update a reserved property name: ${e}. Please choose another name.`);if(void 0!==t&&!u5(t))throw new Error(`Invalid JSON value provided for property ${e}`)}),this._store.updateProperty(o.map(([e,t])=>({id:n.id,property:e,value:t})),{origin:"api"})}updateFeatureGeometry(e,t){if(!this._store.has(e))throw new Error(`No feature with id ${e} present in store`);const n=this._store.copy(e);if(this.isGuidanceFeature(n))throw new Error("Guidance features are not allowed to be updated directly.");if(!(n&&t&&t.type&&t.coordinates))throw new Error("Invalid geometry provided");if(t.type!==n.geometry.type)throw new Error(`Geometry type mismatch: expected ${n.geometry.type}, got ${t.type}`);const r=n.properties.mode,o=this._modes[r];if(!o)throw new Error(`No mode with name ${r} present in instance`);const i=e4({},n,{geometry:t}),s=o.validateFeature(i);if(!s.valid)throw new Error(`Feature validation failed: ${s.reason||"Unknown reason"}`);if(this._store.updateGeometry([{id:n.id,geometry:t}],{origin:"api"}),o.afterFeatureUpdated){o.afterFeatureUpdated(i);const e=i.properties[r4.SELECTED],t=this.getSelectMode({switchToSelectMode:!1});t&&e&&t.afterFeatureUpdated(i)}}transformFeatureGeometry(e,t){if(!this._store.has(e))throw new Error(`No feature with id ${e} present in store`);let n=this._store.copy(e);if(this.isGuidanceFeature(n))throw new Error("Guidance features are not allowed to be updated directly.");const r=n.properties.mode,o=this._modes[r];if(!o)throw new Error(`No mode with name ${r} present in instance`);let i;if("Polygon"===n.geometry.type)i=n.geometry.coordinates[0];else{if("LineString"!==n.geometry.type)throw new Error(`Feature geometry type ${n.geometry.type} is not supported for transformation`);i=n.geometry.coordinates}if("web-mercator"!=t.projection)throw new Error(`Projection ${t.projection} is not currently supported for transformation`);if("scale"===t.type){const{x:e,y:n}=y4(t.origin[0],t.origin[1]);!function({coordinates:e,originX:t,originY:n,xScale:r,yScale:o}){1===r&&1===o||e.forEach(e=>{const{x:i,y:s}=y4(e[0],e[1]),a=t+(i-t)*r,l=n+(s-n)*o,{lng:c,lat:u}=v4(a,l);e[0]=c,e[1]=u})}({coordinates:i,originX:e,originY:n,xScale:t.options.xScale||1,yScale:t.options.yScale||1})}else"rotate"===t.type&&(n=((e,t)=>{if(0===t||360===t||-360===t)return e;const n=.017453292519943295*t,r=("Polygon"===e.geometry.type?e.geometry.coordinates[0]:e.geometry.coordinates).map(([e,t])=>y4(e,t)),o=r.reduce((e,t)=>({x:e.x+t.x,y:e.y+t.y}),{x:0,y:0});o.x/=r.length,o.y/=r.length;const i=r.map(e=>({x:o.x+(e.x-o.x)*Math.cos(n)-(e.y-o.y)*Math.sin(n),y:o.y+(e.x-o.x)*Math.sin(n)+(e.y-o.y)*Math.cos(n)})).map(({x:e,y:t})=>[v4(e,t).lng,v4(e,t).lat]);return"Polygon"===e.geometry.type?e.geometry.coordinates[0]=i:e.geometry.coordinates=i,e})(n,t.options.angle||0),i="Polygon"===n.geometry.type?n.geometry.coordinates[0]:n.geometry.coordinates);if(i=i.map(e=>[p4(e[0],this._adapter.getCoordinatePrecision()),p4(e[1],this._adapter.getCoordinatePrecision())]),n.geometry.coordinates="Polygon"===n.geometry.type?[i]:i,this._store.updateGeometry([{id:n.id,geometry:n.geometry}],{origin:"api"}),o.afterFeatureUpdated){o.afterFeatureUpdated(n);const e=n.properties[r4.SELECTED],t=this.getSelectMode({switchToSelectMode:!1});t&&e&&t.afterFeatureUpdated(n)}}addFeatures(e){return this.checkEnabled(),0===e.length?[]:this._store.load(e,e=>{if(s4(e)){const t=e.properties.mode,n=this._modes[t];if(!n)return{id:e.id,valid:!1,reason:`${t} mode is not in the list of instantiated modes`};const r=n.validateFeature.bind(n)(e);return{id:e.id,valid:r.valid,reason:r.reason?r.reason:r.valid?void 0:"Feature is invalid"}}return{id:e.id,valid:!1,reason:"Mode property does not exist"}},e=>{if(s4(e)){const t=this._modes[e.properties.mode];t&&t.afterFeatureAdded&&t.afterFeatureAdded(e)}},{origin:"api"})}start(){this._enabled||(this._enabled=!0,this._adapter.register({onReady:()=>{this._eventListeners.ready.forEach(e=>{e()})},getState:()=>this._mode.state,onClick:e=>{this._mode.onClick(e)},onMouseMove:e=>{this._mode.onMouseMove(e)},onKeyDown:e=>{this._mode.onKeyDown(e)},onKeyUp:e=>{this._mode.onKeyUp(e)},onDragStart:(e,t)=>{this._mode.onDragStart(e,t)},onDrag:(e,t)=>{this._mode.onDrag(e,t)},onDragEnd:(e,t)=>{this._mode.onDragEnd(e,t)},onClear:()=>{this._mode.cleanUp(),this._store.clear()}}))}getFeaturesAtLngLat(e,t){const{lng:n,lat:r}=e;return this.featuresAtLocation({lng:n,lat:r},t)}getFeaturesAtPointerEvent(e,t){const n=this._adapter.getLngLatFromEvent.bind(this._adapter)(e);return null===n?[]:this.featuresAtLocation(n,t)}stop(){this._enabled&&(this._enabled=!1,this._adapter.unregister())}on(e,t){const n=this._eventListeners[e];n.includes(t)||n.push(t)}off(e,t){const n=this._eventListeners[e];n.includes(t)&&n.splice(n.indexOf(t),1)}}class A5 extends c5{constructor(e){super(e),this._cursor=void 0,this._cursorStyleSheet=void 0,this._lib=void 0,this._map=void 0,this._overlay=void 0,this._clickEventListener=void 0,this._mouseMoveEventListener=void 0,this._readyCalled=!1,this.renderedFeatureIds=new Set,this._lib=e.lib,this._map=e.map,this._coordinatePrecision="number"==typeof e.coordinatePrecision?e.coordinatePrecision:9}get _layers(){var e;return Boolean((null==(e=this.renderedFeatureIds)?void 0:e.size)>0)}circlePath(e,t,n){const r=2*n;return`M ${e} ${t} m -${n}, 0 a ${n},${n} 0 1,0 ${r},0 a ${n},${n} 0 1,0 -${r},0`}register(e){super.register(e),this._overlay=new this._lib.OverlayView,this._overlay.draw=function(){},this._overlay.onAdd=()=>{var e;null!=(e=this._currentModeCallbacks)&&e.onReady&&!this._readyCalled&&(this._currentModeCallbacks.onReady(),this._readyCalled=!0)},this._overlay.setMap(this._map),this._overlay.onRemove=()=>{},this._clickEventListener=this._map.data.addListener("click",e=>{const t=this._listeners.find(({name:e})=>"click"===e);t&&t.callback(e)}),this._mouseMoveEventListener=this._map.data.addListener("mousemove",e=>{const t=this._listeners.find(({name:e})=>"mousemove"===e);t&&t.callback(e)})}unregister(){var e,t;super.unregister(),null==(e=this._clickEventListener)||e.remove(),null==(t=this._mouseMoveEventListener)||t.remove(),this._overlay&&this._overlay.getMap()&&this._overlay.setMap(null),this._overlay=void 0,this._readyCalled=!1}getLngLatFromEvent(e){if(!this._overlay)throw new Error("cannot get overlay");const t=this._map.getBounds();if(!t)return null;const n=t.getNorthEast(),r=t.getSouthWest(),o=new this._lib.LatLngBounds(r,n),i=this._map.getDiv(),s=e.clientX-i.getBoundingClientRect().left,a=e.clientY-i.getBoundingClientRect().top,l=new this._lib.Point(s,a),c=this._overlay.getProjection();if(!c)return null;const u=c.fromContainerPixelToLatLng(l);return u&&o.contains(u)?{lng:u.lng(),lat:u.lat()}:null}getMapEventElement(){return this._map.getDiv().querySelector('div[style*="z-index: 3;"]')}project(e,t){if(!this._overlay)throw new Error("cannot get overlay");if(void 0===this._map.getBounds())throw new Error("cannot get bounds");const n=this._overlay.getProjection();if(void 0===n)throw new Error("cannot get projection");const r=n.fromLatLngToContainerPixel(new this._lib.LatLng(t,e));if(null===r)throw new Error("cannot project coordinates");return{x:r.x,y:r.y}}unproject(e,t){if(!this._overlay)throw new Error("cannot get overlay");const n=this._overlay.getProjection();if(void 0===n)throw new Error("cannot get projection");const r=n.fromContainerPixelToLatLng(new this._lib.Point(e,t));if(null===r)throw new Error("cannot unproject coordinates");return{lng:r.lng(),lat:r.lat()}}setCursor(e){if(e!==this._cursor){if(this._cursorStyleSheet&&(this._cursorStyleSheet.remove(),this._cursorStyleSheet=void 0),"unset"!==e){const t=this._map.getDiv().querySelector(".gm-style > div");if(t){t.classList.add("terra-draw-google-maps");const n=document.createElement("style");n.innerHTML=`.terra-draw-google-maps { cursor: ${e} !important; }`,document.getElementsByTagName("head")[0].appendChild(n),this._cursorStyleSheet=n}}this._cursor=e}}setDoubleClickToZoom(e){this._map.setOptions(e?{disableDoubleClickZoom:!1}:{disableDoubleClickZoom:!0})}setDraggability(e){this._map.setOptions({draggable:e})}render(e,t){this._layers&&(e.deletedIds.forEach(e=>{const t=this._map.data.getFeatureById(e);t&&(this._map.data.remove(t),this.renderedFeatureIds.delete(e))}),e.updated.forEach(e=>{if(!e||!e.id)throw new Error("Feature is not valid");const t=this._map.data.getFeatureById(e.id);if(!t)throw new Error("Feature could not be found by Google Maps API");switch(t.forEachProperty((e,n)=>{t.setProperty(n,void 0)}),Object.keys(e.properties).forEach(n=>{t.setProperty(n,e.properties[n])}),e.geometry.type){case"Point":{const n=e.geometry.coordinates;t.setGeometry(new this._lib.Data.Point(new this._lib.LatLng(n[1],n[0])))}break;case"LineString":{const n=e.geometry.coordinates,r=[];for(let e=0;e<n.length;e++){const t=n[e],o=new this._lib.LatLng(t[1],t[0]);r.push(o)}t.setGeometry(new this._lib.Data.LineString(r))}break;case"Polygon":{const n=e.geometry.coordinates,r=[];for(let e=0;e<n.length;e++){const t=[];for(let r=0;r<n[e].length;r++){const o=new this._lib.LatLng(n[e][r][1],n[e][r][0]);t.push(o)}r.push(t)}t.setGeometry(new this._lib.Data.Polygon(r))}}}),e.created.forEach(e=>{this.renderedFeatureIds.add(e.id),this._map.data.addGeoJson(e)})),e.created.forEach(e=>{this.renderedFeatureIds.add(e.id)});const n={type:"FeatureCollection",features:[...e.created]};this._map.data.addGeoJson(n),this._map.data.setStyle(e=>{const n=e.getProperty("mode"),r=e.getGeometry();if(!r)throw new Error("Google Maps geometry not found");const o=r.getType(),i={},s=e.getId();e.forEachProperty((e,t)=>{i[t]=e});const a=t[n]({type:"Feature",id:s,geometry:{type:o,coordinates:[]},properties:i});switch(o){case"Point":return a.markerUrl?{clickable:!1,icon:{url:a.markerUrl,scaledSize:a.markerWidth&&a.markerHeight?new this._lib.Size(a.markerWidth,a.markerHeight):void 0},zIndex:a.zIndex}:{clickable:!1,icon:{path:this.circlePath(0,0,a.pointWidth),fillColor:a.pointColor,fillOpacity:1,strokeColor:a.pointOutlineColor,strokeWeight:a.pointOutlineWidth,rotation:0,scale:1},zIndex:a.zIndex};case"LineString":return{strokeColor:a.lineStringColor,strokeWeight:a.lineStringWidth,zIndex:a.zIndex};case"Polygon":return{strokeColor:a.polygonOutlineColor,strokeWeight:a.polygonOutlineWidth,fillOpacity:a.polygonFillOpacity,fillColor:a.polygonFillColor,zIndex:a.zIndex}}throw Error("Unknown feature type")})}clearLayers(){this._layers&&(this._map.data.forEach(e=>{const t=e.getId();this.renderedFeatureIds.has(t)&&this._map.data.remove(e)}),this.renderedFeatureIds=new Set)}clear(){this._currentModeCallbacks&&(this._currentModeCallbacks.onClear(),this.clearLayers())}getCoordinatePrecision(){return super.getCoordinatePrecision()}}const h5=e=>{const t=[],n=/\*\*(.*?)\*\*/g;let r,o=0;for(;null!==(r=n.exec(e));)r.index>o&&t.push({text:e.slice(o,r.index),bold:!1}),t.push({text:r[1],bold:!0}),o=n.lastIndex;return o<e.length&&t.push({text:e.slice(o),bold:!1}),0===t.length&&t.push({text:e,bold:!1}),t},p5=()=>{const{mapMode:e,selectedRoute:t,showIndividualMarkers:n,setDynamicIslandHeight:r,leftPanelExpanded:o,currentFolder:i,activePanel:a,selectedRoutePanelVisible:l,roadPriorityPanelOpen:c,priorityFilterPanelExpanded:u,routeNamingDialogOpen:d}=JN(),A=pe.useRef(null),h=JN(e=>e.routes?.length||0),p=$N(e=>e.uploadedRoutes?.routes?.length||0),f=$N(e=>e.polygonDrawing.completedPolygon?1:0),g=$N(e=>e.polygonDrawing.isDrawing),m=$N(e=>e.selectedUploadedRouteId),y=$N(e=>e.isAddingWaypoint),v=$N(e=>!!e.individualRoute.generatedRoute),b=$N(e=>e.segmentation.isActive),w=$N(e=>e.segmentation.type),x=$N(e=>e.segmentation.previewSegments.length),_=$N(e=>e.lassoDrawing.completedPolygon),C=$N(e=>e.lassoDrawing.confirmed),S=$N(e=>e.lassoDrawing.isDrawing),E=$N(e=>e.selectedRoadPriorities),B=$N(e=>e.roadImport.selectionMode);$N(e=>e.roadImport);const I=$N(e=>e.roadImport.routeInMaking),R=$N(e=>e.roadImport.routeInMakingRoadIds),k=$N(e=>e.roadImport.multiSelectValidationResult),T=$N(e=>e.roadImport.multiSelectValidating),P=JN(e=>e.projectId),F=JN(e=>e.pendingFile),M=Lj(e=>e.show_instructions),{isIngesting:L}=X3(),U=uX({projectId:P||void 0,polygon:_,priorities:E,confirmed:C}),O=U.data?.length||0,D=null!==m||null!==t&&(h>0||p>0),[N,j]=pe.useState(!0),[Q,z]=pe.useState(null),[H,G]=pe.useState([]),V=pe.useRef(null),W=kw(e=>e.messages),$=W.length>0?W[W.length-1]:null,K=pe.useMemo(()=>{let r,A=null;switch(r=d?"route_naming_dialog":F&&"upload_routes"===e?"processing_file":c?"road_priority_selection":"view"!==e&&"individual_editing"!==e&&"route_editing"!==e?e:y?"adding_waypoint":l&&"view"===e?"editing_uploaded_route":D&&"view"===e?t&&!m?"viewing_saved_route":"editing_selected_route":!o||"view"!==e||D||l?0!==h||0!==p||"view"!==e||y?e:"home_view":"uploaded_routes"===a?"uploaded_routes_panel":"routes_panel_expanded",r){case"route_naming_dialog":A={title:"Configure Route Names",shortDescription:"Choose how to name your routes: use a feature property (if available) or enter a custom name. Each route will be numbered sequentially.",description:"Configure how your routes will be named. You can use a property from your GeoJSON features (if available), or enter a custom name. Routes will be numbered sequentially (e.g., My Route 1, My Route 2, etc.). Click Continue when you're ready.",multiLineDescription:["Use a **feature property** or **custom name**","Routes numbered sequentially","Click **Continue** when ready"]};break;case"processing_file":A={title:"Processing File",shortDescription:"Please wait while we analyze your file and extract route information.",description:"We're currently processing your uploaded file. This may take a few moments depending on the file size. Please wait while we analyze the file and extract route information.",multiLineDescription:["**Analyzing** your uploaded file","This may take a moment"],icon:s.jsx(Yd,{size:20,thickness:4})};break;case"road_priority_selection":A={title:"Select Road Priorities",shortDescription:"Choose which road priorities to import. Select categories or individual priorities, then confirm to import roads.",description:"Select the road priorities you want to import from the drawn polygon area. You can expand categories to see individual priorities, or select entire categories at once. Only roads matching your selected priorities will be imported. Click Confirm when you're ready.",multiLineDescription:["Select **categories** or **individual priorities**","Only matching roads will be imported","Click **Confirm** when ready"]};break;case"home_view":A={title:"Getting Started",shortDescription:"Click 'Add Routes' to upload routes, draw a new route, or import roads from an area.",description:"Welcome to your project workspace. Click the 'Add Routes' button to see options: From File (GeoJSON) (for GeoJSON files), Draw Route (to manually draw on the map), or Import Roads (to select an area and import all roads within it).",multiLineDescription:["Click **Add Routes** to get started","Choose: **From File (GeoJSON)**, **Draw Route**, or **Import Roads**"]};break;case"routes_panel_expanded":A=i?{title:"Routes in Folder",shortDescription:"Click any route to view details, edit, or navigate to it. Use 'Select Routes' to batch move or delete multiple routes.",description:"You're viewing routes in this folder. Click any route to view its details, edit it, or navigate to it on the map. Use the 'Select Routes' button to select multiple routes and batch move them to another folder or delete them. Click the menu () on any route for more options like editing or viewing the original uploaded route.",multiLineDescription:["**Click** any route to view or edit","Use **Select Routes** for batch operations","**Move** or **delete** multiple routes"]}:{title:"Your Routes",shortDescription:"Browse your routes organized by folders. Click any folder to view its routes, or use the search to find specific folders.",description:"Browse your routes organized by folders. Each folder groups related routes together. Click any folder to view the routes inside it. Use the search bar to quickly find folders by name. Routes without a folder appear in the 'Untagged' folder.",multiLineDescription:["**Click** any folder to view routes","**Search** to find specific folders","Routes grouped by **folders**"]};break;case"uploaded_routes_panel":A={title:"Uploaded Routes",shortDescription:"Review your uploaded routes with distance and match %. Select a route to edit or add waypoints. Create return routes directly from each route item.",description:"Your uploaded routes are displayed here with their Google-optimized versions. Each route shows distance and match percentage. Select a route to review it in detail, add waypoints, or swap start/end points. You can create return routes directly from each route item. Click save to choose a folder and save all routes.",multiLineDescription:[" **Select** a route to edit or add waypoints"," **Create** a return route for each item"," **Click save** to choose folder and save"]};break;case"adding_waypoint":A={title:"Adding Waypoint",shortDescription:"Click on the map to add a waypoint",description:"Click on the map to add a waypoint",multiLineDescription:["**Click** on the map to add a waypoint"]};break;case"viewing_saved_route":A={title:"Viewing Your Route",shortDescription:"View route details including distance, type, status, and folder. Use the buttons to modify or delete the route.",description:"You're viewing a saved route. Route details including distance, type, status, folder, and segments (if applicable) are displayed in the panel on the right. You can rename the route using the Edit icon in the header, modify the route path, or delete it using the buttons at the bottom.",multiLineDescription:["View route **details**: distance, type, status, folder","Use buttons to **modify** or **delete** the route"]};break;case"editing_selected_route":A={title:"Editing Your Route",shortDescription:"Make a route in reverse, flip your current route, or add waypoints to get a more accurate match.",description:"Make a route in reverse, flip your current route, or add waypoints to get a more accurate match.",multiLineDescription:["**Reverse** route, **flip** it, or","**Add waypoints** for better match"]};break;case"editing_uploaded_route":A={title:"Reviewing Uploaded Route",shortDescription:"Adjust your route to match your uploaded route, then save or discard when done.",description:"You're reviewing an uploaded route. Compare the Google-optimized route (purple when selected) with your original uploaded route (yellow). Adjust your route by adding waypoints, reordering them, or swapping start/end points to better match your uploaded route. When you're satisfied, click Save to apply changes or Discard to cancel.",multiLineDescription:["Adjust your route to **match** your uploaded route","**Save** or **Discard** when done"]};break;case"individual_drawing":if(b)A="manual"===w?{title:"Manual Segmentation",shortDescription:"Click on the route to add cut points, or use Auto-Segment to segment at intersections automatically.",description:"In manual mode, you can click anywhere on the route where you want to create a segment boundary. Each click adds a cut point that splits the route into separate segments. Alternatively, use the Auto-Segment button to automatically segment the route at road intersections.",multiLineDescription:["**Click** on route to add cut points","Or use **Auto-Segment** button for automatic segmentation"]}:"distance"===w?{title:"Distance Segmentation",shortDescription:"Enter segment distance and click OK to generate segments.",description:"Enter the distance for each segment in the input field and click OK to generate segments. The route will be automatically divided into segments of the specified length.",multiLineDescription:["**Enter** segment distance and click **OK** to generate segments"]}:{title:"Segmenting Your Route",shortDescription:"Choose how to segment: Distance splits by segment length, or Manual lets you place cut points or use Auto-Segment button. Use the panel on the right to configure.",description:"Choose your segmentation method: Distance splits the route into segments of equal length, or Manual lets you place cut points manually or use the Auto-Segment button to segment at intersections automatically. Use the panel on the right to configure your segmentation.",multiLineDescription:["Choose method: **Distance** or **Manual**","Manual: place cut points or use **Auto-Segment** button","Configure in the **right panel**"]};else if(n)A={title:"Drawing Your Route",shortDescription:"Click on the map to add points (up to 25 points). You need at least 2 points (origin and destination).",description:"Click on the map to add points (up to 25 points). You need at least 2 points (origin and destination). Drag routes in the right panel to reorder them.",multiLineDescription:["**Click** map to add points (up to **25** points)","Need at least **2 points** (origin & destination)"]};else if(v){A=x>0&&!b?{title:"Saving Your Route",shortDescription:"Enter a Route Name and select or create a folder to save your route and its segments. Use the panel on the right.",description:"Enter a Route Name for your route and select or create a folder to organize it. Each segment will be saved with your route. Use the panel on the right to enter these details.",multiLineDescription:["Enter **Route Name** and **folder**","Save route and segments in **right panel**"]}:{title:"Route Ready",shortDescription:"Your route is ready. Segment it or save it directly. When saving, enter a Route Name and select or create a folder in the panel on the right.",description:"Your route is ready. You can segment it to break it into smaller, manageable sections for better organization, or save it directly as one complete route. When saving, you'll need to enter a Route Name and select or create a folder to organize your route. Use the panel on the right to choose your action.",multiLineDescription:["Route is ready","**Segment** it or **save** directly","Enter **Route Name** and **folder** in right panel"]}}else A={title:"Drawing Your Route",shortDescription:"Click on the map to start drawing your route. Continue clicking to add waypoints and shape your path. Drag routes in the right panel to reorder them.",description:"Click on the map to start drawing your route. Continue clicking to add waypoints and shape your path. Each click adds a new waypoint to your route. You can drag routes in the right panel to reorder them. Right-click or press Enter when you're done.",multiLineDescription:["**Click** map to start drawing","Continue clicking to add waypoints","**Drag** in right panel to reorder"]};break;case"polygon_drawing":A=L?{title:"Importing Roads",shortDescription:"Please wait while we import roads from the selected area. This may take a moment.",description:"We're currently importing roads from the selected polygon area. This process may take a few moments depending on the size of the area and the number of roads. Please wait while we process your selection.",multiLineDescription:["**Importing** roads from selected area","This may take a moment"],icon:s.jsx(Yd,{size:20,thickness:4})}:{title:"Selecting an Area",shortDescription:"You're drawing a polygon to import all roads in this area.",description:"You're currently selecting an area on the map. As you click to outline your polygon, all the roads that fall within this boundary will be automatically imported into your project. Take your time to carefully draw the area you want to cover. When you're done, double-click or press Enter to finish and see all the roads that match your selection.",multiLineDescription:["**Click** map to draw polygon boundary","All roads will be **imported** automatically","**Double-click** or **Enter** when finished"]};break;case"lasso_selection":if(_){A={title:"Select Road Priorities",shortDescription:"Choose which road priorities to include. Use the panel on the right to filter and save your selected roads.",description:"Your selection is complete. Now select which road priorities you want to include from the selected area. Use the panel on the right to expand categories, select priorities, and filter the roads. Once you've confirmed your selection, enter a folder and save all matching roads as routes.",multiLineDescription:["Selection complete",U.isFetching?"**Loading** roads...":`**${O}** road${1===O?"":"s"} match your filter`,"**Select** priorities in right panel","**Select Folder** and **save** when ready"]}}else A=S?{title:"Selecting Roads",shortDescription:"Click and drag to draw a freeform shape around the roads you want to select.",description:"You're selecting roads on the map. Click and drag to create a freeform shape around the roads you want to select. Click any point to complete the selection. All roads within your shape will be available for you to filter by priority and save as routes.",multiLineDescription:["**Click and drag** to draw freeform shape","**Click any point** to complete"]}:{title:"Select Roads",shortDescription:"Click and drag on the map to draw a freeform shape around roads you want to select.",description:"Use Select Roads to choose roads by drawing a freeform shape on the map. Click and drag to create your selection area. Click any point to complete the selection. All roads within your shape will be displayed, and you can filter them by road priority before saving as routes.",multiLineDescription:["**Click and drag** to draw freeform shape","**Click any point** to complete","**Filter** by priority and **save** as routes"]};break;case"individual_editing":A={title:"Adjusting Your Route",shortDescription:"You can drag any marker to adjust the route path.",description:"You're now editing your route. You can drag any marker to a new position and the route will automatically adjust to follow your changes. If you want to add more waypoints, simply click anywhere along the route line. Your route is flexible, so feel free to experiment until it follows exactly the path you envision.",multiLineDescription:["**Drag** any marker to adjust route","**Click** on route to add waypoints"]};break;case"route_editing":A={title:"Refining Your Route",shortDescription:"You're fine-tuning waypoints to perfect your route.",description:"You're making changes to your route. Drag any waypoint to reposition it, or add new ones by clicking on the route. The system will recalculate the path as you work. Once you're happy with how the route looks, click 'Save' to commit your changes and make them permanent.",multiLineDescription:["**Drag** waypoints to reposition","**Click** route to add new waypoints","**Save** when ready"]};break;case"segmentation":A={title:"Breaking Down Your Route",shortDescription:"You're dividing your route into manageable segments.",description:"You're now segmenting your route into smaller sections. Click anywhere on the route to create a break point. Each segment becomes its own manageable piece that you can work with independently. This makes it easier to organize, modify, or analyze different parts of your route separately.",multiLineDescription:["**Click** on route to create break points","Each segment is manageable independently"]};break;case"upload_routes":A=p>0?{title:"Reviewing Your Routes",shortDescription:"See your uploaded routes on the left with distance and match %. Higher match % = closer to Google's route. Select any route to edit.",description:"See your uploaded routes on the left with distance and match %. Higher match % = closer to Google's route. Select any route to edit.",multiLineDescription:["Review routes: **distance**, **match %**","Higher match % = closer to Google's route","**Select** any route to edit"]}:{title:"Uploading Routes",shortDescription:"Select a GeoJSON file to upload your routes.",description:"You're ready to upload routes. Select a GeoJSON file containing your route data. Once uploaded, your routes will be displayed on the map and optimized traffic-aware routes will be generated automatically for you to review and edit.",multiLineDescription:["**Select** a GeoJSON file to upload","Routes will be **optimized** automatically"]};break;default:if(f>0&&!g&&L)A={title:"Area Selection Complete",shortDescription:"You've defined selection areas, and the roads within them will be imported.",description:"You've successfully created selection polygons on the map. The system is now processing these areas and will automatically import all the roads that fall within your selected boundaries. Once complete, these roads will be available in your project for you to manage and organize.",multiLineDescription:["Selection polygons created","**Processing** and **importing** roads","Roads will be available soon"]};else if("road_selection"===e)if("multi-select"===B)if(I&&R&&R.length>0){const e=R.length;let t="";if(T)t="**Validating** route continuity...";else if(k)if(k.is_continuous)t=" **Continuous** path - ready to save";else{const e=k.gaps||[];if(e.length>0){const n=e[0];t=` **Gap detected**: ${n.distance_meters?.toFixed(1)||"unknown"}m between roads`}else t=" **Disconnected** roads"}else t="Building continuous route...";A={title:"Building Route",shortDescription:`You're building a route with ${e} road${1!==e?"s":""}. ${t}`,description:`You're building a continuous route by selecting connected roads. Currently ${e} road${1!==e?"s":""} selected. Click on roads that connect to the start or end of your current route to add them. Only roads that form a continuous path can be added. Use the controls to save or cancel.`,multiLineDescription:[`${e} road${1!==e?"s":""} selected`,t,"**Click** connected roads to add, or **Save** when ready"]}}else A={title:"Multi-Select Mode",shortDescription:"Click on a road to start building your route. Only roads that form a continuous path can be added.",description:"You're in multi-select mode. Click on any road to start building a continuous route. Once you've selected the first road, you can add more roads that connect to the start or end of your current route. Only roads that form a continuous path can be added. Use the controls to save your route or cancel.",multiLineDescription:["**Click** a road to start building route","Only **continuous** paths can be added","**Save** or **Cancel** using controls"]};else A="lasso"===B?u?{title:"Select Roads with Lasso",shortDescription:"Draw a polygon on the map to select multiple roads at once. Use the Roads Priority panel to refine your selection.",description:"You're in lasso selection mode. Click and drag on the map to draw a freeform polygon around the roads you want to select. All roads within your polygon will be highlighted. Use the Roads Priority panel on the left to filter roads by priority before selecting. Click any point to complete your selection.",multiLineDescription:["**Draw** polygon to select multiple roads","Use **Roads Priority** panel to refine selection","**Click** any point to complete"]}:{title:"Lasso Selection",shortDescription:"Click and drag to draw a freeform shape around roads you want to select.",description:"You're in lasso selection mode. Click and drag on the map to draw a freeform polygon around the roads you want to select. All roads within your polygon will be highlighted. Click any point to complete your selection.",multiLineDescription:["**Click and drag** to draw freeform shape","**Click** any point to complete"]}:"single"===B?u?{title:"Select Roads",shortDescription:"Click on any road to select it, or switch to lasso or multi-select mode. Use the Roads Priority panel to filter roads by priority.",description:"You can select roads in three ways: Click on any individual road to select it, switch to lasso mode to draw a polygon and select multiple roads at once, or use multi-select mode to build a continuous route. Use the Roads Priority panel on the left to filter roads by priority before selecting. Selected roads will be added to your project.",multiLineDescription:["**Click** any road to select, or","**Switch** to lasso or multi-select mode","Use **Roads Priority** panel to refine"]}:{title:"Select Roads",shortDescription:"Click on any road to select it. Use the controls to switch between single, lasso, or multi-select modes.",description:"Click on any road to select it and add it to your project. Use the controls at the top to switch between single selection, lasso selection (draw polygon), or multi-select mode (build continuous routes). Selected roads will appear in the panel on the right.",multiLineDescription:["**Click** any road to select","**Switch** modes using controls","Selected roads appear in **right panel**"]}:{title:"Import Roads",shortDescription:"Select roads to import. Choose a selection mode: single, lasso, or multi-select.",description:"You're in road import mode. Select roads using one of three methods: single selection (click individual roads), lasso selection (draw a polygon), or multi-select (build continuous routes). Use the controls at the top to choose your selection mode.",multiLineDescription:["Choose **selection mode**: single, lasso, or multi-select","**Click** roads or **draw** polygon to select"]};else A="road_selection"===e&&u?{title:"Select Roads",shortDescription:"Use the Roads Priority panel to filter roads by priority before selecting.",description:"Use the Roads Priority panel on the left to filter roads by priority. Then select roads using your chosen selection mode.",multiLineDescription:["Use **Roads Priority** panel to filter","Then **select** roads using your chosen mode"]}:{title:"Exploring Your Routes",shortDescription:"Your routes are ready. Click on any route in the left panel to explore its details.",description:"You have routes in your project. They're all listed in the left panel, and each one tells its own story on the map. Click on any route to dive deeper into its details, see its properties, and make any adjustments you need. Your routes are waiting for you to explore and manage them.",multiLineDescription:["Routes are ready","**Click** any route in left panel to explore","View details and make adjustments"]}}return A},[e,h,p,f,t,m,D,y,v,b,w,x,n,o,i,a,l,c,u,d,_,S,O,U.isFetching,L,B,g,I,R?.length??0,k,T,F]);pe.useEffect(()=>{V.current&&(clearTimeout(V.current),V.current=null);if((!$||d)&&M){(!Q||Q.title!==K?.title||Q.shortDescription!==K?.shortDescription||JSON.stringify(Q.multiLineDescription)!==JSON.stringify(K?.multiLineDescription))&&K?d?(z(K),j(!0)):Q?V.current=setTimeout(()=>{z(K),j(!0),V.current=null},300):(z(K),j(!0)):!Q&&K&&(z(K),j(!0))}else $||M||Q&&(z(null),j(!1),G([]));return()=>{V.current&&(clearTimeout(V.current),V.current=null)}},[$,M,K,Q,d]),pe.useEffect(()=>{if(V.current&&(clearTimeout(V.current),V.current=null),$&&!d){const e={title:X($.type),shortDescription:$.message,description:$.description||$.message,multiLineDescription:$.description?[$.message,$.description]:[$.message]};(!Q||Q.title!==e.title||Q.shortDescription!==e.shortDescription||JSON.stringify(Q.multiLineDescription)!==JSON.stringify(e.multiLineDescription))&&(z(e),j(!0))}else if($&&d)Q&&Q.title===X($.type)&&z(null);else if(!$&&Q){("Success"===Q.title||"Error"===Q.title||"Warning"===Q.title||"Info"===Q.title||"Loading"===Q.title)&&(z(null),G([]))}},[$,Q,d]);const X=e=>{switch(e){case"success":return"Success";case"error":return"Error";case"info":return"Info";case"warning":return"Warning";case"loading":return"Loading";default:return"Notification"}},Y=!!Q&&("Error"===Q.title||"Success"===Q.title||"Warning"===Q.title||"Info"===Q.title||"Loading"===Q.title),q=$||(Y?Q:null),J=$?$.type:Y&&"Error"===Q?.title?"error":Y&&"Success"===Q?.title?"success":Y&&"Warning"===Q?.title?"warning":Y&&"Info"===Q?.title?"info":Y&&"Loading"===Q?.title?"loading":null,Z=pe.useRef(null);if(pe.useEffect(()=>{if(!Q)return G([]),void(Z.current=null);if(!Z.current||Z.current.title!==Q.title||Z.current.shortDescription!==Q.shortDescription||JSON.stringify(Z.current.multiLineDescription)!==JSON.stringify(Q.multiLineDescription)){const e=Q.multiLineDescription?Q.multiLineDescription:[Q.shortDescription];G(e),Z.current=Q}},[Q]),pe.useEffect(()=>{if(!A.current)return;const e=()=>{if(A.current){const e=A.current.offsetHeight;r(e+32+16)}};e();const t=new ResizeObserver(()=>{e()});return t.observe(A.current),()=>{t.disconnect()}},[r,Q,H]),!Q)return null;const ee=J?(e=>{switch(e){case"success":return"#10b981";case"error":return"#ef4444";case"info":return"#3b82f6";case"warning":return"#f59e0b";default:return sJ}})(J):sJ,te=J?(e=>{switch(e){case"success":return"#ecfdf5";case"error":return"#fef2f2";case"info":case"loading":return"#eff6ff";case"warning":return"#fffbeb";default:return"#ffffff"}})(J):"#ffffff",ne=!!q,re=(e,t)=>`rgba(${parseInt(e.slice(1,3),16)}, ${parseInt(e.slice(3,5),16)}, ${parseInt(e.slice(5,7),16)}, ${t})`;return s.jsx(Fg,{direction:"left",in:N,timeout:300,mountOnEnter:!0,unmountOnExit:!0,children:s.jsx(rf,{ref:A,sx:{position:"fixed",bottom:"22px",right:"10px",zIndex:9999,maxWidth:"400px",width:"400px",pointerEvents:N?"auto":"none"},children:s.jsx(rf,{sx:{position:"relative",width:"100%",overflow:"hidden",borderRadius:"12px",zIndex:0},children:s.jsx(gd,{elevation:8,sx:{position:"relative",width:"100%",borderRadius:"12px",overflow:"hidden",backgroundColor:ne?te:"#ffffff",color:"#202124",border:`2px solid ${ee}`,transition:"all 0.2s ease-in-out",boxShadow:ne?`0px 4px 12px ${re(ee,.3)}, 0px 8px 24px ${re(ee,.2)}, 0px 16px 48px ${re(ee,.15)}`:"0px 4px 12px rgba(66, 133, 244, 0.25), 0px 8px 24px rgba(66, 133, 244, 0.2), 0px 16px 48px rgba(66, 133, 244, 0.15)",zIndex:1,"&:hover":{boxShadow:ne?`0px 6px 16px ${re(ee,.4)}, 0px 12px 32px ${re(ee,.3)}, 0px 24px 64px ${re(ee,.2)}`:"0px 6px 16px rgba(66, 133, 244, 0.3), 0px 12px 32px rgba(66, 133, 244, 0.25), 0px 24px 64px rgba(66, 133, 244, 0.2)"}},children:s.jsx(rf,{sx:{position:"relative",overflow:"hidden",borderRadius:"12px",zIndex:1,backgroundColor:"transparent"},children:s.jsxs(rf,{sx:{px:3,py:2.5,display:"flex",flexDirection:"column",gap:1},children:[s.jsxs(rf,{sx:{display:"flex",alignItems:"center",gap:1.5},children:[("loading"===$?.type||"polygon_drawing"===e&&L||Q.icon)&&s.jsx(Yd,{size:18,thickness:4,sx:{color:ee,flexShrink:0,"& .MuiCircularProgress-circle":{transition:"none",animationDuration:"1.4s"},"& svg":{willChange:"transform",transform:"translateZ(0)"}}}),s.jsx(vA,{variant:"body1",sx:{fontSize:"15px",fontWeight:600,fontFamily:'"Google Sans", sans-serif',color:ne?ee:"#202124",lineHeight:1.4,letterSpacing:"-0.01em",position:"relative"},children:Q.title})]}),H.length>0&&s.jsx(rf,{children:H.map((e,t)=>{if(e.includes("__EDIT_ICON__")||e.includes("__MODIFY_ICON__")||e.includes("__DELETE_ICON__")){const n=[],r=e,o=[];["__EDIT_ICON__","__MODIFY_ICON__","__DELETE_ICON__"].forEach(e=>{const t=r.indexOf(e);if(-1!==t){let n=null;"__EDIT_ICON__"===e?n=s.jsx(jX,{sx:{fontSize:"14px",color:"#5f6368",flexShrink:0,verticalAlign:"middle"}}):"__MODIFY_ICON__"===e?n=s.jsx(QX,{sx:{fontSize:"14px",color:"#5f6368",flexShrink:0,verticalAlign:"middle"}}):"__DELETE_ICON__"===e&&(n=s.jsx(MX,{sx:{fontSize:"14px",color:"#5f6368",flexShrink:0,verticalAlign:"middle"}})),o.push({marker:e,position:t,icon:n})}}),o.sort((e,t)=>e.position-t.position);let i=0;return o.forEach(({marker:e,position:t,icon:o})=>{t>i&&n.push({text:r.slice(i,t)}),n.push({text:"",icon:o}),i=t+e.length}),i<r.length&&n.push({text:r.slice(i)}),s.jsx(qp,{in:!0,timeout:400,style:{transitionDelay:50*t+"ms"},children:s.jsx(vA,{variant:"body2",sx:{fontSize:"15px",fontWeight:400,fontFamily:'"Google Sans", sans-serif',color:"#5f6368",lineHeight:1.6,display:"flex",alignItems:"center",flexWrap:"wrap",gap:.5,letterSpacing:"-0.01em",mb:t<H.length-1?.5:0},children:n.map((e,t)=>e.icon?s.jsx(rf,{component:"span",children:e.icon},t):e.text?s.jsx(rf,{component:"span",children:h5(e.text).map((e,t)=>s.jsx(rf,{component:"span",sx:{fontWeight:e.bold?600:400,color:e.bold?"#202124":"#5f6368"},children:e.text},t))},t):null)})},`${Q.title}-${t}-${e}`)}if("__COLOR_LEGEND__"===e&&"Reviewing Uploaded Route"===Q.title)return s.jsx(qp,{in:!0,timeout:400,style:{transitionDelay:50*t+"ms"},children:s.jsxs(rf,{sx:{display:"flex",alignItems:"center",gap:1.5,flexWrap:"nowrap",mb:t<H.length-1?.75:0},children:[s.jsxs(rf,{sx:{display:"flex",alignItems:"center",gap:.5,flexShrink:0},children:[s.jsx(rf,{sx:{width:10,height:10,borderRadius:"50%",backgroundColor:"#FFEB3B",border:"1px solid rgba(0, 0, 0, 0.1)",flexShrink:0}}),s.jsx(vA,{variant:"body2",sx:{fontSize:"15px",fontWeight:400,fontFamily:'"Google Sans", sans-serif',color:"#5f6368",lineHeight:1.5,letterSpacing:"-0.01em",whiteSpace:"nowrap"},children:"Uploaded"})]}),s.jsxs(rf,{sx:{display:"flex",alignItems:"center",gap:.5,flexShrink:0},children:[s.jsx(rf,{sx:{width:10,height:10,borderRadius:"50%",backgroundColor:"#9C27B0",border:"1px solid rgba(0, 0, 0, 0.1)",flexShrink:0}}),s.jsx(vA,{variant:"body2",sx:{fontSize:"15px",fontWeight:400,fontFamily:'"Google Sans", sans-serif',color:"#5f6368",lineHeight:1.5,letterSpacing:"-0.01em",whiteSpace:"nowrap"},children:"Google's"})]})]})},`${Q.title}-color-legend-${t}`);const n=h5(e);return s.jsx(qp,{in:!0,timeout:400,style:{transitionDelay:50*t+"ms"},children:s.jsx(vA,{variant:"body2",sx:{fontSize:"15px",fontWeight:400,fontFamily:'"Google Sans", sans-serif',color:"#5f6368",lineHeight:1.6,display:"block",letterSpacing:"-0.01em",mb:t<H.length-1?.5:0},children:n.map((e,t)=>s.jsx(rf,{component:"span",sx:{fontWeight:e.bold?600:400,color:e.bold?"#202124":"#5f6368"},children:e.text},t))})},`${Q.title}-${t}-${e}`)})})]})})})})})},Q?`${Q.title}-${Q.shortDescription}`:"no-message")};const f5=({open:e,onConfirm:t,onCancel:n,title:r="Exit Import roads mode",message:o="You have unsaved selected roads. If you exit now, all your selections will be lost.",confirmButtonText:i="Exit Mode"})=>s.jsx(jv,{open:e,onClose:n,title:r,maxWidth:"sm",actions:s.jsxs(s.Fragment,{children:[s.jsx(Nv,{onClick:n,variant:"outlined",children:"Cancel"}),s.jsx(Nv,{onClick:t,variant:"contained",color:"primary",children:i})]}),children:s.jsx(vA,{variant:"body2",className:"text-gray-600",children:o})}),g5=({open:e,type:t,routeCount:n,pointCount:r,onConfirm:o,onCancel:i})=>s.jsx(jv,{open:e,onClose:i,title:"uploaded_routes"===t?"Unsaved Routes":"drawn_route"===t?"Unsaved Route":"Unsaved Polygon",maxWidth:"sm",actions:s.jsxs(s.Fragment,{children:[s.jsx(Nv,{onClick:i,variant:"outlined",children:"Go Back"}),s.jsx(Nv,{onClick:o,variant:"contained",color:"primary",children:"Continue"})]}),children:s.jsx(vA,{variant:"body2",className:"text-gray-600",children:"uploaded_routes"===t?`You have ${n||0} unsaved route${1!==(n||0)?"s":""}. If you switch modes now, all unsaved routes will be lost. Do you want to continue?`:"drawn_route"===t?`You have an unsaved route with ${r||0} point${1!==(r||0)?"s":""}. If you switch modes now, your unsaved route will be lost. Do you want to continue?`:`You have an unsaved polygon with ${r||0} point${1!==(r||0)?"s":""}. If you switch modes now, your unsaved polygon will be lost. Do you want to continue?`})});function m5(e,t){try{let n=[];if("FeatureCollection"===e.type){const t=e.features.find(e=>"LineString"===e.geometry.type||"MultiLineString"===e.geometry.type);if(t)if("LineString"===t.geometry.type)n=t.geometry.coordinates;else if("MultiLineString"===t.geometry.type){const e=t.geometry.coordinates[0];e&&e.length>0&&(n=e)}}else if("Feature"===e.type)if("LineString"===e.geometry.type)n=e.geometry.coordinates;else if("MultiLineString"===e.geometry.type){const t=e.geometry.coordinates[0];t&&t.length>0&&(n=t)}if(n.length<2)return 0;const r=t.coordinates;if(r.length<2)return 0;const o=y5(n),i=y5(r),s=100*(o>0?Math.min(i/o,o/i):0),a=Math.min(50,Math.max(10,Math.floor(r.length/2)));let l=0;const c=50;for(let e=0;e<=a;e++){const t=r[Math.floor(e/a*(r.length-1))],o={lat:t[1],lng:t[0]};let i=1/0;for(let e=0;e<n.length-1;e++){const t=n[e],r=n[e+1],s=MN(o,v5(o,{lat:t[1],lng:t[0]},{lat:r[1],lng:r[0]}));s<i&&(i=s)}i<=c&&l++}const u=l/(a+1)*100,d=Math.min(50,Math.max(10,Math.floor(n.length/2)));let A=0;for(let e=0;e<=d;e++){const t=n[Math.floor(e/d*(n.length-1))],o={lat:t[1],lng:t[0]};let i=1/0;for(let e=0;e<r.length-1;e++){const t=r[e],n=r[e+1],s=MN(o,v5(o,{lat:t[1],lng:t[0]},{lat:n[1],lng:n[0]}));s<i&&(i=s)}i<=c&&A++}const h=.4*u+.4*(A/(d+1)*100)+.2*s,p=Math.max(0,Math.min(100,h));return Math.round(p)}catch(n){return 0}}function y5(e){if(e.length<2)return 0;let t=0;for(let n=0;n<e.length-1;n++){t+=MN({lat:e[n][1],lng:e[n][0]},{lat:e[n+1][1],lng:e[n+1][0]})}return t}function v5(e,t,n){const r=e.lng-t.lng,o=e.lat-t.lat,i=n.lng-t.lng,s=n.lat-t.lat,a=i*i+s*s;if(0===a)return t;const l=(r*i+o*s)/a;let c,u;return l<0?(c=t.lng,u=t.lat):l>1?(c=n.lng,u=n.lat):(c=t.lng+l*i,u=t.lat+l*s),{lat:u,lng:c}}const b5=({waypoint:e,routeId:t,onDragEnd:n})=>{const[r,o]=pe.useState(!1),i=pe.useCallback(()=>{o(!0)},[]),a=pe.useCallback(t=>{if(!t.latLng)return;o(!1);const r={lat:t.latLng.lat(),lng:t.latLng.lng()},i=JN.getState().projectData,s=i?.boundaryGeoJson;if(s&&!Ew(r.lat,r.lng,s))return void Pw("Waypoint must be within the jurisdiction boundary");const{dismissMessagesByPattern:a}=kw.getState();a(/jurisdiction boundary|outside.*boundary/i,"error"),n(e.id,r)},[e.id,n]);return s.jsx(lZ,{position:e.position,draggable:!0,anchorPoint:iZ.CENTER,onDragStart:i,onDragEnd:a,title:`Waypoint ${e.order+1} - Drag to move`,children:s.jsx("div",{style:{transform:`scale(${r?1.2:1})`,transition:"transform 0.2s ease",cursor:"grab"},children:s.jsx("div",{className:"w-7 h-7 rounded-full bg-[#2196F3] text-white text-xs font-semibold flex items-center justify-center shadow-md border-2 border-white",children:e.order+1})})})},w5=({scale:e=1})=>{const t=20*e;return s.jsxs("svg",{width:t,height:t,viewBox:"0 0 32 32",xmlns:"http://www.w3.org/2000/svg",children:[s.jsx("circle",{cx:"16",cy:"16",r:"13",fill:"none",stroke:"white",strokeWidth:"1"}),s.jsx("circle",{cx:"16",cy:"16",r:"10",fill:"white",stroke:"#2f302f",strokeWidth:"6"})]})},x5=({scale:e=1})=>{const t=60*e,n=.75*t;return s.jsx("div",{style:{position:"relative",width:t,height:n},children:s.jsxs("svg",{width:.75*t,height:n,viewBox:"0 0 48 72",xmlns:"http://www.w3.org/2000/svg",style:{position:"absolute",bottom:0,left:"50%",transform:"translateX(-50%)"},children:[s.jsx("path",{d:"\n      M24 0\n      C13 0 4 9 4 20\n      C4 34 17 48 22.5 67\n      C22.8 68 23.3 72 24 72\n      C24.7 72 25.2 68 25.5 67\n      C31 48 44 34 44 20\n      C44 9 35 0 24 0Z\n    ",fill:"#ea4335",stroke:"#b11313",strokeWidth:"1"}),s.jsx("circle",{cx:"24",cy:"20",r:"8",fill:"#b11313"})]})})},_5=({routeId:e,routeIndex:t,routeName:n,startMarker:r,endMarker:o,onRegenerateRoute:i})=>{const a=$N(e=>e.updateOptimizedRouteMarker),l=$N(e=>e.setDraggingMarker),c=$N(e=>e.updateWaypoint),u=$N(e=>e.snappedRoads).routeMarkers.find(t=>t.routeId===e),d=u?.waypoints||[],A=pe.useCallback((t,n)=>{const r=JN.getState().projectData,o=r?.boundaryGeoJson;if(o&&!Ew(n.lat,n.lng,o))return void Pw("Waypoint must be within the jurisdiction boundary");const{dismissMessagesByPattern:s}=kw.getState();s(/jurisdiction boundary|outside.*boundary/i,"error"),c(e,t,n);$N.getState().getEditingState(e)&&setTimeout(()=>{i(e).catch(e=>{})},0)},[e,c,i]),[h,p]=pe.useState(null),f=t=>{p(`${e}-${t}`),l(!0)},g=(t,n)=>{if(!n.latLng)return;const r={lat:n.latLng.lat(),lng:n.latLng.lng()};a(e,t,r)},m=(t,n)=>{if(!n.latLng)return;p(null),l(!1);const r={lat:n.latLng.lat(),lng:n.latLng.lng()},o=JN.getState().projectData,s=o?.boundaryGeoJson;if(s&&!Ew(r.lat,r.lng,s))return void Pw(("start"===t?"Origin":"Destination")+" marker must be within the jurisdiction boundary");const{dismissMessagesByPattern:c}=kw.getState();c(/jurisdiction boundary|outside.*boundary/i,"error"),a(e,t,r);$N.getState().getEditingState(e)&&setTimeout(()=>{i(e).catch(e=>{})},0)},y=h===`${e}-start`,v=h===`${e}-end`,b=t+1;return s.jsxs(s.Fragment,{children:[s.jsx(lZ,{position:r,draggable:!0,anchorPoint:iZ.CENTER,onDragStart:()=>f("start"),onDrag:e=>g("start",e),onDragEnd:e=>m("start",e),title:`Start Point - ${n} (Route ${b})\nDrag to change`,children:s.jsx("div",{style:{transform:`scale(${y?1.2:1})`,transition:"transform 0.2s ease",cursor:"grab"},children:s.jsx(w5,{scale:y?1.2:1})})}),s.jsx(lZ,{position:o,draggable:!0,anchorPoint:iZ.BOTTOM_CENTER,onDragStart:()=>f("end"),onDrag:e=>g("end",e),onDragEnd:e=>m("end",e),title:`End Point - ${n} (Route ${b})\nDrag to change`,children:s.jsx("div",{style:{transform:`scale(${v?1.2:1})`,transition:"transform 0.2s ease",cursor:"grab"},children:s.jsx(x5,{})})}),d.map(t=>s.jsx(b5,{waypoint:t,routeId:e,onDragEnd:A},t.id))]})},C5=()=>{const e=ZJ(),t=$N(e=>e.snappedRoads),n=$N(e=>e.uploadedRoutes),r=$N(e=>e.addSnappedRoads),o=$N(e=>e.removeSnappedRoadsForRoute),i=$N(e=>e.addPreviewRoads),a=$N(e=>e.removePreviewRoadsForRoute),l=$N(e=>e.setSnappedRoadsLoading),c=$N(e=>e.selectedUploadedRouteId),u=$N(e=>e.getEditingState),[d,A]=pe.useState(null),h=pe.useCallback(async e=>{const t=$N.getState(),n=u(e),s=n?.temporaryMarkers||t.snappedRoads.routeMarkers.find(t=>t.routeId===e);if(s)try{A(e),l(!0);const t=s.waypoints.length>0?s.waypoints.sort((e,t)=>e.order-t.order).map(e=>({lat:e.position.lat,lng:e.position.lng})):[],n=await Vw.generateRoute(s.startMarker,s.endMarker,t);if(!n.success||!n.data)throw new Error(n.message||"Failed to generate route");const{encodedPolyline:d,distance:h,duration:p}=n.data,f=h.toFixed(2),g=p.toFixed(0),m=Sw(d),y={type:"Feature",geometry:m,properties:{id:`${e}-optimized`,name:"Optimized Route",source:"google_routes_api",distance:f,duration:g,traffic_aware:!0,encodedPolyline:d}},v=JN.getState(),b=v.projectData?.boundaryGeoJson;if(b){const t=[];"LineString"===m.type?m.coordinates.forEach(e=>{Array.isArray(e)&&e.length>=2&&t.push([e[0],e[1]])}):"MultiLineString"===m.type&&m.coordinates.forEach(e=>{Array.isArray(e)&&e.forEach(e=>{Array.isArray(e)&&e.length>=2&&t.push([e[0],e[1]])})});const n=50,r=Math.max(1,Math.floor(t.length/n)),o=[];t.length>0&&(o.push(t[0]),t.length>1&&o.push(t[t.length-1]));for(let e=r;e<t.length-1;e+=r)o.push(t[e]);if(!o.every(([e,t])=>Ew(t,e,b))){return u(e)&&a(e),void Pw("Route is outside the jurisdiction boundary")}}if(u(e)){a(e),i(e,[y]);const t=JN.getState(),n=t.routes.find(t=>t.id===e);if(n&&"uploaded"===n.type&&n.originalRouteGeoJson)try{if("LineString"===m.type){const r=m5(n.originalRouteGeoJson,m),o=Math.max(0,Math.min(100,r));t.updateRoute(e,{matchPercentage:o})}}catch(c){}}else o(e),r(e,[y])}catch(c){}finally{A(null),l(!1)}},[l,o,r,i,a,u]),p=!1!==$N(e=>e.layerVisibility)["waypoint-markers"];if(0===t.routeMarkers.length||!p)return null;const f=c?t.routeMarkers.filter(e=>e.routeId===c):[];return s.jsxs(s.Fragment,{children:[f.map((e,t)=>{const r=n.routes.find(t=>t.id===e.routeId),o=r?.name||`Route ${t+1}`,i=u(e.routeId),a=i?.temporaryMarkers||e;return s.jsx(_5,{routeId:e.routeId,routeIndex:t,routeName:o,startMarker:a.startMarker,endMarker:a.endMarker,onRegenerateRoute:h},e.routeId)}),d&&e&&s.jsx("div",{className:"absolute top-24 left-1/2 transform -translate-x-1/2 bg-white/95 backdrop-blur-sm px-4 py-2 rounded-full shadow-lg z-[1001]",children:s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("div",{className:"animate-spin h-4 w-4 border-2 border-primary-600 border-t-transparent rounded-full"}),s.jsxs("span",{className:"text-sm font-medium text-gray-700",children:["Regenerating route ",d,"..."]})]})})]})},S5=()=>{const e=$N(e=>e.individualRoute),t=$N(e=>e.movePoint),n=$N(e=>e.setMarkerDragEndTime),{showIndividualMarkers:r}=JN(),o=!1!==$N(e=>e.layerVisibility)["waypoint-markers"],i=pe.useCallback((e,o,i)=>{if(!r)return;const s=JN.getState().projectData,a=s?.boundaryGeoJson;if(a&&!Ew(o,i,a))return void Pw("Point must be within the jurisdiction boundary");t(e,{lat:o,lng:i});const l=Date.now();n(l)},[t,n,r]);if(0===e.points.length||!o)return null;return s.jsx(s.Fragment,{children:e.points.map((t,n)=>{const o=0===n,a=n===e.points.length-1,l=o?"origin":a?"destination":"waypoint";return s.jsx(lZ,{position:{lat:t.coordinates.lat,lng:t.coordinates.lng},anchorPoint:"destination"===l?iZ.BOTTOM:iZ.CENTER,draggable:r,onDragEnd:e=>{const n=e.latLng?.lat(),r=e.latLng?.lng();void 0!==n&&void 0!==r&&i(t.id,n,r)},children:"origin"===l?s.jsx("div",{className:"rounded-full p-1 "+(r?"cursor-grab":"cursor-default"),children:s.jsxs("svg",{width:20,height:20,viewBox:"0 0 32 32",xmlns:"http://www.w3.org/2000/svg",children:[s.jsx("circle",{cx:"16",cy:"16",r:"13",fill:"none",stroke:"white",strokeWidth:"1"}),s.jsx("circle",{cx:"16",cy:"16",r:"10",fill:"white",stroke:"#2f302f",strokeWidth:"6"})]})}):"destination"===l?s.jsx("div",{style:{transition:"transform 0.2s ease",cursor:r?"grab":"default"},children:s.jsx(x5,{})}):s.jsx("div",{className:"w-7 h-7 rounded-full bg-[#2196F3] text-white text-xs font-semibold flex items-center justify-center shadow-md border-2 border-white "+(r?"cursor-grab":"cursor-default"),children:n})},t.id)})})};function E5(){return s.jsx("svg",{width:"64",height:"64",viewBox:"0 0 120 80",xmlns:"http://www.w3.org/2000/svg",children:s.jsxs("g",{children:[s.jsx("path",{d:"M45 28 L58 40 L45 52",fill:"none",stroke:"black",strokeWidth:"8",strokeLinecap:"round"}),s.jsx("path",{fill:"black",d:"M58 40 L95 25 L98 30 L58 43 Z"}),s.jsx("path",{fill:"black",d:"M58 40 L95 55 L98 50 L58 37 Z"}),s.jsx("circle",{cx:"45",cy:"28",r:"8",fill:"black"}),s.jsx("circle",{cx:"45",cy:"52",r:"8",fill:"black"}),s.jsx("circle",{cx:"58",cy:"40",r:"3",fill:"white"})]})})}const B5=({point:e,onDragStart:t,onDragEnd:n,onDelete:r,isSnapped:o,isDragging:i})=>{const a=pe.useCallback(t=>{t.stopPropagation(),r(e.id)},[e.id,r]);return s.jsx(lZ,{position:{lat:e.coordinates.lat,lng:e.coordinates.lng},draggable:!1,anchorPoint:iZ.CENTER,children:s.jsxs(rf,{sx:{position:"relative",display:"flex",alignItems:"center",justifyContent:"center"},children:[s.jsx("div",{className:"hidden",children:s.jsx(E5,{})}),s.jsx(tA,{size:"small",onClick:a,onMouseDown:e=>e.stopPropagation(),sx:{position:"absolute",top:-8,right:-8,backgroundColor:"#ffffff",color:"#d32f2f",width:20,height:20,padding:0,minWidth:20,boxShadow:"0 2px 4px rgba(0,0,0,0.3)",border:"1px solid #ffcdd2",zIndex:1e3,"&:hover":{backgroundColor:"#ffebee",color:"#c62828",transform:"scale(1.1)"},transition:"all 0.2s ease"},title:"Delete cut point",children:s.jsx(MX,{sx:{fontSize:14}})})]})})},I5=()=>{const e=$N(e=>e.segmentation),t=$N(e=>e.startDragging),n=$N(e=>e.endDragging),r=$N(e=>e.removeCutPoint),o=pe.useCallback((e,n)=>{t(e,n)},[t]),i=pe.useCallback((e,t)=>{n(e,t)},[n]),a=pe.useCallback(e=>{r(e)},[r]);return 0===e.cutPoints.length?null:s.jsx(s.Fragment,{children:e.cutPoints.map(e=>s.jsx(B5,{point:e,onDragStart:o,onDragEnd:i,onDelete:a,isSnapped:e.isSnapped,isDragging:e.isDragging},e.id))})},R5=()=>{const[e,t]=pe.useState(null);return pe.useEffect(()=>{const e=e=>{t(e.detail)},n=()=>{t(null)};return window.addEventListener("showSearchMarker",e),window.addEventListener("clearSearchMarker",n),()=>{window.removeEventListener("showSearchMarker",e),window.removeEventListener("clearSearchMarker",n)}},[]),e?s.jsxs(lZ,{position:{lat:e.lat,lng:e.lng},zIndex:1e3,children:[s.jsx("div",{style:{width:"16px",height:"16px",borderRadius:"50%",backgroundColor:sJ,border:"2px solid white",boxShadow:"0 2px 4px rgba(0, 0, 0, 0.3)",animation:"pulse 1.5s ease-in-out infinite"}}),s.jsx("style",{children:"\n        @keyframes pulse {\n          0%, 100% {\n            transform: scale(1);\n            opacity: 1;\n          }\n          50% {\n            transform: scale(1.2);\n            opacity: 0.8;\n          }\n        }\n      "})]}):null},k5=({selectedPriorities:e,onSelectionChange:t,expandedCategories:n,onExpandedCategoriesChange:r})=>{const[o,i]=fe.useState({}),a=n??o,l=r?e=>{r("function"==typeof e?e(a):e)}:i,c={highway:0,arterial:1,local:2},u={ROAD_PRIORITY_CONTROLLED_ACCESS:0,ROAD_PRIORITY_LIMITED_ACCESS:1,ROAD_PRIORITY_PRIMARY_HIGHWAY:2,ROAD_PRIORITY_SECONDARY_ROAD:0,ROAD_PRIORITY_MAJOR_ARTERIAL:1,ROAD_PRIORITY_MINOR_ARTERIAL:2,ROAD_PRIORITY_LOCAL:0,ROAD_PRIORITY_TERMINAL:1,ROAD_PRIORITY_NON_TRAFFIC:2,ROAD_PRIORITY_UNSPECIFIED:3},d=[...GD].sort((e,t)=>(c[e.id]??999)-(c[t.id]??999)),A=HD.map(e=>e.value),h=A.every(t=>e.includes(t)),p=e.length>0&&e.length<A.length,f=()=>{t(h?[]:[...A])};return s.jsxs(rf,{sx:{display:"flex",flexDirection:"column",height:"100%"},children:[s.jsxs(rf,{sx:{position:"sticky",top:0,zIndex:10,backgroundColor:"white",pb:.5},children:[s.jsxs(rf,{onClick:f,sx:{display:"flex",alignItems:"center",gap:.75,px:.5,py:.25,cursor:"pointer",transition:"background-color 0.15s ease","&:hover":{backgroundColor:"#f8f9fa"}},children:[s.jsx(jf,{checked:h,indeterminate:p,onClick:e=>{e.stopPropagation(),f()},size:"small",sx:{color:"#5f6368","&.Mui-checked":{color:sJ},"&.MuiCheckbox-indeterminate":{color:sJ},padding:"4px"}}),s.jsx(vA,{variant:"body2",sx:{fontWeight:500,fontSize:"0.8125rem",color:"#3c4043",lineHeight:1.4,userSelect:"none"},children:"Select All"}),s.jsxs(vA,{component:"span",sx:{fontWeight:400,fontSize:"0.8125rem",color:"#5f6368",ml:.5,userSelect:"none"},children:["(",A.length,")"]})]}),s.jsx(Tg,{sx:{mt:.5,borderColor:"#e8eaed"}})]}),s.jsx(rf,{sx:{flex:1,overflowY:"auto",pt:.5},children:s.jsx("div",{className:"flex flex-col gap-2.5",children:d.map(n=>{const r=HD.filter(e=>e.category===n.id).sort((e,t)=>(u[e.value]??999)-(u[t.value]??999)),o=r.every(t=>e.includes(t.value)),i=r.some(t=>e.includes(t.value))&&!o,c=!!a[n.id];return s.jsxs(rf,{sx:{borderRadius:"16px",border:o?`1px solid ${sJ}`:i?"1px solid #9aa0a6":"1px solid #e8eaed",backgroundColor:o?"#f8f9fa":"white",boxShadow:o||i?"0 2px 8px rgba(9, 87, 208, 0.1)":"0 1px 3px rgba(0, 0, 0, 0.05)","&:hover":{borderColor:o?sJ:"#dadce0",boxShadow:o||i?"0 4px 12px rgba(66, 133, 244, 0.15)":"0 2px 6px rgba(0, 0, 0, 0.08)"}},children:[s.jsxs(rf,{onClick:()=>l(e=>({...e,[n.id]:!e[n.id]})),sx:{width:"100%",px:2.5,py:1.5,display:"flex",alignItems:"flex-start",justifyContent:"space-between",gap:2,cursor:"pointer","&:hover":{backgroundColor:"rgba(0, 0, 0, 0.02)"}},children:[s.jsxs(rf,{sx:{display:"flex",alignItems:"flex-start",gap:1.5,flex:1},children:[s.jsx(jf,{checked:o,indeterminate:i,onClick:n=>{n.stopPropagation(),t(o?e.filter(e=>!r.some(t=>t.value===e)):[...e,...r.map(e=>e.value).filter(t=>!e.includes(t))])},size:"small",sx:{color:"#5f6368","&.Mui-checked":{color:sJ},"&.MuiCheckbox-indeterminate":{color:sJ},padding:0,marginTop:"2px"}}),s.jsxs(rf,{sx:{display:"flex",flexDirection:"column",gap:.25,flex:1},children:[s.jsxs(vA,{variant:"body2",sx:{fontWeight:600,fontSize:"0.875rem",color:"#202124",lineHeight:1.4},children:[n.label,s.jsxs(vA,{component:"span",sx:{fontWeight:500,fontSize:"0.875rem",color:"#5f6368",ml:.5},children:["(",r.length,")"]})]}),s.jsx(vA,{variant:"caption",sx:{fontSize:"0.75rem",color:"#5f6368",lineHeight:1.4},children:n.description})]})]}),s.jsx(rf,{sx:{display:"flex",alignItems:"center",color:"#5f6368",transition:"transform 0.2s ease",transform:c?"rotate(180deg)":"rotate(0deg)"},children:s.jsx(GX,{fontSize:"small"})})]}),s.jsxs(hd,{in:c,timeout:"auto",unmountOnExit:!0,children:[s.jsx(Tg,{sx:{mx:2.5,borderColor:"#e8eaed"}}),s.jsx(rf,{sx:{px:2.5,py:1.5,display:"flex",flexDirection:"column",gap:.5},children:r.map((n,o)=>{const i=e.includes(n.value);return s.jsxs(fe.Fragment,{children:[s.jsxs(rf,{onClick:()=>t(e.includes(n.value)?e.filter(e=>e!==n.value):[...e,n.value]),sx:{display:"flex",alignItems:"flex-start",gap:1.5,px:1.5,py:1,borderRadius:"8px",cursor:"pointer",backgroundColor:i?"#f1f3f4":"transparent",transition:"background-color 0.15s ease","&:hover":{backgroundColor:i?"#e8eaed":"#f8f9fa"}},children:[s.jsx(jf,{checked:i,onChange:()=>t(e.includes(n.value)?e.filter(e=>e!==n.value):[...e,n.value]),onClick:e=>e.stopPropagation(),size:"small",sx:{color:"#5f6368","&.Mui-checked":{color:sJ},padding:0,marginTop:"2px"}}),s.jsxs(rf,{sx:{display:"flex",flexDirection:"column",gap:.25,flex:1},children:[s.jsx(vA,{variant:"body2",sx:{fontWeight:500,fontSize:"0.8125rem",color:i?"#202124":"#3c4043",lineHeight:1.4},children:n.label}),s.jsx(vA,{variant:"caption",sx:{fontSize:"0.75rem",color:"#5f6368",lineHeight:1.4},children:n.description})]})]}),o!==r.length-1&&s.jsx(Tg,{sx:{my:.5,borderColor:"#e8eaed",opacity:.5}})]},n.value)})})]})]},n.id)})})})]})},T5=({value:e,onChange:t,onInputChange:n,tags:r,error:o,helperText:i,required:a=!0,placeholder:l,label:c,excludeTags:u=[]})=>{const[d,A]=fe.useState(!1),[h,p]=fe.useState(e||""),[f,g]=fe.useState(null),m=fe.useRef(null),y=fe.useRef(null),v=100,b=fe.useMemo(()=>h.length>v?"Folder name should not exceed 100 characters":null,[h]);fe.useEffect(()=>{p(e||"")},[e]);const w=fe.useMemo(()=>{const e=new Set(u),t=r.filter(t=>!e.has(t)&&t.length<=v);if(!h)return t;const n=h.toLowerCase();return t.filter(e=>e.toLowerCase().includes(n))},[r,h,u]),x=fe.useCallback(e=>{const o=e.target.value;if(o.length>v)return;p(o),n?n(o):t(o);const i=new Set(u);r.filter(e=>!i.has(e)).length>0&&!d&&A(!0)},[t,n,d,r,u]),_=fe.useCallback(()=>{if(m.current){const e=m.current.getBoundingClientRect();g({top:e.bottom+window.scrollY+4,left:e.left+window.scrollX,width:e.width})}},[]),C=fe.useCallback(()=>{w.length>0&&(_(),A(!0))},[w.length,_]),S=fe.useCallback(()=>{w.length>0&&(_(),A(!0))},[w.length,_]),E=fe.useCallback(e=>{e.length>v||(t(e),p(e),A(!1))},[t]),B=fe.useCallback(e=>{const t=e.target;m.current&&!m.current.contains(t)&&y.current&&!y.current.contains(t)&&A(!1)},[]),I=new Set(u),R=r.filter(e=>!I.has(e)).length>0?"Select a folder or type to create new":"Type to create a new folder";return s.jsx(zf,{onClickAway:B,children:s.jsxs(rf,{sx:{position:"relative",width:"100%"},children:[s.jsx(Dv,{inputRef:m,label:c,placeholder:l||R,value:h,onChange:x,onFocus:C,onClick:S,onKeyDown:e=>{"Escape"===e.key&&A(!1)},error:!!o||!!b,helperText:o||b||i||void 0,variant:"standard",fullWidth:!0,required:a,slotProps:{input:{sx:{fontSize:"0.813rem",fontFamily:'"Google Sans", sans-serif'}},inputLabel:{sx:{fontSize:"0.813rem",fontFamily:'"Google Sans", sans-serif'}}}}),d&&w.length>0&&f&&wu.createPortal(s.jsx(gd,{ref:y,elevation:3,sx:{position:"absolute",top:`${f.top}px`,left:`${f.left}px`,width:`${f.width}px`,zIndex:1500,borderRadius:"8px",border:"1px solid #e0e0e0",boxShadow:"0 2px 8px rgba(0, 0, 0, 0.1)",maxHeight:"300px",overflowY:"auto"},children:w.map(e=>s.jsx(rf,{onClick:()=>E(e),sx:{padding:"8px 16px",cursor:"pointer",fontSize:"0.813rem",fontFamily:'"Google Sans", sans-serif',color:"#202124","&:hover":{backgroundColor:"#f8f9fa"},"&:first-of-type":{borderTopLeftRadius:"8px",borderTopRightRadius:"8px"},"&:last-of-type":{borderBottomLeftRadius:"8px",borderBottomRightRadius:"8px"}},children:e},e))}),document.body)]})})},P5=()=>{const{mapMode:e,setMapMode:t,projectId:n,setActivePanel:r}=JN(),o=$N(e=>e.lassoDrawing),i=$N(e=>e.clearAllDrawing),a=$N(e=>e.setLassoSelectedRoads),[l,c]=fe.useState(!1),[u,d]=fe.useState(["ROAD_PRIORITY_UNSPECIFIED","ROAD_PRIORITY_NON_TRAFFIC","ROAD_PRIORITY_TERMINAL","ROAD_PRIORITY_LOCAL","ROAD_PRIORITY_MINOR_ARTERIAL","ROAD_PRIORITY_MAJOR_ARTERIAL","ROAD_PRIORITY_SECONDARY_ROAD","ROAD_PRIORITY_PRIMARY_HIGHWAY","ROAD_PRIORITY_LIMITED_ACCESS","ROAD_PRIORITY_CONTROLLED_ACCESS"]),[A,h]=fe.useState({}),[p,f]=fe.useState(null),[g,m]=fe.useState(""),[y,v]=fe.useState(null),[b,w]=fe.useState(null),{data:x=[]}=cX(n||""),_=lX(),C=$N(e=>e.lassoDrawing.confirmed),S=uX({projectId:n||void 0,polygon:o.completedPolygon,priorities:u,confirmed:C}),E=(S.data||[]).map(e=>({...e,linestringGeoJson:(()=>{if("string"==typeof e.linestringGeoJson)try{return JSON.parse(e.linestringGeoJson)}catch{return e.linestringGeoJson}return e.linestringGeoJson})()})),B=fe.useRef([]);if(fe.useEffect(()=>{if(!o.completedPolygon)return;const e=E.map(e=>e?.id?.toString()),t=B.current,n=e.length===t.length&&e.every((e,n)=>e===t[n]);n||(a(E),B.current=e)},[o.completedPolygon,E,a]),fe.useEffect(()=>{"lasso_selection"===e&&o.completedPolygon?c(!0):"lasso_selection"===e&&o.completedPolygon||(c(!1),"lasso_selection"!==e&&r(null))},[e,o.completedPolygon,r]),"lasso_selection"!==e||!o.completedPolygon||!l)return null;const I=()=>{i(),t("view"),c(!1)};return s.jsx(s.Fragment,{children:s.jsx(rf,{className:"fixed left-0 top-16 h-[calc(100vh-4rem)] bg-white flex",sx:{width:"360px",fontFamily:"'Google Sans', 'Roboto', sans-serif",zIndex:1e3},children:s.jsxs(rf,{className:"h-full flex flex-col border-r border-gray-200 bg-white",sx:{width:"360px",boxShadow:"0 4px 16px rgba(0, 0, 0, 0.15), 0 2px 8px rgba(0, 0, 0, 0.1)",position:"relative",zIndex:1e3},children:[s.jsx(rf,{className:"px-4 pt-3 pb-3 border-b border-gray-200 bg-white",sx:{flexShrink:0},children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx(vA,{variant:"h6",className:"text-gray-900 font-medium",style:{fontSize:"15px",fontWeight:500},children:"Roads Selection"}),s.jsx(tA,{size:"small",onClick:I,children:s.jsx(IX,{fontSize:"small"})})]})}),s.jsxs(rf,{className:"px-4 py-3 border-b border-gray-200 bg-white",sx:{flexShrink:0},children:[s.jsx(vA,{variant:"caption",className:"uppercase",color:"text.secondary",sx:{mb:1,display:"block"},children:"Folder"}),s.jsx(T5,{tags:x,value:p,onChange:e=>{f(e),m("")},error:g,helperText:g||void 0})]}),s.jsx(rf,{className:"flex-1 overflow-auto px-4 py-3 border-b border-gray-200 bg-white",sx:{flexShrink:0,minHeight:0},children:s.jsx(k5,{selectedPriorities:u,onSelectionChange:e=>{d(e)},expandedCategories:A,onExpandedCategoriesChange:h})}),s.jsx(rf,{className:"px-4 py-4 border-t border-gray-200 bg-white",sx:{flexShrink:0,minHeight:"48px",position:"relative",zIndex:1001},children:s.jsxs(rf,{className:"flex flex-col gap-3",children:[S.isFetching&&s.jsx(vA,{variant:"caption",color:"text.secondary",children:"Fetching roads for your lasso selection..."}),S.error&&s.jsx(vA,{variant:"caption",color:"error",children:S.error.message||"Failed to fetch roads from the server."}),b&&s.jsx(vA,{variant:"caption",color:"error",children:b}),s.jsxs(Bv,{direction:"row",spacing:1,children:[s.jsx(Nv,{variant:"outlined",fullWidth:!0,onClick:I,size:"small",children:"Cancel"}),s.jsx(Nv,{variant:"contained",fullWidth:!0,onClick:async()=>{if(!n)return;const e=p?.trim()||"";if(!e)return void m("Please select or type a folder");const r=S.data||[];if(0!==r.length){w(null),m("");try{const o=e=>{if(!e)return null;if("string"==typeof e)try{return JSON.parse(e)}catch(t){return null}return"object"==typeof e&&"LineString"===e.type?e:null},s=r.map((t,n)=>{const r=o(t.linestringGeoJson);if(!r)return null;const i=r.coordinates;if(!i||i.length<2)return null;const s=[i[0][0],i[0][1]],a=[i[i.length-1][0],i[i.length-1][1]],l=zw(r).map(e=>[e.lng,e.lat]);return{...t,route_type:"imported_from_road",id:t.id,name:`${e} - Route ${n+1}`,linestringGeoJson:r,origin:s,destination:a,length:t.distanceKm,waypoints:l}}).filter(Boolean);if(0===s.length)return void w("No valid road geometries available for batch save.");const a=await _.mutateAsync({projectId:n,tag:e,roads:s});v(`Saved ${a.savedCount} route${1===a.savedCount?"":"s"} successfully.`),a.errors.length>0&&w(`Failed to save ${a.errors.length} road${1===a.errors.length?"":"s"}: ${a.errors.map(e=>e.message).join("; ")}`),i(),t("view")}catch(o){w(o instanceof Error?o.message:"Batch save failed")}}else w(S.isFetching?"Still fetching roads. Please wait...":"No roads match the selected priorities.")},size:"small",disabled:"pending"===_.status||!o.completedPolygon||0===E.length||S.isFetching||!p?.trim(),children:"pending"===_.status?"Saving...":"Save All"})]})]})})]})})})},F5=({visibleLayers:e,savedRoutesLegend:t,importedRoadsLegend:n,segmentsLegend:r,getLayerName:o,getLayerColor:i,getBaseLayerId:a})=>{const[l,c]=pe.useState(!0),[u,d]=pe.useState(!0),[A,h]=pe.useState(!0),[p,f]=pe.useState(!0),[g,m]=pe.useState(!0),y=$N(e=>e.setLayerVisibility),v=JN(e=>e.leftPanelExpanded),b=JN(e=>e.mapMode),w=JN(e=>e.priorityFilterPanelExpanded),x=JN(e=>e.roadPriorityPanelOpen),_=JN(e=>e.mapType),C=$N(e=>e.lassoDrawing),S=$N(e=>e.polygonDrawing),E=pe.useMemo(()=>{const e="lasso_selection"!==b&&!C.completedPolygon&&!x&&"road_selection"!==b&&!S.completedPolygon;return"road_selection"===b&&w?"384px":e&&v?"404px":"33px"},[v,b,w,x,C.completedPolygon,S.completedPolygon]),B=pe.useMemo(()=>{const t=new Set,n=e.filter(e=>!t.has(e.id)&&(t.add(e.id),!0)),r=n.some(e=>"segmentation-boundaries"===e.id),o=n.some(e=>"selected-route-segments-boundaries"===e.id),i=n.some(e=>"selected-route"===e.id),s=n.some(e=>"selected-route-segments"===e.id),a=n.some(e=>"segments"===e.id);let l=n;return a&&(l=l.filter(e=>"selected-route-segments"!==e.id&&"selected-route-segments-hovered"!==e.id)),i&&s&&(l=l.filter(e=>"selected-route-segments"!==e.id&&"selected-route-segments-hovered"!==e.id)),i&&a&&(l=l.filter(e=>"segments"!==e.id)),r&&o&&(l=l.filter(e=>"selected-route-segments-boundaries"!==e.id)),l},[e]),I=`Legend (${B.filter(e=>e.visible).length} visible)`;return s.jsx(gd,{elevation:12,className:"fixed bottom-6 z-[1200] bg-white/95 backdrop-blur-[10px] rounded-2xl overflow-hidden",sx:{left:E,width:256,pointerEvents:"auto",boxShadow:l?"0px 12px 24px rgba(15,23,42,0.2), 0px 6px 12px rgba(15,23,42,0.15), 0px 2px 4px rgba(15,23,42,0.1)":"0px 8px 16px rgba(15,23,42,0.15), 0px 4px 8px rgba(15,23,42,0.1)",cursor:l?"default":"pointer",transition:"left 0.3s cubic-bezier(0.4, 0, 0.2, 1), box-shadow 0.3s cubic-bezier(0.4, 0, 0.2, 1), transform 0.3s cubic-bezier(0.4, 0, 0.2, 1)"},onClick:l?void 0:()=>c(!0),children:l?s.jsxs(s.Fragment,{children:[s.jsxs(rf,{className:"px-3 py-3 border-b border-mui-divider flex items-center justify-between",children:[s.jsxs(rf,{className:"flex items-center gap-1.5",children:[s.jsx(qX,{sx:{fontSize:14}}),s.jsx(vA,{variant:"subtitle2",className:"font-semibold",sx:{fontSize:"13px",fontWeight:500},children:"Legend"})]}),s.jsx(tA,{size:"small",onClick:e=>{e.stopPropagation(),c(!1)},sx:{padding:.25},children:s.jsx(GX,{sx:{fontSize:14}})})]}),s.jsx(rf,{className:"max-h-96 overflow-auto",children:0===B.length?s.jsxs(rf,{className:"text-center py-8 px-4",children:[s.jsx(qX,{sx:{fontSize:28,color:"rgba(0,0,0,0.2)",mb:.5}}),s.jsx(vA,{variant:"caption",className:"text-gray-500 text-xs",sx:{display:"block",mt:.5},children:"No layers available"})]}):s.jsx(rf,{className:"py-1",children:B.map((e,l)=>s.jsxs(rf,{children:[s.jsxs(rf,{className:"px-3 py-1.5 flex items-center gap-1.5 transition-all duration-150 cursor-pointer group",sx:{"&:hover":{backgroundColor:"rgba(249, 250, 251, 0.8)"},borderLeft:(e.visible,"3px solid transparent"),"&:hover .layer-indicator":{boxShadow:`0 0 0 3px ${i(e.id,e._originalLayerId)}20`}},children:["saved-routes-tile"!==e.id&&"imported-roads"!==e.id&&"segments"!==e.id&&"selected-route-segments"!==e.id&&s.jsx(rf,{className:"flex-shrink-0 transition-all duration-200",sx:{width:"12px",height:"12px",display:"flex",alignItems:"center",justifyContent:"center"},children:"selected-route-segments-boundaries"===e.id||"segmentation-boundaries"===e.id?s.jsx(rf,{className:"segment-icon",sx:{display:"flex",alignItems:"center",justifyContent:"center",width:"12px",height:"12px"},children:s.jsx(rf,{sx:{width:"10px",height:"4px",backgroundColor:"rgba(255, 43, 139, 0.9)",transition:"all 0.2s ease",border:"0.5px solid rgba(0, 0, 0, 0.4)",borderRadius:"0.5px"}})}):"waypoint-markers"===e.id?s.jsx(rf,{sx:{display:"flex",alignItems:"center",gap:"2px",width:"24px",height:"12px"},children:s.jsxs("svg",{width:"12",height:"12",viewBox:"0 0 48 72",xmlns:"http://www.w3.org/2000/svg",style:{marginTop:"2px"},children:[s.jsx("path",{d:"M24 0 C13 0 4 9 4 20 C4 34 17 48 22.5 67 C22.8 68 23.3 72 24 72 C24.7 72 25.2 68 25.5 67 C31 48 44 34 44 20 C44 9 35 0 24 0Z",fill:"#ea4335",stroke:"#b11313",strokeWidth:"1"}),s.jsx("circle",{cx:"24",cy:"20",r:"8",fill:"#b11313"})]})}):s.jsx(rf,{className:"layer-indicator w-3 h-3 rounded-full transition-all duration-200}",style:{backgroundColor:i(e.id,e._originalLayerId),boxShadow:`0 0 0 2px ${i(e.id,e._originalLayerId)}30`,border:"saved-polygons"!==e.id&&"jurisdiction-boundary"!==e.id||"hybrid"!==_?"none":"1.5px solid rgba(0, 0, 0, 0.4)"}})}),s.jsx(rf,{className:"flex-1 min-w-0",children:s.jsx(vA,{variant:"body2",className:"text-xs font-medium transition-all duration-150 "+(e.visible?"text-gray-900":"text-gray-400 line-through"),sx:{fontWeight:500,opacity:e.visible?1:.6},children:o(e.id)})}),"saved-routes-tile"===e.id&&s.jsx(tA,{size:"small",onClick:e=>{e.stopPropagation(),d(!u)},className:"p-0.5",sx:{color:"rgba(0,0,0,0.54)","&:hover":{backgroundColor:"rgba(0,0,0,0.08)"}},children:s.jsx(GX,{sx:{fontSize:18,transform:u?"rotate(180deg)":"rotate(0deg)",transition:"transform 0.25s cubic-bezier(0.4, 0, 0.2, 1)"}})}),"imported-roads"===e.id&&s.jsx(tA,{size:"small",onClick:e=>{e.stopPropagation(),h(!A)},className:"p-0.5",sx:{color:"rgba(0,0,0,0.54)","&:hover":{backgroundColor:"rgba(0,0,0,0.08)"}},children:s.jsx(GX,{sx:{fontSize:18,transform:A?"rotate(180deg)":"rotate(0deg)",transition:"transform 0.25s cubic-bezier(0.4, 0, 0.2, 1)"}})}),"selected-route-segments"===e.id&&s.jsx(tA,{size:"small",onClick:e=>{e.stopPropagation(),f(!p)},className:"p-0.5",sx:{color:"rgba(0,0,0,0.54)","&:hover":{backgroundColor:"rgba(0,0,0,0.08)"}},children:s.jsx(GX,{sx:{fontSize:18,transform:p?"rotate(180deg)":"rotate(0deg)",transition:"transform 0.25s cubic-bezier(0.4, 0, 0.2, 1)"}})}),"segments"===e.id&&s.jsx(tA,{size:"small",onClick:e=>{e.stopPropagation(),m(!g)},className:"p-0.5",sx:{color:"rgba(0,0,0,0.54)","&:hover":{backgroundColor:"rgba(0,0,0,0.08)"}},children:s.jsx(GX,{sx:{fontSize:18,transform:g?"rotate(180deg)":"rotate(0deg)",transition:"transform 0.25s cubic-bezier(0.4, 0, 0.2, 1)"}})}),"feature-hover-highlight"!==e.id&&"selected-route"!==e.id&&s.jsx(Ev,{title:e.visible?"Hide Layer":"Show Layer",placement:"left",arrow:!0,children:s.jsx(jf,{size:"small",checked:e.visible,onChange:t=>{t.stopPropagation();const n=e._parentLayerId||e._originalId||e.id,r=a(n),o=!e.visible;if("segments"===e.id){["preview-segments","selected-route-segments","selected-route-segments-hovered"].forEach(e=>{y(e,o)}),y("segments",o)}else y(r,o)},icon:s.jsx(yY,{sx:{fontSize:16,color:"rgba(0,0,0,0.4)"}}),checkedIcon:s.jsx(mY,{sx:{fontSize:16,color:"rgba(37,99,235,0.9)"}}),className:"p-0",sx:{"&:hover":{backgroundColor:"rgba(37,99,235,0.08)"},"&.Mui-checked":{color:"rgba(37,99,235,0.9)"}}})})]}),"saved-routes-tile"===e.id&&u&&s.jsx(rf,{className:"px-3 pb-2 pl-5 space-y-1.5 pt-0.5",sx:{backgroundColor:"rgba(249, 250, 251, 0.5)"},children:t.map(e=>s.jsxs(rf,{className:"flex items-center gap-2 group/legend",children:[s.jsx(rf,{className:"legend-dot w-2.5 h-2.5 rounded-full transition-transform duration-200 shadow-sm",style:{backgroundColor:e.color,boxShadow:`0 0 0 1px ${e.color}40`}}),s.jsx(vA,{variant:"caption",className:"text-xs text-gray-700 font-medium",sx:{fontWeight:500},children:e.label})]},e.label))}),"imported-roads"===e.id&&A&&s.jsx(rf,{className:"px-3 pb-2 pl-5 space-y-1.5 pt-0.5",sx:{backgroundColor:"rgba(249, 250, 251, 0.5)"},children:n.map(e=>{const t="Default"===e.label||"Imported"===e.label,n="hybrid"===_;return s.jsxs(rf,{className:"flex items-center gap-2 group/legend",children:[s.jsx(rf,{className:"legend-dot w-2.5 h-2.5 rounded-full transition-transform duration-200 shadow-sm"+(t&&n?" border border-gray-400":""),style:{backgroundColor:e.color}}),s.jsx(vA,{variant:"caption",className:"text-xs text-gray-700 font-medium",sx:{fontWeight:500},children:e.label})]},e.label)})}),"selected-route-segments"===e.id&&p&&r&&r.length>0&&s.jsx(rf,{className:"px-3 pb-2 pl-5 space-y-1.5 pt-0.5",sx:{backgroundColor:"rgba(249, 250, 251, 0.5)"},children:r.map(e=>s.jsxs(rf,{className:"flex items-center gap-2 group/legend",children:[s.jsx(rf,{className:"legend-dot w-2.5 h-2.5 rounded-full transition-transform duration-200 shadow-sm",style:{backgroundColor:e.color,boxShadow:`0 0 0 1px ${e.color}40`}}),s.jsx(vA,{variant:"caption",className:"text-xs text-gray-700 font-medium",sx:{fontWeight:500},children:e.label})]},e.label))}),"segments"===e.id&&g&&r&&r.length>0&&s.jsx(rf,{className:"px-3 pb-2 pl-5 space-y-1.5 pt-0.5",sx:{backgroundColor:"rgba(249, 250, 251, 0.5)"},children:r.map(e=>s.jsxs(rf,{className:"flex items-center gap-2 group/legend",children:[s.jsx(rf,{className:"legend-dot w-2.5 h-2.5 rounded-full transition-transform duration-200 shadow-sm",style:{backgroundColor:e.color,boxShadow:`0 0 0 1px ${e.color}40`}}),s.jsx(vA,{variant:"caption",className:"text-xs text-gray-700 font-medium",sx:{fontWeight:500},children:e.label})]},e.label))}),l<B.length-1&&s.jsx(rf,{sx:{height:"1px",backgroundColor:"rgba(0, 0, 0, 0.15)",mx:0,borderTop:"1px solid rgba(0, 0, 0, 0.08)"}})]},e.id))})})]}):s.jsxs(rf,{className:"px-3 py-3 flex items-center gap-1.5",children:[s.jsx(qX,{sx:{fontSize:14},className:"text-mui-text-secondary"}),s.jsx(vA,{variant:"caption",sx:{fontSize:"13px",fontWeight:500},children:I}),s.jsx(HX,{sx:{fontSize:14,marginLeft:"auto"}})]})})};function M5(e,t,n){let r,o=n.initialDeps??[],i=!0;function s(){var s,a,l;let c;n.key&&(null==(s=n.debug)?void 0:s.call(n))&&(c=Date.now());const u=e(),d=u.length!==o.length||u.some((e,t)=>o[t]!==e);if(!d)return r;let A;if(o=u,n.key&&(null==(a=n.debug)?void 0:a.call(n))&&(A=Date.now()),r=t(...u),n.key&&(null==(l=n.debug)?void 0:l.call(n))){Math.round(100*(Date.now()-c)),Math.round(100*(Date.now()-A))}return!(null==n?void 0:n.onChange)||i&&n.skipInitialOnChange||n.onChange(r),i=!1,r}return s.updateDeps=e=>{o=e},s}function L5(e,t){if(void 0===e)throw new Error("Unexpected undefined");return e}const U5=(e,t,n)=>{let r;return function(...o){e.clearTimeout(r),r=e.setTimeout(()=>t.apply(this,o),n)}},O5=e=>{const{offsetWidth:t,offsetHeight:n}=e;return{width:t,height:n}},D5=e=>e,N5=e=>{const t=Math.max(e.startIndex-e.overscan,0),n=Math.min(e.endIndex+e.overscan,e.count-1),r=[];for(let o=t;o<=n;o++)r.push(o);return r},j5=(e,t)=>{const n=e.scrollElement;if(!n)return;const r=e.targetWindow;if(!r)return;const o=e=>{const{width:n,height:r}=e;t({width:Math.round(n),height:Math.round(r)})};if(o(O5(n)),!r.ResizeObserver)return()=>{};const i=new r.ResizeObserver(t=>{const r=()=>{const e=t[0];if(null==e?void 0:e.borderBoxSize){const t=e.borderBoxSize[0];if(t)return void o({width:t.inlineSize,height:t.blockSize})}o(O5(n))};e.options.useAnimationFrameWithResizeObserver?requestAnimationFrame(r):r()});return i.observe(n,{box:"border-box"}),()=>{i.unobserve(n)}},Q5={passive:!0},z5="undefined"==typeof window||"onscrollend"in window,H5=(e,t)=>{const n=e.scrollElement;if(!n)return;const r=e.targetWindow;if(!r)return;let o=0;const i=e.options.useScrollendEvent&&z5?()=>{}:U5(r,()=>{t(o,!1)},e.options.isScrollingResetDelay),s=r=>()=>{const{horizontal:s,isRtl:a}=e.options;o=s?n.scrollLeft*(a?-1:1):n.scrollTop,i(),t(o,r)},a=s(!0),l=s(!1);l(),n.addEventListener("scroll",a,Q5);const c=e.options.useScrollendEvent&&z5;return c&&n.addEventListener("scrollend",l,Q5),()=>{n.removeEventListener("scroll",a),c&&n.removeEventListener("scrollend",l)}},G5=(e,t,n)=>{if(null==t?void 0:t.borderBoxSize){const e=t.borderBoxSize[0];if(e){return Math.round(e[n.options.horizontal?"inlineSize":"blockSize"])}}return e[n.options.horizontal?"offsetWidth":"offsetHeight"]},V5=(e,{adjustments:t=0,behavior:n},r)=>{var o,i;const s=e+t;null==(i=null==(o=r.scrollElement)?void 0:o.scrollTo)||i.call(o,{[r.options.horizontal?"left":"top"]:s,behavior:n})};class W5{constructor(e){this.unsubs=[],this.scrollElement=null,this.targetWindow=null,this.isScrolling=!1,this.measurementsCache=[],this.itemSizeCache=new Map,this.laneAssignments=new Map,this.pendingMeasuredCacheIndexes=[],this.prevLanes=void 0,this.lanesChangedFlag=!1,this.lanesSettling=!1,this.scrollRect=null,this.scrollOffset=null,this.scrollDirection=null,this.scrollAdjustments=0,this.elementsCache=new Map,this.observer=(()=>{let e=null;const t=()=>e||(this.targetWindow&&this.targetWindow.ResizeObserver?e=new this.targetWindow.ResizeObserver(e=>{e.forEach(e=>{const t=()=>{this._measureElement(e.target,e)};this.options.useAnimationFrameWithResizeObserver?requestAnimationFrame(t):t()})}):null);return{disconnect:()=>{var n;null==(n=t())||n.disconnect(),e=null},observe:e=>{var n;return null==(n=t())?void 0:n.observe(e,{box:"border-box"})},unobserve:e=>{var n;return null==(n=t())?void 0:n.unobserve(e)}}})(),this.range=null,this.setOptions=e=>{Object.entries(e).forEach(([t,n])=>{void 0===n&&delete e[t]}),this.options={debug:!1,initialOffset:0,overscan:1,paddingStart:0,paddingEnd:0,scrollPaddingStart:0,scrollPaddingEnd:0,horizontal:!1,getItemKey:D5,rangeExtractor:N5,onChange:()=>{},measureElement:G5,initialRect:{width:0,height:0},scrollMargin:0,gap:0,indexAttribute:"data-index",initialMeasurementsCache:[],lanes:1,isScrollingResetDelay:150,enabled:!0,isRtl:!1,useScrollendEvent:!1,useAnimationFrameWithResizeObserver:!1,...e}},this.notify=e=>{var t,n;null==(n=(t=this.options).onChange)||n.call(t,this,e)},this.maybeNotify=M5(()=>(this.calculateRange(),[this.isScrolling,this.range?this.range.startIndex:null,this.range?this.range.endIndex:null]),e=>{this.notify(e)},{key:!1,debug:()=>this.options.debug,initialDeps:[this.isScrolling,this.range?this.range.startIndex:null,this.range?this.range.endIndex:null]}),this.cleanup=()=>{this.unsubs.filter(Boolean).forEach(e=>e()),this.unsubs=[],this.observer.disconnect(),this.scrollElement=null,this.targetWindow=null},this._didMount=()=>()=>{this.cleanup()},this._willUpdate=()=>{var e;const t=this.options.enabled?this.options.getScrollElement():null;if(this.scrollElement!==t){if(this.cleanup(),!t)return void this.maybeNotify();this.scrollElement=t,this.scrollElement&&"ownerDocument"in this.scrollElement?this.targetWindow=this.scrollElement.ownerDocument.defaultView:this.targetWindow=(null==(e=this.scrollElement)?void 0:e.window)??null,this.elementsCache.forEach(e=>{this.observer.observe(e)}),this._scrollToOffset(this.getScrollOffset(),{adjustments:void 0,behavior:void 0}),this.unsubs.push(this.options.observeElementRect(this,e=>{this.scrollRect=e,this.maybeNotify()})),this.unsubs.push(this.options.observeElementOffset(this,(e,t)=>{this.scrollAdjustments=0,this.scrollDirection=t?this.getScrollOffset()<e?"forward":"backward":null,this.scrollOffset=e,this.isScrolling=t,this.maybeNotify()}))}},this.getSize=()=>this.options.enabled?(this.scrollRect=this.scrollRect??this.options.initialRect,this.scrollRect[this.options.horizontal?"width":"height"]):(this.scrollRect=null,0),this.getScrollOffset=()=>this.options.enabled?(this.scrollOffset=this.scrollOffset??("function"==typeof this.options.initialOffset?this.options.initialOffset():this.options.initialOffset),this.scrollOffset):(this.scrollOffset=null,0),this.getFurthestMeasurement=(e,t)=>{const n=new Map,r=new Map;for(let o=t-1;o>=0;o--){const t=e[o];if(n.has(t.lane))continue;const i=r.get(t.lane);if(null==i||t.end>i.end?r.set(t.lane,t):t.end<i.end&&n.set(t.lane,!0),n.size===this.options.lanes)break}return r.size===this.options.lanes?Array.from(r.values()).sort((e,t)=>e.end===t.end?e.index-t.index:e.end-t.end)[0]:void 0},this.getMeasurementOptions=M5(()=>[this.options.count,this.options.paddingStart,this.options.scrollMargin,this.options.getItemKey,this.options.enabled,this.options.lanes],(e,t,n,r,o,i)=>(void 0!==this.prevLanes&&this.prevLanes!==i&&(this.lanesChangedFlag=!0),this.prevLanes=i,this.pendingMeasuredCacheIndexes=[],{count:e,paddingStart:t,scrollMargin:n,getItemKey:r,enabled:o,lanes:i}),{key:!1,skipInitialOnChange:!0,onChange:()=>{this.notify(this.isScrolling)}}),this.getMeasurements=M5(()=>[this.getMeasurementOptions(),this.itemSizeCache],({count:e,paddingStart:t,scrollMargin:n,getItemKey:r,enabled:o,lanes:i},s)=>{if(!o)return this.measurementsCache=[],this.itemSizeCache.clear(),this.laneAssignments.clear(),[];if(this.laneAssignments.size>e)for(const u of this.laneAssignments.keys())u>=e&&this.laneAssignments.delete(u);this.lanesChangedFlag&&(this.lanesChangedFlag=!1,this.lanesSettling=!0,this.measurementsCache=[],this.itemSizeCache.clear(),this.laneAssignments.clear(),this.pendingMeasuredCacheIndexes=[]),0===this.measurementsCache.length&&(this.measurementsCache=this.options.initialMeasurementsCache,this.measurementsCache.forEach(e=>{this.itemSizeCache.set(e.key,e.size)}));const a=this.lanesSettling?0:this.pendingMeasuredCacheIndexes.length>0?Math.min(...this.pendingMeasuredCacheIndexes):0;this.pendingMeasuredCacheIndexes=[],this.lanesSettling&&this.measurementsCache.length===e&&(this.lanesSettling=!1);const l=this.measurementsCache.slice(0,a),c=new Array(i).fill(void 0);for(let u=0;u<a;u++){const e=l[u];e&&(c[e.lane]=u)}for(let u=a;u<e;u++){const e=r(u),o=this.laneAssignments.get(u);let i,a;if(void 0!==o&&this.options.lanes>1){i=o;const e=c[i],r=void 0!==e?l[e]:void 0;a=r?r.end+this.options.gap:t+n}else{const e=1===this.options.lanes?l[u-1]:this.getFurthestMeasurement(l,u);a=e?e.end+this.options.gap:t+n,i=e?e.lane:u%this.options.lanes,this.options.lanes>1&&this.laneAssignments.set(u,i)}const d=s.get(e),A="number"==typeof d?d:this.options.estimateSize(u),h=a+A;l[u]={index:u,start:a,size:A,end:h,key:e,lane:i},c[i]=u}return this.measurementsCache=l,l},{key:!1,debug:()=>this.options.debug}),this.calculateRange=M5(()=>[this.getMeasurements(),this.getSize(),this.getScrollOffset(),this.options.lanes],(e,t,n,r)=>this.range=e.length>0&&t>0?function({measurements:e,outerSize:t,scrollOffset:n,lanes:r}){const o=e.length-1,i=t=>e[t].start;if(e.length<=r)return{startIndex:0,endIndex:o};let s=$5(0,o,i,n),a=s;if(1===r)for(;a<o&&e[a].end<n+t;)a++;else if(r>1){const i=Array(r).fill(0);for(;a<o&&i.some(e=>e<n+t);){const t=e[a];i[t.lane]=t.end,a++}const l=Array(r).fill(n+t);for(;s>=0&&l.some(e=>e>=n);){const t=e[s];l[t.lane]=t.start,s--}s=Math.max(0,s-s%r),a=Math.min(o,a+(r-1-a%r))}return{startIndex:s,endIndex:a}}({measurements:e,outerSize:t,scrollOffset:n,lanes:r}):null,{key:!1,debug:()=>this.options.debug}),this.getVirtualIndexes=M5(()=>{let e=null,t=null;const n=this.calculateRange();return n&&(e=n.startIndex,t=n.endIndex),this.maybeNotify.updateDeps([this.isScrolling,e,t]),[this.options.rangeExtractor,this.options.overscan,this.options.count,e,t]},(e,t,n,r,o)=>null===r||null===o?[]:e({startIndex:r,endIndex:o,overscan:t,count:n}),{key:!1,debug:()=>this.options.debug}),this.indexFromElement=e=>{const t=this.options.indexAttribute,n=e.getAttribute(t);return n?parseInt(n,10):-1},this._measureElement=(e,t)=>{const n=this.indexFromElement(e),r=this.measurementsCache[n];if(!r)return;const o=r.key,i=this.elementsCache.get(o);i!==e&&(i&&this.observer.unobserve(i),this.observer.observe(e),this.elementsCache.set(o,e)),e.isConnected&&this.resizeItem(n,this.options.measureElement(e,t,this))},this.resizeItem=(e,t)=>{const n=this.measurementsCache[e];if(!n)return;const r=t-(this.itemSizeCache.get(n.key)??n.size);0!==r&&((void 0!==this.shouldAdjustScrollPositionOnItemSizeChange?this.shouldAdjustScrollPositionOnItemSizeChange(n,r,this):n.start<this.getScrollOffset()+this.scrollAdjustments)&&this._scrollToOffset(this.getScrollOffset(),{adjustments:this.scrollAdjustments+=r,behavior:void 0}),this.pendingMeasuredCacheIndexes.push(n.index),this.itemSizeCache=new Map(this.itemSizeCache.set(n.key,t)),this.notify(!1))},this.measureElement=e=>{e?this._measureElement(e,void 0):this.elementsCache.forEach((e,t)=>{e.isConnected||(this.observer.unobserve(e),this.elementsCache.delete(t))})},this.getVirtualItems=M5(()=>[this.getVirtualIndexes(),this.getMeasurements()],(e,t)=>{const n=[];for(let r=0,o=e.length;r<o;r++){const o=t[e[r]];n.push(o)}return n},{key:!1,debug:()=>this.options.debug}),this.getVirtualItemForOffset=e=>{const t=this.getMeasurements();if(0!==t.length)return L5(t[$5(0,t.length-1,e=>L5(t[e]).start,e)])},this.getOffsetForAlignment=(e,t,n=0)=>{const r=this.getSize(),o=this.getScrollOffset();"auto"===t&&(t=e>=o+r?"end":"start"),"center"===t?e+=(n-r)/2:"end"===t&&(e-=r);const i=this.getTotalSize()+this.options.scrollMargin-r;return Math.max(Math.min(i,e),0)},this.getOffsetForIndex=(e,t="auto")=>{e=Math.max(0,Math.min(e,this.options.count-1));const n=this.measurementsCache[e];if(!n)return;const r=this.getSize(),o=this.getScrollOffset();if("auto"===t)if(n.end>=o+r-this.options.scrollPaddingEnd)t="end";else{if(!(n.start<=o+this.options.scrollPaddingStart))return[o,t];t="start"}const i="end"===t?n.end+this.options.scrollPaddingEnd:n.start-this.options.scrollPaddingStart;return[this.getOffsetForAlignment(i,t,n.size),t]},this.isDynamicMode=()=>this.elementsCache.size>0,this.scrollToOffset=(e,{align:t="start",behavior:n}={})=>{"smooth"===n&&this.isDynamicMode(),this._scrollToOffset(this.getOffsetForAlignment(e,t),{adjustments:void 0,behavior:n})},this.scrollToIndex=(e,{align:t="auto",behavior:n}={})=>{"smooth"===n&&this.isDynamicMode(),e=Math.max(0,Math.min(e,this.options.count-1));let r=0;const o=t=>{if(!this.targetWindow)return;const r=this.getOffsetForIndex(e,t);if(!r)return;const[o,s]=r;this._scrollToOffset(o,{adjustments:void 0,behavior:n}),this.targetWindow.requestAnimationFrame(()=>{const t=this.getScrollOffset(),n=this.getOffsetForIndex(e,s);var r,o;n&&(r=n[0],o=t,Math.abs(r-o)<1.01||i(s))})},i=e=>{this.targetWindow&&(r++,r<10&&this.targetWindow.requestAnimationFrame(()=>o(e)))};o(t)},this.scrollBy=(e,{behavior:t}={})=>{"smooth"===t&&this.isDynamicMode(),this._scrollToOffset(this.getScrollOffset()+e,{adjustments:void 0,behavior:t})},this.getTotalSize=()=>{var e;const t=this.getMeasurements();let n;if(0===t.length)n=this.options.paddingStart;else if(1===this.options.lanes)n=(null==(e=t[t.length-1])?void 0:e.end)??0;else{const e=Array(this.options.lanes).fill(null);let r=t.length-1;for(;r>=0&&e.some(e=>null===e);){const n=t[r];null===e[n.lane]&&(e[n.lane]=n.end),r--}n=Math.max(...e.filter(e=>null!==e))}return Math.max(n-this.options.scrollMargin+this.options.paddingEnd,0)},this._scrollToOffset=(e,{adjustments:t,behavior:n})=>{this.options.scrollToFn(e,{behavior:n,adjustments:t},this)},this.measure=()=>{this.itemSizeCache=new Map,this.laneAssignments=new Map,this.notify(!1)},this.setOptions(e)}}const $5=(e,t,n,r)=>{for(;e<=t;){const o=(e+t)/2|0,i=n(o);if(i<r)e=o+1;else{if(!(i>r))return o;t=o-1}}return e>0?e-1:0};const K5="undefined"!=typeof document?pe.useLayoutEffect:pe.useEffect;function X5(e){return function(e){const t=pe.useReducer(()=>({}),{})[1],n={...e,onChange:(n,r)=>{var o;r?wu.flushSync(t):t(),null==(o=e.onChange)||o.call(e,n,r)}},[r]=pe.useState(()=>new W5(n));return r.setOptions(n),K5(()=>r._didMount(),[]),K5(()=>r._willUpdate()),r}({observeElementRect:j5,observeElementOffset:H5,scrollToFn:V5,...e})}const Y5=(e,t="km")=>{if(null==e||isNaN(e)||!isFinite(e))return"miles"===t?"0 mi":"0 km";const n=Math.max(0,e);if("miles"===t){const e=.621371*n;return e<.1?`${Math.round(5280*e)} ft`:`${e.toFixed(2)} mi`}return n<.1?`${Math.round(1e3*n)} m`:`${n.toFixed(2)} km`},q5=()=>Lj(e=>e.distanceUnit),J5=e=>.621371*e,Z5=e=>e/.621371,e6=({className:e,style:t,dynamicIslandHeight:n=0,maxHeight:r,title:o,subtitle:i,showBackButton:a=!1,showCloseButton:l=!0,headerBackgroundColor:c,onBack:u,onClose:d,headerContent:A,children:h,footer:p})=>{const f=r||(n>0?`calc(100vh - ${n}px - 60px)`:"calc(100vh - 200px - 80px)");return s.jsxs(gd,{elevation:2,className:`absolute top-20 right-4 w-[320px] bg-white z-[1000] overflow-hidden ${e||""}`,style:{...t,maxHeight:"number"==typeof f?`${f}px`:f},sx:{borderRadius:"24px",border:"none",boxShadow:"0 4px 16px rgba(0, 0, 0, 0.15), 0 2px 8px rgba(0, 0, 0, 0.1)",display:"flex",flexDirection:"column",height:"fit-content",overflow:"hidden"},children:[s.jsxs(rf,{sx:{px:2.5,py:2,display:"flex",alignItems:"center",justifyContent:"space-between",borderBottom:"1px solid #e8eaed",backgroundColor:c||"#fafafa"},children:[s.jsxs(rf,{sx:{display:"flex",alignItems:"center",gap:1,flex:1},children:[a&&u&&s.jsx(tA,{size:"small",onClick:u,sx:{color:"#5f6368","&:hover":{backgroundColor:"#f1f3f4"}},children:s.jsx(gX,{fontSize:"small"})}),s.jsxs(rf,{sx:{flex:1,minWidth:0},children:["string"==typeof o?s.jsx(vA,{variant:"h6",component:"div",sx:{fontSize:"18px",fontFamily:'"Google Sans", sans-serif',fontWeight:500,color:"#111827",lineHeight:1.2},children:o}):s.jsx(rf,{className:"truncate",sx:{fontSize:"18px",fontFamily:'"Google Sans", sans-serif',fontWeight:500,color:"#111827",lineHeight:1.2,width:"100%",maxWidth:"100%",minWidth:0,overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:o}),i&&s.jsx(vA,{variant:"body2",sx:{fontSize:"0.813rem",fontWeight:400,color:"#5f6368",fontFamily:'"Google Sans", sans-serif',mt:.5},children:i})]})]}),s.jsxs(rf,{sx:{display:"flex",alignItems:"center",gap:.5},children:[A,l&&d&&s.jsx(tA,{size:"small",onClick:d,sx:{color:"#5f6368","&:hover":{backgroundColor:"#f1f3f4"}},children:s.jsx(IX,{fontSize:"small"})})]})]}),s.jsx(rf,{sx:{flex:1,overflow:"auto",display:"flex",flexDirection:"column",minHeight:0},children:h}),p&&s.jsx(rf,{sx:{borderTop:"1px solid #e8eaed",backgroundColor:"#ffffff"},children:p})]})},t6=e=>{if(!e)return"";return e.replace("ROAD_PRIORITY_","").replace(/_/g," ").toLowerCase().replace(/\b\w/g,e=>e.toUpperCase())},n6=()=>{const e=ia(),{mapMode:t,setMapMode:n,projectId:r,dynamicIslandHeight:o,setLeftPanelExpanded:i,setCurrentFolder:a}=JN(),l=$N(e=>e.resetRoadPriorityFilters),c=$N(e=>e.roadImport),u=$N(e=>e.removeRouteFromPanel),d=$N(e=>e.updateRouteName),A=$N(e=>e.setHoveredRoadId),h=$N(e=>e.clearRoadImport),p=$N(e=>e.clearAllDrawing),f=$N(e=>e.combineMultiSelectRoadsToRoute),g=$N(e=>e.setMultiSelectValidationResult),m=$N(e=>e.setMultiSelectValidating),y=lX(),v=AX(),b=q5(),{data:w=[]}=cX(r||""),x=GZ("main-map"),[_,C]=pe.useState(null),[S,E]=pe.useState(""),[B,I]=pe.useState(null),[R,k]=pe.useState(!1),[T,P]=pe.useState(!1),[F,M]=pe.useState(window.innerHeight);pe.useEffect(()=>{const e=()=>{M(window.innerHeight)};return window.addEventListener("resize",e),()=>window.removeEventListener("resize",e)},[]);const L=pe.useMemo(()=>{const e=F-144-22-o-24;return Math.max(Math.min(e,600),400)},[o,F]),U=pe.useMemo(()=>L-80-(R?120:60)-20,[L,R]),O=pe.useMemo(()=>[...c.panelRoutes].reverse(),[c.panelRoutes]),D=pe.useMemo(()=>c.panelRoutes.reduce((e,t)=>e+t.roadIds.length,0),[c.panelRoutes]),N=pe.useMemo(()=>c.panelRoutes&&c.panelRoutes.length>0||c.lassoFilteredRoadIds&&c.lassoFilteredRoadIds.length>0||c.multiSelectTempSelection&&c.multiSelectTempSelection.length>0,[c.panelRoutes,c.lassoFilteredRoadIds,c.multiSelectTempSelection]),j=pe.useRef(""),Q=pe.useMemo(()=>JSON.stringify([...c.multiSelectTempSelection].sort()),[c.multiSelectTempSelection]);pe.useEffect(()=>{if(!c.multiSelectValidating&&j.current!==Q)if("multi-select"===c.selectionMode&&c.multiSelectTempSelection.length>0&&r){const e=c.multiSelectTempSelection.map(e=>parseInt(e));e.length>0&&(j.current=Q,m(!0),v.mutateAsync({roadIds:e,projectId:r}).then(e=>{g(e)}).catch(e=>{g({is_continuous:!1,gaps:[],error:e instanceof Error?e.message:"Validation failed"})}).finally(()=>{m(!1)}))}else c.multiSelectValidationResult&&g(null),j.current=""},[Q,c.selectionMode,c.multiSelectValidating,r]);const z=pe.useRef(null),H=O.length>20,G=X5({count:O.length,getScrollElement:()=>z.current,estimateSize:()=>68,overscan:5,enabled:H}),V=pe.useRef(""),W=pe.useRef(0);pe.useEffect(()=>{if(H){const e=G.getVirtualItems();if(e.length>0&&O.length>0){const t=e.map(e=>e.index),n=`${t[0]}-${t[t.length-1]}`;V.current!==n&&(V.current=n)}}},[O.length,U,G,H]),pe.useEffect(()=>{const e=O.length;e>W.current&&z.current&&(z.current.scrollTop=0),W.current=e},[O.length]);const $=pe.useRef(null),K=pe.useRef(c.panelRoutes.length);if(pe.useEffect(()=>{const e=c.importedRoads,t=$.current,n=c.panelRoutes.length,r=K.current;(!t&&e&&0===n||r>0&&0===n)&&k(!1),$.current=e,K.current=n},[c.importedRoads,c.panelRoutes.length]),"road_selection"!==t)return null;const X=(e,t)=>{t&&t.stopPropagation(),C(e.id),E(e.name)},Y=e=>{const t=S.trim();t&&t.length<=100&&(d(e,t),C(null),E(""))},q=()=>{C(null),E("")},J=(e,t)=>{t&&t.stopPropagation(),u(e)},Z=async()=>{if(r&&0!==c.panelRoutes.length)try{const t=c.panelRoutes.map(e=>{const t=e.geometry.coordinates;if(!t||t.length<2)throw new Error(`Invalid geometry for route ${e.name}`);const n=[t[0][0],t[0][1]],r=[t[t.length-1][0],t[t.length-1][1]],o=zw(e.geometry).map(e=>[e.lng,e.lat]);return{id:e.id,name:e.name,linestringGeoJson:e.geometry,origin:n,destination:r,length:e.distance,waypoints:o,route_type:"imported"}}),o=await y.mutateAsync({projectId:r,tag:B||"",roads:t});if(Tw(`Saved ${o.savedCount} route${1===o.savedCount?"":"s"} successfully.`),o.errors.length>0&&Pw(`Failed to save ${o.errors.length} route${1===o.errors.length?"":"s"}: ${o.errors.map(e=>e.message).join("; ")}`),r)try{await uj.delete(`/polygon/delete/${r}`)}catch(e){Pw("Failed to delete roads",{description:e instanceof Error?e.message:"Could not delete roads from database"})}const s=B||"";h(),p(),n("view"),l(),I(null),a(s||"Untagged"),i(!0)}catch(e){Pw(e instanceof Error?e.message:"Failed to save routes")}},ee=()=>{P(!1)},te=async()=>{if(P(!1),r)try{await uj.delete(`/polygon/delete/${r}`)}catch(e){Pw("Failed to delete roads",{description:e instanceof Error?e.message:"Could not delete roads from database"})}h(),p(),n("view"),l()},ne=()=>{k(!1),I(null)},re=e=>e.name||"Unnamed Route";if(R)return s.jsxs(s.Fragment,{children:[s.jsx(e6,{maxHeight:L,title:"Save Routes",showBackButton:!1,showCloseButton:!0,onClose:ne,footer:s.jsxs(rf,{sx:{px:2.5,pt:1,pb:1,display:"flex",gap:1},children:[s.jsx(Nv,{variant:"outlined",fullWidth:!0,onClick:ne,size:"small",sx:{textTransform:"none",fontSize:e.fontSizes.body,fontWeight:500,fontFamily:'"Google Sans", sans-serif',py:1,borderColor:"#dadce0",color:"#5f6368","&:hover":{borderColor:"#bdc1c6",backgroundColor:"#f8f9fa"}},children:"Back"}),s.jsx(Nv,{variant:"contained",color:"primary",fullWidth:!0,onClick:Z,disabled:y.isPending,size:"small",sx:{textTransform:"none",fontSize:e.fontSizes.body,fontWeight:500,fontFamily:'"Google Sans", sans-serif',py:1,backgroundColor:"#1976d2",boxShadow:"none","&:hover":{backgroundColor:"#1565c0",boxShadow:"0 1px 3px rgba(0, 0, 0, 0.12)"},"&.Mui-disabled":{backgroundColor:"#e8eaed",color:"#bdc1c6"}},children:y.isPending?"Saving...":"Confirm"})]}),children:s.jsxs(rf,{sx:{px:2.5,py:1.5,display:"flex",flexDirection:"column",gap:2},children:[s.jsxs(vA,{variant:"caption",sx:{fontSize:e.fontSizes.caption,fontFamily:'"Google Sans", sans-serif',color:"#5f6368",display:"block"},children:["Save all ",D," road",1!==D?"s":""," ","as routes."]}),s.jsx(T5,{value:B,onChange:I,tags:w,placeholder:"Select folder (optional)",required:!1,label:"Folder"})]})}),s.jsx(f5,{open:T,fromMode:"road_selection",toMode:"view",onConfirm:te,onCancel:ee})]});const oe=(()=>{if("multi-select"!==c.selectionMode||0===c.multiSelectTempSelection.length)return null;if(c.multiSelectValidating)return{text:" Validating...",color:"#999"};if(c.multiSelectValidationResult){const e=c.multiSelectValidationResult;if(e.is_continuous)return{text:" Continuous path",color:"#4CAF50"};{const t=e.gaps||[];if(t.length>0){const e=t[0];return{text:` Gap detected: ${e.distance_meters?.toFixed(1)||"unknown"}m between Road ${e.from_road_id} and Road ${e.to_road_id}`,color:"#FF9800"}}return{text:" Disconnected roads",color:"#FF9800"}}}return null})(),ie="multi-select"===c.selectionMode,se=c.multiSelectTempSelection.length>0;return s.jsxs(s.Fragment,{children:[s.jsxs(e6,{maxHeight:L,title:s.jsxs(s.Fragment,{children:["Selected Roads"," ",s.jsxs("span",{className:"text-sm text-gray-500 ml-1",children:["(",D,")"]})]}),onClose:async()=>{if(N)P(!0);else{if(r)try{await uj.delete(`/polygon/delete/${r}`)}catch(e){Pw("Failed to delete roads",{description:e instanceof Error?e.message:"Could not delete roads from database"})}h(),p(),n("view"),l()}},footer:s.jsxs(rf,{sx:{px:2.5,pt:2,pb:2,display:"flex",flexDirection:"column",gap:1},children:[ie&&se&&s.jsx(Nv,{variant:"contained",color:"primary",fullWidth:!0,onClick:async()=>{try{await f(),Tw("Routes combined successfully")}catch(e){Pw(e instanceof Error?e.message:"Failed to combine roads")}},disabled:v.isPending,sx:{textTransform:"none",fontSize:e.fontSizes.body,fontWeight:500,fontFamily:'"Google Sans", sans-serif',padding:"6px 12px",backgroundColor:"#1976d2",boxShadow:"none","&:hover":{backgroundColor:"#1565c0",boxShadow:"0 1px 3px rgba(0, 0, 0, 0.12)"},"&.Mui-disabled":{backgroundColor:"#e8eaed",color:"#bdc1c6"}},children:v.isPending?"Combining...":`Save as Route (${c.multiSelectTempSelection.length} roads)`}),s.jsx(Nv,{variant:"contained",color:"primary",fullWidth:!0,onClick:()=>{0!==c.panelRoutes.length&&k(!0)},disabled:0===c.panelRoutes.length,sx:{textTransform:"none",fontSize:e.fontSizes.body,fontWeight:500,fontFamily:'"Google Sans", sans-serif',padding:"6px 12px",backgroundColor:"#1976d2",boxShadow:"none","&:hover":{backgroundColor:"#1565c0",boxShadow:"0 1px 3px rgba(0, 0, 0, 0.12)"},"&.Mui-disabled":{backgroundColor:"#e8eaed",color:"#bdc1c6"}},children:"Confirm"})]}),children:[oe&&s.jsx(rf,{sx:{px:2.5,py:1.5,borderBottom:"1px solid #e8eaed"},children:s.jsx(rf,{sx:{borderRadius:"12px",px:2,py:1.5,backgroundColor:"#4CAF50"===oe.color?"#E8F5E9":"#FF9800"===oe.color?"#FFF3E0":"#F5F5F5"},children:s.jsx(vA,{variant:"caption",sx:{fontSize:e.fontSizes.helper,color:oe.color,fontWeight:500,fontFamily:'"Google Sans", sans-serif'},children:oe.text})})}),s.jsx(rf,{sx:{flex:1,overflow:"hidden",display:"flex",flexDirection:"column"},children:0!==c.panelRoutes.length||se?s.jsx(rf,{ref:z,sx:{maxHeight:`${U}px`,overflowY:"auto",px:.5,py:.5,"&::-webkit-scrollbar":{width:"8px"},"&::-webkit-scrollbar-track":{backgroundColor:"#f1f3f4",borderRadius:"4px"},"&::-webkit-scrollbar-thumb":{backgroundColor:"#dadce0",borderRadius:"4px","&:hover":{backgroundColor:"#bdc1c6"}}},children:H?s.jsx("div",{style:{height:`${G.getTotalSize()}px`,width:"100%",position:"relative"},children:G.getVirtualItems().map(t=>{const n=O[t.index],r=_===n.id,o=re(n),i=t6(n.priority);return s.jsx("div",{"data-index":t.index,ref:G.measureElement,style:{position:"absolute",top:0,left:0,width:"100%",transform:`translateY(${t.start}px)`,paddingBottom:"4px",boxSizing:"border-box"},children:s.jsx(Mm,{disablePadding:!0,style:{width:"100%"},children:s.jsx(Im,{onClick:e=>{e.target.closest("button")||x({linestring:n.geometry})},onMouseEnter:()=>{n.roadIds.length>0&&A(n.roadIds[0])},onMouseLeave:()=>{A(null)},sx:{minHeight:64,padding:"8px 10px",borderRadius:"12px",position:"relative",zIndex:10,backgroundColor:"#ffffff",border:"1px solid #e0e0e0",boxShadow:"0 1px 2px rgba(0, 0, 0, 0.05)",cursor:"pointer","&:hover":{backgroundColor:"#f5f5f5",boxShadow:"0 2px 4px rgba(0, 0, 0, 0.1)",borderColor:"#d0d0d0"},"&:active":{backgroundColor:"#eeeeee"}},children:r?s.jsxs(s.Fragment,{children:[s.jsx(Dv,{value:S,onChange:e=>E(e.target.value),onClick:e=>e.stopPropagation(),onKeyDown:e=>{"Enter"===e.key?(e.stopPropagation(),Y(n.id)):"Escape"===e.key&&(e.stopPropagation(),q())},autoFocus:!0,variant:"standard",placeholder:"Enter route name",fullWidth:!0,inputProps:{maxLength:100},sx:{flex:1,"& .MuiInput-root":{fontSize:e.fontSizes.body,fontFamily:'"Google Sans", sans-serif',fontWeight:500,"&::before":{borderBottom:"1px solid #e0e0e0"},"&::after":{borderBottom:"2px solid #1976d2"}},"& .MuiInput-input":{padding:0}}}),s.jsxs(rf,{sx:{display:"flex",gap:.5,ml:1},children:[s.jsx(tA,{size:"small",onClick:e=>{e.stopPropagation(),q()},title:"Cancel",sx:{minWidth:10,minHeight:10,padding:"6px",color:"#5f6368",borderRadius:"999px","&:hover":{backgroundColor:"rgba(219, 0, 0,0.12)"}},children:s.jsx(RX,{sx:{fontSize:18}})}),s.jsx(tA,{size:"small",onClick:e=>{e.stopPropagation(),Y(n.id)},title:"Save",sx:{minWidth:28,minHeight:28,padding:"6px",color:"#1976d2",borderRadius:"999px","&:hover":{backgroundColor:"rgba(25, 118, 210, 0.12)"}},children:s.jsx(xX,{sx:{fontSize:18}})})]})]}):s.jsxs(rf,{sx:{display:"flex",alignItems:"center",gap:2,width:"100%"},children:[s.jsxs(rf,{sx:{flex:1,minWidth:0},children:[s.jsx(vA,{variant:"body2",title:n.roadIds.length>1?`${o}\nMade from ${n.roadIds.length} roads`:o,sx:{fontSize:e.fontSizes.body,fontWeight:500,color:"#111827",fontFamily:'"Google Sans", sans-serif',overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",mb:.75},children:o}),s.jsxs(rf,{sx:{display:"flex",alignItems:"center",gap:1,flexWrap:"wrap"},children:[s.jsx(vA,{variant:"caption",sx:{color:"#5f6368",fontWeight:400,fontSize:e.fontSizes.helper,fontFamily:'"Google Sans", sans-serif'},children:Y5(n.distance,b)}),n.roadIds.length>1&&s.jsxs(s.Fragment,{children:[s.jsx(vA,{variant:"caption",sx:{color:"#dadce0",fontSize:e.fontSizes.helper},children:""}),s.jsx(ap,{label:`${n.roadIds.length} roads`,size:"small",sx:{height:18,fontSize:e.fontSizes.caption,fontWeight:500,backgroundColor:"transparent",color:"#5f6368",border:"1px solid #dadce0","& .MuiChip-label":{padding:"0 6px",fontSize:e.fontSizes.caption,lineHeight:1.2}}})]}),n.priority&&s.jsxs(s.Fragment,{children:[s.jsx(vA,{variant:"caption",sx:{color:"#dadce0",fontSize:e.fontSizes.helper},children:""}),s.jsx(ap,{label:i,size:"small",sx:{height:18,fontSize:e.fontSizes.caption,fontWeight:500,backgroundColor:(i.includes("Limited"),"transparent"),color:i.includes("Limited")?"#c5221f":"#1967d2",border:"1px solid "+(i.includes("Limited")?"#fce8e6":"#90caf9"),"& .MuiChip-label":{padding:"0 6px",fontSize:e.fontSizes.caption,lineHeight:1.2}}})]})]})]}),s.jsxs(rf,{sx:{display:"flex",alignItems:"center",gap:.5},children:[s.jsx(tA,{size:"small",onClick:e=>{e.stopPropagation(),X(n,e)},title:"Rename",sx:{minWidth:32,minHeight:32,padding:"6px",color:"#5f6368",borderRadius:"6px","&:hover":{backgroundColor:"#f5f5f5",color:"#1976d2"}},children:s.jsx(jX,{sx:{fontSize:18}})}),s.jsx(tA,{size:"small",onClick:e=>J(n.id,e),title:"Remove",sx:{minWidth:32,minHeight:32,padding:"6px",color:"#5f6368",borderRadius:"6px","&:hover":{backgroundColor:"#f5f5f5",color:"#5f6368"}},children:s.jsx(MX,{sx:{fontSize:18}})})]})]})})})},n.id)})}):s.jsx(rf,{sx:{display:"flex",flexDirection:"column",gap:.5,px:.5,py:.5},children:O.map(t=>{const n=_===t.id,r=re(t),o=t6(t.priority);return s.jsx(Mm,{disablePadding:!0,style:{width:"100%"},children:s.jsx(Im,{onClick:e=>{e.target.closest("button")||x({linestring:t.geometry})},onMouseEnter:()=>{t.roadIds.length>0&&A(t.roadIds[0])},onMouseLeave:()=>A(null),sx:{minHeight:64,padding:"8px 10px",borderRadius:"12px",position:"relative",zIndex:10,backgroundColor:"#ffffff",border:"1px solid #e0e0e0",boxShadow:"0 1px 2px rgba(0, 0, 0, 0.05)",cursor:"pointer","&:hover":{backgroundColor:"#f5f5f5",boxShadow:"0 2px 4px rgba(0, 0, 0, 0.1)",borderColor:"#d0d0d0"},"&:active":{backgroundColor:"#eeeeee"}},children:n?s.jsxs(s.Fragment,{children:[s.jsx(Dv,{value:S,onChange:e=>E(e.target.value),onClick:e=>e.stopPropagation(),onKeyDown:e=>{"Enter"===e.key?(e.stopPropagation(),Y(t.id)):"Escape"===e.key&&(e.stopPropagation(),q())},autoFocus:!0,variant:"standard",placeholder:"Enter route name",fullWidth:!0,inputProps:{maxLength:100},sx:{flex:1,"& .MuiInput-root":{fontSize:e.fontSizes.body,fontFamily:'"Google Sans", sans-serif',fontWeight:500,"&::before":{borderBottom:"1px solid #e0e0e0"},"&::after":{borderBottom:"2px solid #1976d2"}},"& .MuiInput-input":{padding:0}}}),s.jsxs(rf,{sx:{display:"flex",gap:.5,ml:1},children:[s.jsx(tA,{size:"small",onClick:e=>{e.stopPropagation(),q()},title:"Cancel",sx:{minWidth:10,minHeight:10,padding:"6px",color:"#5f6368",borderRadius:"999px","&:hover":{backgroundColor:"rgba(219, 0, 0,0.12)"}},children:s.jsx(RX,{sx:{fontSize:18}})}),s.jsx(tA,{size:"small",onClick:e=>{e.stopPropagation(),Y(t.id)},title:"Save",sx:{minWidth:28,minHeight:28,padding:"6px",color:"#1976d2",borderRadius:"999px","&:hover":{backgroundColor:"rgba(25, 118, 210, 0.12)"}},children:s.jsx(xX,{sx:{fontSize:18}})})]})]}):s.jsxs(rf,{sx:{display:"flex",alignItems:"center",gap:2,width:"100%"},children:[s.jsxs(rf,{sx:{flex:1,minWidth:0},children:[s.jsx(vA,{variant:"body2",title:t.roadIds.length>1?`${r}\nMade from ${t.roadIds.length} roads`:r,sx:{fontSize:e.fontSizes.body,fontWeight:500,color:"#111827",fontFamily:'"Google Sans", sans-serif',overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",mb:.75},children:r}),s.jsxs(rf,{sx:{display:"flex",alignItems:"center",gap:1,flexWrap:"wrap"},children:[s.jsx(vA,{variant:"caption",sx:{color:"#5f6368",fontWeight:400,fontSize:e.fontSizes.helper,fontFamily:'"Google Sans", sans-serif'},children:Y5(t.distance,b)}),t.roadIds.length>1&&s.jsxs(s.Fragment,{children:[s.jsx(vA,{variant:"caption",sx:{color:"#dadce0",fontSize:e.fontSizes.helper},children:""}),s.jsx(ap,{label:`${t.roadIds.length} roads`,size:"small",sx:{height:18,fontSize:e.fontSizes.caption,fontWeight:500,backgroundColor:"transparent",color:"#5f6368",border:"1px solid #dadce0","& .MuiChip-label":{padding:"0 6px",fontSize:e.fontSizes.caption,lineHeight:1.2}}})]}),t.priority&&s.jsxs(s.Fragment,{children:[s.jsx(vA,{variant:"caption",sx:{color:"#dadce0",fontSize:e.fontSizes.helper},children:""}),s.jsx(ap,{label:o,size:"small",sx:{height:18,fontSize:e.fontSizes.caption,fontWeight:500,backgroundColor:"transparent",color:o.includes("Limited")?"#c5221f":"#1967d2",border:"1px solid "+(o.includes("Limited")?"#fce8e6":"#90caf9"),"& .MuiChip-label":{padding:"0 6px",fontSize:e.fontSizes.caption,lineHeight:1.2}}})]})]})]}),s.jsxs(rf,{sx:{display:"flex",alignItems:"center",gap:.5},children:[s.jsx(tA,{size:"small",onClick:e=>{e.stopPropagation(),X(t,e)},title:"Rename",sx:{minWidth:32,minHeight:32,padding:"6px",color:"#5f6368",borderRadius:"6px","&:hover":{backgroundColor:"#f5f5f5",color:"#1976d2"}},children:s.jsx(jX,{sx:{fontSize:18}})}),s.jsx(tA,{size:"small",onClick:e=>J(t.id,e),title:"Remove",sx:{minWidth:32,minHeight:32,padding:"6px",color:"#5f6368",borderRadius:"6px","&:hover":{backgroundColor:"#f5f5f5",color:"#5f6368"}},children:s.jsx(MX,{sx:{fontSize:18}})})]})]})})},t.id)})})}):s.jsx(rf,{className:"p-8 text-center",children:s.jsx(vA,{variant:"body2",sx:{fontSize:e.fontSizes.body,color:"#5f6368",fontFamily:'"Google Sans", sans-serif'},children:'No routes added yet. Select roads and click "Add to Panel" to add them here.'})})})]}),s.jsx(f5,{open:T,fromMode:"road_selection",toMode:"view",onConfirm:te,onCancel:ee})]})},r6=()=>{const e=ZJ();return pe.useEffect(()=>{if(e)return window.googleMap=e,()=>{delete window.googleMap}},[e]),null},o6=({mapId:e})=>{const{mapMode:t}=JN(),n=$N(e=>e.roadImport),r=$N(e=>e.drawingCompletionMenuPosition),o=$N(e=>e.hideDrawingCompletionMenu),i=$N(e=>e.polygonDrawing),s=$N(e=>e.lassoDrawing),a=pe.useRef(null),l="polygon_drawing"===t,c="lasso_selection"===t,u="road_selection"===t&&"lasso"===n.selectionMode;pe.useEffect(()=>{const e=l||c||u,d="polygon_drawing"===a.current||"lasso_selection"===a.current||"road_selection"===a.current&&"lasso"===n.selectionMode;if(e&&!d&&r){i.points.length>0||s.points.length>0||o()}a.current=t},[t,l,c,u,r,o,i.points.length,s.points.length,n.selectionMode]);const d=l||c||u;return pe.useEffect(()=>{},[t,l,c,u,d,r]),(({mapId:e,isActive:t,mode:n})=>{const r=pe.useRef(null),o=pe.useRef(null),i=pe.useRef(null),s=$N(e=>e.startPolygonDrawing),a=$N(e=>e.syncPolygonPointsFromTerraDraw),l=$N(e=>e.startLassoDrawing),c=$N(e=>e.setLassoPoints),u=$N(e=>e.finishLassoDrawing),d=$N(e=>e.clearLassoDrawing),A=$N(e=>e.polygonDrawing),h=JN(e=>e.mapMode);$N(e=>e.drawingCompletionMenuPosition);const p=ZJ(e),f=pe.useCallback(e=>{try{const t=e;if(t&&t.getDiv){const e=t.getDiv();if(e){e.style.cursor="",e.style.removeProperty("cursor"),e.style.setProperty("cursor","default","important");const t=e.querySelectorAll("canvas");t.forEach(e=>{e instanceof HTMLElement&&(e.style.cursor="",e.style.removeProperty("cursor"),e.style.setProperty("cursor","default","important"))}),e.querySelectorAll("*").forEach(e=>{if(e instanceof HTMLElement){const t=window.getComputedStyle(e).cursor;t&&"default"!==t&&"auto"!==t&&"inherit"!==t&&(e.style.cursor="",e.style.removeProperty("cursor"),e.style.setProperty("cursor","default","important")),e.style.cursor&&(e.style.cursor="",e.style.removeProperty("cursor"))}}),requestAnimationFrame(()=>{requestAnimationFrame(()=>{e.style.removeProperty("cursor"),e.style.cursor="",t.forEach(e=>{e instanceof HTMLElement&&(e.style.removeProperty("cursor"),e.style.cursor="")})})})}}}catch(t){}},[]);pe.useEffect(()=>{},[p,n,h,f]),pe.useEffect(()=>{const e="polygon_drawing"===h,n="lasso_selection"===h,u=$N.getState().roadImport,g="road_selection"===h&&"lasso"===u.selectionMode;if(p&&t){try{const t=new A5({lib:google.maps,map:p});o.current=t;const u=new d5({adapter:t,modes:[new Q4]});r.current=u,u.start(),u.setMode("polygon");const d=p;if(d&&d.getDiv){const e=d.getDiv();e&&e.classList.add("terra-draw-active")}if(e||n||g)try{const t=u.getSnapshot();t&&Array.isArray(t)&&t.filter(e=>"Polygon"===e?.geometry?.type).length>0&&(u.clear(),e?a([]):(n||g)&&c([]))}catch(m){}(e||n)&&$N.temporal.getState().clear(),e&&s(),(n||g)&&l();const h=e=>{const t=e.geometry.coordinates[0],n=t.filter((e,n)=>!(n===t.length-1&&t.length>1)||e[0]!==t[0][0]||e[1]!==t[0][1]);return n},f=t=>{i.current&&clearTimeout(i.current),i.current=setTimeout(()=>{if(!u)return;const t=u.getSnapshot();if(!t||!Array.isArray(t))return;const r=t.filter(e=>"Polygon"===e?.geometry?.type);if(null!==$N.getState().drawingCompletionMenuPosition&&r.length>1)try{const t=r[0];if(u.clear(),t&&u.addFeatures([t]),e){const e=t?.geometry?.coordinates?.[0];Array.isArray(e)&&e.length>0&&Array.isArray(e[0])&&a(e.slice(0,-1))}else if(n||g){const e=t?.geometry?.coordinates?.[0];Array.isArray(e)&&e.length>0&&Array.isArray(e[0])&&c(e.slice(0,-1))}}catch(m){if(u.clear(),e&&A.points.length>0){const e=[...A.points,A.points[0]];u.addFeatures([{type:"Feature",geometry:{type:"Polygon",coordinates:[e]},properties:{}}])}}else if(r.length>1){Mw("Please cancel or complete the existing polygon before creating a new one");try{u.clear(),e?a([]):(n||g)&&c([])}catch(m){r.slice(1).forEach(e=>{try{e?.id&&u.clear()}catch(t){}}),e?a([]):(n||g)&&c([])}}else if(n||g){const e=t.find(e=>"Polygon"===e.geometry?.type);if(e){const t=h(e);c(t)}else c([])}else if(e){const e=t.find(e=>"Polygon"===e.geometry?.type);if(e){const t=h(e);a(t)}else a([])}},50)},y=t=>{const r=u.getSnapshot();if(n||g){const e=r.find(e=>e.id===t&&"Polygon"===e.geometry.type);if(e){const t=h(e),n=JN.getState().projectData,r=n?.boundaryGeoJson;if(r&&!t.every(e=>{const[t,n]=e;return Ew(n,t,r)})){Pw("All lasso polygon points must be within the jurisdiction boundary");try{u.clear(),c([]),(0,$N.getState().clearLassoDrawing)()}catch(m){u.clear(),c([]),(0,$N.getState().clearLassoDrawing)()}return}if(c(t),t.length>0){const e=t.reduce((e,t)=>t[0]>e[0]?t:e,t[0]),[n,r]=e;(0,$N.getState().showDrawingCompletionMenu)(r,n+2e-5)}}}else if(e){const e=r.find(e=>e.id===t&&"Polygon"===e.geometry.type);if(e){const t=h(e),n=JN.getState().projectData,r=n?.boundaryGeoJson;if(r&&!t.every(e=>{const[t,n]=e;return Ew(n,t,r)})){Pw("All polygon points must be within the jurisdiction boundary");try{u.clear(),a([])}catch(m){u.clear(),a([])}return}if(a(t),(0,$N.getState().finishPolygonDrawing)(),t.length>0){const e=t.reduce((e,t)=>t[0]>e[0]?t:e,t[0]),[n,r]=e;(0,$N.getState().showDrawingCompletionMenu)(r,n+2e-5)}}}};u.on("change",f),u.on("finish",y)}catch(m){}return()=>{if(i.current&&(clearTimeout(i.current),i.current=null),r.current){try{r.current.stop(),p&&(f(p),document.body.style.cursor="",document.documentElement&&(document.documentElement.style.cursor=""))}catch(m){}r.current=null}o.current&&(o.current=null),p&&(f(p),document.body.style.cursor="",document.documentElement&&(document.documentElement.style.cursor=""))}}if(d(),r.current){try{r.current.stop();const e=p;e&&e.getDiv&&e.getDiv().classList.remove("terra-draw-active"),p&&(f(p),document.body.style.cursor="",document.documentElement&&(document.documentElement.style.cursor=""))}catch(m){}r.current=null}if(o.current&&(o.current=null),p){const e=p;e&&e.getDiv&&e.getDiv().classList.remove("terra-draw-active"),f(p)}},[p,t,n,s,a,l,c,u,d,h]),pe.useEffect(()=>{if(!r.current||!t||"polygon"!==n)return;const e=r.current.getSnapshot().find(e=>"Polygon"===e.geometry.type),o=A.points;if(e){const t=e.geometry.coordinates[0],n=Array.isArray(t)?t.slice(0,-1):[],s=n.length!==o.length||n.some((e,t)=>e[0]!==o[t]?.[0]||e[1]!==o[t]?.[1]);if(s){try{r.current?.clear()}catch(i){}if(o.length>0){const e=[...o,o[0]];try{r.current?.addFeatures([{type:"Feature",geometry:{type:"Polygon",coordinates:[e]},properties:{}}])}catch(i){}}}}else if(o.length>0){const e=[...o,o[0]];try{r.current?.addFeatures([{type:"Feature",geometry:{type:"Polygon",coordinates:[e]},properties:{}}])}catch(i){}}},[A.points,t,n]);const g=pe.useCallback(()=>{r.current?.finish?.()},[]),m=pe.useCallback(()=>{const e=$N.temporal.getState();e.pastStates.length>0&&e.undo()},[]),y=pe.useCallback(()=>{const e=$N.temporal.getState();e.futureStates.length>0&&e.redo()},[]);pe.useEffect(()=>{t&&p?$N.setState({terraDrawUndo:m,terraDrawRedo:y,terraDrawFinish:g}):$N.setState({terraDrawUndo:void 0,terraDrawRedo:void 0,terraDrawFinish:void 0})},[t,p,m,y,g]),r.current})({mapId:e,isActive:d,mode:"polygon"}),null},i6=({open:e,onClose:t,onConfirm:n,title:r="Confirm Action",message:o,confirmText:i="Confirm",cancelText:a="Cancel",confirmColor:l="error",isLoading:c=!1,maxWidth:u="sm"})=>{const d=pe.useRef(null),A=pe.useRef(null),h=pe.useRef("confirm"),p=fe.useCallback(e=>{e.preventDefault(),e.stopPropagation(),n()},[n]),f=fe.useCallback(e=>{e.preventDefault(),e.stopPropagation(),t()},[t]);return pe.useEffect(()=>{if(e){h.current="confirm";const e=setTimeout(()=>{A.current&&!c&&A.current.focus()},100);return()=>clearTimeout(e)}},[e,c]),pe.useEffect(()=>{if(!e)return;const t=e=>"Enter"===e.key?(e.preventDefault(),e.stopPropagation(),void("confirm"===h.current&&A.current&&!c?A.current.click():"cancel"===h.current&&d.current&&d.current.click())):"ArrowLeft"===e.key||"ArrowRight"===e.key?(e.preventDefault(),e.stopPropagation(),void("confirm"===h.current?(h.current="cancel",d.current&&d.current.focus()):(h.current="confirm",A.current&&!c&&A.current.focus()))):void 0;return window.addEventListener("keydown",t),()=>{window.removeEventListener("keydown",t)}},[e,c]),s.jsx(jv,{open:e,onClose:t,maxWidth:u,fullWidth:!0,title:r,sx:{zIndex:2e4,"& .MuiBackdrop-root":{zIndex:19999}},PaperProps:{sx:{zIndex:2e4}},actions:s.jsxs(s.Fragment,{children:[s.jsx(Nv,{ref:d,onClick:f,onMouseDown:e=>{e.stopPropagation()},onFocus:()=>{h.current="cancel"},style:{textTransform:"none"},children:a}),s.jsx(Nv,{ref:A,onClick:p,onMouseDown:e=>{e.stopPropagation()},onFocus:()=>{h.current="confirm"},color:l,variant:"contained",disabled:c,style:{textTransform:"none",pointerEvents:"auto"},children:c?s.jsx(Yd,{size:20}):i})]}),children:s.jsx(vA,{variant:"body2",style:{fontSize:"14px"},children:o})})},s6=({onMouseDown:e,isDragging:t=!1,style:n})=>s.jsx("div",{onMouseDown:e,style:{position:"absolute",top:"8px",right:"8px",cursor:t?"grabbing":"grab",padding:"4px",display:"flex",alignItems:"center",justifyContent:"center",color:"#999",transition:"color 0.15s",zIndex:1,...n},onMouseEnter:e=>{t||(e.currentTarget.style.color="#666")},onMouseLeave:e=>{t||(e.currentTarget.style.color="#999")},children:s.jsx(eY,{fontSize:"small"})}),a6=({initialX:e,initialY:t,onPositionChange:n})=>{const[r,o]=pe.useState({x:e,y:t}),[i,s]=pe.useState(!1),a=pe.useRef(null);pe.useEffect(()=>{o({x:e,y:t})},[e,t]);return pe.useEffect(()=>{if(!i)return;const e=e=>{if(!a.current)return;const t=e.clientX-a.current.x,r=e.clientY-a.current.y,i=window.innerWidth,s=window.innerHeight,l=document.querySelector("[data-draggable-menu]");if(l){const e=l.offsetWidth,a=l.offsetHeight,c=Math.max(0,Math.min(t,i-e)),u=Math.max(0,Math.min(r,s-a));o({x:c,y:u}),n?.(c,u)}else o({x:t,y:r}),n?.(t,r)},t=()=>{s(!1),a.current=null};return document.addEventListener("mousemove",e),document.addEventListener("mouseup",t),()=>{document.removeEventListener("mousemove",e),document.removeEventListener("mouseup",t)}},[i,n]),{position:r,isDragging:i,handleMouseDown:e=>{e.preventDefault(),e.stopPropagation();const t=e.currentTarget.closest("[data-draggable-menu]");if(!t)return;const n=t.getBoundingClientRect(),r=e.clientX-n.left,o=e.clientY-n.top;a.current={x:r,y:o},s(!0)}}},l6=({x:e,y:t,onClose:n,header:r,items:o=[],draggable:i=!1,width:a=200,maxHeight:l=400,minWidth:c,maxWidth:u,children:d,hideItems:A=!1,className:h})=>{const p=pe.useRef(null),f=a6({initialX:e,initialY:t}),g=i?f.position:{x:e,y:t},m=!!i&&f.isDragging,y=i?f.handleMouseDown:void 0;return pe.useEffect(()=>{const e=e=>{m||p.current&&!p.current.contains(e.target)&&n()},t=e=>{"Escape"===e.key&&n()};return document.addEventListener("mousedown",e),document.addEventListener("keydown",t),()=>{document.removeEventListener("mousedown",e),document.removeEventListener("keydown",t)}},[n,m]),s.jsxs("div",{ref:p,"data-draggable-menu":!0,className:`fixed bg-white shadow-lg z-[10000] overflow-hidden ${h}`,style:{left:`${g.x}px`,top:`${g.y}px`,width:"number"==typeof a?`${a}px`:a,minWidth:"number"==typeof c?`${c}px`:c,maxWidth:"number"==typeof u?`${u}px`:u,borderRadius:"24px",boxShadow:"0 4px 12px rgba(0,0,0,0.15)"},children:[r&&s.jsxs("div",{className:"relative px-4 py-3 border-b border-gray-200 bg-gray-50",children:[i&&y&&s.jsx(s6,{onMouseDown:y,isDragging:m}),s.jsxs("div",{className:"flex items-center gap-2",style:{paddingRight:i?"32px":"0"},children:[r.icon&&s.jsx("div",{className:"flex items-center justify-center text-gray-600",children:r.icon}),s.jsxs("div",{className:"flex-1 min-w-0",children:[s.jsx("div",{className:"text-sm font-semibold text-gray-900 whitespace-nowrap overflow-hidden text-ellipsis",title:r.fullTitle||r.title,children:r.title}),r.subtitle&&s.jsx("div",{className:"text-xs text-gray-600 mt-0.5",children:r.subtitle})]})]}),r.metadata&&s.jsx("div",{className:"mt-1.5",children:r.metadata})]}),!A&&o&&o.length>0&&s.jsx("div",{className:"py-0",style:{maxHeight:"number"==typeof l?`${l}px`:l,overflowY:"auto"},children:o.map((e,t)=>s.jsxs(fe.Fragment,{children:[s.jsxs("button",{onClick:()=>{e.disabled||e.onClick()},disabled:e.disabled,className:"w-full px-4 py-2 border-none flex items-center gap-3 text-left transition-colors text-gray-900 "+(e.disabled?"opacity-50 cursor-not-allowed":"cursor-pointer hover:bg-gray-100"),children:[e.icon&&s.jsx("span",{className:"flex items-center justify-center text-gray-600",children:e.icon}),s.jsx("span",{className:"text-[12px]",children:e.label})]}),t<o.length-1&&s.jsx("div",{className:"h-px bg-gray-200"})]},e.id))}),d&&s.jsx("div",{style:{maxHeight:"number"==typeof l?`${l}px`:l,overflowY:"auto"},children:d})]})},c6=({x:e,y:t,road:n,projectId:r,onClose:o})=>{const i=q5(),a=(()=>{const e=ye();return Ee({mutationFn:async({roadId:e,projectId:t})=>{const n=await _j.delete(e);if(!n.success)throw new Error(n.message);return{success:n.data,projectId:t}},onSuccess:({projectId:t})=>{e.invalidateQueries({queryKey:eX.roadsNetwork(t)}),e.invalidateQueries({queryKey:["roads"]}),(0,$N.getState().refreshRoadsTilesTimestamp)()}})})(),l=dX(),[c,u]=fe.useState(!1),d=$N(e=>e.selectedRoadPriorities),A=$N(e=>e.startStretchMode),h=$N(e=>e.startMultiSelectMode),p=$N(e=>e.exitSelectionMode);pe.useEffect(()=>{let e=n.linestringGeoJson;!e&&n.polyline&&(e={type:"LineString",coordinates:n.polyline});const t={id:n?.id?.toString(),routeId:"",name:n.name||`Road ${n.id}`,linestringGeoJson:e,segmentOrder:0,distanceKm:n.length||0,createdAt:(new Date).toISOString()};return A([t],{isPreview:!0}),()=>{$N.getState().roadSelection.isPreview&&p()}},[n.id]);const f=n.name||`Road #${n.id}`,g=f.length>25?`${f.substring(0,22)}...`:f,m=[{id:"save-as-route",label:"Save as Route",icon:s.jsx(aY,{sx:{fontSize:16}}),onClick:()=>{let e=n.linestringGeoJson;!e&&n.polyline&&(e={type:"LineString",coordinates:n.polyline});const t={id:n?.id?.toString(),routeId:"",name:n.name||`Road ${n.id}`,linestringGeoJson:e,segmentOrder:0,distanceKm:n.length||0,createdAt:(new Date).toISOString()};A([t]),o()}},{id:"stretch",label:"Stretch to Intersection",icon:s.jsx(lY,{sx:{fontSize:16}}),onClick:async()=>{try{const e=d.length>0?d:[];if(0===e.length)return alert("Please select at least one road priority before stretching"),void o();const t=(await l.mutateAsync({roadId:n.id,projectId:r,priorityList:e})).stretched_roads.map(e=>{let t=e.linestringGeoJson;return!t&&e.polyline&&(t="string"==typeof e.polyline?JSON.parse(e.polyline):e.polyline),{...e,linestringGeoJson:t}});A(t)}catch(e){alert(`Failed to stretch road: ${e instanceof Error?e.message:"Unknown error"}`)}o()}},{id:"multi-select",label:"Multi-select Mode",icon:s.jsx(sY,{sx:{fontSize:16}}),onClick:()=>{try{let e=n.linestringGeoJson;!e&&n.polyline&&(e={type:"LineString",coordinates:n.polyline});const t={id:n?.id?.toString(),routeId:"",name:n.name||`Road ${n.id}`,linestringGeoJson:e,segmentOrder:0,distanceKm:n.length||0,createdAt:(new Date).toISOString()};h(t)}catch(e){alert(`Failed to start multi-select mode: ${e instanceof Error?e.message:"Unknown error"}`)}o()}},{id:"delete",label:"Delete Road",icon:s.jsx(MX,{sx:{fontSize:16}}),onClick:()=>{u(!0)}}],y=(e=>{if(!e)return"Road";return{ROAD_PRIORITY_UNSPECIFIED:"Local ",ROAD_PRIORITY_NON_TRAFFIC:"Local ",ROAD_PRIORITY_TERMINAL:"Local ",ROAD_PRIORITY_LOCAL:"Local ",ROAD_PRIORITY_MINOR_ARTERIAL:"Arterial ",ROAD_PRIORITY_MAJOR_ARTERIAL:"Arterial ",ROAD_PRIORITY_SECONDARY_ROAD:"Arterial ",ROAD_PRIORITY_PRIMARY_HIGHWAY:"Highway ",ROAD_PRIORITY_LIMITED_ACCESS:"Highway ",ROAD_PRIORITY_CONTROLLED_ACCESS:"Highway "}[e]||""})(n.priority)+"Road",v=n.name||`Road #${n.id}`;return s.jsxs(s.Fragment,{children:[s.jsx(l6,{x:e,y:t,onClose:o,draggable:!0,width:200,header:{title:g,fullTitle:f,metadata:s.jsxs("div",{className:"flex items-center gap-1.5 mt-1",children:[s.jsx("span",{className:"text-xs text-gray-600",children:Y5(n.length||0,i)}),s.jsx("span",{className:"text-xs text-gray-400",children:""}),s.jsx(ap,{label:y,size:"small",sx:{height:18,fontSize:"11px",fontWeight:500,backgroundColor:"#f5f5f5",color:"#666","& .MuiChip-label":{padding:"0 6px"}}})]})},items:m}),s.jsx(i6,{open:c,onClose:()=>{u(!1),o()},onConfirm:async()=>{try{await a.mutateAsync({roadId:n?.id?.toString(),projectId:r}),u(!1),o()}catch(e){alert("Failed to delete road. Please try again."),u(!1)}},title:"Delete Road",message:`Delete "${v}"? This action cannot be undone.`,confirmText:"Delete",isLoading:a.isPending})]})},u6=({x:e,y:t,route:n,onClose:r})=>{const o=pe.useRef(null),i=q5(),{loadRouteForEditing:a,removeRoute:l,setLeftPanelExpanded:c,setCurrentFolder:u,setRouteSearchQuery:d}=JN(),A=sX(),h=iX(),p=rX(),f=$N(e=>e.loadRoutePoints),g=$N(e=>e.setRouteUUID),m=$N(e=>e.clearPoints),[y,v]=pe.useState(!1),[b,w]=pe.useState(n.name),[x,_]=pe.useState(!1);pe.useEffect(()=>{const e=e=>{"Escape"===e.key&&y&&(v(!1),w(n.name))};return document.addEventListener("keydown",e),()=>{document.removeEventListener("keydown",e)}},[y,n.name]);const C=async()=>{const e=b.trim();if(e)if(e.length>100)alert("Route name must not exceed 100 characters");else try{if(await h.mutateAsync({routeId:n.id,updates:{name:e}})){const{updateRoute:t}=JN.getState();t(n.id,{name:e})}v(!1)}catch(t){alert(`Failed to update route name: ${t instanceof Error?t.message:"Unknown error"}`)}else alert("Route name cannot be empty")},S=()=>{w(n.name),v(!1)},E=n.name||`Route #${n.id}`,B=E.length>25?`${E.substring(0,22)}...`:E,I=[{id:"modify",label:"Modify",icon:s.jsx(QX,{sx:{fontSize:16}}),onClick:async()=>{try{const{routes:t,addRoute:o}=JN.getState();let i=t.find(e=>e.id===n.id);if(!i){let t=await wj.getById(n.id);if((!t.success||!t.data)&&n.name&&n.projectId)try{const e=await wj.getByProjectPaginated(n.projectId,1,100,n.name.trim());if(e.success&&e.data?.routes){const r=e.data.routes.find(e=>e.name.toLowerCase().trim()===n.name.toLowerCase().trim());r&&(t=await wj.getById(r.id))}}catch(e){}if(!t.success||!t.data)return Pw("Route not found. It may have been deleted or the route ID is invalid."),void r();i=t.data,o(i)}if(!i.origin||!i.destination||0===i.origin.lat&&0===i.origin.lng||0===i.destination.lat&&0===i.destination.lng)return Pw("Cannot modify route: missing or invalid origin/destination coordinates."),void r();await p(i.id),c(!0);const s=i.tag||"Untagged";u(s),d(i.name),a(i,f,g,m),r()}catch(t){Pw(`Failed to load route for editing: ${t instanceof Error?t.message:"Unknown error"}`),r()}}},{id:"rename",label:"Rename",icon:s.jsx(jX,{sx:{fontSize:16}}),onClick:()=>{v(!0)}},{id:"delete",label:"Delete",icon:s.jsx(MX,{sx:{fontSize:16}}),onClick:e=>{e&&(e.stopPropagation(),e.preventDefault()),_(!0)}}];return y?s.jsx("div",{ref:o,"data-draggable-menu":!0,className:"fixed bg-white shadow-lg z-[10000] overflow-hidden",style:{left:`${e}px`,top:`${t}px`,minWidth:"200px",maxWidth:"250px",borderRadius:"24px",boxShadow:"0 4px 12px rgba(0,0,0,0.15)"},children:s.jsxs("div",{className:"relative px-4 py-3 border-b border-gray-200 bg-gray-50",children:[s.jsx("div",{className:"flex items-center gap-2",children:s.jsx("div",{className:"flex-1 min-w-0",children:s.jsx(Dv,{value:b,onChange:e=>w(e.target.value),variant:"standard",fullWidth:!0,autoFocus:!0,onKeyDown:e=>{"Enter"===e.key&&C(),"Escape"===e.key&&S()},sx:{"& .MuiOutlinedInput-root":{fontSize:"14px",fontWeight:600,padding:"4px 6px","& fieldset":{borderColor:sJ,borderRadius:"4px"},"&:hover fieldset":{borderColor:sJ},"&.Mui-focused fieldset":{borderColor:sJ,borderWidth:"1px"}},"& .MuiOutlinedInput-input":{padding:0,color:"#111827"}}})})}),s.jsxs("div",{className:"flex gap-1.5 mt-2",children:[s.jsx(Nv,{onClick:S,className:"flex-1 px-1.5 py-1 text-xs bg-gray-500 text-white border-none rounded-full cursor-pointer hover:bg-gray-600",children:"Cancel"}),s.jsx(Nv,{onClick:C,className:"flex-1 px-1.5 py-1 text-xs text-white border-none rounded-full cursor-pointer",sx:{backgroundColor:sJ,"&:hover":{backgroundColor:aJ}},children:"Save"})]})]})}):s.jsxs(s.Fragment,{children:[s.jsx(l6,{x:e,y:t,onClose:r,draggable:!0,minWidth:200,maxWidth:250,header:{title:B,fullTitle:E,metadata:s.jsxs("div",{className:"flex items-center gap-1.5 mt-1",children:[s.jsx("span",{className:"text-xs text-gray-600",children:n.distance?Y5(n.distance,i):"N/A"}),s.jsx("span",{className:"text-xs text-gray-400",children:""}),s.jsx(ap,{label:"Route",size:"small",sx:{height:18,fontSize:"11px",fontWeight:500,backgroundColor:"#f5f5f5",color:"#1976d2","& .MuiChip-label":{padding:"0 6px"}}})]})},items:I}),s.jsx(i6,{open:x,onClose:()=>{_(!1)},onConfirm:()=>{A.mutate(n.id,{onSuccess:()=>{l(n.id),_(!1),r()},onError:e=>{alert(`Failed to delete route: ${e.message}`),_(!1),r()}})},title:"Delete Route",message:`Delete route "${n.name}"?`,confirmText:"Delete",isLoading:A.isPending})]})},d6=async(e,t="Text")=>{try{return await navigator.clipboard.writeText(e),!0}catch(n){try{const t=document.createElement("textarea");t.value=e,t.style.position="fixed",t.style.left="-999999px",t.style.top="-999999px",document.body.appendChild(t),t.focus(),t.select();const n=document.execCommand("copy");return document.body.removeChild(t),!!n}catch(r){return!1}}},A6=e=>{try{const t=new Date(e),n=new Date,r=n.getTime()-t.getTime(),o=Math.floor(r/1e3),i=Math.floor(o/60),s=Math.floor(i/60),a=Math.floor(s/24);return o<60?"Just now":i<60?`${i} min${i>1?"s":""} ago`:s<24?`${s} hour${s>1?"s":""} ago`:a<7?`${a} day${a>1?"s":""} ago`:t.toLocaleDateString("en-US",{month:"short",day:"numeric",year:t.getFullYear()!==n.getFullYear()?"numeric":void 0})}catch(t){return e}},h6=({icon:e,label:t,onClick:n,danger:r=!1})=>{const[o,i]=fe.useState(!1);return s.jsxs("button",{onClick:n,onMouseEnter:()=>i(!0),onMouseLeave:()=>i(!1),style:{width:"100%",padding:"8px 12px",border:"none",background:o?r?"#fee":"#f5f5f5":"transparent",cursor:"pointer",display:"flex",alignItems:"center",gap:e?"10px":"0",fontSize:"13px",color:r?"#d32f2f":"#333",transition:"background 0.15s",textAlign:"left"},children:[e&&s.jsx("span",{style:{display:"flex",alignItems:"center"},children:e}),s.jsx("span",{children:t})]})},p6=({x:e,y:t,polygon:n,onClose:r})=>{const o=pe.useRef(null),i=(()=>{const e=ye();return Ee({mutationFn:async e=>{const t=await Cj.delete(e);if(!t.success)throw new Error(t.message);return t.data},onSuccess:()=>{e.invalidateQueries({queryKey:["polygons"]})}})})(),[a,l]=pe.useState(!1),{position:c,isDragging:u,handleMouseDown:d}=a6({initialX:e,initialY:t});pe.useEffect(()=>{const e=e=>{u||o.current&&!o.current.contains(e.target)&&r()},t=e=>{"Escape"===e.key&&r()};return document.addEventListener("mousedown",e),document.addEventListener("keydown",t),()=>{document.removeEventListener("mousedown",e),document.removeEventListener("keydown",t)}},[r,u]);return s.jsxs("div",{ref:o,"data-draggable-menu":!0,style:{position:"fixed",left:`${c.x}px`,top:`${c.y}px`,backgroundColor:"white",borderRadius:"8px",boxShadow:"0 4px 12px rgba(0,0,0,0.15)",zIndex:1e4,minWidth:"180px",overflow:"hidden"},children:[s.jsxs("div",{style:{padding:"8px 12px",borderBottom:"1px solid #e0e0e0",backgroundColor:"#fafafa",position:"relative"},children:[s.jsx(s6,{onMouseDown:d,isDragging:u}),s.jsxs("div",{style:{fontSize:"13px",fontWeight:600,color:"#333"},children:["Polygon #",n.id]}),s.jsxs("div",{style:{fontSize:"11px",color:"#666",marginTop:"2px"},children:["Created:"," ",n.created_at?A6(n.created_at):"Unknown"]})]}),s.jsxs("div",{style:{padding:"2px 0"},children:[s.jsx(h6,{label:"Copy Polygon ID",onClick:async()=>{await d6(String(n.id),"Polygon ID");r()}}),s.jsx("div",{style:{height:"1px",backgroundColor:"#e0e0e0",margin:"3px 0"}}),s.jsx(h6,{label:"Delete Polygon",onClick:()=>{l(!0)},danger:!0}),s.jsx(h6,{label:"Delete Polygon with Roads",onClick:()=>{r()},danger:!0})]}),s.jsx(i6,{open:a,onClose:()=>{l(!1),r()},onConfirm:()=>{i.mutate(n.id,{onSuccess:()=>{l(!1),r()},onError:e=>{alert(`Failed to delete polygon: ${e.message}`),l(!1),r()}})},title:"Delete Polygon",message:`Delete polygon #${n.id}? This will soft delete the polygon and its associated routes and roads.`,confirmText:"Delete",isLoading:i.isPending})]})},f6=({x:e,y:t,segment:n,onClose:r})=>{const o=[{id:"view-details",label:"View Details",icon:s.jsx(YX,{sx:{fontSize:16}}),onClick:()=>{const e=n.distance?`${n.distance.toFixed(2)} km`:"N/A",t=n.segmentOrder||"Unknown";alert(`Segment Details:\nSegment Order: ${t}\nID: ${n.id}\nDistance: ${e}`),r()}},{id:"copy-id",label:"Copy Segment ID",icon:s.jsx(TX,{sx:{fontSize:16}}),onClick:async()=>{await d6(String(n.id),"Segment ID");r()}},{id:"zoom-to",label:"Zoom to Segment",icon:s.jsx(bY,{sx:{fontSize:16}}),onClick:()=>{r()}}];return s.jsx(l6,{x:e,y:t,onClose:r,draggable:!0,width:200,header:{title:`${(()=>{const e=["","","","","","","","","",""];return e[(n.segmentOrder||0)%e.length]})()} Segment ${n.segmentOrder||"?"}`,subtitle:n.distance?`Distance: ${n.distance.toFixed(2)} km`:"Segmentation preview"},items:o})},g6=({x:e,y:t,features:n,onSelectFeature:r,onClose:o,mapMode:i,panelRoutes:a,onToggleRoad:l,onStretchRoad:c,onInitializeRouteInMaking:u})=>{const d=$N(e=>e.setHoveredFeature),A=$N(e=>e.setHoveredRoadId),h=pe.useRef(null),p=pe.useRef(!0);pe.useEffect(()=>(p.current=!0,()=>{p.current=!1,h.current&&(d(null),A(null),h.current=null)}),[d,A]);const f=pe.useMemo(()=>{if(n.length<2)return!1;const e=n.map(e=>e.object?.road_id?.toString()||e.object?.properties?.road_id?.toString()).filter(Boolean);return new Set(e).size<e.length},[n]),g=f?"Select Direction":"road_selection"===i?`Select Road${n.length>1?"s":""} (${n.length})`:`Select Feature (${n.length})`,m=f?"Bi-directional road detected. Select which lanes to track.":"road_selection"===i?"Multiple roads at this location":"Multiple features at this location";return s.jsx(l6,{x:e,y:t,onClose:o,draggable:!0,maxWidth:280,minWidth:270,maxHeight:450,header:{title:g,subtitle:m},hideItems:!0,children:s.jsx(rf,{sx:{pb:"0px"},children:n.map((e,t)=>s.jsx(fe.Fragment,{children:s.jsx(m6,{feature:e,onClick:"road_selection"===i?()=>{}:()=>r(e),index:t,mapMode:i,panelRoutes:a,onToggleRoad:l,onStretchRoad:c,onInitializeRouteInMaking:u,onClose:o})},`${e.layerId}-${t}`))})})},m6=({feature:e,onClick:t,index:n,mapMode:r,panelRoutes:o,onToggleRoad:i,onStretchRoad:a,onInitializeRouteInMaking:l,onClose:c})=>{const u=q5(),d=$N(e=>e.setHoveredFeature),A=$N(e=>e.setHoveredRoadId),h=$N(e=>e.roadImport),p=$N(e=>e.addRoadToRouteInMaking),f=(g=e.layerId,g?.startsWith("imported-roads-")?"imported-roads":g.replace(/-[vt]\d+$/,""));var g;const m="roads-network-tile"===f||"roads-network"===f||"imported-roads"===f,y=e.object?.road_id?.toString()||e.object?.properties?.road_id?.toString()||e.object?.id?.toString()||e.object?.properties?.id?.toString(),v="imported-roads"===f,b=v&&y&&o?.some(e=>1===e.roadIds.length&&e.roadIds[0]===y),w=y&&!(!0===e.object?.isStretched)&&!(!0===e.object?.isMultiSelected),x="road_selection"===r&&"multi-select"===h.selectionMode,_=null!==h.routeInMaking,C=!!(x&&_&&y&&h.importedRoads&&h.routeInMaking)&&Qw(y,h.routeInMaking,h.importedRoads).canAdd,S="road_selection"===r&&v&&y&&(i||a||x&&(l||_&&p)),E=w&&a,B=e.object?.properties?.direction??e.object?.direction??40,I=pe.useMemo(()=>null==B?0:45*Math.round(B/45),[B]),R=e.object.length?Y5(e.object.length,u):null;return s.jsx(Im,{onClick:t,onMouseEnter:()=>{e.polyline&&e.polyline.length>=2&&(m?A(y):d({layerId:e.layerId,polyline:e.polyline,geometry:e.object?.geometry||null}))},onMouseLeave:()=>{d(null),A(null)},disabled:x&&_&&!C,sx:{minHeight:36,height:36,padding:"20px 12px",margin:"0px 0px",backgroundColor:"#ffffff",borderTop:0===n?"1px solid #e0e0e0":"none",boxShadow:"0 1px 2px rgba(0, 0, 0, 0.05)","&:hover":{backgroundColor:"#f5f5f5",boxShadow:"0 2px 4px rgba(0, 0, 0, 0.1)"},"&.Mui-disabled":{opacity:.5,backgroundColor:"#ffffff"}},children:s.jsxs(rf,{sx:{display:"flex",alignItems:"center",gap:1,width:"100%",minWidth:0},children:[null!=B&&s.jsx(rf,{sx:{display:"flex",alignItems:"center",justifyContent:"center",width:20,height:20,flexShrink:0},children:s.jsx(vX,{sx:{fontSize:16,color:"#1976d2",transform:`rotate(${I}deg)`,transition:"transform 0.2s ease"}})}),s.jsx(vA,{variant:"caption",sx:{fontSize:"12px",fontWeight:500,lineHeight:1.2,color:"#212121",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",flex:1,minWidth:0},title:e.displayInfo.title,children:e.displayInfo.title}),s.jsxs(rf,{sx:{display:"flex",alignItems:"center",gap:.75,flexShrink:0},children:[R&&s.jsx(ap,{label:R,size:"small",sx:{height:"20px",backgroundColor:"#f5f5f5",color:"#757575",fontSize:"10px",fontWeight:400,"& .MuiChip-label":{padding:"0 6px"}}}),S&&s.jsxs(s.Fragment,{children:["road_selection"===r&&v&&s.jsx(tA,{size:"small",title:"Stretch till intersections",onClick:e=>{e.stopPropagation(),a&&y&&E&&(a(y),c&&c())},disabled:!E,sx:{width:24,height:24,padding:0,minWidth:24,backgroundColor:"transparent",transition:"all 0.2s cubic-bezier(0.4, 0, 0.2, 1)",transform:"rotate(90deg)","&:hover":{backgroundColor:E?"rgba(25, 118, 210, 0.08)":"transparent",transform:E?"scale(1.1) rotate(90deg)":"rotate(90deg)"},"&:active":{transform:E?"scale(0.95) rotate(90deg)":"rotate(90deg)"},"&.Mui-disabled":{opacity:.4},disabled:!E},children:s.jsx($X,{sx:{fontSize:16,color:"#1976d2"}})}),s.jsx(tA,{size:"small",title:b?"Remove from selection":"Add to selection",onClick:e=>{if(e.stopPropagation(),x&&y){if(!_&&l)l(y),c&&c();else if(_&&C&&p){const e=Qw(y,h.routeInMaking,h.importedRoads);e.canAdd&&e.position&&(p(y,e.position),c&&c())}}else i&&y&&(i(y),c&&c())},disabled:x&&_&&!C,sx:{width:24,height:24,padding:0,minWidth:24,backgroundColor:"transparent",transition:"all 0.2s cubic-bezier(0.4, 0, 0.2, 1)","&:hover":{backgroundColor:x&&_&&!C?"transparent":b?"rgba(95, 99, 104, 0.08)":"rgba(25, 118, 210, 0.08)",transform:x&&_&&!C?"scale(1)":"scale(1.1)"},"&:active":{transform:"scale(0.95)"},"&.Mui-disabled":{opacity:.4}},children:!x&&b?s.jsx(iY,{sx:{fontSize:18,color:"#5f6368"}}):s.jsx(fX,{sx:{fontSize:18,color:x&&_&&!C?"rgba(0, 0, 0, 0.3)":"#1976d2"}})})]})]})]})})},y6=({x:e,y:t,onContinue:n,onCancel:r,onRetry:o,onClose:i,isIngesting:a=!1})=>{const{position:l}=a6({initialX:e,initialY:t});return s.jsx("div",{"data-draggable-menu":!0,className:"fixed bg-white rounded-full z-[10000]",style:{left:`${l.x}px`,top:`${l.y}px`,minWidth:"240px",boxShadow:"0 4px 12px 0 rgba(0,0,0,0.15), 0 2px 6px 0 rgba(0,0,0,0.1)"},children:s.jsxs("div",{className:"flex items-center justify-between px-4 py-3",children:[s.jsx("div",{className:"flex items-center gap-0.5",children:s.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Complete Polygon?"})}),s.jsxs("div",{className:"flex flex-1 items-center gap-0.5 ml-2",children:[s.jsx(tA,{onClick:()=>{r(),i()},size:"small",title:"Cancel and exit",sx:{color:"#6b7280","&:hover":{backgroundColor:"#f3f4f6",color:"#374151"}},children:s.jsx(IX,{sx:{fontSize:18}})}),s.jsx(tA,{onClick:()=>{o()},size:"small",title:"Draw again",sx:{color:"#6b7280","&:hover":{backgroundColor:"#f3f4f6",color:"#374151"}},children:s.jsx(oY,{sx:{fontSize:18}})}),s.jsx(tA,{onClick:()=>{n()},size:"small",title:"Confirm and continue",disabled:a,sx:{color:"#6b7280","&:hover":{backgroundColor:"#f3f4f6",color:"#374151"},"&:disabled":{color:"#9ca3af"}},children:a?s.jsx(Yd,{size:14,sx:{color:"#6b7280"}}):s.jsx(xX,{sx:{fontSize:18}})})]})]})})},v6=e=>e?.startsWith("imported-roads-")?"imported-roads":e.replace(/-[vt]\d+$/,""),b6=(e,t)=>{switch(v6(e)){case"roads-network-tile":case"roads-network":case"imported-roads":return{icon:"",title:t.name||`Road #${t.road_id||t.id||"Unknown"}`,subtitle:t.distance_km?`Length: ${t.distance_km.toFixed(2)} km`:t.priority?`Priority: ${t.priority}`:"Road segment"};case"saved-routes-tile":case"saved-routes":return{icon:"",title:t.name||`Route #${t.id}`,subtitle:t.distance?`Distance: ${(t.distance/1e3).toFixed(2)} km`:"Saved route"};case"saved-polygons":return{icon:"",title:`Polygon #${t.id||"Unknown"}`,subtitle:t.created_at?`Created: ${A6(t.created_at)}`:"Saved polygon"};case"preview-segments":return{icon:"",title:`Segment ${t.segmentOrder||""}`,subtitle:t.distance?`Distance: ${t.distance.toFixed(2)} km`:"Segmentation preview"};default:return{icon:"",title:"Feature",subtitle:`ID: ${t.id||"Unknown"}`}}},w6=({children:e,isExpanded:t,onToggle:n,width:r=360,className:o,style:i})=>s.jsxs(rf,{className:`fixed left-0 top-16 h-[calc(100vh-4rem)] bg-white flex transition-all duration-300 ${o||""}`,style:{width:`${r}px`,fontFamily:"'Google Sans', 'Roboto', sans-serif",transform:t?"translateX(0)":"translateX(calc(-100%))",...i},children:[s.jsx(rf,{className:"h-full flex flex-col border-r border-gray-200 bg-white",sx:{width:`${r}px`,boxShadow:"0 4px 16px rgba(0, 0, 0, 0.15), 0 2px 8px rgba(0, 0, 0, 0.1)",position:"relative",zIndex:1e3},children:e}),s.jsx(rf,{className:"absolute top-1/2 -translate-y-1/2 right-0 translate-x-1/2 bg-white border border-l-0 border-b-0 border-t-0 border-gray-300 rounded-r-lg flex items-center justify-center cursor-pointer transition-all duration-200 z-[999] pl-4",onClick:n,sx:{width:40,height:64,boxShadow:t?"0 2px 8px rgba(0, 0, 0, 0.12), 0 1px 4px rgba(0, 0, 0, 0.08)":"0 4px 16px rgba(0, 0, 0, 0.2), 0 2px 8px rgba(0, 0, 0, 0.15), 0 0 0 2px rgba(66, 133, 244, 0.1)",backgroundColor:t?"#ffffff":"#f8f9fa","&:hover":{backgroundColor:t?"#f8f9fa":"#ffffff",boxShadow:t?"0 4px 12px rgba(0, 0, 0, 0.15), 0 2px 6px rgba(0, 0, 0, 0.1)":"0 6px 20px rgba(0, 0, 0, 0.25), 0 3px 10px rgba(0, 0, 0, 0.2), 0 0 0 3px rgba(66, 133, 244, 0.15)"}},children:t?s.jsx(EX,{className:"text-gray-600",sx:{fontSize:20,transition:"transform 0.2s ease"}}):s.jsx(BX,{className:"text-gray-700",sx:{fontSize:22,fontWeight:600,transition:"transform 0.2s ease"}})})]}),x6=()=>{const e=$N(e=>e.selectedRoadPriorities),t=$N(e=>e.setSelectedRoadPriorities),n=$N(e=>e.toggleRoadPriorityFilter),r=JN(e=>e.mapMode),o=JN(e=>e.priorityFilterPanelExpanded),i=JN(e=>e.setPriorityFilterPanelExpanded);if("road_selection"!==r)return null;const a=e.length===HD.length;return s.jsxs(w6,{isExpanded:o,onToggle:()=>i(!o),width:360,children:[s.jsx(rf,{className:"px-4 pt-3 pb-3 border-b border-gray-200 bg-white",sx:{flexShrink:0},children:s.jsxs(rf,{className:"flex items-center justify-between",children:[s.jsx(vA,{variant:"h6",className:"text-gray-900 font-medium",style:{fontSize:"15px",fontWeight:500},children:"Roads Priority"}),s.jsx(rf,{className:"flex items-center gap-1",children:s.jsx(Nv,{size:"small",variant:"outlined",onClick:a?()=>t(["NO-PRIORITIES-SELECTED"]):()=>t(HD.map(e=>e.value)),sx:{fontSize:"12px",textTransform:"none",fontFamily:'"Google Sans", Roboto',fontWeight:500,color:"#5f6368",borderColor:"#d1d5db",padding:"6px 12px",minWidth:"auto","&:hover":{borderColor:"#1976d2",backgroundColor:"#e3f2fd"}},children:a?"Deselect All":"Select All"})})]})}),s.jsx(rf,{className:"flex-1 overflow-auto px-4 py-3 bg-white",sx:{flexShrink:0,minHeight:0},children:0===GD.length?s.jsx(rf,{className:"text-center py-4 text-mui-disabled",children:s.jsx(vA,{variant:"caption",sx:{fontSize:"0.75rem"},children:"No categories available"})}):s.jsx(rf,{className:"space-y-2",children:GD.map(r=>{const o=HD.filter(e=>e.category===r.id),i=o.every(t=>e.includes(t.value)),a=o.some(t=>e.includes(t.value))&&!i;return s.jsxs("div",{className:"rounded-lg border border-gray-100 bg-white shadow-sm",children:[s.jsxs("div",{className:"w-full px-3 py-2 flex items-start gap-1.5",children:[s.jsx(jf,{checked:i,indeterminate:a,onClick:n=>{n.stopPropagation(),(n=>{const r=HD.filter(e=>e.category===n).map(e=>e.value),o=r.every(t=>e.includes(t));t(o?e.filter(e=>!r.includes(e)):Array.from(new Set([...e,...r])))})(r.id)},size:"small",sx:{padding:.25,marginTop:"2px","& .MuiSvgIcon-root":{fontSize:16}}}),s.jsxs(rf,{sx:{display:"flex",flexDirection:"column",gap:.25,flex:1,minWidth:0},children:[s.jsx(vA,{variant:"body2",sx:{fontWeight:500,fontSize:"13px",color:"#202124",lineHeight:1.4},children:r.label}),s.jsx(vA,{variant:"caption",sx:{fontSize:"0.75rem",color:"#5f6368",lineHeight:1.4},children:r.description})]})]}),s.jsx(Tg,{className:"mx-3"}),s.jsx("div",{className:"px-3 py-2 space-y-1",children:o.map(t=>{const r=e.includes(t.value);return s.jsx(Ev,{title:t.description,placement:"right",arrow:!0,children:s.jsxs("div",{className:"flex items-center gap-2 rounded px-2 py-1.5 transition",children:[s.jsx(jf,{checked:r,onChange:()=>(e=>{n(e)})(t.value),onClick:e=>e.stopPropagation(),size:"small",sx:{padding:.25,"& .MuiSvgIcon-root":{fontSize:16}}}),s.jsx(vA,{variant:"body2",sx:{fontWeight:500,fontSize:"0.8125rem",color:r?"#202124":"#3c4043",lineHeight:1.4,flex:1},children:t.label})]})},t.value)})})]},r.id)})})})]})},_6=({projectId:e})=>{const t=$N(e=>e.roadSelection),n=$N(e=>e.exitSelectionMode),r=aX(),{data:o=[]}=cX(e),[i,a]=pe.useState(""),[l,c]=pe.useState(null),[u,d]=pe.useState(""),[A,h]=pe.useState(""),[p,f]=pe.useState(""),[g,m]=pe.useState(null);pe.useEffect(()=>{const{highlightedRoads:n,validationResult:r}=t;if(0===n.length)return m(null),void a("");const o=(r?.suggested_order||n.map(e=>parseInt(e.id))).map(e=>n.find(t=>parseInt(t.id)===e)).filter(Boolean),s=o[0],l=o[o.length-1],c=s?.linestringGeoJson?.coordinates||[],u=l?.linestringGeoJson?.coordinates||[];if(0===c.length||0===u.length)return void m(null);const d=[c[0][0],c[0][1]],A=[u[u.length-1][0],u[u.length-1][1]],h=[];for(let e=0;e<o.length-1;e++){const t=o[e],n=t?.linestringGeoJson?.coordinates||[];if(n.length>0){const e=n[n.length-1];h.push([e[0],e[1]])}}const p=[];o.forEach((e,t)=>{const n=e.linestringGeoJson?.coordinates||[];0!==n.length&&(0===t?p.push(...n):p.push(...n.slice(1)))});const f=n.reduce((e,t)=>e+(t.distanceKm||0),0);let g="";if(1===o.length){const e=o[0];g=e?.name||`Road ${e?.id}`}else{const e=o[0],t=o[o.length-1];g=`${e?.name||`Road ${e?.id}`}  ${t?.name||`Road ${t?.id}`}`}const y={coordinates:p},v={uuid:bj(),route_name:g,coordinates:{origin:d,destination:A,waypoints:h},encoded_polyline:JSON.stringify(y.coordinates),region_id:parseInt(e),length:f};m(v),i&&""!==i||a(g)},[t,e]);const y=pe.useCallback(()=>{n(),a(""),c(null),d(""),h(""),f(""),m(null)},[n]),v=pe.useCallback(async()=>{if(!g)return;const e=i.trim()?"":"Route name is required";if(e)h(e);else{if(u.trim()&&!l){const e=(e=>{if(!e.trim())return"";const t=e.trim().toLowerCase(),n=o.map(e=>e.toLowerCase());return n.includes(t)?"Folder already exists":t.length>100?"Folder name must not exceed 100 characters":""})(u);if(e)return void f(e)}try{const e={...g,route_name:i.trim(),tag:l||(u.trim()?u.trim():null)};await r.mutateAsync(e),y()}catch(t){alert(`Failed to save as route: ${t instanceof Error?t.message:"Unknown error"}`)}}},[g,i,l,u,r,y]);pe.useEffect(()=>{const e=e=>{"Escape"===e.key&&y()};return window.addEventListener("keydown",e),()=>{window.removeEventListener("keydown",e)}},[y]);const b=t.highlightedRoads.reduce((e,t)=>e+(t.distanceKm||0),0),w="stretch"===t.mode?"Save as Route":"Multi-select Mode",x=(()=>{if(t.isValidating)return{text:" Validating...",color:"#999"};if("valid"===t.validationStatus&&"stretch"!==t.mode)return{text:" Continuous path",color:"#4CAF50"};if("invalid"===t.validationStatus&&t.validationResult){const e=t.validationResult.gaps||[];if(e.length>0){const t=e[0];return{text:` Gap detected: ${t.distance_meters.toFixed(1)}m between Road ${t.from_road_id} and ${t.to_road_id}`,color:"#FF9800"}}return{text:" Disconnected roads",color:"#FF9800"}}return null})();return 0===t.highlightedRoads.length?null:s.jsxs(gd,{elevation:8,className:"absolute top-36 right-4 z-[1000]",sx:{width:320,borderRadius:"24px",border:"none",boxShadow:"0px 11px 15px -7px rgba(0, 0, 0, 0.2), 0px 24px 38px 3px rgba(0, 0, 0, 0.14), 0px 9px 46px 8px rgba(0, 0, 0, 0.12)",backgroundColor:"#fff",display:"flex",flexDirection:"column",overflow:"hidden"},children:[s.jsxs(rf,{sx:{px:2,py:2,display:"flex",alignItems:"center",justifyContent:"space-between",borderBottom:"1px solid #e0e0e0"},children:[s.jsx(tA,{size:"small",onClick:y,sx:{color:"#5f6368"},children:s.jsx(IX,{fontSize:"small"})}),s.jsx(vA,{variant:"h6",component:"div",sx:{fontSize:"18px",fontFamily:'"Google Sans", sans-serif',fontWeight:400,color:"#202124"},children:w}),s.jsx(rf,{sx:{width:32}})]}),s.jsxs(rf,{sx:{display:"flex",flexDirection:"column",flex:1,overflow:"hidden"},children:[s.jsxs(rf,{sx:{px:2,py:1,borderBottom:"1px solid #f1f3f4"},children:[s.jsxs(vA,{variant:"body2",sx:{fontSize:"0.813rem",color:"#5f6368",fontFamily:'"Google Sans", sans-serif',mb:.5},children:[t.highlightedRoads.length," road",1!==t.highlightedRoads.length?"s":""," with total length of ",b.toFixed(2)," km selected."]}),s.jsx(vA,{variant:"body2",sx:{fontSize:"0.813rem",color:"#5f6368",fontFamily:'"Google Sans", sans-serif'},children:"Review the details and save as a reusable route."}),x&&s.jsx(rf,{sx:{borderRadius:"12px",px:2,py:1.5,backgroundColor:"#4CAF50"===x.color?"#E8F5E9":"#FF9800"===x.color?"#FFF3E0":"#F5F5F5"},children:s.jsx(vA,{variant:"caption",sx:{fontSize:"0.75rem",color:x.color,fontWeight:500},children:x.text})})]}),s.jsxs(rf,{sx:{flex:1,overflowY:"auto",overflowX:"hidden",px:2,py:2,display:"flex",flexDirection:"column",gap:2},children:[s.jsxs(rf,{children:[s.jsx(vA,{variant:"caption",sx:{fontSize:"0.688rem",color:"#5f6368",fontFamily:'"Google Sans", sans-serif'},children:"Route Name"}),s.jsx(Dv,{variant:"standard",fullWidth:!0,value:i,onChange:e=>{return t=e.target.value,a(t),void(A&&h(""));var t},error:!!A,helperText:A,inputProps:{maxLength:100},slotProps:{input:{sx:{fontSize:"0.813rem",fontFamily:'"Google Sans", sans-serif'}}}})]}),s.jsxs(rf,{children:[s.jsx(vA,{variant:"caption",sx:{fontSize:"0.688rem",color:"#5f6368",fontFamily:'"Google Sans", sans-serif',mb:1,display:"block"},children:"Folder (optional)"}),s.jsx(T5,{value:l||u||null,onChange:e=>{e&&o.includes(e)?(c(e),d("")):(c(null),d(e||"")),p&&f("")},tags:o,error:p,required:!1,helperText:"Select an existing folder or type to create a new one"})]})]}),s.jsxs(rf,{sx:{borderTop:"1px solid #e0e0e0",px:2,py:1.5,display:"flex",gap:1},children:[s.jsx(Nv,{variant:"outlined",fullWidth:!0,color:"inherit",onClick:y,disabled:t.isValidating,children:"Cancel"}),s.jsx(Nv,{variant:"contained",fullWidth:!0,startIcon:s.jsx(aY,{}),onClick:v,disabled:!i.trim()||r.isPending||t.isValidating,children:r.isPending?"Saving...":"Save Route"})]})]})]})},C6=85.05113;function S6(e,t,n,r){if(n){if(n.userData._googleMap===e)return n;B6(n)}const o={click:null,rightclick:null,dblclick:null,mousemove:null,mouseout:null},i=new nO({...r,useDevicePixels:!!r.interleaved||r.useDevicePixels,style:r.interleaved?null:{pointerEvents:"none"},parent:E6(t,r.style),views:new DM({repeat:!0}),initialViewState:{longitude:0,latitude:0,zoom:1},controller:!1});for(const s in o)o[s]=e.addListener(s,e=>P6(i,s,e));return i.userData._googleMap=e,i.userData._eventListeners=o,i}function E6(e,t){const n=document.createElement("div");return n.style.position="absolute",Object.assign(n.style,t),"getPanes"in e?e.getPanes()?.overlayLayer.appendChild(n):e.getMap()?.getDiv().appendChild(n),n}function B6(e){const{_eventListeners:t}=e.userData;for(const n in t)t[n]&&t[n].remove();e.finalize()}function I6(e,t){const{width:n,height:r}=R6(e),{center:o,heading:i,tilt:s,zoom:a}=t.getCameraParams(),l=r?n/r:1,c=(new GR).perspective({fovy:25*Math.PI/180,aspect:l,near:.75,far:3e14});return{width:n,height:r,viewState:{altitude:.5*c[5],bearing:i,latitude:o.lat(),longitude:o.lng(),pitch:s,projectionMatrix:c,repeat:!0,zoom:a-1}}}function R6(e){const t=e.getDiv().firstChild;return{width:t.offsetWidth,height:t.offsetHeight}}function k6(e,t,n){const r=new google.maps.Point(t,n),o=e.fromContainerPixelToLatLng(r);return[o.lng(),o.lat()]}function T6(e,t){if(e.pixel)return e.pixel;const n=t.getViewports()[0].project([e.latLng.lng(),e.latLng.lat()]);return{x:n[0],y:n[1]}}function P6(e,t,n){if(!e.isInitialized)return;const r={type:t,offsetCenter:T6(n,e),srcEvent:n};switch(t){case"click":case"rightclick":r.type="click",r.tapCount=1,e._onPointerDown(r),e._onEvent(r);break;case"dblclick":r.type="click",r.tapCount=2,e._onEvent(r);break;case"mousemove":r.type="pointermove",e._onPointerMove(r);break;case"mouseout":r.type="pointerleave",e._onPointerMove(r);break;default:return}}const F6=()=>!1,M6={depthMask:!0,depthTest:!0,blend:!0,blendFunc:[770,771,1,771],blendEquation:32774};function L6(){}const U6={interleaved:!0};class O6{constructor(e){this.props={},this._map=null,this._deck=null,this._overlay=null,this.setProps({...U6,...e})}setMap(e){if(e===this._map)return;const{VECTOR:t,UNINITIALIZED:n}=google.maps.RenderingType;if(this._map&&(!e&&this._map.getRenderingType()===t&&this.props.interleaved&&this._overlay.requestRedraw(),this._overlay?.setMap(null),this._map=null),e){this._map=e;e.getRenderingType()!==n?this._createOverlay(e):e.addListener("renderingtype_changed",()=>{this._createOverlay(e)})}}setProps(e){if(Object.assign(this.props,e),this._deck){const t=this._deck.getCanvas();if(e.style&&t?.parentElement){const n=t.parentElement.style;Object.assign(n,e.style),e.style=null}this._deck.setProps(e)}}pickObject(e){return this._deck&&this._deck.pickObject(e)}pickMultipleObjects(e){return this._deck&&this._deck.pickMultipleObjects(e)}pickObjects(e){return this._deck&&this._deck.pickObjects(e)}finalize(){this.setMap(null),this._deck&&(B6(this._deck),this._deck=null)}_createOverlay(e){const{interleaved:t}=this.props,{VECTOR:n,UNINITIALIZED:r}=google.maps.RenderingType,o=e.getRenderingType();if(o===r)return;const i=new(o===n&&google.maps.WebGLOverlayView?google.maps.WebGLOverlayView:google.maps.OverlayView);i instanceof google.maps.WebGLOverlayView?(t?(i.onAdd=L6,i.onContextRestored=this._onContextRestored.bind(this),i.onDraw=this._onDrawVectorInterleaved.bind(this)):(i.onAdd=this._onAdd.bind(this),i.onContextRestored=L6,i.onDraw=this._onDrawVectorOverlay.bind(this)),i.onContextLost=this._onContextLost.bind(this)):(i.onAdd=this._onAdd.bind(this),i.draw=this._onDrawRaster.bind(this)),i.onRemove=this._onRemove.bind(this),this._overlay=i,this._overlay.setMap(e)}_onAdd(){this._deck=S6(this._map,this._overlay,this._deck,this.props)}_onContextRestored({gl:e}){if(!this._map||!this._overlay)return;const t=S6(this._map,this._overlay,this._deck,{gl:e,_customRender:()=>{this._overlay&&this._overlay.requestRedraw()},...this.props});this._deck=t;const n=t.animationLoop;n._renderFrame=()=>{const r=e.getParameter(34964);t.device.withParametersWebGL({},()=>{n.props.onRender(n.animationProps)}),e.bindBuffer(34962,r)}}_onContextLost(){this._deck&&(B6(this._deck),this._deck=null)}_onRemove(){this._deck?.setProps({layerFilter:F6})}_onDrawRaster(){if(!this._deck||!this._map)return;const e=this._deck,{width:t,height:n,left:r,top:o,...i}=function(e,t){const{width:n,height:r}=R6(e),o=t.getProjection(),i=e.getBounds();if(!i)return{width:n,height:r,left:0,top:0};const s=i.getNorthEast(),a=i.getSouthWest(),l=o.fromLatLngToDivPixel(s),c=o.fromLatLngToDivPixel(a),u=k6(o,n/2,r/2),d=new google.maps.LatLng(0,u[0]),A=o.fromLatLngToContainerPixel(d),h=o.fromLatLngToDivPixel(d);if(!(l&&c&&h&&A))return{width:n,height:r,left:0,top:0};const p=Math.round(h.x-A.x);let f=h.y-A.y;const g=k6(o,n/2,0),m=k6(o,n/2,r);let y=u[1];const v=u[0];if(Math.abs(y)>C6){y=y>0?C6:-85.05113;const e=new google.maps.LatLng(y,v);f+=o.fromLatLngToContainerPixel(e).y-r/2}f=Math.round(f);let b=180*new rR(g).sub(m).verticalAngle()/Math.PI;b<0&&(b+=360);const w=e.getHeading()||0;let x,_=e.getZoom()-1;if(0===b)x=r?(c.y-l.y)/r:1;else if(b===w){const e=new rR([l.x,l.y]).sub([c.x,c.y]).len(),t=new rR([n,-r]).len();x=t?e/t:1}return _+=Math.log2(x||1),{width:n,height:r,left:p,top:f,zoom:_,bearing:b,pitch:e.getTilt(),latitude:y,longitude:v}}(this._map,this._overlay),s=e.getCanvas(),a=s?.parentElement||e.props.parent;if(a){const e=a.style;e.left=`${r}px`,e.top=`${o}px`}e.setProps({width:t,height:n,viewState:{altitude:1e4,...i}}),e.redraw()}_onDrawVectorInterleaved({gl:e,transformer:t}){if(!this._deck||!this._map)return;const n=this._deck;if(n.setProps({...I6(this._map,t),width:null,height:null}),n.isInitialized){const t=n.device;if(t instanceof $U){const e=t.getParametersWebGL(36006);n.setProps({_framebuffer:e})}n.needsRedraw({clearRedrawFlags:!0}),t instanceof $U&&(t.setParametersWebGL({viewport:[0,0,e.canvas.width,e.canvas.height],scissor:[0,0,e.canvas.width,e.canvas.height],stencilFunc:[519,0,255,519,0,255]}),t.withParametersWebGL(M6,()=>{n._drawLayers("google-vector",{clearCanvas:!1})}))}}_onDrawVectorOverlay({transformer:e}){if(!this._deck||!this._map)return;const t=this._deck;t.setProps({...I6(this._map,e)}),t.redraw()}}function D6({properties:e}){const t=e.displayName||"Unknown Road",n=e.length||0,r=e.priority||"ROAD_PRIORITY_UNSPECIFIED",o=q5(),i=VD[r]||r.replace("ROAD_PRIORITY_","");return s.jsxs("div",{className:"min-w-[200px] max-w-[260px] bg-white rounded-xl shadow-lg border border-gray-200/60 overflow-hidden",children:[s.jsx("div",{className:"px-3.5 py-2.5 bg-gray-50/50 border-b border-gray-200/60",children:s.jsx(Ev,{title:t,arrow:!0,children:s.jsx("div",{className:"text-sm font-semibold text-gray-900 truncate",children:t})})}),s.jsxs("div",{className:"px-3.5 py-2.5 space-y-2.5",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx("span",{className:"text-xs text-gray-500",children:"Length"}),s.jsx("span",{className:"text-sm font-semibold text-gray-900",children:Y5(n,o)})]}),s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx("span",{className:"text-xs text-gray-500",children:"Priority"}),s.jsx("span",{className:"text-xs font-medium px-2 py-0.5 rounded bg-gray-100 text-gray-700",children:i})]})]})]})}function N6({status:e}){const t=s0(JN(e=>e.mapType)),n=([e,t,n],r=.15)=>`rgba(${e}, ${t}, ${n}, ${r})`,r=([e,t,n])=>`rgb(${e}, ${t}, ${n})`;if(!e)return null;const o=(e=>{if(!e)return"Unsynced";switch(e.toLowerCase()){case"synced":return"Running";case"validating":return"Validating";case"invalid":return"Invalid";default:return"Unsynced"}})(e),i=(e=>{if(!e){const e=t.routeStatusColors.unsynced;return{backgroundColor:n(e,.15),color:r(e)}}switch(e.toLowerCase()){case"synced":case"running":return{backgroundColor:n(t.routeStatusColors.synced,.15),color:r(t.routeStatusColors.synced)};case"validating":return{backgroundColor:n(t.routeStatusColors.validating,.15),color:r(t.routeStatusColors.validating)};case"invalid":return{backgroundColor:n(t.routeStatusColors.invalid,.15),color:r(t.routeStatusColors.invalid)};default:return{backgroundColor:n(t.routeStatusColors.unsynced,.15),color:r(t.routeStatusColors.unsynced)}}})(e);return s.jsx("div",{className:"text-xs font-medium px-2 py-0.5 rounded-full whitespace-nowrap flex-shrink-0",style:{backgroundColor:i.backgroundColor,color:i.color},children:o})}function j6({properties:e}){const t=e.displayName||"Unknown Route",n=e.length||0,r=e.sync_status||"unsynced",o=q5();return s.jsxs("div",{className:"min-w-[240px] max-w-[300px] bg-white rounded-xl shadow-lg border border-gray-200/60 overflow-hidden",children:[s.jsx("div",{className:"px-3.5 py-2.5 bg-blue-50/50 border-b border-gray-200/60",children:s.jsx(Ev,{title:t,arrow:!0,children:s.jsx("div",{className:"text-sm font-semibold text-gray-900 truncate",children:t})})}),s.jsxs("div",{className:"px-3.5 py-2.5 space-y-2.5",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx("span",{className:"text-xs text-gray-500",children:"Length"}),s.jsx("span",{className:"text-sm font-semibold text-gray-900",children:Y5(n,o)})]}),s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx("span",{className:"text-xs text-gray-500",children:"Sync Status"}),s.jsx(N6,{status:r})]})]})]})}function Q6({properties:e}){const t=e.displayName||"Unknown Route",n=e.length||0,r=e.sync_status,o=q5();return s.jsxs("div",{className:"min-w-[260px] max-w-[320px] bg-white rounded-xl shadow-lg border border-gray-200/60 overflow-hidden",children:[s.jsx("div",{className:"px-3.5 py-2.5 bg-blue-50/50 border-b border-gray-200/60",children:s.jsx(Ev,{title:t,arrow:!0,children:s.jsx("div",{className:"text-sm font-semibold text-gray-900 truncate",children:t})})}),s.jsx("div",{className:"px-3.5 py-2.5 space-y-2.5",children:s.jsxs("div",{className:"space-y-2.5",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx("span",{className:"text-xs text-gray-500",children:"Length"}),s.jsx("span",{className:"text-sm font-semibold text-gray-900",children:Y5(n,o)})]}),s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx("span",{className:"text-xs text-gray-500",children:"Sync Status"}),s.jsx(N6,{status:r})]})]})})]})}function z6({feature:e,x:t,y:n}){const r=e.properties?.featureType;let o=null;if("road"===r)o=s.jsx(D6,{properties:e.properties});else if("route"===r){o=e.properties?.hasTrafficData||!1?s.jsx(Q6,{properties:e.properties}):s.jsx(j6,{properties:e.properties})}return o?s.jsx("div",{className:"fixed z-[99999] pointer-events-none",style:{left:t+8,top:n+8},children:o}):null}const H6=({layers:e,overlayRef:t,projectId:n})=>{const r=ZJ("main-map"),o=$N(e=>e.roadSelection);$N(e=>e.roadImport);const i=$N(e=>e.setHoveredRoadId),a=$N(e=>e.addRoadToSelection),l=$N(e=>e.setIsValidating),c=$N(e=>e.setValidationResult),u=$N(e=>e.setValidationStatus),d=$N(e=>e.setRoadSelectionError),A=$N(e=>e.setSelectedUploadedRouteId),h=$N(e=>e.setHoveredFeature),p=$N(e=>e.currentZoom),f=Lj(e=>e.show_tooltip),g=JN(e=>e.mapMode),m=AX(),[y,v]=pe.useState(null),b=pe.useRef(p),w=pe.useRef(f??!0),x=pe.useRef(g);pe.useEffect(()=>{b.current=p},[p]),pe.useEffect(()=>{w.current=f??!0},[f]),pe.useEffect(()=>{x.current=g},[g]);const _=pe.useCallback(e=>{const t=e.layer?.id;if("uploaded-routes"!==t)return;const n=e.object?.properties;n&&n.uploadedRouteId&&A(n.uploadedRouteId)},[A]),C=pe.useCallback(async e=>{if("uploaded-routes"===e.layer?.id)return void _(e);if("multi-select"!==o.mode)return;if(o.isValidating)return;const t=e.layer?.id;if(!("roads-network"===t||"imported-roads"===t||t?.startsWith("imported-roads-")||t?.startsWith("imported-roads-")||t?.startsWith("roads-network-tile")||t?.startsWith("roads-tile-")))return;const r=e.object?.properties;if(!r||!r.id)return;const i=parseInt(r.id);if(o.selectedRoadIds.includes(i))return;const s={id:r?.id?.toString(),routeId:"",name:r.name||`Road ${r.id}`,polyline:"",linestringGeoJson:e.object?.geometry,segmentOrder:0,distanceKm:r.length||0,createdAt:(new Date).toISOString()};a(s);const A=[...o.selectedRoadIds,i];l(!0),u("validating");try{const e=await m.mutateAsync({roadIds:A,projectId:n});c(e),u(e.is_continuous?"valid":"invalid")}catch(h){d(h instanceof Error?h.message:"Validation failed"),u("invalid")}finally{l(!1)}},[o.mode,o.isValidating,o.selectedRoadIds,a,m,n,l,c,u,d,_]),S=pe.useRef(C);pe.useEffect(()=>{S.current=C},[C]),pe.useEffect(()=>{if(r)return t.current||(t.current=new O6({interleaved:!0,pickingRadius:1,getTooltip:e=>{const{layer:t,object:n,sourceLayer:r}=e,o=t?.id||"",i=r?.id||"",s=n?.properties||{};o.includes("saved-routes-tile")||o.includes("-geojson")||o.includes("snapped-roads")||i.includes("saved-routes-tile")||i.includes("-geojson")||i.includes("snapped-roads")||"google_routes_api"===s.source||void 0!==s.uploadedRouteId||s.id&&s.id.includes("-optimized");if(!n)return null;const a=r||t||t;if(a?.props?.getTooltip)try{return a.props.getTooltip(e)||null}catch(l){return null}if(a&&"function"==typeof a.getTooltip)try{return a.getTooltip(e)||null}catch(l){return null}"roads-network-tile"===o||o?.startsWith("roads-network-tile")||o?.startsWith("roads-tile-");return null},onClick:e=>{e?.object&&S.current(e)},onHover:e=>{if(e?.object){const t=e.object?.properties||{};if("direction_arrow"===t.type)return void v(null);const n=e.layer?.id||"",r=e.sourceLayer?.id||"";e.sourceLayer||e.layer,t.type;const o=e.object?.geometry,s="roads-network-tile"===n||"imported-roads"===n||n?.startsWith("imported-roads-")||n?.startsWith("imported-roads-")||n?.startsWith("roads-network-tile")||n?.startsWith("roads-tile-"),a=n.includes("saved-routes-tile")||n.includes("-geojson")||n.includes("snapped-roads")||r.includes("saved-routes-tile")||r.includes("-geojson")||r.includes("snapped-roads")||"google_routes_api"===t.source||void 0!==t.uploadedRouteId||t.id&&t.id.includes("-optimized");if(("view"===x.current||"road_selection"===x.current)&&w.current&&b.current&&b.current>=14)if(s||a){const n={...t,featureType:s?"road":"route",displayName:t.name||t.displayName||t.display_name||"Unknown",hasTrafficData:!(!t.current_duration_seconds&&!t.static_duration_seconds)};v({feature:{properties:n},x:e.x||0,y:e.y||0})}else v(null);else v(null);if("view"!==x.current&&"road_selection"!==x.current||!s&&!a)h(null),"road_selection"===x.current&&i(null);else{const e=o?.coordinates;if(e&&Array.isArray(e)&&(h({layerId:n||(s?"roads-network-tile":"saved-routes-tile"),polyline:e,geometry:o}),"road_selection"===x.current&&s&&("imported-roads"===n||n?.startsWith("imported-roads-")))){const e=t?.road_id?.toString()||t?.id?.toString();e&&i(e)}}}else v(null),h(null),"road_selection"===x.current&&i(null)}})),t.current.setMap(r),t.current.setProps({layers:e}),()=>{t.current&&t.current.setMap(null)}},[r,t]),pe.useEffect(()=>{t.current&&t.current.setProps({layers:e})},[e,t]);const E=y&&"undefined"!=typeof document?wu.createPortal(s.jsx(z6,{feature:y.feature,x:y.x,y:y.y}),document.body):null;return s.jsx(s.Fragment,{children:E})},G6=()=>$N(e=>e.individualRoute).isGenerating?s.jsxs("div",{style:{position:"absolute",top:"20px",left:"50%",transform:"translateX(-50%)",background:"rgba(0, 0, 0, 0.8)",color:"white",padding:"10px 20px",borderRadius:"8px",zIndex:1e3,display:"flex",alignItems:"center",gap:"10px"},children:[s.jsx("div",{style:{width:"20px",height:"20px",border:"2px solid #fff",borderTop:"2px solid transparent",borderRadius:"50%",animation:"spin 1s linear infinite"}}),"Generating route..."]}):null,V6=({routeId:e,onRouteLoaded:t})=>{const{data:n}=function(e){return Ce({...e,enabled:!0,suspense:!0,throwOnError:xe,placeholderData:void 0},W)}({queryKey:eX.route(e),queryFn:async()=>{const t=await wj.getById(e);if(!t.success)throw new Error(t.message);return t.data},staleTime:12e4});return fe.useEffect(()=>{n&&t(n)},[n,t]),null},W6=()=>{const e=ZJ(),t=JN(e=>e.mapType);return pe.useEffect(()=>{if(e)try{const n=e;n&&"function"==typeof n.setMapTypeId&&n.setMapTypeId(t)}catch(n){}},[e,t]),null},$6=()=>{const e=ZJ(),t=$N(e=>e.uploadedRoutes),n=$N(e=>e.snappedRoads),r=$N(e=>e.clearUploadedRouteFocus);return pe.useEffect(()=>{if(!e||0===t.focusRouteIds.length)return;const o=t.routes.filter(e=>t.focusRouteIds.includes(e.id));if(0===o.length)return void r();const i=[];o.forEach(e=>{"FeatureCollection"===e.data.type?i.push(...e.data.features):i.push(e.data)}),t.focusRouteIds.forEach(e=>{n.roads.filter(t=>t.uploadedRouteId===e).forEach(e=>{i.push(e.feature)})});const s=function(e){let t=1/0,n=1/0,r=-1/0,o=-1/0,i=!1;const s=e=>{const[s,a]=e;"number"==typeof s&&"number"==typeof a&&(t=Math.min(t,s),n=Math.min(n,a),r=Math.max(r,s),o=Math.max(o,a),i=!0)},a=e=>{switch(e.type){case"Point":s(e.coordinates);break;case"LineString":case"MultiPoint":e.coordinates.forEach(s);break;case"Polygon":e.coordinates.forEach(e=>{e.forEach(s)});break;case"MultiLineString":e.coordinates.forEach(e=>{e.forEach(s)});break;case"MultiPolygon":e.coordinates.forEach(e=>{e.forEach(e=>{e.forEach(s)})});break;case"GeometryCollection":e.geometries.forEach(a)}};return e.features.forEach(e=>{e.geometry&&a(e.geometry)}),i?[t,n,r,o]:null}({features:i});if(!s)return void r();const[a,l,c,u]=s,d=new google.maps.LatLngBounds(new google.maps.LatLng(l,a),new google.maps.LatLng(u,c));e.fitBounds(d,{top:100,right:100,bottom:100,left:100}),setTimeout(()=>{r()},500)},[e,t.focusRouteIds,t.routes,n.roads,r]),null},K6=({onZoomGetterReady:e})=>{const t=ZJ("main-map"),n=$N(e=>e.setCurrentZoom);return pe.useEffect(()=>{if(t){const r=()=>{try{return t.getZoom()}catch{return}};e(r);const o=()=>{const e=r();n(e)};o();const i=t.addListener("zoom_changed",o);return()=>{i&&google.maps.event.removeListener(i)}}},[t,e,n]),null},X6=()=>{const e=ZJ("main-map"),t=JN(e=>e.mapMode),n=JN(e=>e.setMapMode),r=$N(e=>e.drawingCompletionMenuPosition),o=$N(e=>e.hideDrawingCompletionMenu),i=$N(e=>e.clearAllDrawing),a=$N(e=>e.confirmLassoDrawing),{handleLassoDone:l,handlePolygonDone:c,isIngesting:u}=X3(),d=$N(e=>e.clearLassoFilteredRoads),A=$N(e=>e.polygonDrawing),h=$N(e=>e.lassoDrawing),p="polygon_drawing"===t?A.points:h.points,[f,g]=pe.useState(null),m=pe.useRef(null),[y,v]=pe.useState(!1);pe.useEffect(()=>{if(e&&r&&p.length>0)try{const t=e;if(m.current)m.current.draw();else{const e=new google.maps.OverlayView;e.onAdd=function(){},e.draw=function(){const e=this.getProjection();if(e&&r&&p.length>0){const n=p.map(t=>{const[n,r]=t,o=new google.maps.LatLng(r,n),i=e.fromLatLngToContainerPixel(o);return i?{x:i.x,y:i.y,lat:r,lng:n}:null}).filter(e=>null!==e);if(0===n.length){const n=new google.maps.LatLng(r.lat,r.lng),o=e.fromLatLngToContainerPixel(n);if(o){const e=t.getDiv().getBoundingClientRect();g({x:o.x+e.left,y:o.y+e.top})}return}const o=t.getDiv().getBoundingClientRect(),i=o.width/2,s=n.reduce((e,t)=>e+t.x,0)/n.length>i?n.reduce((e,t)=>t.x<e.x?t:e,n[0]):n.reduce((e,t)=>t.x>e.x?t:e,n[0]);g({x:s.x+o.left,y:s.y+o.top})}},e.setMap(t),m.current=e}return()=>{if(m.current){try{m.current.setMap(null)}catch(hee){}m.current=null}}}catch(t){}else if(g(null),m.current){try{m.current.setMap(null)}catch(hee){}m.current=null}},[e,r,p,t]);const b=u||y;return pe.useEffect(()=>{if(y)if(r){if(!u){const e=setTimeout(()=>{v(!1)},100);return()=>clearTimeout(e)}}else v(!1)},[u,y,r]),r&&f?s.jsx(y6,{x:f.x,y:f.y,mode:"polygon_drawing"===t?"polygon_drawing":"lasso_selection",onContinue:async()=>{if("road_selection"===t)a(),l(),o();else if("polygon_drawing"===t){v(!0);try{await c()}catch(e){v(!1)}}else{"lasso_selection"===t&&a(),window.dispatchEvent(new CustomEvent("complete-lasso-selection"))}},onCancel:()=>{i(),o(),d(),"road_selection"!==t&&n("view")},onRetry:()=>{i(),o()},onClose:o,isIngesting:b}):null},Y6=({projectId:e,apiKey:t,mapId:n="73a66895f21ab8d1af4c7933",className:r,style:o})=>{const i=JN(e=>e.mapMode),a=JN(e=>e.routes),l=JN(e=>e.projectData),c=JN(e=>e.pendingModeSwitch),u=JN(e=>e.pendingUploadClear),{handleClearUploadedRoutesAndUpload:d}=i0(),A=$N(e=>e.roadImport),h=$N(e=>e.uploadedRoutes),p=$N(e=>e.individualRoute),f=$N(e=>e.polygonDrawing),g=$N(e=>e.toggleSelectedRoad),m=$N(e=>e.initializeRouteInMaking),y=$N(e=>e.selectedRoadPriorities),v=dX(),b=pe.useCallback(async t=>{if(!e)return void Pw("Project ID not available");const n=y.length>0?y:[];if(0!==n.length)try{const r=parseInt(t);if(isNaN(r))return void Pw("Invalid road ID");const o=await v.mutateAsync({roadId:r,projectId:e,priorityList:n}),i=o.stretched_roads||[];if(0===i.length)return void Pw("No stretched roads returned");const s=i[0]?.name||`Road ${i[0]?.id||""}`,a=[],l=[];let c=0;if(i.forEach((e,t)=>{let n=e.linestringGeoJson;if(!n&&e.polyline&&(n="string"==typeof e.polyline?JSON.parse(e.polyline):e.polyline),n&&n.coordinates){const r=n.coordinates;0===t?a.push(...r):a.push(...r.slice(1)),l.push(e.id?.toString()||""),c+=e.length||e.distanceKm||0}}),a.length<2)return void Pw("Invalid stretched road geometry");const u=`stretch-${Date.now()}-${Math.random().toString(36).substr(2,9)}`,d={type:"LineString",coordinates:a},A=function(e){const t=e.geometry.coordinates;if(t.length<2)throw new Error("LineString must have at least 2 coordinates");return{start_point:t[0],end_point:t[t.length-1]}}({type:"Feature",geometry:d,properties:{}}),h={type:"Feature",geometry:d,properties:{road_id:u,name:$w(s),length:c||o.total_length||0,priority:i[0]?.priority,start_point:A.start_point,end_point:A.end_point,isStretched:!0}},p={id:`route-${Date.now()}-${Math.random().toString(36).substr(2,9)}`,name:$w(s),roadIds:[u],geometry:d,priority:i[0]?.priority,distance:c||o.total_length||0};$N.setState(e=>{const t=e.roadImport.importedRoads,n=t?{...t,features:[...t.features,h]}:null;return{roadImport:{...e.roadImport,panelRoutes:[...e.roadImport.panelRoutes,p],importedRoads:n}}}),Tw(`Stretched route added (${i.length} roads)`)}catch(r){Pw(`Failed to stretch road: ${r instanceof Error?r.message:"Unknown error"}`)}else Pw("Please select at least one road priority")},[e,v,y]),w=l?.viewstate?.center||{lat:28.44642679009841,lng:77.03122792287415},x=l?.viewstate?.zoom||17,_=$N(e=>e.segmentation),C=$N(e=>e.roadSelection),S=K3(e||"");Z3(e);const{visibleLayers:E,savedRoutesLegend:B,importedRoadsLegend:I,segmentsLegend:R,getLayerName:k,getLayerColor:T,getBaseLayerId:P,toggleLayerVisibility:F}=(e=>{const[t,n]=pe.useState(!1),[r,o]=pe.useState(!1),i=JN(e=>e.mapType),s=K3(e||""),a=$N(e=>e.toggleLayerVisibility),l=$N(e=>e.layerVisibility??{}),c=$N(e=>e.hoveredFeature);$N(e=>e.roadImport.hoveredRoadId);const u=$N(e=>e.roadImport.selectionMode),d=$N(e=>e.individualRoute),A=$N(e=>e.snappedRoads),h=JN(e=>e.mapMode),p=pe.useMemo(()=>"individual_drawing"===h&&d.points.length>0||A.routeMarkers.length>0,[h,d.points.length,A.routeMarkers.length]),f=pe.useMemo(()=>s0(i),[i]),g={"jurisdiction-boundary":"Jurisdiction Boundary","roads-network-tile":"Road Network","saved-routes-tile":"Saved Routes","uploaded-routes":"Uploaded Routes","uploaded-routes-selected":"Uploaded Routes","snapped-roads":"Google Routes","snapped-roads-selected":"Google Routes","selected-route":"Selected Route","selected-route-segments":"Selected Route Segments","selected-route-segments-boundaries":"Segmentation Cuts","segmentation-boundaries":"Segmentation Cuts","individual-preview":"Draft Route","saved-polygons":"Saved Polygons","imported-roads":"Imported Roads","imported-polygon":"Imported Polygon","preview-segments":"Enabled Segments","selected-route-segments-hovered":"Hovered Segments","original-route-dimmed":"Disabled Segments","lasso-selected-roads":"Lasso Selected Roads","road-selection-highlight":"Road Selection","feature-hover-highlight":"Hovered Route","waypoint-markers":"Markers",segments:"Segments"},m=([e,t,n,r])=>`rgba(${e}, ${t}, ${n}, ${r/255})`,y=pe.useMemo(()=>[{label:"Running",color:m(f.routeStatusColors.synced)},{label:"Validating",color:m(f.routeStatusColors.validating)},{label:"Unsynced",color:m(f.routeStatusColors.unsynced)},{label:"Invalid",color:m(f.routeStatusColors.invalid)}],[f]),v=pe.useMemo(()=>[{label:"Imported",color:m(f.importedRoadsDefaultColor)},{label:"Selected",color:m(f.importedRoadsSelectedColor)},{label:"Hovered",color:m(f.importedRoadsHoveredColor)},{label:"Valid for Selection",color:m(f.importedRoadsValidColor),showWhen:e=>"multi-select"===e}].filter(e=>!e.showWhen||e.showWhen(u)).map(({showWhen:e,...t})=>({label:t.label,color:t.color})),[f,u]),b=pe.useMemo(()=>[{label:"Enabled",color:m(f.individualPreviewColor)},{label:"Disabled",color:m([120,120,120,150])},{label:"Hovered",color:m(f.segmentHoverColor)}],[f]),w=pe.useMemo(()=>({"jurisdiction-boundary":m(f.jurisdictionBoundaryColor),"roads-network-tile":m(f.roadsNetworkColor),"saved-routes-tile":m(f.routeStatusColors.unsynced),"uploaded-routes":m(f.uploadedRouteColor),"uploaded-routes-selected":m(f.uploadedRouteColor),"snapped-roads":m(f.polygonRouteColor),"snapped-roads-selected":m(f.polygonRouteColor),"selected-route":m(f.selectedRouteColor),"selected-route-segments":m(f.selectedRouteColor),"selected-route-segments-boundaries":m([255,43,139,255]),"segmentation-boundaries":m([255,43,139,255]),"individual-preview":m(f.individualPreviewColor),"saved-polygons":m(f.jurisdictionBoundaryColor),"imported-roads":m(f.importedRoadsDefaultColor),"imported-polygon":m(f.polygonRouteColor),"preview-segments":m(f.individualPreviewColor),"original-route-dimmed":m([150,150,150,100]),"lasso-selected-roads":m([16,185,129,220]),"road-selection-highlight":m(f.roadSelectionColor),"waypoint-markers":m([33,150,243,255]),"feature-hover-highlight":m(f.segmentHoverColor),segments:m(f.selectedRouteColor),"selected-route-segments-hovered":m(f.segmentHoverColor)}),[f,i]),x=e=>e.startsWith("saved-routes-tile-t")?"saved-routes-tile":e.startsWith("roads-network-tile-t")?"roads-network-tile":"uploaded-routes-selected"===e?"uploaded-routes":"snapped-roads-selected"===e?"snapped-roads":"selected-route-segments-boundaries"===e?"selected-route-segments-boundaries":"segmentation-boundaries"===e?"segmentation-boundaries":"selected-route-segments-hovered"===e?"selected-route-segments-hovered":"selected-route-segments"===e?"selected-route-segments":e.startsWith("selected-route-")?"selected-route":e.startsWith("individual-preview-")?"individual-preview":e.startsWith("imported-roads-")?"imported-roads":e.startsWith("road-selection-")?"road-selection-highlight":e;return{isLayersExpanded:t,setIsLayersExpanded:n,expandedSavedRoutes:r,setExpandedSavedRoutes:o,visibleLayers:pe.useMemo(()=>{const e=new Set(["selected-route","selected-route-segments","selected-route-segments-boundaries","segmentation-boundaries","individual-preview","uploaded-routes","imported-roads","imported-polygon","preview-segments","selected-route-segments-hovered","lasso-selected-roads","road-selection-highlight","segments"]),t=["jurisdiction-boundary","roads-network-tile","saved-routes-tile","uploaded-routes","snapped-roads","selected-route","selected-route-segments","selected-route-segments-boundaries","segmentation-boundaries","individual-preview","saved-polygons","imported-roads","preview-segments","selected-route-segments-hovered","lasso-selected-roads","road-selection-highlight","segments"],n=new Map,r=new Set;s.forEach(e=>{const o=e._parentLayerId||e.id,i=x(o);if(o.includes("-selected")&&t.includes(i)&&r.add(i),t.includes(i)){const t="imported-roads"===i&&o.startsWith("imported-roads-");r.has(i)&&o.includes("-selected")||t&&!n.has(i)?n.set(i,{layer:e,layerIdToCheck:o}):r.has(i)||n.has(i)||t||n.set(i,{layer:e,layerIdToCheck:o})}});const o=new Set(Object.keys(l).map(e=>x(e))),i=new Set;t.forEach(t=>{const r=n.has(t),s=o.has(t),a=l[t];e.has(t)?(r||s&&!1===a)&&i.add(t):(r||s)&&i.add(t)});const a=t.filter(e=>i.has(e)).map(e=>{const t=n.get(e),r=t?.layerIdToCheck||e,o=l[e],i=void 0!==o?o:!1!==t?.layer?.visible;if(t){const{id:n,...o}=t.layer;return{...o,id:e,_originalId:n,_originalLayerId:r,visible:i}}return{id:e,_originalId:e,_originalLayerId:r,visible:i}}),u=[];s.some(e=>"feature-hover-highlight"===e.id)&&c&&c.layerId&&u.push({id:"feature-hover-highlight",_originalId:"feature-hover-highlight",_originalLayerId:c.layerId,visible:!0});const d=[];if(p){const e=l["waypoint-markers"],t=void 0===e||e;d.push({id:"waypoint-markers",_originalId:"waypoint-markers",_originalLayerId:"waypoint-markers",visible:t})}const A=a.some(e=>"preview-segments"===e.id),h=a.some(e=>"selected-route-segments"===e.id),f=a.some(e=>"selected-route-segments-hovered"===e.id)||s.some(e=>"selected-route-segments-hovered"===e.id),g=[],m=A||h||f,y=a.some(e=>"selected-route"===e.id);if(m&&!y){const e=A&&a.find(e=>"preview-segments"===e.id)?.visible||h&&a.find(e=>"selected-route-segments"===e.id)?.visible||!1,t=f&&(a.find(e=>"selected-route-segments-hovered"===e.id)?.visible||!1),n=l.segments,r=void 0!==n?n:e||t;return g.push({id:"segments",_originalId:"segments",_originalLayerId:"segments",visible:r}),[...a.filter(e=>"preview-segments"!==e.id&&"selected-route-segments"!==e.id&&"selected-route-segments-hovered"!==e.id),...g,...u,...d]}return[...a,...u,...d]},[s,l,c,p]),savedRoutesLegend:y,importedRoadsLegend:v,segmentsLegend:b,getLayerName:e=>g[e]||e,getLayerColor:(e,t)=>t&&t.includes("-selected")?w[t]||w[e]||"#000000":w[e]||"#000000",getBaseLayerId:x,toggleLayerVisibility:a}})(e||""),M=pe.useRef(null),L=pe.useRef(null),{contextMenu:U,closeContextMenu:O,selectFeature:D}=(({deckOverlayRef:e,mapElementId:t="main-map",mapMode:n,getZoom:r})=>{const[o,i]=pe.useState(null),s=$N(e=>e.roadImport),a=$N(e=>e.toggleSelectedRoad),l=$N(e=>e.addRoadToMultiSelect),c=$N(e=>e.initializeRouteInMaking),u=$N(e=>e.addRoadToRouteInMaking),d=pe.useCallback((r,o=!1)=>{if(o&&r.preventDefault(),!e.current)return;const l=document.getElementById(t);if(l)try{const t=l.getBoundingClientRect(),d=r.clientX-t.left,A=r.clientY-t.top,h=e.current._deck;if(!h)return;const p=h.pickMultipleObjects({x:d,y:A,radius:10}).filter(e=>e.object?.properties&&e.layer?.id&&e.layer?.constructor?.name&&"direction_arrow"!==e.object?.properties?.type&&"Feature"!==b6(e.layer.id,e.object.properties).title).map(e=>{const t=e.layer.id,n=e.layer.constructor.name,r=e.object.properties,o=e.object.geometry.coordinates;return{layerId:t,layerType:n,object:r,displayInfo:b6(t,r),polyline:o}});if(0===p.length)return;if("road_selection"===n){const e=s.selectionMode||"single",t=p.filter(e=>"imported-roads"===v6(e.layerId));if(o){if(t.length>0)return void(1===t.length?i({x:r.clientX,y:r.clientY,stage:"feature-menu",selectedFeature:t[0],isRightClick:!0}):i({x:r.clientX,y:r.clientY,stage:"feature-selection",features:t,isRightClick:!0}))}else if("multi-select"===e){if(1===t.length){const e=t[0],n=e.object?.road_id?.toString()||e.object?.properties?.road_id?.toString()||e.object?.id?.toString()||e.object?.properties?.id?.toString();if(n){if(s.routeInMaking){if(!s.importedRoads)return;const e=Qw(n,s.routeInMaking,s.importedRoads);return e.canAdd&&e.position?void u(n,e.position):void Pw("This road cannot be added. Only roads that form a continuous path can be added.")}return void c(n)}}else if(t.length>1){if(!s.routeInMaking||!s.importedRoads)return void i({x:r.clientX,y:r.clientY,stage:"feature-selection",features:t,isRightClick:!1});{const e=s.routeInMaking,n=s.importedRoads,o=t.filter(t=>{const r=t.object?.road_id?.toString()||t.object?.properties?.road_id?.toString()||t.object?.id?.toString()||t.object?.properties?.id?.toString();return!!r&&Qw(r,e,n).canAdd});if(1!==o.length)return o.length>1?void i({x:r.clientX,y:r.clientY,stage:"feature-selection",features:o,isRightClick:!1}):void Pw("No valid roads at this location. Only roads that form a continuous path can be added.");{const t=o[0],r=t.object?.road_id?.toString()||t.object?.properties?.road_id?.toString()||t.object?.id?.toString()||t.object?.properties?.id?.toString();if(r){const t=Qw(r,e,n);if(t.canAdd&&t.position)return void u(r,t.position)}}}}}else{if("lasso"===e)return;if("single"===e)if(1===t.length){const e=t[0],n=e.object?.road_id?.toString()||e.object?.properties?.road_id?.toString()||e.object?.id?.toString()||e.object?.properties?.id?.toString();if(n)return void a(n)}else if(t.length>1)return void i({x:r.clientX,y:r.clientY,stage:"feature-selection",features:t,isRightClick:!1})}}1===p.length?i({x:r.clientX,y:r.clientY,stage:"feature-menu",selectedFeature:p[0],isRightClick:o}):i({x:r.clientX,y:r.clientY,stage:"feature-selection",features:p,isRightClick:o})}catch(d){}},[e,t,n,s.selectionMode,s.routeInMaking,s.importedRoads,a,l,c,u]);return pe.useEffect(()=>{const e=document.getElementById(t);if(!e)return;const o=e=>{d(e,!0)},i=e=>{if("view"!==n&&"road_selection"!==n)return;const t=r?.();void 0===t||t<14||d(e,!1)};return"view"!==n&&("road_selection"!==n||"single"!==s.selectionMode&&"lasso"!==s.selectionMode&&"multi-select"!==s.selectionMode&&null!==s.selectionMode)||(e.addEventListener("contextmenu",o),e.addEventListener("click",i)),()=>{"view"!==n&&("road_selection"!==n||"single"!==s.selectionMode&&"lasso"!==s.selectionMode&&"multi-select"!==s.selectionMode&&null!==s.selectionMode)||(e.removeEventListener("contextmenu",o),e.removeEventListener("click",i))}},[e,t,n,r,d]),{contextMenu:o,closeContextMenu:()=>{i(null)},selectFeature:e=>{o&&i({x:o.x,y:o.y,stage:"feature-menu",selectedFeature:e,isRightClick:o.isRightClick})}}})({deckOverlayRef:M,mapElementId:"main-map",mapMode:i,getZoom:()=>L.current?.()??void 0}),{handleMapClick:N}=(e=>{const t=$N(e=>e.addPoint),n=$N(e=>e.addPolygonPoint),r=$N(e=>e.addCutPoint),o=$N(e=>e.segmentation),i=$N(e=>e.markerDragEndTime),s=$N(e=>e.isAddingWaypoint),a=$N(e=>e.waypointAddingRouteId),l=$N(e=>e.addWaypoint),c=$N(e=>e.removeSnappedRoadsForRoute),u=$N(e=>e.addSnappedRoads);return{handleMapClick:pe.useCallback(async(n,d)=>{if(void 0!==n&&void 0!==d&&!(Date.now()-i<500)){if(s&&a){const e=25,t=$N.getState(),r=(0,t.getEditingState)(a),o=r?.temporaryMarkers||t.snappedRoads.routeMarkers.find(e=>e.routeId===a);if(o&&o.waypoints.length>=e)return void Pw(`Maximum ${e} waypoints allowed per route`);l(a,{lat:n,lng:d});const i=$N.getState(),s=i.getEditingState(a),A=s?.temporaryMarkers||i.snappedRoads.routeMarkers.find(e=>e.routeId===a);if(A){const e=null!==s,t=$N.getState().removePreviewRoadsForRoute,n=$N.getState().addPreviewRoads,r=JN.getState(),o=r.projectData?.boundaryGeoJson;e?q3({routeId:a,markers:A,removeSnappedRoadsForRoute:t,addSnappedRoads:n,boundary:o}).catch(e=>{e instanceof Error&&e.message.includes("boundary")&&Pw(e.message)}):q3({routeId:a,markers:A,removeSnappedRoadsForRoute:c,addSnappedRoads:u,boundary:o}).catch(e=>{e instanceof Error&&e.message.includes("boundary")&&Pw(e.message)})}return}if(o.isActive&&o.targetRoute&&"manual"===o.type){const e={id:`cut_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,routeId:o.targetRoute.id,cutOrder:o.cutPoints.length+1,coordinates:{lat:n,lng:d},distanceFromStart:0,createdAt:(new Date).toISOString(),updatedAt:(new Date).toISOString()};return void r(e)}switch(e){case"individual_drawing":{const e=JN.getState();if(!e.showIndividualMarkers)return;const r=27;if($N.getState().individualRoute.points.length>=r)return void Pw(`Maximum ${r} points allowed (origin + 25 waypoints + destination)`);const o=e.projectData?.boundaryGeoJson;if(o&&!Ew(n,d,o))return void Pw("Point must be within the jurisdiction boundary");const i=`point_${Date.now()}_${Math.random().toString(36).substr(2,9)}`;t({id:i,coordinates:{lat:n,lng:d}});break}}}},[e,t,n,r,o.isActive,o.type,o.targetRoute,i,s,a,l,c,u])}})(i),j=JN(e=>e.selectedRoute),Q=j?.id,z=pe.useCallback(e=>{const{updateRoute:t,addRoute:n,selectRoute:r}=JN.getState();JN.getState().routes.find(t=>t.id===e.id)?(t(e.id,e),JN.getState().selectedRoute?.id===e.id&&r(e.id)):(n(e),Q===e.id&&r(e.id))},[Q]),H=S,G=pe.useRef("");return pe.useEffect(()=>{const e=S.map(e=>e.id).join(",");G.current!==e&&(G.current=e)},[S,H.length,i,_.isActive]),s.jsxs(PJ,{apiKey:t,children:[s.jsx("style",{children:"\n        @keyframes spin {\n          0% { transform: rotate(0deg); }\n          100% { transform: rotate(360deg); }\n        }\n        \n        /* DeckGL Tooltip Styling - target all possible tooltip containers */\n        div[class*=\"tooltip\"],\n        .deckgl-tooltip,\n        .deck-tooltip {\n          background: rgba(255, 255, 255, 0.95) !important;\n          color: #1f2937 !important;\n          font-size: 13px !important;\n          padding: 10px 14px !important;\n          border-radius: 12px !important;\n          box-shadow: 0 4px 12px rgba(0,0,0,0.15), 0 0 0 1px rgba(0,0,0,0.05) !important;\n          font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif !important;\n          font-weight: 500 !important;\n          line-height: 1.5 !important;\n          max-width: 280px !important;\n          white-space: pre-line !important;\n          border: none !important;\n        }\n      "}),s.jsxs("div",{className:r,style:o,children:[s.jsx(G6,{}),Q&&s.jsx(V6,{routeId:Q,onRouteLoaded:z}),s.jsxs(qJ,{id:"main-map",mapTypeId:"hybrid",mapId:n,colorScheme:"LIGHT",style:{width:"100%",height:"100%"},gestureHandling:"greedy",disableDefaultUI:!1,mapTypeControl:!1,streetViewControl:!1,fullscreenControl:!1,zoomControl:!1,defaultCenter:w,defaultZoom:x,scaleControl:!1,restriction:{latLngBounds:{north:85,south:-85,west:-180,east:180},strictBounds:!0},clickableIcons:!1,onClick:e=>{"polygon_drawing"!==i&&N(e.detail.latLng?.lat||0,e.detail.latLng?.lng||0)},children:[s.jsx(r6,{}),s.jsx(W6,{}),s.jsx($6,{}),s.jsx(K6,{onZoomGetterReady:e=>{L.current=e}}),s.jsx($Z,{mapId:"main-map"}),s.jsx($Z,{mapId:"main-map"}),s.jsx(H6,{layers:H,overlayRef:M,projectId:e}),s.jsx(o6,{mapId:"main-map"}),s.jsx(P5,{}),"individual_drawing"===i&&s.jsx(S5,{}),_.isActive&&("manual"===_.type||"intersections"===_.type)&&s.jsx(I5,{}),s.jsx(C5,{}),s.jsx(R5,{})]}),s.jsx(X6,{}),U&&s.jsxs(s.Fragment,{children:["feature-selection"===U.stage&&s.jsx(g6,{x:U.x,y:U.y,features:U.features,onSelectFeature:D,onClose:O,mapMode:i,panelRoutes:A.panelRoutes,onToggleRoad:e=>g(e),onStretchRoad:b,onInitializeRouteInMaking:m}),"feature-menu"===U.stage&&U.selectedFeature&&(()=>{const{layerId:t,object:n,polyline:r}=U.selectedFeature,o=e=>e?.startsWith("imported-roads-")?"imported-roads":e.replace(/-[vt]\d+$/,"");switch(o(t)){case"roads-network-tile":case"roads-network":case"imported-roads":if("road_selection"===i){if("imported-roads"===o(t))return s.jsx(g6,{x:U.x,y:U.y,features:[U.selectedFeature],onSelectFeature:D,onClose:O,mapMode:i,panelRoutes:A.panelRoutes,onToggleRoad:e=>g(e),onStretchRoad:b,onInitializeRouteInMaking:m})}return s.jsx(c6,{x:U.x,y:U.y,road:{...n,polyline:r},projectId:e,onClose:O});case"saved-routes-tile":case"saved-routes":{const t=n.properties?.uuid||n.properties?.id||n.id;let r=a.find(e=>e.id===t);if(!r){const o=n.properties||n,i=(e,t)=>{if(!e)return t;if("string"==typeof e)try{return JSON.parse(e)}catch{return t}return e},s=e=>e?"object"==typeof e&&"lat"in e&&"lng"in e?{lat:e.lat,lng:e.lng}:Array.isArray(e)&&e.length>=2?{lat:e[1],lng:e[0]}:{lat:0,lng:0}:{lat:0,lng:0},a=i(o.origin,null),l=i(o.destination,null),c=i(o.waypoints,[]),u=s(a),d=s(l),A=Array.isArray(c)?c.map(e=>s(e)):[];r={id:t,name:o.name||`Route ${t}`,projectId:o.project_id||e,type:o.type||"normal",source:o.source||"individual_drawing",origin:u,destination:d,waypoints:A,encodedPolyline:o.encoded_polyline||"",distance:o.distance||o.length||0,duration:o.duration||0,status:o.status||o.sync_status||"unsynced",createdAt:o.created_at||(new Date).toISOString(),updatedAt:o.updated_at||(new Date).toISOString(),roads:[],isSegmented:o.is_segmented||!1,segmentCount:o.segment_count||0,color:o.color||o.stroke||"#2196F3",opacity:o.opacity||o["stroke-opacity"]||1,tag:o.tag||""}}return r?s.jsx(u6,{x:U.x,y:U.y,route:r,onClose:O}):null}case"saved-polygons":return s.jsx(p6,{x:U.x,y:U.y,polygon:n,onClose:O});case"preview-segments":return s.jsx(f6,{x:U.x,y:U.y,segment:n,onClose:O});default:return null}})()]}),s.jsx(F5,{visibleLayers:E,savedRoutesLegend:B,importedRoadsLegend:I,segmentsLegend:R,getLayerName:k,getLayerColor:T,getBaseLayerId:P,toggleLayerVisibility:F}),s.jsx(n6,{}),s.jsx(x6,{}),A.pendingModeSwitch&&s.jsx(f5,{open:!!A.pendingModeSwitch,fromMode:A.pendingModeSwitch.from,toMode:A.pendingModeSwitch.to,onConfirm:()=>{const{clearRoadImport:e,setPendingModeSwitch:t}=$N.getState(),{clearAllDrawing:n,exitSelectionMode:r}=$N.getState(),{setMapMode:o}=JN.getState(),i=A.pendingModeSwitch;i&&(e(),n(),r(),t(null),o(i.to),"upload_routes"===i.to&&setTimeout(()=>{const e=document.querySelector('input[type="file"][accept*="geojson"]');if(e){const t=()=>{setTimeout(()=>{if(e&&!e.files?.length){const{setMapMode:e}=JN.getState();e("view")}window.removeEventListener("focus",t)},100)};window.addEventListener("focus",t,{once:!0}),e.click()}else setTimeout(()=>{const e=document.querySelector('input[type="file"][accept*="geojson"]');if(e){const t=()=>{setTimeout(()=>{if(e&&!e.files?.length){const{setMapMode:e}=JN.getState();e("view")}window.removeEventListener("focus",t)},100)};window.addEventListener("focus",t,{once:!0}),e.click()}},200)},150))},onCancel:()=>{$N.getState().setPendingModeSwitch(null)}}),c&&(()=>{const{editingSavedRouteId:e,hasUnsavedChanges:t}=$N.getState(),n=h.routes.length>0&&("upload_routes"===c.from||"individual_drawing"===c.to||"polygon_drawing"===c.to||"lasso_selection"===c.to),r="individual_drawing"===c.from&&p.points.length>0&&null===e,o="individual_drawing"===c.from&&null!==e&&t(e),i="polygon_drawing"===c.from&&f.points.length>0,a=n||o?"uploaded_routes":r?"drawn_route":i?"polygon_drawing":"uploaded_routes";return s.jsx(g5,{open:!!c,type:a,routeCount:o?1:h.routes.length,pointCount:r?p.points.length:i?f.points.length:0,onConfirm:()=>{const{clearUploadedRoutes:t,clearSnappedRoads:s,clearAllOptimizedRouteMarkers:a,setSelectedUploadedRouteId:l,clearPoints:u,clearIndividualRoute:d,clearPolygonDrawing:A,discardRouteChanges:h}=$N.getState(),{setMapMode:p,setPendingModeSwitch:f}=JN.getState(),{clearAllDrawing:g,exitSelectionMode:m}=$N.getState(),y=c;if(y){n&&(t(),s(),a(),l(null)),o&&e&&h(e),r&&(u(),d()),i&&A(),g(),m();const c=y.returnToMode;f(null),p(c||y.to),"upload_routes"===y.to&&setTimeout(()=>{const e=document.querySelector('input[type="file"][accept*="geojson"]');if(e){const t=()=>{setTimeout(()=>{if(e&&!e.files?.length){const{setMapMode:e}=JN.getState();e("view")}window.removeEventListener("focus",t)},100)};window.addEventListener("focus",t,{once:!0}),e.click()}else setTimeout(()=>{const e=document.querySelector('input[type="file"][accept*="geojson"]');if(e){const t=()=>{setTimeout(()=>{if(e&&!e.files?.length){const{setMapMode:e}=JN.getState();e("view")}window.removeEventListener("focus",t)},100)};window.addEventListener("focus",t,{once:!0}),e.click()}},200)},150)}},onCancel:()=>{JN.getState().setPendingModeSwitch(null)}})})(),u&&s.jsx(f5,{open:u,fromMode:"upload_routes",toMode:"upload_routes",title:"Clear Uploaded Routes",message:"You have uploaded routes. If you continue, all uploaded routes and their changes will be lost.",confirmButtonText:"Continue",onConfirm:d,onCancel:()=>{JN.getState().setPendingUploadClear(!1)}}),"view"===i&&"none"!==C.mode&&C.highlightedRoads.length>0&&!C.isPreview&&s.jsx(_6,{projectId:e})]})]})},q6=({className:e,style:t,dynamicIslandHeight:n,routeName:r,selectedTag:o,newTag:i,routeNameError:a,tagError:l,tags:c,isSaving:u=!1,onBack:d,onClose:A,onRouteNameChange:h,onTagChange:p,onConfirmSave:f})=>{const g=ia();return s.jsx(e6,{className:e,style:t,dynamicIslandHeight:n,title:"Save",showBackButton:!0,onBack:d,onClose:A,footer:s.jsxs(rf,{sx:{p:2,px:3,display:"flex",gap:1},children:[s.jsx(Nv,{onClick:d,variant:"outlined",fullWidth:!0,disabled:u,size:"small",sx:{py:1,fontSize:g.fontSizes.body,minHeight:"36px"},children:"Cancel"}),s.jsx(Nv,{onClick:f,variant:"contained",fullWidth:!0,disabled:!r.trim()||u,size:"small",sx:{py:1,fontSize:g.fontSizes.body,minHeight:"36px"},children:u?"Saving...":"Confirm"})]}),children:s.jsx(rf,{sx:{display:"flex",flexDirection:"column",flex:1,overflow:"hidden"},children:s.jsxs(rf,{sx:{p:2,overflowY:"auto",overflowX:"hidden",flex:1},children:[s.jsx(vA,{variant:"caption",sx:{fontSize:g.fontSizes.caption,color:"#5f6368",fontFamily:'"Google Sans", sans-serif',display:"block",mb:2},children:"Enter a route name and select or create a folder to save your route."}),s.jsx(Dv,{label:"Route Name",fullWidth:!0,required:!0,variant:"standard",value:r,onChange:e=>h(e.target.value),error:!!a,helperText:a,sx:{mb:2.5},inputProps:{maxLength:100},slotProps:{input:{sx:{fontSize:g.fontSizes.body,fontFamily:'"Google Sans", sans-serif'}},inputLabel:{sx:{fontSize:g.fontSizes.body,fontFamily:'"Google Sans", sans-serif'}}}}),s.jsx(T5,{value:o||i||null,onChange:e=>{p(e)},tags:c,error:l,required:!1,label:"Folder *"})]})})})};const J6="undefined"!=typeof window&&void 0!==window.document&&void 0!==window.document.createElement;function Z6(e){const t=Object.prototype.toString.call(e);return"[object Window]"===t||"[object global]"===t}function e8(e){return"nodeType"in e}function t8(e){var t,n;return e?Z6(e)?e:e8(e)&&null!=(t=null==(n=e.ownerDocument)?void 0:n.defaultView)?t:window:window}function n8(e){const{Document:t}=t8(e);return e instanceof t}function r8(e){return!Z6(e)&&e instanceof t8(e).HTMLElement}function o8(e){return e instanceof t8(e).SVGElement}function i8(e){return e?Z6(e)?e.document:e8(e)?n8(e)?e:r8(e)||o8(e)?e.ownerDocument:document:document:document}const s8=J6?pe.useLayoutEffect:pe.useEffect;function a8(e){const t=pe.useRef(e);return s8(()=>{t.current=e}),pe.useCallback(function(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return null==t.current?void 0:t.current(...n)},[])}function l8(e,t){void 0===t&&(t=[e]);const n=pe.useRef(e);return s8(()=>{n.current!==e&&(n.current=e)},t),n}function c8(e,t){const n=pe.useRef();return pe.useMemo(()=>{const t=e(n.current);return n.current=t,t},[...t])}function u8(e){const t=a8(e),n=pe.useRef(null),r=pe.useCallback(e=>{e!==n.current&&(null==t||t(e,n.current)),n.current=e},[]);return[n,r]}function d8(e){const t=pe.useRef();return pe.useEffect(()=>{t.current=e},[e]),t.current}let A8={};function h8(e,t){return pe.useMemo(()=>{if(t)return t;const n=null==A8[e]?0:A8[e]+1;return A8[e]=n,e+"-"+n},[e,t])}function p8(e){return function(t){for(var n=arguments.length,r=new Array(n>1?n-1:0),o=1;o<n;o++)r[o-1]=arguments[o];return r.reduce((t,n)=>{const r=Object.entries(n);for(const[o,i]of r){const n=t[o];null!=n&&(t[o]=n+e*i)}return t},{...t})}}const f8=p8(1),g8=p8(-1);function m8(e){if(!e)return!1;const{KeyboardEvent:t}=t8(e.target);return t&&e instanceof t}function y8(e){if(function(e){if(!e)return!1;const{TouchEvent:t}=t8(e.target);return t&&e instanceof t}(e)){if(e.touches&&e.touches.length){const{clientX:t,clientY:n}=e.touches[0];return{x:t,y:n}}if(e.changedTouches&&e.changedTouches.length){const{clientX:t,clientY:n}=e.changedTouches[0];return{x:t,y:n}}}return function(e){return"clientX"in e&&"clientY"in e}(e)?{x:e.clientX,y:e.clientY}:null}const v8=Object.freeze({Translate:{toString(e){if(!e)return;const{x:t,y:n}=e;return"translate3d("+(t?Math.round(t):0)+"px, "+(n?Math.round(n):0)+"px, 0)"}},Scale:{toString(e){if(!e)return;const{scaleX:t,scaleY:n}=e;return"scaleX("+t+") scaleY("+n+")"}},Transform:{toString(e){if(e)return[v8.Translate.toString(e),v8.Scale.toString(e)].join(" ")}},Transition:{toString(e){let{property:t,duration:n,easing:r}=e;return t+" "+n+"ms "+r}}}),b8="a,frame,iframe,input:not([type=hidden]):not(:disabled),select:not(:disabled),textarea:not(:disabled),button:not(:disabled),*[tabindex]";function w8(e){return e.matches(b8)?e:e.querySelector(b8)}const x8={display:"none"};function _8(e){let{id:t,value:n}=e;return fe.createElement("div",{id:t,style:x8},n)}function C8(e){let{id:t,announcement:n,ariaLiveType:r="assertive"}=e;return fe.createElement("div",{id:t,style:{position:"fixed",top:0,left:0,width:1,height:1,margin:-1,border:0,padding:0,overflow:"hidden",clip:"rect(0 0 0 0)",clipPath:"inset(100%)",whiteSpace:"nowrap"},role:"status","aria-live":r,"aria-atomic":!0},n)}const S8=pe.createContext(null);const E8={draggable:"\n    To pick up a draggable item, press the space bar.\n    While dragging, use the arrow keys to move the item.\n    Press space again to drop the item in its new position, or press escape to cancel.\n  "},B8={onDragStart(e){let{active:t}=e;return"Picked up draggable item "+t.id+"."},onDragOver(e){let{active:t,over:n}=e;return n?"Draggable item "+t.id+" was moved over droppable area "+n.id+".":"Draggable item "+t.id+" is no longer over a droppable area."},onDragEnd(e){let{active:t,over:n}=e;return n?"Draggable item "+t.id+" was dropped over droppable area "+n.id:"Draggable item "+t.id+" was dropped."},onDragCancel(e){let{active:t}=e;return"Dragging was cancelled. Draggable item "+t.id+" was dropped."}};function I8(e){let{announcements:t=B8,container:n,hiddenTextDescribedById:r,screenReaderInstructions:o=E8}=e;const{announce:i,announcement:s}=function(){const[e,t]=pe.useState("");return{announce:pe.useCallback(e=>{null!=e&&t(e)},[]),announcement:e}}(),a=h8("DndLiveRegion"),[l,c]=pe.useState(!1);if(pe.useEffect(()=>{c(!0)},[]),function(e){const t=pe.useContext(S8);pe.useEffect(()=>{if(!t)throw new Error("useDndMonitor must be used within a children of <DndContext>");return t(e)},[e,t])}(pe.useMemo(()=>({onDragStart(e){let{active:n}=e;i(t.onDragStart({active:n}))},onDragMove(e){let{active:n,over:r}=e;t.onDragMove&&i(t.onDragMove({active:n,over:r}))},onDragOver(e){let{active:n,over:r}=e;i(t.onDragOver({active:n,over:r}))},onDragEnd(e){let{active:n,over:r}=e;i(t.onDragEnd({active:n,over:r}))},onDragCancel(e){let{active:n,over:r}=e;i(t.onDragCancel({active:n,over:r}))}}),[i,t])),!l)return null;const u=fe.createElement(fe.Fragment,null,fe.createElement(_8,{id:r,value:o.draggable}),fe.createElement(C8,{id:a,announcement:s}));return n?wu.createPortal(u,n):u}var R8,k8;function T8(){}function P8(e,t){return pe.useMemo(()=>({sensor:e,options:null!=t?t:{}}),[e,t])}(k8=R8||(R8={})).DragStart="dragStart",k8.DragMove="dragMove",k8.DragEnd="dragEnd",k8.DragCancel="dragCancel",k8.DragOver="dragOver",k8.RegisterDroppable="registerDroppable",k8.SetDroppableDisabled="setDroppableDisabled",k8.UnregisterDroppable="unregisterDroppable";const F8=Object.freeze({x:0,y:0});function M8(e,t){return Math.sqrt(Math.pow(e.x-t.x,2)+Math.pow(e.y-t.y,2))}function L8(e,t){let{data:{value:n}}=e,{data:{value:r}}=t;return n-r}function U8(e,t){let{data:{value:n}}=e,{data:{value:r}}=t;return r-n}function O8(e){let{left:t,top:n,height:r,width:o}=e;return[{x:t,y:n},{x:t+o,y:n},{x:t,y:n+r},{x:t+o,y:n+r}]}function D8(e,t){if(!e||0===e.length)return null;const[n]=e;return n[t]}function N8(e,t,n){return void 0===t&&(t=e.left),void 0===n&&(n=e.top),{x:t+.5*e.width,y:n+.5*e.height}}const j8=e=>{let{collisionRect:t,droppableRects:n,droppableContainers:r}=e;const o=N8(t,t.left,t.top),i=[];for(const s of r){const{id:e}=s,t=n.get(e);if(t){const n=M8(N8(t),o);i.push({id:e,data:{droppableContainer:s,value:n}})}}return i.sort(L8)};function Q8(e,t){const n=Math.max(t.top,e.top),r=Math.max(t.left,e.left),o=Math.min(t.left+t.width,e.left+e.width),i=Math.min(t.top+t.height,e.top+e.height),s=o-r,a=i-n;if(r<o&&n<i){const n=t.width*t.height,r=e.width*e.height,o=s*a;return Number((o/(n+r-o)).toFixed(4))}return 0}const z8=e=>{let{collisionRect:t,droppableRects:n,droppableContainers:r}=e;const o=[];for(const i of r){const{id:e}=i,r=n.get(e);if(r){const n=Q8(r,t);n>0&&o.push({id:e,data:{droppableContainer:i,value:n}})}}return o.sort(U8)};function H8(e,t){return e&&t?{x:e.left-t.left,y:e.top-t.top}:F8}function G8(e){return function(t){for(var n=arguments.length,r=new Array(n>1?n-1:0),o=1;o<n;o++)r[o-1]=arguments[o];return r.reduce((t,n)=>({...t,top:t.top+e*n.y,bottom:t.bottom+e*n.y,left:t.left+e*n.x,right:t.right+e*n.x}),{...t})}}const V8=G8(1);const W8={ignoreTransform:!1};function $8(e,t){void 0===t&&(t=W8);let n=e.getBoundingClientRect();if(t.ignoreTransform){const{transform:t,transformOrigin:r}=t8(e).getComputedStyle(e);t&&(n=function(e,t,n){const r=function(e){if(e.startsWith("matrix3d(")){const t=e.slice(9,-1).split(/, /);return{x:+t[12],y:+t[13],scaleX:+t[0],scaleY:+t[5]}}if(e.startsWith("matrix(")){const t=e.slice(7,-1).split(/, /);return{x:+t[4],y:+t[5],scaleX:+t[0],scaleY:+t[3]}}return null}(t);if(!r)return e;const{scaleX:o,scaleY:i,x:s,y:a}=r,l=e.left-s-(1-o)*parseFloat(n),c=e.top-a-(1-i)*parseFloat(n.slice(n.indexOf(" ")+1)),u=o?e.width/o:e.width,d=i?e.height/i:e.height;return{width:u,height:d,top:c,right:l+u,bottom:c+d,left:l}}(n,t,r))}const{top:r,left:o,width:i,height:s,bottom:a,right:l}=n;return{top:r,left:o,width:i,height:s,bottom:a,right:l}}function K8(e){return $8(e,{ignoreTransform:!0})}function X8(e,t){const n=[];return e?function r(o){if(null!=t&&n.length>=t)return n;if(!o)return n;if(n8(o)&&null!=o.scrollingElement&&!n.includes(o.scrollingElement))return n.push(o.scrollingElement),n;if(!r8(o)||o8(o))return n;if(n.includes(o))return n;const i=t8(e).getComputedStyle(o);return o!==e&&function(e,t){void 0===t&&(t=t8(e).getComputedStyle(e));const n=/(auto|scroll|overlay)/;return["overflow","overflowX","overflowY"].some(e=>{const r=t[e];return"string"==typeof r&&n.test(r)})}(o,i)&&n.push(o),function(e,t){return void 0===t&&(t=t8(e).getComputedStyle(e)),"fixed"===t.position}(o,i)?n:r(o.parentNode)}(e):n}function Y8(e){const[t]=X8(e,1);return null!=t?t:null}function q8(e){return J6&&e?Z6(e)?e:e8(e)?n8(e)||e===i8(e).scrollingElement?window:r8(e)?e:null:null:null}function J8(e){return Z6(e)?e.scrollX:e.scrollLeft}function Z8(e){return Z6(e)?e.scrollY:e.scrollTop}function e9(e){return{x:J8(e),y:Z8(e)}}var t9,n9;function r9(e){return!(!J6||!e)&&e===document.scrollingElement}function o9(e){const t={x:0,y:0},n=r9(e)?{height:window.innerHeight,width:window.innerWidth}:{height:e.clientHeight,width:e.clientWidth},r={x:e.scrollWidth-n.width,y:e.scrollHeight-n.height};return{isTop:e.scrollTop<=t.y,isLeft:e.scrollLeft<=t.x,isBottom:e.scrollTop>=r.y,isRight:e.scrollLeft>=r.x,maxScroll:r,minScroll:t}}(n9=t9||(t9={}))[n9.Forward=1]="Forward",n9[n9.Backward=-1]="Backward";const i9={x:.2,y:.2};function s9(e,t,n,r,o){let{top:i,left:s,right:a,bottom:l}=n;void 0===r&&(r=10),void 0===o&&(o=i9);const{isTop:c,isBottom:u,isLeft:d,isRight:A}=o9(e),h={x:0,y:0},p={x:0,y:0},f=t.height*o.y,g=t.width*o.x;return!c&&i<=t.top+f?(h.y=t9.Backward,p.y=r*Math.abs((t.top+f-i)/f)):!u&&l>=t.bottom-f&&(h.y=t9.Forward,p.y=r*Math.abs((t.bottom-f-l)/f)),!A&&a>=t.right-g?(h.x=t9.Forward,p.x=r*Math.abs((t.right-g-a)/g)):!d&&s<=t.left+g&&(h.x=t9.Backward,p.x=r*Math.abs((t.left+g-s)/g)),{direction:h,speed:p}}function a9(e){if(e===document.scrollingElement){const{innerWidth:e,innerHeight:t}=window;return{top:0,left:0,right:e,bottom:t,width:e,height:t}}const{top:t,left:n,right:r,bottom:o}=e.getBoundingClientRect();return{top:t,left:n,right:r,bottom:o,width:e.clientWidth,height:e.clientHeight}}function l9(e){return e.reduce((e,t)=>f8(e,e9(t)),F8)}const c9=[["x",["left","right"],function(e){return e.reduce((e,t)=>e+J8(t),0)}],["y",["top","bottom"],function(e){return e.reduce((e,t)=>e+Z8(t),0)}]];class u9{constructor(e,t){this.rect=void 0,this.width=void 0,this.height=void 0,this.top=void 0,this.bottom=void 0,this.right=void 0,this.left=void 0;const n=X8(t),r=l9(n);this.rect={...e},this.width=e.width,this.height=e.height;for(const[o,i,s]of c9)for(const e of i)Object.defineProperty(this,e,{get:()=>{const t=s(n),i=r[o]-t;return this.rect[e]+i},enumerable:!0});Object.defineProperty(this,"rect",{enumerable:!1})}}class d9{constructor(e){this.target=void 0,this.listeners=[],this.removeAll=()=>{this.listeners.forEach(e=>{var t;return null==(t=this.target)?void 0:t.removeEventListener(...e)})},this.target=e}add(e,t,n){var r;null==(r=this.target)||r.addEventListener(e,t,n),this.listeners.push([e,t,n])}}function A9(e,t){const n=Math.abs(e.x),r=Math.abs(e.y);return"number"==typeof t?Math.sqrt(n**2+r**2)>t:"x"in t&&"y"in t?n>t.x&&r>t.y:"x"in t?n>t.x:"y"in t&&r>t.y}var h9,p9,f9,g9;function m9(e){e.preventDefault()}function y9(e){e.stopPropagation()}(p9=h9||(h9={})).Click="click",p9.DragStart="dragstart",p9.Keydown="keydown",p9.ContextMenu="contextmenu",p9.Resize="resize",p9.SelectionChange="selectionchange",p9.VisibilityChange="visibilitychange",(g9=f9||(f9={})).Space="Space",g9.Down="ArrowDown",g9.Right="ArrowRight",g9.Left="ArrowLeft",g9.Up="ArrowUp",g9.Esc="Escape",g9.Enter="Enter",g9.Tab="Tab";const v9={start:[f9.Space,f9.Enter],cancel:[f9.Esc],end:[f9.Space,f9.Enter,f9.Tab]},b9=(e,t)=>{let{currentCoordinates:n}=t;switch(e.code){case f9.Right:return{...n,x:n.x+25};case f9.Left:return{...n,x:n.x-25};case f9.Down:return{...n,y:n.y+25};case f9.Up:return{...n,y:n.y-25}}};class w9{constructor(e){this.props=void 0,this.autoScrollEnabled=!1,this.referenceCoordinates=void 0,this.listeners=void 0,this.windowListeners=void 0,this.props=e;const{event:{target:t}}=e;this.props=e,this.listeners=new d9(i8(t)),this.windowListeners=new d9(t8(t)),this.handleKeyDown=this.handleKeyDown.bind(this),this.handleCancel=this.handleCancel.bind(this),this.attach()}attach(){this.handleStart(),this.windowListeners.add(h9.Resize,this.handleCancel),this.windowListeners.add(h9.VisibilityChange,this.handleCancel),setTimeout(()=>this.listeners.add(h9.Keydown,this.handleKeyDown))}handleStart(){const{activeNode:e,onStart:t}=this.props,n=e.node.current;n&&function(e,t){if(void 0===t&&(t=$8),!e)return;const{top:n,left:r,bottom:o,right:i}=t(e);Y8(e)&&(o<=0||i<=0||n>=window.innerHeight||r>=window.innerWidth)&&e.scrollIntoView({block:"center",inline:"center"})}(n),t(F8)}handleKeyDown(e){if(m8(e)){const{active:t,context:n,options:r}=this.props,{keyboardCodes:o=v9,coordinateGetter:i=b9,scrollBehavior:s="smooth"}=r,{code:a}=e;if(o.end.includes(a))return void this.handleEnd(e);if(o.cancel.includes(a))return void this.handleCancel(e);const{collisionRect:l}=n.current,c=l?{x:l.left,y:l.top}:F8;this.referenceCoordinates||(this.referenceCoordinates=c);const u=i(e,{active:t,context:n.current,currentCoordinates:c});if(u){const t=g8(u,c),r={x:0,y:0},{scrollableAncestors:o}=n.current;for(const n of o){const o=e.code,{isTop:i,isRight:a,isLeft:l,isBottom:c,maxScroll:d,minScroll:A}=o9(n),h=a9(n),p={x:Math.min(o===f9.Right?h.right-h.width/2:h.right,Math.max(o===f9.Right?h.left:h.left+h.width/2,u.x)),y:Math.min(o===f9.Down?h.bottom-h.height/2:h.bottom,Math.max(o===f9.Down?h.top:h.top+h.height/2,u.y))},f=o===f9.Right&&!a||o===f9.Left&&!l,g=o===f9.Down&&!c||o===f9.Up&&!i;if(f&&p.x!==u.x){const e=n.scrollLeft+t.x,i=o===f9.Right&&e<=d.x||o===f9.Left&&e>=A.x;if(i&&!t.y)return void n.scrollTo({left:e,behavior:s});r.x=i?n.scrollLeft-e:o===f9.Right?n.scrollLeft-d.x:n.scrollLeft-A.x,r.x&&n.scrollBy({left:-r.x,behavior:s});break}if(g&&p.y!==u.y){const e=n.scrollTop+t.y,i=o===f9.Down&&e<=d.y||o===f9.Up&&e>=A.y;if(i&&!t.x)return void n.scrollTo({top:e,behavior:s});r.y=i?n.scrollTop-e:o===f9.Down?n.scrollTop-d.y:n.scrollTop-A.y,r.y&&n.scrollBy({top:-r.y,behavior:s});break}}this.handleMove(e,f8(g8(u,this.referenceCoordinates),r))}}}handleMove(e,t){const{onMove:n}=this.props;e.preventDefault(),n(t)}handleEnd(e){const{onEnd:t}=this.props;e.preventDefault(),this.detach(),t()}handleCancel(e){const{onCancel:t}=this.props;e.preventDefault(),this.detach(),t()}detach(){this.listeners.removeAll(),this.windowListeners.removeAll()}}function x9(e){return Boolean(e&&"distance"in e)}function _9(e){return Boolean(e&&"delay"in e)}w9.activators=[{eventName:"onKeyDown",handler:(e,t,n)=>{let{keyboardCodes:r=v9,onActivation:o}=t,{active:i}=n;const{code:s}=e.nativeEvent;if(r.start.includes(s)){const t=i.activatorNode.current;return(!t||e.target===t)&&(e.preventDefault(),null==o||o({event:e.nativeEvent}),!0)}return!1}}];class C9{constructor(e,t,n){var r;void 0===n&&(n=function(e){const{EventTarget:t}=t8(e);return e instanceof t?e:i8(e)}(e.event.target)),this.props=void 0,this.events=void 0,this.autoScrollEnabled=!0,this.document=void 0,this.activated=!1,this.initialCoordinates=void 0,this.timeoutId=null,this.listeners=void 0,this.documentListeners=void 0,this.windowListeners=void 0,this.props=e,this.events=t;const{event:o}=e,{target:i}=o;this.props=e,this.events=t,this.document=i8(i),this.documentListeners=new d9(this.document),this.listeners=new d9(n),this.windowListeners=new d9(t8(i)),this.initialCoordinates=null!=(r=y8(o))?r:F8,this.handleStart=this.handleStart.bind(this),this.handleMove=this.handleMove.bind(this),this.handleEnd=this.handleEnd.bind(this),this.handleCancel=this.handleCancel.bind(this),this.handleKeydown=this.handleKeydown.bind(this),this.removeTextSelection=this.removeTextSelection.bind(this),this.attach()}attach(){const{events:e,props:{options:{activationConstraint:t,bypassActivationConstraint:n}}}=this;if(this.listeners.add(e.move.name,this.handleMove,{passive:!1}),this.listeners.add(e.end.name,this.handleEnd),e.cancel&&this.listeners.add(e.cancel.name,this.handleCancel),this.windowListeners.add(h9.Resize,this.handleCancel),this.windowListeners.add(h9.DragStart,m9),this.windowListeners.add(h9.VisibilityChange,this.handleCancel),this.windowListeners.add(h9.ContextMenu,m9),this.documentListeners.add(h9.Keydown,this.handleKeydown),t){if(null!=n&&n({event:this.props.event,activeNode:this.props.activeNode,options:this.props.options}))return this.handleStart();if(_9(t))return this.timeoutId=setTimeout(this.handleStart,t.delay),void this.handlePending(t);if(x9(t))return void this.handlePending(t)}this.handleStart()}detach(){this.listeners.removeAll(),this.windowListeners.removeAll(),setTimeout(this.documentListeners.removeAll,50),null!==this.timeoutId&&(clearTimeout(this.timeoutId),this.timeoutId=null)}handlePending(e,t){const{active:n,onPending:r}=this.props;r(n,e,this.initialCoordinates,t)}handleStart(){const{initialCoordinates:e}=this,{onStart:t}=this.props;e&&(this.activated=!0,this.documentListeners.add(h9.Click,y9,{capture:!0}),this.removeTextSelection(),this.documentListeners.add(h9.SelectionChange,this.removeTextSelection),t(e))}handleMove(e){var t;const{activated:n,initialCoordinates:r,props:o}=this,{onMove:i,options:{activationConstraint:s}}=o;if(!r)return;const a=null!=(t=y8(e))?t:F8,l=g8(r,a);if(!n&&s){if(x9(s)){if(null!=s.tolerance&&A9(l,s.tolerance))return this.handleCancel();if(A9(l,s.distance))return this.handleStart()}return _9(s)&&A9(l,s.tolerance)?this.handleCancel():void this.handlePending(s,l)}e.cancelable&&e.preventDefault(),i(a)}handleEnd(){const{onAbort:e,onEnd:t}=this.props;this.detach(),this.activated||e(this.props.active),t()}handleCancel(){const{onAbort:e,onCancel:t}=this.props;this.detach(),this.activated||e(this.props.active),t()}handleKeydown(e){e.code===f9.Esc&&this.handleCancel()}removeTextSelection(){var e;null==(e=this.document.getSelection())||e.removeAllRanges()}}const S9={cancel:{name:"pointercancel"},move:{name:"pointermove"},end:{name:"pointerup"}};class E9 extends C9{constructor(e){const{event:t}=e,n=i8(t.target);super(e,S9,n)}}E9.activators=[{eventName:"onPointerDown",handler:(e,t)=>{let{nativeEvent:n}=e,{onActivation:r}=t;return!(!n.isPrimary||0!==n.button)&&(null==r||r({event:n}),!0)}}];const B9={move:{name:"mousemove"},end:{name:"mouseup"}};var I9,R9;(R9=I9||(I9={}))[R9.RightClick=2]="RightClick";(class extends C9{constructor(e){super(e,B9,i8(e.event.target))}}).activators=[{eventName:"onMouseDown",handler:(e,t)=>{let{nativeEvent:n}=e,{onActivation:r}=t;return n.button!==I9.RightClick&&(null==r||r({event:n}),!0)}}];const k9={cancel:{name:"touchcancel"},move:{name:"touchmove"},end:{name:"touchend"}};var T9,P9,F9,M9;function L9(e){let{acceleration:t,activator:n=T9.Pointer,canScroll:r,draggingRect:o,enabled:i,interval:s=5,order:a=F9.TreeOrder,pointerCoordinates:l,scrollableAncestors:c,scrollableAncestorRects:u,delta:d,threshold:A}=e;const h=function(e){let{delta:t,disabled:n}=e;const r=d8(t);return c8(e=>{if(n||!r||!e)return U9;const o={x:Math.sign(t.x-r.x),y:Math.sign(t.y-r.y)};return{x:{[t9.Backward]:e.x[t9.Backward]||-1===o.x,[t9.Forward]:e.x[t9.Forward]||1===o.x},y:{[t9.Backward]:e.y[t9.Backward]||-1===o.y,[t9.Forward]:e.y[t9.Forward]||1===o.y}}},[n,t,r])}({delta:d,disabled:!i}),[p,f]=function(){const e=pe.useRef(null);return[pe.useCallback((t,n)=>{e.current=setInterval(t,n)},[]),pe.useCallback(()=>{null!==e.current&&(clearInterval(e.current),e.current=null)},[])]}(),g=pe.useRef({x:0,y:0}),m=pe.useRef({x:0,y:0}),y=pe.useMemo(()=>{switch(n){case T9.Pointer:return l?{top:l.y,bottom:l.y,left:l.x,right:l.x}:null;case T9.DraggableRect:return o}},[n,o,l]),v=pe.useRef(null),b=pe.useCallback(()=>{const e=v.current;if(!e)return;const t=g.current.x*m.current.x,n=g.current.y*m.current.y;e.scrollBy(t,n)},[]),w=pe.useMemo(()=>a===F9.TreeOrder?[...c].reverse():c,[a,c]);pe.useEffect(()=>{if(i&&c.length&&y){for(const e of w){if(!1===(null==r?void 0:r(e)))continue;const n=c.indexOf(e),o=u[n];if(!o)continue;const{direction:i,speed:a}=s9(e,o,y,t,A);for(const e of["x","y"])h[e][i[e]]||(a[e]=0,i[e]=0);if(a.x>0||a.y>0)return f(),v.current=e,p(b,s),g.current=a,void(m.current=i)}g.current={x:0,y:0},m.current={x:0,y:0},f()}else f()},[t,b,r,f,i,s,JSON.stringify(y),JSON.stringify(h),p,c,w,u,JSON.stringify(A)])}(class extends C9{constructor(e){super(e,k9)}static setup(){return window.addEventListener(k9.move.name,e,{capture:!1,passive:!1}),function(){window.removeEventListener(k9.move.name,e)};function e(){}}}).activators=[{eventName:"onTouchStart",handler:(e,t)=>{let{nativeEvent:n}=e,{onActivation:r}=t;const{touches:o}=n;return!(o.length>1)&&(null==r||r({event:n}),!0)}}],(P9=T9||(T9={}))[P9.Pointer=0]="Pointer",P9[P9.DraggableRect=1]="DraggableRect",(M9=F9||(F9={}))[M9.TreeOrder=0]="TreeOrder",M9[M9.ReversedTreeOrder=1]="ReversedTreeOrder";const U9={x:{[t9.Backward]:!1,[t9.Forward]:!1},y:{[t9.Backward]:!1,[t9.Forward]:!1}};var O9,D9,N9;(D9=O9||(O9={}))[D9.Always=0]="Always",D9[D9.BeforeDragging=1]="BeforeDragging",D9[D9.WhileDragging=2]="WhileDragging",(N9||(N9={})).Optimized="optimized";const j9=new Map;function Q9(e,t){return c8(n=>e?n||("function"==typeof t?t(e):e):null,[t,e])}function z9(e){let{callback:t,disabled:n}=e;const r=a8(t),o=pe.useMemo(()=>{if(n||"undefined"==typeof window||void 0===window.ResizeObserver)return;const{ResizeObserver:e}=window;return new e(r)},[n]);return pe.useEffect(()=>()=>null==o?void 0:o.disconnect(),[o]),o}function H9(e){return new u9($8(e),e)}function G9(e,t,n){void 0===t&&(t=H9);const[r,o]=pe.useState(null);function i(){o(r=>{if(!e)return null;var o;if(!1===e.isConnected)return null!=(o=null!=r?r:n)?o:null;const i=t(e);return JSON.stringify(r)===JSON.stringify(i)?r:i})}const s=function(e){let{callback:t,disabled:n}=e;const r=a8(t),o=pe.useMemo(()=>{if(n||"undefined"==typeof window||void 0===window.MutationObserver)return;const{MutationObserver:e}=window;return new e(r)},[r,n]);return pe.useEffect(()=>()=>null==o?void 0:o.disconnect(),[o]),o}({callback(t){if(e)for(const n of t){const{type:t,target:r}=n;if("childList"===t&&r instanceof HTMLElement&&r.contains(e)){i();break}}}}),a=z9({callback:i});return s8(()=>{i(),e?(null==a||a.observe(e),null==s||s.observe(document.body,{childList:!0,subtree:!0})):(null==a||a.disconnect(),null==s||s.disconnect())},[e]),r}const V9=[];function W9(e,t){void 0===t&&(t=[]);const n=pe.useRef(null);return pe.useEffect(()=>{n.current=null},t),pe.useEffect(()=>{const t=e!==F8;t&&!n.current&&(n.current=e),!t&&n.current&&(n.current=null)},[e]),n.current?g8(e,n.current):F8}function $9(e){return pe.useMemo(()=>e?function(e){const t=e.innerWidth,n=e.innerHeight;return{top:0,left:0,right:t,bottom:n,width:t,height:n}}(e):null,[e])}const K9=[];function X9(e){let{measure:t}=e;const[n,r]=pe.useState(null),o=z9({callback:pe.useCallback(e=>{for(const{target:n}of e)if(r8(n)){r(e=>{const r=t(n);return e?{...e,width:r.width,height:r.height}:r});break}},[t])}),i=pe.useCallback(e=>{const n=function(e){if(!e)return null;if(e.children.length>1)return e;const t=e.children[0];return r8(t)?t:e}(e);null==o||o.disconnect(),n&&(null==o||o.observe(n)),r(n?t(n):null)},[t,o]),[s,a]=u8(i);return pe.useMemo(()=>({nodeRef:s,rect:n,setRef:a}),[n,s,a])}const Y9=[{sensor:E9,options:{}},{sensor:w9,options:{}}],q9={current:{}},J9={draggable:{measure:K8},droppable:{measure:K8,strategy:O9.WhileDragging,frequency:N9.Optimized},dragOverlay:{measure:$8}};class Z9 extends Map{get(e){var t;return null!=e&&null!=(t=super.get(e))?t:void 0}toArray(){return Array.from(this.values())}getEnabled(){return this.toArray().filter(e=>{let{disabled:t}=e;return!t})}getNodeFor(e){var t,n;return null!=(t=null==(n=this.get(e))?void 0:n.node.current)?t:void 0}}const e7={activatorEvent:null,active:null,activeNode:null,activeNodeRect:null,collisions:null,containerNodeRect:null,draggableNodes:new Map,droppableRects:new Map,droppableContainers:new Z9,over:null,dragOverlay:{nodeRef:{current:null},rect:null,setRef:T8},scrollableAncestors:[],scrollableAncestorRects:[],measuringConfiguration:J9,measureDroppableContainers:T8,windowRect:null,measuringScheduled:!1},t7={activatorEvent:null,activators:[],active:null,activeNodeRect:null,ariaDescribedById:{draggable:""},dispatch:T8,draggableNodes:new Map,over:null,measureDroppableContainers:T8},n7=pe.createContext(t7),r7=pe.createContext(e7);function o7(){return{draggable:{active:null,initialCoordinates:{x:0,y:0},nodes:new Map,translate:{x:0,y:0}},droppable:{containers:new Z9}}}function i7(e,t){switch(t.type){case R8.DragStart:return{...e,draggable:{...e.draggable,initialCoordinates:t.initialCoordinates,active:t.active}};case R8.DragMove:return null==e.draggable.active?e:{...e,draggable:{...e.draggable,translate:{x:t.coordinates.x-e.draggable.initialCoordinates.x,y:t.coordinates.y-e.draggable.initialCoordinates.y}}};case R8.DragEnd:case R8.DragCancel:return{...e,draggable:{...e.draggable,active:null,initialCoordinates:{x:0,y:0},translate:{x:0,y:0}}};case R8.RegisterDroppable:{const{element:n}=t,{id:r}=n,o=new Z9(e.droppable.containers);return o.set(r,n),{...e,droppable:{...e.droppable,containers:o}}}case R8.SetDroppableDisabled:{const{id:n,key:r,disabled:o}=t,i=e.droppable.containers.get(n);if(!i||r!==i.key)return e;const s=new Z9(e.droppable.containers);return s.set(n,{...i,disabled:o}),{...e,droppable:{...e.droppable,containers:s}}}case R8.UnregisterDroppable:{const{id:n,key:r}=t,o=e.droppable.containers.get(n);if(!o||r!==o.key)return e;const i=new Z9(e.droppable.containers);return i.delete(n),{...e,droppable:{...e.droppable,containers:i}}}default:return e}}function s7(e){let{disabled:t}=e;const{active:n,activatorEvent:r,draggableNodes:o}=pe.useContext(n7),i=d8(r),s=d8(null==n?void 0:n.id);return pe.useEffect(()=>{if(!t&&!r&&i&&null!=s){if(!m8(i))return;if(document.activeElement===i.target)return;const e=o.get(s);if(!e)return;const{activatorNode:t,node:n}=e;if(!t.current&&!n.current)return;requestAnimationFrame(()=>{for(const e of[t.current,n.current]){if(!e)continue;const t=w8(e);if(t){t.focus();break}}})}},[r,t,o,s,i]),null}const a7=pe.createContext({...F8,scaleX:1,scaleY:1});var l7,c7;(c7=l7||(l7={}))[c7.Uninitialized=0]="Uninitialized",c7[c7.Initializing=1]="Initializing",c7[c7.Initialized=2]="Initialized";const u7=pe.memo(function(e){var t,n,r,o;let{id:i,accessibility:s,autoScroll:a=!0,children:l,sensors:c=Y9,collisionDetection:u=z8,measuring:d,modifiers:A,...h}=e;const p=pe.useReducer(i7,void 0,o7),[f,g]=p,[m,y]=function(){const[e]=pe.useState(()=>new Set),t=pe.useCallback(t=>(e.add(t),()=>e.delete(t)),[e]);return[pe.useCallback(t=>{let{type:n,event:r}=t;e.forEach(e=>{var t;return null==(t=e[n])?void 0:t.call(e,r)})},[e]),t]}(),[v,b]=pe.useState(l7.Uninitialized),w=v===l7.Initialized,{draggable:{active:x,nodes:_,translate:C},droppable:{containers:S}}=f,E=null!=x?_.get(x):null,B=pe.useRef({initial:null,translated:null}),I=pe.useMemo(()=>{var e;return null!=x?{id:x,data:null!=(e=null==E?void 0:E.data)?e:q9,rect:B}:null},[x,E]),R=pe.useRef(null),[k,T]=pe.useState(null),[P,F]=pe.useState(null),M=l8(h,Object.values(h)),L=h8("DndDescribedBy",i),U=pe.useMemo(()=>S.getEnabled(),[S]),O=function(e){return pe.useMemo(()=>({draggable:{...J9.draggable,...null==e?void 0:e.draggable},droppable:{...J9.droppable,...null==e?void 0:e.droppable},dragOverlay:{...J9.dragOverlay,...null==e?void 0:e.dragOverlay}}),[null==e?void 0:e.draggable,null==e?void 0:e.droppable,null==e?void 0:e.dragOverlay])}(d),{droppableRects:D,measureDroppableContainers:N,measuringScheduled:j}=function(e,t){let{dragging:n,dependencies:r,config:o}=t;const[i,s]=pe.useState(null),{frequency:a,measure:l,strategy:c}=o,u=pe.useRef(e),d=function(){switch(c){case O9.Always:return!1;case O9.BeforeDragging:return n;default:return!n}}(),A=l8(d),h=pe.useCallback(function(e){void 0===e&&(e=[]),A.current||s(t=>null===t?e:t.concat(e.filter(e=>!t.includes(e))))},[A]),p=pe.useRef(null),f=c8(t=>{if(d&&!n)return j9;if(!t||t===j9||u.current!==e||null!=i){const t=new Map;for(let n of e){if(!n)continue;if(i&&i.length>0&&!i.includes(n.id)&&n.rect.current){t.set(n.id,n.rect.current);continue}const e=n.node.current,r=e?new u9(l(e),e):null;n.rect.current=r,r&&t.set(n.id,r)}return t}return t},[e,i,n,d,l]);return pe.useEffect(()=>{u.current=e},[e]),pe.useEffect(()=>{d||h()},[n,d]),pe.useEffect(()=>{i&&i.length>0&&s(null)},[JSON.stringify(i)]),pe.useEffect(()=>{d||"number"!=typeof a||null!==p.current||(p.current=setTimeout(()=>{h(),p.current=null},a))},[a,d,h,...r]),{droppableRects:f,measureDroppableContainers:h,measuringScheduled:null!=i}}(U,{dragging:w,dependencies:[C.x,C.y],config:O.droppable}),Q=function(e,t){const n=null!=t?e.get(t):void 0,r=n?n.node.current:null;return c8(e=>{var n;return null==t?null:null!=(n=null!=r?r:e)?n:null},[r,t])}(_,x),z=pe.useMemo(()=>P?y8(P):null,[P]),H=function(){const e=!1===(null==k?void 0:k.autoScrollEnabled),t="object"==typeof a?!1===a.enabled:!1===a,n=w&&!e&&!t;if("object"==typeof a)return{...a,enabled:n};return{enabled:n}}(),G=function(e,t){return Q9(e,t)}(Q,O.draggable.measure);!function(e){let{activeNode:t,measure:n,initialRect:r,config:o=!0}=e;const i=pe.useRef(!1),{x:s,y:a}="boolean"==typeof o?{x:o,y:o}:o;s8(()=>{if(!s&&!a||!t)return void(i.current=!1);if(i.current||!r)return;const e=null==t?void 0:t.node.current;if(!e||!1===e.isConnected)return;const o=H8(n(e),r);if(s||(o.x=0),a||(o.y=0),i.current=!0,Math.abs(o.x)>0||Math.abs(o.y)>0){const t=Y8(e);t&&t.scrollBy({top:o.y,left:o.x})}},[t,s,a,r,n])}({activeNode:null!=x?_.get(x):null,config:H.layoutShiftCompensation,initialRect:G,measure:O.draggable.measure});const V=G9(Q,O.draggable.measure,G),W=G9(Q?Q.parentElement:null),$=pe.useRef({activatorEvent:null,active:null,activeNode:Q,collisionRect:null,collisions:null,droppableRects:D,draggableNodes:_,draggingNode:null,draggingNodeRect:null,droppableContainers:S,over:null,scrollableAncestors:[],scrollAdjustedTranslate:null}),K=S.getNodeFor(null==(t=$.current.over)?void 0:t.id),X=X9({measure:O.dragOverlay.measure}),Y=null!=(n=X.nodeRef.current)?n:Q,q=w?null!=(r=X.rect)?r:V:null,J=Boolean(X.nodeRef.current&&X.rect),Z=H8(ee=J?null:V,Q9(ee));var ee;const te=$9(Y?t8(Y):null),ne=function(e){const t=pe.useRef(e),n=c8(n=>e?n&&n!==V9&&e&&t.current&&e.parentNode===t.current.parentNode?n:X8(e):V9,[e]);return pe.useEffect(()=>{t.current=e},[e]),n}(w?null!=K?K:Q:null),re=function(e,t){void 0===t&&(t=$8);const[n]=e,r=$9(n?t8(n):null),[o,i]=pe.useState(K9);function s(){i(()=>e.length?e.map(e=>r9(e)?r:new u9(t(e),e)):K9)}const a=z9({callback:s});return s8(()=>{null==a||a.disconnect(),s(),e.forEach(e=>null==a?void 0:a.observe(e))},[e]),o}(ne),oe=function(e,t){let{transform:n,...r}=t;return null!=e&&e.length?e.reduce((e,t)=>t({transform:e,...r}),n):n}(A,{transform:{x:C.x-Z.x,y:C.y-Z.y,scaleX:1,scaleY:1},activatorEvent:P,active:I,activeNodeRect:V,containerNodeRect:W,draggingNodeRect:q,over:$.current.over,overlayNodeRect:X.rect,scrollableAncestors:ne,scrollableAncestorRects:re,windowRect:te}),ie=z?f8(z,C):null,se=function(e){const[t,n]=pe.useState(null),r=pe.useRef(e),o=pe.useCallback(e=>{const t=q8(e.target);t&&n(e=>e?(e.set(t,e9(t)),new Map(e)):null)},[]);return pe.useEffect(()=>{const t=r.current;if(e!==t){i(t);const s=e.map(e=>{const t=q8(e);return t?(t.addEventListener("scroll",o,{passive:!0}),[t,e9(t)]):null}).filter(e=>null!=e);n(s.length?new Map(s):null),r.current=e}return()=>{i(e),i(t)};function i(e){e.forEach(e=>{const t=q8(e);null==t||t.removeEventListener("scroll",o)})}},[o,e]),pe.useMemo(()=>e.length?t?Array.from(t.values()).reduce((e,t)=>f8(e,t),F8):l9(e):F8,[e,t])}(ne),ae=W9(se),le=W9(se,[V]),ce=f8(oe,ae),ue=q?V8(q,oe):null,de=I&&ue?u({active:I,collisionRect:ue,droppableRects:D,droppableContainers:U,pointerCoordinates:ie}):null,Ae=D8(de,"id"),[he,ge]=pe.useState(null),me=function(e,t,n){return{...e,scaleX:t&&n?t.width/n.width:1,scaleY:t&&n?t.height/n.height:1}}(J?oe:f8(oe,le),null!=(o=null==he?void 0:he.rect)?o:null,V),ye=pe.useRef(null),ve=pe.useCallback((e,t)=>{let{sensor:n,options:r}=t;if(null==R.current)return;const o=_.get(R.current);if(!o)return;const i=e.nativeEvent,s=new n({active:R.current,activeNode:o,event:i,options:r,context:$,onAbort(e){if(!_.get(e))return;const{onDragAbort:t}=M.current,n={id:e};null==t||t(n),m({type:"onDragAbort",event:n})},onPending(e,t,n,r){if(!_.get(e))return;const{onDragPending:o}=M.current,i={id:e,constraint:t,initialCoordinates:n,offset:r};null==o||o(i),m({type:"onDragPending",event:i})},onStart(e){const t=R.current;if(null==t)return;const n=_.get(t);if(!n)return;const{onDragStart:r}=M.current,o={activatorEvent:i,active:{id:t,data:n.data,rect:B}};wu.unstable_batchedUpdates(()=>{null==r||r(o),b(l7.Initializing),g({type:R8.DragStart,initialCoordinates:e,active:t}),m({type:"onDragStart",event:o}),T(ye.current),F(i)})},onMove(e){g({type:R8.DragMove,coordinates:e})},onEnd:a(R8.DragEnd),onCancel:a(R8.DragCancel)});function a(e){return async function(){const{active:t,collisions:n,over:r,scrollAdjustedTranslate:o}=$.current;let s=null;if(t&&o){const{cancelDrop:a}=M.current;if(s={activatorEvent:i,active:t,collisions:n,delta:o,over:r},e===R8.DragEnd&&"function"==typeof a){await Promise.resolve(a(s))&&(e=R8.DragCancel)}}R.current=null,wu.unstable_batchedUpdates(()=>{g({type:e}),b(l7.Uninitialized),ge(null),T(null),F(null),ye.current=null;const t=e===R8.DragEnd?"onDragEnd":"onDragCancel";if(s){const e=M.current[t];null==e||e(s),m({type:t,event:s})}})}}ye.current=s},[_]),be=function(e,t){return pe.useMemo(()=>e.reduce((e,n)=>{const{sensor:r}=n;return[...e,...r.activators.map(e=>({eventName:e.eventName,handler:t(e.handler,n)}))]},[]),[e,t])}(c,pe.useCallback((e,t)=>(n,r)=>{const o=n.nativeEvent,i=_.get(r);if(null!==R.current||!i||o.dndKit||o.defaultPrevented)return;const s={active:i};!0===e(n,t.options,s)&&(o.dndKit={capturedBy:t.sensor},R.current=r,ve(n,t))},[_,ve]));!function(e){pe.useEffect(()=>{if(!J6)return;const t=e.map(e=>{let{sensor:t}=e;return null==t.setup?void 0:t.setup()});return()=>{for(const e of t)null==e||e()}},e.map(e=>{let{sensor:t}=e;return t}))}(c),s8(()=>{V&&v===l7.Initializing&&b(l7.Initialized)},[V,v]),pe.useEffect(()=>{const{onDragMove:e}=M.current,{active:t,activatorEvent:n,collisions:r,over:o}=$.current;if(!t||!n)return;const i={active:t,activatorEvent:n,collisions:r,delta:{x:ce.x,y:ce.y},over:o};wu.unstable_batchedUpdates(()=>{null==e||e(i),m({type:"onDragMove",event:i})})},[ce.x,ce.y]),pe.useEffect(()=>{const{active:e,activatorEvent:t,collisions:n,droppableContainers:r,scrollAdjustedTranslate:o}=$.current;if(!e||null==R.current||!t||!o)return;const{onDragOver:i}=M.current,s=r.get(Ae),a=s&&s.rect.current?{id:s.id,rect:s.rect.current,data:s.data,disabled:s.disabled}:null,l={active:e,activatorEvent:t,collisions:n,delta:{x:o.x,y:o.y},over:a};wu.unstable_batchedUpdates(()=>{ge(a),null==i||i(l),m({type:"onDragOver",event:l})})},[Ae]),s8(()=>{$.current={activatorEvent:P,active:I,activeNode:Q,collisionRect:ue,collisions:de,droppableRects:D,draggableNodes:_,draggingNode:Y,draggingNodeRect:q,droppableContainers:S,over:he,scrollableAncestors:ne,scrollAdjustedTranslate:ce},B.current={initial:q,translated:ue}},[I,Q,de,ue,_,Y,q,D,S,he,ne,ce]),L9({...H,delta:C,draggingRect:ue,pointerCoordinates:ie,scrollableAncestors:ne,scrollableAncestorRects:re});const we=pe.useMemo(()=>({active:I,activeNode:Q,activeNodeRect:V,activatorEvent:P,collisions:de,containerNodeRect:W,dragOverlay:X,draggableNodes:_,droppableContainers:S,droppableRects:D,over:he,measureDroppableContainers:N,scrollableAncestors:ne,scrollableAncestorRects:re,measuringConfiguration:O,measuringScheduled:j,windowRect:te}),[I,Q,V,P,de,W,X,_,S,D,he,N,ne,re,O,j,te]),xe=pe.useMemo(()=>({activatorEvent:P,activators:be,active:I,activeNodeRect:V,ariaDescribedById:{draggable:L},dispatch:g,draggableNodes:_,over:he,measureDroppableContainers:N}),[P,be,I,V,g,L,_,he,N]);return fe.createElement(S8.Provider,{value:y},fe.createElement(n7.Provider,{value:xe},fe.createElement(r7.Provider,{value:we},fe.createElement(a7.Provider,{value:me},l)),fe.createElement(s7,{disabled:!1===(null==s?void 0:s.restoreFocus)})),fe.createElement(I8,{...s,hiddenTextDescribedById:L}))}),d7=pe.createContext(null),A7="button";function h7(e){let{id:t,data:n,disabled:r=!1,attributes:o}=e;const i=h8("Draggable"),{activators:s,activatorEvent:a,active:l,activeNodeRect:c,ariaDescribedById:u,draggableNodes:d,over:A}=pe.useContext(n7),{role:h=A7,roleDescription:p="draggable",tabIndex:f=0}=null!=o?o:{},g=(null==l?void 0:l.id)===t,m=pe.useContext(g?a7:d7),[y,v]=u8(),[b,w]=u8(),x=function(e,t){return pe.useMemo(()=>e.reduce((e,n)=>{let{eventName:r,handler:o}=n;return e[r]=e=>{o(e,t)},e},{}),[e,t])}(s,t),_=l8(n);s8(()=>(d.set(t,{id:t,key:i,node:y,activatorNode:b,data:_}),()=>{const e=d.get(t);e&&e.key===i&&d.delete(t)}),[d,t]);return{active:l,activatorEvent:a,activeNodeRect:c,attributes:pe.useMemo(()=>({role:h,tabIndex:f,"aria-disabled":r,"aria-pressed":!(!g||h!==A7)||void 0,"aria-roledescription":p,"aria-describedby":u.draggable}),[r,h,f,g,p,u.draggable]),isDragging:g,listeners:r?void 0:x,node:y,over:A,setNodeRef:v,setActivatorNodeRef:w,transform:m}}const p7={timeout:25};function f7(e,t,n){const r=e.slice();return r.splice(n<0?r.length+n:n,0,r.splice(t,1)[0]),r}function g7(e,t){return e.reduce((e,n,r)=>{const o=t.get(n);return o&&(e[r]=o),e},Array(e.length))}function m7(e){return null!==e&&e>=0}const y7=e=>{let{rects:t,activeIndex:n,overIndex:r,index:o}=e;const i=f7(t,r,n),s=t[o],a=i[o];return a&&s?{x:a.left-s.left,y:a.top-s.top,scaleX:a.width/s.width,scaleY:a.height/s.height}:null},v7={scaleX:1,scaleY:1},b7=e=>{var t;let{activeIndex:n,activeNodeRect:r,index:o,rects:i,overIndex:s}=e;const a=null!=(t=i[n])?t:r;if(!a)return null;if(o===n){const e=i[s];return e?{x:0,y:n<s?e.top+e.height-(a.top+a.height):e.top-a.top,...v7}:null}const l=function(e,t,n){const r=e[t],o=e[t-1],i=e[t+1];if(!r)return 0;if(n<t)return o?r.top-(o.top+o.height):i?i.top-(r.top+r.height):0;return i?i.top-(r.top+r.height):o?r.top-(o.top+o.height):0}(i,o,n);return o>n&&o<=s?{x:0,y:-a.height-l,...v7}:o<n&&o>=s?{x:0,y:a.height+l,...v7}:{x:0,y:0,...v7}};const w7="Sortable",x7=fe.createContext({activeIndex:-1,containerId:w7,disableTransforms:!1,items:[],overIndex:-1,useDragOverlay:!1,sortedRects:[],strategy:y7,disabled:{draggable:!1,droppable:!1}});function _7(e){let{children:t,id:n,items:r,strategy:o=y7,disabled:i=!1}=e;const{active:s,dragOverlay:a,droppableRects:l,over:c,measureDroppableContainers:u}=pe.useContext(r7),d=h8(w7,n),A=Boolean(null!==a.rect),h=pe.useMemo(()=>r.map(e=>"object"==typeof e&&"id"in e?e.id:e),[r]),p=null!=s,f=s?h.indexOf(s.id):-1,g=c?h.indexOf(c.id):-1,m=pe.useRef(h),y=!function(e,t){if(e===t)return!0;if(e.length!==t.length)return!1;for(let n=0;n<e.length;n++)if(e[n]!==t[n])return!1;return!0}(h,m.current),v=-1!==g&&-1===f||y,b=function(e){return"boolean"==typeof e?{draggable:e,droppable:e}:e}(i);s8(()=>{y&&p&&u(h)},[y,h,p,u]),pe.useEffect(()=>{m.current=h},[h]);const w=pe.useMemo(()=>({activeIndex:f,containerId:d,disabled:b,disableTransforms:v,items:h,overIndex:g,useDragOverlay:A,sortedRects:g7(h,l),strategy:o}),[f,d,b.draggable,b.droppable,v,h,g,l,A,o]);return fe.createElement(x7.Provider,{value:w},t)}const C7=e=>{let{id:t,items:n,activeIndex:r,overIndex:o}=e;return f7(n,r,o).indexOf(t)},S7=e=>{let{containerId:t,isSorting:n,wasDragging:r,index:o,items:i,newIndex:s,previousItems:a,previousContainerId:l,transition:c}=e;return!(!c||!r)&&((a===i||o!==s)&&(!!n||s!==o&&t===l))},E7={duration:200,easing:"ease"},B7="transform",I7=v8.Transition.toString({property:B7,duration:0,easing:"linear"}),R7={roleDescription:"sortable"};function k7(e){let{animateLayoutChanges:t=S7,attributes:n,disabled:r,data:o,getNewIndex:i=C7,id:s,strategy:a,resizeObserverConfig:l,transition:c=E7}=e;const{items:u,containerId:d,activeIndex:A,disabled:h,disableTransforms:p,sortedRects:f,overIndex:g,useDragOverlay:m,strategy:y}=pe.useContext(x7),v=function(e,t){var n,r;if("boolean"==typeof e)return{draggable:e,droppable:!1};return{draggable:null!=(n=null==e?void 0:e.draggable)?n:t.draggable,droppable:null!=(r=null==e?void 0:e.droppable)?r:t.droppable}}(r,h),b=u.indexOf(s),w=pe.useMemo(()=>({sortable:{containerId:d,index:b,items:u},...o}),[d,o,b,u]),x=pe.useMemo(()=>u.slice(u.indexOf(s)),[u,s]),{rect:_,node:C,isOver:S,setNodeRef:E}=function(e){let{data:t,disabled:n=!1,id:r,resizeObserverConfig:o}=e;const i=h8("Droppable"),{active:s,dispatch:a,over:l,measureDroppableContainers:c}=pe.useContext(n7),u=pe.useRef({disabled:n}),d=pe.useRef(!1),A=pe.useRef(null),h=pe.useRef(null),{disabled:p,updateMeasurementsFor:f,timeout:g}={...p7,...o},m=l8(null!=f?f:r),y=z9({callback:pe.useCallback(()=>{d.current?(null!=h.current&&clearTimeout(h.current),h.current=setTimeout(()=>{c(Array.isArray(m.current)?m.current:[m.current]),h.current=null},g)):d.current=!0},[g]),disabled:p||!s}),v=pe.useCallback((e,t)=>{y&&(t&&(y.unobserve(t),d.current=!1),e&&y.observe(e))},[y]),[b,w]=u8(v),x=l8(t);return pe.useEffect(()=>{y&&b.current&&(y.disconnect(),d.current=!1,y.observe(b.current))},[b,y]),pe.useEffect(()=>(a({type:R8.RegisterDroppable,element:{id:r,key:i,disabled:n,node:b,rect:A,data:x}}),()=>a({type:R8.UnregisterDroppable,key:i,id:r})),[r]),pe.useEffect(()=>{n!==u.current.disabled&&(a({type:R8.SetDroppableDisabled,id:r,key:i,disabled:n}),u.current.disabled=n)},[r,i,n,a]),{active:s,rect:A,isOver:(null==l?void 0:l.id)===r,node:b,over:l,setNodeRef:w}}({id:s,data:w,disabled:v.droppable,resizeObserverConfig:{updateMeasurementsFor:x,...l}}),{active:B,activatorEvent:I,activeNodeRect:R,attributes:k,setNodeRef:T,listeners:P,isDragging:F,over:M,setActivatorNodeRef:L,transform:U}=h7({id:s,data:w,attributes:{...R7,...n},disabled:v.draggable}),O=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return pe.useMemo(()=>e=>{t.forEach(t=>t(e))},t)}(E,T),D=Boolean(B),N=D&&!p&&m7(A)&&m7(g),j=!m&&F,Q=j&&N?U:null,z=N?null!=Q?Q:(null!=a?a:y)({rects:f,activeNodeRect:R,activeIndex:A,overIndex:g,index:b}):null,H=m7(A)&&m7(g)?i({id:s,items:u,activeIndex:A,overIndex:g}):b,G=null==B?void 0:B.id,V=pe.useRef({activeId:G,items:u,newIndex:H,containerId:d}),W=u!==V.current.items,$=t({active:B,containerId:d,isDragging:F,isSorting:D,id:s,index:b,items:u,newIndex:V.current.newIndex,previousItems:V.current.items,previousContainerId:V.current.containerId,transition:c,wasDragging:null!=V.current.activeId}),K=function(e){let{disabled:t,index:n,node:r,rect:o}=e;const[i,s]=pe.useState(null),a=pe.useRef(n);return s8(()=>{if(!t&&n!==a.current&&r.current){const e=o.current;if(e){const t=$8(r.current,{ignoreTransform:!0}),n={x:e.left-t.left,y:e.top-t.top,scaleX:e.width/t.width,scaleY:e.height/t.height};(n.x||n.y)&&s(n)}}n!==a.current&&(a.current=n)},[t,n,r,o]),pe.useEffect(()=>{i&&s(null)},[i]),i}({disabled:!$,index:b,node:C,rect:_});return pe.useEffect(()=>{D&&V.current.newIndex!==H&&(V.current.newIndex=H),d!==V.current.containerId&&(V.current.containerId=d),u!==V.current.items&&(V.current.items=u)},[D,H,d,u]),pe.useEffect(()=>{if(G===V.current.activeId)return;if(null!=G&&null==V.current.activeId)return void(V.current.activeId=G);const e=setTimeout(()=>{V.current.activeId=G},50);return()=>clearTimeout(e)},[G]),{active:B,activeIndex:A,attributes:k,data:w,rect:_,index:b,newIndex:H,items:u,isOver:S,isSorting:D,isDragging:F,listeners:P,node:C,overIndex:g,over:M,setNodeRef:O,setActivatorNodeRef:L,setDroppableNodeRef:E,setDraggableNodeRef:T,transform:null!=K?K:z,transition:function(){if(K||W&&V.current.newIndex===b)return I7;if(j&&!m8(I)||!c)return;if(D||$)return v8.Transition.toString({...c,property:B7});return}()}}function T7(e){if(!e)return!1;const t=e.data.current;return!!(t&&"sortable"in t&&"object"==typeof t.sortable&&"containerId"in t.sortable&&"items"in t.sortable&&"index"in t.sortable)}const P7=[f9.Down,f9.Right,f9.Up,f9.Left],F7=(e,t)=>{let{context:{active:n,collisionRect:r,droppableRects:o,droppableContainers:i,over:s,scrollableAncestors:a}}=t;if(P7.includes(e.code)){if(e.preventDefault(),!n||!r)return;const t=[];i.getEnabled().forEach(n=>{if(!n||null!=n&&n.disabled)return;const i=o.get(n.id);if(i)switch(e.code){case f9.Down:r.top<i.top&&t.push(n);break;case f9.Up:r.top>i.top&&t.push(n);break;case f9.Left:r.left>i.left&&t.push(n);break;case f9.Right:r.left<i.left&&t.push(n)}});const l=(e=>{let{collisionRect:t,droppableRects:n,droppableContainers:r}=e;const o=O8(t),i=[];for(const s of r){const{id:e}=s,t=n.get(e);if(t){const n=O8(t),r=o.reduce((e,t,r)=>e+M8(n[r],t),0),a=Number((r/4).toFixed(4));i.push({id:e,data:{droppableContainer:s,value:a}})}}return i.sort(L8)})({collisionRect:r,droppableRects:o,droppableContainers:t});let c=D8(l,"id");if(c===(null==s?void 0:s.id)&&l.length>1&&(c=l[1].id),null!=c){const e=i.get(n.id),t=i.get(c),s=t?o.get(t.id):null,l=null==t?void 0:t.node.current;if(l&&s&&e&&t){const n=X8(l).some((e,t)=>a[t]!==e),o=M7(e,t),i=function(e,t){if(!T7(e)||!T7(t))return!1;if(!M7(e,t))return!1;return e.data.current.sortable.index<t.data.current.sortable.index}(e,t),c=n||!o?{x:0,y:0}:{x:i?r.width-s.width:0,y:i?r.height-s.height:0},u={x:s.left,y:s.top};return c.x&&c.y?u:g8(u,c)}}}};function M7(e,t){return!(!T7(e)||!T7(t))&&e.data.current.sortable.containerId===t.data.current.sortable.containerId}const L7=({point:e,index:t,total:n,onRemove:r,onRef:o})=>{const{attributes:i,listeners:a,setNodeRef:l,transform:c,transition:u,isDragging:d}=k7({id:e.id}),A=fe.useCallback(t=>{l(t),o&&o(e.id,t)},[l,o,e.id]),[h,p]=fe.useState(!1),f=fe.useRef(null),g={transform:v8.Transform.toString(c),transition:u,opacity:d?.5:1};let m="";m=0===t?"Origin":t===n-1?"Destination":`Waypoint ${t}`;const y=fe.useCallback(()=>{const t=`${e.coordinates.lat.toFixed(6)}, ${e.coordinates.lng.toFixed(6)}`;navigator.clipboard.writeText(t).then(()=>{p(!0),f.current&&clearTimeout(f.current),f.current=setTimeout(()=>{p(!1)},1500)})},[e.coordinates]);return fe.useEffect(()=>()=>{f.current&&clearTimeout(f.current)},[]),s.jsxs(Mm,{ref:A,style:g,secondaryAction:s.jsxs(rf,{sx:{display:"flex",alignItems:"center",gap:.5},children:[s.jsx(tA,{size:"small",onClick:y,sx:{color:"#5f6368","&:hover":{backgroundColor:"#f1f3f4"}},title:"Copy coordinates",children:h?s.jsx(xX,{sx:{fontSize:16}}):s.jsx(TX,{sx:{fontSize:16}})}),s.jsx(tA,{size:"small",onClick:()=>r(e.id),sx:{color:"#5f6368","&:hover":{backgroundColor:"#fce8e6",color:"#d93025"}},children:s.jsx(MX,{sx:{fontSize:16}})})]}),sx:{px:2.5,py:1.25,borderBottom:"1px solid #f1f3f4","&:hover":{backgroundColor:"#f8f9fa"},"&:last-child":{borderBottom:"none"},transition:"background-color 0.15s ease"},children:[s.jsx(Dm,{...i,...a,style:{cursor:d?"grabbing":"grab"},sx:{minWidth:"32px"},children:s.jsx(UX,{fontSize:"small",sx:{color:"#9aa0a6",fontSize:"18px"}})}),s.jsxs(rf,{sx:{display:"flex",alignItems:"center",gap:1.5,width:"100%"},children:[s.jsx(rf,{sx:{display:"flex",alignItems:"center",justifyContent:"center",width:"24px",height:"24px",borderRadius:"50%",backgroundColor:0===t?"#e3f2fd":t===n-1?"#ffebee":"#f1f3f4",color:0===t?"#1976d2":t===n-1?"#c62828":"#5f6368",fontSize:"0.688rem",fontWeight:600,flexShrink:0,fontFamily:'"Google Sans", sans-serif'},children:0===t?s.jsx(nY,{sx:{fontSize:"14px"}}):t===n-1?s.jsx(tY,{sx:{fontSize:"14px"}}):t}),s.jsx(vA,{variant:"body2",sx:{fontSize:"0.813rem",fontWeight:500,color:"#202124",fontFamily:'"Google Sans", sans-serif',letterSpacing:"-0.01em"},children:m})]})]})},U7=({className:e,style:t,dynamicIslandHeight:n,onClose:r,onContinue:o,pointRefs:i,pointsScrollContainerRef:a})=>{const l=q5(),c=$N(e=>e.individualRoute),u=$N(e=>e.removePoint),d=$N(e=>e.reorderPoints),A=JN(e=>e.routes),h=pe.useMemo(()=>{if(!c.routeUUID||!c.generatedRoute)return null;const e=A.find(e=>e.id===c.routeUUID);if(!e||"uploaded"!==e.type||!e.originalRouteGeoJson)return null;if(!c.generatedRoute.encodedPolyline)return null;try{const t=Sw(c.generatedRoute.encodedPolyline);if("LineString"===t.type){const n=m5(e.originalRouteGeoJson,t);return Math.max(0,Math.min(100,n))}}catch(t){}return null},[c.routeUUID,c.generatedRoute,A]),p=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return pe.useMemo(()=>[...t].filter(e=>null!=e),[...t])}(P8(E9),P8(w9,{coordinateGetter:F7})),f=pe.useMemo(()=>c.generatedRoute?.encodedPolyline?Cw(c.generatedRoute.encodedPolyline):null,[c.generatedRoute?.encodedPolyline])??c.generatedRoute?.distance??0,g=Boolean(c.generatedRoute?.encodedPolyline),m=c.points.length>=2&&g&&!c.validationError&&!c.isGenerating,y=s.jsxs(rf,{className:"flex flex-col gap-1",children:[s.jsx(vA,{variant:"h6",component:"div",title:c.originalRouteName||"New Route",className:"text-lg font-medium text-gray-900 leading-[1.2] overflow-hidden text-ellipsis whitespace-nowrap max-w-[200px]",sx:{fontFamily:'"Google Sans", sans-serif'},children:c.originalRouteName||"New Route"}),c.points.length>0&&s.jsxs(rf,{className:"flex items-center gap-3",children:[s.jsxs(vA,{variant:"body2",className:"text-[0.813rem] font-medium text-[#5f6368]",sx:{fontFamily:'"Google Sans", sans-serif'},children:[c.points.length," ",1===c.points.length?"point":"points"]}),s.jsx(vA,{variant:"body2",className:"text-[0.813rem] font-medium text-[#5f6368]",sx:{fontFamily:'"Google Sans", sans-serif'},children:Y5(f||0,l)}),null!==h&&s.jsxs(vA,{variant:"body2",className:"text-[0.813rem] font-medium",sx:{fontFamily:'"Google Sans", sans-serif',color:h>=80?"#2e7d32":h>=60?"#e65100":"#c62828"},children:[Math.round(h),"% match"]})]})]});return s.jsx(e6,{className:e,style:t,dynamicIslandHeight:n,title:y,onClose:r,footer:s.jsx(rf,{sx:{p:2,px:3},children:s.jsx(Nv,{variant:"contained",disabled:!m,fullWidth:!0,size:"small",onClick:o,sx:{py:1,fontSize:"0.813rem",minHeight:"36px"},children:"Continue"})}),children:s.jsx(rf,{ref:a,className:"px-5 "+(c.points.length>0?"max-h-[400px] overflow-y-auto py-4":"overflow-y-visible py-8"),children:0===c.points.length?s.jsxs(rf,{className:"flex flex-col items-center justify-center py-16 px-8 text-center",children:[s.jsx(rf,{className:"w-16 h-16 rounded-full bg-gray-100 flex items-center justify-center mb-8",children:s.jsx(tY,{className:"text-[32px] text-[#5f6368] opacity-60",sx:{fontSize:"32px"}})}),s.jsx(vA,{variant:"body1",className:"text-[0.938rem] font-medium text-[#202124] mb-4",sx:{fontFamily:'"Google Sans", sans-serif'},children:"No points added yet"}),s.jsx(vA,{variant:"body2",className:"text-[0.813rem] text-[#5f6368] leading-6 max-w-[240px]",sx:{fontFamily:'"Google Sans", sans-serif'},children:"Click on the map to add your first point and start creating your route"})]}):s.jsx(u7,{sensors:p,collisionDetection:j8,onDragEnd:e=>{const{active:t,over:n}=e;n&&t.id!==n.id&&d(t.id,n.id)},children:s.jsx(_7,{items:c.points.map(e=>e.id),strategy:b7,children:s.jsx(_m,{dense:!0,className:"-mx-5 py-0",children:c.points.map((e,t)=>s.jsx(L7,{point:e,index:t,total:c.points.length,onRemove:u,onRef:(e,t)=>{i.current[e]=t}},e.id))})})})})})},O7=({className:e,style:t,dynamicIslandHeight:n,matchPercentage:r,onBack:o,onClose:i,onEnableSegmentation:a,onSave:l})=>s.jsx(e6,{className:e,style:t,dynamicIslandHeight:n,title:"Route Finalized",showBackButton:!0,onBack:o,onClose:i,children:s.jsxs(rf,{sx:{p:3,display:"flex",flexDirection:"column",gap:2.5},children:[void 0!==r&&(()=>{const e=Math.round(r),t=e>=80,n=e>=60&&e<80,o=t?"#e8f5e9":n?"#fff3e0":"#ffebee",i=t?"#2e7d32":n?"#e65100":"#c62828";return s.jsxs(rf,{sx:{display:"flex",alignItems:"center",gap:1.5,padding:"12px 16px",borderRadius:"12px",backgroundColor:o},children:[s.jsx(SX,{sx:{fontSize:20,color:i,flexShrink:0}}),s.jsxs(vA,{sx:{fontSize:"14px",fontFamily:'"Google Sans", sans-serif',fontWeight:400,color:i},children:["Route matches Google Network (",e,"%)."]})]})})(),s.jsxs(rf,{sx:{display:"flex",gap:2,flexDirection:"row"},children:[s.jsxs(rf,{onClick:a,sx:{flex:1,display:"flex",flexDirection:"column",alignItems:"flex-start",gap:1,padding:"14px",borderRadius:"16px",border:"1px solid #e0e0e0",backgroundColor:"#ffffff",cursor:"pointer",transition:"all 0.2s ease","&:hover":{backgroundColor:"#e3f2fd",borderColor:"#1976d2",boxShadow:"0 2px 8px rgba(25, 118, 210, 0.2)","& .segment-icon":{color:"#1976d2"}}},children:[s.jsx(PX,{className:"segment-icon",sx:{fontSize:24,color:"#5f6368",transition:"color 0.2s ease"}}),s.jsx(vA,{sx:{fontSize:"15px",fontFamily:'"Google Sans", sans-serif',fontWeight:500,color:"#111827",lineHeight:1.2},children:"Segment Route"}),s.jsx(vA,{sx:{fontSize:"12px",fontFamily:'"Google Sans", sans-serif',fontWeight:400,color:"#5f6368",lineHeight:1.3},children:"Split into smaller distances for tracking."})]}),s.jsxs(rf,{onClick:l,sx:{flex:1,display:"flex",flexDirection:"column",alignItems:"flex-start",gap:1,padding:"14px",borderRadius:"16px",border:"1px solid #e0e0e0",backgroundColor:"#ffffff",cursor:"pointer",transition:"all 0.2s ease","&:hover":{backgroundColor:"#e3f2fd",borderColor:"#1976d2",boxShadow:"0 2px 8px rgba(25, 118, 210, 0.2)","& .save-icon":{color:"#1976d2"}}},children:[s.jsx(aY,{className:"save-icon",sx:{fontSize:24,color:"#5f6368",transition:"color 0.2s ease"}}),s.jsx(vA,{sx:{fontSize:"15px",fontFamily:'"Google Sans", sans-serif',fontWeight:500,color:"#111827",lineHeight:1.2},children:"Save As Is"}),s.jsx(vA,{sx:{fontSize:"12px",fontFamily:'"Google Sans", sans-serif',fontWeight:400,color:"#5f6368",lineHeight:1.3},children:"Save entire route as a single unit."})]})]})]})}),D7=({className:e,style:t,dynamicIslandHeight:n,routeLength:r,segmentationMode:o,distanceInput:i,segmentNames:a,onBack:l,onClose:c,onSegmentationModeChange:u,onDistanceInputChange:d,onDistanceKmSet:A,onSegmentNameChange:h,onSave:p,onHoveredSegmentIdChange:f})=>{const g=ia(),m=q5(),y=$N(e=>e.segmentation),v=$N(e=>e.individualRoute),[b,w]=fe.useState(!0),[x,_]=fe.useState(null),C=fe.useRef(null),S=fe.useMemo(()=>{const e=y.targetRoute||v.generatedRoute;return e?.encodedPolyline?Cw(e.encodedPolyline):null},[y.targetRoute,v.generatedRoute]),E=y.calculatedRouteLengthKm??S??r,B="miles"===m?J5(50):50,I=E>50,R=$N(e=>e.toggleSegmentSelection),k=$N(e=>e.startSegmentation),T=$N(e=>e.fetchIntersectionsAndCreateSegments),P=$N(e=>e.removeCutPoint),F=$N(e=>e.switchToManualMode),M=$N(e=>e.clearPreviewSegments);fe.useEffect(()=>{"distance"===o&&w(!0)},[o]),fe.useEffect(()=>{"distance"===o&&y.error&&w(!0)},[o,y.error]),fe.useEffect(()=>{"intersections"===o&&0!==y.previewSegments.length||_(null)},[o,y.previewSegments.length,y.isCalculating]),fe.useEffect(()=>{"distance"===o&&""===i&&(y.previewSegments.length>0||y.error||void 0!==y.distanceKm)&&(M(),$N.setState(e=>({segmentation:{...e.segmentation,distanceKm:void 0,error:void 0}})))},[i,o,y.previewSegments.length,y.error,y.distanceKm,M]);const L=y.selectedSegmentIds,U=!!y.error,O=fe.useMemo(()=>[...y.previewSegments].sort((e,t)=>(e.segmentOrder||0)-(t.segmentOrder||0)),[y.previewSegments]),D=fe.useCallback(e=>{if(0===O.length)return Y5(e,m);const t=O.map(e=>e.length||e.distanceKm||0),n=t.filter(t=>Math.abs(t-e)<=.02);if(n.length>=2&&n.length>=.5*t.length){const t=Math.min(...n),r=Math.max(...n);if(t>=.08&&r<=.12){return`${Math.round(1e3*e)} m`}if(r<.1){return`${Math.round(1e3*e)} m`}return`${e.toFixed(2)} km`}return Y5(e,m)},[O,m]),N=fe.useRef(null),j=O.length>50,Q=X5({count:O.length,getScrollElement:()=>N.current,estimateSize:()=>48,overscan:5,enabled:j}),z=e=>{R(e)},H=e=>{const t=y.cutPoints,n=O.length;if(0===t.length)return;const r=[...t].sort((e,t)=>e.distanceFromStart-t.distanceFromStart);let o=null;if(1===e)o=r[0]?.id||null;else if(e===n)o=r[r.length-1]?.id||null;else{const t=e-1;o=r[t]?.id||null}o&&P(o)},G=()=>{const e=parseFloat(i);if(!isNaN(e)&&e>0){const t="miles"===m?Z5(e):e;t>=.01&&($N.setState(e=>({segmentation:{...e.segmentation,error:void 0}})),A(t),w(!1))}};return s.jsx(e6,{className:e,style:t,dynamicIslandHeight:n,title:"Segment Route",subtitle:E>0?Y5(E,m):void 0,showBackButton:!0,onBack:l,onClose:c,footer:s.jsx(rf,{sx:{borderTop:"1px solid #e0e0e0",p:2,px:3,display:"flex",flexDirection:"column",gap:1,flexShrink:0},children:s.jsxs(Nv,{variant:"contained",fullWidth:!0,disabled:0===L.size||U,onClick:p,size:"small",sx:{py:1,fontSize:g.fontSizes.body,minHeight:"36px"},children:["Save ",L.size>0&&!U&&`(${L.size})`]})}),children:s.jsxs(rf,{sx:{display:"flex",flexDirection:"column",flex:1,overflow:"hidden"},children:[s.jsxs(rf,{sx:{p:2,flexShrink:0,backgroundColor:"#ffffff",borderBottom:"1px solid #e0e0e0"},children:[s.jsx(rf,{sx:{display:"flex",flexDirection:"column",gap:1},children:s.jsxs(rf,{sx:{display:"flex",gap:.75},children:[s.jsx(Nv,{size:"small",variant:"distance"===o?"contained":"outlined",onClick:()=>{u("distance"),v.generatedRoute&&k(v.generatedRoute,"distance")},disabled:y.isCalculating&&"intersections"===o,sx:{flex:1,minHeight:"32px",py:.5,fontSize:g.fontSizes.helper,fontWeight:"distance"===o?500:400},children:"Distance"}),s.jsx(Nv,{size:"small",variant:"manual"===o?"contained":"outlined",onClick:()=>{"intersections"===o&&y.cutPoints.length>0?(F(),u("manual")):(u("manual"),v.generatedRoute&&k(v.generatedRoute,"manual"))},disabled:y.isCalculating&&("intersections"===o||"distance"===o),sx:{flex:1,minHeight:"32px",py:.5,fontSize:g.fontSizes.helper,fontWeight:"manual"===o?500:400},children:"Manual"}),s.jsx(Ev,{title:I?`Auto segmentation is only available for routes up to ${B.toFixed(0)} ${"miles"===m?"mi":"km"}. This route is ${Y5(E,m)}.`:"",arrow:!0,children:s.jsx(rf,{sx:{position:"relative",flex:1,display:"flex"},children:s.jsx(Nv,{ref:C,size:"small",variant:"intersections"===o?"contained":"outlined",onClick:async e=>{if("intersections"===o&&!y.isCalculating&&y.previewSegments.length>0){e.stopPropagation();const t=e.currentTarget.getBoundingClientRect(),n=160,r=50,o=5,i=window.innerWidth,s=window.innerHeight;let a=t.left+t.width/2-n/2;a<o?a=o:a+n>i-o&&(a=i-n-o);let l=t.bottom+o;return l+r>s&&(l=t.top-r-o,l<0&&(l=s-r-o)),void _(x?null:{x:a,y:l})}y.isCalculating||(u("intersections"),v.generatedRoute&&(k(v.generatedRoute,"intersections"),await T()))},disabled:y.isCalculating||I,endIcon:"intersections"===o&&!y.isCalculating&&y.previewSegments.length>0?s.jsx(yX,{sx:{fontSize:"20px",color:"intersections"===o?"#ffffff":"#4285f4"}}):null,sx:{flex:1,minHeight:"32px",py:.5,fontSize:g.fontSizes.helper,fontWeight:"intersections"===o?500:400,position:"relative"},children:"Auto"})})})]})}),x&&s.jsx(l6,{className:"py-1",x:x.x,y:x.y,onClose:()=>_(null),draggable:!1,width:160,items:[{id:"edit",label:"Edit Segments",icon:s.jsx(jX,{sx:{fontSize:16}}),onClick:()=>{F(),u("manual"),_(null)}}]}),"distance"===o&&s.jsxs(rf,{sx:{display:"flex",flexDirection:"column",mt:1.5},children:[s.jsxs(rf,{sx:{display:"flex",alignItems:"center",justifyContent:"space-between",mb:b?1:0},children:[s.jsx(vA,{variant:"caption",sx:{fontSize:g.fontSizes.helper,color:"#5f6368",fontFamily:'"Google Sans", sans-serif',fontWeight:500},children:"Distance Input"}),s.jsx(tA,{size:"small",onClick:()=>w(!b),sx:{padding:"4px",color:"#5f6368"},children:b?s.jsx(HX,{fontSize:"small"}):s.jsx(GX,{fontSize:"small"})})]}),s.jsx(hd,{in:b,timeout:0,children:s.jsxs(rf,{sx:{display:"flex",flexDirection:"column",gap:1},children:[s.jsxs(rf,{sx:{display:"flex",gap:1,alignItems:"center"},children:[s.jsx(Dv,{label:`Distance (${"miles"===m?"mi":"km"})`,type:"text",size:"small",variant:"outlined",fullWidth:!0,value:i,onChange:e=>{var t;(""===(t=e.target.value)||/^\d*\.?\d*$/.test(t))&&(d(t),y.error&&$N.setState(e=>({segmentation:{...e.segmentation,error:void 0}})))},onKeyDown:e=>{"Enter"===e.key&&G()},slotProps:{input:{inputMode:"decimal",sx:{fontSize:"0.813rem",fontFamily:'"Google Sans", sans-serif'}},inputLabel:{sx:{fontSize:"0.813rem",fontFamily:'"Google Sans", sans-serif'}}},sx:{"& .MuiOutlinedInput-root":{borderRadius:"8px"}}}),s.jsx(Nv,{variant:"contained",size:"small",onClick:G,disabled:!i||isNaN(parseFloat(i))||(()=>{const e=parseFloat(i);if(e<=0)return!0;return("miles"===m?Z5(e):e)<.01})(),sx:{flexShrink:0,minWidth:"64px",minHeight:"36px",py:1,fontSize:"0.813rem",textTransform:"none",fontWeight:500},children:"OK"})]}),s.jsxs(vA,{variant:"caption",sx:{fontSize:"0.75rem",color:"#5f6368",fontFamily:'"Google Sans", sans-serif'},children:["Minimum allowed segment length:"," ","miles"===m?"0.0063 mi":"0.01 km (10 m)"]})]})})]})]}),s.jsxs(rf,{sx:{px:2,py:1,overflow:"hidden",flex:1,display:"flex",flexDirection:"column",minHeight:0},children:["distance"===o?s.jsx(s.Fragment,{children:y.isCalculating?s.jsxs(rf,{sx:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",gap:2,py:4,flex:1},children:[s.jsx(Yd,{size:32,thickness:4}),s.jsx(vA,{variant:"caption",sx:{fontSize:g.fontSizes.helper,color:"#5f6368",fontFamily:'"Google Sans", sans-serif'},children:"Calculating segments..."})]}):s.jsx(rf,{sx:{flexShrink:0,mb:.5},children:y.error&&(()=>{let e=y.error;if(y.error.startsWith("ROUTE_LENGTH_"))e="Segmentation distance should always be smaller than the route length. Please use a smaller distance.";else if(y.error.startsWith("MAX_SEGMENTS_EXCEEDED_")){const t=y.error.match(/MAX_SEGMENTS_EXCEEDED_([\d.]+)_LIMIT_([\d.]+)_ROUTE_LENGTH_([\d.]+)_DISTANCE_([\d.]+)/);if(t){const n=parseInt(t[1]),r=parseInt(t[2]);e=`This would create approximately ${n.toLocaleString()} segments, which exceeds the maximum limit of ${r.toLocaleString()}. Please use a larger segment distance.`}}return s.jsx(vA,{variant:"caption",sx:{fontSize:g.fontSizes.helper,color:"#d32f2f",fontFamily:'"Google Sans", sans-serif',display:"block",mb:.5},children:e})})()})}):"intersections"===o?s.jsxs(rf,{sx:{flexShrink:0},children:[I&&s.jsxs(vA,{variant:"caption",sx:{fontSize:g.fontSizes.helper,color:"#d32f2f",fontFamily:'"Google Sans", sans-serif',display:"block",mb:2},children:["Auto segmentation is only available for routes up to"," ",B.toFixed(2)," ","miles"===m?"mi":"km",". This route is"," ",Y5(E,m),"."]}),y.isCalculating?s.jsxs(rf,{sx:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",gap:2,py:4,flex:1},children:[s.jsx(Yd,{size:32,thickness:4}),s.jsx(vA,{variant:"caption",sx:{fontSize:g.fontSizes.helper,color:"#5f6368",fontFamily:'"Google Sans", sans-serif'},children:"Analyzing route and finding intersections..."})]}):s.jsx(s.Fragment,{children:y.error&&(()=>{let e=y.error;if(y.error.startsWith("MAX_SEGMENTS_EXCEEDED_")){const t=y.error.match(/MAX_SEGMENTS_EXCEEDED_([\d.]+)_LIMIT_([\d.]+)_ROUTE_LENGTH_([\d.]+)_DISTANCE_([\d.]+)/);if(t){const n=parseInt(t[1]),r=parseInt(t[2]);e=`This would create approximately ${n.toLocaleString()} segments, which exceeds the maximum limit of ${r.toLocaleString()}. Please use a larger segment distance.`}}return s.jsx(vA,{variant:"caption",sx:{fontSize:g.fontSizes.helper,color:"#d32f2f",fontFamily:'"Google Sans", sans-serif',display:"block",mb:2},children:e})})()})]}):s.jsxs(rf,{sx:{flexShrink:0},children:[y.cutPoints.length>0&&s.jsxs(vA,{variant:"caption",sx:{fontSize:g.fontSizes.helper,color:"#5f6368",fontFamily:'"Google Sans", sans-serif',display:"block",mb:2},children:[y.cutPoints.length," cut point",1!==y.cutPoints.length?"s":""," added"]}),y.error&&s.jsx(vA,{variant:"caption",sx:{fontSize:g.fontSizes.helper,color:"#d32f2f",fontFamily:'"Google Sans", sans-serif',display:"block",mb:2},children:y.error})]}),!y.isCalculating&&O.length>0&&s.jsx(rf,{ref:N,sx:{flex:1,minHeight:0,overflowY:"auto",overflowX:"hidden",pr:1,"&::-webkit-scrollbar":{width:"8px"},"&::-webkit-scrollbar-track":{backgroundColor:"#f1f3f4",borderRadius:"4px"},"&::-webkit-scrollbar-thumb":{backgroundColor:"#dadce0",borderRadius:"4px","&:hover":{backgroundColor:"#bdc1c6"}}},children:j?s.jsx("div",{style:{height:`${Q.getTotalSize()}px`,width:"100%",position:"relative"},children:Q.getVirtualItems().map(e=>{const t=O[e.index],n=e.index,r=L.has(t.id),i=t.length||t.distanceKm||0;return s.jsx("div",{"data-index":e.index,ref:Q.measureElement,style:{position:"absolute",top:0,left:0,width:"100%",transform:`translateY(${e.start}px)`},children:s.jsxs(Mm,{disableGutters:!0,onMouseEnter:()=>f(t.id),onMouseLeave:()=>f(null),sx:{py:.5,borderBottom:"1px solid #f1f3f4",opacity:r?1:.5,"&:last-child":{borderBottom:"none"}},children:[s.jsx(Dm,{sx:{minWidth:36},children:s.jsx(jf,{edge:"start",checked:r,tabIndex:-1,disableRipple:!0,size:"small",onClick:e=>{e.stopPropagation(),z(t.id)}})}),s.jsxs(rf,{sx:{flex:1,display:"flex",alignItems:"center",gap:1},children:[s.jsx(Dv,{size:"small",variant:"standard",fullWidth:!0,placeholder:`Segment ${n+1}`,value:a.get(t.id)||"",onChange:e=>h(t.id,e.target.value),onClick:e=>e.stopPropagation(),disabled:!r,slotProps:{input:{sx:{fontSize:g.fontSizes.body,fontFamily:'"Google Sans", sans-serif',color:r?"inherit":"#9e9e9e",minWidth:0}}},sx:{minWidth:0,flexShrink:1}}),s.jsx(vA,{variant:"caption",sx:{fontSize:g.fontSizes.helper,color:r?"#5f6368":"#9e9e9e",fontFamily:'"Google Sans", sans-serif',minWidth:"60px",textAlign:"right",whiteSpace:"nowrap",flexShrink:0},children:D(i)}),("manual"===o||"intersections"===o)&&s.jsx(tA,{size:"small",onClick:e=>{e.stopPropagation(),H(t.segmentOrder||n+1)},sx:{minWidth:32,minHeight:32,padding:"6px",color:r?"#5f6368":"#9e9e9e",opacity:r?1:.6,borderRadius:"6px",transition:"all 0.15s ease","&:hover":{backgroundColor:"#fce8e6",color:"#d93025",opacity:1}},title:"Delete segment",children:s.jsx(MX,{sx:{fontSize:18}})})]})]})},t.id)})}):s.jsx(_m,{dense:!0,disablePadding:!0,children:O.map((e,t)=>{const n=L.has(e.id),r=e.length||e.distanceKm||0;return s.jsxs(Mm,{disableGutters:!0,onMouseEnter:()=>f(e.id),onMouseLeave:()=>f(null),sx:{py:.5,borderBottom:"1px solid #f1f3f4",opacity:n?1:.5,"&:last-child":{borderBottom:"none"}},children:[s.jsx(Dm,{sx:{minWidth:36},children:s.jsx(jf,{edge:"start",checked:n,tabIndex:-1,disableRipple:!0,size:"small",onClick:t=>{t.stopPropagation(),z(e.id)}})}),s.jsxs(rf,{sx:{flex:1,display:"flex",alignItems:"center",gap:1},children:[s.jsx(Dv,{size:"small",variant:"standard",fullWidth:!0,placeholder:`Segment ${t+1}`,value:a.get(e.id)||"",onChange:t=>h(e.id,t.target.value),onClick:e=>e.stopPropagation(),disabled:!n,slotProps:{input:{sx:{fontSize:g.fontSizes.body,fontFamily:'"Google Sans", sans-serif',color:n?"inherit":"#9e9e9e",minWidth:0}}},sx:{minWidth:0,flexShrink:1}}),s.jsx(vA,{variant:"caption",sx:{fontSize:g.fontSizes.helper,color:n?"#5f6368":"#9e9e9e",fontFamily:'"Google Sans", sans-serif',minWidth:"60px",textAlign:"right",whiteSpace:"nowrap",flexShrink:0},children:D(r)}),("manual"===o||"intersections"===o)&&s.jsx(tA,{size:"small",onClick:n=>{n.stopPropagation(),H(e.segmentOrder||t+1)},sx:{minWidth:32,minHeight:32,padding:"6px",color:n?"#5f6368":"#9e9e9e",opacity:n?1:.6,borderRadius:"6px",transition:"all 0.15s ease","&:hover":{backgroundColor:"#fce8e6",color:"#d93025",opacity:1}},title:"Delete segment",children:s.jsx(MX,{sx:{fontSize:18}})})]})]},e.id)})})}),!y.isCalculating&&0===O.length&&!y.error&&s.jsx(rf,{sx:{textAlign:"center",py:4},children:s.jsx(vA,{variant:"body2",sx:{fontSize:g.fontSizes.body,color:"#5f6368",fontFamily:'"Google Sans", sans-serif'},children:"distance"===o?"Enter distance and click OK to generate segments":"intersections"===o?"Click 'Auto' to automatically segment at intersections":"Click on the route to add cut points"})})]})]})})},N7=({className:e,style:t})=>{const{projectId:n,dynamicIslandHeight:r,setSelectedRoute:o,setRightPanelType:i,rightPanelType:a,setLeftPanelExpanded:l,setCurrentFolder:c}=JN(),u=aX(),d=(()=>{const e=ye();return Ee({mutationFn:async({routeId:e,data:t})=>{const n=await wj.applySegmentation(e,t);if(!n.success)throw new Error(n.message);try{await wj.update(e,{sync_status:"unsynced"})}catch(r){}return n.data},onSuccess:(t,n)=>{e.invalidateQueries({queryKey:eX.cutPoints(n.routeId)}),e.invalidateQueries({queryKey:["routes-infinite"]}),e.invalidateQueries({queryKey:["routes"]}),e.invalidateQueries({queryKey:eX.route(n.routeId)}),e.removeQueries({queryKey:eX.route(n.routeId)}),e.invalidateQueries({queryKey:["routeTags"]}),e.invalidateQueries({queryKey:["project-tags"]})}})})(),A=(()=>{const e=ye();return Ee({mutationFn:async e=>{const t=await wj.clearSegmentation(e);if(!t.success)throw new Error(t.message);return t.data},onSuccess:async(t,n)=>{e.removeQueries({queryKey:eX.route(n)}),e.invalidateQueries({queryKey:eX.route(n)}),e.invalidateQueries({queryKey:["route"]}),e.invalidateQueries({queryKey:["cut-points"]}),e.invalidateQueries({queryKey:["routes-infinite"]}),e.invalidateQueries({queryKey:["routes"]});try{const t=await wj.getById(n);if(t.success&&t.data){const{addRoute:r,updateRoute:o}=JN.getState();e.setQueryData(eX.route(n),t.data),JN.getState().routes.find(e=>e.id===n)?o(n,{isSegmented:!1,segments:void 0,segmentCount:0,segmentationType:void 0}):r(t.data);const i=JN.getState().selectedRoute;i?.id===n&&o(n,{isSegmented:!1,segments:void 0,segmentCount:0,segmentationType:void 0})}}catch(r){}}})})(),h=fe.useRef({}),p=fe.useRef(null),f=fe.useRef(0),g=$N(e=>e.individualRoute),m=$N(e=>e.segmentation),y=$N(e=>e.setDistanceKm),v=$N(e=>e.clearPreviewSegments),b=$N(e=>e.clearAllDrawing),w=$N(e=>e.setRouteUUID),x=$N(e=>e.clearPoints),_=$N(e=>e.setHoveredSegmentId),C=$N(e=>e.startSegmentation),S=$N(e=>e.stopSegmentation),{setMapMode:E}=JN(),B=()=>{"ready"===R?(k("points"),i(null),JN.getState().setShowIndividualMarkers(!0)):"segmentation"===R?(k("ready"),i("route_ready"),v(),S()):"naming"===R&&(k("ready"),i("route_ready"),V(!1))},I=()=>{k("points"),i(null),P(""),N(null),Q(""),ee(""),ne(""),X(new Map),V(!1),b(),E("view"),o(null),JN.getState().setShowIndividualMarkers(!0)},[R,k]=fe.useState("points");fe.useEffect(()=>{const{setShowIndividualMarkers:e}=JN.getState();e("points"===R)},[R]);const[T,P]=fe.useState(""),[F,M]=fe.useState("distance"),L=q5(),[U,O]=fe.useState(()=>{if(void 0!==m.distanceKm){const e="miles"===L?J5(m.distanceKm):m.distanceKm,t=Math.round(1e3*e)/1e3;return String(t)}return""}),[D,N]=fe.useState(null),[j,Q]=fe.useState(""),[z,H]=fe.useState(!1),[G,V]=fe.useState(!1),[W,$]=fe.useState(!1),[K,X]=fe.useState(new Map);fe.useEffect(()=>{if(void 0!==m.distanceKm){const e="miles"===L?J5(m.distanceKm):m.distanceKm,t=Math.round(1e3*e)/1e3;O(String(t))}else O("")},[m.distanceKm,L]),fe.useEffect(()=>{g.routeUUID&&g.originalRouteName?(P(g.originalRouteName),N(g.originalRouteTag)):(P(""),N(null))},[g.routeUUID,g.originalRouteName,g.originalRouteTag]);const Y=fe.useRef(null);fe.useEffect(()=>{const e=g.routeUUID;null!==Y.current&&Y.current!==e&&(v(),S(),k("points"),i(null),P(""),N(null),Q(""),JN.getState().setShowIndividualMarkers(!0)),Y.current=e},[g.routeUUID,i,v,S]);const q=JN(e=>e.routes),J=JN(e=>e.selectedRoute);fe.useEffect(()=>{if(!g.routeUUID)return;J?.id===g.routeUUID||q.some(e=>e.id===g.routeUUID)||(k("points"),i(null),P(""),N(null),Q(""),ee(""),ne(""),X(new Map),V(!1),b(),E("view"),o(null),JN.getState().setShowIndividualMarkers(!0))},[g.routeUUID,q,J]);const[Z,ee]=fe.useState(""),[te,ne]=fe.useState(""),{data:re=[]}=cX(n||"");fe.useEffect(()=>{const e=g.points.length;if(0===f.current)return void(f.current=e);if(e>f.current&&e>0){const e=setTimeout(()=>{const e=g.points[g.points.length-1];if(e){const t=h.current[e.id];if(t&&p.current){const e=p.current,n=e.getBoundingClientRect(),r=t.getBoundingClientRect(),o=e.scrollTop+(r.top-n.top)-n.height/2+r.height/2;e.scrollTo({top:o,behavior:"smooth"})}}},100);return()=>clearTimeout(e)}f.current=e},[g.points.length,g.points]);fe.useEffect(()=>{m.type&&("manual"===m.type?M("manual"):"distance"===m.type&&M("distance"))},[m.type]);const oe=async()=>{const e=!!g.routeUUID,t=g.originalRouteIsSegmented;e&&t&&!m.isActive?H(!0):(ee(""),ne(""),k("naming"),i("naming"))},ie=()=>{H(!1),V(!1)},se=()=>{$(!1)},ae=()=>{if(!g.generatedRoute)return;const e=!!g.routeUUID;let t,n="distance",r=[];if(e){const e=JN.getState().routes.find(e=>e.id===g.routeUUID),i=e&&g.generatedRoute?.encodedPolyline&&e.encodedPolyline!==g.generatedRoute.encodedPolyline;if(e&&e.segments&&e.segments.length>0&&!i){if(n=e.segmentationType||"distance","distance"===n&&e.segments.length>0)try{const n=e.segments[0];if(n.segmentation_config){const e="string"==typeof n.segmentation_config?JSON.parse(n.segmentation_config):n.segmentation_config;e.distanceKm&&(t=e.distanceKm)}}catch(o){}r=e.segments.sort((e,t)=>(e.segment_order||0)-(t.segment_order||0)).map((t,n)=>{let r=[];if(t.encoded_polyline)try{const e=Sw(t.encoded_polyline);"LineString"===e.type&&(r=e.coordinates)}catch(o){}const i=t.length||(r.length>0?QN(r):0);return{id:t.uuid,routeId:e.id,name:t.route_name||`Segment ${n+1}`,linestringGeoJson:{type:"LineString",coordinates:r},segmentOrder:t.segment_order||n+1,distanceKm:i,length:i,createdAt:t.created_at||(new Date).toISOString()}})}}if(C(g.generatedRoute,n),M(n),"distance"===n&&t&&y(t),r.length>0){const i=new Set(r.map(e=>e.id)),s=$N.getState();let a=[];if("manual"===n&&e){const e=JN.getState().routes.find(e=>e.id===g.routeUUID);if(e&&e.segments&&e.segments.length>0)try{const t=e.segments[0];if(t.segmentation_points){const n=JSON.parse(t.segmentation_points);Array.isArray(n)&&n.length>0&&(a=n.map((t,n)=>({id:`cut-point-${n}-${Date.now()}`,routeId:g.generatedRoute?.id||e.id,coordinates:Array.isArray(t)&&t.length>=2?{lat:t[1],lng:t[0]}:t.coordinates||{lat:0,lng:0},cutOrder:n,distanceFromStart:0,createdAt:(new Date).toISOString(),updatedAt:(new Date).toISOString(),isSnapped:!0})))}}catch(o){}}$N.setState({segmentation:{...s.segmentation,previewSegments:r,selectedSegmentIds:i,distanceKm:t||s.segmentation.distanceKm,cutPoints:a,isCalculating:!1}});const l=new Map;r.forEach(e=>{e.name&&l.set(e.id,e.name)}),X(l)}k("segmentation"),i("segmentation")},le=g.generatedRoute?.distance??0,ce=fe.useMemo(()=>{if("ready"===R&&g.generatedRoute&&g.routeUUID){const t=JN.getState().routes.find(e=>e.id===g.routeUUID);if(t&&"uploaded"===t.type&&t.originalRouteGeoJson)try{const e=Sw(g.generatedRoute.encodedPolyline);if("LineString"===e.type){const n=m5(t.originalRouteGeoJson,e);return Math.max(0,Math.min(100,n))}}catch(e){}}},[R,g.routeUUID,g.generatedRoute]);return s.jsxs(s.Fragment,{children:["points"===R&&s.jsx(U7,{className:e,style:t,dynamicIslandHeight:r,onClose:I,onContinue:async()=>{try{if(!g.generatedRoute||!g.generatedRoute.encodedPolyline)return void alert("Please wait for the route to be generated. Make sure you have at least 2 points.");k("ready"),i("route_ready"),JN.getState().setShowIndividualMarkers(!1)}catch(e){alert(`Failed to continue: ${e instanceof Error?e.message:"Unknown error"}`)}},pointRefs:h,pointsScrollContainerRef:p}),"ready"===R&&"route_ready"===a&&s.jsx(O7,{className:e,style:t,dynamicIslandHeight:r,routeLength:le,matchPercentage:ce,onBack:B,onClose:I,onEnableSegmentation:async()=>{try{if(!g.generatedRoute)return;if(!!g.routeUUID){const e=JN.getState().routes.find(e=>e.id===g.routeUUID);if(e&&g.generatedRoute?.encodedPolyline&&e.encodedPolyline!==g.generatedRoute.encodedPolyline&&e&&e.segments&&e.segments.length>0)return void $(!0)}ae()}catch(e){alert(`Failed to enable segmentation: ${e instanceof Error?e.message:"Unknown error"}`)}},onSave:oe}),"segmentation"===R&&"segmentation"===a&&s.jsx(D7,{className:e,style:t,dynamicIslandHeight:r,routeLength:le,segmentationMode:F,distanceInput:U,segmentNames:K,onBack:B,onClose:I,onSegmentationModeChange:M,onDistanceInputChange:O,onDistanceKmSet:y,onSegmentNameChange:(e,t)=>{X(n=>{const r=new Map(n);return r.set(e,t),r})},onSave:oe,onHoveredSegmentIdChange:_}),"naming"===R&&"naming"===a&&s.jsx(q6,{className:e,style:t,dynamicIslandHeight:r,routeName:T,selectedTag:D,newTag:j,routeNameError:Z,tagError:te,tags:re,onBack:()=>{m.isActive?(k("segmentation"),i("segmentation")):(k("ready"),i("route_ready")),ee(""),ne("")},onClose:I,onRouteNameChange:e=>{P(e),Z&&ee("")},onTagChange:e=>{e&&re.includes(e)?(N(e),Q("")):(N(null),Q(e||"")),te&&ne("")},onConfirmSave:async()=>{if(!n)return;if(!g.generatedRoute||!g.generatedRoute.encodedPolyline)return;o(null);const e=T.trim()?"":"Route name is required";if(e)return void ee(e);if((D||j.trim())&&!D){const e=(e=>{if(!e.trim())return"";const t=e.trim().toLowerCase(),n=re.map(e=>e.toLowerCase());return n.includes(t)?"Folder already exists":t.length<2?"Folder must be at least 2 characters":t.length>100?"Folder name must not exceed 100 characters":""})(j);if(e)return void ne(e)}const t=g.generatedRoute.origin,r=g.generatedRoute.destination,s=g.generatedRoute.waypoints||[],a=g.generatedRoute?.distance??void 0;let h,p,f="drawn";if(g.routeUUID){const e=JN.getState(),t=e.selectedRoute?.id===g.routeUUID?e.selectedRoute:e.routes.find(e=>e.id===g.routeUUID);if(t&&(f=t.type||"drawn","uploaded"===t.type&&t.originalRouteGeoJson)){p=t.originalRouteGeoJson;try{const e=Sw(g.generatedRoute.encodedPolyline);if("LineString"===e.type){const n=m5(t.originalRouteGeoJson,e);h=Math.max(0,Math.min(100,n))}}catch(C){}}}if(G&&g.routeUUID)try{await A.mutateAsync(g.routeUUID),V(!1)}catch(C){return void Pw("Failed to clear segmentation. Please try again.")}const y={uuid:g.routeUUID||crypto.randomUUID(),route_name:T.trim(),coordinates:{origin:[t.lng,t.lat],destination:[r.lng,r.lat],waypoints:s.map(e=>[e.lng,e.lat])},encoded_polyline:g.generatedRoute.encodedPolyline,region_id:parseInt(n),tag:D||(j.trim()?j.trim():null),length:a,route_type:f,original_route_geo_json:p,match_percentage:h};try{if(await u.mutateAsync(y),g.routeUUID){const e=$N.getState();e.uploadedRoutes.routes.filter(e=>e.id.startsWith(`${g.routeUUID}-uploaded-`)).forEach(t=>{e.removeUploadedRoute(t.id)})}}catch(C){return Pw("Failed to save route. Please try again."),void E("view")}try{if(m.isActive&&m.previewSegments.length>0){const e=Sw(g.generatedRoute.encodedPolyline).coordinates,t=s.map(t=>{let n=0,r=Number.MAX_VALUE;return e.forEach((e,o)=>{const i=MN({lat:t.lat,lng:t.lng},{lat:e[1],lng:e[0]});i<r&&(r=i,n=o)}),{waypoint:t,index:n}});t.sort((e,t)=>e.index-t.index);const n=m.previewSegments.map((n,r)=>{const o=K.get(n.id)?.trim(),i=o||`${T.trim()} - Segment ${r+1}`,s=n.linestringGeoJson?.coordinates||n.coordinates||[],a=s.length>0?QN(s):0;if(0===s.length)return{id:n.id,route_name:i,name:i,is_selected:m.selectedSegmentIds.has(n.id),is_enabled:m.selectedSegmentIds.has(n.id)?1:0,origin:null,destination:null,waypoints:null,length:0,linestringGeoJson:{type:"LineString",coordinates:[]}};const l=s[0],c=s[s.length-1];let u=-1,d=-1;for(let t=0;t<e.length;t++){const n=e[t];if(Math.abs(n[0]-l[0])<1e-6&&Math.abs(n[1]-l[1])<1e-6){u=t;break}}if(-1===u){let t=Number.MAX_VALUE;e.forEach((e,n)=>{const r=MN({lat:l[1],lng:l[0]},{lat:e[1],lng:e[0]});r<t&&(t=r,u=n)})}for(let t=e.length-1;t>=0;t--){const n=e[t];if(Math.abs(n[0]-c[0])<1e-6&&Math.abs(n[1]-c[1])<1e-6){d=t;break}}if(-1===d){let t=Number.MAX_VALUE;e.forEach((e,n)=>{const r=MN({lat:c[1],lng:c[0]},{lat:e[1],lng:e[0]});r<t&&(t=r,d=n)})}if(u>d){const e=u;u=d,d=e}const A=t.filter(e=>e.index>u&&e.index<d).map(e=>[e.waypoint.lng,e.waypoint.lat]);return{id:n.id,route_name:i,name:i,is_selected:m.selectedSegmentIds.has(n.id),is_enabled:m.selectedSegmentIds.has(n.id)?1:0,origin:{lat:l[1],lng:l[0]},destination:{lat:c[1],lng:c[0]},waypoints:A.length>0?A:null,length:a,linestringGeoJson:{type:"LineString",coordinates:s}}}),r={routeId:y.uuid,data:{type:m.type,..."manual"===m.type||"intersections"===m.type?{cutPoints:m.cutPoints.map(e=>[e.coordinates.lng,e.coordinates.lat])}:{distanceKm:m.distanceKm},segments:n}};await d.mutateAsync(r);try{const e=await wj.getById(y.uuid);if(e.success&&e.data){const{addRoute:t,updateRoute:n}=JN.getState();JN.getState().routes.find(e=>e.id===y.uuid)?n(y.uuid,{isSegmented:!0,segments:e.data.segments,segmentCount:e.data.segments?.length||0,segmentationType:m.type}):t(e.data)}}catch(C){}}}catch(C){return Pw("Failed to apply segmentation. Please try again."),void E("view")}ee(""),ne(""),P(""),N(null),Q(""),X(new Map),k("points"),v(),b(),w(null),x(),i(null),E("view"),JN.getState().setShowIndividualMarkers(!0);const _=D||(j.trim()?j.trim():null);c(_||"Untagged"),l(!0)},isSaving:u.isPending||d.isPending}),s.jsxs(hg,{open:z,onClose:ie,"aria-labelledby":"clear-segmentation-dialog-title","aria-describedby":"clear-segmentation-dialog-description",sx:{"& .MuiDialog-paper":{borderRadius:"16px"}},children:[s.jsx(Eg,{id:"clear-segmentation-dialog-title",children:"Clear Existing Segmentation?"}),s.jsx(wg,{children:s.jsx(Cg,{id:"clear-segmentation-dialog-description",children:"This route has existing segmentation. Saving will remove the current segmentation. Do you want to continue?"})}),s.jsxs(gg,{sx:{p:2,px:3,gap:1},children:[s.jsx(Nv,{onClick:ie,variant:"outlined",fullWidth:!0,size:"small",sx:{py:1,fontSize:"0.813rem",minHeight:"36px"},children:"Cancel"}),s.jsx(Nv,{onClick:async()=>{H(!1),V(!0),ee(""),ne(""),k("naming"),i("naming")},variant:"contained",color:"primary",fullWidth:!0,size:"small",sx:{py:1,fontSize:"0.813rem",minHeight:"36px"},children:"Continue"})]})]}),s.jsx(jv,{open:W,onClose:se,title:"Route Geometry Changed",actions:s.jsxs(rf,{sx:{display:"flex",gap:1,width:"100%"},children:[s.jsx(Nv,{onClick:se,variant:"outlined",fullWidth:!0,size:"small",sx:{py:1,fontSize:"0.813rem",minHeight:"36px"},children:"Cancel"}),s.jsx(Nv,{onClick:()=>{$(!1),ae()},variant:"contained",color:"primary",fullWidth:!0,size:"small",sx:{py:1,fontSize:"0.813rem",minHeight:"36px"},children:"Continue"})]}),children:s.jsx(vA,{variant:"body1",sx:{color:"#5f6368",fontFamily:'"Google Sans", sans-serif',fontSize:"14px",lineHeight:"20px"},children:"The route geometry has been modified. Existing segments are no longer valid and will be lost if you continue. You will need to create new segments for this route."})})]})};var j7=new Map,Q7=new WeakMap,z7=0;function H7(e){return Object.keys(e).sort().filter(t=>void 0!==e[t]).map(t=>{return`${t}_${"root"===t?(n=e.root,n?(Q7.has(n)||(z7+=1,Q7.set(n,z7.toString())),Q7.get(n)):"0"):e[t]}`;var n}).toString()}function G7(e,t,n={},r=undefined){if(void 0===window.IntersectionObserver&&void 0!==r){const o=e.getBoundingClientRect();return t(r,{isIntersecting:r,target:e,intersectionRatio:"number"==typeof n.threshold?n.threshold:0,time:0,boundingClientRect:o,intersectionRect:o,rootBounds:o}),()=>{}}const{id:o,observer:i,elements:s}=function(e){const t=H7(e);let n=j7.get(t);if(!n){const r=new Map;let o;const i=new IntersectionObserver(t=>{t.forEach(t=>{var n;const i=t.isIntersecting&&o.some(e=>t.intersectionRatio>=e);e.trackVisibility&&void 0===t.isVisible&&(t.isVisible=i),null==(n=r.get(t.target))||n.forEach(e=>{e(i,t)})})},e);o=i.thresholds||(Array.isArray(e.threshold)?e.threshold:[e.threshold||0]),n={id:t,observer:i,elements:r},j7.set(t,n)}return n}(n),a=s.get(e)||[];return s.has(e)||s.set(e,a),a.push(t),i.observe(e),function(){a.splice(a.indexOf(t),1),0===a.length&&(s.delete(e),i.unobserve(e)),0===s.size&&(i.disconnect(),j7.delete(o))}}const V7=({open:e,message:t="Syncing routes, please wait..."})=>s.jsxs(ef,{open:e,sx:{zIndex:9999,backgroundColor:"rgba(255, 255, 255, 0.9)",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",gap:3},children:[s.jsx(Yd,{size:60,thickness:4}),s.jsx(vA,{variant:"body1",sx:{color:"text.primary",fontWeight:500},children:t})]}),W7=({open:e,currentName:t,onClose:n,onSave:r,isLoading:o=!1,error:i,projectId:a})=>{const[l,c]=pe.useState(t),[u,d]=pe.useState("");pe.useEffect(()=>{e&&(c(t),d(""))},[e,t]);const A=async()=>{const e=l.trim();if(d(""),e.length>100)d("Route name must not exceed 100 characters");else try{await r(e)}catch(t){const e=t instanceof Error?t.message:"Failed to rename route";d(e)}},h=()=>{d(""),c(t),n()},p=u||i||"";return s.jsx(jv,{open:e,onClose:h,maxWidth:"xs",fullWidth:!0,title:"Rename Route",actions:s.jsxs(s.Fragment,{children:[s.jsx(Nv,{onClick:h,style:{textTransform:"none"},disabled:o,children:"Cancel"}),s.jsx(Nv,{onClick:A,variant:"contained",disabled:o||!l.trim(),style:{textTransform:"none"},children:o?s.jsx(Yd,{size:20}):"Rename"})]}),children:s.jsx(Dv,{label:"Route Name",value:l,onChange:e=>{c(e.target.value),d("")},onKeyDown:e=>{"Enter"===e.key&&!o&&l.trim()?A():"Escape"===e.key&&h()},error:!!p,helperText:p,fullWidth:!0,variant:"standard",required:!0,autoFocus:!0,disabled:o,inputProps:{maxLength:100}})})},$7=({sortBy:e,onSortChange:t,apiSorting:n=!1,showMatchPercentage:r=!1})=>{const[o,i]=fe.useState(null);return s.jsxs(rf,{className:"flex items-center gap-1",children:[s.jsx(Nv,{size:"small",startIcon:s.jsx(dY,{sx:{fontSize:16}}),onClick:e=>i(e.currentTarget),variant:"outlined",sx:{fontSize:"12px",textTransform:"none",color:"#5f6368",borderColor:"#dadce0",padding:"6px 12px",minHeight:"32px",display:"flex",alignItems:"center",fontWeight:400,"&:hover":{backgroundColor:"#f8f9fa",borderColor:"#1976d2",color:"#1976d2"},"& .MuiButton-startIcon":{display:"flex",alignItems:"center",marginRight:"6px",marginLeft:0}},children:(()=>{if(n)switch(e){case"name":default:return"Name";case"distance":return"Distance";case"created_at":return"Newest";case"match_percentage":return"Match %"}else switch(e){case"difference":default:return"Most Different";case"distance":return"Distance";case"alphabetical":return"Alphabetical"}})()}),s.jsx(ly,{anchorEl:o,open:Boolean(o),onClose:()=>i(null),anchorOrigin:{vertical:"bottom",horizontal:"right"},transformOrigin:{vertical:"top",horizontal:"right"},children:n?s.jsxs(s.Fragment,{children:[s.jsx(Ay,{onClick:()=>{t("name"),i(null)},selected:"name"===e,sx:{fontSize:"0.813rem",fontFamily:'"Google Sans", sans-serif'},children:"Name (A-Z)"}),s.jsx(Ay,{onClick:()=>{t("distance"),i(null)},selected:"distance"===e,sx:{fontSize:"0.813rem",fontFamily:'"Google Sans", sans-serif'},children:"Distance (shortest first)"}),r&&s.jsx(Ay,{onClick:()=>{t("match_percentage"),i(null)},selected:"match_percentage"===e,sx:{fontSize:"0.813rem",fontFamily:'"Google Sans", sans-serif'},children:"Match % (lowest first)"}),s.jsx(Ay,{onClick:()=>{t("created_at"),i(null)},selected:"created_at"===e,sx:{fontSize:"0.813rem",fontFamily:'"Google Sans", sans-serif'},children:"Newest First"})]}):s.jsxs(s.Fragment,{children:[s.jsx(Ay,{onClick:()=>{t("difference"),i(null)},selected:"difference"===e,sx:{fontSize:"0.813rem",fontFamily:'"Google Sans", sans-serif'},children:"Most Different"}),s.jsx(Ay,{onClick:()=>{t("distance"),i(null)},selected:"distance"===e,sx:{fontSize:"0.813rem",fontFamily:'"Google Sans", sans-serif'},children:"Distance (shortest first)"}),s.jsx(Ay,{onClick:()=>{t("alphabetical"),i(null)},selected:"alphabetical"===e,sx:{fontSize:"0.813rem",fontFamily:'"Google Sans", sans-serif'},children:"Alphabetical (A-Z)"})]})})]})},K7=({routeTypes:e,onTypeChange:t})=>{const[n,r]=fe.useState(null),o=n=>{const r=new Set(e);r.has(n)?r.delete(n):r.add(n),t(r)};return s.jsxs(rf,{className:"flex items-center gap-1",children:[s.jsx(Nv,{size:"small",startIcon:s.jsx(VX,{sx:{fontSize:16}}),onClick:e=>r(e.currentTarget),variant:"outlined",sx:{fontSize:"12px",textTransform:"none",color:e.size>0?"#1976d2":"#5f6368",borderColor:e.size>0?"#1976d2":"#dadce0",padding:"6px 12px",minHeight:"32px",display:"flex",alignItems:"center",fontWeight:400,backgroundColor:e.size>0?"#e3f2fd":"transparent","&:hover":{backgroundColor:"#f8f9fa",borderColor:"#1976d2",color:"#1976d2"},"& .MuiButton-startIcon":{display:"flex",alignItems:"center",marginRight:"6px",marginLeft:0}},children:(()=>{if(0===e.size)return"All Types";if(1===e.size){const t=Array.from(e)[0];return t.charAt(0).toUpperCase()+t.slice(1)}return`${e.size} Types`})()}),s.jsxs(ly,{anchorEl:n,open:Boolean(n),onClose:()=>r(null),anchorOrigin:{vertical:"bottom",horizontal:"right"},transformOrigin:{vertical:"top",horizontal:"right"},children:[s.jsx(Ay,{onClick:()=>{t(new Set),r(null)},selected:0===e.size,sx:{fontSize:"0.813rem",fontFamily:'"Google Sans", sans-serif'},children:"All Types"}),s.jsxs(Ay,{onClick:e=>{e.stopPropagation(),o("imported")},sx:{fontSize:"0.813rem",fontFamily:'"Google Sans", sans-serif'},children:[s.jsx(jf,{checked:e.has("imported"),size:"small",sx:{padding:"4px 8px 4px 4px",color:"#757575","&.Mui-checked":{color:"#1976d2"}},icon:s.jsx(CX,{sx:{fontSize:18}}),checkedIcon:s.jsx(_X,{sx:{fontSize:18}})}),"Imported"]}),s.jsxs(Ay,{onClick:e=>{e.stopPropagation(),o("drawn")},sx:{fontSize:"0.813rem",fontFamily:'"Google Sans", sans-serif'},children:[s.jsx(jf,{checked:e.has("drawn"),size:"small",sx:{padding:"4px 8px 4px 4px",color:"#757575","&.Mui-checked":{color:"#1976d2"}},icon:s.jsx(CX,{sx:{fontSize:18}}),checkedIcon:s.jsx(_X,{sx:{fontSize:18}})}),"Drawn"]}),s.jsxs(Ay,{onClick:e=>{e.stopPropagation(),o("uploaded")},sx:{fontSize:"0.813rem",fontFamily:'"Google Sans", sans-serif'},children:[s.jsx(jf,{checked:e.has("uploaded"),size:"small",sx:{padding:"4px 8px 4px 4px",color:"#757575","&.Mui-checked":{color:"#1976d2"}},icon:s.jsx(CX,{sx:{fontSize:18}}),checkedIcon:s.jsx(_X,{sx:{fontSize:18}})}),"Uploaded"]})]})]})},X7=({status:e,isLoading:t=!1,disabled:n=!1,onClick:r,size:o="small"})=>{const i=s0(JN(e=>e.mapType)),a=([e,t,n])=>`rgb(${e}, ${t}, ${n})`,l=n||"synced"===e||t;return s.jsx(tA,{size:o,onClick:e=>{e.stopPropagation(),r(e)},disabled:l,title:(()=>{if(t)return"Syncing...";switch(e){case"unsynced":return"Unsynced - Click to sync";case"validating":return"Validating sync status";case"synced":return"Synced";case"invalid":return"Invalid - Click to retry";default:return"Sync route"}})(),className:"p-1",sx:{"&:hover":{backgroundColor:"rgba(0, 0, 0, 0.04)"}},children:(()=>{const n=(e=>{switch(e){case"synced":return a(i.routeStatusColors.synced);case"validating":return a(i.routeStatusColors.validating);case"unsynced":default:return a(i.routeStatusColors.unsynced);case"invalid":return a(i.routeStatusColors.invalid)}})(e);if(t)return s.jsx(hY,{sx:{fontSize:18,color:n,animation:"spin 1s linear infinite","@keyframes spin":{"0%":{transform:"rotate(0deg)"},"100%":{transform:"rotate(360deg)"}}}});switch(e){case"unsynced":default:return s.jsx(hY,{sx:{fontSize:18,color:n}});case"validating":return s.jsx(DZ,{sx:{width:"18px",height:"18px",color:n}});case"synced":return s.jsx(SX,{sx:{fontSize:18,color:n}});case"invalid":return s.jsx(zX,{sx:{fontSize:18,color:n}})}})()})},Y7=({segments:e,routeId:t,isSelected:n,multiSelectEnabled:r,selectedRoute:o,routesStore:i,onNavigateToSegment:a,onHoverSegment:l,onSyncSegment:c,onRenameSegment:u,syncingRouteId:d,projectId:A,toggleRouteMutation:h,distanceUnit:p})=>{const f=fe.useMemo(()=>[...e].sort((e,t)=>(e.segment_order||0)-(t.segment_order||0)),[e]),g=f.length>100,m=fe.useRef(null),y=X5({count:f.length,getScrollElement:()=>m.current,estimateSize:()=>72,overscan:5,enabled:g}),v=fe.useMemo(()=>o?.id===t?o:i.find(e=>e.id===t)||null,[o,t,i]),b=fe.useCallback((e,o)=>{const i=v?.segments?.find(t=>t.uuid===e.uuid)||e;return s.jsxs(rf,{sx:{position:"relative",zIndex:1,marginBottom:"4px",marginLeft:"8px",marginRight:"-16px",borderRadius:"1rem",backgroundColor:n&&!r?"#F5F5F5":"#ffffff",border:"1px solid #e0e0e0",boxShadow:"0 1px 2px rgba(0, 0, 0, 0.05)",transition:"all 0.15s ease-in-out","&:hover":{backgroundColor:n&&!r?"#bbdefb":"#f5f5f5",borderColor:"#d0d0d0",boxShadow:"0 2px 4px rgba(0, 0, 0, 0.1)"}},children:[n&&!r&&s.jsx(rf,{sx:{position:"absolute",left:"-12px",top:"50%",transform:"translateY(-50%)",width:"12px",height:"3px",backgroundColor:"#bdbdbd",zIndex:0}}),s.jsx(Mm,{disablePadding:!0,sx:{width:"100%"},children:s.jsxs(Im,{sx:{padding:"6px 12px",borderRadius:"1rem",minHeight:44,width:"100%",backgroundColor:"transparent",cursor:"pointer","&:hover":{backgroundColor:"transparent"}},onClick:e=>a(i,e),onMouseEnter:()=>l(e.uuid),onMouseLeave:()=>l(null),children:[s.jsx(Dm,{sx:{minWidth:36,width:36,display:"flex",alignItems:"center",justifyContent:"center",alignSelf:"flex-start",marginTop:"10px"},children:s.jsx(jf,{checked:!1!==i.is_enabled,onChange:async n=>{n.stopPropagation();const r=!(!1!==i.is_enabled);try{await h.mutateAsync({routeId:e.uuid,parentRouteId:t,isEnabled:r,projectId:A||void 0})}catch(o){}},size:"small",sx:{color:"#757575",padding:"0px",margin:"0px","&.Mui-checked":{color:"#1976d2"},"&:hover":{backgroundColor:"rgba(25, 118, 210, 0.04)"}},icon:s.jsx(CX,{sx:{fontSize:18}}),checkedIcon:s.jsx(_X,{sx:{fontSize:18}})})}),s.jsxs(rf,{className:"flex items-center flex-1",sx:{minWidth:0,marginLeft:"4px"},children:[s.jsx(zm,{sx:{margin:0,padding:0,flex:1,minWidth:0,"& .MuiListItemText-primary":{marginBottom:"2px"},"& .MuiListItemText-secondary":{marginTop:0}},primary:s.jsx(vA,{variant:"body2",title:i.route_name||`Segment ${o+1}`,sx:{fontSize:"13px",fontWeight:500,lineHeight:1.4,color:!1===i.is_enabled?"#9e9e9e":"#212121",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",flex:1,minWidth:0},children:i.route_name||`Segment ${o+1}`}),secondary:s.jsx(vA,{variant:"caption",sx:{fontSize:"11px",lineHeight:1.3,marginTop:"1px",color:!1===i.is_enabled?"#bdbdbd":"#757575"},children:Y5(i.length||0,p)})}),s.jsx(X7,{status:i.sync_status||"unsynced",disabled:!1,onClick:()=>c(i.uuid),isLoading:d===i.uuid}),s.jsx(tA,{size:"small",onClick:e=>{e.stopPropagation(),u(i.uuid,t)},sx:{minWidth:32,minHeight:32,padding:"6px",color:"#757575",transition:"all 0.15s ease-in-out","&:hover":{backgroundColor:"#e3f2fd",color:"#1976d2"}},title:"Rename segment",children:s.jsx(DX,{sx:{fontSize:18}})})]})]})})]},e.uuid)},[v,n,r,t,a,l,c,u,d,A,h,p]);return g?s.jsx(rf,{ref:m,sx:{maxHeight:"400px",overflowY:"auto",overflowX:"hidden",pr:3,"&::-webkit-scrollbar":{width:"8px"},"&::-webkit-scrollbar-track":{backgroundColor:"#f1f3f4",borderRadius:"4px"},"&::-webkit-scrollbar-thumb":{backgroundColor:"#dadce0",borderRadius:"4px","&:hover":{backgroundColor:"#bdc1c6"}}},children:s.jsx("div",{style:{height:`${y.getTotalSize()}px`,width:"100%",position:"relative"},children:y.getVirtualItems().map(e=>{const t=f[e.index];return s.jsx("div",{"data-index":e.index,ref:y.measureElement,style:{position:"absolute",top:0,left:0,width:"100%",transform:`translateY(${e.start}px)`},children:b(t,e.index)},t.uuid)})})}):s.jsx(rf,{children:f.map((e,t)=>b(e,t))})},q7=()=>{const{navigateWithCheck:e}=sj(),t=JN(e=>e.setSelectedRoutePanelVisible),n=q5(),{selectedRoute:r,selectRoute:o,projectId:i,loadRouteForEditing:a,removeRoute:l,setMapMode:c,showSelectedRouteSegments:u,setShowSelectedRouteSegments:d,setLeftPanelExpanded:A,leftPanelExpanded:h,mapMode:p,mapType:f,currentFolder:g,setCurrentFolder:m,scrollToRoute:y,routeToScrollTo:v,routeSearchQuery:b,setRouteSearchQuery:w,setActivePanel:x,roadPriorityPanelOpen:_,exitEditMode:C}=JN(),S=JN(e=>e.routes),E=$N(e=>e.setSelectedRouteHoveredSegmentId),B=$N(e=>e.loadRoutePoints),I=$N(e=>e.setRouteUUID),R=$N(e=>e.clearPoints),k=$N(e=>e.setEditingSavedRouteId),T=$N(e=>e.individualRoute.routeUUID),P=$N(e=>e.editingSavedRouteId),F=$N(e=>e.hasUnsavedChanges),M=$N(e=>e.discardRouteChanges),L=fe.useCallback(()=>{P&&F(P)&&M(P),o(null),w(null),de(""),"route_editing"!==p&&"individual_editing"!==p&&"individual_drawing"!==p&&"editing_uploaded_route"!==p&&null===T||C(),k(null),E(null)},[P,F,M,o,p,T,C,k,E,w]),U=(()=>{const e=ye();return Ee({mutationFn:async({routeId:e,parentRouteId:t,isEnabled:n,projectId:r})=>{const o=await wj.toggleRouteEnabled(e,n);if(!o.success)throw new Error(o.message);return{routeId:e,parentRouteId:t,projectId:r,isEnabled:n}},onMutate:async({routeId:e,parentRouteId:t,isEnabled:n})=>{const r=JN.getState();if(t){const o=r.routes.find(e=>e.id===t);if(o){if(o.segments){const i=o.segments.map(t=>t.uuid===e?{...t,is_enabled:n}:t);r.updateRoute(t,{segments:i})}if(o.roads){const i=o.roads.map(t=>t.routeId===e||t.id===e?{...t,is_enabled:n}:t);r.updateRoute(t,{roads:i})}}if(r.selectedRoute?.id===t){const o={};if(r.selectedRoute.segments&&(o.segments=r.selectedRoute.segments.map(t=>t.uuid===e?{...t,is_enabled:n}:t)),r.selectedRoute.roads&&(o.roads=r.selectedRoute.roads.map(t=>t.routeId===e||t.id===e?{...t,is_enabled:n}:t)),Object.keys(o).length>0){r.updateRoute(t,o);const e=r.routes.find(e=>e.id===t);e&&JN.setState({selectedRoute:e})}}}const o=JN.getState();o.routes.find(e=>e.id===t),o.selectedRoute,r.routes.find(t=>t.id===e)&&r.updateRoute(e,{sync_status:n?"unsynced":"invalid"})},onSuccess:({routeId:t,parentRouteId:n,projectId:r})=>{e.invalidateQueries({queryKey:eX.route(t)}),n&&e.invalidateQueries({queryKey:eX.route(n)}),r&&(e.invalidateQueries({queryKey:eX.routes(r)}),e.invalidateQueries({queryKey:["routes-infinite",r]}),e.invalidateQueries({queryKey:eX.roadsNetwork(r)}),e.refetchQueries({queryKey:eX.routes(r)}),e.refetchQueries({queryKey:["routes-infinite",r]}))}})})(),O=sX(),D=(e=>{const t=ye();return Ee({mutationFn:async e=>{const t=await wj.batchSoftDelete(e);if(!t.success)throw new Error(t.message);return t.data},onSuccess:()=>{t.invalidateQueries({queryKey:["routes-infinite"]}),t.invalidateQueries({queryKey:["routeTags"]}),t.invalidateQueries({queryKey:["project-tags"]}),e&&(t.invalidateQueries({queryKey:["routes-infinite",e]}),t.invalidateQueries({queryKey:eX.routeTags(e)})),(0,$N.getState().refreshRoutesTilesTimestamp)()}})})(i||void 0),N=(e=>{const t=ye();return Ee({mutationFn:async({routeIds:e,tag:t})=>{const n=await wj.batchMove(e,t);if(!n.success)throw new Error(n.message);return n.data},onSuccess:()=>{t.invalidateQueries({queryKey:["routes-infinite"]}),t.invalidateQueries({queryKey:["routeTags"]}),t.invalidateQueries({queryKey:["project-tags"]}),e&&(t.invalidateQueries({queryKey:["routes-infinite",e]}),t.invalidateQueries({queryKey:eX.routeTags(e)}))}})})(i||void 0),j=rX(),{navigateToGeometry:Q}=KZ(),{setRightPanelType:z}=JN(),{addMessage:H,dismissMessage:G}=kw(),V=(()=>{const e=ye();return Ee({mutationFn:async({dbProjectId:e,tag:t,newTag:n})=>{const r=await wj.renameTag(e,t,n);if(!r.success)throw new Error(r.message);return r.data},onSuccess:()=>{e.invalidateQueries({queryKey:["routes-infinite"]}),e.invalidateQueries({queryKey:["routes"]}),e.invalidateQueries({queryKey:["routeTags"]}),e.invalidateQueries({queryKey:["project-tags"]})}})})(),W=(()=>{const e=ye();return Ee({mutationFn:async({dbProjectId:e,tag:t,newTag:n})=>{const r=await wj.moveTag(e,t,n);if(!r.success)throw new Error(r.message);return r.data},onSuccess:()=>{e.invalidateQueries({queryKey:["routes-infinite"]}),e.invalidateQueries({queryKey:["routes"]}),e.invalidateQueries({queryKey:["routeTags"]}),e.invalidateQueries({queryKey:["project-tags"]})}})})(),$=(()=>{const e=ye();return Ee({mutationFn:async({dbProjectId:e,tag:t})=>{const n=await wj.deleteTag(e,t);if(!n.success)throw new Error(n.message);return n.data},onSuccess:()=>{e.invalidateQueries({queryKey:["routes-infinite"]}),e.invalidateQueries({queryKey:["routes"]}),e.invalidateQueries({queryKey:["routeTags"]}),e.invalidateQueries({queryKey:["project-tags"]}),(0,$N.getState().refreshRoutesTilesTimestamp)()}})})(),K=(()=>{const e=ye();return Ee({mutationFn:async({dbProjectId:e,tag:t,distanceKm:n})=>{const r=await wj.segmentTag(e,t,n);if(!r.success)throw new Error(r.message);return r.data},onSuccess:()=>{e.invalidateQueries({queryKey:["routes-infinite"]}),e.invalidateQueries({queryKey:["routes"]}),e.invalidateQueries({queryKey:["routeTags"]}),e.invalidateQueries({queryKey:["project-tags"]})}})})();(()=>{const e=ye();Ee({mutationFn:async({dbProjectId:e,tag:t})=>{const n=await wj.stretchTag(e,t);if(!n.success)throw new Error(n.message);return n.data},onSuccess:()=>{e.invalidateQueries({queryKey:["routes-infinite"]}),e.invalidateQueries({queryKey:["routes"]}),e.invalidateQueries({queryKey:["routeTags"]}),e.invalidateQueries({queryKey:["project-tags"]})}})})();const X=(()=>{const e=ye();return Ee({mutationFn:async({db_project_id:e,project_number:t,gcp_project_id:n,tag:r})=>{const o=await Ij(e,t,n,r);if("error"===o.status)throw new Error(o.message);return o},onSuccess:async t=>{e.invalidateQueries({queryKey:["routes-infinite"]}),e.invalidateQueries({queryKey:["route"]}),e.invalidateQueries({queryKey:["routeTags"]}),e.invalidateQueries({queryKey:["project-tags"]}),(0,$N.getState().refreshRoutesTilesTimestamp)();const n=t.details;if("Running in view mode."===n.message)return void Fw("This project is in view-only mode. Syncing is disabled.",{duration:5e3});let r="Folder synced.";void 0!==n.previously_validated_routes&&(r+=` Validated: ${n.previously_validated_routes},`),void 0!==n.validating_routes&&(r+=` Validating: ${n.validating_routes}`),Tw(r,{duration:5e3});const o=JN.getState().projectId;o&&setTimeout(async()=>{try{const t=await ZK("main-map");await pj.updateSnapshot(o,t),await e.invalidateQueries({queryKey:eX.projects})}catch(t){}},2e3)},onError:e=>{Pw(`Folder sync failed: ${e instanceof Error?e.message:"Unknown error"}`,{duration:5e3})}})})(),Y=(()=>{const e=ye();return Ee({mutationFn:async({db_project_id:e,project_number:t,gcp_project_id:n,uuid:r})=>{const o=await Rj(e,t,n,r);if("error"===o.status)throw new Error(o.message);return o},onSuccess:async t=>{e.invalidateQueries({queryKey:["routes-infinite"]}),e.invalidateQueries({queryKey:["route"]}),(0,$N.getState().refreshRoutesTilesTimestamp)();const n=t.details;if("Running in view mode."===n.message)return void Fw("This project is in view-only mode. Syncing is disabled.",{duration:5e3});n.message?Tw(n.message,{duration:5e3}):Tw("Route synced successfully",{duration:5e3});const r=JN.getState().projectId;r&&setTimeout(async()=>{try{const t=await ZK("main-map");await pj.updateSnapshot(r,t),await e.invalidateQueries({queryKey:eX.projects})}catch(t){}},2e3)},onError:e=>{Pw(`Route sync failed: ${e instanceof Error?e.message:"Unknown error"}`,{duration:5e3})}})})(),q=iX(),[J,Z]=pe.useState(!1),[ee,te]=pe.useState(null),ne=$N(e=>e.lassoDrawing),re=$N(e=>e.polygonDrawing),{fileInputRef:oe,handleUploadRoute:ie,handleFileUploadChange:se}=i0(),{data:ae,isLoading:le}=(e=>Se({queryKey:eX.routeTags(e),queryFn:async()=>{const t=await wj.getProjectTags(e);if(!t.success)throw new Error(t.message);return t.data},enabled:!!e,staleTime:12e4}))(i||""),ce=h,[ue,de]=pe.useState("");pe.useEffect(()=>{null!==b&&(de(b),w(null))},[b,w]);const Ae=g;pe.useEffect(()=>{if(!Ae)return;const e=e=>{if(" "===e.key||"Spacebar"===e.key){const t=e.target;if(t instanceof HTMLInputElement||t instanceof HTMLTextAreaElement||t.isContentEditable)return;Ht.current&&Ht.current.contains(t)&&(e.preventDefault(),e.stopPropagation())}};return window.addEventListener("keydown",e,!0),()=>{window.removeEventListener("keydown",e,!0)}},[Ae]);const[he,ge]=pe.useState(new Set),[me,ve]=pe.useState(null),[be,we]=pe.useState(!1),[xe,_e]=pe.useState("created_at"),[Ce,Be]=pe.useState(new Set),[Ie,Re]=pe.useState(new Map),[ke,Te]=pe.useState(null),[Pe,Fe]=pe.useState(null),[Me,Le]=pe.useState(null),[Ue,Oe]=pe.useState(!1),[De,Ne]=pe.useState(!1),[je,Qe]=pe.useState(!1),[ze,He]=pe.useState(null),[Ge,Ve]=pe.useState(!1),[We,$e]=pe.useState(null),[Ke,Xe]=pe.useState(!1),[Ye,qe]=pe.useState(null),[Je,Ze]=pe.useState(!1),[et,tt]=pe.useState(""),[nt,rt]=pe.useState(""),[ot,it]=pe.useState(""),[st,at]=pe.useState(!1),[lt,ct]=pe.useState(""),[ut,dt]=pe.useState(null),[At,ht]=pe.useState(!1),[pt,ft]=pe.useState(""),[gt,mt]=pe.useState("1"),[yt,vt]=pe.useState("distance"),[bt,wt]=pe.useState(""),[xt,_t]=pe.useState(!1),[Ct,St]=pe.useState(null),[Et,Bt]=pe.useState(!1),[It,Rt]=pe.useState(null),[kt,Tt]=pe.useState(null),[Pt,Ft]=pe.useState(""),[Mt,Lt]=pe.useState(""),[Ut,Ot]=pe.useState({open:!1,message:"",severity:"success"}),[Dt,Nt]=pe.useState(new Map),jt=fe.useRef(new Map),Qt=fe.useRef(null),zt=fe.useRef(0),Ht=fe.useRef(null),Gt=function(e,t){const[n,r]=pe.useState(e);return pe.useEffect(()=>{const n=setTimeout(()=>{r(e)},t);return()=>{clearTimeout(n)}},[e,t]),n}(ue,500),{data:Vt,fetchNextPage:Wt,hasNextPage:$t,isFetchingNextPage:Kt,isLoading:Xt,error:Yt}=nX(i||"",Ae?Gt:"",Ae,Ae?xe:void 0,Ae&&Ce.size>0?Array.from(Ce):void 0),{ref:qt,inView:Jt}=function({threshold:e,delay:t,trackVisibility:n,rootMargin:r,root:o,triggerOnce:i,skip:s,initialInView:a,fallbackInView:l,onChange:c}={}){var u;const[d,A]=pe.useState(null),h=pe.useRef(c),p=pe.useRef(a),[f,g]=pe.useState({inView:!!a,entry:void 0});h.current=c,pe.useEffect(()=>{if(void 0===p.current&&(p.current=a),s||!d)return;let c;return c=G7(d,(e,t)=>{const n=p.current;p.current=e,(void 0!==n||e)&&(g({inView:e,entry:t}),h.current&&h.current(e,t),t.isIntersecting&&i&&c&&(c(),c=void 0))},{root:o,rootMargin:r,threshold:e,trackVisibility:n,delay:t},l),()=>{c&&c()}},[Array.isArray(e)?e.toString():e,d,o,r,i,s,n,l,t]);const m=null==(u=f.entry)?void 0:u.target,y=pe.useRef(void 0);d||!m||i||s||y.current===m||(y.current=m,g({inView:!!a,entry:void 0}),p.current=a);const v=[A,f.inView,f.entry];return v.ref=v[0],v.inView=v[1],v.entry=v[2],v}({threshold:0}),Zt=pe.useMemo(()=>{if(!Ae){return S}return Vt?.pages.flatMap(e=>e.routes)||[]},[Vt,Ae,S]),en=pe.useMemo(()=>!!Ae&&Zt.some(e=>"uploaded"===e.type||void 0!==e.matchPercentage&&null!==e.matchPercentage),[Ae,Zt]);pe.useEffect(()=>{Jt&&$t&&!Kt&&Ae&&Wt()},[Jt,$t,Kt,Wt,Ae]),pe.useEffect(()=>{if(Kt){Oe(!0);const e=setTimeout(()=>{Kt||Oe(!1)},300);return()=>clearTimeout(e)}{const e=setTimeout(()=>{Oe(!1)},150);return()=>clearTimeout(e)}},[Kt]),pe.useEffect(()=>{Be(new Set),_e("created_at")},[Ae]),pe.useEffect(()=>{const e=ue.trim()||Gt.trim()||Ce.size>0,t=ue.trim()!==Gt.trim();if(Ae&&!Xt&&!Kt&&0===Zt.length&&!Yt&&!e&&!t){const e=setTimeout(()=>{const e=ue.trim()||Gt.trim()||Ce.size>0,t=ue.trim()!==Gt.trim(),n=document.activeElement instanceof HTMLInputElement&&"text"===document.activeElement.type;!Ae||e||t||0!==Zt.length||n||(L(),m(null),de(""),we(!1))},700);return()=>clearTimeout(e)}},[Ae,Xt,Kt,Zt.length,Yt,ue,Gt,Ce,m,L]),pe.useEffect(()=>{if(!v||!i)return void(zt.current=0);let e=Zt.find(e=>e.id===v);if(e||(e=S.find(e=>e.id===v)),!e)return zt.current=0,void wj.getById(v).then(e=>{if(e.success&&e.data){const t=e.data.tag||"Untagged";Ae!==t&&(m(t),de(""))}else y(null),zt.current=0}).catch(e=>{y(null),zt.current=0});const t=e.tag||"Untagged";if(Ae!==t)return zt.current=0,m(t),void de("");{const e=jt.current.get(v);if(e&&Qt.current)setTimeout(()=>{e.scrollIntoView({behavior:"smooth",block:"center"}),y(null),zt.current=0},100);else{if(Zt.find(e=>e.id===v)){const e=setTimeout(()=>{const e=jt.current.get(v);e&&Qt.current&&(e.scrollIntoView({behavior:"smooth",block:"center"}),y(null),zt.current=0)},200);return()=>clearTimeout(e)}if(Xt)return;$t&&!Kt&&Ae&&zt.current<10?(zt.current+=1,Wt()):(!$t||zt.current>=10)&&(y(null),zt.current=0)}}},[v,Zt,S,Ae,m,y,i,$t,Kt,Xt,Wt,10,Vt]),pe.useEffect(()=>{if(!v||!Ae)return;if(Xt||Kt)return;if(Zt.find(e=>e.id===v)){const e=jt.current.get(v);if(!e||!Qt.current){const e=setTimeout(()=>{const e=jt.current.get(v);e&&Qt.current&&(e.scrollIntoView({behavior:"smooth",block:"center"}),y(null),zt.current=0)},300);return()=>clearTimeout(e)}setTimeout(()=>{e.scrollIntoView({behavior:"smooth",block:"center"}),y(null),zt.current=0},150)}},[v,Zt,Ae,Xt,Kt,y,Vt]),fe.useEffect(()=>{if(!Ct)return;r?.id===Ct||S.some(e=>e.id===Ct)||Zt.some(e=>e.id===Ct)||(_t(!1),St(null))},[Ct,S,Zt,r]);const tn=fe.useRef(!1),nn=fe.useRef(r);pe.useEffect(()=>{if(null!==r||null===me||tn.current||(ve(null),d(!1)),null===r||me!==r.id||r.isSegmented&&r.segments&&0!==r.segments.length||(ve(null),d(!1)),null!==nn.current&&null===r&&!tn.current){const{removeUploadedRoute:e}=$N.getState();Nt(t=>(Array.from(t.entries()).forEach(([,t])=>{t&&e(t)}),new Map))}nn.current=r},[r,me,d]);const rn=()=>{Fe(null),Te(null)},on=(e,t)=>{const n=r?.id===t?r:S.find(e=>e.id===t)||Zt.find(e=>e.id===t),o=n?.segments?.find(t=>t.uuid===e);o&&(Rt(e),Tt(t),Ft(o.route_name||""),Lt(""),Bt(!0))},sn=(e,t)=>{const n=t.target;if(!(n.closest(".MuiCheckbox-root")||n.closest('button[title="Rename segment"]')||n.closest('button[aria-label*="Sync"]')||n.closest(".MuiIconButton-root"))&&(t.stopPropagation(),Q&&e.encoded_polyline&&e.encoded_polyline.trim().length>0)){const t=e.encoded_polyline.trim();try{const e=JSON.parse(t);if(Array.isArray(e)&&e.length>0&&Array.isArray(e[0])&&2===e[0].length){return void Q({linestring:{type:"LineString",coordinates:e}})}}catch{}return void Q({encodedPolyline:t})}},an=pe.useMemo(()=>{if(!ae)return[];const e=[...ae.tags];return ae.counts.Untagged>0&&!e.includes("Untagged")&&e.push("Untagged"),e.filter(e=>e.toLowerCase().includes(ue.toLowerCase())).sort((e,t)=>e.localeCompare(t))},[ae,ue]),ln=pe.useMemo(()=>{if(!ae)return[];const e=[...ae.tags];return ae.counts.Untagged>0&&!e.includes("Untagged")&&e.push("Untagged"),e.sort((e,t)=>e.localeCompare(t))},[ae]),cn=pe.useMemo(()=>ae?Object.values(ae.counts).reduce((e,t)=>e+t,0):0,[ae]),un=e=>{const t=new Set(he);t.has(e)?t.delete(e):t.add(e),ge(t)},dn=e=>e instanceof zX||"object"==typeof e&&null!==e&&"message"in e&&"string"==typeof e.message?e.message:"An unknown error occurred",An=e=>e.name||"Unnamed Route",hn=async e=>{const{projectData:t}=JN.getState();if(!i||!t)return void Pw("Project data not available");const n=parseInt(i,10),r=t.bigQueryColumn?.googleCloudProjectNumber,o=t.bigQueryColumn?.googleCloudProjectId;if(r&&o){te(e);try{await Y.mutateAsync({db_project_id:n,project_number:r,gcp_project_id:o,uuid:e})}catch(s){}finally{te(null)}}else Pw("GCP project configuration not available. Please configure your GCP credentials.")};return"lasso_selection"===p||ne.completedPolygon||_||"road_selection"===p||re.completedPolygon?null:s.jsxs(s.Fragment,{children:[s.jsx(V7,{open:J||X.isPending,message:"Syncing folder, please wait..."}),s.jsx("input",{ref:oe,type:"file",accept:".geojson,.json,.kml,.kmz,.gpx,.zip",onChange:se,style:{display:"none"}}),s.jsxs(w6,{isExpanded:ce,onToggle:()=>{if("lasso_selection"===p||ne.completedPolygon||_||"road_selection"===p||re.completedPolygon)return;const e=!ce;A(e),x(e?"saved_routes":null)},width:360,children:[s.jsx(rf,{className:"px-4 pt-3 pb-3 border-b border-gray-200 bg-white",sx:{minHeight:72},children:Ae?s.jsxs(s.Fragment,{children:[s.jsxs(rf,{className:"flex items-center gap-2 mb-3",sx:{minWidth:0},children:[s.jsx(tA,{ref:Ht,size:"small",onClick:()=>{L(),m(null),we(!1),de("")},onKeyDown:e=>{" "!==e.key&&"Spacebar"!==e.key||(e.preventDefault(),e.stopPropagation())},sx:{minWidth:40,minHeight:40,width:40,height:40,padding:0,color:"#757575",display:"flex",alignItems:"center",justifyContent:"center",flexShrink:0,"&:hover":{backgroundColor:"#f5f5f5"}},children:s.jsx(gX,{sx:{fontSize:18,display:"flex",alignItems:"center"}})}),s.jsxs(vA,{variant:"body2",className:"font-semibold",title:`Your Routes / ${Ae}`,sx:{fontSize:"15px",lineHeight:1.5,flex:1,minWidth:0,overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:["Your Routes /"," ",s.jsx("span",{className:"font-normal text-gray-900",children:Ae})]}),s.jsx(vA,{variant:"body2",sx:{fontSize:"12px",color:"#757575",fontWeight:400,fontFamily:'"Google Sans", sans-serif',whiteSpace:"nowrap",flexShrink:0},children:(()=>{const e=ae?.counts[Ae]||0;return s.jsxs(s.Fragment,{children:[e," ",1===e?"route":"routes"]})})()})]}),s.jsx(rf,{children:s.jsx(fJ,{placeholder:"Search saved routes",value:ue,onChange:de})})]}):s.jsxs(s.Fragment,{children:[s.jsxs(rf,{className:"flex items-center justify-between mb-3",children:[s.jsx(vA,{variant:"h6",className:"text-gray-900 font-medium",style:{fontSize:"15px",fontWeight:500},children:"Your Routes"}),s.jsx(tA,{size:"small",onClick:()=>e("/dashboard"),sx:{minWidth:40,minHeight:40,width:40,height:40,padding:0,color:"#5f6368",display:"flex",alignItems:"center",justifyContent:"center","&:hover":{backgroundColor:"#f5f5f5",color:sJ}},"aria-label":"Go to dashboard",title:"Go to dashboard",children:s.jsx(XX,{sx:{fontSize:20,display:"flex",alignItems:"center"}})})]}),s.jsx(rf,{children:s.jsx(fJ,{placeholder:"Search folders...",value:ue,onChange:de})})]})}),Ae&&s.jsx(rf,{className:"px-4 pt-3 pb-3 border-b border-gray-200 bg-white",sx:{flexShrink:0},children:s.jsxs(rf,{sx:{display:"flex",alignItems:"center",justifyContent:"space-between",gap:1,minWidth:0},children:[s.jsxs(rf,{sx:{display:"flex",alignItems:"center",gap:1.5,minWidth:0,flexShrink:1},children:[be&&he.size>0&&s.jsxs(vA,{variant:"body2",sx:{fontSize:"12px",color:"#757575",fontWeight:400,fontFamily:'"Google Sans", sans-serif',whiteSpace:"nowrap"},children:[he.size," selected"]}),!be&&s.jsxs(s.Fragment,{children:[s.jsx(K7,{routeTypes:Ce,onTypeChange:Be}),s.jsx($7,{sortBy:xe,onSortChange:e=>{_e(e)},apiSorting:!0,showMatchPercentage:en})]}),be&&he.size>0&&s.jsxs(rf,{sx:{display:"flex",alignItems:"center",gap:1},children:[s.jsx(Ev,{title:`Move ${he.size} selected route${1!==he.size?"s":""}`,children:s.jsx(tA,{onClick:()=>{qe(null),wt(""),Xe(!0)},disabled:N.isPending,sx:{color:"#1976d2",border:"1px solid #e0e0e0",padding:"6px",width:"32px",height:"32px","&:hover":{backgroundColor:"#e3f2fd",color:"#1565c0",borderColor:"#1976d2"},"&:disabled":{borderColor:"#e0e0e0",color:"#9e9e9e"}},children:N.isPending?s.jsx(Yd,{size:18}):s.jsx(OX,{sx:{fontSize:18}})})}),s.jsx(Ev,{title:`Delete ${he.size} selected route${1!==he.size?"s":""}`,children:s.jsx(tA,{onClick:()=>{Ne(!0)},disabled:D.isPending,sx:{color:"#1976d2",border:"1px solid #e0e0e0",padding:"6px",width:"32px",height:"32px","&:hover":{backgroundColor:"#e3f2fd",color:"#1565c0",borderColor:"#1976d2"},"&:disabled":{borderColor:"#e0e0e0",color:"#9e9e9e"}},children:D.isPending?s.jsx(Yd,{size:18}):s.jsx(MX,{sx:{fontSize:18}})})})]})]}),s.jsx(rf,{sx:{display:"flex",alignItems:"center",gap:1,flexShrink:0},children:Zt.length>0&&s.jsxs(s.Fragment,{children:[be?s.jsx(Nv,{variant:"outlined",onClick:he.size===Zt.length?()=>{ge(new Set)}:()=>{if(!Ae||0===Zt.length)return;const e=new Set(Zt.map(e=>e.id));ge(e)},sx:{fontSize:"12px",textTransform:"none",color:"#5f6368",borderColor:"#d1d5db",padding:"6px 12px",minWidth:"auto",height:"32px",lineHeight:1.2,whiteSpace:"nowrap",display:"none","&:hover":{borderColor:"#1976d2",backgroundColor:"#e3f2fd"}},children:he.size===Zt.length?"Deselect All":"Select All"}):s.jsx(Nv,{variant:"outlined",onClick:()=>{if(r){if(o(null),ve(null),d(!1),Dt.has(r.id)){const e=Dt.get(r.id);if(e){const{removeUploadedRoute:t}=$N.getState();t(e),Nt(e=>{const t=new Map(e);return t.delete(r.id),t})}}"individual_drawing"===p&&T&&T===r.id&&C()}we(!0)},sx:{fontSize:"12px",textTransform:"none",color:"#5f6368",borderColor:"#d1d5db",padding:"6px 12px",minWidth:"auto",height:"32px",lineHeight:1.2,whiteSpace:"nowrap","&:hover":{borderColor:"#1976d2",backgroundColor:"#e3f2fd"}},children:"Select"}),be&&s.jsx(Nv,{variant:"text",onClick:()=>{we(!1),ge(new Set)},sx:{fontSize:"12px",textTransform:"none",color:"#757575",padding:"6px 12px",minWidth:"auto",height:"32px",lineHeight:1.2,whiteSpace:"nowrap","&:hover":{backgroundColor:"#f5f5f5"}},children:"Done"})]})})]})}),s.jsx(rf,{className:"flex-1 flex flex-col",sx:{minHeight:0,overflow:"hidden"},children:Ae?s.jsx(rf,{className:"flex-1 flex flex-col",sx:{minHeight:0,overflow:"hidden"},children:Xt?s.jsx(_m,{disablePadding:!0,className:"px-4",children:[...Array(5)].map((e,t)=>s.jsxs(fe.Fragment,{children:[s.jsx(Mm,{disablePadding:!0,children:s.jsxs(rf,{sx:{width:"100%",padding:"6px 12px",margin:"2px 8px",display:"flex",alignItems:"center",gap:2},children:[s.jsx(lv,{variant:"rectangular",width:40,height:40,sx:{borderRadius:"4px",flexShrink:0}}),s.jsxs(rf,{sx:{flex:1,minWidth:0},children:[s.jsx(lv,{variant:"text",width:"60%",height:20,sx:{marginBottom:1}}),s.jsx(lv,{variant:"text",width:"40%",height:16})]}),s.jsxs(rf,{sx:{display:"flex",alignItems:"center",gap:1,flexShrink:0},children:[s.jsx(lv,{variant:"rectangular",width:60,height:22,sx:{borderRadius:"11px"}}),s.jsx(lv,{variant:"circular",width:32,height:32})]})]})}),t<4&&s.jsx(Tg,{sx:{marginLeft:5,marginRight:1,borderColor:"#e0e0e0"}})]},`skeleton-${t}`))}):Yt?s.jsxs(rf,{className:"p-6 text-center text-red-500",children:[s.jsx(zX,{className:"text-5xl mb-2 opacity-30"}),s.jsx(vA,{variant:"body2",gutterBottom:!0,style:{fontSize:"14px"},children:"Error loading routes"})]}):0===Zt.length&&ue===Gt?s.jsxs(rf,{className:"flex flex-col items-center justify-center py-12 px-6 text-center",children:[s.jsx(sY,{className:"text-5xl mb-4 opacity-20",sx:{fontSize:64}}),s.jsx(vA,{variant:"h6",className:"text-gray-900 font-medium mb-2",style:{fontSize:"18px",fontWeight:500},children:Gt.trim()||Ce.size>0?"No routes found":"No routes in this folder"}),s.jsx(vA,{variant:"body2",className:"text-gray-500 mb-6",style:{fontSize:"14px",maxWidth:"280px"},children:Gt.trim()?`No routes match "${Gt}"`:Ce.size>0?`There are no routes with selected type${Ce.size>1?"s":""}. Try adjusting your filters.`:"Create a new route or move existing routes here"}),!Gt.trim()&&0===Ce.size&&s.jsx(Nv,{variant:"contained",startIcon:s.jsx(fX,{}),onClick:()=>c("individual_drawing"),className:"rounded-lg",sx:{textTransform:"none",fontSize:"14px",fontWeight:500,padding:"10px 24px",backgroundColor:"#1976d2","&:hover":{backgroundColor:"#1565c0"}},children:"Create New Route"})]}):s.jsxs(s.Fragment,{children:[s.jsxs(rf,{ref:Qt,className:"flex-1 overflow-auto",sx:{minHeight:0},children:[s.jsx(_m,{disablePadding:!0,className:"px-4 !mx-0 !my-2",children:Zt.map((e,t)=>{const a=r?.id===e.id,l=he.has(e.id),c=me===e.id&&!be&&u&&(r?.id===e.id?r?.isSegmented&&r?.segments&&r.segments.length>0:e.isSegmented&&e.segments&&e.segments.length>0),A=(e.encodedPolyline?Cw(e.encodedPolyline):null)??e.distance??0;return s.jsxs(fe.Fragment,{children:[s.jsx(Mm,{className:"mb-1",disablePadding:!0,ref:t=>{t?jt.current.set(e.id,t):jt.current.delete(e.id)},children:s.jsxs(Im,{selected:a&&!be,onClick:async t=>{be?(t.stopPropagation(),un(e.id)):(await(async(e,t)=>{if(t?.target instanceof HTMLElement&&(t.target.closest(".MuiCheckbox-root")||t.target.closest(".MuiIconButton-root")||t.target.closest(".MuiMenu-root")))return;if(me===e||r?.id===e){const t=JN.getState().rightPanelType;"individual_drawing"===p&&("naming"===t||T&&T===e)&&C();const{stopSegmentation:n,segmentation:r}=$N.getState();if(r.isActive&&n(),"route_ready"!==t&&"segmentation"!==t&&"naming"!==t||z(null),Dt.has(e)){const t=Dt.get(e);if(t){const{removeUploadedRoute:n}=$N.getState();n(t),Nt(t=>{const n=new Map(t);return n.delete(e),n})}}ve(null),o(null),d(!1)}else{const{stopSegmentation:t,segmentation:n}=$N.getState();n.isActive&&t();const r=JN.getState().rightPanelType;"route_ready"!==r&&"segmentation"!==r&&"naming"!==r||z(null),"individual_drawing"===p&&(T&&T===e||C());const{removeUploadedRoute:o}=$N.getState();Array.from(Dt.entries()).forEach(([t,n])=>{t!==e&&n&&o(n)}),Nt(t=>{const n=new Map;if(t.has(e)){const r=t.get(e);r&&n.set(e,r)}return n}),tn.current=!0,ve(e);const i=Zt.find(t=>t.id===e);if(i){const{addRoute:t,selectRoute:n}=JN.getState();JN.getState().routes.find(t=>t.id===e)||t(i),n(e)}try{await j(e)}finally{tn.current=!1}const s=JN.getState().selectedRoute;s?.isSegmented&&s?.segments&&s.segments.length>0?d(!0):d(!1)}})(e.id,t),((e,t)=>{if(t.stopPropagation(),Q&&e.encodedPolyline&&e.encodedPolyline.trim().length>0){const t=e.encodedPolyline.trim();try{const e=JSON.parse(t);if(Array.isArray(e)&&e.length>0&&Array.isArray(e[0])&&2===e[0].length)return void Q({linestring:{type:"LineString",coordinates:e}})}catch{}Q({encodedPolyline:t})}})(e,t))},sx:{minHeight:44,padding:"6px 12px",borderRadius:"1rem",marginBottom:c?0:"4px",position:"relative",zIndex:10,backgroundColor:be&&l||a?"#e3f2fd":"#ffffff",borderLeft:be&&l?"3px solid #1b75d2":a?"3px solid #1976d2":"3px solid transparent",border:"1px solid #e0e0e0",boxShadow:"0 1px 2px rgba(0, 0, 0, 0.05)","&:hover":{backgroundColor:be&&l?"#e3f2fd":"#f5f5f5",boxShadow:"0 2px 4px rgba(0, 0, 0, 0.1)"},"&.Mui-selected":{backgroundColor:"#e3f2fd","&:hover":{backgroundColor:"#bbdefb"}}},children:[be&&s.jsx(Dm,{className:"min-w-[40px]",sx:{minWidth:40,display:"flex",alignItems:"center",justifyContent:"flex-start"},children:s.jsx(jf,{checked:l,onClick:t=>{t.stopPropagation(),un(e.id)},size:"small",sx:{color:"#757575",padding:0,display:"flex",alignItems:"center","&.Mui-checked":{color:"#1976d2"}},icon:s.jsx(CX,{sx:{fontSize:20,display:"flex",alignItems:"center"}}),checkedIcon:s.jsx(_X,{sx:{fontSize:20,display:"flex",alignItems:"center"}})})}),s.jsx(zm,{sx:{margin:0,padding:0,flex:1,minWidth:0,"& .MuiListItemText-primary":{marginBottom:"4px"},"& .MuiListItemText-secondary":{marginTop:0}},primary:s.jsxs(rf,{sx:{display:"flex",alignItems:"center",justifyContent:"space-between",gap:1,minWidth:0},children:[s.jsx(vA,{variant:"body2",className:"font-medium text-gray-900",title:An(e),sx:{fontSize:"14px",fontWeight:500,lineHeight:1.4,overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",flex:1,minWidth:0,color:be&&l?"#1976d2":"#212121"},children:An(e)}),!be&&s.jsxs(rf,{className:"flex items-center gap-1",sx:{flexShrink:0,display:"flex",alignItems:"center",gap:.5},children:[a&&(()=>{const t=r?.id===e.id?r:e;return t.isSegmented&&t.segments&&t.segments.length>0})()&&s.jsx(tA,{size:"small",onClick:async t=>{if(t.stopPropagation(),c)ve(null),d(!1);else{if(!a){const t=Zt.find(t=>t.id===e.id);if(t){const{addRoute:n,selectRoute:r}=JN.getState();JN.getState().routes.find(t=>t.id===e.id)||n(t),r(e.id)}try{await j(e.id)}catch(n){}}ve(e.id);const t=JN.getState().selectedRoute;t?.isSegmented&&t?.segments&&t.segments.length>0&&d(!0)}},sx:{minWidth:32,minHeight:32,padding:"4px",color:"#757575","&:hover":{backgroundColor:"#f0f0f0"}},title:c?"Collapse segments":"Expand segments",children:c?s.jsx(Ev,{title:"Collapse segments",children:s.jsx(HX,{sx:{fontSize:18}})}):s.jsx(Ev,{title:"Expand segments",children:s.jsx(GX,{sx:{fontSize:18}})})}),!e.isSegmented&&s.jsx(X7,{status:e.sync_status||"unsynced",disabled:!1,onClick:()=>hn(e.id),isLoading:ee===e.id}),s.jsx(tA,{size:"small",onClick:t=>{((e,t)=>{e.stopPropagation();const n=e.currentTarget.getBoundingClientRect(),r=window.innerWidth,o=window.innerHeight;let i=n.right+0;i+160>r&&(i=n.left-160-0,i<0&&(i=r-160-0));let s=n.bottom+0-25;s+75>o&&(s=n.top-75-0,s<0&&(s=o-75-0)),Le({x:i,y:s,routeId:t})})(t,e.id)},sx:{minWidth:32,minHeight:32,padding:"4px",color:"#757575","&:hover":{backgroundColor:"#f0f0f0"}},children:s.jsx(ZX,{sx:{fontSize:18}})})]})]}),secondary:s.jsx(rf,{sx:{display:"flex",flexDirection:"column",gap:.5,marginTop:"2px"},children:s.jsxs(rf,{sx:{display:"flex",alignItems:"center",justifyContent:"space-between",gap:.5,flexWrap:"wrap"},children:[s.jsxs(rf,{sx:{display:"flex",alignItems:"center",gap:.5,flexWrap:"wrap"},children:[s.jsx(vA,{variant:"caption",sx:{fontSize:"11px",fontWeight:400,color:"#757575",whiteSpace:"nowrap"},children:Y5(A,n)}),(()=>{const t=r?.id===e.id?r:e,n=t.isSegmented&&t.segments?t.segments.length:0;return n>0?s.jsxs(s.Fragment,{children:[s.jsx(vA,{component:"span",sx:{fontSize:"10px",color:"#9e9e9e",lineHeight:1,verticalAlign:"middle",margin:"0 2px"},children:""}),s.jsx(ap,{component:"span",label:`${n} segment${1!==n?"s":""}`,size:"small",sx:{height:"18px",backgroundColor:"#f5f5f5",color:"#757575",fontSize:"10px",fontWeight:400,"& .MuiChip-label":{padding:"0 6px",fontSize:"10px",lineHeight:"18px"},display:"inline-flex",alignItems:"center"}})]}):null})(),void 0!==e.matchPercentage&&null!==e.matchPercentage&&s.jsxs(s.Fragment,{children:[s.jsx(vA,{component:"span",sx:{fontSize:"10px",color:"#9e9e9e",lineHeight:1,verticalAlign:"middle",margin:"0 2px"},children:""}),s.jsx(Ev,{title:"Shows how closely saved route follows uploaded route",children:s.jsx(ap,{component:"span",label:`${Math.round(e.matchPercentage)}% match`,size:"small",sx:{height:"18px",backgroundColor:e.matchPercentage>=80?"#e8f5e9":e.matchPercentage>=60?"#fff3e0":"#ffebee",color:e.matchPercentage>=80?"#2e7d32":e.matchPercentage>=60?"#e65100":"#c62828","& .MuiChip-label":{padding:"0 6px",fontSize:"10px",fontWeight:400,lineHeight:"18px"},cursor:"help",display:"inline-flex",alignItems:"center"}})})]})]}),s.jsxs(rf,{sx:{display:"flex",alignItems:"center",gap:.5,position:"relative"},children:[r?.id===e.id&&"uploaded"===e.type&&s.jsx(rf,{onClick:t=>{t.stopPropagation(),(async e=>{try{const t=Dt.get(e),{addUploadedRoute:n,removeUploadedRoute:r}=$N.getState();if(t)r(t),Nt(t=>{const n=new Map(t);return n.delete(e),n});else{Array.from(Dt.entries()).forEach(([,e])=>{r(e)}),Nt(new Map);const t=await wj.getById(e);if(!t.success||!t.data)return void Pw("Failed to load route");const o=t.data;if("uploaded"!==o.type){const e="individual_drawing"===o.source;return void Pw(e?"This route was drawn manually and doesn't have an original uploaded route":"Original uploaded route is not available for this route. It may have been saved before this feature was added.")}let i;if(o.originalRouteGeoJson)i=JSON.parse(JSON.stringify(o.originalRouteGeoJson));else{if(!(o.encodedPolyline&&o.encodedPolyline.trim().length>0))return void Ot({open:!0,message:"Original uploaded route data is not available for this route.",severity:"error"});{const e=o.encodedPolyline.trim();let t;try{const n=JSON.parse(e);t=Array.isArray(n)&&n.length>0&&Array.isArray(n[0])&&2===n[0].length?{type:"LineString",coordinates:n}:Sw(e)}catch{t=Sw(e)}i={type:"Feature",geometry:t,properties:{}}}}const s=`${e}-uploaded-${Date.now()}`;n({id:s,name:`${o.name} (Original)`,type:"geojson",data:i,uploadedAt:new Date,color:s0(f).uploadedRouteColor}),Nt(t=>{const n=new Map(t);return n.set(e,s),n})}}catch(t){Pw("Failed to toggle uploaded route")}})(e.id)},sx:{display:"flex",alignItems:"center",cursor:"pointer",userSelect:"none",marginRight:"4px"},children:s.jsx(rf,{sx:{width:36,height:20,borderRadius:"9999px",backgroundColor:Dt.has(e.id)?"#1976d2":"#bdbdbd",position:"relative",transition:"background-color 0.2s ease","&:hover":{backgroundColor:Dt.has(e.id)?"#1565c0":"#9e9e9e"}},children:s.jsx(rf,{sx:{width:16,height:16,borderRadius:"50%",backgroundColor:"#ffffff",position:"absolute",top:2,left:Dt.has(e.id)?18:2,transition:"left 0.2s ease",boxShadow:"0 1px 3px rgba(0, 0, 0, 0.2)"}})})}),s.jsx(vA,{variant:"caption",component:"span",sx:{fontSize:"11px",color:"#757575",fontWeight:400,whiteSpace:"nowrap",fontStyle:"italic"},children:e.type.charAt(0).toUpperCase()+e.type.slice(1)})]})]})})})]})}),me===e.id&&!be&&u&&(r?.id===e.id?r?.isSegmented&&r?.segments&&r.segments.length>0:e.isSegmented&&e.segments&&e.segments.length>0)&&s.jsxs(rf,{sx:{position:"relative",margin:"0 8px 4px 8px",marginTop:0,backgroundColor:"transparent",borderRadius:"0 0 1rem 1rem",padding:"4px"},children:[a&&!be&&s.jsx(rf,{sx:{position:"absolute",left:0,top:"-20px",bottom:0,width:"3px",backgroundColor:"#bdbdbd",zIndex:1}}),s.jsx(rf,{className:"mr-4",sx:{position:"relative"},children:(()=>{const t=(r?.id===e.id?r:e).segments||e.segments;return t?s.jsx(Y7,{segments:t,routeId:e.id,isSelected:a,multiSelectEnabled:be,selectedRoute:r,routesStore:S,onNavigateToSegment:sn,onHoverSegment:E,onSyncSegment:hn,onRenameSegment:on,syncingRouteId:ee,projectId:i,toggleRouteMutation:U,distanceUnit:n}):null})()})]})]},e.id)})}),Ue&&s.jsxs(rf,{className:"p-6 text-center bg-gray-50 border-t border-gray-200",children:[s.jsx(Yd,{size:32,thickness:4}),s.jsx(vA,{variant:"caption",className:"text-gray-700 mt-3 block font-medium",style:{fontSize:"13px"},children:"Loading more routes..."})]}),$t&&!Kt&&s.jsx(rf,{ref:qt,className:"h-8 flex items-center justify-center",children:s.jsx(vA,{variant:"caption",className:"text-gray-400",style:{fontSize:"11px"},children:"Scroll for more..."})})]}),!$t&&Zt.length>0&&s.jsx(rf,{className:"p-4 text-center border-t border-gray-100 flex-shrink-0",sx:{backgroundColor:"#ffffff"},children:s.jsx(vA,{variant:"caption",className:"text-gray-500",style:{fontSize:"12px",fontWeight:500},children:" All routes loaded"})})]})}):s.jsx(rf,{className:"flex-1 overflow-auto px-4",sx:{minHeight:0},children:le?s.jsxs(rf,{className:"p-6 text-center",children:[s.jsx(Yd,{size:32}),s.jsx(vA,{variant:"body2",className:"text-gray-500 mt-2",style:{fontSize:"14px"},children:"Loading folders..."})]}):0===cn?s.jsxs(rf,{className:"flex flex-col items-center justify-center py-12 px-6 text-center",children:[s.jsx(sY,{className:"text-6xl mb-4 opacity-20",sx:{fontSize:80}}),s.jsx(vA,{variant:"h6",className:"text-gray-900 font-medium mb-2",style:{fontSize:"20px",fontWeight:500},children:"No routes yet"}),s.jsx(vA,{variant:"body2",className:"text-gray-500 mb-6",style:{fontSize:"14px",maxWidth:"280px"},children:"Get started by creating your first route"}),s.jsxs(rf,{className:"flex flex-col gap-3 w-full max-w-[280px]",children:[s.jsx(Nv,{variant:"contained",startIcon:s.jsx(fX,{}),onClick:()=>c("individual_drawing"),className:"rounded-lg",sx:{textTransform:"none",fontSize:"14px",fontWeight:500,padding:"10px 24px",backgroundColor:"#1976d2","&:hover":{backgroundColor:"#1565c0"}},children:"Draw Route"}),s.jsx(Nv,{variant:"outlined",startIcon:s.jsx(fY,{}),onClick:ie,className:"rounded-lg",sx:{textTransform:"none",fontSize:"14px",fontWeight:500,padding:"10px 24px",borderColor:"#1976d2",color:"#1976d2","&:hover":{backgroundColor:"#e3f2fd",borderColor:"#1565c0"}},children:"From File (GeoJSON)"})]})]}):0===an.length?s.jsxs(rf,{className:"p-6 text-center text-gray-500",children:[s.jsx(WX,{className:"text-5xl mb-2 opacity-30"}),s.jsx(vA,{variant:"body2",gutterBottom:!0,style:{fontSize:"14px"},children:"No folders found"})]}):s.jsx(_m,{disablePadding:!0,className:"!mx-0 !my-2",children:an.map(e=>{const t=ae?.counts[e]||0;return s.jsx(fe.Fragment,{children:s.jsx(Mm,{disablePadding:!0,children:s.jsxs(Im,{onClick:()=>{m(e||"Untagged"),de("")},sx:{minHeight:44,borderRadius:"1rem",margin:"0px 0px",marginBottom:"8px",backgroundColor:"#ffffff",border:"1px solid #e0e0e0",boxShadow:"0 1px 2px rgba(0, 0, 0, 0.05)","&:hover":{backgroundColor:"#f5f5f5",boxShadow:"0 2px 4px rgba(0, 0, 0, 0.1)"}},children:[s.jsx(Dm,{className:"min-w-[40px]",sx:{minWidth:40,display:"flex",alignItems:"center",justifyContent:"flex-start"},children:s.jsx(WX,{sx:{fontSize:18,color:"#757575",display:"flex",alignItems:"center"}})}),s.jsx(zm,{primary:s.jsx(vA,{variant:"body2",className:"font-medium text-gray-900",title:e||"Untagged",sx:{fontSize:"14px",fontWeight:500,lineHeight:1.3,overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:e||"Untagged"}),sx:{margin:0,flex:1,minWidth:0}}),s.jsxs(rf,{className:"flex items-center gap-1.5",children:[s.jsx(ap,{label:`${t} route${1!==t?"s":""}`,size:"small",sx:{backgroundColor:"#f5f5f5",color:"#757575",fontSize:"12px",height:"22px",fontWeight:400,"& .MuiChip-label":{padding:"0 8px"}}}),s.jsx(tA,{size:"small",onClick:t=>((e,t)=>{e.stopPropagation();const n=e.currentTarget.getBoundingClientRect(),r=window.innerWidth,o=window.innerHeight;let i=n.right+5;i+160>r&&(i=n.left-160-5,i<0&&(i=r-160-5));let s=n.top;s+210>o&&(s=n.bottom-210,s<0&&(s=o-210-5)),Fe({x:i,y:s,folderTag:t}),Te({element:e.currentTarget,folderTag:t})})(t,e),sx:{minWidth:32,minHeight:32,padding:"4px",color:"#757575","&:hover":{backgroundColor:"#f0f0f0"}},children:s.jsx(ZX,{sx:{fontSize:18}})})]})]})})},e)})})})}),!Ae&&s.jsx(rf,{className:"px-4 py-3 border-t border-gray-200 bg-gray-50/50",sx:{flexShrink:0,minHeight:"48px"},children:s.jsxs(vA,{variant:"body2",sx:{fontSize:"12px",color:"#757575",fontWeight:400},children:[ln.length," folder",1!==ln.length?"s":""]})})]}),Pe&&s.jsx(l6,{className:"py-1",x:Pe.x,y:Pe.y,onClose:rn,draggable:!1,width:160,items:[{id:"rename",label:"Rename",icon:s.jsx(NX,{sx:{fontSize:16}}),onClick:()=>{return e=Pe.folderTag,tt(e),rt(""),it(""),Ze(!0),void rn();var e}},{id:"move",label:"Move All",icon:s.jsx(OX,{sx:{fontSize:16}}),onClick:()=>{return e=Pe.folderTag,ct(e),dt(null),at(!0),void rn();var e}},{id:"sync",label:"Sync Folder",icon:s.jsx(hY,{sx:{fontSize:16}}),onClick:()=>(async e=>{const{projectData:t}=JN.getState();if(!i||!t)return void Pw("Project data not available");const n=parseInt(i,10),r=t.bigQueryColumn?.googleCloudProjectNumber,o=t.bigQueryColumn?.googleCloudProjectId;if(r&&o){rn(),Z(!0);try{await X.mutateAsync({db_project_id:n,project_number:r,gcp_project_id:o,tag:e})}catch(s){}finally{Z(!1)}}else Pw("GCP project configuration not available. Please configure your GCP credentials.")})(Pe.folderTag)},{id:"delete",label:"Delete All",icon:s.jsx(MX,{sx:{fontSize:16}}),onClick:()=>{return e=Pe.folderTag,rn(),$e(e),void Ve(!0);var e}}]}),Me&&s.jsx(l6,{x:Me.x,y:Me.y,onClose:()=>Le(null),draggable:!1,width:160,items:(()=>{const e=Zt.find(e=>e.id===Me.routeId);if(!e)return[];const t=[{id:"rename",label:"Rename",icon:s.jsx(DX,{sx:{fontSize:16}}),onClick:()=>{return e=Me.routeId,void(Zt.find(t=>t.id===e)&&(St(e),_t(!0),Le(null)));var e}},{id:"modify",label:"Modify",icon:s.jsx(QX,{sx:{fontSize:16}}),onClick:async()=>{Le(null),ve(e.id);const t=H("loading","Loading route details...",{description:"Fetching route data and segments"});try{const{addRoute:t,updateRoute:r}=JN.getState();let o=e;try{const n=await wj.getById(e.id);if(n.success&&n.data){o=n.data;S.find(t=>t.id===e.id)?r(e.id,o):t(o);const i=JN.getState();i.selectedRoute?.id===e.id&&r(e.id,o)}}catch(n){}if(await j(e.id),Q&&o.encodedPolyline)try{const e=o.encodedPolyline.trim();try{const t=JSON.parse(e);if(Array.isArray(t)&&t.length>0&&Array.isArray(t[0])&&2===t[0].length){Q({linestring:{type:"LineString",coordinates:t}})}else Q({encodedPolyline:e})}catch{Q({encodedPolyline:e})}}catch(n){}await new Promise(e=>setTimeout(e,50));o.isSegmented&&o.segments&&o.segments.length>0?(d(!0),ve(e.id),await new Promise(e=>setTimeout(e,0))):d(!1),z(null);"individual_drawing"===JN.getState().mapMode&&(I(o.id),R(),await new Promise(e=>setTimeout(e,10))),a(o,B,I,R)}finally{G(t)}}}];return t.push({id:"delete",label:"Delete",icon:s.jsx(MX,{sx:{fontSize:16}}),onClick:()=>{var e;e=Me.routeId,He(e),Qe(!0),Le(null)}}),t})()}),s.jsxs(hg,{open:De,onClose:()=>Ne(!1),maxWidth:"sm",fullWidth:!0,children:[s.jsx(Eg,{children:"Delete Routes"}),s.jsx(wg,{children:s.jsxs(vA,{variant:"body2",style:{fontSize:"14px"},children:["Are you sure you want to delete ",he.size," route(s)? This action cannot be undone."]})}),s.jsxs(gg,{children:[s.jsx(Nv,{onClick:()=>Ne(!1),style:{textTransform:"none"},children:"Cancel"}),s.jsx(Nv,{onClick:async()=>{try{const e=Array.from(he);await D.mutateAsync(e);const{removeUploadedRoute:t}=$N.getState();e.forEach(e=>{const n=Dt.get(e);n&&t(n)}),e.forEach(e=>l(e)),Nt(t=>{const n=new Map(t);return e.forEach(e=>{n.delete(e)}),n}),r&&e.includes(r.id)&&(o(null),d(!1),ve(null)),me&&e.includes(me)&&(ve(null),d(!1)),ge(new Set),we(!1),Ne(!1),Tw(`Successfully deleted ${e.length} route(s)`)}catch(e){Ne(!1),Pw(`Failed to delete routes: ${dn(e)}`)}},color:"error",variant:"contained",disabled:D.isPending,style:{textTransform:"none"},children:D.isPending?s.jsx(Yd,{size:20}):"Delete"})]})]}),s.jsx(i6,{open:je,onClose:()=>{Qe(!1),He(null)},onConfirm:()=>{if(!ze)return;const e=ze,t=Dt.get(e);if(t){const{removeUploadedRoute:n}=$N.getState();n(t),Nt(t=>{const n=new Map(t);return n.delete(e),n})}O.mutate(e,{onSuccess:()=>{l(e),r?.id===e&&(o(null),d(!1),ve(null)),me===e&&(ve(null),d(!1)),he.has(e)&&ge(t=>{const n=new Set(t);return n.delete(e),n})}}),Qe(!1),He(null)},title:"Delete Route",message:"Are you sure you want to delete this route? This action cannot be undone.",confirmText:"Delete",isLoading:O.isPending}),s.jsx(i6,{open:Ge,onClose:()=>{Ve(!1),$e(null)},onConfirm:async()=>{if(i&&We)try{await $.mutateAsync({dbProjectId:parseInt(i,10),tag:"Untagged"===We?"":We}),JN.setState({selectedRoute:null}),d(!1),ve(null),t(!1),Tw("Folder deleted successfully"),Ve(!1),$e(null)}catch(e){const t=e;Pw(t?.message||"Failed to delete folder")}},title:"Delete Folder",message:`Are you sure you want to delete the folder "${We||"Untagged"}" and all its routes? This action cannot be undone.`,confirmText:"Delete",isLoading:$.isPending}),s.jsxs(jv,{open:Ke,onClose:()=>Xe(!1),maxWidth:"sm",fullWidth:!0,title:"Move Routes",actions:s.jsxs(s.Fragment,{children:[s.jsx(Nv,{onClick:()=>Xe(!1),style:{textTransform:"none"},children:"Cancel"}),s.jsx(Nv,{onClick:async()=>{try{const e=Array.from(he),t=bt.trim()||Ye||null;await N.mutateAsync({routeIds:e,tag:"Untagged"===t?null:t}),ge(new Set),we(!1),Xe(!1),qe(null),wt("");const n=t||"Untagged";Tw(`Successfully moved ${e.length} route(s) to '${n}'`)}catch(e){Xe(!1),Pw(`Failed to move routes: ${dn(e)}`)}},variant:"contained",disabled:N.isPending||!Ye&&!bt.trim(),style:{textTransform:"none"},children:N.isPending?s.jsx(Yd,{size:20}):"Move"})]}),children:[s.jsxs(vA,{variant:"body2",className:"mb-4",style:{fontSize:"14px"},children:["Move ",he.size," route(s) to:"]}),s.jsx(Xp,{options:ln||[],value:Ye||bt||"",onChange:(e,t)=>{"string"==typeof t?ln?.includes(t)?(qe(t),wt("")):(qe(null),wt(t)):(qe(null),wt(""))},onInputChange:(e,t)=>{t&&!ln?.includes(t)?(qe(null),wt(t)):ln?.includes(t)?(qe(t),wt("")):(qe(null),wt(""))},renderInput:e=>s.jsx(Dv,{...e,label:"Select or create folder",placeholder:"Choose a folder or type to create new...",size:"small"}),freeSolo:!0})]}),s.jsx(jv,{open:Je,onClose:()=>{Ze(!1),it("")},maxWidth:"xs",fullWidth:!0,title:"Rename Folder",actions:s.jsxs(s.Fragment,{children:[s.jsx(Nv,{onClick:()=>{Ze(!1),it("")},style:{textTransform:"none"},children:"Cancel"}),s.jsx(Nv,{onClick:async()=>{if(!i||!nt.trim())return;const e=nt.trim();if(it(""),e.length>100)it("Folder name must not exceed 100 characters");else try{const t="Untagged"===et?"":et,n=e;await V.mutateAsync({dbProjectId:parseInt(i,10),tag:t,newTag:n}),Tw("Folder renamed successfully"),Ze(!1),rt(""),it("")}catch(t){const e=t;it(e?.message||"Failed to rename folder")}},variant:"contained",disabled:V.isPending||!nt.trim(),style:{textTransform:"none"},children:V.isPending?s.jsx(Yd,{size:20}):"Rename"})]}),children:s.jsx(Dv,{label:"New Folder Name",value:nt,onChange:e=>{rt(e.target.value),it("")},error:!!ot,helperText:ot,fullWidth:!0,variant:"standard",required:!0,inputProps:{maxLength:100}})}),s.jsxs(jv,{open:st,onClose:()=>{at(!1),dt(null)},maxWidth:"sm",fullWidth:!0,title:"Move Folder",actions:s.jsxs(s.Fragment,{children:[s.jsx(Nv,{onClick:()=>{at(!1),dt(null)},style:{textTransform:"none"},children:"Cancel"}),s.jsx(Nv,{onClick:async()=>{if(i&&ut)try{const e="Untagged"===lt?"":lt,t="Untagged"===ut?"":ut;await W.mutateAsync({dbProjectId:parseInt(i,10),tag:e,newTag:t});Tw(`Successfully moved all routes to '${ut||"Untagged"}'`),at(!1),dt(null)}catch(e){const t=e;Pw(t?.message||"Failed to move routes")}},variant:"contained",disabled:V.isPending||!ut,style:{textTransform:"none"},children:V.isPending?s.jsx(Yd,{size:20}):"Move"})]}),children:[s.jsxs(vA,{variant:"body2",style:{fontSize:"14px",marginBottom:"16px"},children:['Move all routes from "',lt||"Untagged",'" to:']}),s.jsx(Xp,{options:ln.filter(e=>e!==lt)||[],value:ut||null,onChange:(e,t)=>{dt(t)},getOptionDisabled:e=>e===lt,renderInput:e=>s.jsx(Dv,{...e,label:"Select destination folder",placeholder:"Choose a folder...",variant:"standard"})})]}),s.jsx(jv,{open:At,onClose:()=>ht(!1),maxWidth:"xs",fullWidth:!0,title:"Segment Routes",actions:s.jsxs(s.Fragment,{children:[s.jsx(Nv,{onClick:()=>ht(!1),style:{textTransform:"none"},children:"Cancel"}),s.jsx(Nv,{onClick:async()=>{if(!i||!gt.trim())return;const e=parseFloat(gt);if(isNaN(e)||e<=0)Pw("Please enter a valid distance");else try{const t=await K.mutateAsync({dbProjectId:parseInt(i,10),tag:pt,distanceKm:e});Tw(t.detail||"Routes segmented successfully"),ht(!1),mt("1")}catch(t){const e=t;Pw(e?.message||"Failed to segment routes")}},variant:"contained",disabled:K.isPending||!gt.trim()||parseFloat(gt)<=0,style:{textTransform:"none"},children:K.isPending?s.jsx(Yd,{size:20}):"Segment"})]}),children:s.jsx(Dv,{label:"Distance (km)",type:"number",value:gt,onChange:e=>mt(e.target.value),fullWidth:!0,variant:"standard",disabled:"distance"!==yt,inputProps:{min:.1,step:.1}})}),Ct&&s.jsx(W7,{open:xt,currentName:Zt.find(e=>e.id===Ct)?.name||"",onClose:()=>{_t(!1),St(null)},onSave:async e=>{if(Ct)try{if(await q.mutateAsync({routeId:Ct,updates:{name:e}})){const{updateRoute:t}=JN.getState();t(Ct,{name:e});const n=$N.getState();n.individualRoute.routeUUID===Ct&&n.individualRoute.originalRouteName&&$N.setState({individualRoute:{...n.individualRoute,originalRouteName:e}})}Tw("Route renamed successfully"),_t(!1),St(null)}catch(t){throw t}},isLoading:q.isPending,projectId:i||void 0}),s.jsx(jv,{open:Et,onClose:()=>{Bt(!1),Lt(""),Rt(null),Tt(null)},maxWidth:"xs",fullWidth:!0,title:"Rename Segment",actions:s.jsxs(s.Fragment,{children:[s.jsx(Nv,{onClick:()=>{Bt(!1),Lt(""),Rt(null),Tt(null)},style:{textTransform:"none"},children:"Cancel"}),s.jsx(Nv,{onClick:async()=>{if(!It||!Pt.trim())return;const e=Pt.trim();if(Lt(""),e.length<2)Lt("Segment name must be at least 2 characters");else try{if(await q.mutateAsync({routeId:It,updates:{name:e}})&&kt){const{updateRoute:t}=JN.getState(),n=r?.id===kt?r:S.find(e=>e.id===kt);if(n?.segments){const r=n.segments.map(t=>t.uuid===It?{...t,route_name:e}:t);t(kt,{segments:r})}if(r?.id===kt){const t=r.segments?.map(t=>t.uuid===It?{...t,route_name:e}:t)||[],{updateRoute:n}=JN.getState();n(kt,{segments:t})}}Tw("Segment renamed successfully"),Bt(!1),Ft(""),Lt(""),Rt(null),Tt(null)}catch(t){const e=t;Lt(e?.message||"Failed to rename segment")}},variant:"contained",disabled:q.isPending||!Pt.trim(),style:{textTransform:"none"},children:q.isPending?s.jsx(Yd,{size:20}):"Rename"})]}),children:s.jsx(Dv,{label:"Segment Name",value:Pt,onChange:e=>{Ft(e.target.value),Lt("")},error:!!Mt,helperText:Mt,fullWidth:!0,variant:"standard",required:!0,autoFocus:!0})}),s.jsx(gv,{open:Ut.open,autoHideDuration:6e3,onClose:()=>Ot({...Ut,open:!1}),anchorOrigin:{vertical:"bottom",horizontal:"left"},children:s.jsx(rf,{className:"px-4 py-2 rounded-lg "+("success"===Ut.severity?"bg-green-600 text-white":"bg-red-600 text-white"),children:s.jsx(vA,{variant:"body2",style:{fontSize:"14px"},children:Ut.message})})})]})},J7=({open:e,onClose:t,onConfirm:n,initialSelection:r,isIngesting:o=!1})=>{const[i,a]=fe.useState([]),[l,c]=fe.useState({}),[u,d]=fe.useState(!1);fe.useEffect(()=>{if(e){const e=HD.map(e=>e.value);a(r??e),c({}),d(!1)}else a([]),c({}),d(!1)},[e,r]),fe.useEffect(()=>{o?d(!0):u&&!o&&e&&(t(),d(!1))},[o,u,e,t]);const A=()=>{o||t()};return e?s.jsx(rf,{className:"fixed left-0 top-16 h-[calc(100vh-4rem)] bg-white flex",sx:{width:"360px",fontFamily:"'Google Sans', 'Roboto', sans-serif",zIndex:1e3},children:s.jsxs(rf,{className:"h-full flex flex-col border-r border-gray-200 bg-white",sx:{width:"360px",boxShadow:"0 4px 16px rgba(0, 0, 0, 0.15), 0 2px 8px rgba(0, 0, 0, 0.1)",position:"relative",zIndex:1e3},children:[s.jsx(rf,{className:"px-4 pt-3 pb-3 border-b border-gray-200 bg-white",sx:{flexShrink:0},children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{className:"flex flex-col gap-1",children:[s.jsx(vA,{variant:"h6",className:"text-gray-900 font-medium",style:{fontSize:"15px",fontWeight:500},children:"Road Priorities"}),s.jsx(vA,{variant:"caption",color:"text.secondary",sx:{fontSize:"0.75rem",lineHeight:1.2},children:"Filter roads when importing."})]}),s.jsx(tA,{size:"small",onClick:A,disabled:o,children:s.jsx(IX,{fontSize:"small"})})]})}),s.jsx(rf,{className:"flex-1 overflow-auto px-4 py-3 border-b border-gray-200 bg-white",sx:{flexShrink:0,minHeight:0},children:s.jsx(k5,{selectedPriorities:i,onSelectionChange:a,expandedCategories:l,onExpandedCategoriesChange:c})}),s.jsx(rf,{className:"px-4 py-4 border-t border-gray-200 bg-white",sx:{flexShrink:0,minHeight:"48px",position:"relative",zIndex:1001},children:s.jsxs(Bv,{direction:"row",spacing:1,children:[s.jsx(Nv,{variant:"outlined",fullWidth:!0,onClick:A,disabled:o,size:"small",children:"Cancel"}),s.jsx(Nv,{variant:"contained",fullWidth:!0,onClick:()=>{0===i.length||o||n(i)},disabled:0===i.length||o,size:"small",startIcon:o?s.jsx(Yd,{size:16,sx:{color:"inherit"}}):null,sx:{whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},children:o?"Importing roads...":`Confirm (${i.length})`})]})})]})}):null},Z7=e=>{const t=e.trim();return t?t.length>100?{isValid:!1,error:"Route name must not exceed 100 characters"}:{isValid:!0}:{isValid:!1,error:"Route name is required"}},eee=({open:e,onClose:t,onConfirm:n,featureCount:r,availableProperties:o=[],projectId:i})=>{const[a,l]=fe.useState(o.length>0?"property":"custom"),[c,u]=fe.useState(o[0]||""),[d,A]=fe.useState("Route"),[h,p]=fe.useState("");fe.useEffect(()=>{e&&(l(o.length>0?"property":"custom"),u(o[0]||""),A("Route"))},[e,o]);const f=()=>{t()},g=d.trim()?`${d.trim()} 1`:"";return s.jsxs(jv,{open:e,onClose:f,maxWidth:"sm",fullWidth:!0,title:"Configure Route Names",actions:s.jsxs(s.Fragment,{children:[s.jsx(Nv,{onClick:f,variant:"text",sx:{color:"#5f6368","&:hover":{backgroundColor:"rgba(95, 99, 104, 0.08)"}},children:"Cancel"}),s.jsx(Nv,{onClick:()=>{if("property"===a)n({type:"property",value:c});else{const e=d.trim();if(!e)return void p("Route name is required");const t=Z7(e);if(!t.isValid)return void p(t.error||"");p(""),n({type:"custom",value:e})}t()},variant:"contained",disabled:"custom"===a&&!d.trim()||"property"===a&&!c,children:"Continue"})]}),children:[s.jsxs(vA,{variant:"body2",sx:{color:"#5f6368",marginBottom:"24px",fontSize:"14px"},children:["This GeoJSON file contains ",r," feature(s). Choose how to name the routes:"]}),s.jsx(Ng,{component:"fieldset",fullWidth:!0,children:s.jsxs(Qy,{value:a,onChange:e=>l(e.target.value),children:[o.length>0&&s.jsxs(s.Fragment,{children:[s.jsx(Gg,{value:"property",control:s.jsx(Ny,{}),label:"Use feature property",sx:{marginBottom:"16px"}}),"property"===a&&s.jsxs("div",{style:{marginLeft:"32px",marginBottom:"16px"},children:[s.jsxs(Ng,{fullWidth:!0,size:"small",children:[s.jsx(hm,{id:"property-select-label",children:"Select Property"}),s.jsx(tv,{labelId:"property-select-label",value:c,label:"Select Property",onChange:e=>u(e.target.value),sx:{borderRadius:"8px"},children:o.map(e=>s.jsx(Ay,{value:e,children:e},e))})]}),s.jsxs(vA,{variant:"caption",sx:{color:"#5f6368",fontSize:"12px",marginTop:"8px",display:"block"},children:['Routes will be named using the "',c,"\" property value from each feature. If a feature doesn't have this property, it will fall back to a default name."]})]})]}),s.jsx(Gg,{value:"custom",control:s.jsx(Ny,{}),label:"Use a custom name",sx:{marginBottom:"16px"}}),"custom"===a&&s.jsxs("div",{style:{marginLeft:"32px",marginBottom:"16px"},children:[s.jsx(Dv,{fullWidth:!0,placeholder:"Enter custom name (e.g., 'My Route')",value:d,onChange:e=>{A(e.target.value),h&&p("")},variant:"outlined",size:"small",inputProps:{maxLength:100},error:!!h,helperText:h,sx:{marginBottom:"8px","& .MuiOutlinedInput-root":{borderRadius:"8px"}}}),s.jsxs(vA,{variant:"caption",sx:{color:"#5f6368",fontSize:"12px",display:"block"},children:["Routes will be named: ",g||"...",","," ",d.trim()||"..."," 2, ",d.trim()||"..."," 3, etc."]})]})]})})]})},tee=({className:e,style:t})=>{const{mapType:n,toggleMapType:r,projectData:o}=JN(),i=(()=>{const e=ye();return Ee({mutationFn:async({db_project_id:e,project_number:t,gcp_project_id:n})=>{const r=await Bj(e,t,n);if("error"===r.status)throw new Error(r.message);return r},onSuccess:async t=>{e.invalidateQueries({queryKey:["routes-infinite"]}),e.invalidateQueries({queryKey:["route"]}),e.invalidateQueries({queryKey:["routeTags"]}),e.invalidateQueries({queryKey:["project-tags"]}),(0,$N.getState().refreshRoutesTilesTimestamp)(),"Running in view mode."===t.details.message?Fw("This project is in view-only mode. Syncing is disabled.",{duration:5e3}):Tw("Routes synced successfully.",{duration:5e3});const n=JN.getState().projectId;n&&setTimeout(async()=>{try{const t=await ZK("main-map");await pj.updateSnapshot(n,t),await e.invalidateQueries({queryKey:eX.projects})}catch(t){}},2e3)},onError:e=>{Pw(`Sync failed: ${e instanceof Error?e.message:"Unknown error"}`,{duration:5e3})}})})(),{mapMode:a,handleModeChange:l}=(()=>{const e=JN(e=>e.mapMode),t=JN(e=>e.setMapMode),n=$N(e=>e.resetRoadPriorityFilters),r=$N(e=>e.clearAllDrawing),o=$N(e=>e.clearUploadedRoutes),i=$N(e=>e.clearSnappedRoads),s=$N(e=>e.clearAllOptimizedRouteMarkers),a=$N(e=>e.setSelectedUploadedRouteId),l=kw(e=>e.dismissAll);return{mapMode:e,setMapMode:t,handleModeChange:(c,u)=>{if(e===c)if("individual_drawing"===c){const{editingSavedRouteId:e,hasUnsavedChanges:t,discardRouteChanges:n,clearPoints:o,clearIndividualRoute:i,setRouteUUID:s,setEditingSavedRouteId:a,individualRoute:l}=$N.getState(),c=l.points.length>0&&null===e,u=null!==e&&t(e);if(c||u){const{setPendingModeSwitch:e}=JN.getState();return void e({from:"individual_drawing",to:"view",returnToMode:"individual_drawing"})}e?(n(e),s(null),a(null),o(),i()):(o(),i()),r()}else t("view"),r();else t(c),null!==JN.getState().pendingModeSwitch||"individual_drawing"!==c&&"polygon_drawing"!==c&&"lasso_selection"!==c||(a(null),o(),i(),s(),l());u?.(),n()}}})(),{undo:c,redo:u,canUndo:d,canRedo:A}=(()=>{const[e,t]=pe.useState(()=>$N.temporal.getState());return pe.useEffect(()=>$N.temporal.subscribe(e=>{t(e)}),[]),{undo:e.undo,redo:e.redo,clear:e.clear,canUndo:e.pastStates.length>0,canRedo:e.futureStates.length>0,undoDepth:e.pastStates.length,redoDepth:e.futureStates.length}})(),h=$N(e=>e.roadImport),p=$N(e=>e.setSelectionMode),f=$N(e=>e.clearLassoDrawing),g=$N(e=>e.clearLassoFilteredRoads),m=$N(e=>e.clearRouteInMaking),y=$N(e=>e.saveRouteInMaking),v=$N(e=>e.uploadedRoutes),b=fe.useMemo(()=>{if(0===v.routes.length)return!1;return!v.routes.every(e=>e.name.includes("(Original)"))},[v.routes]),[w,x]=fe.useState(!1),{fileInputRef:_,pendingFeatureCount:C,pendingProperties:S,routeNamingDialogOpen:E,handleUploadRoute:B,handleFileUploadChange:I,handleRouteNamingConfirm:R,handleRouteNamingCancel:k}=i0(),{isIngesting:T,priorityDialogOpen:P,handlePolygonDone:F,handleLassoDone:M,handlePriorityConfirm:L,handlePriorityCancel:U}=X3(),O=$N(e=>e.polygonDrawing),D=$N(e=>e.lassoDrawing),N=kw(e=>e.messages),j=Lj(e=>e.show_instructions),Q=N.length>0||j,[z,H]=fe.useState(!1);fe.useEffect(()=>{const e=()=>{F()},t=()=>{M()};return window.addEventListener("complete-polygon-drawing",e),window.addEventListener("complete-lasso-selection",t),()=>{window.removeEventListener("complete-polygon-drawing",e),window.removeEventListener("complete-lasso-selection",t)}},[O,D,F,M]);const[G,V]=fe.useState(!1),W=fe.useRef(null),$=fe.useRef(null);fe.useEffect(()=>{const e=e=>{W.current&&!W.current.contains(e.target)&&G&&V(!1)};return G&&document.addEventListener("mousedown",e),()=>{document.removeEventListener("mousedown",e)}},[G]);const K="upload_routes"===a||"editing_uploaded_route"===a;fe.useEffect(()=>{const e=e=>{if(e.target instanceof HTMLInputElement||e.target instanceof HTMLTextAreaElement||e.target.isContentEditable)return;if(!(e.ctrlKey||e.metaKey))return;const t=e.key.toLowerCase();if("z"===t&&!e.shiftKey){if("upload_routes"===a||"editing_uploaded_route"===a)return;return e.preventDefault(),void(d&&c())}if("y"===t||"z"===t&&e.shiftKey){if("upload_routes"===a||"editing_uploaded_route"===a)return;e.preventDefault(),A&&u()}};return window.addEventListener("keydown",e),()=>window.removeEventListener("keydown",e)},[c,u,d,A,a]);const X=e=>{$N.temporal.getState().clear(),l(e,()=>V(!1))},Y="road_selection"===a,q="lasso"===h?.selectionMode,J="single"===h?.selectionMode,Z="multi-select"===h?.selectionMode,ee=e=>{p(e),"lasso"===e?$N.getState().startLassoDrawing():(f(),g()),"multi-select"!==e&&$N.getState().clearMultiSelectTemp()},te=pe.useCallback(async()=>{const e=JN.getState().projectId;if(e)try{await uj.delete(`/polygon/delete/${e}`)}catch(t){Pw("Failed to delete roads",{description:t instanceof Error?t.message:"Could not delete roads from database"})}},[]),ne=fe.useRef(a);fe.useEffect(()=>{"road_selection"===ne.current&&"road_selection"!==a&&te(),ne.current=a},[a,te]);const re=()=>s.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"w-5 h-5",viewBox:"0 0 24 24",fill:"currentColor",children:s.jsx("path",{d:"m13.775 22l-3.625-7.8L6 20V2l14 11h-7.1l3.6 7.725z"})}),oe=$N(e=>e.individualRoute.routeUUID),ie=pe.useMemo(()=>"upload_routes"===a||E||b?{text:"From File (GeoJSON)",icon:s.jsx(gY,{sx:{fontSize:18}}),className:"bg-orange-50 text-orange-700 hover:bg-orange-100 border border-orange-200",isActive:!0}:"individual_drawing"===a&&null===oe?{text:"Draw Route",icon:s.jsx(jX,{sx:{fontSize:18}}),className:"bg-blue-50 border-blue-100 border border-solid text-blue-700 hover:bg-blue-100",isActive:!0}:"polygon_drawing"===a?{text:"Import Roads",icon:T?s.jsx(Yd,{size:18,sx:{color:"inherit"}}):s.jsx(FX,{sx:{fontSize:18}}),className:"bg-green-50 border-green-100 border border-solid text-green-700 hover:bg-green-100",isActive:!0}:"road_selection"===a?{text:"Import Roads",icon:s.jsx(FX,{sx:{fontSize:18}}),className:"bg-green-50 border-green-100 border border-solid text-green-700 hover:bg-green-100",isActive:!0}:{text:"Add Routes",icon:null,className:"bg-white text-gray-700 hover:bg-gray-50",isActive:!1},[a,T,oe,b,E]);return s.jsxs(s.Fragment,{children:[s.jsx(V7,{open:w||i.isPending,message:"Syncing routes, please wait..."}),s.jsx("input",{ref:_,type:"file",accept:".geojson,.json,.kml,.kmz,.gpx,.zip",onChange:I,style:{display:"none"}}),s.jsx(rf,{className:`absolute top-20 left-1/2 flex flex-col gap-2 z-[1001] items-center ${e}`,style:{transform:"translateX(-50%)",...t},children:s.jsx(rf,{className:"flex flex-col items-center gap-2",children:s.jsxs(rf,{className:"flex flex-nowrap items-center relative",sx:{backgroundColor:"white",borderRadius:"50px",padding:"5px",boxShadow:"0 4px 12px 0 rgba(0,0,0,0.15), 0 2px 6px 0 rgba(0,0,0,0.1)",gap:"8px",whiteSpace:"nowrap",overflow:"visible",width:"max-content","& > *":{flexShrink:0}},children:[s.jsxs(rf,{className:"relative",ref:W,children:[s.jsx(Nv,{onClick:()=>V(!G),startIcon:ie.icon,endIcon:s.jsx(GX,{sx:{transform:G?"rotate(180deg)":"rotate(0deg)",transition:"transform 0.3s ease"}}),variant:"text",disabled:"polygon_drawing"===a&&T,className:`rounded-full font-semibold transition-all duration-200 px-4 py-2.5 text-sm capitalize ${ie.className}`,sx:{fontWeight:600,fontSize:"0.875rem",textTransform:"none",whiteSpace:"nowrap",backgroundColor:ie.isActive?void 0:"transparent",border:ie.isActive?void 0:"none",boxShadow:"none","&:hover":{backgroundColor:ie.isActive?void 0:"rgba(0,0,0,0.05)",boxShadow:"none"},"&.Mui-disabled":{backgroundColor:"rgba(16, 185, 129, 0.1)",color:"rgba(16, 185, 129, 0.7)"}},children:ie.text}),s.jsx(rf,{sx:{position:"absolute",top:"100%",left:"50%",transform:"translateX(-50%)",marginTop:"4px",zIndex:1001},children:s.jsx(hd,{in:G,children:s.jsxs(rf,{className:"flex flex-col",sx:{backgroundColor:"white",borderRadius:"16px",boxShadow:"0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06)",border:"1px solid rgba(0, 0, 0, 0.1)",overflow:"hidden",minWidth:"180px"},children:[s.jsx(Ev,{title:"Upload routes from GeoJSON file",placement:"right",children:s.jsx(Nv,{onClick:()=>{B(()=>V(!1))},startIcon:s.jsx(gY,{sx:{fontSize:18}}),variant:"text",fullWidth:!0,className:"font-medium transition-all duration-150 px-4 py-2.5 text-sm capitalize justify-start "+("upload_routes"===a||E||b?"bg-orange-50 text-orange-700 hover:bg-orange-100":"bg-white text-gray-700 hover:bg-gray-50"),sx:{borderRadius:0,fontWeight:500,fontSize:"0.875rem",whiteSpace:"nowrap",textTransform:"none",borderBottom:"1px solid rgba(0, 0, 0, 0.05)","&:last-of-type":{borderBottom:"none"}},children:"From File (GeoJSON)"})}),s.jsx(Ev,{title:"Draw a custom route on the map, adjust it, segment it and save it",placement:"right",children:s.jsx(Nv,{onClick:()=>X("individual_drawing"),startIcon:s.jsx(jX,{sx:{fontSize:18}}),variant:"text",fullWidth:!0,className:"font-medium transition-all duration-150 px-4 py-2.5 text-sm capitalize justify-start "+("individual_drawing"===a&&null===oe?"bg-blue-50 text-blue-700 hover:bg-blue-100":"bg-white text-gray-700 hover:bg-gray-50"),sx:{borderRadius:0,fontWeight:500,fontSize:"0.875rem",whiteSpace:"nowrap",textTransform:"none",borderBottom:"1px solid rgba(0, 0, 0, 0.05)","&:last-of-type":{borderBottom:"none"}},children:"Draw Route"})}),s.jsx(Ev,{title:"Import all roads (or of some priority) inside a polygon boundary",placement:"right",children:s.jsx(Nv,{onClick:()=>X("polygon_drawing"),startIcon:T?s.jsx(Yd,{size:18,sx:{color:"inherit"}}):s.jsx(FX,{sx:{fontSize:18}}),variant:"text",fullWidth:!0,disabled:"polygon_drawing"===a&&T,className:"font-medium transition-all duration-150 px-4 py-2.5 text-sm capitalize justify-start "+("polygon_drawing"===a?"bg-green-50 text-green-700 hover:bg-green-100":"bg-white text-gray-700 hover:bg-gray-50"),sx:{borderRadius:0,fontWeight:500,fontSize:"0.875rem",whiteSpace:"nowrap",textTransform:"none",borderBottom:"1px solid rgba(0, 0, 0, 0.05)","&:last-of-type":{borderBottom:"none"}},children:"Import Roads"})})]})})})]}),Y?s.jsxs(s.Fragment,{children:[s.jsx(rf,{className:"w-px h-8",sx:{backgroundColor:"rgba(0,0,0,0.12)"}}),s.jsx(Ev,{title:"Single Selection",placement:"bottom",children:s.jsx(tA,{onClick:()=>ee("single"),size:"small",className:"transition-all duration-200",sx:{width:40,height:40,borderRadius:"50%",backgroundColor:J?sJ:"transparent",color:J?"#ffffff":"#757575","&:hover":{backgroundColor:J?aJ:"rgba(0,0,0,0.04)"}},children:s.jsx(re,{})})}),s.jsx(Ev,{title:"Lasso Selection",placement:"bottom",children:s.jsx(tA,{onClick:()=>ee("lasso"),size:"small",className:"transition-all duration-200",sx:{width:40,height:40,borderRadius:"50%",backgroundColor:q?sJ:"transparent",color:q?"#ffffff":"#757575","&:hover":{backgroundColor:q?aJ:"rgba(0,0,0,0.04)"}},children:s.jsx(KX,{className:"w-5 h-5"})})}),s.jsx(Ev,{title:"Merge Roads",placement:"bottom",children:s.jsx(tA,{ref:$,onClick:()=>ee("multi-select"),size:"small",className:"transition-all duration-200",sx:{width:40,height:40,borderRadius:"50%",backgroundColor:Z?sJ:"transparent",color:Z?"#ffffff":"#757575","&:hover":{backgroundColor:Z?aJ:"rgba(0,0,0,0.04)"}},children:s.jsx(sY,{className:"w-5 h-5"})})}),s.jsx(ty,{open:Z&&!!h.routeInMaking&&h.routeInMakingRoadIds.length>0,anchorEl:$.current,anchorOrigin:{vertical:"bottom",horizontal:"center"},transformOrigin:{vertical:"top",horizontal:"center"},disableRestoreFocus:!0,disableEnforceFocus:!0,disableAutoFocus:!0,disablePortal:!1,slotProps:{root:{style:{pointerEvents:"none"}},paper:{style:{pointerEvents:"auto"},onMouseDown:e=>{e.stopPropagation()}}},sx:{mt:.5,"& .MuiBackdrop-root":{backgroundColor:"transparent",pointerEvents:"none"},"& .MuiPaper-root":{borderRadius:"9999px",boxShadow:"0 8px 16px rgba(0, 0, 0, 0.12), 0 4px 8px rgba(0, 0, 0, 0.08)",border:"none",overflow:"visible",background:"transparent",pointerEvents:"auto"}},children:s.jsx(rf,{sx:{position:"relative",backgroundColor:"#ffffff",borderRadius:"9999px",boxShadow:"0 8px 16px rgba(0, 0, 0, 0.12), 0 4px 8px rgba(0, 0, 0, 0.08)","&::before":{content:'""',position:"absolute",top:"-6px",left:"50%",transform:"translateX(-50%)",width:0,height:0,borderLeft:"6px solid transparent",borderRight:"6px solid transparent",borderBottom:"6px solid #ffffff",filter:"drop-shadow(0 -2px 4px rgba(0, 0, 0, 0.1))"}},children:s.jsxs(rf,{sx:{display:"flex",alignItems:"center",gap:.75,px:1,py:.5,backgroundColor:"#ffffff",borderRadius:"9999px"},children:[s.jsx(Ev,{title:"Cancel",placement:"top",children:s.jsx(tA,{onClick:m,size:"small",className:"transition-all duration-200",sx:{width:40,height:40,borderRadius:"50%",color:"#757575",backgroundColor:"transparent","&:hover":{backgroundColor:"rgba(0,0,0,0.04)"}},children:s.jsx(IX,{sx:{fontSize:20}})})}),s.jsx(Ev,{title:"Merge roads",placement:"top",children:s.jsxs(ff,{onClick:y,variant:"contained",startIcon:s.jsx(xX,{sx:{fontSize:20,fontWeight:600}}),className:"transition-all duration-200",sx:{height:40,borderRadius:"9999px",backgroundColor:sJ,color:"#ffffff",px:2.5,py:0,textTransform:"none",fontSize:"14px",fontWeight:600,fontFamily:'"Google Sans", sans-serif',whiteSpace:"nowrap",boxShadow:"0 2px 4px rgba(9, 87, 208, 0.2), 0 1px 2px rgba(9, 87, 208, 0.15)","&:hover":{backgroundColor:aJ,boxShadow:"0 4px 8px rgba(9, 87, 208, 0.3), 0 2px 4px rgba(9, 87, 208, 0.2)",transform:"translateY(-1px)"},"&:active":{transform:"translateY(0)",boxShadow:"0 1px 2px rgba(9, 87, 208, 0.2)"},"& .MuiButton-startIcon":{marginRight:1,marginLeft:0,"& > *:nth-of-type(1)":{fontSize:"20px"}}},children:["Merge ",h.routeInMakingRoadIds?.length||0," ","road",1!==(h.routeInMakingRoadIds?.length||0)?"s":""]})})]})})}),!(Z&&h.routeInMaking&&h.routeInMakingRoadIds.length>0)&&s.jsxs(s.Fragment,{children:[s.jsx(rf,{className:"w-px h-8",sx:{backgroundColor:"rgba(0,0,0,0.12)"}}),s.jsx(Ev,{title:"Exit Import Roads Mode",placement:"bottom",children:s.jsx(tA,{onClick:async()=>{await te(),l("view")},size:"small",className:"text-gray-600 hover:bg-gray-100 transition-all duration-200",sx:{width:40,height:40,borderRadius:"50%"},children:s.jsx(IX,{sx:{fontSize:20}})})})]})]}):s.jsxs(s.Fragment,{children:[s.jsx(rf,{className:"w-px h-8",sx:{backgroundColor:"rgba(0,0,0,0.12)"}}),s.jsx(Ev,{title:"Sync all routes to BigQuery",children:s.jsx(Nv,{onClick:async()=>{const{projectData:e}=JN.getState();if(!e)return void Pw("Project data not available");const t=parseInt(e.id),n=e.bigQueryColumn?.googleCloudProjectNumber;if(!n)return void Pw("GCP project number not configured. Please configure your GCP credentials.");if(isNaN(t))return void Pw("Invalid project ID");const r=e.bigQueryColumn?.googleCloudProjectId;if(r){x(!0);try{await i.mutateAsync({db_project_id:t,project_number:n,gcp_project_id:r})}catch{}finally{x(!1)}}else Pw("GCP project ID not configured. Please configure your GCP credentials.")},disabled:w,startIcon:s.jsx(hY,{sx:{fontSize:18,animation:w?"spin 1s linear infinite":"none","@keyframes spin":{"0%":{transform:"rotate(0deg)"},"100%":{transform:"rotate(360deg)"}}}}),variant:"text",className:"rounded-full font-semibold transition-all duration-200 px-4 py-2.5 min-w-[120px] text-sm capitalize text-gray-700 hover:bg-gray-50 active:scale-100",sx:{fontWeight:600,fontSize:"0.875rem",whiteSpace:"nowrap",backgroundColor:"transparent",border:"none",boxShadow:"none","&:hover":{backgroundColor:"rgba(0,0,0,0.05)",boxShadow:"none"},"&.Mui-disabled":{backgroundColor:"transparent",color:"rgba(0,0,0,0.38)"}},children:"Sync Routes"})})]}),s.jsxs(s.Fragment,{children:[s.jsx(rf,{className:"w-px h-8",sx:{backgroundColor:"rgba(0,0,0,0.12)"}}),s.jsxs(rf,{className:"flex items-center rounded-full overflow-hidden",sx:{backgroundColor:"transparent",border:"none",boxShadow:"none"},children:[s.jsx(Ev,{title:"Undo (Ctrl+Z)",children:s.jsx(tA,{size:"small",onClick:()=>{d&&!K&&c()},disabled:!d||K,className:"rounded-none rounded-l-full w-10 h-10 flex items-center justify-center transition-all duration-150",sx:{color:d&&!K?"rgba(0,0,0,0.87)":"rgba(0,0,0,0.26)",fontSize:"10px",backgroundColor:"transparent","&:hover":{backgroundColor:d&&!K?"rgba(0,0,0,0.05)":"transparent"},"&.Mui-disabled":{color:"rgba(0,0,0,0.26)",opacity:.5}},children:s.jsx(pY,{fontSize:"small"})})}),s.jsx(rf,{className:"w-px h-7",sx:{backgroundColor:"rgba(0,0,0,0.12)"}}),s.jsx(Ev,{title:"Redo (Ctrl+Y)",children:s.jsx(tA,{size:"small",onClick:()=>{A&&!K&&u()},disabled:!A||K,className:"rounded-none rounded-r-full w-10 h-10 flex items-center justify-center transition-all duration-150",sx:{color:A&&!K?"rgba(0,0,0,0.87)":"rgba(0,0,0,0.26)",backgroundColor:"transparent","&:hover":{backgroundColor:A&&!K?"rgba(0,0,0,0.05)":"transparent"},"&.Mui-disabled":{color:"rgba(0,0,0,0.26)",opacity:.5}},children:s.jsx(rY,{fontSize:"small"})})})]})]})]})})}),s.jsxs(rf,{className:"absolute bottom-4 right-4 flex flex-row gap-2 items-center",onMouseEnter:()=>H(!0),onMouseLeave:()=>H(!1),sx:{zIndex:1e4,opacity:Q&&!z?.4:1,transition:"opacity 0.3s ease-in-out"},children:[s.jsx(Ev,{title:"Return to home view",slotProps:{popper:{style:{zIndex:10001}}},children:s.jsx(tA,{onClick:()=>{(e=>{if(!e?.viewstate)return;const{center:t,zoom:n}=e.viewstate,r=window.googleMap;if(r&&t&&n)try{r.moveCamera({center:new google.maps.LatLng(t.lat,t.lng),zoom:n})}catch(o){}})(o)},className:"rounded-full font-semibold transition-all duration-200 py-2.5 min-w-10 text-sm capitalize bg-white border border-gray-200 text-gray-700 hover:bg-gray-50 active:scale-100",sx:{fontWeight:600,fontSize:"0.875rem",boxShadow:"0 4px 12px 0 rgba(0,0,0,0.15), 0 2px 6px 0 rgba(0,0,0,0.1)","&:hover":{boxShadow:"0 6px 20px 0 rgba(0,0,0,0.2), 0 3px 10px 0 rgba(0,0,0,0.15)",borderColor:"rgba(0,0,0,0.3)",backgroundColor:"rgba(249,250,251,1)"}},children:s.jsx(wX,{sx:{fontSize:18}})})}),s.jsx(Ev,{title:"hybrid"===n?"Switch to Road Map":"Switch to Satellite View",slotProps:{popper:{style:{zIndex:10001}}},children:s.jsx(tA,{onClick:r,className:"rounded-full font-semibold transition-all duration-200 p-0 min-w-10 text-sm capitalize  "+("hybrid"===n?"bg-purple-600 text-white hover:bg-purple-700 active:scale-100 border-0":"bg-white border border-gray-200 text-gray-700 hover:bg-gray-50 active:scale-100"),sx:{fontWeight:600,fontSize:"0.875rem",padding:0,width:"40px",height:"40px",boxShadow:"hybrid"===n?"0 4px 16px 0 rgba(147,51,234,0.35), 0 2px 8px 0 rgba(147,51,234,0.25)":"0 4px 12px 0 rgba(0,0,0,0.15), 0 2px 6px 0 rgba(0,0,0,0.1)","&:hover":{boxShadow:"hybrid"===n?"0 6px 20px 0 rgba(147,51,234,0.4), 0 3px 10px 0 rgba(147,51,234,0.3)":"0 6px 20px 0 rgba(0,0,0,0.2), 0 3px 10px 0 rgba(0,0,0,0.15)",borderColor:"hybrid"===n?"transparent":"rgba(147,51,234,0.4)"}},children:s.jsx("img",{src:"hybrid"===n?"/assets/roadmap-CgIzNe03.png":"/assets/satellite-D8UCCGyQ.png",alt:"hybrid"===n?"Road map view":"Satellite view",className:"w-full h-full object-cover rounded-full"})})})]}),"polygon_drawing"===a&&s.jsx(J7,{open:P,onClose:U,onConfirm:L,isIngesting:T}),s.jsx(eee,{open:E,onClose:k,onConfirm:R,featureCount:C,availableProperties:S})]})},nee=()=>{const e=JN(e=>e.selectedRoute),t=JN(e=>e.selectRoute),n=JN(e=>e.panels),r=JN(e=>e.mapMode),o=JN(e=>e.mapType),i=$N(e=>e.individualRoute.routeUUID),a=$N(e=>e.segmentation),l=JN(e=>e.rightPanelType),c=JN(e=>e.setRightPanelType),u=JN(e=>e.dynamicIslandHeight),d=q5(),A=s0(o),{loadRouteForEditing:h,updateRoute:p,removeRoute:f}=JN(),{loadRoutePoints:g,setRouteUUID:m,clearPoints:y}=$N(),v=iX(),b=sX(),w=fe.useMemo(()=>e?.encodedPolyline?Cw(e.encodedPolyline):null,[e?.encodedPolyline]),x=w??e?.distance??0,[_,C]=pe.useState(!1),[S,E]=pe.useState(""),[B,I]=pe.useState(""),[R,k]=pe.useState(!1),T=fe.useRef(null);fe.useEffect(()=>{const n="individual_drawing"===T.current,o="individual_drawing"===r;T.current=r,o&&null!==e&&null===i&&!n&&t(null)},[r,e,t,i]),fe.useEffect(()=>{if(null!==e){if("individual_drawing"===r)return;("route_ready"===l||"segmentation"===l||"naming"===l||"route_details"!==l)&&c("route_details")}else null===e&&"route_details"===l&&c(null)},[e,l,c,r]);const P="individual_drawing"===r,F="segmentation"===r||a.isActive;if(!(n.right.visible&&null!==e&&!P&&!F&&"route_details"===l)||!e)return null;const M=()=>{t(null),c(null)},L=async()=>{if(!e)return;const t=S.trim(),n=Z7(t);if(n.isValid)try{await v.mutateAsync({routeId:e.id,updates:{name:t}})&&p(e.id,{name:t}),C(!1),I("")}catch(r){I(r instanceof Error?r.message:"Failed to update route name")}else I(n.error||"")},U=()=>{E(""),I(""),C(!1)},O=e=>{switch(e){case"STATUS_RUNNING":return"synced";case"STATUS_VALIDATING":return"validating";case"STATUS_INVALID":return"invalid";default:return"unsynced"}};return s.jsxs(e6,{dynamicIslandHeight:u,title:s.jsx(vA,{variant:"h6",component:"div",noWrap:!0,title:e.name||"Unnamed Route",className:"text-lg font-medium text-gray-900 leading-[1.2] max-w-[220px] overflow-hidden text-ellipsis whitespace-nowrap",sx:{fontFamily:'"Google Sans", sans-serif'},children:e.name||"Unnamed Route"}),headerContent:s.jsx(tA,{size:"small",onClick:()=>{e&&(E(e.name||""),I(""),C(!0))},disabled:_,sx:{color:"#5f6368","&:hover":{backgroundColor:"#f1f3f4"}},title:"Rename route",children:s.jsx(jX,{sx:{fontSize:18}})}),onClose:M,children:[s.jsx(rf,{sx:{p:2.5,display:"flex",flexDirection:"column",gap:2},children:s.jsxs(rf,{sx:{display:"flex",flexDirection:"column",gap:1.5},children:[(void 0!==e.distance||null!==w)&&s.jsxs(rf,{sx:{display:"flex",alignItems:"center",justifyContent:"space-between"},children:[s.jsx(vA,{variant:"body2",sx:{fontSize:"13px",fontFamily:'"Google Sans", sans-serif',fontWeight:400,color:"#5f6368"},children:"Distance"}),s.jsx(vA,{variant:"body2",sx:{fontSize:"13px",fontFamily:'"Google Sans", sans-serif',fontWeight:500,color:"#111827"},children:Y5(x,d)})]}),e.type&&s.jsxs(rf,{sx:{display:"flex",alignItems:"center",justifyContent:"space-between"},children:[s.jsx(vA,{variant:"body2",sx:{fontSize:"13px",fontFamily:'"Google Sans", sans-serif',fontWeight:400,color:"#5f6368"},children:"Type"}),s.jsx(ap,{label:e.type.charAt(0).toUpperCase()+e.type.slice(1),size:"small",sx:{height:"22px",fontSize:"11px",fontFamily:'"Google Sans", sans-serif',backgroundColor:"uploaded"===e.type?`rgba(${tN[0]}, ${tN[1]}, ${tN[2]}, 0.25)`:"#e3f2fd",color:"uploaded"===e.type?"#f57c00":"#1976d2","& .MuiChip-label":{padding:"0 10px",fontWeight:500}}})]}),e.sync_status&&!e.isSegmented&&s.jsxs(rf,{sx:{display:"flex",alignItems:"center",justifyContent:"space-between"},children:[s.jsx(vA,{variant:"body2",sx:{fontSize:"13px",fontFamily:'"Google Sans", sans-serif',fontWeight:400,color:"#5f6368"},children:"Status"}),s.jsx(ap,{label:(e=>{switch(e){case"STATUS_RUNNING":return"Running";case"STATUS_VALIDATING":return"Validating";case"STATUS_INVALID":return"Invalid";default:return"Unsynced"}})(e.route_status),size:"small",sx:{height:"22px",fontSize:"11px",fontFamily:'"Google Sans", sans-serif',backgroundColor:(e=>{const t=O(e);return(([e,t,n],r=.15)=>`rgba(${e}, ${t}, ${n}, ${r})`)(A.routeStatusColors[t],.15)})(e.route_status),color:(e=>{const t=O(e);return(([e,t,n])=>`rgb(${e}, ${t}, ${n})`)(A.routeStatusColors[t])})(e.route_status),"& .MuiChip-label":{padding:"0 10px",fontWeight:500}}})]}),e.tag&&s.jsxs(rf,{sx:{display:"flex",alignItems:"center",justifyContent:"space-between"},children:[s.jsx(vA,{variant:"body2",sx:{fontSize:"13px",fontFamily:'"Google Sans", sans-serif',fontWeight:400,color:"#5f6368"},children:"Folder"}),s.jsx(vA,{variant:"body2",sx:{fontSize:"13px",fontFamily:'"Google Sans", sans-serif',fontWeight:500,color:"#111827",textAlign:"right",maxWidth:"calc(100% - 100px)",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:e.tag})]}),e.isSegmented&&s.jsxs(rf,{sx:{display:"flex",alignItems:"center",justifyContent:"space-between"},children:[s.jsx(vA,{variant:"body2",sx:{fontSize:"13px",fontFamily:'"Google Sans", sans-serif',fontWeight:400,color:"#5f6368"},children:"Segments"}),s.jsxs(vA,{variant:"body2",sx:{fontSize:"13px",fontFamily:'"Google Sans", sans-serif',fontWeight:500,color:"#111827"},children:[e.segmentCount||0," segment(s)"]})]}),void 0!==e.matchPercentage&&null!==e.matchPercentage&&s.jsxs(rf,{sx:{display:"flex",alignItems:"center",justifyContent:"space-between"},children:[s.jsx(vA,{variant:"body2",sx:{fontSize:"13px",fontFamily:'"Google Sans", sans-serif',fontWeight:400,color:"#5f6368"},children:"Match"}),s.jsx(ap,{label:`${Math.round(e.matchPercentage)}%`,size:"small",sx:{height:"22px",fontSize:"11px",fontFamily:'"Google Sans", sans-serif',backgroundColor:e.matchPercentage>=80?"#e8f5e9":e.matchPercentage>=60?"#fff3e0":"#ffebee",color:e.matchPercentage>=80?"#2e7d32":e.matchPercentage>=60?"#e65100":"#c62828","& .MuiChip-label":{padding:"0 10px",fontWeight:500}}})]})]})}),s.jsx(rf,{sx:{display:"flex",flexDirection:"column",gap:2},children:s.jsxs(rf,{sx:{p:2.5,display:"flex",alignItems:"center",justifyContent:"space-between",paddingTop:2,borderTop:"1px solid #e8eaed"},children:[s.jsx(Nv,{variant:"outlined",size:"small",startIcon:s.jsx(MX,{sx:{fontSize:16}}),onClick:()=>{k(!0)},disabled:b.isPending,sx:{color:"#5f6368",borderColor:"#dadce0",padding:"8px 16px","&:hover":{borderColor:"#bdc1c6",backgroundColor:"#f8f9fa"},"&.Mui-disabled":{color:"#bdc1c6",borderColor:"#e8eaed"}},children:b.isPending?"Deleting...":"Delete"}),s.jsx(Nv,{variant:"outlined",size:"small",startIcon:s.jsx(QX,{sx:{fontSize:16}}),onClick:async()=>{e&&(h(e,g,m,y),c(null))},sx:{color:"#5f6368",borderColor:"#dadce0",padding:"8px 16px","&:hover":{borderColor:"#bdc1c6",backgroundColor:"#f8f9fa"}},children:"Modify"})]})}),s.jsx(jv,{open:_,onClose:U,maxWidth:"xs",fullWidth:!0,title:"Rename Route",actions:s.jsxs(s.Fragment,{children:[s.jsx(Nv,{onClick:U,style:{textTransform:"none"},children:"Cancel"}),s.jsx(Nv,{onClick:L,variant:"contained",disabled:v.isPending||!S.trim(),style:{textTransform:"none"},children:v.isPending?s.jsx(Yd,{size:20}):"Rename"})]}),children:s.jsx(Dv,{label:"Route Name",value:S,onChange:e=>{E(e.target.value),I("")},error:!!B,inputProps:{maxLength:100},helperText:B,fullWidth:!0,variant:"standard",required:!0,autoFocus:!0,onKeyDown:e=>{"Enter"===e.key&&L()}})}),s.jsx(i6,{open:R,onClose:()=>k(!1),onConfirm:()=>{e&&(b.mutate(e.id,{onSuccess:()=>{f(e.id),M()},onError:e=>{alert(`Failed to delete route: ${e.message}`)}}),k(!1))},title:"Delete Route",message:"Are you sure you want to delete this route? This action cannot be undone.",confirmText:"Delete",isLoading:b.isPending})]})},ree=({routeId:e,routeInfo:t,className:n,style:r,onBack:o,onRenameRoute:i,onSwapStartEnd:a,onAddWaypoint:l,onRemoveWaypoint:c,onMoveWaypointUp:u,onMoveWaypointDown:d,onMoveOriginDown:A,onMoveDestinationUp:h,onCancelAddingWaypoint:p,isAddingWaypoint:f,waypointAddingRouteId:g,onSaveRouteChanges:m,onDiscardRouteChanges:y})=>{const[v,b]=fe.useState(!1),w=q5(),x=$N(e=>e.snappedRoads),_=$N(e=>e.initializeRouteEditing),C=$N(t=>t.hasUnsavedChanges(e)),S=$N(e=>e.getEditingState),E=JN(e=>e.dynamicIslandHeight),B=JN(e=>e.projectData),I=B?.boundaryGeoJson,R=ia(),k=fe.useMemo(()=>{if(!I)return!0;const t=S(e),n=x.routeMarkers.find(t=>t.routeId===e),r=t?.temporaryMarkers||n;if(r){if(!Ew(r.startMarker.lat,r.startMarker.lng,I))return!1;if(!Ew(r.endMarker.lat,r.endMarker.lng,I))return!1;if(r.waypoints&&r.waypoints.length>0)for(const e of r.waypoints)if(!Ew(e.position.lat,e.position.lng,I))return!1}const o=t?x.previewRoads.filter(t=>t.uploadedRouteId===e):x.roads.filter(t=>t.uploadedRouteId===e);if(t&&0===o.length)return!1;if(0===o.length)return!0;for(const e of o){const t=e.feature.geometry;if("LineString"===t.type){const e=t.coordinates;for(const t of e)if(Array.isArray(t)&&t.length>=2){const[e,n]=[t[0],t[1]];if(!Ew(n,e,I))return!1}}else if("MultiLineString"===t.type)for(const e of t.coordinates)if(Array.isArray(e))for(const t of e)if(Array.isArray(t)&&t.length>=2){const[e,n]=[t[0],t[1]];if(!Ew(n,e,I))return!1}}return!0},[I,e,x.roads,x.previewRoads,x.routeMarkers,S]),T=fe.useRef({}),P=fe.useRef(null),F=fe.useRef(null);fe.useEffect(()=>{S(e)||_(e)},[e,_,S]);const M=fe.useMemo(()=>{if(!x.isLoading)return!1;if(!x.routeMarkers.find(t=>t.routeId===e))return!1;return 0===x.roads.filter(t=>t.uploadedRouteId===e).length},[x.isLoading,x.roads,x.routeMarkers,e]),L=fe.useRef({}),U=fe.useRef(0);fe.useEffect(()=>{if(f&&g===e){const e=F.current||P.current;e&&(U.current=e.scrollTop)}},[f,g,e]),fe.useEffect(()=>{if(f&&g===e){const e=setTimeout(()=>{const e=F.current||P.current;e&&U.current>0&&(e.scrollTop=U.current)},50);return()=>clearTimeout(e)}},[f,g,e]),fe.useEffect(()=>{const t=$N.getState(),n=(0,t.getEditingState)(e),r=n?.temporaryMarkers||t.snappedRoads.routeMarkers.find(t=>t.routeId===e);if(!r)return;const o=r.waypoints?.length||0;if(!(e in L.current))return void(L.current[e]=o);if(o>L.current[e]&&o>0){const e=(t=0)=>{const n=F.current||P.current;n?(n.scrollTo({top:n.scrollHeight,behavior:"smooth"}),U.current=n.scrollHeight):t<5&&requestAnimationFrame(()=>{setTimeout(()=>e(t+1),150)})};requestAnimationFrame(()=>{requestAnimationFrame(()=>{setTimeout(()=>e(0),400)})})}L.current[e]=o},[e,t.waypoints.length,x.routeMarkers]);const O=fe.useCallback(()=>{b(!0)},[]),D=fe.useCallback(async e=>{await i(e),b(!1)},[i]),N=fe.useCallback(()=>{o()},[o]),[j,Q]=fe.useState(window.innerHeight);fe.useEffect(()=>{const e=()=>{Q(window.innerHeight)};return window.addEventListener("resize",e),()=>window.removeEventListener("resize",e)},[]);const z=fe.useMemo(()=>{const e=j-144-22-E-24;return Math.max(Math.min(e,600),400)},[E,j]),H=fe.useMemo(()=>z-80-60-60-40,[z]),G=s.jsx(rf,{sx:{minWidth:0,overflow:"hidden",maxWidth:"140px"},children:s.jsx(vA,{variant:"h6",component:"div",sx:{fontSize:R.fontSizes.body,fontFamily:'"Google Sans", sans-serif',fontWeight:500,color:"#111827",lineHeight:1.2,width:"100%",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},title:t.routeName,children:t.routeName})}),V=s.jsx(tA,{size:"small",onClick:O,sx:{color:"#5f6368","&:hover":{backgroundColor:"#f1f3f4",color:"#1967d2"}},title:"Edit route name",children:s.jsx(jX,{fontSize:"small"})});return s.jsxs(e6,{className:n,style:{...r,maxHeight:z},dynamicIslandHeight:E,title:G,subtitle:Y5(t.distanceKm,w),showBackButton:!0,onBack:N,onClose:N,headerContent:V,footer:s.jsx(s.Fragment,{children:s.jsxs(rf,{sx:{px:2.5,pt:2,pb:2,display:"flex",gap:1,width:"100%"},children:[s.jsx(Nv,{size:"small",variant:"outlined",onClick:()=>y(e),disabled:!C,sx:{flex:1,minWidth:"80px",textTransform:"none",fontSize:R.fontSizes.body,fontWeight:500,fontFamily:'"Google Sans", sans-serif',padding:"6px 12px",color:"#5f6368",borderColor:"#dadce0",backgroundColor:"#ffffff","&:hover":{borderColor:"#bdc1c6",backgroundColor:"#f8f9fa"},"&.Mui-disabled":{color:"#bdc1c6",borderColor:"#e8eaed",backgroundColor:"#f8f9fa"}},children:"Discard"}),s.jsx(Nv,{size:"small",variant:"contained",onClick:()=>m(e),disabled:!C||!k,sx:{flex:1,minWidth:"80px",textTransform:"none",fontSize:R.fontSizes.body,fontWeight:500,fontFamily:'"Google Sans", sans-serif',padding:"6px 12px",backgroundColor:"#1976d2",boxShadow:"none","&:hover":{backgroundColor:"#1565c0",boxShadow:"0 1px 3px rgba(0, 0, 0, 0.12)"},"&.Mui-disabled":{backgroundColor:"#e8eaed",color:"#bdc1c6"}},title:k?void 0:"Route is outside the jurisdiction boundary",children:"Save"})]})}),children:[s.jsx(rf,{sx:{px:0,pt:0,pb:0,display:"flex",flexDirection:"column",overflow:"hidden",flex:1},children:M?s.jsx(rf,{className:"text-center py-4 text-gray-500",children:s.jsx(vA,{variant:"body2",sx:{fontSize:R.fontSizes.body,fontFamily:'"Google Sans", sans-serif',color:"#5f6368"},children:"Generating route..."})}):s.jsxs(s.Fragment,{children:[s.jsx(rf,{sx:{px:2.5,py:2,borderBottom:"1px solid #e8eaed"},children:s.jsx(rf,{children:s.jsxs(rf,{sx:{display:"flex",alignItems:"center",justifyContent:"space-between",gap:1.5},children:[s.jsxs(rf,{sx:{display:"flex",alignItems:"center",gap:1},children:[s.jsx(vA,{variant:"body1",sx:{fontSize:R.fontSizes.body,color:"#202124",fontWeight:500,fontFamily:'"Google Sans", sans-serif',letterSpacing:"-0.01em",lineHeight:1.4},children:Y5(t.distanceKm,w)}),s.jsx(Ev,{title:"Shows how closely Google's route follows your uploaded route",children:s.jsx(ap,{label:`${t.similarityPercentage}% match`,size:"small",sx:{height:"20px",backgroundColor:t.similarityPercentage>=80?"#e8f5e9":t.similarityPercentage>=60?"#fff3e0":"#ffebee",color:t.similarityPercentage>=80?"#2e7d32":t.similarityPercentage>=60?"#e65100":"#c62828","& .MuiChip-label":{padding:"0 6px",fontSize:R.fontSizes.helper,fontWeight:500,fontFamily:'"Google Sans", sans-serif'},cursor:"help",border:"none"}})})]}),s.jsx(Nv,{size:"small",onClick:n=>{n.stopPropagation(),f&&g===e?p():t.waypoints.length<25&&l(e)},disabled:t.waypoints.length>=25&&!(f&&g===e),startIcon:f&&g===e?s.jsx(bX,{sx:{fontSize:R.fontSizes.body}}):s.jsx(fX,{sx:{fontSize:R.fontSizes.body,backgroundColor:sJ,color:"#ffffff",borderRadius:"50%",width:"16px",height:"16px",display:"flex",alignItems:"center",justifyContent:"center"}}),sx:{color:f&&g===e?"#ea4335":sJ,textTransform:"none",fontSize:R.fontSizes.body,fontWeight:500,fontFamily:'"Google Sans", sans-serif',padding:"1px 4px",minWidth:"auto",boxShadow:"none","&:hover":{backgroundColor:"#f1f3f4",boxShadow:"none"},"&.Mui-disabled":{color:"#bdc1c6"},"& .MuiButton-startIcon":{marginRight:"4px",marginLeft:0}},children:f&&g===e?"Cancel":"Add Waypoint"})]})})}),s.jsx(rf,{className:"px-4 flex flex-col overflow-hidden",children:(()=>{const n=t.waypoints||[],r=x.routeMarkers.find(t=>t.routeId===e),o=(0,$N.getState().getEditingState)(e),i=o?.temporaryMarkers||r,l=i?.startMarker,p=i?.endMarker,f=e=>e?`${e.lat.toFixed(6)}, ${e.lng.toFixed(6)}`:"No location";return s.jsx(rf,{className:"flex flex-col",sx:{py:0===n.length?.5:2},children:s.jsxs(rf,{ref:F,sx:{maxHeight:`${H}px`,overflowY:"auto",display:"flex",flexDirection:"column","&::-webkit-scrollbar":{width:"8px"},"&::-webkit-scrollbar-track":{backgroundColor:"#f1f3f4",borderRadius:"4px"},"&::-webkit-scrollbar-thumb":{backgroundColor:"#dadce0",borderRadius:"4px","&:hover":{backgroundColor:"#bdc1c6"}}},children:[l&&s.jsxs(rf,{sx:{display:"flex",alignItems:"center",gap:1.5,px:2,py:0===n.length?.75:1.5,position:"relative"},children:[s.jsx(rf,{sx:{width:"16px",height:"16px",flexShrink:0,display:"flex",alignItems:"center",justifyContent:"center",position:"relative"},children:s.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 32 32",xmlns:"http://www.w3.org/2000/svg",children:[s.jsx("circle",{cx:"16",cy:"16",r:"13",fill:"none",stroke:"white",strokeWidth:"1"}),s.jsx("circle",{cx:"16",cy:"16",r:"10",fill:"white",stroke:"#202124",strokeWidth:"6"})]})}),s.jsxs(vA,{sx:{fontSize:R.fontSizes.body,color:"#202124",fontFamily:'"Google Sans", sans-serif',flex:1,overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},title:f(l),children:["Origin (",l.lat.toFixed(2),","," ",l.lng.toFixed(2),")"]}),n.length>0&&s.jsx(rf,{sx:{display:"flex",alignItems:"center",gap:0},children:s.jsx(tA,{"aria-label":"move origin down",size:"small",onClick:t=>{t.stopPropagation(),A(e)},sx:{color:"#5f6368",padding:"2px","&:hover":{backgroundColor:"#f1f3f4",color:"#202124"},transition:"all 0.15s"},children:s.jsx(mX,{sx:{fontSize:"14px"}})})})]}),p&&s.jsxs(rf,{sx:{display:"flex",alignItems:"center",position:"relative",px:2,py:0},children:[s.jsx(rf,{sx:{flex:1,borderTop:"1px solid #dadce0",mr:0===n.length?1:0}}),0===n.length&&s.jsx(Ev,{title:"Swaps start and end points to generate route in opposite direction",placement:"top",arrow:!0,children:s.jsx(tA,{size:"small",onClick:t=>{t.stopPropagation(),a(e)},sx:{color:"#5f6368",padding:"2px","&:hover":{backgroundColor:"#f1f3f4",color:"#202124"}},children:s.jsx(AY,{sx:{fontSize:"16px"}})})})]}),n.sort((e,t)=>e.order-t.order).map((t,r)=>s.jsxs(fe.Fragment,{children:[s.jsxs(rf,{ref:e=>{e?T.current[t.id]=e:delete T.current[t.id]},sx:{display:"flex",alignItems:"center",gap:1.5,px:2,py:1.5,position:"relative","&:hover":{backgroundColor:"#f8f9fa",borderRadius:"4px"},transition:"background-color 0.15s"},children:[s.jsx(rf,{sx:{width:"18px",height:"18px",borderRadius:"50%",backgroundColor:sJ,display:"flex",alignItems:"center",justifyContent:"center",flexShrink:0,color:"#ffffff",fontSize:R.fontSizes.caption,fontWeight:600,fontFamily:'"Google Sans", sans-serif'},children:t.order+1}),s.jsxs(vA,{sx:{fontSize:R.fontSizes.body,color:"#202124",fontFamily:'"Google Sans", sans-serif',flex:1},children:["Waypoint ",t.order+1," (",t.position.lat.toFixed(2),","," ",t.position.lng.toFixed(2),")"]}),s.jsxs(rf,{sx:{display:"flex",alignItems:"center",gap:0},children:[s.jsx(tA,{"aria-label":"move waypoint up",size:"small",onClick:n=>{n.stopPropagation(),u(e,t.id)},sx:{color:"#202124",padding:"2px","&:hover":{backgroundColor:"#f1f3f4",color:"#202124"},transition:"all 0.15s"},children:s.jsx(vX,{sx:{fontSize:"14px"}})}),s.jsx(tA,{"aria-label":"move waypoint down",size:"small",onClick:n=>{n.stopPropagation(),d(e,t.id)},sx:{color:"#5f6368",padding:"2px","&:hover":{backgroundColor:"#f1f3f4",color:"#202124"},transition:"all 0.15s"},children:s.jsx(mX,{sx:{fontSize:"14px"}})}),s.jsx(rf,{sx:{width:"1px",height:"16px",backgroundColor:"#dadce0",mx:.5}}),s.jsx(tA,{edge:"end","aria-label":"delete waypoint",size:"small",onClick:n=>{n.stopPropagation(),c(e,t.id)},sx:{color:"#5f6368",padding:"2px","&:hover":{backgroundColor:"#fce8e6",color:"#d93025"},transition:"all 0.15s"},children:s.jsx(IX,{sx:{fontSize:"14px"}})})]})]}),(r<n.length-1||p)&&s.jsx(rf,{sx:{borderTop:"1px solid #dadce0",mx:2}})]},t.id)),p&&s.jsxs(rf,{sx:{display:"flex",alignItems:"center",gap:1.5,px:2,py:0===n.length?.75:1.5,position:"relative"},children:[s.jsx(rf,{sx:{width:"16px",height:"16px",flexShrink:0,display:"flex",alignItems:"flex-start",justifyContent:"center",position:"relative"},children:s.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 48 72",xmlns:"http://www.w3.org/2000/svg",style:{filter:"drop-shadow(0 1px 2px rgba(0, 0, 0, 0.1))"},children:[s.jsx("path",{d:"M24 0\n                                     C13 0 4 9 4 20\n                                     C4 34 17 48 22.5 67\n                                     C22.8 68 23.3 72 24 72\n                                     C24.7 72 25.2 68 25.5 67\n                                     C31 48 44 34 44 20\n                                     C44 9 35 0 24 0Z",fill:"#ea4335",stroke:"#b11313",strokeWidth:"1"}),s.jsx("circle",{cx:"24",cy:"20",r:"8",fill:"#b11313"})]})}),s.jsxs(vA,{sx:{fontSize:R.fontSizes.body,color:"#202124",fontFamily:'"Google Sans", sans-serif',flex:1,overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},title:f(p),children:["Destination (",p.lat.toFixed(2),","," ",p.lng.toFixed(2),")"]}),n.length>0&&s.jsx(rf,{sx:{display:"flex",alignItems:"center",gap:0},children:s.jsx(tA,{"aria-label":"move destination up",size:"small",onClick:t=>{t.stopPropagation(),h(e)},sx:{color:"#5f6368",padding:"2px","&:hover":{backgroundColor:"#f1f3f4",color:"#202124"},transition:"all 0.15s"},children:s.jsx(vX,{sx:{fontSize:"14px"}})})})]})]})})})()})]})}),s.jsx(W7,{open:v,currentName:t.routeName,onClose:()=>b(!1),onSave:D})]})},oee=({className:e,style:t})=>{const n=q5(),{projectId:r,setMapMode:o,leftPanelExpanded:i,setLeftPanelExpanded:a,activePanel:l,setActivePanel:c,setSelectedRoutePanelVisible:u,projectData:d,setCurrentFolder:A}=JN(),h=lX(),p=sX(),{data:f=[]}=cX(r||""),g=$N(e=>e.editingSavedRouteId),m=$N(e=>e.setEditingSavedRouteId),y=$N(e=>e.uploadedRoutes),v=$N(e=>e.snappedRoads.routeMarkers.length),b=$N(e=>e.snappedRoads.roads.length),w=$N(e=>e.snappedRoads.previewRoads.length),x=$N(e=>e.snappedRoads.isLoading),_=$N(e=>{const t=e.snappedRoads.roads,n=e.snappedRoads.previewRoads,r=new Map;t.forEach(e=>{const t=e.uploadedRouteId;if(!t)return;const n=r.get(t)||"",o=`${e.id}-${e.feature.properties?.distance||0}-${e.feature.properties?.duration||0}`;r.set(t,n?`${n}|${o}`:o)});const o=Array.from(r.entries()).map(([e,t])=>`${e}:${t.split("|").length}`).join(","),i=new Map;n.forEach(e=>{const t=e.uploadedRouteId;if(!t)return;const n=i.get(t)||"",r=`${e.id}-${e.feature.properties?.distance||0}-${e.feature.properties?.duration||0}`;i.set(t,n?`${n}|${r}`:r)});const s=Array.from(i.entries()).map(([e,t])=>`${e}:${t.split("|").length}:${t}`).join(",");return`${t.length}-${n.length}-${o}-${s}`}),C=$N(e=>e.hasUnsavedChanges),S=$N(e=>e.snappedRoads.routeMarkers.reduce((e,t)=>e+(t.waypoints?.length||0),0)),E=$N(e=>e.focusOnUploadedRoutes),B=$N(e=>e.setHoveredRouteId),I=$N(e=>e.removeUploadedRoute),R=$N(e=>e.updateUploadedRoute),k=$N(e=>e.removeSnappedRoadsForRoute),T=$N(e=>e.removeOptimizedRouteMarkers),P=$N(e=>e.clearUploadedRoutes),F=$N(e=>e.clearSnappedRoads),M=$N(e=>e.clearAllOptimizedRouteMarkers),L=$N(e=>e.removeWaypoint),U=$N(e=>e.moveWaypointUp),O=$N(e=>e.moveWaypointDown),D=$N(e=>e.moveOriginDown),N=$N(e=>e.moveDestinationUp),j=$N(e=>e.selectedUploadedRouteId),Q=$N(e=>e.setSelectedUploadedRouteId),z=$N(e=>e.setAddingWaypointMode),H=$N(e=>e.isAddingWaypoint),G=$N(e=>e.waypointAddingRouteId),V=$N(e=>e.cancelAddingWaypoint),W=$N(e=>e.swapRouteStartEnd),$=$N(e=>e.addSnappedRoads),K=$N(e=>e.setOptimizedRouteMarkers),X=$N(e=>e.saveRouteChanges),Y=$N(e=>e.discardRouteChanges),q=$N(e=>e.initializeRouteEditing),[J,Z]=fe.useState(!1),[ee,te]=fe.useState(null),[ne,re]=fe.useState(""),[oe,ie]=fe.useState(!1),[se,ae]=fe.useState(!1),le=fe.useRef(null),[ce,ue]=fe.useState("difference"),[de,Ae]=fe.useState(""),[he,pe]=fe.useState(new Set),[ge,me]=fe.useState(!1),[ye,ve]=fe.useState(""),[be,we]=fe.useState(null),[xe,_e]=fe.useState(!1),[Ce,Se]=fe.useState(!1),Ee=fe.useCallback(async e=>{await new Promise(e=>requestAnimationFrame(()=>e(void 0)));const t=$N.getState(),n=t.getEditingState(e),r=n?.temporaryMarkers||t.snappedRoads.routeMarkers.find(t=>t.routeId===e);if(r)try{const o=r.waypoints.length>0?r.waypoints.sort((e,t)=>e.order-t.order).map(e=>({lat:e.position.lat,lng:e.position.lng})):[],i=await Vw.generateRoute(r.startMarker,r.endMarker,o);if(!i.success||!i.data)throw new Error(i.message||"Failed to generate route");const{encodedPolyline:s,distance:a,duration:l}=i.data,c=Sw(s),u={type:"Feature",geometry:c,properties:{id:`${e}-optimized`,name:"Optimized Route",source:"google_routes_api",distance:a.toFixed(2),duration:l.toFixed(0),traffic_aware:!0,encodedPolyline:s}},d=JN.getState().projectData,A=d?.boundaryGeoJson;if(A){const r=[];"LineString"===c.type?c.coordinates.forEach(e=>{Array.isArray(e)&&e.length>=2&&r.push([e[0],e[1]])}):"MultiLineString"===c.type&&c.coordinates.forEach(e=>{Array.isArray(e)&&e.forEach(e=>{Array.isArray(e)&&e.length>=2&&r.push([e[0],e[1]])})});const{isPointInBoundary:o}=await Ie(async()=>{const{isPointInBoundary:e}=await Promise.resolve().then(()=>Iw);return{isPointInBoundary:e}},void 0);if(!r.every(([e,t])=>o(t,e,A)))return n&&t.removePreviewRoadsForRoute(e),void Pw("Route is outside the jurisdiction boundary")}n?(t.removePreviewRoadsForRoute(e),t.addPreviewRoads(e,[u])):(t.removePreviewRoadsForRoute(e),t.removeSnappedRoadsForRoute(e),t.addSnappedRoads(e,[u]))}catch(o){}},[]),Be=fe.useMemo(()=>{const e=$N.getState().snappedRoads;return{routeMarkers:e.routeMarkers,roads:e.roads,previewRoads:e.previewRoads,isLoading:e.isLoading,isVisible:e.isVisible,isDraggingMarker:e.isDraggingMarker,hoveredRouteId:e.hoveredRouteId}},[v,b,w,x,S,_]),Re=y.routes.length,ke=fe.useRef(0),Te=fe.useMemo(()=>Re>0&&y.routes.every(e=>e.name.includes("(Original)")),[Re,y.routes]);fe.useEffect(()=>"saved_routes"===l&&0===Re?(Z(!1),void(ke.current=0)):0!==Re||g||j||"uploaded_routes"!==l?j&&Re>0?(Z(!0),c("uploaded_routes"),void(ke.current=Re)):(!j&&Re>0&&J&&!g&&!Te&&(Z(!0),c("uploaded_routes")),g&&Re>0&&!Te&&(Z(!0),c("uploaded_routes")),!(Re>0&&0===ke.current)||J||g||j||Te||(Z(!0),c("uploaded_routes"),a(!0)),Re>ke.current&&J&&Re>0&&(Z(!0),c("uploaded_routes")),Re<ke.current&&J&&Re>0&&ke.current>0&&(Z(!0),c("uploaded_routes")),void(ke.current=Re)):(Z(!1),c(null),void(ke.current=0)),[Re,J,l,c,a,g,j,Te]),fe.useEffect(()=>{const e=y.routes.map(e=>e.id),t=Be.roads.map(e=>e.uploadedRouteId);Je.current.forEach((n,r)=>{t.includes(r)?Je.current.delete(r):e.includes(r)||Je.current.delete(r)})},[y.routes,Be.roads]);const Pe=fe.useMemo(()=>{const e=Be.routeMarkers.map(e=>{const t=y.routes.find(t=>t.id===e.routeId),n=Be.roads.filter(t=>t.uploadedRouteId===e.routeId);let r=0,o=0;if(n.forEach(e=>{const t=e.feature.properties?.distance,n=t?parseFloat(t):0;r+=n;const i=e.feature.properties?.duration,s=i?parseFloat(i):0;o+=s}),0===n.length&&t){const e=e=>{if("FeatureCollection"===e.type){const t=[];return e.features.forEach(e=>{"LineString"===e.geometry.type?t.push(...e.geometry.coordinates):"MultiLineString"===e.geometry.type&&e.geometry.coordinates.forEach(e=>{t.push(...e)})}),t}if("LineString"===e.geometry.type)return e.geometry.coordinates;if("MultiLineString"===e.geometry.type){const t=[];return e.geometry.coordinates.forEach(e=>{t.push(...e)}),t}return[]},n=e(t.data);if(n.length>=2){const e=6371e3;let t=0;for(let r=0;r<n.length-1;r++){const[o,i]=n[r],[s,a]=n[r+1],l=(a-i)*Math.PI/180,c=(s-o)*Math.PI/180,u=Math.sin(l/2)*Math.sin(l/2)+Math.cos(i*Math.PI/180)*Math.cos(a*Math.PI/180)*Math.sin(c/2)*Math.sin(c/2);t+=e*(2*Math.atan2(Math.sqrt(u),Math.sqrt(1-u)))}r=t/1e3,o=r/50*60}}let i=0;if(t&&n.length>0){const e=[];if(n.forEach(t=>{const n=t.feature.geometry;"LineString"===n.type&&e.push(...n.coordinates)}),e.length>0){const n={type:"LineString",coordinates:e};try{i=m5(t.data,n),i=Math.max(0,Math.min(100,i))}catch(u){i=0}}}const s=Be.routeMarkers.find(t=>t.routeId===e.routeId),a=s?.waypoints||[],l=d?.boundaryGeoJson;let c=!0;if(l&&n.length>0)for(const d of n){const e=d.feature.geometry;if("LineString"===e.type){const t=e.coordinates;for(const e of t)if(Array.isArray(e)&&e.length>=2){const[t,n]=[e[0],e[1]];if(!Ew(n,t,l)){c=!1;break}}if(!c)break}else if("MultiLineString"===e.type){for(const t of e.coordinates)if(Array.isArray(t)){for(const e of t)if(Array.isArray(e)&&e.length>=2){const[t,n]=[e[0],e[1]];if(!Ew(n,t,l)){c=!1;break}}if(!c)break}if(!c)break}}return{routeId:e.routeId,routeName:t?.name||"Unknown Route",distanceKm:r,durationMinutes:o,segmentCount:n.length,similarityPercentage:i,differencePercentage:100-i,waypoints:a,isOptimizedRouteWithinBoundary:c}}),t=[...e];switch(ce){case"difference":default:t.sort((e,t)=>t.differencePercentage-e.differencePercentage);break;case"distance":t.sort((e,t)=>e.distanceKm-t.distanceKm);break;case"alphabetical":t.sort((e,t)=>e.routeName.localeCompare(t.routeName,void 0,{sensitivity:"base"}))}return t},[Be.routeMarkers,Be.roads,y.routes,ce,d?.boundaryGeoJson,b,_]),Fe=fe.useMemo(()=>{if(!de.trim())return Pe;const e=de.trim().toLowerCase();return Pe.filter(t=>t.routeName.toLowerCase().includes(e))},[Pe,de]),Me=fe.useMemo(()=>{if(!j)return null;const e=$N.getState(),t=e.snappedRoads.previewRoads,n=C(j),r=t.filter(e=>e.uploadedRouteId===j),o=n&&r.length>0?r:Be.roads.filter(e=>e.uploadedRouteId===j),i=y.routes.find(e=>e.id===j);if(!i)return null;let s=0,a=0;if(o.forEach(e=>{const t=e.feature.properties?.distance||e.feature.properties?.length,n=t?parseFloat(t):0;s+=n;const r=e.feature.properties?.duration,o=r?parseFloat(r):0;a+=o}),0===o.length&&i){const e=e=>{if("FeatureCollection"===e.type){const t=[];return e.features.forEach(e=>{"LineString"===e.geometry.type?t.push(...e.geometry.coordinates):"MultiLineString"===e.geometry.type&&e.geometry.coordinates.forEach(e=>{t.push(...e)})}),t}if("LineString"===e.geometry.type)return e.geometry.coordinates;if("MultiLineString"===e.geometry.type){const t=[];return e.geometry.coordinates.forEach(e=>{t.push(...e)}),t}return[]},t=e(i.data);if(t.length>=2){const e=6371e3;let n=0;for(let r=0;r<t.length-1;r++){const[o,i]=t[r],[s,a]=t[r+1],l=(a-i)*Math.PI/180,c=(s-o)*Math.PI/180,u=Math.sin(l/2)*Math.sin(l/2)+Math.cos(i*Math.PI/180)*Math.cos(a*Math.PI/180)*Math.sin(c/2)*Math.sin(c/2);n+=e*(2*Math.atan2(Math.sqrt(u),Math.sqrt(1-u)))}s=n/1e3,a=s/50*60}}let l=0;if(i&&o.length>0){const e=[];if(o.forEach(t=>{const n=t.feature.geometry;"LineString"===n.type&&e.push(...n.coordinates)}),e.length>0){const t={type:"LineString",coordinates:e};try{l=m5(i.data,t),l=Math.max(0,Math.min(100,l))}catch(h){l=0}}}const c=e.getEditingState(j),u=e.snappedRoads.routeMarkers.find(e=>e.routeId===j),d=c?.temporaryMarkers||u,A=d?.waypoints||[];return{routeId:j,routeName:i.name||"Unknown Route",distanceKm:s,durationMinutes:a,segmentCount:o.length,similarityPercentage:l,differencePercentage:100-l,waypoints:A}},[j,Be.routeMarkers,Be.roads,Be.previewRoads,y.routes,_,C,S]),Le=fe.useMemo(()=>!!Be.isLoading&&(y.routes.length>0&&0===Fe.length&&0===Be.routeMarkers.length),[Be.isLoading,y.routes.length,Fe.length,Be.routeMarkers.length]),Ue=fe.useMemo(()=>{if(0===y.routes.length)return!0;if(Be.isLoading)return!1;const e=y.routes.map(e=>{const t=Be.routeMarkers.some(t=>t.routeId===e.id),n=Be.roads.some(t=>t.uploadedRouteId===e.id),r=Be.previewRoads.some(t=>t.uploadedRouteId===e.id),o=t&&(n||r);return{routeId:e.id,routeName:e.name,hasMarkers:t,hasRegularRoads:n,hasPreviewRoads:r,isLoaded:o}}),t=e.every(e=>e.isLoaded),n=e.filter(e=>!e.isLoaded);return!Be.isLoading&&n.length>0||t},[y.routes,Be.isLoading,Be.routeMarkers,Be.roads,Be.previewRoads]),Oe=fe.useCallback(()=>{if(j){$N.getState().hasUnsavedChanges(j)&&Y(j)}Q(null),u(!1),o("view"),H&&V();const e=$N.getState().uploadedRoutes.routes.map(e=>e.id);e.length>0&&E(e)},[Q,u,o,H,V,E,j,Y]);fe.useEffect(()=>{if(j){q(j);const e=y.routes.find(e=>e.id===j);!e||e.color&&255===e.color[0]&&235===e.color[1]&&59===e.color[2]||R(j,{color:[255,235,59,255]})}},[j,q,y.routes,R]),fe.useEffect(()=>{if(j)E([j]);else{const e=y.routes.map(e=>e.id);e.length>0&&E(e)}},[j,E,y.routes]),fe.useEffect(()=>{const e=Boolean((J||g)&&null!==j&&null!==Me);u(e)},[J,g,j,Me,u]);const De=fe.useCallback(()=>{const e=!i;a(e),c(e&&y.routes.length>0?"uploaded_routes":null)},[i,a,c,y.routes.length]),Ne=fe.useCallback(()=>{Je.current.forEach(e=>{e.abort()}),Je.current.clear(),B(null),Q(null),u(!1),P(),F(),M(),te(null),re(""),ae(!1),o("view"),c("saved_routes"),u(!1),a(!1),Z(!1)},[B,Q,P,F,M,o,c,u,a,j,Y]),[je,Qe]=fe.useState(!1);fe.useEffect(()=>{je||pe(new Set)},[je,pe]);const ze=fe.useCallback(e=>{pe(t=>{const n=new Set(t);return n.has(e)?n.delete(e):n.add(e),n})},[]),He=fe.useCallback(()=>{const e=new Set(Fe.map(e=>e.routeId));pe(e)},[Fe]),Ge=fe.useCallback(()=>{pe(new Set)},[]),Ve=e=>{if(!e||!e.trim())return"Folder is required";const t=e.trim().toLowerCase(),n=f.map(e=>e.toLowerCase());return n.includes(t)?"":t.length>100?"Folder name must not exceed 100 characters":""},We=fe.useCallback(e=>{te(e),ne&&re("")},[ne]),$e=fe.useCallback(e=>{te(e),ne&&re("")},[ne]),Ke=fe.useCallback(()=>{_e(!0)},[]),Xe=fe.useCallback(()=>{te(null),re(""),_e(!1)},[]),Ye=fe.useCallback(async()=>{if(!ee||!ee.trim())return void re("Please select a folder or create a new one");const e=Ve(ee);e?re(e):(_e(!1),await qe())},[ee]),qe=async()=>{if(!r)return;if(!ee||!ee.trim())return void re("Please select a folder or create a new one");const e=Ve(ee);if(e)return void re(e);for(const r of Pe){if(!r.isOptimizedRouteWithinBoundary)continue;const e=r.routeName||`Route ${r.routeId}`;if(!e.trim())return void Pw("Route name cannot be empty");if(e.trim().length>100)return void Pw("Route name must not exceed 100 characters")}const t=[...y.routes],n={roads:[...Be.roads],routeMarkers:[...Be.routeMarkers]};Z(!1),ie(!0),ae(!1),le.current&&Ow(le.current),le.current=Lw(g?"Route is being updated...":"Routes are being saved...");const o=ee?.trim()||"Untagged";try{const e=ee?.trim()||"";g&&await p.mutateAsync(g);const t=[];for(const r of Pe){if(!r.isOptimizedRouteWithinBoundary)continue;const e=y.routes.find(e=>e.id===r.routeId);if(!e)continue;const n=$N.getState(),o=n.hasUnsavedChanges(r.routeId);let i=Be.routeMarkers.find(e=>e.routeId===r.routeId);if(o){const e=n.getEditingState(r.routeId);e?.originalMarkers&&(i=e.originalMarkers)}if(!i)continue;const s=Be.roads.filter(e=>e.uploadedRouteId===r.routeId);if(0===s.length)continue;const a=s[0].feature.properties?.distance,l=a?parseFloat(a):0;let c,u;if(1===s.length){const e=s[0];c=e.feature.properties?.encodedPolyline}if(!c){const e=[];if(s.forEach(t=>{const n=t.feature.geometry;"LineString"===n.type?e.push(...n.coordinates):"MultiLineString"===n.type&&n.coordinates.forEach(t=>{e.push(...t)})}),e.length<2)continue;u={type:"LineString",coordinates:e}}const d=[i.startMarker.lng,i.startMarker.lat],A=[i.endMarker.lng,i.endMarker.lat],h=(i.waypoints||[]).sort((e,t)=>e.order-t.order).map(e=>[e.position.lng,e.position.lat]);if("Feature"===e.data.type&&("google_routes_api"===e.data.properties?.source||String(e.data.properties?.id||"").includes("-optimized"))||"FeatureCollection"===e.data.type&&e.data.features.some(e=>"google_routes_api"===e.properties?.source||String(e.properties?.id||"").includes("-optimized")))throw new Error(`Route ${r.routeName} has optimized route data instead of original. Cannot save route.`);const p=JSON.parse(JSON.stringify(e.data));if(u){(()=>{let e=[],t=!1;if("FeatureCollection"===p.type){const n=p.features[0];"LineString"===n?.geometry.type&&(e=n.geometry.coordinates,t=3===e[0]?.length)}else"LineString"===p.geometry.type&&(e=p.geometry.coordinates,t=3===e[0]?.length);const n=u.coordinates,r=e.slice(0,3).map(e=>[e[0],e[1]]),o=n.slice(0,3).map(e=>[e[0],e[1]]);r.every((e,t)=>{const n=o[t];return!!n&&(Math.abs(e[0]-n[0])<1e-5&&Math.abs(e[1]-n[1])<1e-5)})})()}if(!c&&!u)continue;const f={id:r.routeId,name:r.routeName,length:l,originalRouteGeoJson:p,origin:d,destination:A,waypoints:h,matchPercentage:r.similarityPercentage};c?f.encodedPolyline=c:u&&(f.linestringGeoJson=u),t.push(f)}const n=Pe.filter(e=>!e.isOptimizedRouteWithinBoundary);if(n.length,0===t.length){if(n.length===Pe.length)throw new Error("All routes have optimized routes outside the jurisdiction boundary. Please adjust the routes to ensure they are within the boundary.");throw new Error("No valid routes to save")}const i=await h.mutateAsync({projectId:r,tag:e,roads:t});if(i.errors&&i.errors.length>0){const e=i.errors.map(e=>`${e.roadId}: ${e.message}`).join(", ");throw new Error(`Failed to save some routes: ${e}. ${i.savedCount} route(s) saved successfully.`)}ae(!0),le.current&&(Ow(le.current),le.current=null),m(null),Ne(),A(o),a(!0)}catch(i){const e=i instanceof Error?i.message:"Failed to save routes. Please try again.";le.current?(Uw(le.current,e,"error"),le.current=null):Pw(e),P(),F(),M(),t.forEach(e=>{(0,$N.getState().addUploadedRoute)(e)});const r=new Map;n.roads.forEach(e=>{const t=e.uploadedRouteId;t&&(r.has(t)||r.set(t,[]),r.get(t).push(e.feature))}),r.forEach((e,t)=>{(0,$N.getState().addSnappedRoads)(t,e)}),n.routeMarkers.forEach(e=>{(0,$N.getState().setOptimizedRouteMarkers)(e.routeId,e.startMarker,e.endMarker),e.waypoints&&e.waypoints.length>0&&e.waypoints.forEach(t=>{(0,$N.getState().addWaypoint)(e.routeId,t.position)})}),setTimeout(()=>{Z(!0),_e(!0)},500)}finally{ie(!1)}},Je=fe.useRef(new Map);fe.useEffect(()=>(window.__registerRouteAbortController=(e,t)=>{Je.current.set(e,t)},window.__getRouteAbortController=e=>Je.current.get(e),window.__removeRouteAbortController=e=>{Je.current.delete(e)},()=>{const e=window;delete e.__registerRouteAbortController,delete e.__getRouteAbortController,delete e.__removeRouteAbortController}),[]);const Ze=fe.useCallback(e=>{j!==e&&Q(e),z(e)},[z,j,Q]),et=fe.useCallback(async(e,t)=>{L(e,t),await Ee(e)},[L,Ee]),tt=fe.useCallback(async(e,t)=>{U(e,t),await Ee(e)},[U,Ee]),nt=fe.useCallback(async(e,t)=>{O(e,t),await Ee(e)},[O,Ee]),rt=fe.useCallback(async e=>{D(e),await Ee(e)},[D,Ee]),ot=fe.useCallback(async e=>{N(e),await Ee(e)},[N,Ee]),it=fe.useCallback(e=>{W(e)},[W]),st=fe.useCallback(async e=>{X(e),await Ee(e);const t=$N.getState();t.snappedRoads.previewRoads.some(t=>t.uploadedRouteId===e)&&t.removePreviewRoadsForRoute(e),q(e)},[X,Ee,q]),at=fe.useCallback(e=>{Y(e)},[Y]),lt=fe.useCallback((e,t)=>{const n=$N.getState(),r=y.routes.find(t=>t.id===e);if(!r)return;const o=n.snappedRoads.roads.filter(t=>t.uploadedRouteId===e);if(0===o.length)return;const i=(e=>{if("FeatureCollection"===e.type){const t=[];return e.features.forEach(e=>{"LineString"===e.geometry.type?t.push(...e.geometry.coordinates):"MultiLineString"===e.geometry.type&&e.geometry.coordinates.forEach(e=>{t.push(...e)})}),t}if("LineString"===e.geometry.type)return e.geometry.coordinates;if("MultiLineString"===e.geometry.type){const t=[];return e.geometry.coordinates.forEach(e=>{t.push(...e)}),t}return[]})(r.data);if(i.length<2)return;const s=[...i].reverse(),a=[];o.forEach(e=>{const t=e.feature.geometry;"LineString"===t.type?a.push(...t.coordinates):"MultiLineString"===t.type&&t.coordinates.forEach(e=>{a.push(...e)})});const l=[...a].reverse(),c=[],u={type:"Feature",geometry:{type:"LineString",coordinates:s},properties:{..."Feature"===r.data.type?r.data.properties:{}}},d={id:crypto.randomUUID(),name:t,type:r.type,data:u,color:r.color,uploadedAt:new Date,originalRouteId:e};(0,$N.getState().addUploadedRoute)(d);const A=l[0],h=l[l.length-1],p=o.map(e=>{const t=e.feature.geometry;let n;if("LineString"===t.type)n={type:"LineString",coordinates:[...t.coordinates].reverse()};else if("MultiLineString"===t.type){n={type:"MultiLineString",coordinates:[...t.coordinates].reverse().map(e=>[...e].reverse())}}else n={type:"LineString",coordinates:l};return{...e.feature,geometry:n,properties:{...e.feature.properties,id:`${d.id}-optimized`,name:"Optimized Route (Reversed)"}}});$(d.id,p),K(d.id,{lat:A[1],lng:A[0]},{lat:h[1],lng:h[0]}),c.length>0&&(c.forEach(e=>{(0,$N.getState().addWaypoint)(d.id,e.position)}),setTimeout(()=>{Ee(d.id)},100)),Q(d.id),setTimeout(()=>{Z(!0)},0)},[y.routes,Ee,$,K,Q,Z]),ct=fe.useCallback(()=>{0!==he.size&&(he.forEach(e=>{const t=Fe.find(t=>t.routeId===e);if(t){const n=`${t.routeName} (Reversed)`;lt(e,n)}}),pe(new Set))},[he,Fe,lt]),ut=fe.useCallback(e=>{const t=Je.current.get(e);t&&(t.abort(),Je.current.delete(e));const n=$N.getState(),r=n.selectedUploadedRouteId===e;n.snappedRoads.hoveredRouteId===e&&B(null),r&&(n.hasUnsavedChanges(e)&&Y(e),Q(null),u(!1),o("view"),H&&V()),he.has(e)&&pe(t=>{const n=new Set(t);return n.delete(e),n}),I(e),k(e),T(e),setTimeout(()=>{const e=$N.getState().uploadedRoutes.routes.map(e=>e.id);e.length>0&&E(e),Z(!0)},0)},[B,Q,u,o,he,I,k,T,Z,a,H,V,Y,E]),dt=fe.useCallback(()=>{const e=Pe.filter(e=>!e.isOptimizedRouteWithinBoundary);if(0===e.length)return;const t=$N.getState(),n=t.selectedUploadedRouteId,r=e.some(e=>e.routeId===n);e.forEach(e=>{const n=e.routeId,r=Je.current.get(n);r&&(r.abort(),Je.current.delete(n)),t.snappedRoads.hoveredRouteId===n&&B(null),he.has(n)&&pe(e=>{const t=new Set(e);return t.delete(n),t}),I(n),k(n),T(n)}),r&&n&&(t.hasUnsavedChanges(n)&&Y(n),Q(null),u(!1),o("view"),H&&V()),setTimeout(()=>{const e=$N.getState().uploadedRoutes.routes.map(e=>e.id);e.length>0&&E(e),Z(!0)},0),Se(!1),Tw(`Removed ${e.length} route${1!==e.length?"s":""} outside jurisdiction boundary`)},[Pe,he,B,Q,u,o,I,k,T,Z,H,V,Y,E]),At=fe.useCallback(()=>{if(0===he.size)return;const e=$N.getState(),t=e.selectedUploadedRouteId,n=t&&he.has(t);he.forEach(t=>{const n=Je.current.get(t);n&&(n.abort(),Je.current.delete(t)),e.snappedRoads.hoveredRouteId===t&&B(null),I(t),k(t),T(t)}),n&&t&&(e.hasUnsavedChanges(t)&&Y(t),Q(null),u(!1),o("view"),H&&V()),pe(new Set),setTimeout(()=>{const e=$N.getState().uploadedRoutes.routes.map(e=>e.id);e.length>0&&E(e),Z(!0)},0)},[he,B,Q,u,o,I,k,T,Z,a,H,V,Y,E]);return s.jsxs(s.Fragment,{children:[s.jsx(jv,{open:Ce,onClose:()=>Se(!1),title:"Remove Routes Outside Boundary",maxWidth:"sm",actions:s.jsxs(s.Fragment,{children:[s.jsx(Nv,{variant:"outlined",onClick:()=>Se(!1),sx:{textTransform:"none",fontFamily:'"Google Sans", Roboto',fontSize:"14px",fontWeight:500,padding:"8px 16px",borderColor:"#d1d5db",color:"#1976d2","&:hover":{borderColor:"#1976d2",backgroundColor:"#e3f2fd"}},children:"Cancel"}),s.jsx(Nv,{variant:"contained",onClick:dt,sx:{textTransform:"none",fontFamily:'"Google Sans", Roboto',fontSize:"14px",fontWeight:500,padding:"8px 16px",backgroundColor:"#e65100","&:hover":{backgroundColor:"#bf360c"}},children:"Remove All"})]}),children:s.jsxs(rf,{children:[s.jsx(vA,{variant:"body2",sx:{fontSize:"14px",fontWeight:400,color:"#202124",fontFamily:'"Google Sans", sans-serif',lineHeight:1.5,mb:2},children:"Are you sure you want to remove all routes outside the jurisdiction boundary? This action cannot be undone."}),s.jsxs(rf,{sx:{px:2,py:1.5,backgroundColor:"#fff3e0",border:"1px solid #ffb74d",borderRadius:"8px"},children:[s.jsx(vA,{variant:"body2",sx:{fontSize:"13px",fontWeight:500,color:"#e65100",fontFamily:'"Google Sans", sans-serif',mb:.5},children:"Routes to be removed:"}),s.jsx(rf,{component:"ul",sx:{margin:0,paddingLeft:2,fontSize:"13px",color:"#e65100",fontFamily:'"Google Sans", sans-serif'},children:Pe.filter(e=>!e.isOptimizedRouteWithinBoundary).map(e=>s.jsx("li",{children:e.routeName},e.routeId))})]})]})}),s.jsx(jv,{open:ge,onClose:()=>{me(!1),ve(""),we(null)},title:"Name Reversed Route",actions:s.jsxs(s.Fragment,{children:[s.jsx(Nv,{variant:"outlined",onClick:()=>{me(!1),ve(""),we(null)},children:"Cancel"}),s.jsx(Nv,{variant:"contained",onClick:()=>{if(be&&ye.trim()){const e=ye.trim();if(e.length>100)return;lt(be,e),me(!1),ve(""),we(null)}},disabled:!ye.trim(),children:"Create"})]}),children:s.jsx(rf,{sx:{mt:2},children:s.jsx(Dv,{fullWidth:!0,label:"Route Name",value:ye,onChange:e=>ve(e.target.value),placeholder:"Enter route name",autoFocus:!0,inputProps:{maxLength:100},onKeyDown:e=>{if("Enter"===e.key&&ye.trim()&&be){const e=ye.trim();if(e.length>100)return;lt(be,e),me(!1),ve(""),we(null)}}})})}),s.jsx(jv,{open:xe,onClose:()=>{te(null),re(""),_e(!1)},title:"Select Folder",maxWidth:"xs",actions:s.jsxs(s.Fragment,{children:[s.jsx(Nv,{variant:"outlined",onClick:Xe,sx:{textTransform:"none",fontFamily:'"Google Sans", Roboto',fontSize:"14px",fontWeight:500,padding:"8px 16px",borderColor:"#d1d5db",color:"#1976d2","&:hover":{borderColor:"#1976d2",backgroundColor:"#e3f2fd"}},children:"Cancel"}),s.jsx(Nv,{variant:"contained",onClick:Ye,disabled:oe||!Ue||!ee||!ee.trim(),sx:{textTransform:"none",fontFamily:'"Google Sans", Roboto',fontSize:"14px",fontWeight:500,padding:"8px 16px",backgroundColor:"#1976d2","&:hover":{backgroundColor:"#1565c0"},"&:disabled":{backgroundColor:"#9ca3af",color:"#ffffff"}},children:oe?g?"Updating...":"Saving...":Ue?g?"Update Route":`Save All (${Pe.length})`:"Loading routes..."})]}),children:s.jsxs(rf,{sx:{mb:2},children:[f.length>0&&s.jsxs(vA,{variant:"caption",sx:{fontSize:"12px",color:"#757575",fontFamily:'"Google Sans", sans-serif',mb:1.5,display:"block"},children:[f.length," ",1===f.length?"folder":"folders"," available"]}),s.jsx(T5,{value:ee,onChange:We,onInputChange:$e,tags:f,error:ne,required:!0,showTagsCount:!1,label:"Folder"})]})}),J&&s.jsxs(w6,{isExpanded:i,onToggle:De,width:360,children:[s.jsxs(rf,{className:"px-4 pt-3 pb-3 border-b border-gray-200 bg-white",sx:{flexShrink:0},children:[s.jsxs(rf,{className:"flex items-center justify-between mb-3",children:[s.jsx(vA,{variant:"h6",className:"text-gray-900 font-medium",style:{fontSize:"15px",fontWeight:500},children:g?"Edit Route":"Uploaded Routes"}),s.jsx($7,{sortBy:ce,onSortChange:ue})]}),s.jsx(rf,{className:"mb-3",children:s.jsx(fJ,{placeholder:"Search routes...",value:de,onChange:Ae})}),s.jsxs(rf,{className:"flex items-center justify-between",children:[s.jsxs(rf,{className:"flex items-center gap-2",children:[s.jsx(vA,{variant:"body2",sx:{fontSize:"12px",color:"#757575",fontWeight:400,fontFamily:'"Google Sans", sans-serif'},children:je&&he.size>0?s.jsxs(s.Fragment,{children:[he.size," route",1!==he.size?"s":""," selected"]}):s.jsxs(s.Fragment,{children:[Fe.length," ",1===Fe.length?"route":"routes",de&&s.jsxs("span",{children:[" of ",Pe.length]})]})}),je&&he.size>0&&s.jsxs(rf,{sx:{display:"flex",alignItems:"center",gap:.5},children:[s.jsx(Ev,{title:`Create reversed routes for ${he.size} selected route${1!==he.size?"s":""}`,children:s.jsx(tA,{size:"small",onClick:ct,sx:{color:"#1976d2",border:"1px solid #e0e0e0",padding:"2px",width:"24px",height:"24px","&:hover":{backgroundColor:"#e3f2fd",color:"#1565c0",borderColor:"#1976d2"}},children:s.jsx(OZ,{sx:{fontSize:14}})})}),s.jsx(Ev,{title:`Delete ${he.size} selected route${1!==he.size?"s":""}`,children:s.jsx(tA,{size:"small",onClick:At,sx:{color:"#757575",border:"1px solid #e0e0e0",padding:"2px",width:"24px",height:"24px","&:hover":{backgroundColor:"#f0f0f0",color:"#d32f2f",borderColor:"#d32f2f"}},children:s.jsx(MX,{sx:{fontSize:14}})})})]})]}),s.jsx(rf,{className:"flex items-center gap-1",children:Fe.length>0&&s.jsxs(s.Fragment,{children:[je?s.jsx(Nv,{size:"small",variant:"outlined",onClick:he.size===Fe.length?Ge:He,sx:{fontSize:"12px",textTransform:"none",fontFamily:'"Google Sans", Roboto',fontWeight:500,color:"#5f6368",borderColor:"#d1d5db",padding:"6px 12px",minWidth:"auto","&:hover":{borderColor:"#1976d2",backgroundColor:"#e3f2fd"}},children:he.size===Fe.length?"Deselect All":"Select All"}):s.jsx(Nv,{size:"small",variant:"outlined",onClick:()=>Qe(!0),sx:{fontSize:"12px",textTransform:"none",fontFamily:'"Google Sans", Roboto',fontWeight:500,color:"#5f6368",borderColor:"#d1d5db",padding:"6px 12px",minWidth:"auto","&:hover":{borderColor:"#1976d2",backgroundColor:"#e3f2fd"}},children:"Select"}),je&&s.jsx(Nv,{size:"small",variant:"text",onClick:()=>Qe(!1),sx:{fontSize:"12px",textTransform:"none",fontFamily:'"Google Sans", Roboto',fontWeight:500,color:"#757575",padding:"6px 12px",minWidth:"auto","&:hover":{backgroundColor:"#f5f5f5"}},children:"Done"})]})})]})]}),s.jsx(rf,{className:"flex-1 flex flex-col",sx:{minHeight:0,overflow:"hidden",position:"relative"},children:s.jsx(rf,{className:"flex-1 overflow-auto",sx:{minHeight:0},children:Le?s.jsxs(rf,{className:"p-6 text-center",children:[s.jsx(Yd,{size:32}),s.jsx(vA,{variant:"body2",className:"text-gray-500 mt-2",style:{fontSize:"14px"},children:"Generating routes..."})]}):0===y.routes.length?s.jsx(rf,{className:"p-6 text-center text-gray-500",children:s.jsx(vA,{variant:"body2",style:{fontSize:"14px"},children:"No routes uploaded yet."})}):0===Fe.length?s.jsx(rf,{className:"p-6 text-center text-gray-500",children:s.jsx(vA,{variant:"body2",style:{fontSize:"14px"},children:"No Google routes generated yet."})}):s.jsx(_m,{disablePadding:!0,className:"px-4 !mx-0 !my-2",children:Fe.map(e=>s.jsx(fe.Fragment,{children:s.jsx(Mm,{className:"mb-1",disablePadding:!0,children:s.jsxs(Im,{selected:j===e.routeId,onClick:()=>{if(je){const t=j===e.routeId,n=he.has(e.routeId);ze(e.routeId),n?t&&(Q(null),u(!1),o("view")):(Q(e.routeId),u(!0),o("editing_uploaded_route"),Z(!0),c("uploaded_routes"),q(e.routeId))}else{j===e.routeId?(Q(null),u(!1),o("view")):(Q(e.routeId),u(!0),o("editing_uploaded_route"),Z(!0),c("uploaded_routes"),q(e.routeId))}},onMouseEnter:()=>B(e.routeId),onMouseLeave:()=>B(null),sx:{minHeight:44,padding:"6px 12px",borderRadius:"1rem",marginBottom:"4px",position:"relative",zIndex:10,backgroundColor:je&&he.has(e.routeId)||j===e.routeId?"#e3f2fd":"#ffffff",borderLeft:je&&he.has(e.routeId)?"3px solid #1b75d2":j===e.routeId?"3px solid #1976d2":"3px solid transparent",border:"1px solid #e0e0e0",boxShadow:"0 1px 2px rgba(0, 0, 0, 0.05)","&:hover":{backgroundColor:je&&he.has(e.routeId)?"#e3f2fd":"#f5f5f5",boxShadow:"0 2px 4px rgba(0, 0, 0, 0.1)"},"&.Mui-selected":{backgroundColor:"#e3f2fd","&:hover":{backgroundColor:"#bbdefb"}}},children:[je&&s.jsx(Dm,{className:"min-w-[40px]",sx:{minWidth:40,display:"flex",alignItems:"center",justifyContent:"flex-start"},children:s.jsx(jf,{checked:he.has(e.routeId),onClick:t=>{t.stopPropagation();const n=j===e.routeId,r=he.has(e.routeId);ze(e.routeId),r?n&&(Q(null),u(!1),o("view")):(Q(e.routeId),u(!0),o("editing_uploaded_route"),Z(!0),a(!0),c("uploaded_routes"),q(e.routeId))},size:"small",sx:{color:"#757575",padding:0,display:"flex",alignItems:"center","&.Mui-checked":{color:"#1976d2"}},icon:s.jsx(CX,{sx:{fontSize:20,display:"flex",alignItems:"center"}}),checkedIcon:s.jsx(_X,{sx:{fontSize:20,display:"flex",alignItems:"center"}})})}),s.jsx(zm,{sx:{margin:0,padding:0,flex:1,minWidth:0,"& .MuiListItemText-primary":{marginBottom:"4px"},"& .MuiListItemText-secondary":{marginTop:0}},primary:s.jsxs(rf,{sx:{display:"flex",alignItems:"center",justifyContent:"space-between",gap:1,minWidth:0},children:[s.jsx(vA,{variant:"body2",className:"font-medium text-gray-900",title:e.routeName,sx:{fontSize:"14px",fontWeight:500,lineHeight:1.4,overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",flex:1,minWidth:0,color:je&&he.has(e.routeId)?"#1976d2":"#212121"},children:e.routeName}),!je&&s.jsxs(rf,{className:"flex items-center gap-1",sx:{flexShrink:0,display:"flex",alignItems:"center",gap:.5},children:[C(e.routeId)&&s.jsx(ap,{component:"span",label:"Unsaved",size:"small",sx:{height:"16px",backgroundColor:"#fff3e0",color:"#e65100",border:"1px solid #ffb74d","& .MuiChip-label":{padding:"0 4px",fontSize:"9px",fontWeight:400,fontFamily:'"Google Sans", sans-serif',lineHeight:1.2},flexShrink:0}}),!e.isOptimizedRouteWithinBoundary&&s.jsx(Ev,{title:"Optimized route is outside the jurisdiction boundary. This route will be excluded when saving.",children:s.jsx(ap,{component:"span",label:"Outside",size:"small",sx:{height:"16px",backgroundColor:"#ffebee",color:"#c62828",border:"1px solid #ef5350","& .MuiChip-label":{padding:"0 4px",fontSize:"9px",fontWeight:400,fontFamily:'"Google Sans", sans-serif',lineHeight:1.2},flexShrink:0,cursor:"help"}})}),s.jsx(Ev,{title:"Create return route",children:s.jsx(tA,{edge:"end","aria-label":"create return route",size:"small",onClick:t=>{t.stopPropagation(),we(e.routeId),ve(`${e.routeName} (Reversed)`),me(!0)},sx:{color:"#5f6368",padding:"4px","&:hover":{backgroundColor:"#e3f2fd",color:"#1976d2"},transition:"all 0.15s"},children:s.jsx(OZ,{sx:{fontSize:"18px"}})})}),s.jsx(Ev,{title:"Delete route",children:s.jsx(tA,{edge:"end","aria-label":"delete route",size:"small",onClick:t=>{t.stopPropagation(),ut(e.routeId)},sx:{color:"#5f6368",padding:"4px","&:hover":{backgroundColor:"#fce8e6",color:"#d93025"},transition:"all 0.15s"},children:s.jsx(MX,{fontSize:"small"})})})]})]}),secondary:s.jsx(rf,{sx:{display:"flex",alignItems:"center",justifyContent:"space-between",gap:.5,flexWrap:"wrap"},children:s.jsxs(rf,{sx:{display:"flex",alignItems:"center",gap:.5,flexWrap:"wrap"},children:[s.jsx(vA,{variant:"caption",sx:{fontSize:"11px",fontWeight:400,color:"#757575",whiteSpace:"nowrap"},children:Y5(e.distanceKm,n)}),s.jsx(Ev,{title:"Shows how closely Google's route follows your uploaded route",children:s.jsx(ap,{component:"span",label:`${e.similarityPercentage}% match`,size:"small",sx:{height:"18px",backgroundColor:e.similarityPercentage>=80?"#e8f5e9":e.similarityPercentage>=60?"#fff3e0":"#ffebee",color:e.similarityPercentage>=80?"#2e7d32":e.similarityPercentage>=60?"#e65100":"#c62828","& .MuiChip-label":{padding:"0 6px",fontSize:"10px",fontWeight:400,lineHeight:"18px"},cursor:"help",display:"inline-flex",alignItems:"center"}})})]})})})]})})},e.routeId))})})}),s.jsx(rf,{className:"px-4 py-3 border-t border-gray-200 bg-white",sx:{flexShrink:0,minHeight:"48px",position:"relative",zIndex:1001},children:s.jsxs(rf,{className:"flex flex-col",children:[se&&s.jsx(rf,{sx:{px:1.5,py:1,mb:2,backgroundColor:"#e8f5e9",border:"1px solid #c8e6c9",borderRadius:"4px"},children:s.jsx(vA,{variant:"body2",sx:{fontSize:"14px",fontWeight:400,color:"#2e7d32",fontFamily:'"Google Sans", sans-serif'},children:" All routes saved successfully!"})}),(()=>{const e=Pe.filter(e=>!e.isOptimizedRouteWithinBoundary);return e.length>0?s.jsx(rf,{sx:{px:2,py:1.5,mb:2,backgroundColor:"#fff3e0",border:"1px solid #ffb74d",borderRadius:"8px"},children:s.jsxs(vA,{variant:"body2",sx:{fontSize:"13px",fontWeight:400,color:"#e65100",fontFamily:'"Google Sans", sans-serif',lineHeight:1.5},children:[e.length," ",1===e.length?"route is":"routes are"," ","outside the jurisdiction."," ",s.jsx(rf,{component:"span",onClick:()=>Se(!0),sx:{color:"#e65100",textDecoration:"underline",cursor:"pointer",fontWeight:500,"&:hover":{color:"#bf360c"}},children:"Remove all"})]})}):null})(),(()=>{const e=Pe.filter(e=>!e.isOptimizedRouteWithinBoundary);return s.jsx(rf,{sx:{display:"flex",gap:1,justifyContent:"flex-end",alignItems:"center"},children:s.jsxs(rf,{className:"flex items-center gap-1",children:[s.jsx(Nv,{size:"small",variant:"outlined",onClick:()=>{XZ=!0,YZ.forEach(e=>{e.abort()}),YZ.clear(),null!==qZ&&(Ow(qZ),qZ=null),null!==JZ&&(Ow(JZ),JZ=null,ZZ=0,e0=""),m(null),Ne(),Fw("Uploading cancelled")},sx:{minWidth:"80px",textTransform:"none",fontFamily:'"Google Sans", Roboto',fontSize:"12px",fontWeight:500,padding:"6px 12px",borderColor:"#d1d5db",color:"#1976d2","&:hover":{borderColor:"#1976d2",backgroundColor:"#e3f2fd"}},children:"Cancel"}),s.jsx(Nv,{size:"small",variant:"contained",onClick:Ke,disabled:oe||!Ue||e.length>0,sx:{minWidth:"80px",textTransform:"none",fontFamily:'"Google Sans", Roboto',fontSize:"12px",fontWeight:500,padding:"6px 12px",backgroundColor:"#1976d2","&:hover":{backgroundColor:"#1565c0"},"&:disabled":{backgroundColor:"#9ca3af",color:"#ffffff"}},children:Ue?"Save":"Loading routes..."})]})})})()]})})]}),(J||g)&&j&&Me&&s.jsx(ree,{routeId:j,routeInfo:Me,className:e,style:t,onBack:Oe,onRenameRoute:async e=>{j&&R(j,{name:e.trim()})},onSwapStartEnd:it,onAddWaypoint:Ze,onRemoveWaypoint:et,onMoveWaypointUp:tt,onMoveWaypointDown:nt,onMoveOriginDown:rt,onMoveDestinationUp:ot,onCancelAddingWaypoint:V,isAddingWaypoint:H,waypointAddingRouteId:G,onSaveRouteChanges:st,onDiscardRouteChanges:at})]})},iee=({projectId:e,apiKey:t,className:n,style:r})=>{const o=JN(e=>e.setProject),i=JN(e=>e.projectData),a=JN(e=>e.mapMode),{data:l,isLoading:c,error:u}=(e=>Se({queryKey:eX.project(e),queryFn:async()=>{const t=await pj.getById(e);if(!t.success)throw new Error(t.message);return t.data},enabled:!!e,staleTime:3e5}))(e);return pe.useEffect(()=>{e&&(()=>{const e=$N.getState();e.uploadedRoutes.routes.forEach(t=>{e.discardRouteChanges(t.id)}),e.clearUploadedRoutes(),$N.setState({snappedRoads:{roads:[],isVisible:e.snappedRoads.isVisible,isLoading:!1,routeMarkers:[],isDraggingMarker:!1,hoveredRouteId:null,previewRoads:[],editingStates:{}}}),e.clearAllOptimizedRouteMarkers(),e.setSelectedUploadedRouteId(null),e.setEditingSavedRouteId(null),e.setAddingWaypointMode(null),e.setRouteUUID(null),e.clearPoints()})()},[e]),pe.useEffect(()=>{if(l&&l.id!==i?.id){o(e,l);const t=$N.getState();t.refreshRoutesTilesTimestamp(),t.refreshRoadsTilesTimestamp()}},[l,e,i?.id,o]),c?s.jsx("div",{className:`relative w-full h-screen overflow-hidden flex items-center justify-center ${n}`,style:r,children:s.jsxs("div",{className:"text-center",children:[s.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-mui-primary mx-auto mb-4"}),s.jsx("p",{className:"text-gray-600",children:"Loading project..."})]})}):u?s.jsx("div",{className:`relative w-full h-screen overflow-hidden flex items-center justify-center ${n}`,style:r,children:s.jsxs("div",{className:"text-center",children:[s.jsx("p",{className:"text-red-600 mb-4",children:"Failed to load project"}),s.jsx("p",{className:"text-gray-600",children:u?.message||"Please try refreshing the page"})]})}):i?s.jsx(WZ,{children:s.jsxs("div",{className:`relative w-full h-screen overflow-hidden ${n}`,style:r,children:[s.jsx(Y6,{projectId:e,apiKey:t,className:"w-full h-full"}),s.jsx(tee,{}),s.jsx(q7,{}),i&&s.jsx(oee,{}),"individual_drawing"===a&&s.jsx(N7,{}),s.jsx(nee,{}),s.jsx(p5,{})]})}):s.jsx("div",{className:`relative w-full h-screen overflow-hidden flex items-center justify-center ${n}`,style:r,children:s.jsxs("div",{className:"text-center",children:[s.jsx("p",{className:"text-red-600 mb-4",children:"Failed to load project"}),s.jsx("p",{className:"text-gray-600",children:"Please try refreshing the page"})]})})};function see(){const{projectId:e}=Sc(),[t,n]=pe.useState(!1),{setMapMode:r}=JN(),{data:o=0,isLoading:i}=oX(e||"");if(pe.useEffect(()=>{n(!i&&0===o)},[o,i]),!e)return s.jsx("div",{className:"h-screen w-screen bg-gray-50 flex items-center justify-center",children:s.jsx("p",{className:"text-lg text-gray-600",children:"Invalid project ID"})});const a=Hw();return s.jsx(vJ,{children:s.jsx(iee,{projectId:e,apiKey:a,className:"h-[calc(100vh-64px)]"})})}const aee=ta({cssVariables:!0,typography:{fontFamily:'"Google Sans", "Roboto", "Helvetica", "Arial", sans-serif'},palette:{primary:{main:sJ,dark:aJ,contrastText:"#ffffff"}},fontSizes:{caption:"0.688rem",helper:"0.75rem",body:"0.813rem"}}),lee=(cee=[{element:s.jsx(aj,{}),children:[{path:"/",element:s.jsx(Hc,{to:"/dashboard",replace:!0})},{path:"/dashboard",element:s.jsx(HZ,{})},{path:"/add-project",element:s.jsx(hZ,{})},{path:"/project/:projectId",element:s.jsx(see,{})}]}],bl({basename:uee?.basename,getContext:uee?.getContext,future:uee?.future,history:wa({window:uee?.window}),hydrationData:Au(),routes:cee,mapRouteProperties:Dc,hydrationRouteProperties:Nc,dataStrategy:uee?.dataStrategy,patchRoutesOnNavigation:uee?.patchRoutesOnNavigation,window:uee?.window}).initialize());var cee,uee;function dee(){return s.jsxs(ga,{theme:aee,children:[s.jsx(pX,{}),s.jsx(_u,{router:lee})]})}const Aee=new class{#$;#N;#A;#K;#X;#Y;#q;#J;constructor(e={}){this.#$=e.queryCache||new ce,this.#N=e.mutationCache||new oe,this.#A=e.defaultOptions||{},this.#K=new Map,this.#X=new Map,this.#Y=0}mount(){this.#Y++,1===this.#Y&&(this.#q=F.subscribe(async e=>{e&&(await this.resumePausedMutations(),this.#$.onFocus())}),this.#J=O.subscribe(async e=>{e&&(await this.resumePausedMutations(),this.#$.onOnline())}))}unmount(){this.#Y--,0===this.#Y&&(this.#q?.(),this.#q=void 0,this.#J?.(),this.#J=void 0)}isFetching(e){return this.#$.findAll({...e,fetchStatus:"fetching"}).length}isMutating(e){return this.#N.findAll({...e,status:"pending"}).length}getQueryData(e){const t=this.defaultQueryOptions({queryKey:e});return this.#$.get(t.queryHash)?.state.data}ensureQueryData(e){const t=this.defaultQueryOptions(e),n=this.#$.build(this,t),r=n.state.data;return void 0===r?this.fetchQuery(e):(e.revalidateIfStale&&n.isStaleByTime(p(t.staleTime,n))&&this.prefetchQuery(t),Promise.resolve(r))}getQueriesData(e){return this.#$.findAll(e).map(({queryKey:e,state:t})=>[e,t.data])}setQueryData(e,t,n){const r=this.defaultQueryOptions({queryKey:e}),o=this.#$.get(r.queryHash),i=o?.state.data,s=function(e,t){return"function"==typeof e?e(t):e}(t,i);if(void 0!==s)return this.#$.build(this,r).setData(s,{...n,manual:!0})}setQueriesData(e,t,n){return U.batch(()=>this.#$.findAll(e).map(({queryKey:e})=>[e,this.setQueryData(e,t,n)]))}getQueryState(e){const t=this.defaultQueryOptions({queryKey:e});return this.#$.get(t.queryHash)?.state}removeQueries(e){const t=this.#$;U.batch(()=>{t.findAll(e).forEach(e=>{t.remove(e)})})}resetQueries(e,t){const n=this.#$;return U.batch(()=>(n.findAll(e).forEach(e=>{e.reset()}),this.refetchQueries({type:"active",...e},t)))}cancelQueries(e,t={}){const n={revert:!0,...t},r=U.batch(()=>this.#$.findAll(e).map(e=>e.cancel(n)));return Promise.all(r).then(d).catch(d)}invalidateQueries(e,t={}){return U.batch(()=>(this.#$.findAll(e).forEach(e=>{e.invalidate()}),"none"===e?.refetchType?Promise.resolve():this.refetchQueries({...e,type:e?.refetchType??e?.type??"active"},t)))}refetchQueries(e,t={}){const n={...t,cancelRefetch:t.cancelRefetch??!0},r=U.batch(()=>this.#$.findAll(e).filter(e=>!e.isDisabled()&&!e.isStatic()).map(e=>{let t=e.fetch(void 0,n);return n.throwOnError||(t=t.catch(d)),"paused"===e.state.fetchStatus?Promise.resolve():t}));return Promise.all(r).then(d)}fetchQuery(e){const t=this.defaultQueryOptions(e);void 0===t.retry&&(t.retry=!1);const n=this.#$.build(this,t);return n.isStaleByTime(p(t.staleTime,n))?n.fetch(t):Promise.resolve(n.state.data)}prefetchQuery(e){return this.fetchQuery(e).then(d).catch(d)}fetchInfiniteQuery(e){return e.behavior=q(e.pages),this.fetchQuery(e)}prefetchInfiniteQuery(e){return this.fetchInfiniteQuery(e).then(d).catch(d)}ensureInfiniteQueryData(e){return e.behavior=q(e.pages),this.ensureQueryData(e)}resumePausedMutations(){return O.isOnline()?this.#N.resumePausedMutations():Promise.resolve()}getQueryCache(){return this.#$}getMutationCache(){return this.#N}getDefaultOptions(){return this.#A}setDefaultOptions(e){this.#A=e}setQueryDefaults(e,t){this.#K.set(v(e),{queryKey:e,defaultOptions:t})}getQueryDefaults(e){const t=[...this.#K.values()],n={};return t.forEach(t=>{b(e,t.queryKey)&&Object.assign(n,t.defaultOptions)}),n}setMutationDefaults(e,t){this.#X.set(v(e),{mutationKey:e,defaultOptions:t})}getMutationDefaults(e){const t=[...this.#X.values()],n={};return t.forEach(t=>{b(e,t.mutationKey)&&Object.assign(n,t.defaultOptions)}),n}defaultQueryOptions(e){if(e._defaulted)return e;const t={...this.#A.queries,...this.getQueryDefaults(e.queryKey),...e,_defaulted:!0};return t.queryHash||(t.queryHash=y(t.queryKey,t)),void 0===t.refetchOnReconnect&&(t.refetchOnReconnect="always"!==t.networkMode),void 0===t.throwOnError&&(t.throwOnError=!!t.suspense),!t.networkMode&&t.persister&&(t.networkMode="offlineFirst"),t.queryFn===k&&(t.enabled=!1),t}defaultMutationOptions(e){return e?._defaulted?e:{...this.#A.mutations,...e?.mutationKey&&this.getMutationDefaults(e.mutationKey),...e,_defaulted:!0}}clear(){this.#$.clear(),this.#N.clear()}};We.createRoot(document.getElementById("root")).render(s.jsxs($n,{enableCssLayer:!0,children:[s.jsx(oa,{styles:"@layer theme, base, mui, components, utilities;"}),s.jsxs(ve,{client:Aee,children:[s.jsx(dee,{}),s.jsx(Te,{initialIsOpen:!1})]})]}));
